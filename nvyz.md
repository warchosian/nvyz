# Projet : nvyz

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Applications\nvyz`

**Fichiers** : 56 fichiers non-binaires

## 📁 Arborescence des fichiers

├── **si/**
│   ├── <a id="tree-si-DAT-presentation-md"></a>[DAT-presentation.md](#si-DAT-presentation-md) *(14.042 octets)*
│   ├── <a id="tree-si-RenoiRH-GTA-analysis-md"></a>[RenoiRH-GTA.analysis.md](#si-RenoiRH-GTA-analysis-md) *(17.659 octets)*
│   ├── <a id="tree-si-RenoiRH-GTA-dat-md"></a>[RenoiRH-GTA.dat.md](#si-RenoiRH-GTA-dat-md) *(11.120 octets)*
│   ├── <a id="tree-si-_VueDeploiement_Supervision_Et_Sauvegarde-md"></a>[_VueDeploiement_Supervision_Et_Sauvegarde.md](#si-_VueDeploiement_Supervision_Et_Sauvegarde-md) *(770 octets)*
│   ├── <a id="tree-si-_example-dat-md"></a>[_example.dat.md](#si-_example-dat-md) *(8.861 octets)*
│   ├── <a id="tree-si-admin_ep-analysis-md"></a>[admin_ep.analysis.md](#si-admin_ep-analysis-md) *(16.565 octets)*
│   ├── <a id="tree-si-ado-analysis-md"></a>[ado.analysis.md](#si-ado-analysis-md) *(0 octets)*
│   ├── <a id="tree-si-afinope-wiki-md"></a>[afinope.wiki.md](#si-afinope-wiki-md) *(5.056 octets)*
│   ├── <a id="tree-si-agile-front-md"></a>[agile-front.md](#si-agile-front-md) *(119.391 octets)*
│   ├── <a id="tree-si-balise-analysis-md"></a>[balise.analysis.md](#si-balise-analysis-md) *(13.407 octets)*
│   ├── <a id="tree-si-balise-md"></a>[balise.md](#si-balise-md) *(902.864 octets)*
│   ├── <a id="tree-si-causalis-wiki-md"></a>[causalis.wiki.md](#si-causalis-wiki-md) *(4.649 octets)*
│   ├── <a id="tree-si-datapop-wiki-md"></a>[datapop.wiki.md](#si-datapop-wiki-md) *(41.803 octets)*
│   ├── <a id="tree-si-formation-ecologie-analysis-md"></a>[formation-ecologie.analysis.md](#si-formation-ecologie-analysis-md) *(28.591 octets)*
│   ├── <a id="tree-si-formation-ecologie-dat-md"></a>[formation-ecologie.dat.md](#si-formation-ecologie-dat-md) *(8.861 octets)*
│   ├── <a id="tree-si-gta-scripts-md"></a>[gta-scripts.md](#si-gta-scripts-md) *(17.100 octets)*
│   ├── <a id="tree-si-honore-front-md"></a>[honore-front.md](#si-honore-front-md) *(695.533 octets)*
│   ├── <a id="tree-si-hubrh-wiki-md"></a>[hubrh.wiki.md](#si-hubrh-wiki-md) *(13.167 octets)*
│   ├── <a id="tree-si-litij-back-md"></a>[litij-back.md](#si-litij-back-md) *(158.456 octets)*
│   ├── <a id="tree-si-meridienne-wiki-md"></a>[meridienne.wiki.md](#si-meridienne-wiki-md) *(202.076 octets)*
│   ├── <a id="tree-si-meridienne_fiche-md"></a>[meridienne_fiche.md](#si-meridienne_fiche-md) *(15.454 octets)*
│   ├── <a id="tree-si-orchidee_fiche-md"></a>[orchidee_fiche.md](#si-orchidee_fiche-md) *(6.646 octets)*
│   ├── <a id="tree-si-palome-django-md"></a>[palome-django.md](#si-palome-django-md) *(428.858 octets)*
│   ├── <a id="tree-si-palome-django-wiki-md"></a>[palome-django.wiki.md](#si-palome-django-wiki-md) *(4.186 octets)*
│   ├── <a id="tree-si-palome-legacy-analysis-md"></a>[palome-legacy.analysis.md](#si-palome-legacy-analysis-md) *(15.063 octets)*
│   ├── <a id="tree-si-pasta-cooker-back-md"></a>[pasta-cooker-back.md](#si-pasta-cooker-back-md) *(18.328 octets)*
│   ├── <a id="tree-si-pastacooker-back-analysis-md"></a>[pastacooker-back.analysis.md](#si-pastacooker-back-analysis-md) *(15.355 octets)*
│   ├── <a id="tree-si-primes-analysis-md"></a>[primes.analysis.md](#si-primes-analysis-md) *(12.596 octets)*
│   ├── <a id="tree-si-primesauto-analysis-md"></a>[primesauto.analysis.md](#si-primesauto-analysis-md) *(16.817 octets)*
│   ├── <a id="tree-si-resif-analysis-md"></a>[resif.analysis.md](#si-resif-analysis-md) *(10.898 octets)*
│   ├── <a id="tree-si-riga2-wiki-md"></a>[riga2.wiki.md](#si-riga2-wiki-md) *(78.354 octets)*
│   ├── <a id="tree-si-rimenvue-back-md"></a>[rimenvue-back.md](#si-rimenvue-back-md) *(9.489 octets)*
│   ├── <a id="tree-si-rimenvue-md"></a>[rimenvue.md](#si-rimenvue-md) *(25.123 octets)*
│   ├── <a id="tree-si-sigefoups-analysis-md"></a>[sigefoups.analysis.md](#si-sigefoups-analysis-md) *(13.736 octets)*
│   ├── <a id="tree-si-sij-analysis-md"></a>[sij.analysis.md](#si-sij-analysis-md) *(18.140 octets)*
│   ├── <a id="tree-si-sij-md"></a>[sij.md](#si-sij-md) *(6.501 octets)*
│   ├── <a id="tree-si-sireines-wiki-md"></a>[sireines.wiki.md](#si-sireines-wiki-md) *(29.075 octets)*
│   ├── <a id="tree-si-sireines_analyse-md"></a>[sireines_analyse.md](#si-sireines_analyse-md) *(14.597 octets)*
│   ├── <a id="tree-si-sireines_wiki-md"></a>[sireines_wiki.md](#si-sireines_wiki-md) *(55.677 octets)*
│   ├── <a id="tree-si-siss-analysis-md"></a>[siss.analysis.md](#si-siss-analysis-md) *(16.677 octets)*
│   ├── <a id="tree-si-siss-md"></a>[siss.md](#si-siss-md) *(35.518 octets)*
│   ├── <a id="tree-si-speddi-analysis-md"></a>[speddi.analysis.md](#si-speddi-analysis-md) *(14.731 octets)*
│   ├── <a id="tree-si-speddi-wiki-md"></a>[speddi.wiki.md](#si-speddi-wiki-md) *(43.151 octets)*
│   ├── <a id="tree-si-ttc-analysis-md"></a>[ttc.analysis.md](#si-ttc-analysis-md) *(12.604 octets)*
│   ├── <a id="tree-si-vaccination-analysis-md"></a>[vaccination.analysis.md](#si-vaccination-analysis-md) *(0 octets)*
│   ├── <a id="tree-si-ze-services-md"></a>[ze-services.md](#si-ze-services-md) *(526.856 octets)*
│   ├── <a id="tree-si-zone_echange-analysis-md"></a>[zone_echange.analysis.md](#si-zone_echange-analysis-md) *(16.959 octets)*
│   └── <a id="tree-si-zone_echange-wiki-md"></a>[zone_echange.wiki.md](#si-zone_echange-wiki-md) *(148.561 octets)*
├── **src/**
│   ├── **core/**
│   │   └── <a id="tree-src-core-pathglob-py"></a>[pathglob.py](#src-core-pathglob-py) *(4.069 octets)*
│   ├── **nvyz/**
│   │   ├── <a id="tree-src-nvyz-__init__-py"></a>[__init__.py](#src-nvyz-__init__-py) *(55 octets)*
│   │   └── <a id="tree-src-nvyz-cli-py"></a>[cli.py](#src-nvyz-cli-py) *(658 octets)*
│   ├── <a id="tree-src-check_md-py"></a>[check_md.py](#src-check_md-py) *(4.554 octets)*
│   └── <a id="tree-src-check_md-py-old"></a>[check_md.py.old](#src-check_md-py-old) *(956 octets)*
├── <a id="tree--gitignore"></a>[.gitignore](#-gitignore) *(366 octets)*
├── <a id="tree-README-md"></a>[README.md](#README-md) *(543 octets)*
└── <a id="tree-pyproject-toml"></a>[pyproject.toml](#pyproject-toml) *(752 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `.gitignore` [366 octets]
<a id="-gitignore"></a> [↩ Retour à l'arborescence](#tree--gitignore)

> **Chemin relatif** : `.gitignore`  
> **Taille** : 366 octets  
> **Lignes** : 44  
> **Type** : text

```text
# Byte-compiled / optimized / DLL files
__pycache__/
*.py[cod]
*$py.class

# Distribution / packaging
.Python
build/
develop-eggs/
dist/
downloads/
eggs/
.eggs/
lib/
lib64/
parts/
sdist/
var/
wheels/
*.egg-info/
.installed.cfg
*.egg

# Installer
env/
venv/
.venv/
ENV/
env.bak/
venv.bak/

# Poetry
.poetry

# IDE
.idea/
.vscode/
*.swp
*.swo

# Tests
.coverage
.tox/

```


---

### 📄 `pyproject.toml` [752 octets]
<a id="pyproject-toml"></a> [↩ Retour à l'arborescence](#tree-pyproject-toml)

> **Chemin relatif** : `pyproject.toml`  
> **Taille** : 752 octets  
> **Lignes** : 34  
> **Type** : toml

```toml
[tool.poetry]
name = "nvyz"
version = "0.1.0"
description = "Un outil pour vérifier l'encodage des fichiers Markdown."
authors = ["Votre Nom <votre.email@example.com>"]
license = "MIT"
readme = "README.md"
packages = [{include = "nvyz", from = "src"}]

[tool.poetry.dependencies]
python = "^3.10"
chardet = "^5.2.0"

[tool.poetry.group.dev.dependencies]
commitizen = "^3.13.0"
pytest = "^8.0.0"
black = "^24.0.0"
isort = "^5.13.0"

[tool.poetry.scripts]
nvyz = "nvyz.cli:main"

[build-system]
requires = ["poetry-core>=1.0.0"]
build-backend = "poetry.core.masonry.api"

[tool.commitizen]
name = "cz_conventional_commits"
version = "0.1.0"
tag_format = "$version"
version_files = [
    "pyproject.toml:version",
    "src/nvyz/__init__.py:__version__"
]
```


---

### 📄 `README.md` [543 octets]
<a id="README-md"></a> [↩ Retour à l'arborescence](#tree-README-md)

> **Chemin relatif** : `README.md`  
> **Taille** : 543 octets  
> **Lignes** : 28  
> **Type** : markdown

````markdown
# nvyz

Un outil pour vérifier l'encodage des fichiers Markdown.

## Installation

1. Cloner le dépôt.
2. Installer les dépendances avec Poetry :
   ```bash
   poetry install
   ```
3. Activer l'environnement virtuel :
   ```bash
   poetry shell
   ```

## Utilisation

Exécutez la commande suivante pour vérifier l'encodage des fichiers Markdown :
```bash
nvyz check-md <fichiers>
```

## Développement

- Utilisez `poetry run cz commit` pour créer des commits standardisés.
- Utilisez `poetry run cz bump` pour gérer les versions.

````


---

### 📄 `si/_example.dat.md` [8.861 octets]
<a id="si-_example-dat-md"></a> [↩ Retour à l'arborescence](#tree-si-_example-dat-md)

> **Chemin relatif** : `si/_example.dat.md`  
> **Taille** : 8.861 octets  
> **Lignes** : 325  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (325 lignes) - Cliquer pour déplier</summary>

````markdown
---
title: Dossier d'architecture technique - Formation Écologie
---










**Document en chantier**

[TOC]

## Introduction et objectifs

### Vue d'ensemble

Le projet est un portail web permettant la consultation et la recherche dans le catalogue RenoiRH des formations. Il offre une exploration cartographique et des fonctionnalités de recherche avancée.

**Fonctionnalités principales:**
- Consultation du catalogue de formations RenoiRH
- Recherche avancée dans le catalogue
- Exploration cartographique des formations
- Visualisation détaillée des sessions de formation

```mermaid
graph TD
    A[Portail Formation] --> B[Catalogue RenoiRH]
    A --> C[Recherche]
    A --> D[Cartographie]
    B --> E[Sessions]
    B --> F[Stages]
    C --> G[MeiliSearch]
    D --> H[Visualisation Géographique]
```

### Objectifs principaux de qualité

1. **Performance de recherche**
   - Temps de réponse < 200ms pour les recherches
   - Pertinence des résultats
   - Interface réactive

2. **Accessibilité**
   - Conformité au RGAA
   - Compatible Design System de l'État
   - Responsive design

3. **Maintenabilité**
   - Code Python/Django structuré
   - Documentation claire
   - Tests automatisés

### Parties prenantes

| Rôle | Contact | Attentes |
|------|---------|----------|
| Utilisateurs ministériels | - | Recherche efficace des formations |
| GTI | gti@xxx.gouv.fr | Maintenance et évolutions |
| Maîtrise d'ouvrage | moa@xxx.gouv.fr | Conformité aux besoins métier |

## Contraintes

### Contraintes d'architecture

- Développement en Python/Django
- Utilisation du Design System de l'État
- Base de données PostgreSQL
- Moteur de recherche MeiliSearch
- Gestion des dépendances avec Poetry
- Python 3.11.7

### Contraintes de sécurité

- **Disponibilité**: Accès au catalogue en continu
- **Intégrité**: Données RenoiRH fiables
- **Confidentialité**: Données publiques uniquement
- **Traçabilité**: Logs applicatifs

## Contexte et périmètre

### Contexte métier

```mermaid
graph TD
    A[Portail Formation] --> B[RenoiRH]
    A --> C[MeiliSearch]
    A --> D[Interface Cartographique]
    B --> E[Catalogue Formations]
    C --> F[Index Sessions]
    C --> G[Index Stages]
    D --> H[Visualisation Géographique]
```

Interfaces fonctionnelles:
- Lecture catalogue RenoiRH
- Moteur de recherche MeiliSearch
- Visualisation cartographique
- Export des données de formation

### Contexte Technique

- Django pour le backend et les vues
- Design System de l'État pour le frontend
- PostgreSQL pour le stockage
- MeiliSearch pour la recherche

## Stratégie de solution

### Modèles de conception

- Architecture monolithique Django (MVT)
- Indexation asynchrone via Crons
- API REST pour les données cartographiques

### Environnement technologique

- Python 3.11.7
- Django dernière version stable
- Poetry pour la gestion des dépendances
- PostgreSQL
- MeiliSearch
- Docker pour le développement
- Design System de l'État (DSFR)

### Forge logicielle - CI/CD

- GitLab pour le versioning et CI/CD
- Tests unitaires Django
- Docker Compose pour le développement
- Makefile pour les commandes courantes

## Vue en Briques

```mermaid
flowchart TD
 subgraph Infrastructure["Infrastructure"]
        B["PostgreSQL"]
        A["Django App"]
        C["MeiliSearch"]
  end
 subgraph Import_RenoiRH["Import RenoiRH"]
        E["S3 Minio"]
        D["SFTP"]
        F["Temp Files"]
  end
    A --> B & C
    D -- "recup_data.sh" --> E
    E -- download_from_S3 --> F
    F -- import_cisirh --> B
    B -- index --> C
    classDef text fill:#fff,stroke:none
    linkStyle 2 stroke:#008000,stroke-width:2px,fill:none
    linkStyle 3 stroke:#0000FF,stroke-width:2px,fill:none
    linkStyle 4 stroke:#0000FF,stroke-width:2px,fill:none
    linkStyle 5 stroke:#0000FF,stroke-width:2px,fill:none
```
![Capture_d_écran_du_2025-05-16_12-26-27](uploads/79b3b9c8f4e8292e6f1ea5e6f48da749/Capture_d_écran_du_2025-05-16_12-26-27.png) Cron Import SFTP → S3 (Tous les mardis à samedis à 04h00)

![Capture_d_écran_du_2025-05-16_12-27-36](uploads/96652ac166a5da2a9fa20c533f381118/Capture_d_écran_du_2025-05-16_12-27-36.png) Cron Import S3 → DB (Tous les mardis à samedis à 04h30)

### Composants principaux

1. **Application Django**
   - **Models**
     - Stage (catalogue formations)
     - Session (instances formations)
     - Période (créneaux formation)
   
   - **Views**
     - Recherche catalogue
     - Visualisation cartographique
     - Filtres et facettes
   
   - **Templates**
     - Design System État (DSFR)
     - Interface responsive
     - Templates accessibles RGAA

2. **MeiliSearch**
   - **Index stages**
     - Titre formation
     - Mots-clés
     - Localisation
   
   - **Index sessions**
     - Dates
     - Lieux
     - Places disponibles

3. **PostgreSQL**
   - **Tables**
     - formations_stage
     - formations_session
     - formations_periode
   
   - **Contraintes**
     - Intégrité référentielle
     - Validations métier

4. **Intégration RenoiRH**
   - **Import SFTP → S3** (4h00)
     ```python
     # VM Sèche: 10.167.71.51
     # filepath: /home/admingti/recup_data.sh
     # Récupération quotidienne (mar-sam)
     # Archive jour précédent
     # Import nouveaux fichiers
     ```
   
   - **Import S3 → DB** (4h30)
     ```python
     # filepath: app/management/commands/import_cisirh.py
     # Parse fichiers CSV
     # Import PostgreSQL
     # Index MeiliSearch
     ```
## Vue Exécution

### Scénario 1: Indexation des données RenoiRH

```mermaid
sequenceDiagram
    Cron->>+Django: Déclenche ReindexAll
    Django->>+PostgreSQL: Récupère données
    PostgreSQL-->>-Django: Retourne stages/sessions
    Django->>+MeiliSearch: Indexe données
    MeiliSearch-->>-Django: Confirmation indexation
```

### Scénario 2: Recherche utilisateur

```mermaid
sequenceDiagram
    User->>+Frontend: Saisit recherche
    Frontend->>+MeiliSearch: Query API
    MeiliSearch->>+MeiliSearch: Recherche index
    MeiliSearch-->>-Frontend: Résultats
    Frontend->>+Django: Détails formations
    Django-->>-User: Affiche résultats
```

## Vue Déploiement

### Environnements

| Environnement | Serveur | Usage | URL |
|--------------|-------------|------------|------------|
| Développement | 192.168.5.139 | Tests et validation | http://dev.formation-ecologie.pnm3.eco4.cloud.e2.rie.gouv.fr/ |
| Production | 192.168.5.52 | Production | http://formation-ecologie.e2.rie.gouv.fr/ |

### Infrastructure

Le produit est hébergé sur le cloud interne ECO4 basé sur Openstack, dans le tenant 'pnm3' du département.
Le reverse-proxy Nginx du schéma ci-dessous est en fait une paire de Nginx load-balancés en frontal des produits hébergés sur le tenant.

```mermaid
graph TD
    A[Nginx] --> B[Django App]
    B --> C[PostgreSQL]
    B --> D[MeiliSearch]
```

### Supervision

Le produit est supervisé via le système standard du GTI pour ce faire :

* via Portainer pour la partie purement containérisation,
* via la stack Prometheus/Grafana/Loki/AlertManager,

Le produit dispose également d'une supervision PSIN.

### Sauvegardes

Les sauvegardes de la base de données sont assurées par des scripts standards du GTI permettant la création de dumps cryptés en AES-256 et déposés sur :

* le stockage objet B3 du IaaS ministériel,
* le stockage objet Outscale SecNumCloud (via la prestation qu'a le GTI sur le marché "Nuage Public"),
* le stockage objet standard de Google Cloud (via la prestation qu'a le GTI sur le marché "Nuage Public")

## Sujets transverses

1. **Gestion des données**
   - Import catalogue RenoiRH
   - Indexation MeiliSearch

2. **Monitoring**
   - Logs Django
   - Métriques MeiliSearch
   - Surveillance base de données

3. **Maintenance**
   - Commandes make
   - Crons d'indexation
   - Mises à jour dépendances Poetry

## Exigences de qualité

| Exigence | Validation | Mesure |
|----------|------------|--------|
| Performance recherche | < 200ms | Logs MeiliSearch |
| Conformité DSFR | Audit visuel | Checklist Design System |
| Maintenance | Poetry/Make | Facilité mise à jour |

## Risques et Dettes techniques

1. **Dette**: Documentation indexation
   - Impact: Moyen
   - Solution: Documentation des processus MeiliSearch

## Annexes

### Glossaire

- **RenoiRH**: Système RH source des données
- **DSFR**: Design System de l'État
- **GTI**: Groupe Technique Informatique

### Décisions d'architectures - ADR

- [ADR-001] Choix MeiliSearch vs Elasticsearch
````

</details>


---

### 📄 `si/_VueDeploiement_Supervision_Et_Sauvegarde.md` [770 octets]
<a id="si-_VueDeploiement_Supervision_Et_Sauvegarde-md"></a> [↩ Retour à l'arborescence](#tree-si-_VueDeploiement_Supervision_Et_Sauvegarde-md)

> **Chemin relatif** : `si/_VueDeploiement_Supervision_Et_Sauvegarde.md`  
> **Taille** : 770 octets  
> **Lignes** : 22  
> **Type** : markdown

```markdown
## Vue Déploiement

Elements à mettre systématiquement dans le DAT

### Supervision

Le produit est supervisé via le système standard du GTI pour ce faire :

* via Portainer pour la partie purement containérisation,
* via la stack Prometheus/Grafana/Loki/AlertManager,

Le produit dispose également d'une supervision PSIN.

### Sauvegardes

Les sauvegardes de la base de données sont assurées par des scripts standards du GTI permettant la création de dumps cryptés en AES-256 et déposés sur :

* le stockage objet B3 du IaaS ministériel,
* le stockage objet Outscale SecNumCloud (via la prestation qu'a le GTI sur le marché "Nuage Public"),
* le stockage objet standard de Google Cloud (via la prestation qu'a le GTI sur le marché "Nuage Public")


```


---

### 📄 `si/admin_ep.analysis.md` [16.565 octets]
<a id="si-admin_ep-analysis-md"></a> [↩ Retour à l'arborescence](#tree-si-admin_ep-analysis-md)

> **Chemin relatif** : `si/admin_ep.analysis.md`  
> **Taille** : 16.565 octets  
> **Lignes** : 523  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (523 lignes) - Cliquer pour déplier</summary>

````markdown
# ?? Analyse détaillée de lapplication `adminep`

> ? **Base de lanalyse** : contenu exact du fichier `admin_ep.md`, représentant un extrait dun projet Java EE (Struts 2, Vertigo, Maven, ODS, etc.).  
> ?? Le projet sappelle **AdminEP**, version `1.3.1`, dédié à la gestion des **administrateurs détablissements publics** (et des nominations issues des JORF/BO).

---

## ?? Aperçu général

| Champ | Valeur |
|------|--------|
| **Nom du projet** | `adminep` |
| **Version** | `1.3.1` |
| **Type** | Application web Java EE (Struts 2 + Vertigo + Log4j) |
| **Finalité** | Gestion des administrateurs détablissements publics, avec extraction automatisée darticles officiels (JORF, BO) |
| **Frontend** | JSP / Struts-tags / Bootstrap 2 / jQuery UI (thème Redmond) |
| **Backend** | Java 8+, DAO générés via `*.ksp`, orchestration métier séquencée |
| **Stockage** | Base de données relationnelle + indexation Elasticsearch (config `elasticsearch.yml`) |

---

## ?? Partie fonctionnelle

### ?? Acteurs

| Acteur | Description | Exemples de profils (fichier `cerbere-filtre.xml`) |
|--------|-------------|----------------------------------------------------|
| **Gestionnaire** | Utilisateur habilité à créer/modifier des entités | `GEST` (test@test.com) |
| **Consultant** | Accès lecture seule | `CONSULT` (consult@kleegroup.com) |
| **Administrateur technique** | Supervise les imports, relance les traitements | implicite via `SupervisionAction` |

> ?? Lauthentification semble gérée par **Cerbère** (SSO ministériel), avec un fichier `cerbere-filtre.xml` servant de bouchon pour les tests.

---

### ?? Cas dusage principaux

```plantuml
@startuml
left to right direction
actor Gestionnaire as G
actor Consultant as C
actor AdminTech as A

rectangle "AdminEP" {
  (Rechercher un établissement public) as UC1
  (Consulter un administrateur) as UC2
  (Créer / Modifier un mandat) as UC3
  (Importer des bulletins officiels) as UC4
  (Analyser des articles JORF en attente) as UC5
  (Exporter des données en ODS) as UC6
  (Superviser les imports historiques) as UC7
}

G --> UC1
G --> UC3
G --> UC4
G --> UC5
G --> UC6

C --> UC1
C --> UC2

A --> UC4
A --> UC5
A --> UC7

UC4 --> UC5 : déclenche
UC5 --> UC3 : crée/suggère
@enduml
```

#### ?? Description détaillée

| Cas dusage | Déclencheur | Résultat métier |
|------------|-------------|-----------------|
| **Rechercher un établissement public** | Saisie dans `rechercheEP.jsp` | Affichage dans `detailEP.jsp` |
| **Consulter un administrateur** | Clic sur un admin dans `rechercheAdmins.jsp` | Page `detailAdmin.jsp` (392 lignes ? riche en info) |
| **Créer / Modifier un mandat** | Bouton + Ajouter un mandat ? `detailMandat.jsp` / `detailAutreMandat.jsp` | Création dans table `mandat` |
| **Importer des bulletins officiels** | Action `RecupererBulletinActivityEngine` | Téléchargement ? stockage temporaire ? `Article` en base |
| **Analyser des articles JORF en attente** | Bouton Analyser les articles en attente (cf `supervision.jsp`) | Extraction de **nominations** / **remplacements** / **collèges** ? création d`Administrateur`s et `Mandat`s |
| **Exporter en ODS** | Bouton Exporter (ex: `DetailEPAction`) | Génération dynamique via `OdsUtil.java` (basé sur `fastods`) |
| **Supervision des imports** | Accès à `/SupervisionSupervision.do` | Vue `supervision.jsp` + historique `supervisionImportJORF.jsp` |

---

### ?? Règles métier clés (extraites du code)

1. ?? **Un article JORF peut contenir plusieurs nominations**  
   - Extraction via `StepAnalyseRechercheNominations.java` (12k lignes ? cur métier critique).
   - Types supportés :
     - Nomination simple (`Nomination`)
     - Remplacement (`Remplacement`)
     - Suppléant / titulaire (`StepAnalyseTitulaireSuppleant`)
     - Collège (`StepAnalyseRechercheColleges`)

2. ?? **Deux modes danalyse**  
   - `analyseAll()` ? analyse + **réindexation ES**
   - `analyseAllNoReindex()` ? analyse seule (plus rapide, mais index potentiellement désynchronisé)

3. ?? **Distinction EP / Autres**  
   - `analyserEP = true` ? articles liés aux Établissements Publics  
   - `analyserEP = false` ? articles autres nominations (ex: nominations dans ministères)

4. ?? **Résolution des ambiguïtés**  
   - Étape `StepAnalyseVerifierAutresNominations` : détecte les cas où un même nom/prénom apparaît plusieurs fois ? évite les doublons.

5. ?? **Format source**  
   - Articles BO/JORF stockés au format **XML** (`*.xml`) ou **PDF** (extrait via `PdfUtil.java` + Apache PDFBox)

---

### ?? Workflow dimport et danalyse

```plantuml
@startuml
title Workflow d'import et d'analyse des articles

start

:Récupérer flux RSS BO\n(RssBulletinExtractor);
:Extraire liens + métadonnées\n(NOR, thème, type, dates);
:Downloader PDF / XML;
:Mettre en attente\n(table article_attente);

if (Supervision\n"Analyser les articles en attente"?) then (oui)
  :Lancer ArticleAnalyser;
  :Exécuter preSteps\n(Init, lister EP/colleges,\ncharger articles);
  :Pour chaque article ? exécuter steps:\n- Reset variables\n- Recherche civilités\n- Recherche collèges\n- Recherche nominations\n- Titulaire/Suppléant\n- Vérif autres nominations\n- Ajout aux résultats;
  :Construire InfosExtraitesDeArticle;
  :Créer Administrateurs + Mandats\n(persistence hors analyse);
  :Déflaguer article_attente;
  :Optionnel: réindexer ES;
else (non)
  :Attente manuelle;
endif

stop
@enduml
```

> ?? Lanalyse **ne persiste rien** en base : `ArticleAnalyser` produit une liste de `InfosExtraitesDeArticle`, ensuite traitée par un autre composant (probablement `MandatsResolver.java` ou `SupervisionAction`).

---

## ?? Partie technique

### ?? Architecture générale (module Maven)

```plantuml
@startuml
package "adminep (1.3.1)" {
  [adminep-web] #lightblue
  [adminep-database] #lightgreen
  [adminep-doc] #lightyellow
  [adminep-deployment] #orange
}

[adminep-web] --> [adminep-database] : dépend
[adminep-deployment] --> [adminep-web] : assemble
[adminep-deployment] --> [adminep-database] : assemble
[adminep-deployment] --> [adminep-doc] : assemble

note right of [adminep-web]
  WAR avec JSP, Struts, Vertigo,
  FastODS, Log4j, PDFBox
end note
@enduml
```

- **`adminep-web`** (15ko lignes de config) : module principal, WAR.
- **`adminep-database`** : scripts SQL, migrations.
- **`adminep-doc`** : documentation (dossier `Doc installation/` inclus dans ZIP).
- **`adminep-deployment`** : assemblages ZIP (code, DB, docs) ? livraison continue.

---

### ?? Couches techniques (package Java)

```plantuml
@startuml
package "adminep-web" {
  package "controller" {
    [AbstractBaseAdminActionSupport]
    [SupervisionAction]
    [DetailEPAction]
    [DetailAdminAction]
    [RechercheUtilisateursAction]
  }
  
  package "services" {
    [ArticleServices]
    [ServicesBaseAdminProvider]
    [ServicesIntegrationProvider]
  }

  package "domain" {
    [Administrateur]
    [Mandat]
    [Etablissement]
    [ArticleIndex]
    [ArticleAttente]
  }

  package "util" {
    [JORFutil]
    [OdsUtil]
    [StringUtil]
    [PdfUtil]
    [RssBulletinExtractor]
    package "articleanalyser" {
      [ArticleAnalyser]
      [InfosExtraitesDeArticle]
      package "step" {
        [AbstractStepAnalyse]
        [PreStep*]
        [StepAnalyse*]
      }
      package "pojo" {
        [Nomination]
        [Remplacement]
        [Identite]
      }
    }
  }

  package "dynamo.search" {
    [ReindexArticlesByArtiIDTask]
  }

  package "orchestra" {
    [RecupererBulletinActivityEngine]
    [RecupererJORFActivityEngine]
  }
}

[controller] --> [services] : utilise
[services] --> [domain] : manipule
[services] ..> [util] : dépend
[SupervisionAction] --> [JORFutil] : appelle
[JORFutil] --> [ArticleAnalyser] : instancie + exécute
[ArticleAnalyser] --> [step] : exécute séquentiellement
[InfosExtraitesDeArticle] --> [pojo] : agrège
@enduml
```

---

### ?? Dépendances notables (inférées)

| Techno | Usage | Preuve dans le code |
|-------|-------|---------------------|
| **Apache Struts 2** | MVC web | `@AcceptCtxQueryParam`, `<s:form>`, `struts.xml` (21ko lignes) |
| **Vertigo (Klee)** | Framework DAO / DI / Search | `io.vertigo.*`, `@Inject`, `DtList`, `mda.xml` |
| **Log4j 2** | Journalisation | `log4j2.xml`, `LogManager.getLogger()` |
| **FastODS (jferard)** | Export ODS | `OdsUtil.java`, `TableCellStyleBuilder.java` |
| **Apache PDFBox** | Extraction PDF | `PdfUtil.java`, `PDDocument`, `PDFTextStripper` |
| **Elasticsearch** | Recherche full-text | `elasticsearch.yml`, `Reindex*Task.java` |
| **JSP + JSTL + DisplayTag** | IHM | `detailEP.jsp`, `<display:table>` |
| **Bootstrap 2 + jQuery UI** | CSS/JS frontend | `bootstrap-responsive.css`, `jquery-ui.css` |

---

### ?? Sécurité

```plantuml
@startuml
title Schéma d'authentification (Cerbère)

actor Utilisateur
component "Navigateur" as N
component "Filtre Cerbère" as C
component "App AdminEP" as A

Utilisateur -> N : accès /Accueil.do
N -> C : requête HTTP
C -> CerbereSSO : vérif SSO (bouchon en local)
alt Auth OK
  C -> A : injecte headers (`mel`, `profil`, ...)
  A --> N : rend JSP
else Échec
  N <-- C : redirect vers error_auth.jsp
end
@enduml
```

- ? **Authentification** : Cerbère (SSO)  simulé localement via `cerbere-filtre.xml`.
- ? **Autorisations** : gérées par `profil` (`GEST`, `CONSULT`)  probablement via `SecurityHelper.java`.
- ? **Mot de passe DB en clair** dans `context.xml` ? risque (dette technique) :

```xml
<Resource name="jdbc/AdminepDS" 
          username="adminep" password="adminep" 
          ... />
```

---

### ?? Dette technique (déduite)

| Problème | Localisation | Risque |
|---------|--------------|--------|
| ?? Credentials en clair | `context.xml`, `META-INF-RU/context.xml` | Sécurité (dev only ?) |
| ?? Logique métier dans les *steps* complexes | `StepAnalyseRechercheNominations.java` (276 lignes), `StepAnalyseRecherchePostesUniques.java` (263 lignes) | Maintenance / testabilité |
| ?? JSP volumineux | `detailEP.jsp` (455 lignes), `detailAdmin.jsp` (392 lignes) | Séparation préoccupations |
| ?? Orchestration manuelle | `ArticleAnalyser` + `List<AbstractStepAnalyse>` | Rigueur nécessaire (ordre des steps) |
| ?? Dépendance à `fastods` via copie de code source | `com.github.jferard.fastods.*` dans `src/main/java/` | Mise à jour difficile |
| ?? Pas de tests unitaires visibles | Absence de `src/test/` dans larborescence fournie | Fiabilité de lanalyse |

> ?? *Remarque* : le fichier `.gitignore` exclut `src/main/javagen/*` ? code généré (probablement par Vertigo MDA)  bonne pratique.

---

## ?? Diagrammes complémentaires

### ?? Cycle de vie dun article

```plantuml
@startuml
hide empty description
[*] --> EnAttente : import BO/JORF
EnAttente --> Analysé : analyseOf()
Analysé --> [*] : création Admin + Mandat
EnAttente --> Erreur : exception
Erreur --> EnAttente : correction manuelle + relance
@enduml
```

---

### ?? Modèle de données simplifié (entités clés)

```plantuml
@startuml
entity ArticleAttente {
  * artiId : String
  --
  nor : String
  contenu : String
  url : String
}

entity Administrateur {
  * admId : Long
  --
  nom : String
  prenom : String
}

entity Mandat {
  * manId : Long
  --
  dateDébut : Date
  dateFin : Date
  typeMandat : String
}

entity Etablissement {
  * etaId : Long
  --
  etaDeLibelle : String
  sigle : String
}

entity ArticleIndex {
  * artiId : String
  --
  typeArticle : String
  datePublication : Date
}

ArticleAttente ||--o{ Administrateur : "extrait ?"
Administrateur ||--o{ Mandat : "1..*"
Mandat }o--|| Etablissement : "sur"
ArticleAttente ||--|| ArticleIndex : "réindexé ?"
@enduml
```

> ?? Ce MCD est *déduit* des noms de classes, champs (`etaDeLibelle`) et relations implicites  **pas de schéma SQL fourni**.

---

### ?? Hiérarchie des steps danalyse

```plantuml
@startuml
abstract class AbstractStepAnalyse {
  {abstract} process(ArticleAnalyser)
  needsArticle : boolean
}

abstract class AbstractPreStepAnalyseRecupererArticles {
  process(ArticleAnalyser)
}

PreStepAnalyseInitAnalyser --|> AbstractStepAnalyse
PreStepAnalyseListerCollegesEtSynonymes --|> AbstractStepAnalyse
PreStepAnalyseRecupererArticlesEP --|> AbstractPreStepAnalyseRecupererArticles
PreStepAnalyseRecupererArticlesAdmins --|> AbstractPreStepAnalyseRecupererArticles

StepAnalyseResetVariables --|> AbstractStepAnalyse
StepAnalyseRechercheCivilites --|> AbstractStepAnalyse
StepAnalyseRechercheColleges --|> AbstractStepAnalyse
StepAnalyseRechercheNominations --|> AbstractStepAnalyse
StepAnalyseTitulaireSuppleant --|> AbstractStepAnalyse
StepAnalyseVerifierAutresNominations --|> AbstractStepAnalyse
StepAnalyseAjoutInfosExtraitesAuxResultats --|> AbstractStepAnalyse

AbstractPreStepAnalyseRecupererArticles --|> AbstractStepAnalyse
@enduml
```

---

## ?? Arborescence clé (extraite)

```
adminep-web/
+-- src/main/
¦   +-- java/
¦   ¦   +-- fr/gouv/e2/baseadmin/
¦   ¦   ¦   +-- controller/          # Actions Struts
¦   ¦   ¦   +-- services/            # Services métier
¦   ¦   ¦   +-- domain/              # Entités
¦   ¦   ¦   +-- util/
¦   ¦   ¦       +-- articleanalyser/ # Cur de lIA métier
¦   ¦   ¦       +-- jorf/            # Import JORF
¦   ¦   ¦       +-- bulletin/        # Import BO
¦   ¦   ¦       +-- OdsUtil.java     # Export ODS
¦   ¦   +-- com/github/jferard/fastods/ # Copie locale
¦   +-- resources/
¦   ¦   +-- boot/
¦   ¦   ¦   +-- definitions/        # *.ksp ? génération DAO
¦   ¦   ¦   +-- components/         # Config Vertigo (core.xml, services.xml)
¦   ¦   ¦   +-- config/
¦   ¦   ¦       +-- elasticsearch.yml
¦   ¦   +-- struts.xml              # Routage Actions
¦   +-- webapp/
¦       +-- WEB-INF/
¦       ¦   +-- jsp/                # IHM (JSP)
¦       ¦   ¦   +-- etablissements/detailEP.jsp
¦       ¦   ¦   +-- admins/detailAdmin.jsp
¦       ¦   ¦   +-- supervision/supervision.jsp
¦       ¦   +-- applicationContext.xml
¦       ¦   +-- cerbere-filtre.xml  # Bouchon SSO
¦       ¦   +-- web.xml
¦       +-- static/
¦           +-- css/bootstrap*.css
¦           +-- js/bootstrap.js
¦           +-- wiki/               # Aide en ligne (HTML statique)
+-- pom.xml
```

---

## ?? Annexes

### A. Exemple de KSP (génération DAO)

Fichier `adminep-web/src/main/resources/boot/definitions/services/article/model.ksp` (982 octets) :

```text
domain DO_ARTI_ID {
  type : String
  maxLength : 20
}
DtDefinition ARTICLE {
  field ARTI_ID        { domain : DO_ARTI_ID         notNull : "true" }
  field CONTENU        { domain : DO_TEXTE          notNull : "true" }
  field URL            { domain : DO_LABEL_LONG     notNull : "false" }
  field TYPE_ARTICLE   { domain : DO_LABEL_SHORT    notNull : "false" }
}
```

? Utilisé par **Vertigo MDA** pour générer `ArticleDAO.java`, `ArticleDtDefinition.java`, etc.

---

### B. Extrait de supervision.jsp (workflow utilisateur)

> *Lien vers wiki intégré* :
> ```jsp
> <s:a href="%{wikiUrl}" target="_blank">Aide en ligne</s:a>
> ```
>
> *Bouton déclencheur analyse* :
> ```jsp
> <s:form action="analyseOfSupervision">
>   <s:submit value="Analyser les articles en attente" cssClass="btn btn-success"/>
> </s:form>
> ```

---

### C. Niveaux de logs (log4j2.xml)

```xml
<Configuration>
  <Appenders>
    <File name="fileAppender" fileName="../logs/adminep/baseadmin.log"/>
  </Appenders>
  <Loggers>
    <Root level="info">
      <AppenderRef ref="fileAppender"/>
    </Root>
  </Loggers>
</Configuration>
```

? Logs en `../logs/adminep/baseadmin.log` (relatif au serveur).

---

## ? Conclusion

**AdminEP** est une application métier mature, centrée sur **lextraction automatisée de données administratives** depuis des sources officielles (JORF/BO), avec :

- ? Une **logique danalyse** très structurée (pattern *Pipeline* via `ArticleAnalyser` + `Step`s).
- ? Une **stack technique cohérente** (Struts 2 + Vertigo), bien adaptée aux SI de lÉtat.
- ?? Des **dette technique maîtrisables** (credentials, JSP volumineux).
- ?? Un **fort couplage métier/technique** dans les *steps*, nécessitant une documentation rigoureuse (fournie via wiki embarqué).


````

</details>


---

### 📄 `si/ado.analysis.md` [0 octets]
<a id="si-ado-analysis-md"></a> [↩ Retour à l'arborescence](#tree-si-ado-analysis-md)

> **Chemin relatif** : `si/ado.analysis.md`  
> **Taille** : 0 octets  
> **Lignes** : 0  
> **Type** : markdown

```markdown

```


---

### 📄 `si/afinope.wiki.md` [5.056 octets]
<a id="si-afinope-wiki-md"></a> [↩ Retour à l'arborescence](#tree-si-afinope-wiki-md)

> **Chemin relatif** : `si/afinope.wiki.md`  
> **Taille** : 5.056 octets  
> **Lignes** : 211  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (211 lignes) - Cliquer pour déplier</summary>

`````markdown
﻿# Projet : afinope.wiki

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\afinope.wiki`

**Fichiers** : 3 fichiers non-binaires

## 📁 Arborescence des fichiers

├── **home/**
│   ├── **how_tos/**
│   │   └── <a id="tree-home-how_tos-Superset-en-local-md"></a>[Superset-en-local.md](#home-how_tos-Superset-en-local-md) *(149 octets)*
│   └── <a id="tree-home-how_tos-md"></a>[how_tos.md](#home-how_tos-md) *(26 octets)*
└── <a id="tree-home-md"></a>[home.md](#home-md) *(0 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `home/how_tos/Superset-en-local.md` [149 octets]
<a id="home-how_tos-Superset-en-local-md"></a> [↩ Retour à l'arborescence](#tree-home-how_tos-Superset-en-local-md)

> **Chemin relatif** : `home/how_tos/Superset-en-local.md`  
> **Taille** : 149 octets  
> **Lignes** : 5  
> **Type** : markdown

````markdown
```
git clone --depth=1  https://github.com/apache/superset.git
export TAG=4.0.2
docker compose -f docker-compose-image-tag.yml up --build -d
```
````


---

### 📄 `home/how_tos.md` [26 octets]
<a id="home-how_tos-md"></a> [↩ Retour à l'arborescence](#tree-home-how_tos-md)

> **Chemin relatif** : `home/how_tos.md`  
> **Taille** : 26 octets  
> **Lignes** : 4  
> **Type** : markdown

```markdown
---
title: How-Tos
---

```


---

### 📄 `home.md` [0 octets]
<a id="home-md"></a> [↩ Retour à l'arborescence](#tree-home-md)

> **Chemin relatif** : `home.md`  
> **Taille** : 0 octets  
> **Lignes** : 0  
> **Type** : markdown

```markdown

```


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

`````

</details>


---

### 📄 `si/agile-front.md` [119.391 octets]
<a id="si-agile-front-md"></a> [↩ Retour à l'arborescence](#tree-si-agile-front-md)

> **Chemin relatif** : `si/agile-front.md`  
> **Taille** : 119.391 octets  
> **Lignes** : 4113  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (4113 lignes) - Cliquer pour déplier</summary>

`````markdown
﻿# Projet : agile-front

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\agile-front`

**Fichiers** : 20 fichiers non-binaires

## 📁 Arborescence des fichiers

├── **public/**
│   └── <a id="tree-public-index-html"></a>[index.html](#public-index-html) *(728 octets)*
├── **src/**
│   ├── **components/**
│   │   ├── <a id="tree-src-components-ConfirmationDialog-vue"></a>[ConfirmationDialog.vue](#src-components-ConfirmationDialog-vue) *(1.105 octets)*
│   │   ├── <a id="tree-src-components-EtudesExportPanel-vue"></a>[EtudesExportPanel.vue](#src-components-EtudesExportPanel-vue) *(16.420 octets)*
│   │   ├── <a id="tree-src-components-EtudesList-vue"></a>[EtudesList.vue](#src-components-EtudesList-vue) *(10.749 octets)*
│   │   └── <a id="tree-src-components-FinancementsList-vue"></a>[FinancementsList.vue](#src-components-FinancementsList-vue) *(15.100 octets)*
│   ├── **views/**
│   │   ├── <a id="tree-src-views-Assistance-vue"></a>[Assistance.vue](#src-views-Assistance-vue) *(6.058 octets)*
│   │   ├── <a id="tree-src-views-Etude-vue"></a>[Etude.vue](#src-views-Etude-vue) *(8.425 octets)*
│   │   ├── <a id="tree-src-views-EtudeEdit-vue"></a>[EtudeEdit.vue](#src-views-EtudeEdit-vue) *(9.851 octets)*
│   │   ├── <a id="tree-src-views-EtudeNew-vue"></a>[EtudeNew.vue](#src-views-EtudeNew-vue) *(9.890 octets)*
│   │   ├── <a id="tree-src-views-Home-vue"></a>[Home.vue](#src-views-Home-vue) *(1.290 octets)*
│   │   ├── <a id="tree-src-views-Liens-vue"></a>[Liens.vue](#src-views-Liens-vue) *(11.705 octets)*
│   │   ├── <a id="tree-src-views-Login-vue"></a>[Login.vue](#src-views-Login-vue) *(893 octets)*
│   │   ├── <a id="tree-src-views-Statistiques-vue"></a>[Statistiques.vue](#src-views-Statistiques-vue) *(1.488 octets)*
│   │   ├── <a id="tree-src-views-Tutoriels-vue"></a>[Tutoriels.vue](#src-views-Tutoriels-vue) *(844 octets)*
│   │   └── <a id="tree-src-views-Videos-vue"></a>[Videos.vue](#src-views-Videos-vue) *(1.415 octets)*
│   └── <a id="tree-src-App-vue"></a>[App.vue](#src-App-vue) *(8.689 octets)*
├── <a id="tree--browserslistrc"></a>[.browserslistrc](#-browserslistrc) *(21 octets)*
├── <a id="tree--env-sample"></a>[.env.sample](#-env-sample) *(21 octets)*
├── <a id="tree--gitignore"></a>[.gitignore](#-gitignore) *(220 octets)*
└── <a id="tree-README-md"></a>[README.md](#README-md) *(198 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `.browserslistrc` [21 octets]
<a id="-browserslistrc"></a> [↩ Retour à l'arborescence](#tree--browserslistrc)

> **Chemin relatif** : `.browserslistrc`  
> **Taille** : 21 octets  
> **Lignes** : 3  
> **Type** : text

```text
> 1%
last 2 versions

```


---

### 📄 `.env.sample` [21 octets]
<a id="-env-sample"></a> [↩ Retour à l'arborescence](#tree--env-sample)

> **Chemin relatif** : `.env.sample`  
> **Taille** : 21 octets  
> **Lignes** : 1  
> **Type** : text

```text
VUE_APP_API_BASE_URL=
```


---

### 📄 `.gitignore` [220 octets]
<a id="-gitignore"></a> [↩ Retour à l'arborescence](#tree--gitignore)

> **Chemin relatif** : `.gitignore`  
> **Taille** : 220 octets  
> **Lignes** : 23  
> **Type** : text

```text
.DS_Store
node_modules
/dist

# local env files
.env.local
.env.*.local
/.env

# Log files
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# Editor directories and files
.idea
.vscode
*.suo
*.ntvs*
*.njsproj
*.sln
*.sw?

```


---

### 📄 `public/index.html` [728 octets]
<a id="public-index-html"></a> [↩ Retour à l'arborescence](#tree-public-index-html)

> **Chemin relatif** : `public/index.html`  
> **Taille** : 728 octets  
> **Lignes** : 22  
> **Type** : html

```html
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <link rel="icon" href="<%= BASE_URL %>favicon.ico" />
  <title>Agile</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@latest/css/materialdesignicons.min.css" />
</head>

<body>
  <noscript>
    <strong>Agile ne peut pas fonctionner sans JavaScript. Merci de l'activer pour continuer.</strong>
  </noscript>
  <div id="app"></div>
  <!-- built files will be auto injected -->
</body>

</html>
```


---

### 📄 `README.md` [198 octets]
<a id="README-md"></a> [↩ Retour à l'arborescence](#tree-README-md)

> **Chemin relatif** : `README.md`  
> **Taille** : 198 octets  
> **Lignes** : 22  
> **Type** : markdown

````markdown
# Agile

Publié sur "/beta/"

## Project setup

```
yarn install
```

### Compiles and hot-reloads for development

```
yarn serve
```

### Compiles and minifies for production

```
yarn build
```

````


---

### 📄 `src/App.vue` [8.689 octets]
<a id="src-App-vue"></a> [↩ Retour à l'arborescence](#tree-src-App-vue)

> **Chemin relatif** : `src/App.vue`  
> **Taille** : 8.689 octets  
> **Lignes** : 270  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (270 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <v-app>
    <v-navigation-drawer app clipped v-model="drawer">
      <v-list dense nav>
        <v-list-item link to="/thematique">
          <v-list-item-action>
            <v-icon>mdi-shape</v-icon>
          </v-list-item-action>
          <v-list-item-content>
            <v-list-item-title>Affichage Thématique</v-list-item-title>
          </v-list-item-content>
        </v-list-item>
        <v-list-item link to="/budgetaire">
          <v-list-item-action>
            <v-icon>mdi-calculator</v-icon>
          </v-list-item-action>
          <v-list-item-content>
            <v-list-item-title>Affichage Budgétaire</v-list-item-title>
          </v-list-item-content>
        </v-list-item>
        <!-- <v-list-item link to="/statistiques">
          <v-list-item-action>
            <v-icon>mdi-view-dashboard</v-icon>
          </v-list-item-action>
          <v-list-item-content>
            <v-list-item-title>Tableau de bord</v-list-item-title>
          </v-list-item-content>
        </v-list-item>-->
      </v-list>
      <v-divider dark class="my-4" v-if="isAdmin" />
      <v-list dense nav v-if="isAdmin">
        <v-list-item link :href="baseUrl + '/admin'" target="_blank">
          <v-list-item-action>
            <v-icon>mdi-account-settings</v-icon>
          </v-list-item-action>
          <v-list-item-content>
            <v-list-item-title>
              Administration
              <v-icon dense small right>mdi-open-in-new</v-icon>
            </v-list-item-title>
          </v-list-item-content>
        </v-list-item>
      </v-list>
      <v-divider dark class="my-4" />
      <v-list dense nav>
        <v-list-item link to="/liens/">
          <v-list-item-action>
            <v-icon>mdi-link</v-icon>
          </v-list-item-action>
          <v-list-item-content>
            <v-list-item-title>Liens</v-list-item-title>
          </v-list-item-content>
        </v-list-item>
        <v-divider dark class="my-4" />
        <v-list-item
          link
          href="http://intra.dreal-normandie.e2.rie.gouv.fr/IMG/odp/utiliseragilev40.odp"
          target="_blank"
        >
          <v-list-item-action>
            <v-icon>mdi-help-circle-outline</v-icon>
          </v-list-item-action>
          <v-list-item-content>
            <v-list-item-title>
              Guide utilisateur
              <v-icon dense small right>mdi-open-in-new</v-icon>
            </v-list-item-title>
          </v-list-item-content>
        </v-list-item>
        <v-list-item link to="/tutoriels/">
          <v-list-item-action>
            <v-icon>mdi-filmstrip</v-icon>
          </v-list-item-action>
          <v-list-item-content>
            <v-list-item-title>Tutoriels</v-list-item-title>
          </v-list-item-content>
        </v-list-item>        
        <v-list-item link to="/videos/">
          <v-list-item-action>
            <v-icon>mdi-file-video</v-icon>
          </v-list-item-action>
          <v-list-item-content>
            <v-list-item-title>Vidéos: l'avis des usagers</v-list-item-title>
          </v-list-item-content>
        </v-list-item>
        <v-list-item
          link
          href="http://intra.dreal-normandie.e2.rie.gouv.fr/agile-r3331.html"
          target="_blank"
        >
          <v-list-item-action>
            <v-icon>mdi-bookshelf</v-icon>
          </v-list-item-action>
          <v-list-item-content>
            <v-list-item-title>
              Tout savoir sur agile
              <v-icon dense small right>mdi-open-in-new</v-icon>
            </v-list-item-title>
          </v-list-item-content>
        </v-list-item>
        <v-list-item link to="/assistance/">
          <v-list-item-action>
            <v-icon>mdi-headset</v-icon>
          </v-list-item-action>
          <v-list-item-content>
            <v-list-item-title>Assistance</v-list-item-title>
          </v-list-item-content>
        </v-list-item>
      </v-list>
    </v-navigation-drawer>
    <v-app-bar app dense dark clipped-left>
      <v-app-bar-nav-icon @click.stop="drawer = !drawer" />
      <v-toolbar-title
        ><img :src="publicPath + 'img/agile.png'"
      /></v-toolbar-title>
      <v-spacer></v-spacer>
      <v-toolbar-items>
        <v-btn text @click="create" v-if="isConnected && !isCreatingNew">
          <v-icon class="mx-1">mdi-plus-circle-outline</v-icon>
          <span class="hidden-sm-and-down">Ajouter une fiche</span>
        </v-btn>
        <v-divider
          class="mx-4"
          vertical
          v-if="isConnected && !isCreatingNew"
        ></v-divider>
        <v-overflow-btn
          style="min-width:270px"
          :items="perimetre"
          item-text="libelle"
          item-value="token"
          label="CHOIX RÉGION / PÉRIMÈTRE"
          hide-details
          class="pa-0 mb-0 mt-0"
          height="48"
          overflow
          allow-overflow
          @change="filtrer()"
          v-model="perimetreActif"
          flat
        ></v-overflow-btn>
        <v-divider class="mx-4" vertical></v-divider>
        <v-btn
          text
          :href="baseUrl + '/cas/connexionCAS.php'"
          v-if="!isConnected"
          ><v-icon class="mx-1">mdi-login</v-icon
          ><span class="hidden-sm-and-down">Se connecter</span></v-btn
        >
        <v-btn
          text
          :href="baseUrl + '/cas/connexionCAS.php?logout'"
          v-if="isConnected"
          ><v-icon class="mx-1">mdi-logout</v-icon
          ><span class="hidden-sm-and-down">Se déconnecter</span></v-btn
        >
      </v-toolbar-items>
    </v-app-bar>
    <router-view></router-view>
    <v-footer color="primary lighten-1" app>
      <v-layout justify-center wrap>
        <v-spacer></v-spacer>

        <v-btn-toggle
          group
          v-model="statutActif"
          borderless
          class="primary lighten-1"
          @change="filtrer()"
        >
          <span
            v-for="(currentStatus, index) in status"
            :key="currentStatus.key"
            :value="currentStatus.key"
          >
            <v-btn
              class="my-0 mx-0 white--text"
              small
              text
              :value="currentStatus.key"
            >
              <span v-if="currentStatus.key !== 'toutes'"
                >{{ index + 1 }} - </span
              >{{ currentStatus.label }}
              <v-chip
                v-if="currentStatus.icon"
                small
                :color="currentStatus.color"
                label
                class="black--text ml-2"
                :class="{ 'white--text': currentStatus.key === 'toutes' }"
              >
                <v-icon small>{{ currentStatus.icon }}</v-icon>
              </v-chip>
            </v-btn>
            <v-icon
              small
              class="white--text"
              v-if="
                currentStatus.key !== 'toutes' &&
                  currentStatus.key !== 'abandonnee'
              "
              >mdi-arrow-right-thick</v-icon
            >
          </span>
        </v-btn-toggle>
        <v-spacer></v-spacer>
      </v-layout>
    </v-footer>
  </v-app>
</template>

<script>
import { mapGetters, mapState } from "vuex";

export default {
  name: "App",
  data() {
    return {
      publicPath: process.env.BASE_URL,
      drawer: false,
      perimetreActif: undefined,
      statutActif: undefined,
      baseUrl: process.env.VUE_APP_API_BASE_URL,
    };
  },
  created() {
    this.$store.dispatch("security/fetchSubject");
  },
  methods: {
    filtrer: function() {
      let statut = this.statutActif === "toutes" ? undefined : this.statutActif;
      let perimetre =
        this.perimetreActif === "Tous" ? undefined : this.perimetreActif;
      this.$store.dispatch("studies/filterByPerimeter", perimetre);
      this.$store.dispatch("studies/filterByStatus", statut);
    },
    create: function() {
      this.$router.push(this.basePath + "new");
    },
  },
  computed: {
    affichage: function() {
      return this.$route.params.affichage === "budgetaire"
        ? "budgetaire"
        : "thematique";
    },
    basePath: function() {
      return (
        "/" +
        (this.$route.params.affichage ? this.$route.params.affichage + "/" : "")
      );
    },
    isCreatingNew: function() {
      return this.$route.path.indexOf("new") !== -1 ||
        this.$route.path.indexOf("edit") !== -1
        ? true
        : false;
    },
    ...mapGetters("security", ["isConnected", "isAdmin"]),
    ...mapState("studies", ["status", "perimetre"]),
  },
};
</script>
<style>
.v-autocomplete.v-input > .v-input__control > .v-input__slot {
  cursor: pointer;
}
</style>

```

</details>


---

### 📄 `src/components/ConfirmationDialog.vue` [1.105 octets]
<a id="src-components-ConfirmationDialog-vue"></a> [↩ Retour à l'arborescence](#tree-src-components-ConfirmationDialog-vue)

> **Chemin relatif** : `src/components/ConfirmationDialog.vue`  
> **Taille** : 1.105 octets  
> **Lignes** : 45  
> **Type** : text

```text
<template>
  <div>
    <v-dialog v-model="active" persistent max-width="400">
      <v-card>
        <v-card-title class="headline">Modification en cours</v-card-title>
        <v-card-text>
          Voulez-vous vraiment quitter la modification en cours ? Vos
          changements seront perdus.
        </v-card-text>
        <v-card-actions>
          <v-btn color="grey darken-1" text @click="abort()">Annuler</v-btn>
          <v-spacer></v-spacer>
          <v-btn color="secondary darken-1" @click="confirm()">Quitter</v-btn>
        </v-card-actions>
      </v-card>
    </v-dialog>
  </div>
</template>

<script>
export default {
  data() {
    return { active: false, resolve: function() {} };
  },
  methods: {
    pop() {
      this.active = true;
      return new Promise((resolve, reject) => {
        this.resolve = resolve;
      });
    },
    confirm() {
      this.active = false;
      this.resolve(true);
    },
    abort() {
      this.active = false;
      this.resolve(false);
    }
  }
};
</script>

<style lang="scss" scoped></style>

```


---

### 📄 `src/components/EtudesExportPanel.vue` [16.420 octets]
<a id="src-components-EtudesExportPanel-vue"></a> [↩ Retour à l'arborescence](#tree-src-components-EtudesExportPanel-vue)

> **Chemin relatif** : `src/components/EtudesExportPanel.vue`  
> **Taille** : 16.420 octets  
> **Lignes** : 585  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (585 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <v-dialog
    v-model="displayExport"
    fullscreen
    persistent
    hide-overlay
    transition="dialog-bottom-transition"
  >
    <v-card>
      <v-toolbar>
        <v-checkbox
          dense
          v-model="checkAll"
          :label="isAllChecked ? 'Tout décocher' : 'Tout cocher'"
          hide-details
        ></v-checkbox>
        <v-spacer />
        <v-toolbar-items>
          <v-btn color="accent" @click="exporter">
            Exporter
          </v-btn>
          <v-btn text icon @click="close">
            <v-icon>mdi-close</v-icon>
          </v-btn>
        </v-toolbar-items>
      </v-toolbar>
      <v-card-text>
        <v-row>
          <v-col>
            <v-tabs
              v-model="exportTab"
              background-color="transparent"
              grow
              show-arrows
            >
              <v-tab
                v-for="exportField in exportFields"
                :key="exportField.section"
                >{{ exportField.section }}</v-tab
              >
            </v-tabs>
            <v-tabs-items v-model="exportTab">
              <v-tab-item
                v-for="exportField in exportFields"
                :key="exportField.section"
                :class="{ tabItemHeight: $vuetify.breakpoint.mdAndUp }"
              >
                <div class="">
                  <v-checkbox
                    dense
                    v-for="field in exportField.fields"
                    :key="field.name"
                    v-model="field.selected"
                    :label="field.label"
                    hide-details
                  ></v-checkbox>
                </div>
              </v-tab-item>
            </v-tabs-items>
          </v-col>
        </v-row>
      </v-card-text>
    </v-card>
  </v-dialog>
</template>

<script>
export default {
  props: {
    filtres: {
      type: Object
    },
    displayExport: {
      type: Boolean,
      default: false
    }
  },
  data() {
    return {
      exportTab: null,
      isAllChecked: false,
      exportFields: [
        {
          section: "Présentation",
          fields: [
            {
              name: "groupe",
              label: "Perimètre",
              selected: false
            },
            {
              name: "titre_etude",
              label: "Titre de l'étude",
              selected: false
            },
            {
              name: "ru",
              label: "N° de fiche AGILE",
              selected: false
            },
            {
              name: "num_pre_prog_ou_contrat",
              label: "N° partenaire",
              selected: false
            },
            {
              name: "annee",
              label: "Année",
              selected: false
            },
            {
              name: "maj",
              label: "Date MAJ",
              selected: false
            },
            {
              name: "theme",
              label: "Thème",
              selected: false
            },
            {
              name: "type",
              label: "Type de prestation",
              selected: false
            },
            {
              name: "zone_geographique",
              label: "Territoire étudié",
              selected: false
            },
            {
              name: "resume",
              label: "Résumé de l'étude",
              selected: false
            },
            {
              name: "lien_autre",
              label: "Lien",
              selected: false
            },
            {
              name: "nombre_phases",
              label: "Nombre de phases",
              selected: false
            },
            {
              name: "lien_autre_etude",
              label: "Autre N° Fiche",
              selected: false
            },
            {
              name: "journal",
              label: "Le journal",
              selected: false
            },
            {
              name: "date_creation_fiche",
              label: "Date de création fiche",
              selected: false
            },
            {
              name: "nomfichieretude",
              label: "Pièce jointe 1",
              selected: false
            },
            {
              name: "annexeetude",
              label: "Pièce jointe 2",
              selected: false
            },
            {
              name: "annexe2etude",
              label: "Pièce jointe 3",
              selected: false
            }
          ]
        },
        {
          section: "Objectif",
          fields: [
            {
              name: "date_debut_prevision",
              label: "Date de début prévisionnelle",
              selected: false
            },
            {
              name: "date_fin_prev",
              label: "Date de fin prévisionnelle",
              selected: false
            },
            {
              name: "probleme_a_resoudre",
              label: "Le problème à résoudre",
              selected: false
            },
            {
              name: "resultat_description",
              label: "Les résultat attendus",
              selected: false
            },
            {
              name: "resultat_utilisation",
              label: "L'utilisation des résultats",
              selected: false
            },
            {
              name: "methode",
              label: "La méthode",
              selected: false
            }
          ]
        },
        {
          section: "Contacts",
          fields: [
            {
              name: "service",
              label: "Direction",
              selected: false
            },
            {
              name: "pilotage_moa",
              label: "Pilote/MOA",
              selected: false
            },
            {
              name: "contact_pilotage",
              label: "Contact/MOA",
              selected: false
            },
            {
              name: "courriel_contact",
              label: "Courriel pilote 1",
              selected: false
            },
            {
              name: "courriel_contact2",
              label: "Courriel pilote 2",
              selected: false
            },            
            {
              name: "realisation_moe",
              label: "Prestataire/MOE",
              selected: false
            },
            {
              name: "contact_moe",
              label: "Contact/MOE",
              selected: false
            },
            {
              name: "courriel_moe",
              label: "Courriel prestataire 1",
              selected: false
            },
            {
              name: "courriel_moe2",
              label: "Courriel prestataire 2",
              selected: false
            }            
          ]
        },
        {
          section: "Budget",
          fields: [
            {
              name: "priorite",
              label: "Priorité demandeur",
              selected: false
            },
            {
              name: "enjeux_specifique",
              label: "Enjeu spécifique 1",
              selected: false
            },
            {
              name: "enjeux_specifique2",
              label: "Enjeu spécifique 2",
              selected: false
            },
            {
              name: "priorite_gouvernance",
              label: "Priorité gouvernance",
              selected: false
            },
            {
              name: "priorite_partenaire",
              label: "Priorité partenaire",
              selected: false
            },
            {
              name: "sous_actions.sigle",
              label: "Budget",
              selected: false
            },
            {
              name: "financement.demandese",
              label: "Montant demandé €",
              selected: false
            },
            {
              name: "financement.date_comite",
              label: "Date comité",
              selected: false
            },
            {
              name: "financement.aee",
              label: "Montant autorisé €",
              selected: false
            },
            {
              name: "financement.cp_e",
              label: "CP €",
              selected: false
            },
            {
              name: "financement.motif_comite",
              label: "Commentaire",
              selected: false
            },
            {
              name: "etudes.avis",
              label: "Avis comité",
              selected: false
            },
            {
              name: "etudes.total_ae",
              label: "Total des autorisations €",
              selected: false
            }
          ]
        },
        {
          section: "Progression",
          fields: [
            {
              name: "date_debut",
              label: "Date de début",
              selected: false
            },
            {
              name: "avancement",
              label: "Progression",
              selected: false
            },
            {
              name: "date_fin",
              label: "Date de fin réelle",
              selected: false
            },
            {
              name: "etat_etude",
              label: "Etat d'avancement",
              selected: false
            }
          ]
        },
        {
          section: "Résultat",
          fields: [
            {
              name: "action_valorisation",
              label: "Actions de valorisation",
              selected: false
            },
            {
              name: "lien_internet",
              label: "Valorisation/lien",
              selected: false
            },
            {
              name: "lien_internet2",
              label: "Valorisation/lien 2",
              selected: false
            },
            {
              name: "acces",
              label: "Accès à l'étude",
              selected: false
            },
            {
              name: "nomfichier",
              label: "Pièce jointe 1",
              selected: false
            },
            {
              name: "annexevalorisation",
              label: "Pièce jointe 2",
              selected: false
            },
            {
              name: "annexe2valorisation",
              label: "Pièce jointe 3",
              selected: false
            }
          ]
        },
        {
          section: "Évaluation",
          fields: [
            {
              name: "retexEmail",
              label: "Courriel du rédacteur de l'évaluation",
              selected: false
            },
            {
              name: "retexQ1",
              label: "Cette étude a-t-elle eu les effets escomptés ? 	",
              selected: false
            },
            {
              name: "retexQ1C",
              label:
                "Commentaire - Cette étude a-t-elle eu les effets escomptés ? 	",
              selected: false
            },
            {
              name: "retexQ2",
              label:
                "Avec le recul, cette étude a-t-elle bien pris en compte le problème, le contexte ?",
              selected: false
            },
            {
              name: "retexQ2C",
              label:
                "Commentaire - Avec le recul, cette étude a-t-elle bien pris en compte le problème, le contexte ?",
              selected: false
            },
            {
              name: "retexQ3",
              label:
                "Les moyens (financier, humains, techniques) ont ils été suffisants pour atteindre l’objectif ?",
              selected: false
            },
            {
              name: "retexQ3C",
              label:
                "Commentaire - Les moyens (financier, humains, techniques) ont ils été suffisants pour atteindre l’objectif ?",
              selected: false
            },
            {
              name: "retexQ4",
              label:
                "Cette étude peut-elle être utile ou permettre une évaluation d’une politique publique sur le territoire étudié et laquelle ?",
              selected: false
            },
            {
              name: "retexQ4C",
              label:
                "Commentaire - Cette étude peut-elle être utile ou permettre une évaluation d’une politique publique sur le territoire étudié et laquelle ?",
              selected: false
            },
            {
              name: "retexQ5",
              label: "Êtes-vous satisfait de la prestation obtenue ?",
              selected: false
            },
            {
              name: "retexQ5C",
              label:
                "Commentaire - Êtes-vous satisfait de la prestation obtenue ?",
              selected: false
            },
            {
              name: "retexQ6",
              label:
                "Les résultats nécessitent-ils d’être actualisés régulièrement ?",
              selected: false
            },
            {
              name: "retexQ6C",
              label:
                "Commentaire - Les résultats nécessitent-ils d’être actualisés régulièrement ?",
              selected: false
            },
            {
              name: "retexEtude",
              label: "Si cette étude était à refaire",
              selected: false
            },
            {
              name: "retexPourquoi",
              label: "Et pourquoi",
              selected: false
            }
          ]
        },
        {
          section: "Abandon",
          fields: [
            {
              name: "abandon",
              label: "Abandon",
              selected: false
            },
            {
              name: "motif_abandon",
              label: "Motif d'abandon",
              selected: false
            },
            {
              name: "nomfichierabandon1",
              label: "Pièce jointe 1",
              selected: false
            },
            {
              name: "nomfichierabandon2",
              label: "Pièce jointe 2",
              selected: false
            },
            {
              name: "nomfichierabandon3",
              label: "Pièce jointe 3",
              selected: false
            },
            {
              name: "lien_abandon",
              label: "Lien",
              selected: false
            }
          ]
        }
      ]
    };
  },
  methods: {
    exporter: function() {
      this.$store.dispatch("studies/fetchExport", {
        filtres: this.filtres,
        page: this.page,
        fieldList: this.exportFieldList
      });
      this.$emit("closed", true);
    },
    close() {
      this.$emit("closed", true);
    }
  },
  computed: {
    exportFieldList: function() {
      return this.exportFields
        .reduce((acc, current) => {
          current.fields.forEach(field => {
            if (field.selected) {
              acc.push(field.name);
            }
          });
          return acc;
        }, [])
        .join(",");
    },
    checkAll: {
      get: function() {
        return this.isAllChecked;
      },
      set: function(value) {
        if (value) {
          this.exportFields.forEach(function(section) {
            section.fields.forEach(function(field) {
              field.selected = true;
            });
          });
          // this.isAllChecked = false
        } else {
          this.exportFields.forEach(function(section) {
            section.fields.forEach(function(field) {
              field.selected = false;
            });
          });
          // this.isAllChecked = true
        }
        this.isAllChecked = value;
      }
    }
  }
};
</script>

<style>
.tabItemHeight {
  /* height: calc(100vh - 366px); */
  /* overflow: auto; */
}
</style>

```

</details>


---

### 📄 `src/components/EtudesList.vue` [10.749 octets]
<a id="src-components-EtudesList-vue"></a> [↩ Retour à l'arborescence](#tree-src-components-EtudesList-vue)

> **Chemin relatif** : `src/components/EtudesList.vue`  
> **Taille** : 10.749 octets  
> **Lignes** : 374  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (374 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <v-card tile>
    <v-toolbar dense elevation="1">
      <v-toolbar-title>Tableau récapitulatif</v-toolbar-title>
      <v-spacer />
      <v-toolbar-items>
        <v-btn text @click="displayExport = true">
          <span v-if="this.$vuetify.breakpoint.mdAndUp">Exporter</span>
          <v-icon>mdi-file-export</v-icon>
        </v-btn>
        <v-btn
          text
          @click="displayFilter = !displayFilter"
          :class="{ 'grey lighten-2': displayFilter }"
        >
          <v-badge
            color="accent"
            overlap
            bottom
            offset-x="3"
            :content="nombreFiltres"
            :value="nombreFiltres"
          >
            <span v-if="this.$vuetify.breakpoint.mdAndUp">Filtrer</span>
            <v-icon>mdi-filter-variant</v-icon>
          </v-badge>
        </v-btn>
      </v-toolbar-items>
    </v-toolbar>
    <v-card-text class="my-0 py-0">
      <v-row>
        <v-col
          :sm="displayFilter ? 9 : 12"
          :md="displayFilter ? 10 : 12"
          class=".no-bottom-padding"
        >
          <EtudesExportPanel
            :filtres="filtres"
            :displayExport="displayExport"
            :class="{
              tableDesktopLayout: this.$vuetify.breakpoint.mdAndUp
            }"
            @closed="closeExport"
          />
          <v-data-table
            fixed-header
            :headers="headers"
            :items="studies"
            :server-items-length="studiesTotalCount"
            :footer-props="{
              'items-per-page-options': [100]
            }"
            :items-per-page="100"
            :page="page"
            @update:page="updatePage($event)"
            disableSort
            group-by="theme"
            @click:row="etude($event)"
            :class="{
              tableDesktopLayout: this.$vuetify.breakpoint.mdAndUp
            }"
            :height="
              this.$vuetify.breakpoint.mdAndUp ? 'calc(100vh - 216px)' : ''
            "
            single-selected
            v-model="selected"
            :loading="tableLoading"
            dense
          >
            <template v-slot:group.header="{ group, headers, groupBy, items }">
              <td :colspan="headers.length" class="secondary white--text">
                <v-container fluid class="py-0">
                  <v-row dense>
                    <v-col cols="6">
                      <span>Thème : {{ group }}</span>
                    </v-col>
                    <v-col></v-col>
                    <v-col class="d-flex justify-end">
                      <span>Nombre Fiches : {{ items.length }}</span>
                    </v-col>
                  </v-row>
                </v-container>
              </td>
            </template>
            <template v-slot:item.etat_etude="{ item }">
              <v-chip
                :value="getStatus(item.etat_etude).key"
                x-small
                :color="getStatus(item.etat_etude).color"
                label
                class="black--text"
                :class="{
                  'white--text': getStatus(item.etat_etude).key === 'toutes'
                }"
              >
                <v-icon small>{{ getStatus(item.etat_etude).icon }}</v-icon>
              </v-chip>
            </template>
          </v-data-table>
        </v-col>
        <v-col xs="12" sm="3" md="2" :class="{ 'd-none': !displayFilter }">
          <v-sheet
            tile
            class="filtres"
            :class="{
              tableDesktopLayout: this.$vuetify.breakpoint.mdAndUp
            }"
          >
            <v-form>
              <v-select
                :items="annees"
                v-model="filtres.annee"
                item-text="label"
                item-value="key"
                label="Année"
                dense
                class="mr-2 mt-5"
                @change="filtrer()"
              ></v-select>
              <v-select
                :items="bops"
                v-model="filtres.bop"
                label="Gestionnaire BOP"
                dense
                multiple
                chips
                class="mr-2 mt-0 pt-0"
                @change="filtrer()"
              ></v-select>
              <v-text-field
                label="Direction"
                v-model="filtres.direction"
                dense
                class="mr-2 mt-0 pt-0"
                @change="filtrer()"
              />
              <v-text-field
                label="Pilote"
                v-model="filtres.pilote"
                dense
                class="mr-2 mt-0 pt-0"
                @change="filtrer()"
              />
              <v-select
                :items="themes"
                v-model="filtres.theme"
                label="Thématiques"
                dense
                multiple
                chips
                class="mr-2 mt-0 pt-0"
                @change="filtrer()"
              ></v-select>
              <v-text-field
                label="Titre"
                v-model="filtres.titre"
                dense
                class="mr-2 mt-0 pt-0"
                @change="filtrer()"
              />
              <v-select
                :items="types"
                :key="id"
                item-text="type"
                item-value="type"
                v-model="filtres.type"
                label="Type de prestation"
                dense
                multiple
                chips
                class="mr-2 mt-0 pt-0"
                @change="filtrer()"
              ></v-select>
              <v-text-field
                label="N° de fiche AGILE"
                v-model="filtres.ru"
                dense
                class="mr-2 mt-0 pt-0"
                @change="filtrer()"
              />
              <v-text-field
                label="N° partenaire"
                v-model="filtres.suivi"
                dense
                class="mr-2 mt-0 pt-0"
                @change="filtrer()"
              />
              <v-text-field
                label="enjeux spécifique 1"
                v-model="filtres.enjeux_specifique"
                dense
                class="mr-2 mt-0 pt-0"
                @change="filtrer()"
              />
              <v-text-field
                label="Priorité demandeur"
                v-model="filtres.priorite"
                dense
                class="mr-2 mt-0 pt-0"
                @change="filtrer()"
              />
              <v-text-field
                label="Prestataire"
                v-model="filtres.realisation_moe"
                dense
                class="mr-2 mt-0 pt-0"
                @change="filtrer()"
              />
            </v-form>
          </v-sheet>
        </v-col>
      </v-row>
    </v-card-text>
  </v-card>
</template>

<script>
import { mapState, mapGetters } from "vuex";
import { filterUtilMixin } from "../mixins/filterUtilMixin.js";
import EtudesExportPanel from "@/components/EtudesExportPanel.vue";

export default {
  name: "EtudesListPage",
  mixins: [filterUtilMixin],
  data() {
    return {
      tableLoading: false,
      globalHeader: "Global data",
      headers: [
        { text: "", value: "etat_etude", sortable: false, width: "1%" },
        { text: "N° Fiche", value: "id" },
        {
          text: "Titre",
          align: "left",
          sortable: false,
          value: "titre_etude"
        },

        { text: "Type", value: "type" },
        { text: "Territoire", value: "zone_geographique" },
        { text: "Année", value: "annee" },
        { text: "Direction", value: "service" },
        { text: "Pilotage", value: "pilotage_moa" },
        { text: "Prestataire", value: "realisation_moe" }
      ],
      displayFilter: true,
      displayExport: false,
      page: 1
    };
  },
  created() {
    this.$store.dispatch("studies/fetchStudies", {
      filtres: this.filtres,
      page: this.page
    });
  },
  methods: {
    etude: function(item) {
      this.$router.push(
        "/" +
          (this.$route.params.affichage
            ? this.$route.params.affichage + "/"
            : "") +
          item.id
      );
    },
    filtrer: function() {
      this.$store.dispatch("studies/fetchStudies", {
        filtres: this.filtres,
        page: this.page
      });
    },
    closeExport: function() {
      this.displayExport = false;
    },
    updatePage: async function(page) {
      this.tableLoading = !this.tableLoading;
      this.page = page;
      await this.$store.dispatch("studies/fetchStudies", {
        filtres: this.filtres,
        page: this.page
      });
      this.tableLoading = !this.tableLoading;
    },
    getStatus: function(requestedStatus) {
      let filteredStatus = this.status.filter(currentStatus => {
        return currentStatus.key === requestedStatus;
      });
      return filteredStatus[0];
    }
  },
  computed: {
    ...mapState("studies", [
      "studies",
      "studiesTotalCount",
      "globalFilters",
      "affichages",
      "bops",
      "themes",
      "types",
      "globalFilters",
      "status",
      "updateListComponent"
    ]),
    ...mapState("security", ["subject"]),
    ...mapGetters("security", ["isConnected"]),
    id: function() {
      return this.$route.params.id;
    },
    selected: {
      get() {
        return [{ id: this.id }];
      },
      set(selectedId) {
        selectedId;
      }
    }
  },
  watch: {
    globalFilters() {
      this.$store.dispatch("studies/fetchStudies", {
        filtres: this.filtres,
        page: this.page
      });
    },
    updateListComponent() {
      this.$store.dispatch("studies/fetchStudies", {
        filtres: this.filtres,
        page: this.page
      });
    }
  },
  components: {
    EtudesExportPanel
  }
};
</script>

<style>
.tableDesktopLayout {
  height: calc(100vh - 178px);
  overflow: auto;
}
.studyDesktopLayout {
  height: calc(100vh - 154px);
  overflow: auto;
}
.no-bottom-padding {
  padding-bottom: 0px !important;
  padding-top: 6px !important;
}

.v-data-table__selected {
  background-color: #7fc6a4 !important;
}

.v-data-table td,
.v-data-table th {
  padding: 0 8px;
}

.filtres .v-label {
  font-size: 0.825rem;
}

.filtres .v-input {
  font-size: 0.825rem;
}

.filtres .v-chip__content {
  font-size: 0.825rem;
}
</style>

```

</details>


---

### 📄 `src/components/FinancementsList.vue` [15.100 octets]
<a id="src-components-FinancementsList-vue"></a> [↩ Retour à l'arborescence](#tree-src-components-FinancementsList-vue)

> **Chemin relatif** : `src/components/FinancementsList.vue`  
> **Taille** : 15.100 octets  
> **Lignes** : 439  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (439 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <v-card tile>
    <v-toolbar dense elevation="1">
      <v-toolbar-title>Tableau récapitulatif</v-toolbar-title>
      <v-spacer />
      <v-toolbar-items>
        <v-btn
          text
          @click="displayExport = true"
        >
          <span v-if="this.$vuetify.breakpoint.mdAndUp">Exporter</span>
          <v-icon>mdi-file-export</v-icon>
        </v-btn>
        <v-btn
          text
          @click="displayFilter = !displayFilter"
          :class="{ 'grey lighten-2': displayFilter }"
        >
          <span v-if="this.$vuetify.breakpoint.mdAndUp">Filtrer</span>
          <v-badge
            color="accent"
            overlap
            bottom
            offset-x="3"
            :content="nombreFiltres"
            :value="nombreFiltres"
          >
            <v-icon>mdi-filter-variant</v-icon>
          </v-badge>
        </v-btn>
      </v-toolbar-items>
    </v-toolbar>
    <v-card-text class="my-0 py-0">
      <v-row>
        <v-col :sm="displayFilter ? 9 : 12" :md="displayFilter ? 10 : 12">
          <EtudesExportPanel
            :filtres="filtres"
            :displayExport="displayExport"
            :class="{
              tableDesktopLayout: this.$vuetify.breakpoint.mdAndUp
            }"
            @closed="closeExport"
          />
          <v-data-table
            :headers="headers"
            :items="dotations"
            :server-items-length="dotationsTotalCount"
            :footer-props="{
              'items-per-page-options': [30]
            }"
            :items-per-page="30"
            :globalHeader="this.globalHeader"
            :subHeaders="this.subHeaders"
            fixed-header
            hide-default-header
            @update:page="updatePage($event)"
            :class="{
              tableDesktopLayout: this.$vuetify.breakpoint.mdAndUp
            }"
            :height="
              this.$vuetify.breakpoint.mdAndUp ? 'calc(100vh - 216px)' : ''
            "
            :loading="tableLoading"
            dense
          >
            <template v-slot:item="{ item, index }">
              <tr class="secondary white--text">
                <td :colspan="subHeaders.length">
                  <v-container fluid class="py-0">
                    <v-row dense>
                      <v-col cols="6">
                        <span>
                          {{ item.sousAction }} - {{ item.perimetre }} -
                          {{ item.annee }}
                          <span
                            v-if="
                              item.sousAction === 'AUTRE' && item.autreFinanceur
                            "
                          >
                            - {{ item.autreFinanceur.libelle }}
                          </span>
                          <v-spacer></v-spacer>
                          <span class="font-weight-bold">Nombre de fiches :</span>
                          {{ item.nombreEtudes }}
                        </span>
                      </v-col>
                      <v-col>
                      <span v-if="
                              item.sousAction !== 'Régie' && item.sousAction !== 'À définir' && item.sousAction !== 'AUTRE' " >
                        <span class="font-weight-bold">Budget</span> :
                        {{ item.budget.toLocaleString() }} €
                        <v-spacer></v-spacer></span>
                        <span v-if="
                              item.sousAction !== 'Régie' && item.sousAction !== 'À définir'  && item.sousAction !== 'AUTRE' " ><span class="font-weight-bold">Reliquat</span> :
                        {{ item.reliquat.toLocaleString() }} €
                      </span></v-col>
                      <v-col><span class="font-weight-bold">Demandé</span> :
                        {{ item.montantDemande.toLocaleString() }} <span v-if="
                              item.sousAction !== 'Régie' " > €</span>
                        <span v-if="
                              item.sousAction === 'Régie' " > jours</span>
                        </v-col>
                      <v-col>
                        <span class="font-weight-bold">Autorisé</span> :{{ item.montantAutorise.toLocaleString() }}<span v-if="
                              item.sousAction !== 'Régie' " > €</span>
                        <span v-if="
                              item.sousAction === 'Régie' " > jours</span>
                        {{ item.sousAction ? item.sousAction.sigle : "" }}
                      </v-col>
                    </v-row>
                  </v-container>
                </td>
              </tr>
              <tr v-if="item.financement.length > 0" class="grey lighten-2">
                <td :colspan="subHeaders.length">
                  <v-container fluid class="py-0">
                    <v-row dense>
                      <v-col cols="6">
                        <span
                          ><span class="font-weight-bold">Nombre Études</span> :
                          {{ item.financement.length }}</span
                        >
                      </v-col>
                      <v-col></v-col>
                      <v-col>
                        <span class="font-weight-bold">Demandé</span> :
                        {{
                          Intl.NumberFormat().format(item.financement
                            .map(x => x.demandese)
                            .reduce((acc, value) => acc + value))
                        }}
                      </v-col>
                      <v-col>
                        <span class="font-weight-bold">Autorisé</span> :
                        {{
                          Intl.NumberFormat().format(item.financement
                            .map(x => x.aee)
                            .reduce((acc, value) => acc + value))
                        }}
                      </v-col>
                    </v-row>
                  </v-container>
                </td>
              </tr>
              <tr v-if="item.financement.length > 0">
                <td :colspan="subHeaders.length">
                  <v-data-table
                    :headers="subHeaders"
                    :items="item.financement"
                    @click:row="etude($event)"
                    item-key="etudeId"
                    hide-default-footer
                    disable-pagination
                    single-selected
                    v-model="selected"
                    dense
                  >
                    <template v-slot:item.etatEtude="{ item }">
                      <v-chip
                        :value="getStatus(item.etatEtude).key"
                        x-small
                        :color="getStatus(item.etatEtude).color"
                        label
                        class="black--text"
                        :class="{
                          'white--text':
                            getStatus(item.etatEtude).key === 'toutes'
                        }"
                      >
                        <v-icon small>{{
                          getStatus(item.etatEtude).icon
                        }}</v-icon>
                      </v-chip>
                    </template>
                    <template v-slot:item.demandese="{ item }">
                        {{ item.demandese.toLocaleString() }}
                    </template>
                    <template v-slot:item.aee="{ item }">
                        {{ Intl.NumberFormat().format(item.aee) }}
                    </template>
                    <template v-slot:item.totalae="{ item }">
                        {{ Intl.NumberFormat().format(item.totalae) }}
                    </template>                    
                  </v-data-table>
                </td>
              </tr>
            </template>
          </v-data-table>
        </v-col>
        <v-col sm="3" md="2" xs="12" :class="{ 'd-none': !displayFilter }">
          <v-sheet
            tile
            :class="{
              tableDesktopLayout: this.$vuetify.breakpoint.mdAndUp
            }"
          >
            <v-form class="filtres">
              <v-select
                :items="annees"
                v-model="filtres.annee"
                item-text="label"
                item-value="key"
                label="Année"
                dense
                class="mr-2 mt-5"
                @change="filtrer()"
              ></v-select>
              <v-select
                :items="bops"
                v-model="filtres.bop"
                label="Gestionnaire BOP"
                dense
                multiple
                chips
                class="mr-2"
                @change="filtrer()"
              ></v-select>
              <v-text-field
                label="Direction"
                v-model="filtres.direction"
                dense
                class="mr-2"
                @change="filtrer()"
              />
              <v-text-field
                label="Pilote"
                v-model="filtres.pilote"
                dense
                class="mr-2"
                @change="filtrer()"
              />
              <v-select
                :items="themes"
                v-model="filtres.theme"
                label="Thématiques"
                dense
                multiple
                chips
                class="mr-2"
                @change="filtrer()"
              ></v-select>
              <v-text-field
                label="Titre"
                v-model="filtres.titre"
                dense
                class="mr-2"
                @change="filtrer()"
              />
              <v-select
                :items="types"
                :key="id"
                item-text="type"
                item-value="type"
                v-model="filtres.type"
                label="Type de prestation"
                dense
                multiple
                chips
                class="mr-2"
                @change="filtrer()"
              ></v-select>
              <v-text-field
                label="N° de fiche AGILE"
                v-model="filtres.ru"
                dense
                class="mr-2"
                @change="filtrer()"
              />
              <v-text-field
                label="enjeux specifique 1"
                v-model="filtres.enjeux_specifique"
                dense
                class="mr-2"
                @change="filtrer()"
              />
              <v-text-field
                label="priorite"
                v-model="filtres.priorite"
                dense
                class="mr-2"
                @change="filtrer()"
              />
              <v-text-field
                label="prestataire"
                v-model="filtres.realisation_moe"
                dense
                class="mr-2"
                @change="filtrer()"
              />              
              <v-text-field
                label="N° partenaire"
                v-model="filtres.suivi"
                dense
                class="mr-2 mt-0 pt-0"
                @change="filtrer()"
              />
            </v-form>
          </v-sheet>
        </v-col>
      </v-row>
    </v-card-text>
  </v-card>
</template>

<script>
import { mapState, mapGetters } from "vuex";
import { filterUtilMixin } from "../mixins/filterUtilMixin.js";
import EtudesExportPanel from "@/components/EtudesExportPanel.vue";

export default {
  name: "FinancementsListPage",
  mixins: [filterUtilMixin],
  data() {
    return {
      tableLoading: false,
      globalHeader: "Global data",
      headers: [
        {
          text: "Périmètre",
          align: "left",
          sortable: false,
          value: "perimetre"
        },
        { text: "Sous-Action", value: "sousAction.sigle" },
        { text: "Autre financeur", value: "autreFinanceur" },
        { text: "Année", value: "annee" },
        { text: "Budget", value: "budget" }
      ],
      subHeaders: [
        { text: "", value: "etatEtude" },
        { text: "N°RU", value: "etudeId" },
        {
          text: "Titre",
          align: "left",
          sortable: false,
          value: "titreetude",
          width: "50%"
        },
        { text: "Direction", value: "direction", width: "10%" },
        { text: "Pilotage", value: "pilotage", width: "10%" },
        { text: "Année", value: "annee" },
        { text: "Demandé", value: "demandese"},
        { text: "Autorisé", value: "aee" },
        { text: "TOTAL AE", value: "totalae" }
      ],
      displayFilter: true,
      displayExport: false,
      page: 1
    };
  },
  created() {
    this.$store.dispatch("studies/fetchDotations", {
      filtres: this.filtres,
      page: this.page
    });
  },
  methods: {
    etude: function(item) {
      this.$router.push(
        "/" +
          (this.$route.params.affichage
            ? this.$route.params.affichage + "/"
            : "") +
          item.etudeId
      );
    },
    filtrer: function() {
      this.$store.dispatch("studies/fetchDotations", {
        filtres: this.filtres,
        page: this.page
      });
    },
    closeExport: function(){
      this.displayExport= false
    },
    updatePage: async function(page) {
      this.tableLoading = !this.tableLoading;
      this.page = page;
      await this.$store.dispatch("studies/fetchDotations", {
        filtres: this.filtres,
        page: this.page
      });
      this.tableLoading = !this.tableLoading;
    },
    getStatus: function(requestedStatus) {
      let filteredStatus = this.status.filter(currentStatus => {
        return currentStatus.key === requestedStatus;
      });
      return filteredStatus[0];
    }
  },
  computed: {
    ...mapState("studies", [
      "dotations",
      "dotationsTotalCount",
      "globalFilters",
      "affichages",
      "bops",
      "themes",
      "types",
      "status",
      "updateListComponent"
    ]),
    ...mapState("security", ["subject"]),
    ...mapGetters("security", ["isConnected"]),
    id: function() {
      return this.$route.params.id;
    },
    selected: {
      get() {
        return [{ etudeId: this.id }];
      },
      set(selectedId) {
        selectedId;
      }
    }
  },
  watch: {
    globalFilters() {
      this.$store.dispatch("studies/fetchDotations", {
        filtres: this.filtres,
        page: this.page
      });
    },
    updateListComponent(){
      this.$store.dispatch("studies/fetchDotations", {
        filtres: this.filtres,
        page: this.page
      });
    }
  },
  components: {
    EtudesExportPanel
  }
};
</script>

<style></style>

```

</details>


---

### 📄 `src/views/Assistance.vue` [6.058 octets]
<a id="src-views-Assistance-vue"></a> [↩ Retour à l'arborescence](#tree-src-views-Assistance-vue)

> **Chemin relatif** : `src/views/Assistance.vue`  
> **Taille** : 6.058 octets  
> **Lignes** : 156  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (156 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <div>
    <v-content>
      <v-container fluid>
        <v-row>
          <v-col cols="12">
            <v-card>
              <v-card-title>Assistance</v-card-title>
              <v-card-text>
                <v-tabs
                  v-model="tab"
                  background-color="transparent"
                  grow
                  show-arrows
                >
                  <v-tab v-for="item in items" :key="item.onglet">{{
                    item.onglet
                  }}</v-tab>
                </v-tabs>
                <v-tabs-items v-model="tab">
                  <v-tab-item key="Auvergne Rhône Alpes">
                    <v-card flat>
                      <v-card-text>
                        Pascale Dupré service CIDDAE pôle SeDD
                        <br />Téléphone : 04 73 43 15 60 <br />Courriel :
                        etudes.dreal-ara@developpement-durable.gouv.fr
                      </v-card-text>
                    </v-card>
                  </v-tab-item>
                  <v-tab-item key="Bourgogne-Franche-Comté">
                    <v-card flat>
                      <v-card-text>
                        Marie-Christine Bois
                        <br />Téléphone : 03 81 21 68 65
                        <br />
                        <br />Lauren KELLY <br />Téléphone : 03 39 59 62 95 - 06 67 18 25 50
                        <br />
                        <br />Courriel :
                        dc.sdda.dreal-bourgogne-franche-comte@developpement-durable.gouv.fr
                      </v-card-text>
                    </v-card>
                  </v-tab-item>
                  <v-tab-item key="Bretagne">
                    <v-card flat>
                      <v-card-text>
                        Téléphone : 02.99.33.43.70
                        <br />Courriel :
                        etudes.cpros.coprev.dreal-bretagne@developpement-durable.gouv.fr
                      </v-card-text>
                    </v-card>
                  </v-tab-item>
                  <v-tab-item key="Centre-Val de Loire">
                    <v-card flat>
                      <v-card-text>
                        Courriel :
                        agile.scatel.dreal-centre@developpement-durable.gouv.fr
                      </v-card-text>
                    </v-card>
                  </v-tab-item>
                  <v-tab-item key="Grand Est">
                    <v-card flat>
                      <v-card-text>
                        Courriel :
                        reseau-etudes-connaissance.dreal-grand-est@developpement-durable.gouv.fr
                        <br />Marie Thérèse Grün au 03.51.37.60.18
                        <br />Nathalie Brunsart au 03.51.37.60.10
                      </v-card-text>
                    </v-card>
                  </v-tab-item>
                  <v-tab-item key="Hauts de France">
                    <v-card flat>
                      <v-card-text>
                        Courriel :cecile.randria@developpement-durable.gouv.fr
                        <br />
                        <br />Afin de permettre une prise en charge effective de
                        votre demande, merci de bien vouloir libeller votre
                        sujet du message de la manière suivante :
                        <br />
                        <br />AGILE [SERVICE] Prénom NOM - objet de la demande
                        <br />
                        <br />exemple : <br />AGILE [DREAL] Henri DUPONT -
                        Demande d'ouverture de compte
                      </v-card-text>
                    </v-card>
                  </v-tab-item>
                  <v-tab-item key="Île de France">
                    <v-card flat>
                      <v-card-text>
                        Pour la DRIEAT:
                        <br /><br />Courriel :mva.scdd.drieat-if@developpement-durable.gouv.fr
                        <br /><br />Yannick Nouaillas
                        <br />téléphone : 01 40 61 88 86
                        <br />Sandrine Phemius
                        <br />téléphone : 01 40 61 89 64
                        <br />Frédéric Ruysschaert
                        <br />téléphone : 01 40 61 81 08
                      </v-card-text>
                    </v-card>
                  </v-tab-item>                  
                  <v-tab-item key="Normandie">
                    <v-card flat>
                      <v-card-text>
                        Mallorie HUGUET
                        <br />Courriel :
                        mallorie.huguet@developpement-durable.gouv.fr
                        <br />
                        <br />Secrétariat : <br />Téléphone : 02.50.01.83.11
                      </v-card-text>
                    </v-card>
                  </v-tab-item>
                  <v-tab-item key="Nouvelle-Aquitaine">
                    <v-card flat>
                      <v-card-text>
                        Arnaud WILCZYNSKI
                        <br />Courriel :
                        arnaud.wilczynski@developpement-durable.gouv.fr
                        <br />Téléphone : 05.55.12.94.93
                      </v-card-text>
                    </v-card>
                  </v-tab-item>
                </v-tabs-items>
              </v-card-text>
            </v-card>
          </v-col>
        </v-row>
      </v-container>
    </v-content>
  </div>
</template>

<script>
import {} from "vuex";

export default {
  name: "Assistance",
  data() {
    return {
      tab: null,
      items: [
        { onglet: "Auvergne Rhône Alpes", content: "1" },
        { onglet: "Bourgogne-Franche-Comté" },
        { onglet: "Bretagne", content: "2" },
        { onglet: "Centre-Val de Loire" },
        { onglet: "Grand Est" },
        { onglet: "Hauts de France" },
        { onglet: "Île de France" },
        { onglet: "Normandie" },
        { onglet: "Nouvelle-Aquitaine" }
      ]
    };
  }
};
</script>

<style></style>

```

</details>


---

### 📄 `src/views/Etude.vue` [8.425 octets]
<a id="src-views-Etude-vue"></a> [↩ Retour à l'arborescence](#tree-src-views-Etude-vue)

> **Chemin relatif** : `src/views/Etude.vue`  
> **Taille** : 8.425 octets  
> **Lignes** : 373  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (373 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <v-card tile>
    <v-toolbar dense elevation="1">
      <v-toolbar-title>Fiche N° {{ id }}</v-toolbar-title>
      <v-spacer />
      <v-toolbar-items>
        <v-btn v-if="isPermitted" color="accent" @click="update"
          >Mettre à jour</v-btn
        >
        <v-spacer></v-spacer>
        <v-btn v-if="isPermitted" color="accent" @click="duplicate"
          >Dupliquer</v-btn
        >
        <v-spacer></v-spacer>
        <v-btn color="accent" link :href="printUrl" target="_blank"
          >Imprimer</v-btn
        >
        <v-btn text icon @click="close">
          <v-icon>mdi-close</v-icon>
        </v-btn>
      </v-toolbar-items>
    </v-toolbar>
    <v-card-text
      :class="{ studyDesktopLayout: this.$vuetify.breakpoint.mdAndUp }"
    >
      <div v-html="this.study ? this.study.html : ''" ref="insertedStudy">
        Nothing there
      </div>
    </v-card-text>
  </v-card>
</template>

<script>
import { mapState, mapGetters } from "vuex";

export default {
  data() {
    return {
      id: this.$route.params.id,
      baseUrl: process.env.VUE_APP_API_BASE_URL,
    };
  },
  methods: {
    update() {
      // let id = this.$route.params.id;
      this.$router.push(
        "/" +
          (this.$route.params.affichage
            ? this.$route.params.affichage + "/"
            : "") +
          this.id +
          "/edit"
      );
    },
    duplicate() {
      this.$router.push(
        "/" +
          (this.$route.params.affichage
            ? this.$route.params.affichage + "/"
            : "") +
          "new/" +
          this.id
      );
    },
    close() {
      this.$router.push(this.basePath);
    }
  },
  created() {
    this.$store.dispatch("studies/fetchStudy", this.$route.params.id);
  },
  computed: {
    printUrl: function() {
      return this.baseUrl + '/etudes/' + this.id + '/print'
    },
    basePath: function() {
      return (
        "/" +
        (this.$route.params.affichage ? this.$route.params.affichage + "/" : "")
      );
    },
    isPermitted() {
      let permitted = this.study
        ? this.study.perimetre === this.subject.autorisation
        : false;
      return permitted;
    },
    ...mapState("studies", ["study"]),
    ...mapState("security", ["subject"]),
    ...mapGetters("security", ["isConnected"])
  },
  updated() {
    // Évènements onglet hérités
    const script =
      'var anc_onglet; if (document.querySelector(".panneau-actif") === null) { document.querySelector(".panneau-description").classList.remove("panneau-masque"); document.querySelector(".panneau-description").classList.add("panneau-actif"); anc_onglet = "description"; } function onglet_01(nom_onglet) { anc_onglet = onglet(nom_onglet, anc_onglet); } function onglet_02(nom_onglet) { anc_onglet = onglet(nom_onglet, anc_onglet); } function onglet_03(nom_onglet) { anc_onglet = onglet(nom_onglet, anc_onglet); } function onglet_04(nom_onglet) { anc_onglet = onglet(nom_onglet, anc_onglet); } function onglet(nom_onglet, anc_onglet) { let new_onglet = nom_onglet.id == null ? nom_onglet : nom_onglet.id; anc_onglet = anc_onglet == null ? new_onglet : anc_onglet; document.getElementById(anc_onglet).className = ""; document.getElementById(new_onglet).className = "active"; document.getElementById("panneau-" + anc_onglet).classList.remove("panneau-actif"); document.getElementById("panneau-" + anc_onglet).classList.add("panneau-masque"); document.getElementById("panneau-" + new_onglet).classList.remove("panneau-masque"); document.getElementById("panneau-" + new_onglet).classList.add("panneau-actif"); return new_onglet }; ';
    let se = document.createElement("script");
    se.setAttribute("type", "text/javascript");
    se.appendChild(document.createTextNode(script));

    this.$refs["insertedStudy"].appendChild(se);
  }
};
</script>

<style lang="scss" scoped>
* {
  &::v-deep div {
    header,
    section,
    footer,
    div {
      // overflow-x: hidden;
    }

    ul#pop_error li {
      display: inline;
      font-weight: bold;
      background-color: red;
      color: white;
      padding: 4px;
    }

    button.btn,
    button#newEtude {
      display: none;
    }

    .required {
      font-weight: bold;
    }

    h4 {
      margin: 4px 0 2px 0;
    }

    #etudeGeneralites {
      width: 100%;
    }

    #etudeGeneralites tr:first-child textarea {
      text-align: center;
      font-weight: bold;
    }

    table {
      border-collapse: collapse;
      table-layout: fixed;
    }

    #panneau-monchoix,
    #panneau-madotation {
      overflow: hidden;
    }

    .panneau-masque {
      display: none;
    }

    .panneau-actif {
      display: block;
    }

    .spacer {
      display: block;
      padding: 6px;
      min-height: 12px;
    }

    .right {
      display: block;
      text-align: right;
    }

    .mid-text,
    .date {
      width: 8em;
    }

    .number {
      width: 9em;
    }

    .short-text {
      width: 100%;
    }

    .extra-short-text {
      width: 3em;
    }

    table td,
    table.form td {
      padding: 3px;
    }

    #valorisation_comment {
      max-width: 100%;
      width: 100%;
      height: 5em;
    }

    #libelle {
      max-width: 100%;
      width: 100%;
      height: 3em;
    }

    #commentaires {
      max-width: 100%;
      width: 100%;
      height: 12em;
    }

    nav ul {
      margin: 0;
      padding: 0;
      overflow: hidden;
    }

    nav ul li {
      float: left;
      border: 4px solid #4874b8;
      background-color: #4874b8;
      border-radius: 4px 4px 4px 4px;
    }

    nav ul li a {
      color: #fff;
    }

    .active {
      border-bottom: 4px solid #fff;
      background-color: #fff;
    }

    .active a {
      color: #000;
    }

    nav ul li a {
      display: block;
      padding: 5px;
    }

    ul {
      list-style-type: none;
    }

    li a {
      text-align: center;
      text-decoration: none;
    }

    input[type="text"],
    textarea {
      background: none;
      border: 0.5px dashed #bbb;
    }

    input[type="text"]:focus,
    textarea:focus {
      background: white;
      border: 1px solid #ddd;
    }

    select {
      background: none;
      border: none;
      border-bottom: 1px solid;
      margin: 4px 5px;
      color: black;
    }

    input[type="button"],
    input[type="submit"] {
      padding: 1em;
      border-radius: 6px;
    }

    input[disabled] {
      background: none;
      color: #aaa;
    }

    .panneau-description select {
      width: 60%;
    }

    .panneau-description input[type="number"] {
      width: 4em;
    }

    .panneau-description textarea {
      width: 36vw;
    }

    .panneau h2 {
      font-variant: small-caps;
      font-size: 14px;
    }

    .panneau h3,
    .panneau h4 {
      text-decoration: underline;
    }

    span.libelle {
      font-weight: bold;
    }

    .panneau-financement {
      overflow-y: scroll;
    }

    .panneau-financement select {
      width: 60%;
    }

    .panneau-contexte textarea {
      width: 80%;
    }

    /*
 Financements
*/

    .panneau-financement ul {
      padding-left: 0;
    }
    table.financement {
      border: solid 1px #e0e0e0;
    }
    table.financement tr:nth-child(1) {
      border: solid 1px #e0e0e0;
    }
    table.financement tr:nth-child(1) td {
      border: solid 1px #e0e0e0;
    }
    table.financement tr:nth-child(3n + 2) {
      border-top: solid 1px #e0e0e0;
    }
    table.financement tr:nth-child(3n + 2) td {
      border-left: solid 1px #e0e0e0;
      border-right: solid 1px #e0e0e0;
      border-bottom: solid 1px #e0e0e0;
    }
    table.financement td {
      min-width: 5vw;
      width: 10vw;
    }

    .financement select.financement_sous_action {
      width: 7vw;
      margin: 0px;
      padding: 0px;
    }

    .financement input.financement_autre_financeur {
      width: 7vw;
    }

    .financement input.financement_motif_comite {
      width: 24vw;
    }

    .financement input {
      background-color: white;
      width: 4vw;
    }
  }
}
</style>

```

</details>


---

### 📄 `src/views/EtudeEdit.vue` [9.851 octets]
<a id="src-views-EtudeEdit-vue"></a> [↩ Retour à l'arborescence](#tree-src-views-EtudeEdit-vue)

> **Chemin relatif** : `src/views/EtudeEdit.vue`  
> **Taille** : 9.851 octets  
> **Lignes** : 402  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (402 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <v-dialog
    v-model="dialog"
    persistent
    hide-overlay
    transition="dialog-bottom-transition">
  <v-card tile>
    <v-toolbar dense elevation="1">
      <v-toolbar-title>Fiche N° {{ id }}</v-toolbar-title>
      <v-spacer />
      <v-toolbar-items>
        <v-btn color="accent" @click="handleSubmit" :disabled="submitted"
          >Valider les modifications</v-btn
        >
      </v-toolbar-items>
      <v-btn text icon @click="close">
        <v-icon>mdi-close</v-icon>
      </v-btn>
    </v-toolbar>
    <ConfirmationDialog ref="modalDialog" />
    <v-card-text
      :class="{ studyDesktopLayout: this.$vuetify.breakpoint.mdAndUp }"
    >
      <form
        @submit.prevent="handleSubmit"
        id="editForm"
        novalidate="novalidate"
      >
        <div v-html="this.studyEdit" ref="insertedStudy">Nothing there</div>
      </form>
    </v-card-text>
  </v-card>
  </v-dialog>
</template>

<script>
import { mapState } from "vuex";
import ConfirmationDialog from "@/components/ConfirmationDialog.vue";

export default {
  data() {
    return {
      dialog:true,
      submitted: false,
      id: this.$route.params.id,
    };
  },
  created() {
    this.$store.dispatch("studies/fetchStudyEdit", this.$route.params.id);
  },
  computed: {
    basePath: function () {
      return (
        "/" +
        (this.$route.params.affichage ? this.$route.params.affichage + "/" : "")
      );
    },
    ...mapState("studies", ["studyEdit"]),
  },
  methods: {
    async handleSubmit() {
      this.submitted = true;
      let id = this.$route.params.id;
      let editForm = document.getElementById("editForm");
      let formData = new FormData(editForm);
      await this.$store.dispatch("studies/postStudy", { id, formData });
      this.submitted=false;
    },
    close() {
      this.$router.push(this.basePath+this.$route.params.id);
    },
  },
  beforeRouteLeave(to, from, next) {
    if (this.submitted) {
      next();
    } else {
      this.$refs.modalDialog.pop().then((answer) => {
        if (answer) {
          this.dialog=false;
          next();
        }
      });
    }
  },
  updated() {
    // Évènements onglets(legacy)
    const scriptOnglet =
      'var anc_onglet; if (document.querySelector(".panneau-actif") === null) { document.querySelector(".panneau-description").classList.remove("panneau-masque"); document.querySelector(".panneau-description").classList.add("panneau-actif"); anc_onglet = "description"; } function onglet_01(nom_onglet) { anc_onglet = onglet(nom_onglet, anc_onglet); } function onglet_02(nom_onglet) { anc_onglet = onglet(nom_onglet, anc_onglet); } function onglet_03(nom_onglet) { anc_onglet = onglet(nom_onglet, anc_onglet); } function onglet_04(nom_onglet) { anc_onglet = onglet(nom_onglet, anc_onglet); } function onglet(nom_onglet, anc_onglet) { let new_onglet = nom_onglet.id == null ? nom_onglet : nom_onglet.id; anc_onglet = anc_onglet == null ? new_onglet : anc_onglet; document.getElementById(anc_onglet).className = ""; document.getElementById(new_onglet).className = "active"; document.getElementById("panneau-" + anc_onglet).classList.remove("panneau-actif"); document.getElementById("panneau-" + anc_onglet).classList.add("panneau-masque"); document.getElementById("panneau-" + new_onglet).classList.remove("panneau-masque"); document.getElementById("panneau-" + new_onglet).classList.add("panneau-actif"); return new_onglet }; ';
    let se = document.createElement("script");
    se.setAttribute("type", "text/javascript");
    se.appendChild(document.createTextNode(scriptOnglet));

    // Évènements ajouts financements(legacy)
    const scriptFin =
      'var collectionHolder; var addFinancementLink = document.querySelector(".add_financement_link"); var newLinkLi = document.createElement("li").appendChild(addFinancementLink); collectionHolder = document.querySelector("ul.financements"); collectionHolder.appendChild(newLinkLi); document.querySelector(".add_financement_link").onclick = function (event) { event.preventDefault(); var prototype = collectionHolder.getAttribute("data-prototype"); var index = collectionHolder.getAttribute("data-index"); var newForm = prototype; newForm = newForm.replace(/__name__/g, index); collectionHolder.setAttribute("data-index", Number(index) + 1); var newFormLi = document.createElement("li"); newFormLi.innerHTML = newForm; newLinkLi.parentNode.insertBefore(newFormLi, newLinkLi); };';
    let sw2 = document.createElement("script");
    sw2.setAttribute("type", "text/javascript");
    sw2.appendChild(document.createTextNode(scriptFin));

    this.$refs["insertedStudy"].appendChild(se);
    this.$refs["insertedStudy"].appendChild(sw2);
  },
  components: {
    ConfirmationDialog,
  },
};
</script>

<style lang="scss" scoped>
form {
  &::v-deep div {
    ul#pop_error {
      margin: 0;
      padding: 0;
    }

    input[type=text]{
      width: 15vw;;
    }

    ul#pop_error li {
      display: inline;
      font-weight: bold;
      background-color: red;
      color: white;
      padding: 4px;
    }

    button.btn {
      display: none;
    }

    .required {
      font-weight: bold;
    }

    h4 {
      margin: 4px 0 2px 0;
    }

    select {
      -moz-appearance: menulist;
      -webkit-appearance: menulist;
    }

    #etudeGeneralites {
      width: 100%;
    }

    #etudeGeneralites tr:first-child textarea {
      text-align: center;
      font-weight: bold;
    }

    table {
      border-collapse: collapse;
      table-layout: fixed;
    }

    #panneau-monchoix,
    #panneau-madotation {
      overflow: hidden;
    }

    .panneau-masque {
      display: none;
    }

    .panneau-actif {
      display: block;
    }

    .spacer {
      display: block;
      padding: 6px;
      min-height: 12px;
    }

    .right {
      display: block;
      text-align: right;
    }

    .mid-text,
    .date {
      // width: 8em;
    }

    .number {
      // width: 9em;
    }

    .short-text {
      width: 100%;
    }

    .extra-short-text {
      // width: 3em;
    }

    table td,
    table.form td {
      padding: 3px;
    }

    #valorisation_comment {
      max-width: 100%;
      width: 100%;
      height: 5em;
    }

    #libelle {
      max-width: 100%;
      width: 100%;
      height: 3em;
    }

    #commentaires {
      max-width: 100%;
      width: 100%;
      height: 12em;
    }

    nav ul {
      margin: 0;
      padding: 0;
      overflow: hidden;
    }

    nav ul li {
      float: left;
      border: 4px solid #4874b8;
      background-color: #4874b8;
      border-radius: 4px 4px 4px 4px;
      width:12vw;
    }

    nav ul li a {
      color: #fff;
    }

    .active {
      border-bottom: 4px solid #fff;
      background-color: #fff;
    }

    .active a {
      color: #000;
    }

    nav ul li a {
      display: block;
      padding: 5px;
    }

    ul {
      list-style-type: none;
    }

    li a {
      text-align: center;
      text-decoration: none;
    }

    .ligne_financement a {
      color: blue;
    }

    input[type="text"],
    textarea {
      background: none;
      border: 0.5px dashed #bbb;
    }

    div#panneau-description textarea#etudes_resume {
      width: 100%;
    }

    #panneau-description textarea {
      height: 10rem;
    }

    input[type="text"]:focus,
    textarea:focus {
      background: white;
      border: 1px solid #ddd;
    }

    select {
      background: none;
      border: none;
      border-bottom: 1px solid;
      margin: 4px 5px;
      color: black;
    }

    input[type="button"],
    input[type="submit"] {
      padding: 1em;
      border-radius: 6px;
    }

    input[disabled] {
      background: none;
      color: #aaa;
    }

    .panneau-description select {
      // width: 60%;
    }

    .panneau-description input[type="number"] {
      // width: 4em;
    }

    .panneau-description textarea {
      width: 36vw;
    }

    .panneau h2 {
      font-variant: small-caps;
      font-size: 14px;
    }

    .panneau h3,
    .panneau h4 {
      text-decoration: underline;
    }

    span.libelle {
      font-weight: bold;
    }

    .panneau-financement {
      overflow-y: scroll;
    }

    .panneau-financement select {
      // width: 60%;
    }

    .panneau-contexte textarea {
      width: 100%;
    }

    .panneau-contexte table {
      width: 100%;
    }

    /*
 Financements
*/

    .panneau-financement ul {
      padding-left: 0;
    }
    table.financement {
      border: solid 1px #e0e0e0;
    }
    table.financement tr:nth-child(1) {
      border: solid 1px #e0e0e0;
    }
    table.financement tr:nth-child(1) td {
      border: solid 1px #e0e0e0;
    }
    table.financement tr:nth-child(3n + 2) {
      border-top: solid 1px #e0e0e0;
    }
    table.financement tr:nth-child(3n + 2) td {
      border-left: solid 1px #e0e0e0;
      border-right: solid 1px #e0e0e0;
      border-bottom: solid 1px #e0e0e0;
    }
    table.financement td {
      // min-width: 5vw;
      width: 15vw;
    }

    .financement select.financement_sous_action {
      width: 15vw;
      margin: 0px;
      padding: 0px;
      // -moz-appearance: menulist;
      // -webkit-appearance: menulist;
    }

    .financement input.financement_autre_financeur {
      width: 15vw;
    }

    .financement input.financement_motif_comite {
      width: 15vw;
    }

    .financement input {
      background-color: white;
      width: 15vw;
    }
  }
}
</style>

```

</details>


---

### 📄 `src/views/EtudeNew.vue` [9.890 octets]
<a id="src-views-EtudeNew-vue"></a> [↩ Retour à l'arborescence](#tree-src-views-EtudeNew-vue)

> **Chemin relatif** : `src/views/EtudeNew.vue`  
> **Taille** : 9.890 octets  
> **Lignes** : 386  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (386 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <v-dialog
    v-model="dialog"
    persistent
    hide-overlay
    transition="dialog-bottom-transition">
  <v-card tile>
    <v-toolbar dense elevation="1">
      <v-toolbar-title>Fiche</v-toolbar-title>
      <v-spacer />
      <v-toolbar-items>
        <v-btn color="accent" @click="handleSubmit">Enregistrer</v-btn>
      </v-toolbar-items>
      <v-btn text icon @click="close">
        <v-icon>mdi-close</v-icon>
      </v-btn>
    </v-toolbar>
    <ConfirmationDialog ref="modalDialog" />
    <v-card-text
      :class="{ studyDesktopLayout: this.$vuetify.breakpoint.mdAndUp }"
    >
      <form
        @submit.prevent="handleSubmit"
        id="editForm"
        novalidate="novalidate"
      >
        <div v-html="this.studyNew" ref="insertedStudy">Nothing there</div>
      </form>
    </v-card-text>
  </v-card>
  </v-dialog>
</template>

<script>
import { mapState } from "vuex";
import ConfirmationDialog from "@/components/ConfirmationDialog.vue";

export default {
  data() {
    return { dialog:true, submitted: false };
  },
  created() {
    this.$store.dispatch("studies/fetchStudyNew", this.$route.params.id);
  },
  computed: {
    basePath: function () {
      return (
        "/" +
        (this.$route.params.affichage ? this.$route.params.affichage + "/" : "")
      );
    },
    ...mapState("studies", ["studyNew"]),
  },
  methods: {
    async handleSubmit() {
      this.submitted = true;
      let editForm = document.getElementById("editForm");
      let formData = new FormData(editForm);
      await this.$store.dispatch("studies/createStudy", { formData });
      this.submitted = false;
    },
    close() {
      this.$router.push(this.basePath);
    },
  },
  beforeRouteLeave(to, from, next) {
    if (this.submitted) {
      next();
    } else {
      this.$refs.modalDialog.pop().then((answer) => {
        if (answer) {
          next();
        }
      });
    }
  },
  updated() {
    // Évènements onglets(legacy)
    const scriptOnglet =
      'var anc_onglet; if (document.querySelector(".panneau-actif") === null) { document.querySelector(".panneau-description").classList.remove("panneau-masque"); document.querySelector(".panneau-description").classList.add("panneau-actif"); anc_onglet = "description"; } function onglet_01(nom_onglet) { anc_onglet = onglet(nom_onglet, anc_onglet); } function onglet_02(nom_onglet) { anc_onglet = onglet(nom_onglet, anc_onglet); } function onglet_03(nom_onglet) { anc_onglet = onglet(nom_onglet, anc_onglet); } function onglet_04(nom_onglet) { anc_onglet = onglet(nom_onglet, anc_onglet); } function onglet(nom_onglet, anc_onglet) { let new_onglet = nom_onglet.id == null ? nom_onglet : nom_onglet.id; anc_onglet = anc_onglet == null ? new_onglet : anc_onglet; document.getElementById(anc_onglet).className = ""; document.getElementById(new_onglet).className = "active"; document.getElementById("panneau-" + anc_onglet).classList.remove("panneau-actif"); document.getElementById("panneau-" + anc_onglet).classList.add("panneau-masque"); document.getElementById("panneau-" + new_onglet).classList.remove("panneau-masque"); document.getElementById("panneau-" + new_onglet).classList.add("panneau-actif"); return new_onglet }; ';
    let se = document.createElement("script");
    se.setAttribute("type", "text/javascript");
    se.appendChild(document.createTextNode(scriptOnglet));

    // Évènements ajouts financements(legacy)
    const scriptFin =
      'var collectionHolder; var addFinancementLink = document.querySelector(".add_financement_link"); var newLinkLi = document.createElement("li").appendChild(addFinancementLink); collectionHolder = document.querySelector("ul.financements"); collectionHolder.appendChild(newLinkLi); document.querySelector(".add_financement_link").onclick = function (event) { event.preventDefault(); var prototype = collectionHolder.getAttribute("data-prototype"); var index = collectionHolder.getAttribute("data-index"); var newForm = prototype; newForm = newForm.replace(/__name__/g, index); collectionHolder.setAttribute("data-index", Number(index) + 1); var newFormLi = document.createElement("li"); newFormLi.innerHTML = newForm; newLinkLi.parentNode.insertBefore(newFormLi, newLinkLi); }; var prototype = collectionHolder.getAttribute("data-prototype"); var index = collectionHolder.getAttribute("data-index"); var newForm = prototype; newForm = newForm.replace(/__name__/g, index); collectionHolder.setAttribute("data-index", Number(index) + 1); var newFormLi = document.createElement("li"); newFormLi.innerHTML = newForm; newLinkLi.parentNode.insertBefore(newFormLi, newLinkLi);  ';
    let sw2 = document.createElement("script");
    sw2.setAttribute("type", "text/javascript");
    sw2.appendChild(document.createTextNode(scriptFin));

    this.$refs["insertedStudy"].appendChild(se);
    this.$refs["insertedStudy"].appendChild(sw2);
  },
  components: {
    ConfirmationDialog,
  },
};
</script>

<style lang="scss" scoped>
form {
  &::v-deep div {
    ul#pop_error li {
      display: inline;
      font-weight: bold;
      background-color: red;
      color: white;
      padding: 4px;
    }

    input[type=text]{
      width: 15vw;;
    }

    button.btn {
      display: none;
    }

    .required {
      font-weight: bold;
    }

    h4 {
      margin: 4px 0 2px 0;
    }

    select {
      -moz-appearance: menulist;
      -webkit-appearance: menulist;
    }

    #etudeGeneralites {
      width: 100%;
    }

    #etudeGeneralites tr:first-child textarea {
      text-align: center;
      font-weight: bold;
    }

    table {
      border-collapse: collapse;
      table-layout: fixed;
    }

    #panneau-monchoix,
    #panneau-madotation {
      overflow: hidden;
    }

    .panneau-masque {
      display: none;
    }

    .panneau-actif {
      display: block;
    }

    .spacer {
      display: block;
      padding: 6px;
      min-height: 12px;
    }

    .right {
      display: block;
      text-align: right;
    }

    .mid-text,
    .date {
      // width: 8em;
    }

    .number {
      // width: 9em;
    }

    .short-text {
      width: 100%;
    }

    .extra-short-text {
      // width: 3em;
    }

    table td,
    table.form td {
      padding: 3px;
    }

    #valorisation_comment {
      max-width: 100%;
      width: 100%;
      height: 5em;
    }

    #libelle {
      max-width: 100%;
      width: 100%;
      height: 3em;
    }

    #commentaires {
      max-width: 100%;
      width: 100%;
      height: 12em;
    }

    nav ul {
      margin: 0;
      padding: 0;
      overflow: hidden;
    }

    nav ul li {
      float: left;
      border: 4px solid #4874b8;
      background-color: #4874b8;
      border-radius: 4px 4px 4px 4px;
      width:12vw;
    }

    nav ul li a {
      color: #fff;
    }

    .active {
      border-bottom: 4px solid #fff;
      background-color: #fff;
    }

    .active a {
      color: #000;
    }

    nav ul li a {
      display: block;
      padding: 5px;
    }

    ul {
      list-style-type: none;
    }

    li a {
      text-align: center;
      text-decoration: none;
    }
    .ligne_financement a {
      color: blue;
    }

    input[type="text"],
    textarea {
      background: none;
      border: 0.5px dashed #bbb;
    }

    div#panneau-description textarea#etudes_resume {
      width: 100%;
    }

    #panneau-description textarea {
      height: 10rem;
    }

    input[type="text"]:focus,
    textarea:focus {
      background: white;
      border: 1px solid #ddd;
    }

    select {
      background: none;
      border: none;
      border-bottom: 1px solid;
      margin: 4px 5px;
      color: black;
    }

    input[type="button"],
    input[type="submit"] {
      padding: 1em;
      border-radius: 6px;
    }

    input[disabled] {
      background: none;
      color: #aaa;
    }

    .panneau-description select {
      // width: 60%;
    }

    .panneau-description input[type="number"] {
      // width: 4em;
    }

    .panneau-description textarea {
      width: 36vw;
    }

    .panneau h2 {
      font-variant: small-caps;
      font-size: 14px;
    }

    .panneau h3,
    .panneau h4 {
      text-decoration: underline;
    }

    .panneau span.libelle {
      font-weight: bold;
    }

    .panneau-financement {
      overflow-y: scroll;
    }

    .panneau-financement select {
      // width: 60%;
    }

    .panneau-contexte textarea {
      width: 100%;
    }

    .panneau-contexte table {
      width: 100%;
    }

    /*
 Financements
*/

    .panneau-financement ul {
      padding-left: 0;
    }
    table.financement {
      border: solid 1px #e0e0e0;
    }
    table.financement tr:nth-child(1) {
      border: solid 1px #e0e0e0;
    }
    table.financement tr:nth-child(1) td {
      border: solid 1px #e0e0e0;
    }
    table.financement tr:nth-child(3n + 2) {
      border-top: solid 1px #e0e0e0;
    }
    table.financement tr:nth-child(3n + 2) td {
      border-left: solid 1px #e0e0e0;
      border-right: solid 1px #e0e0e0;
      border-bottom: solid 1px #e0e0e0;
    }
    table.financement td {
      // min-width: 5vw;
      width: 15vw;
    }

    .financement select.financement_sous_action {
      width: 15vw;
      margin: 0px;
      padding: 0px;
    }

    .financement input.financement_autre_financeur {
      width: 15vw;
    }

    .financement input.financement_motif_comite {
      width: 15vw;
    }

    .financement input {
      background-color: white;
      width: 15vw;
    }
  }
}
</style>

```

</details>


---

### 📄 `src/views/Home.vue` [1.290 octets]
<a id="src-views-Home-vue"></a> [↩ Retour à l'arborescence](#tree-src-views-Home-vue)

> **Chemin relatif** : `src/views/Home.vue`  
> **Taille** : 1.290 octets  
> **Lignes** : 56  
> **Type** : text

```text
<template>
  <div>
    <v-main>
      <v-container fluid class="my-1 py-0">
        <v-row>
          <v-col :md="this.searchOnly ? 12 : 7" class="no-bottom-padding pr-1">
            <FinancementsList v-if="affichage === 'budgetaire'" />
            <EtudesList v-else />
          </v-col>

          <v-col md="5" class="no-bottom-padding">
            <router-view :key="$route.fullPath"></router-view>
          </v-col>
        </v-row>
      </v-container>
    </v-main>
  </div>
</template>

<script>
import { mapState, mapGetters } from "vuex";

import FinancementsList from "@/components/FinancementsList.vue";
import EtudesList from "@/components/EtudesList.vue";

export default {
  name: "ListPage",
  data() {
    return {};
  },
  computed: {
    searchOnly: function() {
      return !this.$route.params.id && this.$route.path.indexOf("/new") === -1;
    },
    affichage: function() {
      return this.$route.params.affichage === "budgetaire"
        ? "budgetaire"
        : "thematique";
    },
    ...mapState("security", ["subject"]),
    ...mapGetters("security", ["isConnected"])
  },
  components: {
    FinancementsList,
    EtudesList
  }
};
</script>

<style>
.col .no-bottom-padding {
  padding-bottom: 0px !important;
  padding-top: 0px !important;
}
</style>

```


---

### 📄 `src/views/Liens.vue` [11.705 octets]
<a id="src-views-Liens-vue"></a> [↩ Retour à l'arborescence](#tree-src-views-Liens-vue)

> **Chemin relatif** : `src/views/Liens.vue`  
> **Taille** : 11.705 octets  
> **Lignes** : 266  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (266 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <div>
    <v-content>
      <v-container fluid>
        <v-row>
          <v-col cols="12">
            <v-card>
              <v-card-title>Liens</v-card-title>
              <v-card-text>
                <v-tabs
                  v-model="tab"
                  background-color="transparent"
                  grow
                  show-arrows
                >
                  <v-tab v-for="onglet in onglets" :key="onglet.label">{{
                    onglet.label
                  }}</v-tab>
                </v-tabs>
                <v-tabs-items v-model="tab">
                  <v-tab-item v-for="onglet in onglets" :key="onglet.label">
                    <div class="d-flex flex-wrap">
                      <v-card
                        :width="$vuetify.breakpoint.mdAndUp ? '48%' : '100%'"
                        class="my-2 mx-2"
                        v-for="lien in onglet.liens"
                        :key="lien.nom"
                      >
                        <v-card-text>
                          <v-card-title>{{ lien.nom }}</v-card-title>
                        </v-card-text>
                        <v-container>
                          <v-row justify="space-between">
                            <v-col cols="3">
                              <v-img
                                :src="`${publicPath}img/${lien.image}`"
                              ></v-img>
                            </v-col>
                            <v-col cols="9">
                              <v-card-text>{{ lien.description }}</v-card-text>
                            </v-col>
                          </v-row>
                        </v-container>
                        <v-card-actions>
                          <v-btn text :href="lien.url">Voir</v-btn>
                        </v-card-actions>
                      </v-card>
                    </div>
                  </v-tab-item>
                </v-tabs-items>
              </v-card-text>
            </v-card>
          </v-col>
        </v-row>
      </v-container>
    </v-content>
  </div>
</template>

<script>
import { mapState, mapGetters } from "vuex";

export default {
  name: "DashboardPage",
  data() {
    return {
      publicPath: process.env.BASE_URL,
      tab: null,
      onglets: [
        {
          label: "Administration centrale",
          liens: [
            {
              nom: "",
              description:
                "Le CRDALN (Centre de ressources documentaires sur l’aménagement, le logement et la nature) propose des ressources sur l’aménagement, l’urbanisme, la construction, le logement, la nature, la biodiversité, l’eau, le littoral et les milieux marins, les paysages, les matières premières non énergétiques, en France et dans le monde.\nIl réalise de nombreux produits documentaires dont les dernières publications sont accessibles en ligne (veilles, flux, synthèses, dossiers, bibliographies…), propose des services de recherches, questions-réponses par mail, fourniture de documents pour les publics interne et externe.",
              url: "http://crdaln.intradoc.metier.i2/",
              image: "crdaln-intradoc.png"
            }
          ]
        },
        {
          label: "Bourgogne-Franche-Comté",
          liens: [
            {
              nom: "Portail de la donnée et de la connaissance IDéO BFC",
              description:
                "Les pilotes du dispositif que sont l'Etat, la Région et Territoires Numériques vous proposent un portail où sera, à terme, recensé et partagé l'ensemble du patrimoine de données qui existe à l'échelle régionale. Ces informations sont des données (géographiques, statistiques, ouvertes ou restreintes) et des documents (études, rapports...).",
              url: " https://ideo.ternum-bfc.fr/",
              image: "bfc-ideo-2019-210px-fond-blanc.png"
            }
          ]
        },
        {
          label: "Bretagne",
          liens: [
            {
              nom: "Études et prospective",
              description:
                "Vous trouverez dans ces pages de la DREAL : des informations et des documents relatifs à l’organisation régionale des études ; des ressources sur les études en région et la prospective territoriale ; des informations sur le réseau connaissance et observation en Bretagne et la valorisation des études",
              url:
                "http://intra.dreal-bretagne.e2.rie.gouv.fr/etudes-et-prospective-r2974.html",
              image: "br-bretagne-etude_et_prospective.png"
            },
            {
              nom: "Catalogue des études",
              description:
                "Vous trouverez dans ces pages de la DREAL les études classées par thématiques ",
              url:
                "http://www.bretagne.developpement-durable.gouv.fr/catalogue-des-etudes-r50.html",
              image: "br-bretagne-catalogue_des_etudes.png"
            }
          ]
        },
        {
          label: "Centre-Val de Loire",
          liens: [
            {
              nom: "Site internet DREAL Centre-VDL",
              description:
                "",
              url:
                "http://www.centre-val-de-loire.developpement-durable.gouv.fr/",
              image: "cvl-MLvaaS.png"
            },
            {
              nom:
                "Site REE « l’Environnement en France » rapport sur l’état de l’environnement",
              description:
                "Cette page rassemble les principaux sites internet publics mettant à disposition des informations concernant la région et l’ensemble des thématiques environnementales. Il peut s’agir de sites internet d’organismes publics (services de l’État, établissements publics, observatoires thématiques…), de bases de données thématiques ou de plateformes d’informations géographiques. Pour faciliter l’accès à l’information, ces sites sont classés par grands domaines.",
              url:
                "https://ree.developpement-durable.gouv.fr/spip.php?page=rubrique&id_rubrique=143&region=26",
              image: "cvl-ezx5SX.jpg"
            },
            {
              nom:
                "Profil environnemental régional Centre-Val de Loire",
              description:
                "Une cinquantaine d’indicateurs sur l’environnement en région Centre-Val de Loire sont rassemblés et commentés dans cette publication synthétique, qui reprend les thématiques approfondies dans le cadre du profil environnemental régional",
              url:
                "http://www.centre-val-de-loire.developpement-durable.gouv.fr/profil-environnemental-regional-centre-val-de-r889.html",
              image: "cvl_profil-enviro.png"
            }
          ]
        },
        {
          label: "Grand Est",
          liens: [
            {
              nom: "Grand Est Ressources",
              description:
                "Publication interne à destination des services DREAL GE - DDT du territoire GE - DRAAF GE - SGARE par mail",
              url:
                "http://intra.dreal-grand-est.e2.rie.gouv.fr/grand-est-ressources-a54942.html",
              image: "ge-grand-est-ressources2.png"
            },
            {
              nom: "Cartothèque de la DREAL",
              description:
                "Toutes les cartes utiles, interactives, statiques...",
              url:
                "http://intra.dreal-grand-est.e2.rie.gouv.fr/cartotheque-r1207.html",
              image: "ge-carthotheque.png"
            },
            {
              nom: "Les diagnostics Grand Est de la DREAL",
              description: "",
              url:
                "http://intra.dreal-grand-est.e2.rie.gouv.fr/les-diagnostics-grand-est-a3427.html",
              image: "ge-diagnosticsge.png"
            },
            {
              nom: "Catalogue régional de données",
              description: "",
              url:
                "http://intra.dreal-grand-est.e2.rie.gouv.fr/catalogue-regional-des-donnees-a2161.html",
              image: "ge_cataloguedesdonnees.png"
            },
            {
              nom: "Portraits de territoire",
              description: "",
              url:
                "http://intra.dreal-grand-est.e2.rie.gouv.fr/portraits-de-territoire-r14666.html",
              image: "ge-portraitdeterritoire.png"
            },
            {
              nom: "Data Grand Est",
              description:
                "Plateforme de la donnée en Grand Est : La dynamique DataGrandEst est mise en œuvre par l’État et la Région Grand Est pour développer la coopération régionale en matière de production, de partage et de valorisation de données dans le Grand Est",
              url: "https://www.geograndest.fr/portail/fr",
              image: "ge-dge.png"
            }
          ]
        },
        {
          label: "Normandie",
          liens: [
            {
              nom: "ETUDE ET PUBLICATIONS",
              description:
                "Vous trouverez sur cet espace ETUDE ET PUBLICATIONS toute l’information utile sur les études : les financements, le CEREMA, les publications, le BRGM... ",
              url:
                "http://intra.dreal-normandie.e2.rie.gouv.fr/etudes-et-publications-r3336.html",
              image: "etude_et_publications.png"
            },
            {
              nom: "CIRCÉ",
              description:
                "CIRCÉ, le Catalogue Interactif Régional de Consultation des Études, est un espace de partage des études, des analyses et des rapports produits en Normandie et sur la Normandie. Élaboré en 2014, CIRCÉ est le fruit d'un travail partenarial entre la DREAL Normandie et la Région Normandie.",
              url: "http://www.etudes-normandie.fr/accueil?",
              image: "cirece.png"
            },
            {
              nom:
                "DEMP - Données environnementales pour mon projet en Normandie",
              description:
                "Ce  site internet propose une aide aux poteurs de projets pour préciser et adapter l’insertion environnementale de leur projet. Il permet aussi d’interroger les données de la DREAL par approche cartographique.",
              url: "https://demp.dreal-norm.fr/",
              image: "demp.png"
            },
            {
              nom: "CARTO SI",
              description:
                "Liens vers des systèmes d’informations  classés par thématiques",
              url:
                "http://www.donnees.normandie.developpement-durable.gouv.fr/carto_si/carto_si.php",
              image: "carto_si.png"
            }
          ]
        },
        {
          label: "Nouvelle-Aquitaine",
          liens: [
            {
              nom: " FERNA - Forum des Etudes Régionales en Nouvelle-Aquitaine",
              description:
                "La plateforme FERNA est un outil de partage des travaux de connaissance produits par les services de l'Etat en Nouvelle-Aquitaine. Elle est pilotée et administrée par le SGAR.",
              url: " http://www.ferna.fr",
              image: "nl-ferna.png"
            }
          ]
        }
      ]
    };
  },
  created() {
    this.$store.dispatch("studies/fetchStudies");
  },
  methods: {
    create: function() {
      this.$router.push("/new");
    }
  },
  computed: {
    searchOnly: function() {
      return this.$route.path !== "/";
    },
    ...mapState("security", ["subject"]),
    ...mapGetters("security", ["isConnected"]),
    ...mapState("studies", ["perimetre", "globalFilters"])
  }
};
</script>

<style></style>

````

</details>


---

### 📄 `src/views/Login.vue` [893 octets]
<a id="src-views-Login-vue"></a> [↩ Retour à l'arborescence](#tree-src-views-Login-vue)

> **Chemin relatif** : `src/views/Login.vue`  
> **Taille** : 893 octets  
> **Lignes** : 39  
> **Type** : text

```text
<template>
  <v-card width="400" class="mx-auto mt-5">
    <v-card-title>
      <h1 class="display-1">Login</h1>
    </v-card-title>
    <v-card-text>
      <v-form>
        <v-text-field label="Username" prepend-icon="mdi-account-circle" />
        <v-text-field
          :type="showPassword ? 'text' : 'password'"
          label="Password"
          prepend-icon="mdi-lock"
          :append-icon="showPassword ? 'mdi-eye' : 'mdi-eye-off'"
          @click:append="showPassword = !showPassword"
        />
      </v-form>
    </v-card-text>
    <v-divider></v-divider>
    <v-card-actions>
      <v-btn color="success">Register</v-btn>
      <v-spacer></v-spacer>
      <v-btn color="info">Login</v-btn>
    </v-card-actions>
  </v-card>
</template>

<script>
export default {
  name: "LoginPage",
  data() {
    return {
      showPassword: false
    };
  }
};
</script>

<style></style>

```


---

### 📄 `src/views/Statistiques.vue` [1.488 octets]
<a id="src-views-Statistiques-vue"></a> [↩ Retour à l'arborescence](#tree-src-views-Statistiques-vue)

> **Chemin relatif** : `src/views/Statistiques.vue`  
> **Taille** : 1.488 octets  
> **Lignes** : 64  
> **Type** : text

```text
<template>
  <div>
    <v-content>
      <v-container fluid>
        <v-row>
          <v-col md="6" cols="12">
            <v-card>
              <v-card-title>test</v-card-title>
              <v-card-text>content test</v-card-text>
            </v-card>
          </v-col>
          <v-col md="6" cols="12">
            <v-card>
              <v-card-title>test</v-card-title>
              <v-card-text>content test</v-card-text>
            </v-card>
          </v-col>
          <v-col md="6" cols="12">
            <v-card>
              <v-card-title>test</v-card-title>
              <v-card-text>content test</v-card-text>
            </v-card>
          </v-col>
          <v-col md="6" cols="12">
            <v-card>
              <v-card-title>test</v-card-title>
              <v-card-text>content test</v-card-text>
            </v-card>
          </v-col>
        </v-row>
      </v-container>
    </v-content>
  </div>
</template>

<script>
import { mapState, mapGetters } from "vuex";

export default {
  name: "DashboardPage",
  data() {
    return {};
  },
  created() {
    this.$store.dispatch("studies/fetchStudies");
  },
  methods: {
    create: function() {
      this.$router.push("/new");
    }
  },
  computed: {
    searchOnly: function() {
      return this.$route.path !== "/";
    },
    ...mapState("security", ["subject"]),
    ...mapGetters("security", ["isConnected"]),
    ...mapState("studies", ["globalFilters"])
  }
};
</script>

<style></style>

```


---

### 📄 `src/views/Tutoriels.vue` [844 octets]
<a id="src-views-Tutoriels-vue"></a> [↩ Retour à l'arborescence](#tree-src-views-Tutoriels-vue)

> **Chemin relatif** : `src/views/Tutoriels.vue`  
> **Taille** : 844 octets  
> **Lignes** : 34  
> **Type** : text

```text
<template>
  <div>
    <v-content>
      <v-container fluid>
        <v-row>
          <v-col cols="12">
            <v-card>
              <v-card-title>Tutoriels</v-card-title>
        <v-list-item
          link
          href="https://webissimo.e2.rie.gouv.fr/IMG/mp4/tuto_agile_fonction_export_cle1c578f.mp4"
          target="_blank"
        >
          <v-list-item-action>
            <v-icon>mdi-filmstrip</v-icon>
          </v-list-item-action>
          <v-list-item-content>
            <v-list-item-title>
              "La fonction export"
              <v-icon dense small right>mdi-open-in-new</v-icon>
            </v-list-item-title>
          </v-list-item-content>
        </v-list-item>
            </v-card>
          </v-col>
        </v-row>
      </v-container>
    </v-content>
  </div>
</template>


<style></style>

```


---

### 📄 `src/views/Videos.vue` [1.415 octets]
<a id="src-views-Videos-vue"></a> [↩ Retour à l'arborescence](#tree-src-views-Videos-vue)

> **Chemin relatif** : `src/views/Videos.vue`  
> **Taille** : 1.415 octets  
> **Lignes** : 50  
> **Type** : text

```text
<template>
  <div>
    <v-content>
      <v-container fluid>
        <v-row>
          <v-col cols="12">
            <v-card>
              <v-card-title>Vidéos</v-card-title>
        <v-list-item
          link
          href="https://webissimo.e2.rie.gouv.fr/IMG/mp4/agileitwcroiseesstandard_cle5c34d3.mp4"
          target="_blank"
        >
          <v-list-item-action>
            <v-icon>mdi-file-video</v-icon>
          </v-list-item-action>
          <v-list-item-content>
            <v-list-item-title>
              1/ L'avis des usagers de DDT(M) - DREAL - Ministère
              <v-icon dense small right>mdi-open-in-new</v-icon>
            </v-list-item-title>
          </v-list-item-content>
        </v-list-item>
        <v-list-item
          link
          href="https://webissimo.e2.rie.gouv.fr/IMG/mp4/agile_itw_yves_salaun_2022_cle12a478.mp4"
          target="_blank"
        >
          <v-list-item-action>
            <v-icon>mdi-file-video</v-icon>
          </v-list-item-action>
          <v-list-item-content>
            <v-list-item-title>
              2/ L'avis du directeur adjoint
              <v-icon dense small right>mdi-open-in-new</v-icon>
            </v-list-item-title>
          </v-list-item-content>
        </v-list-item>

            </v-card>
          </v-col>
        </v-row>
      </v-container>
    </v-content>
  </div>
</template>


<style></style>

```


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

`````

</details>


---

### 📄 `si/balise.analysis.md` [13.407 octets]
<a id="si-balise-analysis-md"></a> [↩ Retour à l'arborescence](#tree-si-balise-analysis-md)

> **Chemin relatif** : `si/balise.analysis.md`  
> **Taille** : 13.407 octets  
> **Lignes** : 461  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (461 lignes) - Cliquer pour déplier</summary>

````markdown
# ?? Analyse complète de lapplication **BALISE**

> **BALISE** = *BAse Légale Informatisée pour la Sécurité des remontées mécaniques et des transports guidés*  
> Application documentaire métier dédiée à la diffusion centralisée de textes réglementaires, circulaires, recommandations, etc., liés à la sécurité des équipements (remontées mécaniques, transports guidés).

---

## ?? Table des matières

- [1. Vue densemble fonctionnelle](#1-vue-densemble-fonctionnelle)
  - [1.1 Acteurs](#11-acteurs)
  - [1.2 Cas dusage principaux](#12-cas-dusage-principaux)
  - [1.3 Règles métier clés](#13-règles-métier-clés)
  - [1.4 Workflow de recherche](#14-workflow-de-recherche)
- [2. Architecture technique](#2-architecture-technique)
  - [2.1 Stack technologique](#21-stack-technologique)
  - [2.2 Arborescence fonctionnelle](#22-arborescence-fonctionnelle)
  - [2.3 Sécurité & contrôle daccès](#23-sécurité--contrôle-daccès)
- [3. Modélisation détaillée](#3-modélisation-détaillée)
  - [3.1 Diagramme de cas dusage](#31-diagramme-de-cas-dusage)
  - [3.2 Diagramme de composants](#32-diagramme-de-composants)
  - [3.3 Diagramme de classes (structures SDX)](#33-diagramme-de-classes-structures-sdx)
  - [3.4 Diagrammes de séquence critiques](#34-diagrammes-de-séquence-critiques)
  - [3.5 Machine à états : `query` ? `results`](#35-machine-à-états--query--results)
  - [3.6 Tableau décisionnel règles daccès](#36-tableau-décisionnel-règles-daccès)
- [4. Dette technique & risques](#4-dette-technique--risques)
  - [4.1 Problèmes repérés](#41-problèmes-repérés)
  - [4.2 Recommandations](#42-recommandations)

---

## 1. Vue densemble fonctionnelle

### 1.1 Acteurs

| Acteur | Rôle | Permissions (rôles SDX) | Accès aux bases |
|--------|------|-------------------------|-----------------|
| **Consultant anonyme** | Lecteur public |  | `balise_public` |
| **Agent STRMTG** | Interne DDT | `reseau` | `balise_public`, `balise_strmtg` |
| **Professionnel (RM/TG)** | Opérateur agréé | `profession` | `balise_public`, `balise_strmtg`, `balise_pro` |
| **Administrateur SDX** | Gestion technique | `balise:admin:sdx` | Toutes |
| **Super-admin (Cerbère)** | Contrôle SI | `ADMINISTRATEUR` | Toutes |

?? **Note** : Les profils sont mappés via Cerbère (`[profils-cerbere]` dans `security.ini`), avec une hiérarchie explicite.

```plantuml
@startuml Actors
actor "Consultant\n(public)" as user
actor "Agent STRMTG" as reseau
actor "Professionnel (RM/TG)" as pro
actor "Admin SDX" as admin
actor "Super-admin Cerbère" as cerbere

user .> (Rechercher)
reseau .> (Rechercher avancée)
reseau .> (Panier)
pro .> (Accès texte intégral)
admin .> (Upload / Suppression)
cerbere .> (Audit / Backup)

note right of admin
  Peut :<br/>
  - Optimiser bases<br/>
  - Vérifier intégrité<br/>
  - Sauvegarder app
end note
@enduml
```

---

### 1.2 Cas dusage principaux

| Cas dusage | Description | Pages impliquées |
|-------------|-------------|------------------|
| Recherche simple | Saisie libre + critères (domaine, type, date) | `recherche.xsp`, `recherche.xsl` |
| Recherche avancée | Formulaire structuré (opérateurs `and`/`or`/`not`, shingles, champs spécifiques) | `recherche-avancee.xsp`, `recherche-avancee.xsl` |
| Consultation document | Vue détaillée dun document + PJ | `document.xsp`, `document.xsl` |
| Gestion du panier | Ajout/retrait/export (PDF/RTF) | `panier.xsp`, `exportpanier.xsl` |
| Administration | Upload, suppression, indexation, audit | `admin/*.xsp`, `admin/*.xsl` |

---

### 1.3 Règles métier clés

#### ?? Règle daccès aux documents
Un document est visible si **au moins une** de ses valeurs `DIFFUSION_field` est autorisée pour lutilisateur :

```text
visible ? ? d ? document.DIFFUSION_field tel que d ? autorisations_utilisateur
```

Avec :
| Profil | Valeurs autorisées |
|--------|-------------------|
| Public | `PUBLIC` |
| Réseau | `PUBLIC`, `STRMTG` |
| Professionnel | `PUBLIC`, `STRMTG`, `PROFESSION` |

?? Implémenté via concaténation de clauses Lucene :
```java
String securityQuery = " ( DIFFUSION_field:|PUBLIC| ) ";
if (subject.isPermitted("reseau")) {
  securityQuery += " ( DIFFUSION_field:|STRMTG| ) ";
}
if (subject.isPermitted("profession")) {
  securityQuery += " (DIFFUSION_field:|PROFESSION|) ";
}
query = "+( " + userQuery + ") +( " + securityQuery + ") ";
```

#### ?? Règle de recherche multi-champs (`DOMAINES`)
Cas particulier : le domaine *« Remontées mécaniques et Transports guidés »* est traité comme **deux domaines distincts ET une combinaison** :

```java
if ("Remontées mécaniques et Transports guidés".equals(contenu)) {
  query += " +( (DOMAINE_field:|Remontées mécaniques|) "
         + " (DOMAINE_field:|Transports guidés| ) "
         + " (DOMAINE_field:|Remontées mécaniques et Transports guidés| ) ) ";
}
```

?? Modélisation logique :

| Valeur saisie | Interprétation Lucene |
|---------------|------------------------|
| `"RM"` | `DOMAINE_field:|RM|` |
| `"RM et TG"` | `(RM_field:|RM| AND RM_field:|TG|) OR RM_field:|RM et TG|` |

---

### 1.4 Workflow de recherche (simplifié)

```plantuml
@startuml SearchWorkflow
title Workflow de recherche avancée

[*] --> Saisie
Saisie --> Prétraitement : Submit

note right of Prétraitement
  - Échappement paramètres<br/>
  - Découpe mots<br/>
  - Génération Lucene<br/>
  - Ajout securityQuery
end note

Prétraitement --> Execution : Lucene query

Execution --> Résultats : sdx:results

Résultats --> Affichage : Transformation XSL

Affichage --> [*]
@enduml
```

---

## 2. Architecture technique

### 2.1 Stack technologique

| Couche | Technologies |
|--------|--------------|
| **Serveur** | Apache Tomcat + Apache Cocoon 2.x |
| **Langage** | Java (XSP), XSLT 1.0/2.0, XML |
| **Moteur de recherche** | Apache Lucene (indexation + requêtage) |
| **Stockage** | MySQL (document metadata), FS (PDF/annexes) |
| **Frontend** | HTML5, CSS, JS (jQuery UI, webshims, autocomplete) |
| **Authentification** | Cerbère (SSO), gestion rôles via `security.ini` |

---

### 2.2 Arborescence fonctionnelle

```plantuml
@startmindmap
* BALISE
** Configuration
*** conf/
**** security.ini
**** logicsheets/*.xsl
** Application
*** xsp/ : logique serveur (XSP)
**** recherche.xsp
**** document.xsp
**** panier.xsp
**** admin/*.xsp
*** xsl/ : présentation
**** skin.xsl
**** results.xsl
**** exportpanier*.xsl
** Librairies
*** sdxlib/
**** css/, js/, images/
** Données
*** /home/tomcat/webapps/sdx/documents/balise (fs-doc)
*** MySQL : base `balise`
@endmindmap
```

---

### 2.3 Sécurité & contrôle daccès

#### ?? Modèle de permissions (basé sur `security.ini`)

```ini
[roles]
admin      = balise:admin:sdx
reseau     = balise:balise-diffusion:reseau
profession = balise:balise-diffusion:profession
```

#### ??? Mapping Cerbère ? rôles SDX

```plantuml
@startuml CerbereMapping
rectangle "Cerbère" {
  [ADMINISTRATEUR] --> reseau
  [ADMINISTRATEUR] --> profession
  [CONTROLEUR] --> reseau
  [CONTROLEUR] --> profession
  [CONSULTANT] --> reseau
  [CONSULTANT] --> profession
  [PROFESSIONNEL] --> profession
  [EXPLOITANT] --> profession
  [SIEGEMODIF] --> reseau
  [SIEGEMODIF] --> profession
  [ORGAMODIF] --> profession
}
@enduml
```

> ? Aucun mot de passe en clair dans les fichiers fournis ? gestion via Cerbère (SSO).

---

## 3. Modélisation détaillée

### 3.1 Diagramme de cas dusage (complet)

```plantuml
@startuml UseCases
left to right direction
actor Utilisateur
actor Admin

rectangle "BALISE" {
  Utilisateur -- (Rechercher)
  Utilisateur -- (Consulter document)
  Utilisateur -- (Gérer panier)
  Utilisateur -- (Exporter PDF/RTF)

  Admin -- (Uploader document)
  Admin -- (Supprimer document)
  Admin -- (Optimiser index)
  Admin -- (Vérifier intégrité)
  Admin -- (Sauvegarder application)

  (Rechercher) .> (Recherche simple) : <<include>>
  (Rechercher) .> (Recherche avancée) : <<include>>
  (Exporter PDF/RTF) .> (Générer panier) : <<include>>
}
@enduml
```

---

### 3.2 Diagramme de composants

```plantuml
@startuml Components
package "Frontend" {
  [HTML/CSS/JS] --> [Cocoon Pipeline]
}
package "Cocoon" {
  [sitemap.xmap] --> [XSP Generator]
  [XSP Generator] --> [XSL Transformer]
  [XSL Transformer] --> [Serializer (HTML/PDF/RTF)]
}
package "Backend" {
  [XSP Logicsheets] --> [SDX Core]
  [SDX Core] --> [Lucene Index]
  [SDX Core] --> [MySQL DB]
  [SDX Core] --> [File System]
}
package "Auth" {
  [Cerbère SSO] --> [security.ini]
  [security.ini] --> [XSP Security Logicsheet]
}

[XSP Generator] ..> [XSP Logicsheets] : uses
[XSL Transformer] ..> [xsl/*.xsl] : applies
[SDX Core] ..> [sdxlib/conf/logicsheets/*.xsl] : embeds
@enduml
```

---

### 3.3 Diagramme de classes (structures SDX)

```plantuml
@startuml SDXClasses
class SDXApplication {
  +String id
  +String name
  +List<DocumentBase> bases
}

class DocumentBase {
  +String id
  +String name
  +List<Repository> repos
  +FieldList fields
}

class FieldList {
  +List<Field> fields
}

class Field {
  +String name
  +String type  // "field", "word", "date"
  +String analyzerClass  // ex: Analyzer_shingle
  +boolean brief
}

class Repository {
  +String id
  +String type  // "MYSQL", "FS"
  +String dsi / baseDirectory
}

SDXApplication "1" *-- "n" DocumentBase
DocumentBase "1" *-- "1" FieldList
FieldList "1" *-- "n" Field
DocumentBase "1" *-- "n" Repository
@enduml
```

> Extrait de `site-properties.xml` :
> ```xml
> <sdx:field name="OBJET_mots" type="word"
>   analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle"/>
> ```

---

### 3.4 Diagrammes de séquence critiques

#### ?? Séquence : Recherche avancée ? résultats

```plantuml
@startuml SeqRecherche
actor User
participant "recherche-avancee.xsp" as XSP
participant "sdxSearch.xsl" as Logicsheet
participant "Lucene" as Engine
participant "results.xsl" as XSL

User -> XSP : Submit formulaire
XSP -> Logicsheet : appelle queryProcessFunctions()
Logicsheet -> Logicsheet : traitement2(champ, contenu, op_mots, op_champ)
Logicsheet --> XSP : Lucene query string
XSP -> Engine : executeComplexQuery(query)
Engine --> XSP : sdx:results
XSP -> XSL : transforme avec results.xsl
XSL --> User : HTML affiché
@enduml
```

#### ?? Séquence : Upload + indexation

```plantuml
@startuml SeqUpload
actor Admin
participant "upload.xsp" as XSP
participant "sdxUtil.xsl" as Util
participant "Lucene Indexer" as Indexer

Admin -> XSP : Upload fichier XML/PDF
XSP -> Util : extractDocContent(docName)
Util --> XSP : texte brut + metadata
XSP -> Indexer : indexDocument(metadata, content)
Indexer --> XSP : OK / Exception
XSP --> Admin : Feedback (succès/erreur)
@enduml
```

---

### 3.5 Machine à états : `query` ? `results`

```plantuml
@startuml QueryStateMachine
[*] --> Empty
Empty --> Building : addField()
Building --> Building : addOperator()
Building --> Valid : finalize()
Valid --> Executing : execute()
Executing --> Results : success
Executing --> Error : exception
Results --> [*]
Error --> [*]

note right of Building
  États internes :
  - champ en cours
  - opérateur (and/or/not)
  - mode shingle ?
end note
@enduml
```

> Transitions pilotées par `traitement2()` et `traitementShingleSeul()` dans `sdxUtil.xsl`.

---

### 3.6 Tableau décisionnel : règles daccès

| Utilisateur | `DIFFUSION_field` | Accès ? | Explication |
|-------------|-------------------|---------|-------------|
| Public | `PUBLIC` | ? | Match direct |
| Public | `STRMTG` | ? | Non autorisé |
| Réseau | `PUBLIC` | ? | Inclus |
| Réseau | `STRMTG` | ? | Rôle `reseau` |
| Réseau | `PROFESSION` | ? | Nécessite `profession` |
| Professionnel | `PROFESSION` | ? | Rôle `profession` |
| Admin | `*` | ? | Superuser implicite |

? Implémenté via clause Lucene `+(securityQuery)`.

---

## 4. Dette technique & risques

### 4.1 Problèmes repérés

| Risque | Localisation | Gravité | Commentaire |
|--------|--------------|---------|-------------|
| **XSLT 1.0 + Java logique dans XSP** | `conf/logicsheets/sdxUtil.xsl`, `xsp/*.xsp` | ?? Élevée | Code métier fragmenté, difficile à tester/maintenir |
| **Doublons XML** | multiples extraits GPL | ?? Moyenne | Redondance de notices légales ? risque de désync |
| **Hardcoded paths** | `sitemap.xmap`: `<fs-doc>/home/tomcat/...` | ?? Moyenne | Non portable, dépend du déploiement |
| **Mix HTML/XML** | espace dans attributs (`xmlns= " "`) | ?? Bloquant | Risque parsing (ex: `site-properties.xml`) |
| **Pas de tests** | aucun fichier `test/` ou `*.t` | ?? Élevée | Maintenance à haut risque |

---

### 4.2 Recommandations

| Priorité | Action | Bénéfice |
|----------|--------|----------|
| ?? **Urgent** | Corriger les espaces dans `xmlns=` | Éviter crash parsing |
| ?? **Haut** | Extraire la logique de `traitement2()` dans service Java testable | Sécuriser les requêtes |
| ?? **Haut** | Externaliser `<fs-doc>` via paramètre Cocoon | Portabilité |
| ?? **Moyen** | Centraliser les notices GPL dans un fichier unique | Réduction dette doc |
| ?? **Long terme** | Migrer vers Spring Boot + Elasticsearch | Modernisation stack |


````

</details>


---

### 📄 `si/balise.md` [902.864 octets]
<a id="si-balise-md"></a> [↩ Retour à l'arborescence](#tree-si-balise-md)

> **Chemin relatif** : `si/balise.md`  
> **Taille** : 902.864 octets  
> **Lignes** : 23489  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (23489 lignes) - Cliquer pour déplier</summary>

````markdown
﻿# Projet : balise

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\balise`

**Fichiers** : 100 fichiers non-binaires

## 📁 Arborescence des fichiers

├── **admin/**
│   ├── **xsl/**
│   │   ├── <a id="tree-admin-xsl-admin-xsl"></a>[admin.xsl](#admin-xsl-admin-xsl) *(19.705 octets)*
│   │   ├── <a id="tree-admin-xsl-afficheoptions-xsl"></a>[afficheoptions.xsl](#admin-xsl-afficheoptions-xsl) *(2.584 octets)*
│   │   ├── <a id="tree-admin-xsl-auto-delete-inter-xsl"></a>[auto-delete-inter.xsl](#admin-xsl-auto-delete-inter-xsl) *(1.731 octets)*
│   │   ├── <a id="tree-admin-xsl-auto-delete-xsl"></a>[auto-delete.xsl](#admin-xsl-auto-delete-xsl) *(1.731 octets)*
│   │   ├── <a id="tree-admin-xsl-auto-upload-2-xsl"></a>[auto-upload-2.xsl](#admin-xsl-auto-upload-2-xsl) *(5.114 octets)*
│   │   ├── <a id="tree-admin-xsl-auto-upload-inter-xsl"></a>[auto-upload-inter.xsl](#admin-xsl-auto-upload-inter-xsl) *(5.114 octets)*
│   │   ├── <a id="tree-admin-xsl-auto-upload-xsl"></a>[auto-upload.xsl](#admin-xsl-auto-upload-xsl) *(5.114 octets)*
│   │   ├── <a id="tree-admin-xsl-delete-xsl"></a>[delete.xsl](#admin-xsl-delete-xsl) *(1.731 octets)*
│   │   ├── <a id="tree-admin-xsl-deleteByQuery-2-xsl"></a>[deleteByQuery-2.xsl](#admin-xsl-deleteByQuery-2-xsl) *(1.738 octets)*
│   │   ├── <a id="tree-admin-xsl-deleteByQuery-xsl"></a>[deleteByQuery.xsl](#admin-xsl-deleteByQuery-xsl) *(1.738 octets)*
│   │   ├── <a id="tree-admin-xsl-explorer-xsl"></a>[explorer.xsl](#admin-xsl-explorer-xsl) *(74.469 octets)*
│   │   ├── <a id="tree-admin-xsl-login-xsl"></a>[login.xsl](#admin-xsl-login-xsl) *(4.250 octets)*
│   │   ├── <a id="tree-admin-xsl-logout-xsl"></a>[logout.xsl](#admin-xsl-logout-xsl) *(1.675 octets)*
│   │   ├── <a id="tree-admin-xsl-recherche2-xsl"></a>[recherche2.xsl](#admin-xsl-recherche2-xsl) *(20.734 octets)*
│   │   ├── <a id="tree-admin-xsl-recherchelucene-xsl"></a>[recherchelucene.xsl](#admin-xsl-recherchelucene-xsl) *(1.992 octets)*
│   │   ├── <a id="tree-admin-xsl-skin-xsl"></a>[skin.xsl](#admin-xsl-skin-xsl) *(16.016 octets)*
│   │   ├── <a id="tree-admin-xsl-suppqid-xsl"></a>[suppqid.xsl](#admin-xsl-suppqid-xsl) *(1.909 octets)*
│   │   ├── <a id="tree-admin-xsl-suppression-xsl"></a>[suppression.xsl](#admin-xsl-suppression-xsl) *(6.476 octets)*
│   │   └── <a id="tree-admin-xsl-upload-xsl"></a>[upload.xsl](#admin-xsl-upload-xsl) *(5.123 octets)*
│   ├── <a id="tree-admin-admin-xmap"></a>[admin.xmap](#admin-admin-xmap) *(3.056 octets)*
│   ├── <a id="tree-admin-admin-xsp"></a>[admin.xsp](#admin-admin-xsp) *(2.653 octets)*
│   ├── <a id="tree-admin-afficheoptions-xsp"></a>[afficheoptions.xsp](#admin-afficheoptions-xsp) *(1.591 octets)*
│   ├── <a id="tree-admin-auto-delete-inter-xsp"></a>[auto-delete-inter.xsp](#admin-auto-delete-inter-xsp) *(1.939 octets)*
│   ├── <a id="tree-admin-auto-delete-xsp"></a>[auto-delete.xsp](#admin-auto-delete-xsp) *(1.934 octets)*
│   ├── <a id="tree-admin-auto-upload-2-xsp"></a>[auto-upload-2.xsp](#admin-auto-upload-2-xsp) *(2.638 octets)*
│   ├── <a id="tree-admin-auto-upload-inter-xsp"></a>[auto-upload-inter.xsp](#admin-auto-upload-inter-xsp) *(2.148 octets)*
│   ├── <a id="tree-admin-auto-upload-xsp"></a>[auto-upload.xsp](#admin-auto-upload-xsp) *(2.671 octets)*
│   ├── <a id="tree-admin-delete-xsp"></a>[delete.xsp](#admin-delete-xsp) *(2.012 octets)*
│   ├── <a id="tree-admin-deleteByQuery-2-xsp"></a>[deleteByQuery-2.xsp](#admin-deleteByQuery-2-xsp) *(1.997 octets)*
│   ├── <a id="tree-admin-deleteByQuery-xsp"></a>[deleteByQuery.xsp](#admin-deleteByQuery-xsp) *(2.065 octets)*
│   ├── <a id="tree-admin-explorer-xsp"></a>[explorer.xsp](#admin-explorer-xsp) *(4.328 octets)*
│   ├── <a id="tree-admin-login-xsp"></a>[login.xsp](#admin-login-xsp) *(1.536 octets)*
│   ├── <a id="tree-admin-logout-xsp"></a>[logout.xsp](#admin-logout-xsp) *(293 octets)*
│   ├── <a id="tree-admin-recherchelucene-xsp"></a>[recherchelucene.xsp](#admin-recherchelucene-xsp) *(1.390 octets)*
│   ├── <a id="tree-admin-suppqid-xsp"></a>[suppqid.xsp](#admin-suppqid-xsp) *(1.605 octets)*
│   ├── <a id="tree-admin-suppression-xsp"></a>[suppression.xsp](#admin-suppression-xsp) *(4.168 octets)*
│   └── <a id="tree-admin-upload-xsp"></a>[upload.xsp](#admin-upload-xsp) *(2.277 octets)*
├── **conf/**
│   ├── **logicsheets/**
│   │   └── <a id="tree-conf-logicsheets-sdxUtil-xsl"></a>[sdxUtil.xsl](#conf-logicsheets-sdxUtil-xsl) *(25.943 octets)*
│   ├── <a id="tree-conf-application-xconf"></a>[application.xconf](#conf-application-xconf) *(35.696 octets)*
│   ├── <a id="tree-conf-index-balise-xsl"></a>[index-balise.xsl](#conf-index-balise-xsl) *(12.945 octets)*
│   └── <a id="tree-conf-security-ini"></a>[security.ini](#conf-security-ini) *(615 octets)*
├── **css/**
│   └── <a id="tree-css-local-css"></a>[local.css](#css-local-css) *(1.306 octets)*
├── **sdxlib/**
│   ├── **conf/**
│   │   └── **logicsheets/**
│   │       ├── <a id="tree-sdxlib-conf-logicsheets-sdxSearch-xsl"></a>[sdxSearch.xsl](#sdxlib-conf-logicsheets-sdxSearch-xsl) *(3.589 octets)*
│   │       └── <a id="tree-sdxlib-conf-logicsheets-sdxSecurity-xsl"></a>[sdxSecurity.xsl](#sdxlib-conf-logicsheets-sdxSecurity-xsl) *(4.334 octets)*
│   ├── **css/**
│   │   ├── **jquery-ui/**
│   │   │   ├── <a id="tree-sdxlib-css-jquery-ui-jquery-ui-1-10-3-custom-css"></a>[jquery-ui-1.10.3.custom.css](#sdxlib-css-jquery-ui-jquery-ui-1-10-3-custom-css) *(2.888 octets)*
│   │   │   └── <a id="tree-sdxlib-css-jquery-ui-jquery-ui-1-10-3-custom-min-css"></a>[jquery-ui-1.10.3.custom.min.css](#sdxlib-css-jquery-ui-jquery-ui-1-10-3-custom-min-css) *(2.008 octets)*
│   │   ├── <a id="tree-sdxlib-css-autocomplete-css"></a>[autocomplete.css](#sdxlib-css-autocomplete-css) *(573 octets)*
│   │   ├── <a id="tree-sdxlib-css-color-blue-css"></a>[color-blue.css](#sdxlib-css-color-blue-css) *(4.113 octets)*
│   │   ├── <a id="tree-sdxlib-css-color-gray-css"></a>[color-gray.css](#sdxlib-css-color-gray-css) *(4.210 octets)*
│   │   ├── <a id="tree-sdxlib-css-color-green-css"></a>[color-green.css](#sdxlib-css-color-green-css) *(4.047 octets)*
│   │   ├── <a id="tree-sdxlib-css-color-purple-css"></a>[color-purple.css](#sdxlib-css-color-purple-css) *(4.065 octets)*
│   │   ├── <a id="tree-sdxlib-css-jquery-autocomplete-css"></a>[jquery.autocomplete.css](#sdxlib-css-jquery-autocomplete-css) *(744 octets)*
│   │   └── <a id="tree-sdxlib-css-pandoc-base-css"></a>[pandoc-base.css](#sdxlib-css-pandoc-base-css) *(25.651 octets)*
│   ├── **images/**
│   │   └── **onglet_fichiers/**
│   │       └── <a id="tree-sdxlib-images-onglet_fichiers-pandoc-base-css"></a>[pandoc-base.css](#sdxlib-images-onglet_fichiers-pandoc-base-css) *(2.991 octets)*
│   ├── **js/**
│   │   ├── **jquery/**
│   │   │   └── <a id="tree-sdxlib-js-jquery-jquery-tooltip-css"></a>[jquery.tooltip.css](#sdxlib-js-jquery-jquery-tooltip-css) *(588 octets)*
│   │   └── **webshims/**
│   │       └── **shims/**
│   │           ├── **FlashCanvas/**
│   │           │   ├── <a id="tree-sdxlib-js-webshims-shims-FlashCanvas-proxy-php"></a>[proxy.php](#sdxlib-js-webshims-shims-FlashCanvas-proxy-php) *(2.392 octets)*
│   │           │   └── <a id="tree-sdxlib-js-webshims-shims-FlashCanvas-save-php"></a>[save.php](#sdxlib-js-webshims-shims-FlashCanvas-save-php) *(1.945 octets)*
│   │           ├── **FlashCanvasPro/**
│   │           │   ├── <a id="tree-sdxlib-js-webshims-shims-FlashCanvasPro-proxy-php"></a>[proxy.php](#sdxlib-js-webshims-shims-FlashCanvasPro-proxy-php) *(2.392 octets)*
│   │           │   └── <a id="tree-sdxlib-js-webshims-shims-FlashCanvasPro-save-php"></a>[save.php](#sdxlib-js-webshims-shims-FlashCanvasPro-save-php) *(1.945 octets)*
│   │           ├── **i18n/**
│   │           │   ├── <a id="tree-sdxlib-js-webshims-shims-i18n-formcfg-de-txt"></a>[formcfg-de.txt](#sdxlib-js-webshims-shims-i18n-formcfg-de-txt) *(3.195 octets)*
│   │           │   └── <a id="tree-sdxlib-js-webshims-shims-i18n-formcfg-en-txt"></a>[formcfg-en.txt](#sdxlib-js-webshims-shims-i18n-formcfg-en-txt) *(2.745 octets)*
│   │           ├── **jpicker/**
│   │           │   ├── <a id="tree-sdxlib-js-webshims-shims-jpicker-ChangeLog-txt"></a>[ChangeLog.txt](#sdxlib-js-webshims-shims-jpicker-ChangeLog-txt) *(10.137 octets)*
│   │           │   ├── <a id="tree-sdxlib-js-webshims-shims-jpicker-ReadMe-txt"></a>[ReadMe.txt](#sdxlib-js-webshims-shims-jpicker-ReadMe-txt) *(1.986 octets)*
│   │           │   └── <a id="tree-sdxlib-js-webshims-shims-jpicker-jpicker-css"></a>[jpicker.css](#sdxlib-js-webshims-shims-jpicker-jpicker-css) *(4.436 octets)*
│   │           └── **styles/**
│   │               ├── **scss/**
│   │               │   └── <a id="tree-sdxlib-js-webshims-shims-styles-scss-shim-scss"></a>[shim.scss](#sdxlib-js-webshims-shims-styles-scss-shim-scss) *(20.873 octets)*
│   │               ├── <a id="tree-sdxlib-js-webshims-shims-styles-config-rb"></a>[config.rb](#sdxlib-js-webshims-shims-styles-config-rb) *(251 octets)*
│   │               └── <a id="tree-sdxlib-js-webshims-shims-styles-shim-css"></a>[shim.css](#sdxlib-js-webshims-shims-styles-shim-css) *(18.322 octets)*
│   ├── **services/**
│   │   └── **xsp/**
│   │       └── <a id="tree-sdxlib-services-xsp-thumbnailService-xsp"></a>[thumbnailService.xsp](#sdxlib-services-xsp-thumbnailService-xsp) *(2.651 octets)*
│   ├── **xsl/**
│   │   ├── <a id="tree-sdxlib-xsl-404-xsl"></a>[404.xsl](#sdxlib-xsl-404-xsl) *(2.296 octets)*
│   │   ├── <a id="tree-sdxlib-xsl-ajoutepanier-xsl"></a>[ajoutepanier.xsl](#sdxlib-xsl-ajoutepanier-xsl) *(1.535 octets)*
│   │   ├── <a id="tree-sdxlib-xsl-contenupanier-xsl"></a>[contenupanier.xsl](#sdxlib-xsl-contenupanier-xsl) *(1.670 octets)*
│   │   ├── <a id="tree-sdxlib-xsl-extract-id-xsl"></a>[extract-id.xsl](#sdxlib-xsl-extract-id-xsl) *(1.989 octets)*
│   │   ├── <a id="tree-sdxlib-xsl-retraitpanier-xsl"></a>[retraitpanier.xsl](#sdxlib-xsl-retraitpanier-xsl) *(1.535 octets)*
│   │   ├── <a id="tree-sdxlib-xsl-sdx-default-xsl"></a>[sdx-default.xsl](#sdxlib-xsl-sdx-default-xsl) *(38.508 octets)*
│   │   └── <a id="tree-sdxlib-xsl-skin-xsl"></a>[skin.xsl](#sdxlib-xsl-skin-xsl) *(211.053 octets)*
│   └── **xsp/**
│       ├── <a id="tree-sdxlib-xsp-ajoutepanier-xsp"></a>[ajoutepanier.xsp](#sdxlib-xsp-ajoutepanier-xsp) *(2.309 octets)*
│       ├── <a id="tree-sdxlib-xsp-contenupanier-xsp"></a>[contenupanier.xsp](#sdxlib-xsp-contenupanier-xsp) *(1.630 octets)*
│       ├── <a id="tree-sdxlib-xsp-extraction-pdf-xsp"></a>[extraction-pdf.xsp](#sdxlib-xsp-extraction-pdf-xsp) *(3.779 octets)*
│       ├── <a id="tree-sdxlib-xsp-menu-connexion-xsp"></a>[menu-connexion.xsp](#sdxlib-xsp-menu-connexion-xsp) *(1.918 octets)*
│       ├── <a id="tree-sdxlib-xsp-retraitpanier-xsp"></a>[retraitpanier.xsp](#sdxlib-xsp-retraitpanier-xsp) *(2.273 octets)*
│       └── <a id="tree-sdxlib-xsp-suggest-xsp"></a>[suggest.xsp](#sdxlib-xsp-suggest-xsp) *(23.305 octets)*
├── **xsl/**
│   └── <a id="tree-xsl-skin-xsl"></a>[skin.xsl](#xsl-skin-xsl) *(2.127 octets)*
├── **xsp/**
│   ├── <a id="tree-xsp-actu-xsp"></a>[actu.xsp](#xsp-actu-xsp) *(2.061 octets)*
│   ├── <a id="tree-xsp-aide-xsp"></a>[aide.xsp](#xsp-aide-xsp) *(2.528 octets)*
│   ├── <a id="tree-xsp-checkUserPermission-xsp"></a>[checkUserPermission.xsp](#xsp-checkUserPermission-xsp) *(3.660 octets)*
│   ├── <a id="tree-xsp-contacts-xsp"></a>[contacts.xsp](#xsp-contacts-xsp) *(1.655 octets)*
│   ├── <a id="tree-xsp-document-xsp"></a>[document.xsp](#xsp-document-xsp) *(8.741 octets)*
│   ├── <a id="tree-xsp-footer-menu-xsp"></a>[footer-menu.xsp](#xsp-footer-menu-xsp) *(1.944 octets)*
│   ├── <a id="tree-xsp-historique-xsp"></a>[historique.xsp](#xsp-historique-xsp) *(1.740 octets)*
│   ├── <a id="tree-xsp-index-xsp"></a>[index.xsp](#xsp-index-xsp) *(4.847 octets)*
│   ├── <a id="tree-xsp-menu-main-xsp"></a>[menu-main.xsp](#xsp-menu-main-xsp) *(1.886 octets)*
│   ├── <a id="tree-xsp-panier-xsp"></a>[panier.xsp](#xsp-panier-xsp) *(3.987 octets)*
│   ├── <a id="tree-xsp-recherche-avancee-xsp"></a>[recherche-avancee.xsp](#xsp-recherche-avancee-xsp) *(5.863 octets)*
│   ├── <a id="tree-xsp-recherche-xsp"></a>[recherche.xsp](#xsp-recherche-xsp) *(4.116 octets)*
│   ├── <a id="tree-xsp-resultats-xsp"></a>[resultats.xsp](#xsp-resultats-xsp) *(10.034 octets)*
│   ├── <a id="tree-xsp-suggest-xsp"></a>[suggest.xsp](#xsp-suggest-xsp) *(23.894 octets)*
│   └── <a id="tree-xsp-userisLoggedIn-xsp"></a>[userisLoggedIn.xsp](#xsp-userisLoggedIn-xsp) *(2.690 octets)*
├── <a id="tree-README-md"></a>[README.md](#README-md) *(268 octets)*
├── <a id="tree-site-properties-xml"></a>[site-properties.xml](#site-properties-xml) *(2.997 octets)*
└── <a id="tree-sitemap-xmap"></a>[sitemap.xmap](#sitemap-xmap) *(23.522 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `admin/admin.xmap` [3.056 octets]
<a id="admin-admin-xmap"></a> [↩ Retour à l'arborescence](#tree-admin-admin-xmap)

> **Chemin relatif** : `admin/admin.xmap`  
> **Taille** : 3.056 octets  
> **Lignes** : 78  
> **Type** : text

```text
<?xml version="1.0"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<!-- Sitemap for the sdxworld application -->
<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">
	<map:pipelines>
		<map:pipeline>
			<map:match pattern="admin/">
				<map:redirect-to uri="admin.xsp" />
			</map:match>
			<map:match pattern="admin/*.xsp">
				<map:generate type="xsp" src="{1}.xsp"/>
				<map:transform src="xsl/{1}.xsl">
					<map:parameter name="use-request-parameters" value="true"/>
				</map:transform>
				<map:serialize/>
			</map:match>
			<map:match pattern="admin/icons/*.gif">
				<map:read type="image" src="../icons/{1}.gif" mime-type="image/gif" />
			</map:match>
			<map:match pattern="admin/icons/*.png">
				<map:read type="image" src="../icons/{1}.png" mime-type="image/png" />
			</map:match>
			<map:match pattern="admin/icons/*.jpg">
				<map:read type="image" src="../icons/{1}.jpg" mime-type="image/jpg" />
			</map:match>
			<map:match pattern="admin/icons/*.ico">
				<map:read type="image" src="../icons/{1}.ico" mime-type="image/x-icon" />
			</map:match>
			<map:match pattern="admin/images/*.gif">
				<map:read type="image" src="../images/{1}.gif" mime-type="image/gif" />
			</map:match>
			<map:match pattern="admin/images/*.png">
				<map:read type="image" src="../images/{1}.png" mime-type="image/png" />
			</map:match>
			<map:match pattern="admin/images/*.jpg">
				<map:read type="image" src="../images/{1}.jpg" mime-type="image/jpg" />
			</map:match>
			<map:match pattern="admin/images/*.ico">
				<map:read type="image" src="../images/{1}.ico" mime-type="image/x-icon" />
			</map:match>
			<map:match pattern="admin/*.css">
				<map:read src="../css/{1}.css" mime-type="text/css" />
			</map:match>
			<map:match pattern="admin/*.js">
				<map:read src="../js/{1}.js" mime-type="text/javascript" />
			</map:match>
		</map:pipeline>
	</map:pipelines>
</map:sitemap>

```


---

### 📄 `admin/admin.xsp` [2.653 octets]
<a id="admin-admin-xsp"></a> [↩ Retour à l'arborescence](#tree-admin-admin-xsp)

> **Chemin relatif** : `admin/admin.xsp`  
> **Taille** : 2.653 octets  
> **Lignes** : 76  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx">
	<sdx:page>
		<title>Interface d'administration</title>
		<bar/>
		<sdx:userIsAdmin>
			<title>Administration</title>
			<xsp:logic>
				String page=context.getRealPath(request.getServletPath());
				String app=page.substring(0, page.lastIndexOf(File.separator));
				String server=app.substring(0, app.lastIndexOf(File.separator));
    
				String query=(String)request.getParameter("q");
				if(query==null)
					query="sdxall:1";
			</xsp:logic>
<!--
			<documents>
				<xsp:attribute name="notices"><xsp:expr>app+File.separator+"documents"</xsp:expr></xsp:attribute>
			</documents>
-->
			
			<xsp:logic>
				String appId = sdx_app.getId();
				java.util.Enumeration e = sdx_app.getDocumentBasesIds();
				while (e.hasMoreElements()) {
					String base = (String)e.nextElement();
					if ( !base.equals("sdxuserdb") ){
						<pont><xsp:logic>request.getParameter("base");</xsp:logic></pont>
					<sdxbase>
						<xsp:attribute name="name"><xsp:expr>base</xsp:expr></xsp:attribute>
						<xsp:attribute name="action">upload.xsp</xsp:attribute>
						<sdx:executeSimpleQuery queryString="query" hpp="10" baseString="base">
						</sdx:executeSimpleQuery>
					</sdxbase>
					}
				}
			</xsp:logic>
            
			<sdx:fallback>
				<notadmin/>
				<link show="replace" actuate="onload" time="5" href="login.xsp"/>
			</sdx:fallback>
		</sdx:userIsAdmin>
	</sdx:page>
</xsp:page>

```


---

### 📄 `admin/afficheoptions.xsp` [1.591 octets]
<a id="admin-afficheoptions-xsp"></a> [↩ Retour à l'arborescence](#tree-admin-afficheoptions-xsp)

> **Chemin relatif** : `admin/afficheoptions.xsp`  
> **Taille** : 1.591 octets  
> **Lignes** : 48  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page xmlns:xsp="http://apache.org/xsp">
    <sdx:page  xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx">
		<rechercheavancee/>
		<title>Recherche avancée</title>
		<!--<xsp:logic>
			if(lang.equals("fr")){
				<title>Recherche avancée</title>
			}
			if(lang.equals("en")){
				<title>Advanced search</title>
			}
			if(lang.equals("es")){
				<title>Búsqueda avanzada</title>
			}
		</xsp:logic>-->
	</sdx:page>
</xsp:page>

```


---

### 📄 `admin/auto-delete-inter.xsp` [1.939 octets]
<a id="admin-auto-delete-inter-xsp"></a> [↩ Retour à l'arborescence](#tree-admin-auto-delete-inter-xsp)

> **Chemin relatif** : `admin/auto-delete-inter.xsp`  
> **Taille** : 1.939 octets  
> **Lignes** : 55  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx">
    <sdx:page>
		<title>Suppression de documents</title>
		<bar/>
		<xsp:logic>
			String ip = request.getRemoteAddr();
			if ("127.0.0.1".equals(ip)||"172.16.33.2".equals(ip)) {
				<title>Suppression</title>
				String id=(String)request.getParameter("id");
				if(id!=null){
					<sdx:deleteDocument base="noticesinter" dirParam="notices" idParam="id" delete="true">
						<sdx:fallback>
							<message type="echec_suppression">Echec suppression</message>
						</sdx:fallback>
					</sdx:deleteDocument>
				}else{
					<sdx:deleteDocuments delete="true" hpp="-1">
						<sdx:location/>
					</sdx:deleteDocuments>
				}
			}
		</xsp:logic>
	</sdx:page>
</xsp:page>

```


---

### 📄 `admin/auto-delete.xsp` [1.934 octets]
<a id="admin-auto-delete-xsp"></a> [↩ Retour à l'arborescence](#tree-admin-auto-delete-xsp)

> **Chemin relatif** : `admin/auto-delete.xsp`  
> **Taille** : 1.934 octets  
> **Lignes** : 55  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx">
    <sdx:page>
		<title>Suppression de documents</title>
		<bar/>
		<xsp:logic>
			String ip = request.getRemoteAddr();
			if ("127.0.0.1".equals(ip)||"172.16.33.2".equals(ip)) {
				<title>Suppression</title>
				String id=(String)request.getParameter("id");
				if(id!=null){
					<sdx:deleteDocument base="notices" dirParam="notices" idParam="id" delete="true">
						<sdx:fallback>
							<message type="echec_suppression">Echec suppression</message>
						</sdx:fallback>
					</sdx:deleteDocument>
				}else{
					<sdx:deleteDocuments delete="true" hpp="-1">
						<sdx:location/>
					</sdx:deleteDocuments>
				}
			}
		</xsp:logic>
	</sdx:page>
</xsp:page>

```


---

### 📄 `admin/auto-upload-2.xsp` [2.638 octets]
<a id="admin-auto-upload-2-xsp"></a> [↩ Retour à l'arborescence](#tree-admin-auto-upload-2-xsp)

> **Chemin relatif** : `admin/auto-upload-2.xsp`  
> **Taille** : 2.638 octets  
> **Lignes** : 64  
> **Type** : text

```text
<?xml version="1.0"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page xmlns:xsp="http://apache.org/xsp">
    <sdx:page xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" show="user get post additions">
        <xsp:logic>
	System.out.println("auto-upload.xsp : REQUETE HTTP RECU");
	System.out.print("auto-upload.xsp : Creation objet File...");
        File att=new File(context.getRealPath(request.getServletPath().substring(0, request.getServletPath().lastIndexOf('/')+1))+File.separator+"documents"+File.separator+"test.jpg");
	System.out.println("auto-upload.xsp : OK");
	System.out.print("auto-upload.xsp : Creation Date...");
        String jour=DateFormat.getDateInstance(DateFormat.FULL).format(new Date());
	System.out.println("auto-upload.xsp : OK");
        </xsp:logic>
		<bar/>
		<title>Import - réception des documents</title>
		<!--<sdx:userIsAdmin>&#32;-->
		<xsp:logic>
			System.out.print("auto-upload.xsp : Creation ip...");
			String ip=request.getRemoteAddr();
			System.out.println("auto-upload.xsp : OK( "+ip+" )");
			if ("127.0.0.1".equals(ip)||"172.16.33.2".equals(ip)) {
			<upload/>
			<sdx:debug>
				<sdx:uploadDocuments batch="1000" base="revues" dirParam="notices" includes="*.xml">
					<sdx:transformation type="XSLT" src="../conf/index-revues.xsl" srcParam="notices"/>
				</sdx:uploadDocuments>
			</sdx:debug>
			//System.out.print("auto-upload.xsp : Lancement optimize...");
			//sdx_base.optimize();
			System.out.println("auto-upload.xsp : OK");
			}
		</xsp:logic>
	<!--</sdx:userIsAdmin>-->
	</sdx:page>
</xsp:page>

```


---

### 📄 `admin/auto-upload-inter.xsp` [2.148 octets]
<a id="admin-auto-upload-inter-xsp"></a> [↩ Retour à l'arborescence](#tree-admin-auto-upload-inter-xsp)

> **Chemin relatif** : `admin/auto-upload-inter.xsp`  
> **Taille** : 2.148 octets  
> **Lignes** : 55  
> **Type** : text

```text
<?xml version="1.0"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page xmlns:xsp="http://apache.org/xsp">
    <sdx:page xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" show="user get post additions">
        <xsp:logic>
        File att=new File(context.getRealPath(request.getServletPath().substring(0, request.getServletPath().lastIndexOf('/')+1))+File.separator+"documents"+File.separator+"test.jpg");
        String jour=DateFormat.getDateInstance(DateFormat.FULL).format(new Date());
        </xsp:logic>
		<bar/>
		<title>Import - réception des documents</title>
		<!--<sdx:userIsAdmin>&#32;-->
		<xsp:logic>
			String ip=request.getRemoteAddr();
			if ("127.0.0.1".equals(ip)||"172.16.33.2".equals(ip)) {
			<upload/>
			<sdx:debug>
				<sdx:uploadDocuments batch="1000" base="noticesinter" dirParam="notices" includes="*.xml">
					<sdx:transformation type="XSLT" src="../../conf/index-notice.xsl" srcParam="notices"/>
				</sdx:uploadDocuments>
			</sdx:debug>
			sdx_base.optimize();
			}
		</xsp:logic>
	<!--</sdx:userIsAdmin>-->
	</sdx:page>
</xsp:page>

```


---

### 📄 `admin/auto-upload.xsp` [2.671 octets]
<a id="admin-auto-upload-xsp"></a> [↩ Retour à l'arborescence](#tree-admin-auto-upload-xsp)

> **Chemin relatif** : `admin/auto-upload.xsp`  
> **Taille** : 2.671 octets  
> **Lignes** : 64  
> **Type** : text

```text
<?xml version="1.0"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page xmlns:xsp="http://apache.org/xsp">
    <sdx:page xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" show="user get post additions">
        <xsp:logic>
	System.out.println("auto-upload.xsp : REQUETE HTTP RECU");
	System.out.print("auto-upload.xsp : Creation objet File...");
        File att=new File(context.getRealPath(request.getServletPath().substring(0, request.getServletPath().lastIndexOf('/')+1))+File.separator+"documents"+File.separator+"test.jpg");
	System.out.println("auto-upload.xsp : OK");
	System.out.print("auto-upload.xsp : Creation Date...");
        String jour=DateFormat.getDateInstance(DateFormat.FULL).format(new Date());
	System.out.println("auto-upload.xsp : OK");
        </xsp:logic>
		<bar/>
		<title>Import - réception des documents</title>
		<!--<sdx:userIsAdmin>&#32;-->
		<xsp:logic>
			System.out.print("auto-upload.xsp : Creation ip...");
			String ip=request.getRemoteAddr();
			System.out.println("auto-upload.xsp : OK( "+ip+" )");
			if ("127.0.0.1".equals(ip)||"172.16.33.2".equals(ip) || "0:0:0:0:0:0:0:1".equals(ip)) {
			<upload/>
			<sdx:debug>
				<sdx:uploadDocuments batch="1000" base="notices" dirParam="notices" includes="*.xml">
					<sdx:transformation type="XSLT" src="../conf/index-notice.xsl" srcParam="notices"/>
				</sdx:uploadDocuments>
			</sdx:debug>
			//System.out.print("auto-upload.xsp : Lancement optimize...");
			//sdx_base.optimize();
			System.out.println("auto-upload.xsp : OK");
			}
		</xsp:logic>
	<!--</sdx:userIsAdmin>-->
	</sdx:page>
</xsp:page>

```


---

### 📄 `admin/delete.xsp` [2.012 octets]
<a id="admin-delete-xsp"></a> [↩ Retour à l'arborescence](#tree-admin-delete-xsp)

> **Chemin relatif** : `admin/delete.xsp`  
> **Taille** : 2.012 octets  
> **Lignes** : 63  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx">
    <sdx:page>
		<bar/>
		<sdx:userIsAdmin>
			<retourAdmin/>
			<title>Suppression</title>
			<xsp:logic>
				<!--if(lang.equals("fr")){
					<title>Suppression</title>
				}
				if(lang.equals("en")){
					<title>Delete</title>
				}
				if(lang.equals("es")){
					<title>Eliminación</title>
				}-->
				String id=(String)request.getParameter("id");
				if(id!=null){
					<sdx:deleteDocument idParam="id" delete="true">
						<sdx:fallback>
							<message type="echec_suppression">Echec suppression</message>
						</sdx:fallback>
					</sdx:deleteDocument>
				}else{
					<sdx:deleteDocuments delete="true" hpp="-1">
						<sdx:location/>
					</sdx:deleteDocuments>
				}
			</xsp:logic>
		</sdx:userIsAdmin>
	</sdx:page>
</xsp:page>

```


---

### 📄 `admin/deleteByQuery-2.xsp` [1.997 octets]
<a id="admin-deleteByQuery-2-xsp"></a> [↩ Retour à l'arborescence](#tree-admin-deleteByQuery-2-xsp)

> **Chemin relatif** : `admin/deleteByQuery-2.xsp`  
> **Taille** : 1.997 octets  
> **Lignes** : 56  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx">
    <sdx:page>
		<title>Suppression de documents</title>
		<bar/>
		<xsp:logic>
			String ip = request.getRemoteAddr();
			if ("127.0.0.1".equals(ip)||"172.16.33.22".equals(ip)) {
				<title>Suppression</title>
				String q =  (String)request.getParameter("query");
				if ( q==null || q.equals("") ){

					<sdx:deleteDocument base="revues" dirParam="notices" idParam="id" delete="true">
						<sdx:fallback>
							<message type="echec_suppression">Echec suppression</message>
						</sdx:fallback>
					</sdx:deleteDocument>
				}else{
						<sdx:deleteDocuments hpp="-1" delete="true" base="revues">
						    <sdx:simpleQuery queryString="q"/>
						</sdx:deleteDocuments>
				}
			}
		</xsp:logic>
	</sdx:page>
</xsp:page>

```


---

### 📄 `admin/deleteByQuery.xsp` [2.065 octets]
<a id="admin-deleteByQuery-xsp"></a> [↩ Retour à l'arborescence](#tree-admin-deleteByQuery-xsp)

> **Chemin relatif** : `admin/deleteByQuery.xsp`  
> **Taille** : 2.065 octets  
> **Lignes** : 56  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx">
    <sdx:page>
		<title>Suppression de documents</title>
		<bar/>
		<xsp:logic>
			String ip = request.getRemoteAddr();
			if ("127.0.0.1".equals(ip)||"172.16.33.22".equals(ip) || "0:0:0:0:0:0:0:1".equals(ip)) {
				<title>Suppression</title>
				String q =  (String)request.getParameter("query");
				if ( q==null || q.equals("") ){

					<sdx:deleteDocument base="notices" baseParam="base" dirParam="notices" idParam="id" delete="true">
						<sdx:fallback>
							<message type="echec_suppression">Echec suppression</message>
						</sdx:fallback>
					</sdx:deleteDocument>
				}else{
						<sdx:deleteDocuments hpp="-1" delete="true" base="notices" baseParam="base">
						    <sdx:simpleQuery queryString="q"/>
						</sdx:deleteDocuments>
				}
			}
		</xsp:logic>
	</sdx:page>
</xsp:page>

```


---

### 📄 `admin/explorer.xsp` [4.328 octets]
<a id="admin-explorer-xsp"></a> [↩ Retour à l'arborescence](#tree-admin-explorer-xsp)

> **Chemin relatif** : `admin/explorer.xsp`  
> **Taille** : 4.328 octets  
> **Lignes** : 107  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (107 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0"?>
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" xmlns:api-explore="http://www.culture.gouv.fr/ns/sdx/sdx/api-explore">
	<xsp:structure>
		<xsp:include>fr.gouv.culture.sdx.user.Group</xsp:include>
		<xsp:include>fr.gouv.culture.sdx.user.User</xsp:include>
		<xsp:include>fr.gouv.culture.sdx.documentbase.IndexParameters</xsp:include>
		<xsp:include>java.util.Vector</xsp:include>
		<xsp:include>java.util.Hashtable</xsp:include>
		<xsp:include>java.util.Enumeration</xsp:include>
		<xsp:include>fr.gouv.culture.sdx.documentbase.AbstractDocumentBase</xsp:include>
	</xsp:structure>
	<sdx:page>
		<!--<sdx:userIsAdminOrSu>-->
			<!-- Get the application informations -->
			<sdx:app/>
			<!-- logic for forms submit -->
			<xsp:logic>
			String ip=request.getRemoteAddr();
			if ("127.0.0.1".equals(ip)||"172.16.33.2".equals(ip)) {
				<!-- Check which operation was requested by the super-user -->
				if("optimize".equals(request.getParameter("op"))) {
					<!-- if so, we grab the DocumentBase id and perform a full optimization process, we also don't forget to tell the user what is happening -->
				<!-- TODO:
						1- look for the documentBase
						2- check if this thing is not null or getting an exception
						3- eventually, we optimize it
						4- and then we can use the meta just after this comment to let the super-user know about what's going on
					-->
					if(sdx_app != null) {
						sdx_base = sdx_app.getDocumentBase(request.getParameter("base"));
						if(sdx_base != null) {
							<!-- we got an optimization for a specific documentbase here -->
							sdx_base.optimize();
							<!-- Do also the job : sdx_app.optimize(request.getParameter("base")); -->
				<optimizationDone>
					<xsp:attribute name="base">
						<xsp:expr>request.getParameter("base")</xsp:expr>
					</xsp:attribute>
				</optimizationDone>
						} else {
							<!-- if not specific, then the optimization apply on all the application. That mean all documentbases -->
							sdx_app.optimize();
							<optimizationDone/>
						}
					}
				} else if("backup".equals(request.getParameter("op"))) {
					<!-- Here we have a full application backup request, pretty simple logic here -->
					if(sdx_app != null)
					{
						<!-- Apply it -->
						sdx_app.saveApplication();
						<!-- Notify it -->
				<saveApplicationDone/>
					}
				}else if("restore".equals(request.getParameter("op"))) {
					<!-- Here we have a full application backup request, pretty simple logic here -->
					if(sdx_app != null)
					{
						<!-- Apply it -->
						sdx_app.loadApplication(null);
						<!-- Notify it -->
				<!--saveApplicationDone/-->
					} 
				}else if("integrity".equals(request.getParameter("op"))) {
					<!-- Same logic than for optimization yet, but with the integrity check this time -->
				<!-- TODO: add integrity check for repositories and internal databases here when implemented in java-api -->
					if(sdx_app != null) {
						sdx_base = sdx_app.getDocumentBase(request.getParameter("base"));
						if(sdx_base != null) {
							sdx_base.checkIntegrity();
							<checkIntegrityDone>
					<xsp:attribute name="base">
						<xsp:expr>request.getParameter("base")</xsp:expr>
					</xsp:attribute>
				</checkIntegrityDone>
						} else {
							sdx_app.checkIntegrity();
							<checkIntegrityDone/>
						}
					}
				}
			}
			</xsp:logic>
			<!-- end of submited forms managment -->
			<!-- Include the specific CSS for the exploration interface -->
			<sdx:xplorecss/>
			<!-- Get the application name -->
			<appName/>
			<!-- The exploration interface itself, see the XSL file for more information about how it works -->
			<sdx:explore/>
			<bar>
				<button id="welcome" href="index.xsp"/>
				<button id="login" href="login.xsp"/>
				<button id="identities" href="identities.xsp"/>
				<button id="bases" href="bases.xsp" self="true"/>
				<button id="explorer" href="explorer.xsp" self="true"/>
			</bar>
			<sdx:fallback>
				<bar>
					<button id="welcome" href="index.xsp"/>
					<button id="login" href="loginsu.xsp" self="true"/>
				</bar>
			</sdx:fallback>
		<!--</sdx:userIsAdminOrSu>-->
	</sdx:page>
</xsp:page>

```

</details>


---

### 📄 `admin/login.xsp` [1.536 octets]
<a id="admin-login-xsp"></a> [↩ Retour à l'arborescence](#tree-admin-login-xsp)

> **Chemin relatif** : `admin/login.xsp`  
> **Taille** : 1.536 octets  
> **Lignes** : 39  
> **Type** : text

```text
<?xml version="1.0"?>
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx">
    <sdx:page>
        <bar/>
        <title>Identification</title>
        <sdx:login idParam="id" passParam="pass">
            <!-- ici l'identité a été reconnue pour cette application -->
            <sdx:fallback>
                <!-- ici elle n'est pas connue -->
                <anonymous/>
            </sdx:fallback>
        </sdx:login>
        <sdx:logout/>
        <sdx:userIsAdmin>
            <!-- ici, l'utilisateur est administrateur -->
            <admin/>
            <!-- redirection vers le bureau d'administration -->
            
            <link show="replace" actuate="onload" time="3" href="admin.xsp"/>
            
            <sdx:fallback>
                <!-- ici, l'utilisateur n'est pas administrateur -->
                <sdx:parameter valueParam="id">
                    <sdx:success>
                        <!-- ici il a échoué à s'identifier (présence du paramètre http id) -->
                        <notadmin/>
                    </sdx:success>
                    <sdx:fallback>
                        <!-- ici, il n'a pas cherché à s'identifier -->
                      <!--  <rights/>-->
                    </sdx:fallback>
                </sdx:parameter>
            </sdx:fallback>
        </sdx:userIsAdmin>
        <!-- le formulaire d'identification -->
        <login/>
    </sdx:page>
</xsp:page>

```


---

### 📄 `admin/logout.xsp` [293 octets]
<a id="admin-logout-xsp"></a> [↩ Retour à l'arborescence](#tree-admin-logout-xsp)

> **Chemin relatif** : `admin/logout.xsp`  
> **Taille** : 293 octets  
> **Lignes** : 10  
> **Type** : text

```text
﻿<?xml version="1.0"?>
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx">
    <sdx:page>
        <bar/>
        <title>déconnexion</title>
        <sdx:logout logout="true"/>
        <logout/>
    </sdx:page>
</xsp:page>

```


---

### 📄 `admin/recherchelucene.xsp` [1.390 octets]
<a id="admin-recherchelucene-xsp"></a> [↩ Retour à l'arborescence](#tree-admin-recherchelucene-xsp)

> **Chemin relatif** : `admin/recherchelucene.xsp`  
> **Taille** : 1.390 octets  
> **Lignes** : 38  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx">
    <sdx:page>
        <bar/>    
        <title>Recherche</title>
        <recherchelucene/>
    </sdx:page>
</xsp:page>

```


---

### 📄 `admin/suppqid.xsp` [1.605 octets]
<a id="admin-suppqid-xsp"></a> [↩ Retour à l'arborescence](#tree-admin-suppqid-xsp)

> **Chemin relatif** : `admin/suppqid.xsp`  
> **Taille** : 1.605 octets  
> **Lignes** : 46  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx">
    <sdx:page>
        <bar/>
        <title>Suppression QID</title>
	<sdx:userIsAdmin>
	
		<sdx:deleteDocuments qidParam="qid" delete="true" hpp="-1">
			 <sdx:fallback>
				   <sdx:message>Erreur de suppression</sdx:message>
			      </sdx:fallback>
		</sdx:deleteDocuments>
		<retour/>
	</sdx:userIsAdmin>
    </sdx:page>
</xsp:page>

```


---

### 📄 `admin/suppression.xsp` [4.168 octets]
<a id="admin-suppression-xsp"></a> [↩ Retour à l'arborescence](#tree-admin-suppression-xsp)

> **Chemin relatif** : `admin/suppression.xsp`  
> **Taille** : 4.168 octets  
> **Lignes** : 134  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (134 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx">
    <sdx:page>
        <bar/>
        <title>Suppression des notices de la base</title>
	<sdx:userIsAdmin>
	<xsp:logic>
		
		// identifiant de la table DORIS (ktab) à modifier pour chaque application SDX
		String tableid="558";

		
		// ouverture du fichier contenant les notices supprimées au format (ligne par ligne) :
		// 02/08/2004 09:29:27 DORIS_BEFORE ktab=4898 kintab=48269 DELETE 
		
		String page=context.getRealPath(request.getServletPath());
		String app=page.substring(0, page.lastIndexOf(File.separator));
		String server=app.substring(0, app.lastIndexOf(File.separator));
		java.io.File fic=new java.io.File(server+File.separator+"delete.txt");

		if(fic.exists()){

			java.io.BufferedReader br = new java.io.BufferedReader(new java.io.FileReader(fic));
			
			String ligne=br.readLine();
		
			<sdx:message>Fichier trouvé, 1ère ligne lue :<xsp:expr>ligne</xsp:expr>, lecture pour ktab=<xsp:expr>tableid</xsp:expr></sdx:message>
			
			String query="";
			
			while(ligne!=null){
	
				StringTokenizer st=new StringTokenizer(ligne," ");
				
				//date
				if(st.hasMoreTokens())
					st.nextToken();
				//heure
				if(st.hasMoreTokens())
					st.nextToken();
				// doris_before
				if(st.hasMoreTokens())
					st.nextToken();
				// ktab
				String ktab=null;
				if(st.hasMoreTokens())
					ktab=st.nextToken();
				
				// kintab
				String kintab=null;
				if(st.hasMoreTokens())
					kintab=st.nextToken();
				
				
				if(ktab!=null &amp;&amp; ktab.endsWith(tableid) &amp;&amp; kintab!=null &amp;&amp; kintab.startsWith("kintab=") ){
	
					// identifiant de la notice (DORIS_KEY)
					String id=kintab.substring(7);
					String appId = sdx_app.getId();
					if (appId.equals("fr.gouv.equipement.documentation.archires"))
						id = "Archires-" + id;
					else if (appId.equals("fr.gouv.equipement.documentation.urbamet"))
						id = "Urbamet-" + id;
					else if (appId.equals("fr.gouv.equipement.documentation.dad"))
						id = "Urbamet-" + id;
					else if (appId.equals("fr.gouv.equipement.documentation.villesnouvelles"))
						id = "Urbamet-" + id;
					else if (appId.equals("fr.gouv.equipement.documentation.developpementdurable"))
						id = "Urbamet-" + id;
					else if (appId.equals("fr.gouv.equipement.documentation.cataloguecdu"))
						id = "Cdu-" + id;
					else if (appId.equals("fr.gouv.equipement.documentation.temis"))
						id = "Temis-" + id;

					query+="id:|"+id+"| ";
					
				}
			
				ligne=br.readLine();
			}
			
			<sdx:message> -       query=<xsp:expr>query</xsp:expr></sdx:message>

					
			br.close();

			if(!query.equals("")){
				<sdx:executeSimpleQuery base="notices" queryString="query"/>
			}
			else{
				<sdx:message>Pas de documents pour la base <xsp:expr>tableid</xsp:expr> trouvé dans delete.txt</sdx:message>
			}
		}
		else{
			
			
		}

		
	</xsp:logic>
	</sdx:userIsAdmin>
	
    </sdx:page>
</xsp:page>

```

</details>


---

### 📄 `admin/upload.xsp` [2.277 octets]
<a id="admin-upload-xsp"></a> [↩ Retour à l'arborescence](#tree-admin-upload-xsp)

> **Chemin relatif** : `admin/upload.xsp`  
> **Taille** : 2.277 octets  
> **Lignes** : 55  
> **Type** : text

```text
<?xml version="1.0"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page xmlns:xsp="http://apache.org/xsp">
    <sdx:page xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" show="user get post additions">
        <xsp:logic>
        File att=new File(context.getRealPath(request.getServletPath().substring(0, request.getServletPath().lastIndexOf('/')+1))+File.separator+"documents"+File.separator+"test.jpg");
        String jour=DateFormat.getDateInstance(DateFormat.FULL).format(new Date());
        </xsp:logic>
		<bar/>
		<title>Import - réception des documents</title>
		<sdx:userIsAdmin>&#32;
			<upload/>
			<sdx:debug>
				<sdx:uploadDocuments batch="1000" base="notices" dirParam="notices" includes="*.xml">
					<sdx:transformation type="XSLT" src="../conf/index-notice.xsl" srcParam="notices"/>
				</sdx:uploadDocuments>
			</sdx:debug>
			<sdx:fallback>
				<!-- si l'utilisateur n'est pas administrateur de cette application -->
				<notadmin/>
				<!-- l'xsl de présentation html remplace ceci par une redirection vers la page d'identification -->
				<link show="replace" actuate="onload" time="10" href="login.xsp"/>
			</sdx:fallback>
		</sdx:userIsAdmin>
	</sdx:page>
</xsp:page>

```


---

### 📄 `admin/xsl/admin.xsl` [19.705 octets]
<a id="admin-xsl-admin-xsl"></a> [↩ Retour à l'arborescence](#tree-admin-xsl-admin-xsl)

> **Chemin relatif** : `admin/xsl/admin.xsl`  
> **Taille** : 19.705 octets  
> **Lignes** : 549  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (549 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet xmlns="http://www.w3.org/1999/xhtml" version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" exclude-result-prefixes="sdx">
	<xsl:import href="../../sdxlib/xsl/skin.xsl"/>

	<xsl:template match="sdxbase">
		<xsl:variable name="baseName" select="@name"/>
		<h2>Base <xsl:value-of select="$baseName"/></h2>
		<!-- répertoire de fichiers XML -->

		<form name="dir" action="{@action}" method="get">
			Répertoire local à importer :&#160;<input type="text" name="notices" size="50" value="{normalize-space(@baseDir)}"/>
			&#160;
			<input type="hidden" name="base">
				<xsl:attribute name="value"><xsl:value-of select="$baseName"/></xsl:attribute>
			</input>
			<input type="submit" value="Importer"/>
		</form>
		<!-- un fichier zip -->
		<form name="zip" action="{@action}" method="post" enctype="multipart/form-data">
			Fichier ZIP à importer : <input type="file" name="zip" size="50"/>
			&#160;
			<input type="hidden" name="base">
				<xsl:attribute name="value"><xsl:value-of select="$baseName"/></xsl:attribute>
			</input>
			<input type="submit" value="Importer"/>
		</form>                    

		<xsl:call-template name="sdx:results-head">
			<xsl:with-param name="sdx:results" select="sdx:results"/>
			<xsl:with-param name="queryParam" select="'notices'"/>
		</xsl:call-template>
		<p>
			<xsl:call-template name="sdx:results-delete">
				<xsl:with-param name="sdx:results" select="sdx:results"/>
				<xsl:with-param name="action" select="'delete.xsp'"/>
			</xsl:call-template>
		</p>
		<xsl:apply-templates select="sdx:results"/>
	</xsl:template>
    
	<xsl:template match="notices">
		<xsl:if test="//noticesIntra"><h2>Notices du guide des ressources intranet</h2></xsl:if>
		<xsl:if test="not(//noticesIntra)"><h2>Administration de la base de documents XML</h2></xsl:if>
		<!-- répertoire de fichiers XML -->

		<form id="dir" action="{@action}" method="get">
			<p>
			<label for="notices">Répertoire local à importer&#160;: </label>
			<input type="text" name="notices" id="notices" size="50" value="{normalize-space(/*/documents/@notices)}"/>
			<xsl:text>&#160;</xsl:text>
			<input type="submit" value="Importer"/>
			</p>
		</form>
		<!-- un fichier zip -->
		<form id="zipform" action="{@action}" method="post" enctype="multipart/form-data">
			<p>
			<label for="zip">Fichier ZIP à importer&#160;: </label>
			<input type="file" name="zip" id="zip" size="50"/>
			<xsl:text>&#160;</xsl:text>
			<input type="submit" value="Importer"/>
			</p>
		</form>

		<xsl:call-template name="sdx:results-head">
			<xsl:with-param name="sdx:results" select="sdx:results"/>
			<xsl:with-param name="queryParam" select="'notices'"/>
		</xsl:call-template>
		<p>
			<xsl:call-template name="sdx:results-delete">
				<xsl:with-param name="sdx:results" select="sdx:results"/>
				<xsl:with-param name="action" select="'delete.xsp'"/>
			</xsl:call-template>
		</p>
		<xsl:apply-templates select="sdx:results"/>
	</xsl:template>
	
	<xsl:template match="dico">
		<h2>Administration de la base du thésaurus géographique</h2>
		<table class="form" width="100%" border="0" cellspacing="5">
			<tr>
				<td>
					<!-- répertoire de fichiers XML -->
					<form name="dir" action="{@action}" method="get">
						Répertoire local à importer :&#160;<input type="text" name="notices" size="50" value="{normalize-space(/*/documents/@dico)}"/>
						&#160;
						<input type="hidden" name="base" value="dico"/>
						<input type="submit" value="Importer"/>
					</form>
					<!-- un fichier zip -->
					<form name="zip" action="{@action}" method="post" enctype="multipart/form-data">
						Fichier ZIP à importer : <input type="file" name="zip" size="50"/>
						&#160;
						<input type="hidden" name="base" value="dico"/>
						<input type="submit" value="Importer"/>
					</form>                    
				</td>
			</tr>
			<tr>
				<td>
					<xsl:call-template name="sdx:results-head">
						<xsl:with-param name="sdx:results" select="sdx:results"/>
						<xsl:with-param name="queryParam" select="'dico'"/>
					</xsl:call-template>
					-
					<xsl:call-template name="sdx:results-delete">
						<xsl:with-param name="sdx:results" select="sdx:results"/>
						<xsl:with-param name="action" select="'delete.xsp'"/>
					</xsl:call-template>
				</td>
			</tr>
		</table>
		<xsl:apply-templates select="sdx:results"/>
	</xsl:template>


	<xsl:template match="revues">
		<h2>Administration de la base ArchiresRevues</h2>
		<table class="form" width="100%" border="0" cellspacing="5">
			<tr>
				<td>
					<!-- répertoire de fichiers XML -->
					<form name="dir" action="{@action}" method="get">
						Répertoire local à importer :&#160;<input type="text" name="notices" size="50" value="{normalize-space(/*/documents/@dico)}"/>
						&#160;
						<input type="hidden" name="base" value="revues"/>
						<input type="submit" value="Importer"/>
					</form>
					<!-- un fichier zip -->
					<form name="zip" action="{@action}" method="post" enctype="multipart/form-data">
						Fichier ZIP à importer : <input type="file" name="zip" size="50"/>
						&#160;
						<input type="hidden" name="base" value="revues"/>
						<input type="submit" value="Importer"/>
					</form>                    
				</td>
			</tr>
			<tr>
				<td>
					<xsl:call-template name="sdx:results-head">
						<xsl:with-param name="sdx:results" select="sdx:results"/>
						<xsl:with-param name="queryParam" select="'revues'"/>
					</xsl:call-template>
					-
					<xsl:call-template name="sdx:results-delete">
						<xsl:with-param name="sdx:results" select="sdx:results"/>
						<xsl:with-param name="action" select="'delete.xsp'"/>
					</xsl:call-template>
				</td>
			</tr>
		</table>
		<xsl:apply-templates select="sdx:results"/>
	</xsl:template>


	<xsl:template match="noticesInter">
		<h2>Notices du répertoire des sites Internet</h2>
		<table class="form" width="100%" border="0" cellspacing="5">
			<tr>
				<td>
					<!-- répertoire de fichiers XML -->
					<form name="dir" action="{@action}" method="get">
						Répertoire local à importer :&#160;<input type="text" name="notices" size="50" value="{normalize-space(/*/documents/@notices)}"/>
						&#160;
						<input type="hidden" name="base" value="noticesinter"/>
						<input type="submit" value="Importer"/>
					</form>
					<!-- un fichier zip -->
					<form name="zip" action="{@action}" method="post" enctype="multipart/form-data">
						Fichier ZIP à importer : <input type="file" name="zip" size="50"/>
						&#160;
						<input type="hidden" name="base" value="noticesinter"/>
						<input type="submit" value="Importer"/>
					</form>
				</td>
			</tr>
			<tr>
				<td>
					<xsl:call-template name="sdx:results-head">
						<xsl:with-param name="sdx:results" select="sdx:results"/>
						<xsl:with-param name="queryParam" select="'noticesinter'"/>
					</xsl:call-template>
					-
					<xsl:call-template name="sdx:results-delete">
						<xsl:with-param name="sdx:results" select="sdx:results"/>
						<xsl:with-param name="action" select="'delete.xsp'"/>
					</xsl:call-template>
				</td>
			</tr>
		</table>
		<xsl:apply-templates select="sdx:results"/>
	</xsl:template>

	<xsl:template match="dictionnaires">
		<h2>Termes du dictionnaire</h2>
		<table class="form" width="100%" border="0" cellspacing="5">
			<tr>
				<td>
					<!-- répertoire de fichiers XML -->
					<form name="dir" action="{@action}" method="get">
						Répertoire local à importer :&#160;<input type="text" name="notices" size="50" value="{normalize-space(/*/documents/@notices)}"/>
						&#160;
						<input type="hidden" name="base" value="dictionnaires"/>
						<input type="submit" value="Importer"/>
					</form>
					<!-- un fichier zip -->
					<form name="zip" action="{@action}" method="post" enctype="multipart/form-data">
						Fichier ZIP à importer : <input type="file" name="zip" size="50"/>
						&#160;
						<input type="hidden" name="base" value="dictionnaires"/>
						<input type="submit" value="Importer"/>
					</form>
				</td>
			</tr>
			<tr>
				<td>
					<xsl:call-template name="sdx:results-head">
						<xsl:with-param name="sdx:results" select="sdx:results"/>
						<xsl:with-param name="queryParam" select="'dictionnaires'"/>
					</xsl:call-template>
					-
					<xsl:call-template name="sdx:results-delete">
						<xsl:with-param name="sdx:results" select="sdx:results"/>
						<xsl:with-param name="action" select="'delete.xsp'"/>
					</xsl:call-template>
				</td>
			</tr>
		</table>
		<xsl:apply-templates select="sdx:results"/>
	</xsl:template>

	<xsl:template match="muleta">
		<h2>Administration de la base de correspondance Muleta</h2>
		<table class="form" width="100%" border="0" cellspacing="5">
			<tr>
				<td>
					<!-- répertoire de fichiers XML -->
					<form name="dir" action="{@action}" method="get">
						Répertoire local à importer :&#160;<input type="text" name="notices" size="50" value="{normalize-space(@baseDir)}"/>
						&#160;
						<input type="hidden" name="base" value="muleta"/>
						<input type="submit" value="Importer"/>
					</form>
					<!-- un fichier zip -->
					<form name="zip" action="{@action}" method="post" enctype="multipart/form-data">
						Fichier ZIP à importer : <input type="file" name="zip" size="50"/>
						&#160;
						<input type="hidden" name="base" value="muleta"/>
						<input type="submit" value="Importer"/>
					</form>                    
				</td>
			</tr>
			<tr>
				<td>
					<xsl:call-template name="sdx:results-head">
						<xsl:with-param name="sdx:results" select="sdx:results"/>
						<xsl:with-param name="queryParam" select="'muleta'"/>
					</xsl:call-template>
					-
					<xsl:call-template name="sdx:results-delete">
						<xsl:with-param name="sdx:results" select="sdx:results"/>
						<xsl:with-param name="action" select="'delete.xsp'"/>
					</xsl:call-template>
				</td>
			</tr>
		</table>
		<xsl:apply-templates select="sdx:results"/>
	</xsl:template>

	<xsl:template match="noticesLettres">
		<h2>CGPC : Lettres de commande</h2>
		<table class="form" width="100%" border="0" cellspacing="5">
			<tr>
				<td>
					<!-- répertoire de fichiers XML -->
					<form name="dir" action="{@action}" method="get">
						Répertoire local à importer :&#160;<input type="text" name="notices" size="50" value="{normalize-space(@baseDir)}"/>
						&#160;
						<input type="hidden" name="base" value="notices_lettres"/>
						<input type="submit" value="Importer"/>
					</form>
					<!-- un fichier zip -->
					<form name="zip" action="{@action}" method="post" enctype="multipart/form-data">
						Fichier ZIP à importer : <input type="file" name="zip" size="50"/>
						&#160;
						<input type="hidden" name="base" value="notices_lettres"/>
						<input type="submit" value="Importer"/>
					</form>                    
				</td>
			</tr>
			<tr>
				<td>
					<xsl:call-template name="sdx:results-head">
						<xsl:with-param name="sdx:results" select="sdx:results"/>
						<xsl:with-param name="queryParam" select="'muleta'"/>
					</xsl:call-template>
					-
					<xsl:call-template name="sdx:results-delete">
						<xsl:with-param name="sdx:results" select="sdx:results"/>
						<xsl:with-param name="action" select="'delete.xsp'"/>
					</xsl:call-template>
				</td>
			</tr>
		</table>
		<xsl:apply-templates select="sdx:results"/>
	</xsl:template>

	<xsl:template match="noticesAvisAE">
		<h2>CGPC : Avis de l'autorité environnementale</h2>
		<table class="form" width="100%" border="0" cellspacing="5">
			<tr>
				<td>
					<!-- répertoire de fichiers XML -->
					<form name="dir" action="{@action}" method="get">
						Répertoire local à importer :&#160;<input type="text" name="notices" size="50" value="{normalize-space(@baseDir)}"/>
						&#160;
						<input type="hidden" name="base" value="notices_avisae"/>
						<input type="submit" value="Importer"/>
					</form>
					<!-- un fichier zip -->
					<form name="zip" action="{@action}" method="post" enctype="multipart/form-data">
						Fichier ZIP à importer : <input type="file" name="zip" size="50"/>
						&#160;
						<input type="hidden" name="base" value="notices_avisae"/>
						<input type="submit" value="Importer"/>
					</form>                    
				</td>
			</tr>
			<tr>
				<td>
					<xsl:call-template name="sdx:results-head">
						<xsl:with-param name="sdx:results" select="sdx:results"/>
						<xsl:with-param name="queryParam" select="'muleta'"/>
					</xsl:call-template>
					-
					<xsl:call-template name="sdx:results-delete">
						<xsl:with-param name="sdx:results" select="sdx:results"/>
						<xsl:with-param name="action" select="'delete.xsp'"/>
					</xsl:call-template>
				</td>
			</tr>
		</table>
		<xsl:apply-templates select="sdx:results"/>
	</xsl:template>

	<xsl:template match="organisations">
		<h2>Administration des organisations pour les bases Urbamet</h2>
		<table class="form" width="100%" border="0" cellspacing="5">
			<tr>
				<td>
					<!-- répertoire de fichiers XML -->
					<form name="dir" action="{@action}" method="get">
						Répertoire local à importer :&#160;<input type="text" name="notices" size="50" value="{normalize-space(@baseDir)}"/>
						&#160;
						<input type="hidden" name="base" value="organisations"/>
						<input type="submit" value="Importer"/>
					</form>
					<!-- un fichier zip -->
					<form name="zip" action="{@action}" method="post" enctype="multipart/form-data">
						Fichier ZIP à importer : <input type="file" name="zip" size="50"/>
						&#160;
						<input type="hidden" name="base" value="organisations"/>
						<input type="submit" value="Importer"/>
					</form>                    
				</td>
			</tr>
			<tr>
				<td>
					<xsl:call-template name="sdx:results-head">
						<xsl:with-param name="sdx:results" select="sdx:results"/>
						<xsl:with-param name="queryParam" select="'muleta'"/>
					</xsl:call-template>
					-
					<xsl:call-template name="sdx:results-delete">
						<xsl:with-param name="sdx:results" select="sdx:results"/>
						<xsl:with-param name="action" select="'delete.xsp'"/>
					</xsl:call-template>
				</td>
			</tr>
		</table>
		<xsl:apply-templates select="sdx:results"/>
	</xsl:template>

	<xsl:template match="urbanisme">
		<h2>Administration urbanisme pour les bases Urbamet</h2>
		<table class="form" width="100%" border="0" cellspacing="5">
			<tr>
				<td>
					<!-- répertoire de fichiers XML -->
					<form name="dir" action="{@action}" method="get">
						Répertoire local à importer :&#160;<input type="text" name="notices" size="50" value="{normalize-space(@baseDir)}"/>
						&#160;
						<input type="hidden" name="base" value="urbanisme"/>
						<input type="submit" value="Importer"/>
					</form>
					<!-- un fichier zip -->
					<form name="zip" action="{@action}" method="post" enctype="multipart/form-data">
						Fichier ZIP à importer : <input type="file" name="zip" size="50"/>
						&#160;
						<input type="hidden" name="base" value="urbanisme"/>
						<input type="submit" value="Importer"/>
					</form>                    
				</td>
			</tr>
			<tr>
				<td>
					<xsl:call-template name="sdx:results-head">
						<xsl:with-param name="sdx:results" select="sdx:results"/>
						<xsl:with-param name="queryParam" select="'muleta'"/>
					</xsl:call-template>
					-
					<xsl:call-template name="sdx:results-delete">
						<xsl:with-param name="sdx:results" select="sdx:results"/>
						<xsl:with-param name="action" select="'delete.xsp'"/>
					</xsl:call-template>
				</td>
			</tr>
		</table>
		<xsl:apply-templates select="sdx:results"/>
	</xsl:template>

	<!-- sdx:results -->
	<xsl:template match="sdx:results">
		<xsl:choose>
			<xsl:when test="@nb > 0">
				<xsl:apply-templates>
				<!-- template depuis sdx-default.xsl -->
				<xsl:with-param name="action" select="'../document.xsp'">
					<!-- vers oÃ¹ voir une page -->
				</xsl:with-param>
				<xsl:with-param name="delete" select="'true'"/>
				<xsl:with-param name="action-delete" select="'delete.xsp'">
						<!-- vers oÃ¹ détruire une page -->
				</xsl:with-param>
				</xsl:apply-templates>
			</xsl:when>
			<xsl:otherwise>
				<strong>Votre base est vide. </strong>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	
	<!--
	<a style="text-decoration:none; color:black" href="#">
		<xsl:attribute name="onclick">
			document.forms['attach'].ref.value='{sdx:field[@name='sdxdocid']}';
			path='{normalize-space(/*/documents/@dir)}';
			document.forms['attach'].url.value =
			document.forms['attach'].url.value.replace(/\\[^\\]*$/, '')
			+ '\\{sdx:field[@name='sdxdocid']}.jpg'
			; 
			return false;
		</xsl:attribute>
	</a>
	-->
	
	<xsl:template match="sdx:field"/>
    
	<xsl:template match="sdx:field[@name='url']">
		<small>
			<xsl:text>&#160;</xsl:text>
			<a style="color:black" href="{@value}" onclick="document.forms['url'].url.value=this.href; return false">
				<xsl:value-of select="@value"/>
			</a>
		</small>
	</xsl:template>
	
	<xsl:template match="sdx:field[@name='titre']">
		<strong>
			<xsl:value-of select="@value"/>
		</strong>
	</xsl:template>
	
	<xsl:template match="sdx:field[@name='sdxdocid']">
		<small>
			<xsl:text>&#160;id=</xsl:text>
			<xsl:value-of select="@value"/>&#160;
		</small>
	</xsl:template>
    
	<!-- rights -->
	<xsl:template match="noteditor">
		<p>Pour accéder à cette page, veuillez d'abord vous identifier : 
			<a href="login.xsp">login.xsp</a>
		</p>
	</xsl:template>
	
	<xsl:template match="sdx:query"/>
	
	<!-- un formulaire pour attacher un document à un autre 
	<xsl:template match="formulaire[@type='attach']">
		<br/>
		<form id="attach" action="{@traitement}" method="get">
			<h2>Attacher une image à un document xml    
				<small>(base de documents "sites")</small>
			</h2>
			<p>Indiquez un identifiant de document et l'url 
			d'une image, pour qu'elle lui soit attachée.</p>
			<div class="form">
				Document
				<input type="text" name="ref" size="10" value=""/>
				<input type="submit" value="lister" onclick="this.form.action='admin.xsp'"/>
				<br/>
				URL image
				<input type="text" name="url" size="60" value="file://{normalize-space(/*/documents/@dir)}\"/>
				<input type="submit" value="Attacher"/>
				<br/>
				<xsl:apply-templates/>
				<div>
					<small>
						En cliquant l'identifiant d'un des projets, 
						il s'inscrit directement dans le champ texte,
						avec l'url d'une image correspondante.
					</small>
				</div>
			</div>
		</form>
	</xsl:template>
	-->
</xsl:stylesheet>

```

</details>


---

### 📄 `admin/xsl/afficheoptions.xsl` [2.584 octets]
<a id="admin-xsl-afficheoptions-xsl"></a> [↩ Retour à l'arborescence](#tree-admin-xsl-afficheoptions-xsl)

> **Chemin relatif** : `admin/xsl/afficheoptions.xsl`  
> **Taille** : 2.584 octets  
> **Lignes** : 89  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet xmlns="http://www.w3.org/1999/xhtml" version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" exclude-result-prefixes="sdx">
    <xsl:import href="../../xsl/skin.xsl"/>
    
    <xsl:param name="et"/>
    <xsl:param name="ou"/>
    <xsl:param name="expr"/>
    <xsl:param name="sauf"/>
    <xsl:param name="champ"/>

    <xsl:template match="rechercheavancee">

	
	
         <form id="rechercheavancee">
	 <input type="hidden" name="champ" value="{$champ}"/> 
	
	 <table>
	 <tr>
		 <td colspan="2" align="center">champ <b><xsl:value-of select="$champ"/></b> contenant :</td>
	 </tr>
	 <tr>
		 <td><b>tous</b> les mots suivants (ET)</td>
		 <td>
		 <input type="text" name="et" value="{$et}" size="30"/>
		</td>
	</tr>
	<tr>
		 <td>cette <b>expression exacte</b> ("")</td>
		 <td>
		 <input type="text" name="expr" value="{$expr}" size="30"/>
		</td>
	</tr>
	<tr>
		 <td><b>au moins un</b> des mots suivants (OU)</td>
		 <td>
		 <input type="text" name="ou" value="{$ou}" size="30"/>
		</td>
	</tr>
	
	<tr>
		 <td><b>aucun</b> des mots suivants (SAUF)</td>
		 <td>
		 <input type="text" name="sauf" value="{$sauf}" size="30"/>
		</td>
	</tr>
	<tr>
	<td/>
	<td><input type="submit" value="Valider" onclick="return validerRechercheAvancee('{$champ}','et','ou','expr','sauf');"/></td>
	</tr>
	</table>
	
	</form> 
    </xsl:template>

   


</xsl:stylesheet>

```


---

### 📄 `admin/xsl/auto-delete-inter.xsl` [1.731 octets]
<a id="admin-xsl-auto-delete-inter-xsl"></a> [↩ Retour à l'arborescence](#tree-admin-xsl-auto-delete-inter-xsl)

> **Chemin relatif** : `admin/xsl/auto-delete-inter.xsl`  
> **Taille** : 1.731 octets  
> **Lignes** : 43  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet xmlns="http://www.w3.org/1999/xhtml" version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" exclude-result-prefixes="sdx">
	<xsl:include href="../../xsl/skin.xsl"/>
	<xsl:template match="sdx:message[1]">
		Document inconnu.
	</xsl:template>
	<xsl:template match="retourAdmin">
		<p class="right"><a href="admin.xsp">Retour page admin</a></p>
	</xsl:template>
	<xsl:template match="sdx:parameters">
		<xsl:apply-templates/>
	</xsl:template>
</xsl:stylesheet>

```


---

### 📄 `admin/xsl/auto-delete.xsl` [1.731 octets]
<a id="admin-xsl-auto-delete-xsl"></a> [↩ Retour à l'arborescence](#tree-admin-xsl-auto-delete-xsl)

> **Chemin relatif** : `admin/xsl/auto-delete.xsl`  
> **Taille** : 1.731 octets  
> **Lignes** : 43  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet xmlns="http://www.w3.org/1999/xhtml" version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" exclude-result-prefixes="sdx">
	<xsl:include href="../../xsl/skin.xsl"/>
	<xsl:template match="sdx:message[1]">
		Document inconnu.
	</xsl:template>
	<xsl:template match="retourAdmin">
		<p class="right"><a href="admin.xsp">Retour page admin</a></p>
	</xsl:template>
	<xsl:template match="sdx:parameters">
		<xsl:apply-templates/>
	</xsl:template>
</xsl:stylesheet>

```


---

### 📄 `admin/xsl/auto-upload-2.xsl` [5.114 octets]
<a id="admin-xsl-auto-upload-2-xsl"></a> [↩ Retour à l'arborescence](#tree-admin-xsl-auto-upload-2-xsl)

> **Chemin relatif** : `admin/xsl/auto-upload-2.xsl`  
> **Taille** : 5.114 octets  
> **Lignes** : 168  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (168 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet xmlns="http://www.w3.org/1999/xhtml" version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" exclude-result-prefixes="sdx">
	<xsl:import href="../../xsl/skin.xsl"/>
	<xsl:template match="sdx:uploadDocuments">
		<p class="right"><a href="admin.xsp">Retour page admin</a></p>
		<h1>
			<xsl:text>Import de document</xsl:text>
			<xsl:if test="number(sdx:summary/@additions) &gt; 1">s</xsl:if>
		</h1>
		<xsl:apply-templates select="sdx:summary"/>
		<ul>
			<xsl:apply-templates select="sdx:uploadDocument"/>
		</ul>
	</xsl:template>
    
	<xsl:template match="sdx:uploadDocument">
		<li>
			<strong>
				<xsl:value-of select="@id"/>
			</strong>
			<xsl:text> indexé. </xsl:text>
		</li>
		<xsl:if test="/sdx:document/sdx:parameters/sdx:parameter[@name='url']">
			<iframe width="100%" height="200" src="{/sdx:document/sdx:parameters/sdx:parameter[@name='url']/@value}" title="Un nouveau document cherchable"/>
		</xsl:if>
	</xsl:template>
    
	<xsl:template match="sdx:uploadDocument[sdx:exception]">
		<li>
			<strong>
				<xsl:value-of select="@id"/>
			</strong>
			<xsl:text> erreur. </xsl:text>
			<xsl:apply-templates select="sdx:exception/sdx:message"/>
		</li>
	</xsl:template>
    
	<xsl:template match="sdx:summary">
		<div>
			<xsl:apply-templates select="@*"/>
		</div>
	</xsl:template>
	
	<xsl:template match="@additions">
		<xsl:if test="number(.) &gt; 0">
			<xsl:value-of select="."/>
			<xsl:text> document</xsl:text>
			<xsl:if test="number(.) &gt; 1">s</xsl:if>
			<xsl:text> ajouté</xsl:text>
			<xsl:if test="number(.) &gt; 1">s</xsl:if>
			<xsl:text>, </xsl:text>
		</xsl:if>
	</xsl:template>
	
	<xsl:template match="@failures">
		<xsl:if test="number(.) &gt; 0">
			<xsl:value-of select="."/>
			<xsl:text> échec</xsl:text>
			<xsl:if test="number(.) &gt; 1">s</xsl:if>
			<xsl:text>, </xsl:text>
		</xsl:if>
	</xsl:template>
    
	<xsl:template match="@replacements">
		<xsl:value-of select="."/>
		<xsl:text> document</xsl:text>
		<xsl:if test="number(.) &gt; 1">s</xsl:if>
		<xsl:text> remplacé</xsl:text>
		<xsl:if test="number(.) &gt; 1">s</xsl:if>
	</xsl:template>
	
	<xsl:template match="@duration"> (<xsl:value-of select="."/> secondes).</xsl:template>
    
	<xsl:template match="sdx:uploadDocument/sdx:exception">
		<h2>Erreur</h2>
		<xsl:apply-templates/>
	</xsl:template>
	
	<xsl:template match="sdx:uploadDocument/sdx:exception/sdx:message">
		<small>
			<xsl:apply-templates/>
		</small>
	</xsl:template>
	
	<xsl:template match="sdx:results">
		<div style="font-family:sans-serif">
			<strong>Champs indexés</strong>
			<xsl:apply-templates select="sdx:result"/>
		</div>
	</xsl:template>
    
	<xsl:template match="sdx:result">
		<xsl:apply-templates select="sdx:field">
			<xsl:sort select="@name"/>
			<xsl:sort select="@value"/>
		</xsl:apply-templates>
	</xsl:template>
	
	<!-- sdx:field -->
	<xsl:template match="sdx:field">
		<div>
			<span class="sdx_field-name" style="font-weight:bold">
				<xsl:value-of select="@name"/>
			</span>
			<xsl:text>:"</xsl:text>
			<span class="sdx_field-value">
				<xsl:value-of select="@value"/>
			</span>
			<xsl:text>"</xsl:text>
		</div>
	</xsl:template>
	
	<xsl:template match="sdx:field[@name='lien']">
		<div>
			<a href="{normalize-space(.)}">
				<xsl:value-of select="."/>
			</a>
		</div>
	</xsl:template>
    
	<!-- url d'image -->
	<xsl:template match="sdx:field[@name='image']">
		<img src="{.}"/>
	</xsl:template>
	
	<xsl:template match="sdx:terms">
		<div>
			<strong>Termes indexés</strong>
		</div>
		<small>
			<xsl:apply-templates select="sdx:term"/>
		</small>
	</xsl:template>
	
	<xsl:template match="sdx:term">
		<xsl:value-of select="@value"/>
		<xsl:text>&#32;</xsl:text>
	</xsl:template>
</xsl:stylesheet>
```

</details>


---

### 📄 `admin/xsl/auto-upload-inter.xsl` [5.114 octets]
<a id="admin-xsl-auto-upload-inter-xsl"></a> [↩ Retour à l'arborescence](#tree-admin-xsl-auto-upload-inter-xsl)

> **Chemin relatif** : `admin/xsl/auto-upload-inter.xsl`  
> **Taille** : 5.114 octets  
> **Lignes** : 168  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (168 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet xmlns="http://www.w3.org/1999/xhtml" version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" exclude-result-prefixes="sdx">
	<xsl:import href="../../xsl/skin.xsl"/>
	<xsl:template match="sdx:uploadDocuments">
		<p class="right"><a href="admin.xsp">Retour page admin</a></p>
		<h1>
			<xsl:text>Import de document</xsl:text>
			<xsl:if test="number(sdx:summary/@additions) &gt; 1">s</xsl:if>
		</h1>
		<xsl:apply-templates select="sdx:summary"/>
		<ul>
			<xsl:apply-templates select="sdx:uploadDocument"/>
		</ul>
	</xsl:template>
    
	<xsl:template match="sdx:uploadDocument">
		<li>
			<strong>
				<xsl:value-of select="@id"/>
			</strong>
			<xsl:text> indexé. </xsl:text>
		</li>
		<xsl:if test="/sdx:document/sdx:parameters/sdx:parameter[@name='url']">
			<iframe width="100%" height="200" src="{/sdx:document/sdx:parameters/sdx:parameter[@name='url']/@value}" title="Un nouveau document cherchable"/>
		</xsl:if>
	</xsl:template>
    
	<xsl:template match="sdx:uploadDocument[sdx:exception]">
		<li>
			<strong>
				<xsl:value-of select="@id"/>
			</strong>
			<xsl:text> erreur. </xsl:text>
			<xsl:apply-templates select="sdx:exception/sdx:message"/>
		</li>
	</xsl:template>
    
	<xsl:template match="sdx:summary">
		<div>
			<xsl:apply-templates select="@*"/>
		</div>
	</xsl:template>
	
	<xsl:template match="@additions">
		<xsl:if test="number(.) &gt; 0">
			<xsl:value-of select="."/>
			<xsl:text> document</xsl:text>
			<xsl:if test="number(.) &gt; 1">s</xsl:if>
			<xsl:text> ajouté</xsl:text>
			<xsl:if test="number(.) &gt; 1">s</xsl:if>
			<xsl:text>, </xsl:text>
		</xsl:if>
	</xsl:template>
	
	<xsl:template match="@failures">
		<xsl:if test="number(.) &gt; 0">
			<xsl:value-of select="."/>
			<xsl:text> échec</xsl:text>
			<xsl:if test="number(.) &gt; 1">s</xsl:if>
			<xsl:text>, </xsl:text>
		</xsl:if>
	</xsl:template>
    
	<xsl:template match="@replacements">
		<xsl:value-of select="."/>
		<xsl:text> document</xsl:text>
		<xsl:if test="number(.) &gt; 1">s</xsl:if>
		<xsl:text> remplacé</xsl:text>
		<xsl:if test="number(.) &gt; 1">s</xsl:if>
	</xsl:template>
	
	<xsl:template match="@duration"> (<xsl:value-of select="."/> secondes).</xsl:template>
    
	<xsl:template match="sdx:uploadDocument/sdx:exception">
		<h2>Erreur</h2>
		<xsl:apply-templates/>
	</xsl:template>
	
	<xsl:template match="sdx:uploadDocument/sdx:exception/sdx:message">
		<small>
			<xsl:apply-templates/>
		</small>
	</xsl:template>
	
	<xsl:template match="sdx:results">
		<div style="font-family:sans-serif">
			<strong>Champs indexés</strong>
			<xsl:apply-templates select="sdx:result"/>
		</div>
	</xsl:template>
    
	<xsl:template match="sdx:result">
		<xsl:apply-templates select="sdx:field">
			<xsl:sort select="@name"/>
			<xsl:sort select="@value"/>
		</xsl:apply-templates>
	</xsl:template>
	
	<!-- sdx:field -->
	<xsl:template match="sdx:field">
		<div>
			<span class="sdx_field-name" style="font-weight:bold">
				<xsl:value-of select="@name"/>
			</span>
			<xsl:text>:"</xsl:text>
			<span class="sdx_field-value">
				<xsl:value-of select="@value"/>
			</span>
			<xsl:text>"</xsl:text>
		</div>
	</xsl:template>
	
	<xsl:template match="sdx:field[@name='lien']">
		<div>
			<a href="{normalize-space(.)}">
				<xsl:value-of select="."/>
			</a>
		</div>
	</xsl:template>
    
	<!-- url d'image -->
	<xsl:template match="sdx:field[@name='image']">
		<img src="{.}"/>
	</xsl:template>
	
	<xsl:template match="sdx:terms">
		<div>
			<strong>Termes indexés</strong>
		</div>
		<small>
			<xsl:apply-templates select="sdx:term"/>
		</small>
	</xsl:template>
	
	<xsl:template match="sdx:term">
		<xsl:value-of select="@value"/>
		<xsl:text>&#32;</xsl:text>
	</xsl:template>
</xsl:stylesheet>
```

</details>


---

### 📄 `admin/xsl/auto-upload.xsl` [5.114 octets]
<a id="admin-xsl-auto-upload-xsl"></a> [↩ Retour à l'arborescence](#tree-admin-xsl-auto-upload-xsl)

> **Chemin relatif** : `admin/xsl/auto-upload.xsl`  
> **Taille** : 5.114 octets  
> **Lignes** : 168  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (168 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet xmlns="http://www.w3.org/1999/xhtml" version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" exclude-result-prefixes="sdx">
	<xsl:import href="../../xsl/skin.xsl"/>
	<xsl:template match="sdx:uploadDocuments">
		<p class="right"><a href="admin.xsp">Retour page admin</a></p>
		<h1>
			<xsl:text>Import de document</xsl:text>
			<xsl:if test="number(sdx:summary/@additions) &gt; 1">s</xsl:if>
		</h1>
		<xsl:apply-templates select="sdx:summary"/>
		<ul>
			<xsl:apply-templates select="sdx:uploadDocument"/>
		</ul>
	</xsl:template>
    
	<xsl:template match="sdx:uploadDocument">
		<li>
			<strong>
				<xsl:value-of select="@id"/>
			</strong>
			<xsl:text> indexé. </xsl:text>
		</li>
		<xsl:if test="/sdx:document/sdx:parameters/sdx:parameter[@name='url']">
			<iframe width="100%" height="200" src="{/sdx:document/sdx:parameters/sdx:parameter[@name='url']/@value}" title="Un nouveau document cherchable"/>
		</xsl:if>
	</xsl:template>
    
	<xsl:template match="sdx:uploadDocument[sdx:exception]">
		<li>
			<strong>
				<xsl:value-of select="@id"/>
			</strong>
			<xsl:text> erreur. </xsl:text>
			<xsl:apply-templates select="sdx:exception/sdx:message"/>
		</li>
	</xsl:template>
    
	<xsl:template match="sdx:summary">
		<div>
			<xsl:apply-templates select="@*"/>
		</div>
	</xsl:template>
	
	<xsl:template match="@additions">
		<xsl:if test="number(.) &gt; 0">
			<xsl:value-of select="."/>
			<xsl:text> document</xsl:text>
			<xsl:if test="number(.) &gt; 1">s</xsl:if>
			<xsl:text> ajouté</xsl:text>
			<xsl:if test="number(.) &gt; 1">s</xsl:if>
			<xsl:text>, </xsl:text>
		</xsl:if>
	</xsl:template>
	
	<xsl:template match="@failures">
		<xsl:if test="number(.) &gt; 0">
			<xsl:value-of select="."/>
			<xsl:text> échec</xsl:text>
			<xsl:if test="number(.) &gt; 1">s</xsl:if>
			<xsl:text>, </xsl:text>
		</xsl:if>
	</xsl:template>
    
	<xsl:template match="@replacements">
		<xsl:value-of select="."/>
		<xsl:text> document</xsl:text>
		<xsl:if test="number(.) &gt; 1">s</xsl:if>
		<xsl:text> remplacé</xsl:text>
		<xsl:if test="number(.) &gt; 1">s</xsl:if>
	</xsl:template>
	
	<xsl:template match="@duration"> (<xsl:value-of select="."/> secondes).</xsl:template>
    
	<xsl:template match="sdx:uploadDocument/sdx:exception">
		<h2>Erreur</h2>
		<xsl:apply-templates/>
	</xsl:template>
	
	<xsl:template match="sdx:uploadDocument/sdx:exception/sdx:message">
		<small>
			<xsl:apply-templates/>
		</small>
	</xsl:template>
	
	<xsl:template match="sdx:results">
		<div style="font-family:sans-serif">
			<strong>Champs indexés</strong>
			<xsl:apply-templates select="sdx:result"/>
		</div>
	</xsl:template>
    
	<xsl:template match="sdx:result">
		<xsl:apply-templates select="sdx:field">
			<xsl:sort select="@name"/>
			<xsl:sort select="@value"/>
		</xsl:apply-templates>
	</xsl:template>
	
	<!-- sdx:field -->
	<xsl:template match="sdx:field">
		<div>
			<span class="sdx_field-name" style="font-weight:bold">
				<xsl:value-of select="@name"/>
			</span>
			<xsl:text>:"</xsl:text>
			<span class="sdx_field-value">
				<xsl:value-of select="@value"/>
			</span>
			<xsl:text>"</xsl:text>
		</div>
	</xsl:template>
	
	<xsl:template match="sdx:field[@name='lien']">
		<div>
			<a href="{normalize-space(.)}">
				<xsl:value-of select="."/>
			</a>
		</div>
	</xsl:template>
    
	<!-- url d'image -->
	<xsl:template match="sdx:field[@name='image']">
		<img src="{.}"/>
	</xsl:template>
	
	<xsl:template match="sdx:terms">
		<div>
			<strong>Termes indexés</strong>
		</div>
		<small>
			<xsl:apply-templates select="sdx:term"/>
		</small>
	</xsl:template>
	
	<xsl:template match="sdx:term">
		<xsl:value-of select="@value"/>
		<xsl:text>&#32;</xsl:text>
	</xsl:template>
</xsl:stylesheet>
```

</details>


---

### 📄 `admin/xsl/delete.xsl` [1.731 octets]
<a id="admin-xsl-delete-xsl"></a> [↩ Retour à l'arborescence](#tree-admin-xsl-delete-xsl)

> **Chemin relatif** : `admin/xsl/delete.xsl`  
> **Taille** : 1.731 octets  
> **Lignes** : 43  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet xmlns="http://www.w3.org/1999/xhtml" version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" exclude-result-prefixes="sdx">
	<xsl:include href="../../xsl/skin.xsl"/>
	<xsl:template match="sdx:message[1]">
		Document inconnu.
	</xsl:template>
	<xsl:template match="retourAdmin">
		<p class="right"><a href="admin.xsp">Retour page admin</a></p>
	</xsl:template>
	<xsl:template match="sdx:parameters">
		<xsl:apply-templates/>
	</xsl:template>
</xsl:stylesheet>

```


---

### 📄 `admin/xsl/deleteByQuery-2.xsl` [1.738 octets]
<a id="admin-xsl-deleteByQuery-2-xsl"></a> [↩ Retour à l'arborescence](#tree-admin-xsl-deleteByQuery-2-xsl)

> **Chemin relatif** : `admin/xsl/deleteByQuery-2.xsl`  
> **Taille** : 1.738 octets  
> **Lignes** : 43  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet xmlns="http://www.w3.org/1999/xhtml" version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" exclude-result-prefixes="sdx">
	<xsl:include href="../../sdxlib/xsl/skin.xsl"/>
	<xsl:template match="sdx:message[1]">
		Document inconnu.
	</xsl:template>
	<xsl:template match="retourAdmin">
		<p class="right"><a href="admin.xsp">Retour page admin</a></p>
	</xsl:template>
	<xsl:template match="sdx:parameters">
		<xsl:apply-templates/>
	</xsl:template>
</xsl:stylesheet>

```


---

### 📄 `admin/xsl/deleteByQuery.xsl` [1.738 octets]
<a id="admin-xsl-deleteByQuery-xsl"></a> [↩ Retour à l'arborescence](#tree-admin-xsl-deleteByQuery-xsl)

> **Chemin relatif** : `admin/xsl/deleteByQuery.xsl`  
> **Taille** : 1.738 octets  
> **Lignes** : 43  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet xmlns="http://www.w3.org/1999/xhtml" version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" exclude-result-prefixes="sdx">
	<xsl:include href="../../sdxlib/xsl/skin.xsl"/>
	<xsl:template match="sdx:message[1]">
		Document inconnu.
	</xsl:template>
	<xsl:template match="retourAdmin">
		<p class="right"><a href="admin.xsp">Retour page admin</a></p>
	</xsl:template>
	<xsl:template match="sdx:parameters">
		<xsl:apply-templates/>
	</xsl:template>
</xsl:stylesheet>

```


---

### 📄 `admin/xsl/explorer.xsl` [74.469 octets]
<a id="admin-xsl-explorer-xsl"></a> [↩ Retour à l'arborescence](#tree-admin-xsl-explorer-xsl)

> **Chemin relatif** : `admin/xsl/explorer.xsl`  
> **Taille** : 74.469 octets  
> **Lignes** : 1046  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (1046 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<o:stylesheet xmlns:o="http://www.w3.org/1999/XSL/Transform" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:xfm="http://www.w3.org/2002/01/xforms" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" version="1.0" sdx:copy="for namespace">

	<xsl:import href="skin.xsl"/>
   
	<!-- parameter language to choose a message set -->
	<o:param name="lang-default" select="'fr'"/> 

	<!-- some useful stuff to have here -->
	<xsl:param name="messages-URI" select="concat('messages.', substring($lang, 1, 2))"/><!-- take set of language -->
	<o:variable name="messages" select="document($messages-URI)/*/xfm:messages[substring($lang, 1, 2)=substring(@xml:lang, 1, 2)] | document('')/*/xfm:messages[substring($lang, 1, 2)=substring(@xml:lang, 1, 2)]"/>
	<xsl:param name="id"/>
	<xsl:param name="appPath" select="concat('/', string(/*/*/sdx:application/sdx:Path), '/')"/>

	<!-- here is our CSS include -->
	<xsl:template match="sdx:xplorecss" mode="head">
		<link rel="stylesheet" type="text/css" href="res/explore.css"/>
	</xsl:template>

	<!-- well.. the page title... -->
	<xsl:template name="title">
		<o:apply-templates select="($messages/xfm:caption[@id=&#34;title&#34;])[1]"/>
	</xsl:template>

	<!-- a notice to let the super-user know that the application's backup he requested is a success -->
	<xsl:template match="saveApplicationDone">
		<span class="notice"><o:apply-templates select="($messages/xfm:caption[@id=&#34;nSaveApplicationDone&#34;])[1]"/></span>
	</xsl:template>

	<!-- a notice to let the super-user know that the documentBase's optimization he requested is a success (yay !) -->
	<xsl:template match="optimizationDone">
		<span class="notice"><o:apply-templates select="($messages/xfm:caption[@id=&#34;nOptimizationDone&#34;])[1]"/><xsl:if test="@base != ''">&#160;:&#160;<xsl:value-of select="@base"/></xsl:if></span>
	</xsl:template>

	<!-- a notice to let the super-user know that the documentBase's integrity check he requested is a success -->
	<xsl:template match="checkIntegrityDone">
		<span class="notice"><o:apply-templates select="($messages/xfm:caption[@id=&#34;nCheckIntegrityDone&#34;])[1]"/><xsl:if test="@base != ''">&#160;:&#160;<xsl:value-of select="@base"/></xsl:if></span>
	</xsl:template>

	<!-- warn the super-user about the fact that he asked an optimization for a documentBase that doesn't exist -->
	<xsl:template match="nullDocumentBase">
		<span class="warn"><o:apply-templates select="($messages/xfm:caption[@id=&#34;nNullDocumentBase&#34;])[1]"/></span>
	</xsl:template>

	<!-- Text output interception -->
	<xsl:template match="text()">
		<xsl:choose>
			<xsl:when test="self::text()='true'">
				<span class="true"><o:apply-templates select="($messages/xfm:caption[@id=&#34;gTrue&#34;] )[1]"/></span>
			</xsl:when>
			<xsl:when test="self::text()='false'">
				<o:apply-templates select="($messages/xfm:caption[@id=&#34;gFalse&#34;] )[1]"/>
			</xsl:when>
			<xsl:when test="self::text()='null' or self::text()='none'">
				<span class="null"><o:apply-templates select="($messages/xfm:caption[@id=&#34;gEmpty&#34;] )[1]"/></span>
			</xsl:when>
			<xsl:when test="self::text()=''">null</xsl:when>
			<xsl:otherwise><xsl:value-of select="."/></xsl:otherwise>
		</xsl:choose>
	</xsl:template> 

	<!-- Exploration interface -->
	<xsl:template match="sdx:explore">
		
		<!-- Application level -->
		<div class="application">
		<!-- Some feedback from the super-user requests done by this interface -->
		<xsl:apply-templates select="/nullDocumentBase"/>
		<xsl:apply-templates select="/optimizationDone"/>
		<!-- Here follow the data about the application -->
		<h1><o:apply-templates select="($messages/xfm:caption[@id=&#34;tApp&#34;] )[1]"/>&#160;<xsl:apply-templates select="sdx:application/sdx:ID"/>&#160;<xsl:value-of select="$appPath"/></h1>
		<h2><o:apply-templates select="($messages/xfm:caption[@id=&#34;gProps&#34;] )[1]"/></h2>
		<ul>
		<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gEncode&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:application/sdx:Encoding"/></b></li>
		<li>XML-Lang&#160;=&#160;<b><xsl:apply-templates select="sdx:application/sdx:XML-Lang"/></b></li>
		<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;headSessionObject&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:application/sdx:Session_Object_Limit"/></b></li>
		</ul>
		<!-- Tools -->
		<p class="tools">
			<!-- Backup tool -->
			<form class="tool" action="{/sdx:document/@uri}" method="get" onsubmit="if (window.xfm_submit) return xfm_submit(this);">
				<input type="hidden" class="xfm_input" name="op" value="backup"/>
				<input type="hidden" class="xfm_input" name="app" value="{$app}"/>
				<input type="hidden" class="xfm_input" name="lang" value="{$lang}"/>
				<input type="submit" onclick="this.form.action='{@href}'" title="{$messages/xfm:hint[@id=&#34;hSaveApplication&#34;]}" value="{$messages/xfm:caption[@id=&#34;iSaveApplication&#34;]}"/>
			</form>
			<!-- End of backup tool -->
			<!-- Optimization tool -->
			<form class="tool" action="{/sdx:document/@uri}" method="get" onsubmit="if (window.xfm_submit) return xfm_submit(this);">
				<input type="hidden" class="xfm_input" name="op" value="optimize"/>
				<input type="hidden" class="xfm_input" name="app" value="{$app}"/>
				<input type="hidden" class="xfm_input" name="lang" value="{$lang}"/>
				<input type="submit" onclick="this.form.action='{@href}'" title="{$messages/xfm:hint[@id=&#34;hOptimizeApplication&#34;]}" value="{$messages/xfm:caption[@id=&#34;iOptimizeBaseDoc&#34;]}"/>
			</form>
			<!-- End of optimization tool -->
			<!-- Integrity tool -->
			<form class="tool" action="{/sdx:document/@uri}" method="get" onsubmit="if (window.xfm_submit) return xfm_submit(this);">
				<input type="hidden" class="xfm_input" name="op" value="integrity"/>
				<input type="hidden" class="xfm_input" name="app" value="{$app}"/>
				<input type="hidden" class="xfm_input" name="lang" value="{$lang}"/>
				<input type="submit" onclick="this.form.action='{@href}'" title="{$messages/xfm:hint[@id=&#34;hCheckIntegrityApplication&#34;]}" value="{$messages/xfm:caption[@id=&#34;iCheckIntegrity&#34;]}"/>
			</form>
			<!-- End of integrity tool -->
		</p>
		<!-- End of tools -->
		<h2><o:apply-templates select="($messages/xfm:caption[@id=&#34;headDefault&#34;] )[1]"/></h2>
		<ul>
		<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDocBase&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:application/sdx:Default_DocumentBase"/></b></li>
		<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;docBaseType&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:application/sdx:Default_Documentbase_Type"/></b></li>
		<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;thesType&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:application/sdx:Default_Thesaurus_Type"/></b></li>
		<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;adminIdGroup&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:application/sdx:Default_Administrator_Group_ID"/></b></li>
		<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;adminIdUser&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:application/sdx:Default_Administrator_User_ID"/></b></li>
		</ul>
		<h2><o:apply-templates select="($messages/xfm:caption[@id=&#34;headDir&#34;] )[1]"/></h2>
		<ul>
		<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;headClass&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:application/sdx:Classes_Directory_Name"/></b></li>
		<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDataBases&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:application/sdx:Databases_Directory_Name"/></b></li>
		<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDocBases&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:application/sdx:Documentbases_Directory_Name"/></b></li>
		<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;headLib&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:application/sdx:Libraries_Directory_Name"/></b></li>
		<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gRepos&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:application/sdx:Repositories_Directory_Name"/></b></li>
		<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;headThes&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:application/sdx:Thesauri_Directory_Name"/></b></li>
		<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;headDbs&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:application/sdx:Users_Databases_Directory_Name"/></b></li>
		<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;headDocBases&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:application/sdx:Users_Documentbases_Directory_Name"/></b></li>
		</ul>
		</div>
		
		<!-- Table of contents -->
		<h1><o:apply-templates select="($messages/xfm:caption[@id=&#34;tContents&#34;] )[1]"/></h1>
		<div id="index">
		<!-- Repositories -->
		<xsl:if test="count(child::*/sdx:repository) &gt; 0">
		<h2><o:apply-templates select="($messages/xfm:caption[@id=&#34;gRepos&#34;] )[1]"/></h2>
		<xsl:apply-templates select="."><xsl:with-param name="index" select="1"/><xsl:sort select="@id"/></xsl:apply-templates>
		</xsl:if>
		<!-- Field lists -->
		<xsl:if test="count(child::*/sdx:fieldList) &gt; 0">
		<h2><o:apply-templates select="($messages/xfm:caption[@id=&#34;gFieldList&#34;] )[1]"/></h2>
		<xsl:apply-templates select="child::*/sdx:fieldList"><xsl:with-param name="index" select="1"/><xsl:sort select="@id"/></xsl:apply-templates>
		</xsl:if>
		<!-- Documents Bases -->
		<xsl:if test="count(child::*/sdx:Document_Bases/sdx:databaseBacked) &gt; 0">
		<h2><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDocBases&#34;] )[1]"/></h2>
		<xsl:apply-templates select="child::*/sdx:Document_Bases/sdx:databaseBacked"><xsl:with-param name="index" select="1"/><xsl:sort select="@id"/></xsl:apply-templates>
		</xsl:if>
		<!-- Thesauri -->
		<xsl:if test="count(child::*/sdx:Thesauri/sdx:databaseBacked) &gt; 0">
		<h2><o:apply-templates select="($messages/xfm:caption[@id=&#34;headThes&#34;] )[1]"/></h2>
		<xsl:apply-templates select="child::*/sdx:Thesauri/sdx:databaseBacked"><xsl:with-param name="index" select="3"/><xsl:sort select="@id"/></xsl:apply-templates>
		</xsl:if>
		</div>
		
		<!-- Content -->
		<h1><o:apply-templates select="($messages/xfm:caption[@id=&#34;tData&#34;] )[1]"/></h1>
		<!-- Document Bases -->
		<xsl:if test="count(child::*/sdx:Document_Bases/sdx:databaseBacked) &gt; 0">
		<h1><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDocBases&#34;] )[1]"/></h1>
		<ul><xsl:apply-templates select="sdx:application/sdx:Document_Bases/child::*"><xsl:with-param name="index" select="0"/></xsl:apply-templates></ul>
		</xsl:if>
		<!-- Thesauri -->
		<xsl:if test="count(child::*/sdx:Thesauri/sdx:databaseBacked) &gt; 0">
		<h1><o:apply-templates select="($messages/xfm:caption[@id=&#34;headThes&#34;] )[1]"/></h1>
		<ul><xsl:apply-templates select="sdx:application/sdx:Thesauri/child::*"><xsl:with-param name="index" select="2"/></xsl:apply-templates></ul>
		</xsl:if>
	</xsl:template>


	<!-- Properties display managment -->
	<xsl:template match="sdx:explore//*">
		<xsl:param name="index"/>
		<xsl:choose>
			
			<!-- Thesauri : Table of contents -->
			<xsl:when test="local-name()='databaseBacked' and $index='3'">
				<div class="documentbase">
					<a href="#{@object}"><xsl:value-of select="@id"/></a>&#160;[&#160;<xsl:value-of select="@object"/>&#160;]
				</div>
	 		</xsl:when>
			
			<!-- Thesauri : content -->
			<xsl:when test="local-name()='databaseBacked' and $index='2'">
				<div class="documentbase"><a name="{@object}"/><h2><xsl:value-of select="@id"/>&#160;[&#160;<xsl:value-of select="@object"/>&#160;]</h2>
				<h3><o:apply-templates select="($messages/xfm:caption[@id=&#34;gProps&#34;] )[1]"/>&#160;::&#160;<o:apply-templates select="($messages/xfm:caption[@id=&#34;gEncode&#34;] )[1]"/>&#160;<xsl:apply-templates select="sdx:Encoding"/>&#160;::&#160;XML-Lang&#160;<xsl:apply-templates select="sdx:XML-Lang"/></h3>
				<ul>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;thesType&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Thesaurus_Type"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gIsDefault&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Is_default"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;autoOptimize&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Auto_Optimize"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;keepOriginal&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Keep_Original_Documents"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;depth&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Depth"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDocCount&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Document_Count"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;source&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Source"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;relation&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Relation"/></b></li>
				</ul>
				<!-- Database -->
				<h3><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDataBase&#34;] )[1]"/>&#160;[&#160;<xsl:value-of select="sdx:database/@id"/>&#160;]</h3>
				<ul>
				<xsl:if test="sdx:database/sdx:Database_Type/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;dbType&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:database/sdx:Database_Type"/></b></li></xsl:if>
				<xsl:if test="sdx:database/sdx:Database_Directory_Path/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDir&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:database/sdx:Database_Directory_Path"/></b></li></xsl:if>
				<xsl:if test="sdx:database/sdx:member/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;dbMember&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:database/sdx:member"/></b></li></xsl:if>
				<xsl:if test="sdx:database/sdx:JDBC_Table_Name/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;dbJDBCTableName&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:database/sdx:JDBC_Table_Name"/></b></li></xsl:if>
				<xsl:if test="sdx:database/sdx:Document_Count/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDocCount&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:database/sdx:Document_Count"/></b></li></xsl:if>
				</ul>
				<!-- Pipeline -->
				<h3><o:apply-templates select="($messages/xfm:caption[@id=&#34;pipeline&#34;] )[1]"/>&#160;::&#160;<o:apply-templates select="($messages/xfm:caption[@id=&#34;gEncode&#34;] )[1]"/>&#160;<xsl:apply-templates select="sdx:pipeline/sdx:Encoding"/>&#160;::&#160;XML-Lang&#160;<xsl:apply-templates select="sdx:pipeline/sdx:XML-Lang"/></h3>
				<ul>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gLocale&#34;] )[1]"/>&#160;=&#160;<b><xsl:value-of select="sdx:pipeline/sdx:Locale"/></b></li>
				<xsl:if test="sdx:pipeline/sdx:sdxDate/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDateSDX&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:pipeline/sdx:sdxDate"/></b></li></xsl:if>
				<xsl:if test="sdx:pipeline/sdx:sdxISO8601Date/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDateISO&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:pipeline/sdx:sdxISO8601Date"/></b></li></xsl:if>
				<xsl:if test="sdx:pipeline/sdx:sdxDateMilliseconds/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDateMilli&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:pipeline/sdx:sdxDateMilliseconds"/></b></li></xsl:if>
				<xsl:if test="sdx:pipeline/sdx:docUrl/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gUrlDoc&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:pipeline/sdx:docUrl"/></b></li></xsl:if>
				</ul>
				<!-- Index -->
				<h3><o:apply-templates select="($messages/xfm:caption[@id=&#34;index&#34;] )[1]"/>&#160;::&#160;<o:apply-templates select="($messages/xfm:caption[@id=&#34;gEncode&#34;] )[1]"/>&#160;<xsl:apply-templates select="sdx:index_encoding"/>&#160;::&#160;XML-Lang&#160;<xsl:apply-templates select="sdx:index_xml-lang"/></h3>
				<ul>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;engine&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:index_engine"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;isOptimized&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:index_is_optimized"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;useCF&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:index_use_compound_files"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDocCount&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:index_document_count"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;path&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:index_path"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;indexCreate&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:index_creation_date"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;indexMaj&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:index_last_modification_date"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;indexFullSize&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:index_full_size"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;indexCountFiles&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:index_count_files"/></b></li>
				</ul>
				<xsl:apply-templates select="sdx:fieldList"/>
				</div>
			</xsl:when>
						
			<!-- DocumentBase : Table of contents -->
			<xsl:when test="local-name()='databaseBacked' and $index='1'">
				<div class="documentbase">
					<a href="#{@object}"><xsl:value-of select="@id"/></a>&#160;[&#160;<xsl:value-of select="@object"/>&#160;]
					<h3><o:apply-templates select="($messages/xfm:caption[@id=&#34;gRepos&#34;] )[1]"/></h3>
					<xsl:for-each select="sdx:SDX_DocumentBase_Repositories/sdx:repository">
						<xsl:apply-templates select=".">
							<xsl:with-param name="index" select="2"/>
							<xsl:sort select="@id"/>
						</xsl:apply-templates>
					</xsl:for-each>
					<!-- Tools -->
					<p class="tools">
						<!-- Optimization tool -->
						<form class="tool" action="{/sdx:document/@uri}" method="get" onsubmit="if (window.xfm_submit) return xfm_submit(this);">
							<input type="hidden" class="xfm_input" name="op" value="optimize"/>
							<input type="hidden" class="xfm_input" name="app" value="{$app}"/>
							<input type="hidden" class="xfm_input" name="lang" value="{$lang}"/>
							<input type="hidden" class="xfm_input" name="base" value="{@id}"/>
							<input type="submit" onclick="this.form.action='{@href}'" title="{$messages/xfm:hint[@id=&#34;hOptimize&#34;]}" value="{$messages/xfm:caption[@id=&#34;iOptimizeBaseDoc&#34;]}"/>
						</form>
						<!-- End of optimization tool -->
						<!-- Integrity tool -->
						<form class="tool" action="{/sdx:document/@uri}" method="get" onsubmit="if (window.xfm_submit) return xfm_submit(this);">
							<input type="hidden" class="xfm_input" name="op" value="integrity"/>
							<input type="hidden" class="xfm_input" name="app" value="{$app}"/>
							<input type="hidden" class="xfm_input" name="lang" value="{$lang}"/>
							<input type="hidden" class="xfm_input" name="base" value="{@id}"/>
							<input type="submit" onclick="this.form.action='{@href}'" title="{$messages/xfm:hint[@id=&#34;hCheckIntegrity&#34;]}" value="{$messages/xfm:caption[@id=&#34;iCheckIntegrity&#34;]}"/>
						</form>
						<!-- End of integrity tool -->
					</p>
					<!-- End of tools -->
				</div>
	 		</xsl:when>
			
			<!-- DocumentBase : content -->
			<xsl:when test="local-name()='databaseBacked'">
				<div class="documentbase"><a name="{@object}"/><h2><xsl:value-of select="@id"/>&#160;[&#160;<xsl:value-of select="@object"/>&#160;]</h2>
				<h3><o:apply-templates select="($messages/xfm:caption[@id=&#34;gProps&#34;] )[1]"/>&#160;::&#160;<o:apply-templates select="($messages/xfm:caption[@id=&#34;gEncode&#34;] )[1]"/>&#160;<xsl:apply-templates select="sdx:Encoding"/>&#160;::&#160;XML-Lang&#160;<xsl:apply-templates select="sdx:XML-Lang"/></h3>
				<ul>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gIsDefault&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Is_default"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;defaultRepo&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Default_Repository"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;autoOptimize&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Auto_Optimize"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;indexFileSize&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Split_Size"/>&#160;<xsl:apply-templates select="sdx:Split_Unit"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;indexMaxDoc&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Split_Doc"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;keepOriginal&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Keep_Original_Documents"/></b></li>
				</ul>
				<!-- Tools -->
				<!-- Optimization tool -->
				<form class="tool" action="{/sdx:document/@uri}" method="get" onsubmit="if (window.xfm_submit) return xfm_submit(this);">
					<input type="hidden" class="xfm_input" name="op" value="optimize"/>
					<input type="hidden" class="xfm_input" name="app" value="{$app}"/>
					<input type="hidden" class="xfm_input" name="lang" value="{$lang}"/>
					<input type="hidden" class="xfm_input" name="base" value="{@id}"/>
					<input type="submit" onclick="this.form.action='{@href}'" title="{$messages/xfm:hint[@id=&#34;hOptimize&#34;]}" value="{$messages/xfm:caption[@id=&#34;iOptimizeBaseDoc&#34;]}"/>
				</form>
				<!-- End of optimization tool -->
				<!-- Integrity tool -->
				<form class="tool" action="{/sdx:document/@uri}" method="get" onsubmit="if (window.xfm_submit) return xfm_submit(this);">
					<input type="hidden" class="xfm_input" name="op" value="integrity"/>
					<input type="hidden" class="xfm_input" name="app" value="{$app}"/>
					<input type="hidden" class="xfm_input" name="lang" value="{$lang}"/>
					<input type="hidden" class="xfm_input" name="base" value="{@id}"/>
					<input type="submit" onclick="this.form.action='{@href}'" title="{$messages/xfm:hint[@id=&#34;hCheckIntegrity&#34;]}" value="{$messages/xfm:caption[@id=&#34;iCheckIntegrity&#34;]}"/>
				</form>
				<!-- End of integrity tool -->
				<!-- End of tools -->
				<!-- Identify (from OAI) : displaying data via a loop because XPath doesn't work here without the namespace. TODO: fix it -->
				<xsl:for-each select="child::*">
					<xsl:if test="local-name(.)='Identify'">
						<h3><o:apply-templates select="($messages/xfm:caption[@id=&#34;oaiIdentify&#34;] )[1]"/></h3>
						<ul>
						<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;oaiRepoName&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="child::*[1]"/></b></li>
						<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;oaiBaseUrl&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="child::*[2]"/></b></li>
						<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;oaiProtocol&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="child::*[3]"/></b></li>
						<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;oaiMail&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="child::*[4]"/></b></li>
						<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;oaiTimeStamp&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="child::*[5]"/></b></li>
						<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;oaiDelete&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="child::*[6]"/></b></li>
						<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;oaiGranularity&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="child::*[7]"/></b></li>
						</ul>
					</xsl:if>
				</xsl:for-each>
				<!-- Database -->
				<h3><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDataBase&#34;] )[1]"/>&#160;[&#160;<xsl:value-of select="sdx:database/@id"/>&#160;]</h3>
				<ul>
				<xsl:if test="sdx:database/sdx:Database_Type/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;dbType&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:database/sdx:Database_Type"/></b></li></xsl:if>
				<xsl:if test="sdx:database/sdx:Database_Directory_Path/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDir&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:database/sdx:Database_Directory_Path"/></b></li></xsl:if>
				<xsl:if test="sdx:database/sdx:member/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;dbMember&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:database/sdx:member"/></b></li></xsl:if>
				<xsl:if test="sdx:database/sdx:JDBC_Table_Name/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;dbJDBCTableName&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:database/sdx:JDBC_Table_Name"/></b></li></xsl:if>
				<xsl:if test="sdx:database/sdx:Document_Count/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDocCount&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:database/sdx:Document_Count"/></b></li></xsl:if>
				</ul>
				<!-- Pipeline -->
				<h3><o:apply-templates select="($messages/xfm:caption[@id=&#34;pipeline&#34;] )[1]"/>&#160;[&#160;<xsl:apply-templates select="sdx:pipeline/sdx:ID"/>&#160;]&#160;::&#160;<o:apply-templates select="($messages/xfm:caption[@id=&#34;gEncode&#34;] )[1]"/>&#160;<xsl:apply-templates select="sdx:pipeline/sdx:Encoding"/>&#160;::&#160;XML-Lang&#160;<xsl:apply-templates select="sdx:pipeline/sdx:XML-Lang"/></h3>
				<ul>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gLocale&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:pipeline/sdx:Locale"/></b></li>
				<xsl:if test="sdx:pipeline/sdx:sdxDate/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDateSDX&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:pipeline/sdx:sdxDate"/></b></li></xsl:if>
				<xsl:if test="sdx:pipeline/sdx:sdxISO8601Date/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDateISO&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:pipeline/sdx:sdxISO8601Date"/></b></li></xsl:if>
				<xsl:if test="sdx:pipeline/sdx:sdxDateMilliseconds/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDateMilli&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:pipeline/sdx:sdxDateMilliseconds"/></b></li></xsl:if>
				<xsl:if test="sdx:pipeline/sdx:docUrl/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gUrlDoc&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:pipeline/sdx:docUrl"/></b></li></xsl:if>
				<li>
					<!-- Transformation -->
					<div class="transformation">
					<span class="transformation"><o:apply-templates select="($messages/xfm:caption[@id=&#34;transformation&#34;] )[1]"/>&#160;[&#160;<xsl:apply-templates select="sdx:pipeline/sdx:transformation/sdx:ID"/>&#160;]&#160;::&#160;<o:apply-templates select="($messages/xfm:caption[@id=&#34;gEncode&#34;] )[1]"/>&#160;<xsl:apply-templates select="sdx:pipeline/sdx:transformation/sdx:Encoding"/>&#160;::&#160;XML-Lang&#160;<xsl:value-of select="sdx:pipeline/sdx:transformation/sdx:XML-Lang"/></span>
					<ul>
					<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gLocale&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:pipeline/sdx:transformation/sdx:Locale"/></b></li>
					<xsl:if test="sdx:pipeline/sdx:transformation/sdx:sdxDate/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDateSDX&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:pipeline/sdx:transformation/sdx:sdxDate"/></b></li></xsl:if>
					<xsl:if test="sdx:pipeline/sdx:transformation/sdx:sdxISO8601Date/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDateISO&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:pipeline/sdx:transformation/sdx:sdxISO8601Date"/></b></li></xsl:if>
					<xsl:if test="sdx:pipeline/sdx:transformation/sdx:sdxDateMilliseconds/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDateMilli&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:pipeline/sdx:transformation/sdx:sdxDateMilliseconds"/></b></li></xsl:if>
					<xsl:if test="sdx:pipeline/sdx:transformation/sdx:docUrl/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gUrlDoc&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:pipeline/sdx:transformation/sdx:docUrl"/></b></li></xsl:if>
					<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gName&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:pipeline/sdx:transformation/sdx:Name"/></b></li>
					</ul>
					</div>
				</li>
				</ul>
				<!-- Repository -->
				<h3><o:apply-templates select="($messages/xfm:caption[@id=&#34;gRepos&#34;] )[1]"/></h3>
				<xsl:for-each select="sdx:SDX_DocumentBase_Repositories/sdx:repository">
					<ul>
					<xsl:apply-templates select=".">
						<xsl:sort select="@id"/>
					</xsl:apply-templates>
					</ul>
				</xsl:for-each>
				<!-- Index -->
				<h3><o:apply-templates select="($messages/xfm:caption[@id=&#34;index&#34;] )[1]"/>&#160;::&#160;<o:apply-templates select="($messages/xfm:caption[@id=&#34;gEncode&#34;] )[1]"/>&#160;<xsl:apply-templates select="sdx:index_encoding"/>&#160;::&#160;XML-Lang&#160;<xsl:apply-templates select="sdx:index_xml-lang"/></h3>
				<ul>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;engine&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:index_engine"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;isOptimized&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:index_is_optimized"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;useCF&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:index_use_compound_files"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gDocCount&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:index_document_count"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;path&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:index_path"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;indexCreate&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:index_creation_date"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;indexMaj&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:index_last_modification_date"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;indexFullSize&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:index_full_size"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;indexCountFiles&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:index_count_files"/></b></li>
				</ul>
				<xsl:apply-templates select="sdx:fieldList"/>
				</div>
	 		</xsl:when>
			
	 		<!-- Repositories : Application level -->
			<!-- Still have to see this one in a real case as sdxtest does not provide this kind of repository -->
	 		<xsl:when test="local-name()='repository' and $index='1'">
				<xsl:if test="local-name(parent::*)='repositories'"><div class="repository"><a href="#app{local-name()}{@id}"><xsl:value-of select="@id"/></a>&#160;[&#160;<xsl:value-of select="@object"/>&#160;]</div></xsl:if>
	 		</xsl:when>
			
	 		<!-- Repositories : Table of contents -->
	 		<xsl:when test="local-name()='repository' and $index='2'">
				<div class="repository"><a href="#{local-name()}{parent::*/parent::*/@id}{@id}"><xsl:value-of select="@id"/></a>&#160;[&#160;<xsl:value-of select="@object"/>&#160;]</div>
	 		</xsl:when>
	 		
	 		<!-- Repositories : Content -->
	 		<xsl:when test="local-name()='repository'">
				<li>
				<div class="repository"><span class="repository">
				<xsl:if test="local-name(parent::*)='repositories'"><a name="app{local-name()}{@id}"/></xsl:if>
				<xsl:if test="local-name(parent::*)!='repositories'"><a name="{local-name()}{parent::*/parent::*/@id}{@id}"/></xsl:if>
				<xsl:value-of select="@id"/>&#160;::&#160;<o:apply-templates select="($messages/xfm:caption[@id=&#34;gEncode&#34;] )[1]"/>&#160;<xsl:apply-templates select="sdx:Encoding"/>&#160;::&#160;XML-Lang&#160;<xsl:apply-templates select="sdx:XML-Lang"/>
				</span>
				<ul>
				<!-- Shared data -->
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gIsDefault&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Is_default"/></b></li>
				<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gType&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Repository_Type"/></b></li>
				<!-- Specific data -->
				<xsl:if test="sdx:Data_Source_Identifier/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;dataSrcId&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Data_Source_Identifier"/></b></li></xsl:if>
				<xsl:if test="sdx:Read_Only/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;readOnly&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Read_Only"/></b></li></xsl:if>
				<xsl:if test="sdx:Use_cache/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;useCache&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Use_cache"/></b></li></xsl:if>
				<xsl:if test="sdx:Check_On_Get/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;checkOnGet&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Check_On_Get"/></b></li></xsl:if>
				<xsl:if test="sdx:Base_Directory/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;baseDirectory&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Base_Directory"/></b></li></xsl:if>
				<xsl:if test="sdx:Base_URL/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;baseURL&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Base_URL"/></b></li></xsl:if>
				<xsl:if test="sdx:Documents_Directory/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;docDirectory&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Documents_Directory"/></b></li></xsl:if>
				<xsl:if test="sdx:File_prefix/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;filePrefix&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:File_prefix"/></b></li></xsl:if>
				<xsl:if test="sdx:File_suffix/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;fileSuffix&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:File_suffix"/></b></li></xsl:if>
				<xsl:if test="sdx:Extent/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;extent&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Extent"/></b></li></xsl:if>
				<xsl:if test="sdx:Depth/text() != ''"><li><o:apply-templates select="($messages/xfm:caption[@id=&#34;depth&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Depth"/></b></li></xsl:if>
				<xsl:for-each select="sdx:database"><xsl:apply-templates select="."/></xsl:for-each>
				</ul>
				</div>
				</li>
	 		</xsl:when>
			 
	 		<!-- Fields list : Application level -->
			<!-- Still have to see this one in a real case too -->
	 		<xsl:when test="local-name()='fieldList' and $index='1'">
				<div class="fieldlist">
				<a href="#app{local-name()}{@id}"><xsl:value-of select="@id"/></a>&#160;[&#160;<xsl:value-of select="@object"/>&#160;]
				<span><xsl:value-of select="count(sdx:field/child::*)"/>&#160;<o:apply-templates select="($messages/xfm:caption[@id=&#34;fields&#34;] )[1]"/>&#160;|&#160;<o:apply-templates select="($messages/xfm:caption[@id=&#34;defaultField&#34;] )[1]"/>&#160;:&#160;<xsl:apply-templates select="sdx:default_field"/>&#160;|&#160;<o:apply-templates select="($messages/xfm:caption[@id=&#34;ignoreCase&#34;] )[1]"/>&#160;:&#160;<xsl:apply-templates select="sdx:ignore_case"/></span>
				</div>
	 		</xsl:when>
			
	 		<!-- Fields list : Content -->
	 		<xsl:when test="local-name()='fieldList'">
	  		<h3 class="fieldlist"><o:apply-templates select="($messages/xfm:caption[@id=&#34;gFieldList&#34;] )[1]"/>&#160;[&#160;<xsl:apply-templates select="sdx:ID"/>&#160;]&#160;::&#160;<o:apply-templates select="($messages/xfm:caption[@id=&#34;gEncode&#34;] )[1]"/>&#160;<xsl:apply-templates select="sdx:Encoding"/>&#160;::&#160;XML-Lang&#160;<xsl:apply-templates select="sdx:XML-Lang"/></h3>
			<ul>
			<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gLocale&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="@locale"/></b></li>
			<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;defaultField&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Default_Field"/></b></li>
			<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;gWordAnalyzer&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Default_Analyser"/></b></li>
			<li><o:apply-templates select="($messages/xfm:caption[@id=&#34;ignoreCase&#34;] )[1]"/>&#160;=&#160;<b><xsl:apply-templates select="sdx:Ignore_Case"/></b></li>
			</ul>
	  		<table class="properties">
				<tr class="property-row-head">
					<td class="property-no"><o:apply-templates select="($messages/xfm:caption[@id=&#34;number&#34;] )[1]"/></td>
					<td class="property-name"><o:apply-templates select="($messages/xfm:caption[@id=&#34;gName&#34;] )[1]"/></td>
					<td class="property-type"><o:apply-templates select="($messages/xfm:caption[@id=&#34;gType&#34;] )[1]"/></td>
					<td class="property-default"><o:apply-templates select="($messages/xfm:caption[@id=&#34;default&#34;] )[1]"/></td>
					<td class="property-brief"><o:apply-templates select="($messages/xfm:caption[@id=&#34;brief&#34;] )[1]"/></td>
					<td class="property-storeTermVector"><o:apply-templates select="($messages/xfm:caption[@id=&#34;storeTermVector&#34;] )[1]"/></td>
					<td class="property-locale"><o:apply-templates select="($messages/xfm:caption[@id=&#34;gLocale&#34;] )[1]"/></td>
					<td class="property-analyzer"><o:apply-templates select="($messages/xfm:caption[@id=&#34;gWordAnalyzer&#34;] )[1]"/></td>
					<td class="property-config"><o:apply-templates select="($messages/xfm:caption[@id=&#34;config&#34;] )[1]"/></td>
				</tr>
				<xsl:for-each select="./sdx:field">
					<xsl:apply-templates select="child::*">
						<xsl:sort select="sdx:name"/>
					</xsl:apply-templates>
				</xsl:for-each>
	  		</table>
	 		</xsl:when>
			
	 		<!-- Fields -->
	 		<xsl:when test="local-name()='field'">
				<!-- Even row number (used for display style via CSS) -->
				<xsl:if test="position() mod 2 = 0">
					<tr class="property-row-even">
						<td class="property-no"><xsl:value-of select="position()"/></td> 
						<td class="property-name"><xsl:apply-templates select="sdx:name"/></td> 
						<td class="property-type"><xsl:apply-templates select="sdx:type_name"/></td> 
						<td class="property-default"><xsl:apply-templates select="sdx:is_default/text()"/></td> 
						<td class="property-brief"><xsl:apply-templates select="sdx:in_brief/text()"/></td> 
						<td class="property-storeTermVector"><xsl:apply-templates select="sdx:storeTermVector"/></td>
						<td class="property-locale"><xsl:apply-templates select="sdx:locale"/></td> 
						<td class="property-analyzer"><xsl:apply-templates select="sdx:analyzer/sdx:type"/></td>
						<td class="property-config">todo</td>
					</tr>
				</xsl:if>
				<!-- Odd row number (used for display style via CSS) -->
				<xsl:if test="position() mod 2 != 0">
					<tr class="property-row-odd">
						<td class="property-no"><xsl:value-of select="position()"/></td> 
						<td class="property-name"><xsl:apply-templates select="sdx:name"/></td> 
						<td class="property-type"><xsl:apply-templates select="sdx:type_name"/></td> 
						<td class="property-default"><xsl:apply-templates select="sdx:is_default/text()"/></td> 
						<td class="property-brief"><xsl:apply-templates select="sdx:in_brief/text()"/></td> 
						<td class="property-storeTermVector"><xsl:apply-templates select="sdx:storeTermVector"/></td>
						<td class="property-locale"><xsl:apply-templates select="sdx:locale"/></td> 
						<td class="property-analyzer"><xsl:apply-templates select="sdx:analyzer/sdx:type"/></td>
						<td class="property-config">todo</td>
					</tr>
				</xsl:if>
	 		</xsl:when>
			
			<!--
				In any other case, we output the data as an unordered html list, so we can keep the tree structure as we go through the childs elements.
				As this should no longer happen other than for debuging purpose, we add a [*] before each element to keep a track of what is going out of here.
			-->
	 		<xsl:otherwise>
				<xsl:if test="current()!=text()">
					<li><i>[*]&#160;</i><xsl:apply-templates select="name()"/><xsl:if test="count(child::*) = 0 and text() != ''">&#160;=&#160;<b><xsl:apply-templates select="."/></b></xsl:if>
					<xsl:if test="count(child::*) > 0"><ul><xsl:apply-templates select="child::*"/></ul></xsl:if>
					</li>
				</xsl:if>
				<xsl:if test="current()=text()">
					<xsl:apply-templates/>
				</xsl:if>
	 		</xsl:otherwise>
			
		</xsl:choose>
	</xsl:template>
   
   
	<!-- ======  COMMON TEMPLATES  ====================== 
			short templates to format messages
			known issues : no correct id for a repeated help button 
			then hide/show message can't work
			but is it useful to repeat the same help ?
	-->  

	<o:template match="xfm:help">
		<o:param name="id" select="@id"/>
		<input type="button" class="xfm_help" tabindex="32767" value="?">
		<o:attribute name="onclick">if(document.getElementById) var o=document.getElementById('<o:value-of select="$id"/>_help'); if (o!=null) o.style.display=(o.style.display=='none')?'':'none'; </o:attribute>
		</input>
		<table cellpadding="1" cellspacing="0" border="0" class="xfm_help" style="display:none;">
			<o:attribute name="id">
			<o:value-of select="$id"/>_help</o:attribute>
			<tr>
				<td width="90%" class="xfm_bar">
					<o:value-of select="(caption | title | h1 )[1]"/>
				</td>
				<td align="right" class="xfm_bar">
					<input type="button" class="xfm_key" value="X">
					<o:attribute name="onclick">if(document.getElementById) var o=document.getElementById('<o:value-of select="$id"/>_help'); if (o!=null) o.style.display=(o.style.display=='none')?'':'none'; </o:attribute>
					</input>
				</td>
			</tr>
			<tr>
				<td colspan="2" class="xfm_text">
				<o:apply-templates mode="copy"/>
				</td>
			</tr>
		</table>
	</o:template>
   
	<o:template match="xfm:caption" priority="-1">
		<o:apply-templates mode="copy"/>
	</o:template>
	
	<!-- Escape js string (or other search/replace)-->
	<o:template match="* | @* | text()" mode="replace" name="xfm:replace">
		<o:param name="string" select="normalize-space(.)"/>
		<o:param name="search">'</o:param>
		<o:param name="replace">\'</o:param>
		<o:choose>
			<o:when test="contains($string, $search)">
				<o:value-of select="concat(substring-before($string, $search), $replace)"/>
				<o:call-template name="xfm:replace">
					<o:with-param name="string" select="substring-after($string, $search)"/>
					<o:with-param name="search" select="$search"/>
					<o:with-param name="replace" select="$replace"/>
				</o:call-template>
			</o:when>
			<o:otherwise>
				<o:value-of select="$string"/>
			</o:otherwise>
		</o:choose>
	</o:template>
	
	<o:template match="*" priority="-1" mode="copy">
		<o:element name="{name()}">
			<o:apply-templates select="@*" mode="copy"/>
			<o:apply-templates mode="copy"/>
		</o:element>
	</o:template>
   
	<o:template match="@*" mode="copy">
		<o:copy/>
	</o:template>  


	<!-- ======  MESSAGES @xml:lang="fr"  ====================== -->  
	<xfm:messages xml:lang="fr">
		<xfm:caption id="title">SDX Administration - Application - Explorer</xfm:caption>
	  
		<!-- Titres -->
		<xfm:caption id="tApp">Application</xfm:caption>
		<xfm:caption id="tContents">Table des mati&#232;res</xfm:caption>
		<xfm:caption id="tData">Contenu de l'application</xfm:caption>
		
		<!-- Informations de debut de page -->
		<xfm:caption id="headDefault">Valeurs par d&#233;fauts</xfm:caption>
		<xfm:caption id="headDir">R&#233;pertoires</xfm:caption>
		<xfm:caption id="headDb">Base de donn&#233;es interne des utilisateurs</xfm:caption>
		<xfm:caption id="headSessionObject">Limite d'objets par session</xfm:caption>
		<xfm:caption id="headClass">Classes</xfm:caption>
		<xfm:caption id="headLib">Biblioth&#232;ques</xfm:caption>
		<xfm:caption id="headThes">Thesauri</xfm:caption>
		<xfm:caption id="headDbs">Bases de donn&#233;es internes des utilisateurs</xfm:caption>
		<xfm:caption id="headDocBases">Base de documents des utilisateurs</xfm:caption>
		
		<!-- Informations recurrentes ('g' signifie 'global') -->
		<xfm:caption id="gEmpty">Aucune Valeur</xfm:caption>
		<xfm:caption id="gTrue">vrai</xfm:caption>
		<xfm:caption id="gFalse">faux</xfm:caption>
		<xfm:caption id="gEncode">Encodage</xfm:caption>
		<xfm:caption id="gDocBases">Bases de documents</xfm:caption>
		<xfm:caption id="gDocBase">Base de documents</xfm:caption>
		<xfm:caption id="gDataBases">Bases de donn&#233;es internes</xfm:caption>
		<xfm:caption id="gDataBase">Base de donn&#233;es interne</xfm:caption>
		<xfm:caption id="gRepos">Entrep&#244;ts</xfm:caption>
		<xfm:caption id="gRepo">Entrep&#244;t</xfm:caption>
		<xfm:caption id="gFieldList">Liste de champs</xfm:caption>
		<xfm:caption id="gDir">R&#233;pertoire</xfm:caption>
		<xfm:caption id="gProps">Propri&#233;t&#233;s</xfm:caption>
		<xfm:caption id="gIsDefault">Par d&#233;faut</xfm:caption>
		<xfm:caption id="gLocale">Localisation</xfm:caption>
		<xfm:caption id="gName">Nom</xfm:caption>
		<xfm:caption id="gType">Type</xfm:caption>
		<xfm:caption id="gDateSDX">Date SDX</xfm:caption>
		<xfm:caption id="gDateISO">Date ISO-8601</xfm:caption>
		<xfm:caption id="gDateMilli">Date en millisecondes</xfm:caption>
		<xfm:caption id="gUrlDoc">URL du document</xfm:caption>
		<xfm:caption id="gWordAnalyzer">Analyseur de mots</xfm:caption>
		<xfm:caption id="gDocCount">Nombre de documents</xfm:caption>
		
		<!-- Informations specifiques -->
		<xfm:caption id="docBaseType">Type de base de documents</xfm:caption>
		<xfm:caption id="thesType">Type de thesaurus</xfm:caption>
		<xfm:caption id="adminIdGroup">Identifiant de groupe administrateur</xfm:caption>
		<xfm:caption id="adminIdUser">Identifiant utilisateur d'administrateur</xfm:caption>
		<xfm:caption id="defaultRepo">Entrep&#244;t par d&#233;faut</xfm:caption>
		<xfm:caption id="keepOriginal">Conserver les documents originaux</xfm:caption>
		<xfm:caption id="pipeline">Pipeline <i>(canalisation)</i></xfm:caption>
		<xfm:caption id="transformation">Transformation</xfm:caption>
		<xfm:caption id="index">Index</xfm:caption>
		<xfm:caption id="engine">Moteur</xfm:caption>
		<xfm:caption id="path">Chemin</xfm:caption>
		<xfm:caption id="readOnly">Lecture seule</xfm:caption>
		<xfm:caption id="useCache">Utilise le cache</xfm:caption>
		<xfm:caption id="checkOnGet">V&#233;rification lors de l'obtention</xfm:caption>
		<xfm:caption id="baseDirectory">R&#233;pertoire de base</xfm:caption>
		<xfm:caption id="docDirectory">R&#233;pertoire des documents</xfm:caption>
		<xfm:caption id="filePrefix">Pr&#233;fixe de nom de fichier</xfm:caption>
		<xfm:caption id="fileSuffix">Suffixe de nom de fichier</xfm:caption>
		<xfm:caption id="extent">Ampleur</xfm:caption>
		<xfm:caption id="depth">Profondeur</xfm:caption>
		<xfm:caption id="fields">Champs</xfm:caption>
		<xfm:caption id="defaultField">Champ par d&#233;faut</xfm:caption>
		<xfm:caption id="ignoreCase">Ignore la casse</xfm:caption>
		<xfm:caption id="number">No</xfm:caption>
		<xfm:caption id="default">Par d&#233;faut</xfm:caption>
		<xfm:caption id="brief">Bref</xfm:caption>
		<xfm:caption id="config">Config</xfm:caption>
		<xfm:caption id="dbMember">Membres</xfm:caption>
		<xfm:caption id="dbJDBCTableName">Nom de la table JDBC</xfm:caption>
		<xfm:caption id="useCF">Utilise les fichiers composites</xfm:caption>
		<xfm:caption id="dbType">Type de base de donn&#233;es</xfm:caption>
		<xfm:caption id="indexCreate">Date de cr&#233;ation</xfm:caption>
		<xfm:caption id="indexMaj">Date de derni&#232;re modification</xfm:caption>
		<xfm:caption id="source">Source</xfm:caption>
		<xfm:caption id="relation">Relation</xfm:caption>
		<xfm:caption id="baseURL">URL de base</xfm:caption>
		<xfm:caption id="dataSrcId">Identifiant de la source de donn&#233;es</xfm:caption>
		<xfm:caption id="storeTermVector">TermVector</xfm:caption>
		<xfm:caption id="autoOptimize">Optimisation automatique</xfm:caption>
		<xfm:caption id="isOptimized">Optimis&#233;</xfm:caption>
		<xfm:caption id="indexFullSize">Taille totale de l'index</xfm:caption>
		<xfm:caption id="indexCountFiles">Nombre de fichiers d'index</xfm:caption>
		<xfm:caption id="indexFileSize">Taille maximum d'un fichier d'index</xfm:caption>
		<xfm:caption id="indexMaxDoc">Nombre de documents maximums par fichier d'index</xfm:caption>
		
		<!-- Donnees OAI -->
		<xfm:caption id="oaiIdentify">Identification</xfm:caption>
		<xfm:caption id="oaiRepoName">Nom de l'entrep&#244;t</xfm:caption>
		<xfm:caption id="oaiBaseUrl">URL de base</xfm:caption>
		<xfm:caption id="oaiProtocol">Version du protocole</xfm:caption>
		<xfm:caption id="oaiMail">Mail de l'administrateur</xfm:caption>
		<xfm:caption id="oaiTimeStamp">Derni&#232;re activation</xfm:caption>
		<xfm:caption id="oaiDelete">Suppression d'enregistrements</xfm:caption>
		<xfm:caption id="oaiGranularity">Format date</xfm:caption>
		
		<!-- Messages d'informations pour le super-utilisateur -->
		<xfm:caption id="nOptimizationDone">Optimisation r&#233;ussie</xfm:caption>
		<xfm:caption id="nNullDocumentBase">La base de document demand&#233;e n'existe pas</xfm:caption>
		<xfm:caption id="nSaveApplicationDone">Sauvegarde de l'application r&#233;ussie</xfm:caption>
		<xfm:caption id="nCheckIntegrityDone">V&#233;rification l'int&#233;grit&#233; r&#233;ussie</xfm:caption>
		
		<!-- Boutons : libelle / infos contextuelles -->
		<xfm:caption id="iOptimizeBaseDoc">Optimiser</xfm:caption>
		<xfm:hint id="hOptimize">Optimise les &#233;l&#233;ments de la base de document, en particulier l'index (long).</xfm:hint>
		<xfm:hint id="hOptimizeApplication">Optimise toutes les bases de documents de l'application (long).</xfm:hint>
		<xfm:caption id="iSaveApplication">Sauvegarder</xfm:caption>
		<xfm:hint id="hSaveApplication">Effectue une sauvegarde compl&#232;te de l'application</xfm:hint>
		<xfm:caption id="iCheckIntegrity">Int&#233;grit&#233;</xfm:caption>
		<xfm:hint id="hCheckIntegrity">V&#233;rifie l'int&#233;grit&#233; de la base de document</xfm:hint>
		<xfm:hint id="hCheckIntegrityApplication">V&#233;rifie l'int&#233;grit&#233; de l'application compl&#232;te</xfm:hint>
		
	</xfm:messages>
	
	<!-- ======  MESSAGES @xml:lang="en"  ====================== -->  
	<xfm:messages xml:lang="en">
		<xfm:caption id="title">SDX Administration - Application - Explore</xfm:caption>
		
		<!-- Titles -->
		<xfm:caption id="tApp">Application</xfm:caption>
		<xfm:caption id="tContents">Table of contents</xfm:caption>
		<xfm:caption id="tData">Application content</xfm:caption>
		
		<!-- Data from page begin -->
		<xfm:caption id="headDefault">Default values</xfm:caption>
		<xfm:caption id="headDir">Directories</xfm:caption>
		<xfm:caption id="headDb">Internal users database</xfm:caption>
		<xfm:caption id="headSessionObject">Session object limit</xfm:caption>
		<xfm:caption id="headClass">Classes</xfm:caption>
		<xfm:caption id="headLib">Libraries</xfm:caption>
		<xfm:caption id="headThes">Thesauri</xfm:caption>
		<xfm:caption id="headDbs">Internal users databases</xfm:caption>
		<xfm:caption id="headDocBases">Users documentBases</xfm:caption>
		
		<!-- Multiple occurences data ('g' stand for 'global') -->
		<xfm:caption id="gEmpty">No Value</xfm:caption>
		<xfm:caption id="gTrue">true</xfm:caption>
		<xfm:caption id="gFalse">false</xfm:caption>
		<xfm:caption id="gEncode">Encoding</xfm:caption>
		<xfm:caption id="gDocBases">DocumentBases</xfm:caption>
		<xfm:caption id="gDocBase">DocumentBase</xfm:caption>
		<xfm:caption id="gDataBases">Internal databases</xfm:caption>
		<xfm:caption id="gDataBase">Internal database</xfm:caption>
		<xfm:caption id="gRepos">Repositories</xfm:caption>
		<xfm:caption id="gRepo">Repository</xfm:caption>
		<xfm:caption id="gFieldList">Fields list</xfm:caption>
		<xfm:caption id="gDir">Directory</xfm:caption>
		<xfm:caption id="gProps">Properties</xfm:caption>
		<xfm:caption id="gIsDefault">Is default</xfm:caption>
		<xfm:caption id="gLocale">Locale</xfm:caption>
		<xfm:caption id="gName">Name</xfm:caption>
		<xfm:caption id="gType">Type</xfm:caption>
		<xfm:caption id="gDateSDX">SDX date</xfm:caption>
		<xfm:caption id="gDateISO">ISO-8601 date</xfm:caption>
		<xfm:caption id="gDateMilli">Date in milliseconds</xfm:caption>
		<xfm:caption id="gUrlDoc">Document's URL</xfm:caption>
		<xfm:caption id="gWordAnalyzer">Word Analyzer</xfm:caption>
		<xfm:caption id="gDocCount">Document count</xfm:caption>
		
		<!-- Specific data -->
		<xfm:caption id="docBaseType">DocumentBase type</xfm:caption>
		<xfm:caption id="thesType">Thesaurus type</xfm:caption>
		<xfm:caption id="adminIdGroup">Administrator group ID</xfm:caption>
		<xfm:caption id="adminIdUser">Administrator user ID</xfm:caption>
		<xfm:caption id="defaultRepo">Default repository</xfm:caption>
		<xfm:caption id="keepOriginal">Keep original documents</xfm:caption>
		<xfm:caption id="pipeline">Pipeline</xfm:caption>
		<xfm:caption id="transformation">Transformation</xfm:caption>
		<xfm:caption id="index">Index</xfm:caption>
		<xfm:caption id="engine">Engine</xfm:caption>
		<xfm:caption id="path">Path</xfm:caption>
		<xfm:caption id="readOnly">Read only</xfm:caption>
		<xfm:caption id="useCache">Use cache</xfm:caption>
		<xfm:caption id="checkOnGet">Check on get</xfm:caption>
		<xfm:caption id="baseDirectory">Base directory</xfm:caption>
		<xfm:caption id="docDirectory">Document directory</xfm:caption>
		<xfm:caption id="filePrefix">File prefix</xfm:caption>
		<xfm:caption id="fileSuffix">File suffix</xfm:caption>
		<xfm:caption id="extent">Extent</xfm:caption>
		<xfm:caption id="depth">Depth</xfm:caption>
		<xfm:caption id="fields">Fields</xfm:caption>
		<xfm:caption id="defaultField">Default field</xfm:caption>
		<xfm:caption id="ignoreCase">Ignore case</xfm:caption>
		<xfm:caption id="number">No</xfm:caption>
		<xfm:caption id="default">Default</xfm:caption>
		<xfm:caption id="brief">Brief</xfm:caption>
		<xfm:caption id="config">Config</xfm:caption>
		<xfm:caption id="dbMember">Members</xfm:caption>
		<xfm:caption id="dbJDBCTableName">JDBC table name</xfm:caption>
		<xfm:caption id="useCF">Use compound files</xfm:caption>
		<xfm:caption id="dbType">Database  type</xfm:caption>
		<xfm:caption id="indexCreate">Creation date</xfm:caption>
		<xfm:caption id="indexMaj">Last modification date</xfm:caption>
		<xfm:caption id="source">Source</xfm:caption>
		<xfm:caption id="relation">Relation</xfm:caption>
		<xfm:caption id="baseURL">Basic URL</xfm:caption>
		<xfm:caption id="dataSrcId">Data source identifier</xfm:caption>
		<xfm:caption id="storeTermVector">TermVector</xfm:caption>
		<xfm:caption id="autoOptimize">Automatic optimization</xfm:caption>
		<xfm:caption id="isOptimized">Optimised</xfm:caption>
		<xfm:caption id="indexFullSize">Total index size</xfm:caption>
		<xfm:caption id="indexCountFiles">Index files count</xfm:caption>
		<xfm:caption id="indexFileSize">Maximum size for an index file</xfm:caption>
		<xfm:caption id="indexMaxDoc">Maximum indexed document for an index file</xfm:caption>
		
		<!-- OAI Data -->
		<xfm:caption id="oaiIdentify">Identify</xfm:caption>
		<xfm:caption id="oaiRepoName">Repository name</xfm:caption>
		<xfm:caption id="oaiBaseUrl">Base URL</xfm:caption>
		<xfm:caption id="oaiProtocol">Protocol version</xfm:caption>
		<xfm:caption id="oaiMail">Mail admin</xfm:caption>
		<xfm:caption id="oaiTimeStamp">Earliest timestamp</xfm:caption>
		<xfm:caption id="oaiDelete">Deleted record</xfm:caption>
		<xfm:caption id="oaiGranularity">Granularity</xfm:caption>
		
		<!-- Information message for the superuser -->
		<xfm:caption id="nOptimizationDone">Optimization successful</xfm:caption>
		<xfm:caption id="nNullDocumentBase">The requested DocumentBase doesn't exist for this application</xfm:caption>
		<xfm:caption id="nSaveApplicationDone">Application backup successful</xfm:caption>
		<xfm:caption id="nCheckIntegrityDone">Integrity check successful</xfm:caption>
		
		<!-- Button caption and hints -->
		<xfm:caption id="iOptimizeBaseDoc">Optimize</xfm:caption>
		<xfm:hint id="hOptimize">Optimize the DocumentBase, mainly the index (long).</xfm:hint>
		<xfm:hint id="hOptimizeApplication">Optimize all application's DocumentBases (long).</xfm:hint>
		<xfm:caption id="iSaveApplication">Backup</xfm:caption>
		<xfm:hint id="hSaveApplication">Do a full application backup</xfm:hint>
		<xfm:caption id="iCheckIntegrity">Integrity</xfm:caption>
		<xfm:hint id="hCheckIntegrity">Check the DocumentBase integrity</xfm:hint>
		<xfm:hint id="hCheckIntegrityApplication">Check the application integrity</xfm:hint>
		
	</xfm:messages>
	
	<!-- ======  MESSAGES @xml:lang="es"  ====================== -->  
	<xfm:messages xml:lang="es">
		<xfm:caption id="title">Administraci&#243;n de SDX - Uso - Explorar</xfm:caption>
		
		<!-- Titulos -->
		<xfm:caption id="tApp">Uso</xfm:caption>
		<xfm:caption id="tContents">Tabla de contenido</xfm:caption>
		<xfm:caption id="tData">Contenido del uso</xfm:caption>
		
		<!-- Los datos de la pagina comienzan -->
		<xfm:caption id="headDefault">Valores prefijados</xfm:caption>
		<xfm:caption id="headDir">Directorios</xfm:caption>
		<xfm:caption id="headDb">Base de datos interna de los usuarios</xfm:caption>
		<xfm:caption id="headSessionObject">L&#237;mite del objeto de la sesi&#243;n</xfm:caption>
		<xfm:caption id="headClass">Clases</xfm:caption>
		<xfm:caption id="headLib">Bibliotecas</xfm:caption>
		<xfm:caption id="headThes">Tesoros</xfm:caption>
		<xfm:caption id="headDbs">Base de datos interna de los usuarios</xfm:caption>
		<xfm:caption id="headDocBases">Bases del documento de los usuarios</xfm:caption>
		
		<!-- Datos multiples de los sucesos (soporte de 'g' para 'global') -->
		<xfm:caption id="gEmpty">Ning&#250;n Valor</xfm:caption>
		<xfm:caption id="gTrue">verdadero</xfm:caption>
		<xfm:caption id="gFalse">falso</xfm:caption>
		<xfm:caption id="gEncode">Codificaci&#243;n</xfm:caption>
		<xfm:caption id="gDocBases">Bases Del Documento</xfm:caption>
		<xfm:caption id="gDocBase">Base Del Documento</xfm:caption>
		<xfm:caption id="gDataBases">Bases de datos interna</xfm:caption>
		<xfm:caption id="gDataBase">Base de datos interna</xfm:caption>
		<xfm:caption id="gRepos">Dep&#243;sitos</xfm:caption>
		<xfm:caption id="gRepo">Dep&#243;sito</xfm:caption>
		<xfm:caption id="gFieldList">Lista de los campos</xfm:caption>
		<xfm:caption id="gDir">Directorio</xfm:caption>
		<xfm:caption id="gProps">Caracter&#237;sticas</xfm:caption>
		<xfm:caption id="gIsDefault">Es el defecto</xfm:caption>
		<xfm:caption id="gLocale">Localizaci&#243;n</xfm:caption>
		<xfm:caption id="gName">Nombre</xfm:caption>
		<xfm:caption id="gType">Tipo</xfm:caption>
		<xfm:caption id="gDateSDX">Fecha de SDX</xfm:caption>
		<xfm:caption id="gDateISO">Fecha de ISO-8601</xfm:caption>
		<xfm:caption id="gDateMilli">Feche en milisegundos</xfm:caption>
		<xfm:caption id="gUrlDoc">URL de documento</xfm:caption>
		<xfm:caption id="gWordAnalyzer">Analizador De la Palabra</xfm:caption>
		<xfm:caption id="gDocCount">Documente a conde</xfm:caption>
		
		<!-- Datos especificos -->
		<xfm:caption id="docBaseType">Tipo del bajo documento</xfm:caption>
		<xfm:caption id="thesType">Tipo del tesoro</xfm:caption>
		<xfm:caption id="adminIdGroup">Identificaci&#243;n de grupo del administrador</xfm:caption>
		<xfm:caption id="adminIdUser">Identificaci&#243;n del usuario del administrador</xfm:caption>
		<xfm:caption id="defaultRepo">Dep&#243;sito del defecto</xfm:caption>
		<xfm:caption id="keepOriginal">Guardar los documentos originales</xfm:caption>
		<xfm:caption id="pipeline">Pipeline <i>(Tuber&#237;a)</i></xfm:caption>
		<xfm:caption id="transformation">Transformaci&#243;n</xfm:caption>
		<xfm:caption id="index">&#205;ndice</xfm:caption>
		<xfm:caption id="engine">Motor</xfm:caption>
		<xfm:caption id="path">Trayectoria</xfm:caption>
		<xfm:caption id="readOnly">Le&#237;do solamente</xfm:caption>
		<xfm:caption id="useCache">Utilice el escondrijo</xfm:caption>
		<xfm:caption id="checkOnGet">Consigue el cheque encendido</xfm:caption>
		<xfm:caption id="baseDirectory">Directorio bajo</xfm:caption>
		<xfm:caption id="docDirectory">Directorio de documento</xfm:caption>
		<xfm:caption id="filePrefix">Prefijo del archivo</xfm:caption>
		<xfm:caption id="fileSuffix">Sufijo del archivo</xfm:caption>
		<xfm:caption id="extent">Grado</xfm:caption>
		<xfm:caption id="depth">Profundidad</xfm:caption>
		<xfm:caption id="fields">Campos</xfm:caption>
		<xfm:caption id="defaultField">Campo del defecto</xfm:caption>
		<xfm:caption id="ignoreCase">No haga caso del caso</xfm:caption>
		<xfm:caption id="number">N</xfm:caption>
		<xfm:caption id="default">Defecto</xfm:caption>
		<xfm:caption id="brief">Escrito</xfm:caption>
		<xfm:caption id="config">Config</xfm:caption>
		<xfm:caption id="dbMember">Miembros</xfm:caption>
		<xfm:caption id="dbJDBCTableName">Nombre de mesa de JDBC</xfm:caption>
		<xfm:caption id="useCF">Utilice los archivos compuestos</xfm:caption>
		<xfm:caption id="dbType">De tipo base de datos</xfm:caption>
		<xfm:caption id="indexCreate">Fecha de creaci&#243;n</xfm:caption>
		<xfm:caption id="indexMaj">Dure la fecha de la modificaci&#243;n</xfm:caption>
		<xfm:caption id="source">Fuente</xfm:caption>
		<xfm:caption id="relation">Relaci&#243;n</xfm:caption>
		<xfm:caption id="baseURL">URL b&#225;sico</xfm:caption>
		<xfm:caption id="dataSrcId">Identificaci&#243;n de fuente de datos</xfm:caption>
		<xfm:caption id="storeTermVector">TermVector</xfm:caption>
		<xfm:caption id="autoOptimize">Optimizaci&#243;n autom&#225;tica</xfm:caption>
		<xfm:caption id="isOptimized">Optimizado</xfm:caption>
		<xfm:caption id="indexFullSize">Tama&#241;o total de &#237;ndice</xfm:caption>
		<xfm:caption id="indexCountFiles">Los archivos del &#237;ndice cuentan</xfm:caption>
		<xfm:caption id="indexFileSize">El tama&#241;o m&#225;ximo para un archivo del &#237;ndice</xfm:caption>
		<xfm:caption id="indexMaxDoc">El m&#225;ximo index&#243; documento para un archivo del &#237;ndice</xfm:caption>
		
		<!-- Datos de OAI -->
		<xfm:caption id="oaiIdentify">Identifique</xfm:caption>
		<xfm:caption id="oaiRepoName">Nombre del dep&#243;sito</xfm:caption>
		<xfm:caption id="oaiBaseUrl">URL de la base</xfm:caption>
		<xfm:caption id="oaiProtocol">Versi&#243;n del protocolo</xfm:caption>
		<xfm:caption id="oaiMail">Correo del admin</xfm:caption>
		<xfm:caption id="oaiTimeStamp">El timestamp m&#225;s temprano</xfm:caption>
		<xfm:caption id="oaiDelete">Expediente suprimido</xfm:caption>
		<xfm:caption id="oaiGranularity">Formato</xfm:caption>
		
		<!-- Information message for the superuser -->
		<xfm:caption id="nOptimizationDone">Optimizaci&#243;n exitosa</xfm:caption>
		<xfm:caption id="nNullDocumentBase">El DocumentBase solicitado no existe para esta aplicaci&#243;n</xfm:caption>
		<xfm:caption id="nSaveApplicationDone">Aplicaci&#243;n de respaldo exitosa</xfm:caption>
		<xfm:caption id="nCheckIntegrityDone">Cheque de integridad exitoso</xfm:caption>
		
		<!-- Button caption and hints -->
		<xfm:caption id="iOptimizeBaseDoc">Optimice</xfm:caption>
		<xfm:hint id="hOptimize">Optimice el bases del documento, principalmente el &#237;ndice (largo).</xfm:hint>
		<xfm:hint id="hOptimizeApplication">Optimice todo bases del documento (largo) de la aplicaci&#243;n. </xfm:hint>
		<xfm:caption id="iSaveApplication">Respaldo</xfm:caption>
		<xfm:hint id="hSaveApplication">Haga un respaldo repleto de la aplicaci&#243;n</xfm:hint>
		<xfm:caption id="iCheckIntegrity">Integridad</xfm:caption>
		<xfm:hint id="hCheckIntegrity">Verifique la integridad debBases del documento</xfm:hint>
		<xfm:hint id="hCheckIntegrityApplication">Verifique la integridad de la aplicaci&#243;n</xfm:hint>
		
	</xfm:messages>
	
	<!-- ======  MESSAGES @xml:lang="pt"  ====================== -->  
	<xfm:messages xml:lang="pt">
		<xfm:caption id="title">Administra&#231;&#227;o de SDX - Aplica&#231;&#227;o - Explorar</xfm:caption>
		
		<!-- Titulos -->
		<xfm:caption id="tApp">Aplica&#231;&#227;o</xfm:caption>
		<xfm:caption id="tContents">tabela da &#237;ndices</xfm:caption>
		<xfm:caption id="tData">&#205;ndice da aplica&#231;&#227;o</xfm:caption>
		
		<!-- Os dados da pagina comecam -->
		<xfm:caption id="headDefault">Valores de defeito</xfm:caption>
		<xfm:caption id="headDir">Diret&#243;rios</xfm:caption>
		<xfm:caption id="headDb">Base de dados interna dos usu&#225;rios</xfm:caption>
		<xfm:caption id="headSessionObject">Limite do objeto da sess&#227;o</xfm:caption>
		<xfm:caption id="headClass">Classes</xfm:caption>
		<xfm:caption id="headLib">Bibliotecas</xfm:caption>
		<xfm:caption id="headThes">Enciclop&#233;dias</xfm:caption>
		<xfm:caption id="headDbs">Base de dados interna dos usu&#225;rios</xfm:caption>
		<xfm:caption id="headDocBases">Base do documento dos usu&#225;rios</xfm:caption>
		
		<!-- Dados multiplos dos ocorrencias (carrinho de 'g' para 'global') -->
		<xfm:caption id="gEmpty">Nenhum Valor</xfm:caption>
		<xfm:caption id="gTrue">verdadero</xfm:caption>
		<xfm:caption id="gFalse">falso</xfm:caption>
		<xfm:caption id="gEncode">Codifica&#231;&#227;o</xfm:caption>
		<xfm:caption id="gDocBases">Base do documentos</xfm:caption>
		<xfm:caption id="gDocBase">Base do documentos</xfm:caption>
		<xfm:caption id="gDataBases">Base de dados interna</xfm:caption>
		<xfm:caption id="gDataBase">Base de dados interna</xfm:caption>
		<xfm:caption id="gRepos">Reposit&#243;rios</xfm:caption>
		<xfm:caption id="gRepo">Reposit&#243;rio</xfm:caption>
		<xfm:caption id="gFieldList">Lista dos campos</xfm:caption>
		<xfm:caption id="gDir">Diret&#243;rio</xfm:caption>
		<xfm:caption id="gProps">Propriedades</xfm:caption>
		<xfm:caption id="gIsDefault">&#201; o defeito</xfm:caption>
		<xfm:caption id="gLocale">Localiza&#231;&#227;o</xfm:caption>
		<xfm:caption id="gName">Nome</xfm:caption>
		<xfm:caption id="gType">Tipo</xfm:caption>
		<xfm:caption id="gDateSDX">Data de SDX</xfm:caption>
		<xfm:caption id="gDateISO">Data de ISO-8601</xfm:caption>
		<xfm:caption id="gDateMilli">Date em milliseconds</xfm:caption>
		<xfm:caption id="gUrlDoc">URL do documento</xfm:caption>
		<xfm:caption id="gWordAnalyzer">Analisador da Palavra</xfm:caption>
		<xfm:caption id="gDocCount">Documente contagem</xfm:caption>
		
		<!-- Dados especificos -->
		<xfm:caption id="docBaseType">Tipo do basear do documentos</xfm:caption>
		<xfm:caption id="thesType">Tipo da enciclop&#233;dia</xfm:caption>
		<xfm:caption id="adminIdGroup">Grupo ID do administrador</xfm:caption>
		<xfm:caption id="adminIdUser">Usu&#225;rio ID do administrador</xfm:caption>
		<xfm:caption id="defaultRepo">Reposit&#243;rio do defeito</xfm:caption>
		<xfm:caption id="keepOriginal">Mantenha os originais documentos</xfm:caption>
		<xfm:caption id="pipeline">Pipeline <i>(Encanamento)</i></xfm:caption>
		<xfm:caption id="transformation">Transforma&#231;&#227;o</xfm:caption>
		<xfm:caption id="index">&#205;ndice</xfm:caption>
		<xfm:caption id="engine">Motor</xfm:caption>
		<xfm:caption id="path">Trajeto</xfm:caption>
		<xfm:caption id="readOnly">Lido somente</xfm:caption>
		<xfm:caption id="useCache">Usa o esconderijo</xfm:caption>
		<xfm:caption id="checkOnGet">O cheque em receber</xfm:caption>
		<xfm:caption id="baseDirectory">Diret&#243;rio do basear</xfm:caption>
		<xfm:caption id="docDirectory">Diret&#243;rio de documento</xfm:caption>
		<xfm:caption id="filePrefix">Prefixo da lima</xfm:caption>
		<xfm:caption id="fileSuffix">Sufixo da lima</xfm:caption>
		<xfm:caption id="extent">Extens&#227;o</xfm:caption>
		<xfm:caption id="depth">Profundidade</xfm:caption>
		<xfm:caption id="fields">Campos</xfm:caption>
		<xfm:caption id="defaultField">Campo do defeito</xfm:caption>
		<xfm:caption id="ignoreCase">Ignore o caso</xfm:caption>
		<xfm:caption id="number">N</xfm:caption>
		<xfm:caption id="default">Defeito</xfm:caption>
		<xfm:caption id="brief">Sum&#225;rio</xfm:caption>
		<xfm:caption id="config">Config</xfm:caption>
		<xfm:caption id="dbMember">Membros</xfm:caption>
		<xfm:caption id="dbJDBCTableName">Nome de tabela de JDBC</xfm:caption>
		<xfm:caption id="useCF">Use arquivos compostos</xfm:caption>
		<xfm:caption id="dbType">Tipo de base de dados</xfm:caption>
		<xfm:caption id="indexCreate">Data de cria&#231;&#227;o</xfm:caption>
		<xfm:caption id="indexMaj">Dure data de modifica&#231;&#227;o</xfm:caption>
		<xfm:caption id="source">Fonte</xfm:caption>
		<xfm:caption id="relation">Rela&#231;&#227;o</xfm:caption>
		<xfm:caption id="baseURL">URL b&#225;sico</xfm:caption>
		<xfm:caption id="dataSrcId">Identifier de fonte de dados</xfm:caption>
		<xfm:caption id="storeTermVector">TermVector</xfm:caption>
		<xfm:caption id="autoOptimize">Optimization autom&#225;tico</xfm:caption>
		<xfm:caption id="isOptimized">Optimizado</xfm:caption>
		<xfm:caption id="indexFullSize">Tamanho total de &#237;ndice</xfm:caption>
		<xfm:caption id="indexCountFiles">Os arquivos de &#237;ndice contam</xfm:caption>
		<xfm:caption id="indexFileSize">Tamanho m&#225;ximo para um arquivo de &#237;ndice</xfm:caption>
		<xfm:caption id="indexMaxDoc">Documento m&#225;ximo de indexed para um arquivo de &#237;ndice</xfm:caption>
		
		<!-- Dados de OAI -->
		<xfm:caption id="oaiIdentify">Identifique</xfm:caption>
		<xfm:caption id="oaiRepoName">Nome do reposit&#243;rio</xfm:caption>
		<xfm:caption id="oaiBaseUrl">URL da basear</xfm:caption>
		<xfm:caption id="oaiProtocol">Vers&#227;o do protocolo</xfm:caption>
		<xfm:caption id="oaiMail">Correio do admin</xfm:caption>
		<xfm:caption id="oaiTimeStamp">O timestamp o mais adiantado</xfm:caption>
		<xfm:caption id="oaiDelete">Registro suprimido</xfm:caption>
		<xfm:caption id="oaiGranularity">Formato</xfm:caption>
		
		<!-- Information message for the superuser -->
		<xfm:caption id="nOptimizationDone">O Optimization bem sucedido</xfm:caption>
		<xfm:caption id="nNullDocumentBase">O DocumentBase solicitado n&#227;o existe para esta aplica&#231;&#227;o</xfm:caption>
		<xfm:caption id="nSaveApplicationDone">O apoio de aplica&#231;&#227;o bem sucedido</xfm:caption>
		<xfm:caption id="nCheckIntegrityDone">O cheque de integridade bem sucedido</xfm:caption>
		
		<!-- Button caption and hints -->
		<xfm:caption id="iOptimizeBaseDoc">Optimizar</xfm:caption>
		<xfm:hint id="hOptimize">Optimizar o base do documento, principalmente o &#237;ndice (longo).</xfm:hint>
		<xfm:hint id="hOptimizeApplication">Optimize toda aplica&#231;&#227;o base do documento (longo). </xfm:hint>
		<xfm:caption id="iSaveApplication">Apoio</xfm:caption>
		<xfm:hint id="hSaveApplication">Fa&#231;a um pleno apoio de aplica&#231;&#227;o</xfm:hint>
		<xfm:caption id="iCheckIntegrity">Integridade</xfm:caption>
		<xfm:hint id="hCheckIntegrity">Verifique a integridade de base do documento</xfm:hint>
		<xfm:hint id="hCheckIntegrityApplication">Verifique a integridade de aplica&#231;&#227;o</xfm:hint>
		
	</xfm:messages>
	
	<o:template match="node()" mode="onload" priority="-2"/>
</o:stylesheet>

```

</details>


---

### 📄 `admin/xsl/login.xsl` [4.250 octets]
<a id="admin-xsl-login-xsl"></a> [↩ Retour à l'arborescence](#tree-admin-xsl-login-xsl)

> **Chemin relatif** : `admin/xsl/login.xsl`  
> **Taille** : 4.250 octets  
> **Lignes** : 118  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (118 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet xmlns="http://www.w3.org/1999/xhtml" version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" exclude-result-prefixes="sdx xsl">
	<xsl:import href="../../sdxlib/xsl/skin.xsl"/>
	<xsl:param name="id" select="''"/>
	<xsl:param name="pass"/>
	
	<xsl:template name="onload">
		<xsl:text>document.forms.login.id.focus();</xsl:text>
	</xsl:template>
	
	<xsl:template match="rights">
		<h1>Droits</h1>
		<p>L'administration d'une application SDX peut être sécurisée,
			selon les notions courantes de "groupe" et d' "utilisateur".
			Pour cette application, des identités par défaut ont été définies
			dans le fichier de configuration : le groupe "admins", avec pour
			membre l'utilisateur "admin". L'accès aux bases de document est ici
			réservé aux membres du groupe "admins". L'utilisateur "admin"
			est donc autorisé, mais vous pouvez définir d'autres identités 
			(utilisateurs ou groupes) par l'interface suivante : 
			<a href="../sdx/admin/identities.xsp?app=fr.gouv.culture.sdx.sdxworld">
				../sdx/admin
			</a>.
			<!--
			Pour accéder directement aux bases de cette application
			cliquez <a  class="but" href="admin.xsp">Documents</a>.
			-->
		</p>
	</xsl:template>
	
	<xsl:template match="login">
		<form id="login" action="login.xsp" method="post">
			<div class="center">
			<table cellpadding="5" cellspacing="0" class="form">
				<caption>Connexion</caption>
				<tr>
					<th><label for="id">Code d'utilisateur :</label></th>
					<td>
						<input name="id" id="id" size="30" type="text" value="{$id}"/>
					</td>
				</tr>
				<tr>
					<th><label for="pass">Mot de passe :</label></th>
					<td>
						<input name="pass" id="pass" size="30" type="password" value="{$pass}"/>
					</td>
				</tr>
				<tr>
					<td colspan="2" class="center">
						<input type="submit" value="Entrer"/>
						<input type="submit" value="Déconnexion" name="logout"/>
					</td>
				</tr>
			</table>
			</div>
		</form>
	</xsl:template>
	
	<xsl:template match="identified">
		<div class="alert">
			<strong>Votre identité a été reconnue.</strong>
		</div>
	</xsl:template>
	
	<xsl:template match="anonymous">
		<div class="alert">
			Cette identité n'est pas connue pour cette application.
		</div>
	</xsl:template>
	
	<xsl:template match="admin">
		<div class="alert">
			<strong>Vous appartenez au groupe : "admins" ; vous pouvez accéder à l'administration de cette application.</strong>
		</div>
	</xsl:template>

	<xsl:template match="sdx:user">
		<xsl:choose>
			<xsl:when test="@id = 'ceddre'">
				<div class="alert">Vous pouvez maintenant accéder à <a href="../rechercheadmin.xsp">votre page d'administration</a></div>
			</xsl:when>
			<xsl:when test="@id = 'urbamet'">
				<div class="alert">Vous pouvez maintenant <a href="../adherents.xsp">gérer les adhésions et les envois de mails</a>.</div>
			</xsl:when>
		</xsl:choose>
	</xsl:template>

</xsl:stylesheet>

```

</details>


---

### 📄 `admin/xsl/logout.xsl` [1.675 octets]
<a id="admin-xsl-logout-xsl"></a> [↩ Retour à l'arborescence](#tree-admin-xsl-logout-xsl)

> **Chemin relatif** : `admin/xsl/logout.xsl`  
> **Taille** : 1.675 octets  
> **Lignes** : 41  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet xmlns="http://www.w3.org/1999/xhtml" version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" exclude-result-prefixes="sdx xsl">
	<xsl:import href="../../xsl/skin.xsl"/>
	<xsl:param name="id" select="'admin'"/>
	<xsl:param name="pass"/>
	<xsl:template match="logout">
		<h2>Déconnexion</h2>
		<p>Vous êtes désormais un utilisateur anonyme pour cette application.</p>
	</xsl:template>
</xsl:stylesheet>

```


---

### 📄 `admin/xsl/recherche2.xsl` [20.734 octets]
<a id="admin-xsl-recherche2-xsl"></a> [↩ Retour à l'arborescence](#tree-admin-xsl-recherche2-xsl)

> **Chemin relatif** : `admin/xsl/recherche2.xsl`  
> **Taille** : 20.734 octets  
> **Lignes** : 777  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (777 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 32000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet xmlns="http://www.w3.org/1999/xhtml" version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" exclude-result-prefixes="sdx">
    <xsl:include href="skin.xsl"/>
    
    <xsl:template name="onload">
	    
    </xsl:template>
    

<xsl:template match="recherche">

    
    <form name="recherche" action="results.xsp" method="get" onSubmit="javascript:return lanceRecherche();">
	    <input type="hidden" name="q"/>
	    <input type="hidden" name="log" value="true"/>
                 

	
     <table border="0" align="center" cellspacing="0" cellpadding="4" >
	      


	<!-- champ sujet -->
	
	
	<!--
	<xsl:call-template name="ecrit_operateur_champ">
			<xsl:with-param name="nomchamp">sujet</xsl:with-param>
	</xsl:call-template>
	-->
	
	<tr>
                <td class="formulaire_libelle">Sujet</td>
	      <td align="left">
	      <select name="op_mots_sujet">
		<option value="and" selected="selected">Et</option>
		<option value="or">Ou</option>
		<option value="not">Sauf</option>
	      </select>
	      </td>
                <td align="left"><input name="sujet" size="45" tabindex="1"/> </td>
	      <td align="left">
		      <a href="#" title="Afficher les index-mots du sujet" onClick="javascript:return afficheIndex('sujet','a','mot');">
		      <img src="icons/index.gif" border="0" width="29" height="20" align="absmiddle"/>
		      </a>
	       </td>
	</tr>
	
	<!-- champ auteur -->
	
	
	<tr>
                <td class="formulaire_libelle">Auteur</td>
	      <td align="left">
	      <select name="op_mots_auteur">
		<option value="and" selected="selected">Et</option>
		<option value="or">Ou</option>
		<option value="not">Sauf</option>
	      </select>
	      </td>
                <td align="left"><input name="auteur_mot" size="45" tabindex="1"/> </td>
	      <td align="left">
		      <a href="#" title="Afficher les index-mot des auteurs" onClick="javascript:return afficheIndex('auteur','A','expression');">
		      <img src="icons/index.gif" border="0" width="29" height="20" align="absmiddle"/>
		      </a>
	       </td>
	</tr>
   
	<tr>
                 <td class="formulaire_libelle"></td>
	       <td valign="top">
		       
	       </td>
                 <td align="left">
		
		<xsl:call-template name="ecritchampcache">
			<xsl:with-param name="nomchamp">auteur</xsl:with-param>
			<xsl:with-param name="nb">5</xsl:with-param>
		</xsl:call-template>

		</td>
		 <td align="left"></td>		
	</tr>
	
	<!-- lieu -->
	
	
	
	<tr>
                <td class="formulaire_libelle">Lieu</td>
	      <td align="left">
	      <select name="op_mots_lieu">
		<option value="and" selected="selected">Et</option>
		<option value="or">Ou</option>
		<option value="not">Sauf</option>
	      </select>
	      </td>
                <td align="left"><input name="lieu_mot" size="45" tabindex="1"/> </td>
	      <td align="left">
		      <a href="#" title="Afficher les index-expression des lieux" onClick="javascript:return afficheIndex('lieu','a','expression');">
		      <img src="icons/index.gif" border="0" width="29" height="20" align="absmiddle"/>
		      </a>
	       </td>
	</tr>
   
	<tr>
                 <td class="formulaire_libelle"></td>
	       <td valign="top">
		       
	       </td>
                 <td align="left">
		
		<xsl:call-template name="ecritchampcache">
			<xsl:with-param name="nomchamp">lieu</xsl:with-param>
			<xsl:with-param name="nb">5</xsl:with-param>
		</xsl:call-template>

		</td>
		 <td align="left"></td>		
	</tr>


	
	<!-- champ titre -->
	
	


	<tr>
                <td class="formulaire_libelle">Titre</td>
	      <td align="left">
	      <select name="op_mots_titre">
		<option value="and" selected="selected">Et</option>
		<option value="or">Ou</option>
		<option value="not">Sauf</option>
	      </select>
	      </td>
                <td align="left"><input name="titre" size="45" tabindex="1"/> </td>
	      <td align="left">
		      <a href="#" title="Afficher les index-mots du titre" onClick="javascript:return afficheIndex('titre','a','mot');">
		      <img src="icons/index.gif" border="0" width="29" height="20" align="absmiddle"/>
		      </a>
	       </td>
	</tr>

	<!-- descripteur -->
	
	
	
	<tr>
                <td class="formulaire_libelle">Descripteur(s) matière(s)</td>
	      <td align="left">
	      <select name="op_mots_descripteur">
		<option value="and" selected="selected">Et</option>
		<option value="or">Ou</option>
		<option value="not">Sauf</option>
	      </select>
	      </td>
                <td align="left">
		<a href="http://thesurb.documentation.equipement.gouv.fr">voir le thésaurus en ligne</a>
		<br/>
		<input name="descripteur_mot" size="45" tabindex="1"/> </td>
	      <td align="left">
		      <a href="#" title="Afficher les index-expression des descripteurs" onClick="javascript:return afficheIndex('descripteur','a','expression');">
		      <img src="icons/index.gif" border="0" width="29" height="20" align="absmiddle"/>
		      </a>
	       </td>
	</tr>
   
	<tr>
                 <td class="formulaire_libelle"></td>
	       <td valign="top">
		       
	       </td>
                 <td align="left">
		
		<xsl:call-template name="ecritchampcache">
			<xsl:with-param name="nomchamp">descripteur</xsl:with-param>
			<xsl:with-param name="nb">5</xsl:with-param>
		</xsl:call-template>

		</td>
		 <td align="left"></td>		
	</tr>
	
	<!-- descripteur anglais -->
	
	
	
	<tr>
                <td class="formulaire_libelle">Descripteur(s) anglai(s)</td>
	      <td align="left">
	      <select name="op_mots_descripteur_anglais">
		<option value="and" selected="selected">Et</option>
		<option value="or">Ou</option>
		<option value="not">Sauf</option>
	      </select>
	      </td>
                <td align="left">
		<a href="http://thesurb.documentation.equipement.gouv.fr/IndexEnglish.htm">voir le thésaurus en ligne</a>
			<br/>
			<input name="descripteur_anglais_mot" size="45" tabindex="1"/> 
	       </td>
	      <td align="left">
		     
			<a href="#" title="Afficher les index-expression des descripteurs anglais" onClick="javascript:return afficheIndex('descripteur_anglais','a','expression');">
		      <img src="icons/index.gif" border="0" width="29" height="20" align="absmiddle"/>
		      </a>
	       </td>
	</tr>
   
	<tr>
                 <td class="formulaire_libelle"></td>
	       <td valign="top">
		       
	       </td>
                 <td align="left">
		
		<xsl:call-template name="ecritchampcache">
			<xsl:with-param name="nomchamp">descripteur_anglais</xsl:with-param>
			<xsl:with-param name="nb">5</xsl:with-param>
		</xsl:call-template>

		</td>
		 <td align="left"></td>		
	</tr>
	
	      
	<!-- champ organisme 
	
	
	<xsl:call-template name="ecrit_operateur_champ">
			<xsl:with-param name="nomchamp">organisme</xsl:with-param>
	</xsl:call-template>
	
	<tr>
                <td class="formulaire_libelle">Organisme(s)</td>
	      <td align="left">
	      <select name="op_mots_organisme">
		<option value="and" selected="selected">Et</option>
		<option value="or">Ou</option>
		<option value="not">Sauf</option>
	      </select>
	      </td>
                <td align="left"><input name="organisme_mot" size="45" tabindex="1"/> </td>
	      <td align="left">
		      <a href="#" title="Afficher les index-expression des organismes" onClick="javascript:return afficheIndex('organisme','A','expression');">
		      <img src="icons/index.gif" border="0" width="29" height="20" align="absmiddle"/>
		      </a>
	       </td>
	</tr>
   
	<tr>
                 <td class="formulaire_libelle"></td>
	       <td valign="top">
		       
	       </td>
                 <td align="left">
		
		<xsl:call-template name="ecritchampcache">
			<xsl:with-param name="nomchamp">organisme</xsl:with-param>
			<xsl:with-param name="nb">5</xsl:with-param>
		</xsl:call-template>

		</td>
		 <td align="left"></td>		
	</tr>

	-->

	<!-- champ date 
	<tr>      
                <td class="formulaire_libelle">Année(s)</td>
	        <td>
		<select name="op_date">
			  <option value="equal" selected="selected">=</option>
			  <option value="supequal">&gt;=</option>
			  <option value="lessequal">&lt;=</option>
			  <option value="notequal">Sauf</option>
		</select>
	       </td>
                 <td align="left">
		<select name="date">
			<option value="" selected="selected">Toutes les années</option>
			<xsl:apply-templates select="document('annees.xml')/*/*"/>
		</select>
	      </td>
	       <td></td>
	</tr>
	-->
	
	<!-- champ theme 
	
	<xsl:call-template name="ecrit_operateur_champ">
			<xsl:with-param name="nomchamp">theme</xsl:with-param>
	</xsl:call-template>
	
	<tr>
                    <td class="formulaire_libelle">Thème(s)</td>
	          <td>
		<select name="op_mots_theme">
			<option value="and" selected="selected">Et</option>
			<option value="or">Ou</option>
			<option value="not">Sauf</option>
		</select>
		</td>
		<td align="left">
		      <select name="theme" onChange="javascript:selectionner('theme',this.options[this.selectedIndex].value);">
			<option value="" selected="selected">Sélectionner un ou plusieurs thème(s)</option>
			<xsl:apply-templates select="document('themes.xml')/*/*"/>
		      </select>
		</td>
	          <td></td>
	</tr>
	      
	<tr>
                 <td class="formulaire_libelle"></td>
	       <td>
	       </td>
	       <td align="left">
	       
		<xsl:call-template name="ecritchampcache">
			<xsl:with-param name="nomchamp">theme</xsl:with-param>
			<xsl:with-param name="nb">5</xsl:with-param>
		</xsl:call-template>

		</td>
		<td align="left"></td>		
	</tr>
	
	-->
	
	
	

	<!-- champ typedoc
	
	<xsl:call-template name="ecrit_operateur_champ">
			<xsl:with-param name="nomchamp">typedoc</xsl:with-param>
	</xsl:call-template>
	
	<tr>
                    <td class="formulaire_libelle">Type(s) de document</td>
	          <td>
		<select name="op_mots_typedoc">
			<option value="and" selected="selected">Et</option>
			<option value="or">Ou</option>
			<option value="not">Sauf</option>
		</select>
		</td>
		<td align="left">
		       <select name="typedoc" onChange="javascript:selectionner('typedoc',this.options[this.selectedIndex].value);">
			<option value="" selected="selected">Sélectionner un ou plusieurs types de document</option>
			<xsl:apply-templates select="document('typedocs.xml')/*/*"/>
		      </select>
		     
		</td>
	          <td></td>
	</tr>

	<tr>
                 <td class="formulaire_libelle"></td>
	       <td>
	       </td>
	       <td align="left">
	       
		<xsl:call-template name="ecritchampcache">
			<xsl:with-param name="nomchamp">typedoc</xsl:with-param>
			<xsl:with-param name="nb">5</xsl:with-param>
		</xsl:call-template>

		</td>
		<td align="left"></td>		
	</tr>
	
	
		-->


        </table>
	<blockquote> 
            <div align="center"> 
              <input type="submit" value="Rechercher" name="submit"/>
		      &#160;&#160;
		      <a href="#aide">
		      <img src="icons/info.gif" border="0" alt="Aide" width="23" height="36"/>
		      </a> 
            </div>
          </blockquote>
	
  </form>
  </xsl:template>
  
  
  <xsl:template match="recherchesimple">
     
    <a name="haut"/>
    <a href="recherche.xsp?type=avancee">Recherche avancée</a>
    <br/>
    <form name="recherche" action="results.xsp" method="get" onSubmit="javascript:return lanceRecherche();">
	    <input type="hidden" name="q"/>
	    <input type="hidden" name="log" value="true"/>
                 
     <table border="0" align="center" cellspacing="0" cellpadding="4" >
	      


	<!-- champ sujet -->
	
	<tr>
                <td class="formulaire_libelle">Sujet</td>
	      <td align="left">
	      <select name="op_mots_sujet" title="bonjour">
		<option value="and" selected="selected">Et</option>
		<option value="or">Ou</option>
		<option value="not">Sauf</option>
	      </select>
	      </td>
                <td align="left"><input name="sujet" size="45" tabindex="1"/> </td>
	      <td align="left">
		      <a href="#" title="Afficher les index-mots du sujet" onClick="javascript:return afficheIndex('sujet','a','mot');">
		      <img src="icons/index.gif" border="0" width="29" height="20" align="absmiddle"/>
		      </a>
	       </td>
	</tr>
	
	<!-- champ theme -->
	
	<tr>
                    <td class="formulaire_libelle">Thème(s)</td>
	          <td>
		<select name="op_mots_theme">
			<option value="and" selected="selected">Et</option>
			<option value="or">Ou</option>
			<option value="not">Sauf</option>
		</select>
		</td>
		<td align="left">
		      <select name="theme" onChange="javascript:selectionner('theme',this.options[this.selectedIndex].value);">
			<option value="" selected="selected">Sélectionner un ou plusieurs thème(s)</option>
			<xsl:apply-templates select="document('themes.xml')/*/*"/>
		      </select>
		</td>
	          <td></td>
	</tr>
	
	<tr>
                 <td class="formulaire_libelle"></td>
	       <td>
	       </td>
	       <td align="left">
	       
		<xsl:call-template name="ecritchampcache">
			<xsl:with-param name="nomchamp">theme</xsl:with-param>
			<xsl:with-param name="nb">5</xsl:with-param>
		</xsl:call-template>

		</td>
		<td align="left"></td>		
	</tr>


        </table>
	<blockquote> 
            <div align="center"> 
              <input type="submit" value="Rechercher" name="submit"/>
		      &#160;&#160;
		      <a href="#aide">
		      <img src="icons/info.gif" border="0" alt="Aide" width="23" height="36"/>
		      </a> 
            </div>
          </blockquote>
	
  </form>
  </xsl:template>
  
  <xsl:template match="aide">
  
	  <div align="center">
	  <br/><br/><br/><br/><br/>
	  </div>

	<div align="center">
	      <a name="aide"/>
	<h3>Aide à la recherche
		&#160;&#160;
		<a href="#haut">
			<img src="icons/haut.gif" width="16" height="13" border="0"/>
		</a>
	</h3>
	<p align="left">
	Pour effectuer une recherche, remplissez au minimum un des champs de recherche puis cliquez sur le bouton "rechercher".
	<br/>L'<a href="#booleen">opérateur booléen</a> entre les champs est ET. Si vous voulez combiner plusieurs recherches, utilisez la fonction <a href="historique.xsp">historique</a>.
	</p>
	
      <table border="1" cellpadding="3">
	
	<tr>
	<td width="150"><b>Champ</b>
	</td>
	<td width="450"><b>Signification</b>
	</td>
	</tr>
	
	<tr>
	<td class="formulaire_libelle">Sujet
	</td>
	<td width="450">Interrogation libre.
		<br/>Vous pouvez afficher tous les mots indexés en cliquant sur l'index symbolisé par la petite main verte : sélectionner le mot, puis refermer l'assistant.
		<br/>Vous pouvez également modifier l'<a href="#booleen">opérateur booléen</a> (ET par défaut). 
		
	</td>
	</tr>
	<tr>
	<td class="formulaire_libelle">Thème
	</td>
	<td width="450">
			Choisissez un thème parmi ceux proposés.
			<br/>Par défaut, tous les thèmes sont sélectionnés.
			<br/>A l'aide du menu déroulant, vous pouvez sélectionner un ou plusieurs thèmes, et les supprimer manuellement à l'aide de la croix.
			<br/>L'<a href="#booleen">opérateur booléen</a> entre les thèmes est ET.
	</td>
	</tr>
	<tr>
	<td class="formulaire_libelle">Titre
	</td>
	<td width="450">Vous pouvez saisir des mots du titre. L'opérateur booléen par défaut est le ET. 
		<br/>Exemple : <code>route bretagne</code> correspond à <code>route ET bretagne</code>
	</td>
	</tr>
      
      </table>
      
      <br/><br/>
      
      <table border="1" cellpadding="3" width="80%">
	
	<tr>
	<td colspan="3" align="center">
	<b>Troncature</b>
		&#160;&#160;
		<a href="#haut">
			<img src="icons/haut.gif" width="16" height="13" border="0"/>
		</a>
	</td>
	</tr>
	
	<tr>
	<td>
	<b>Code</b>
	</td>
	<td>
	<b>Signification</b>
	</td>
	<td>
	<b>Exemple</b>
	</td>
	</tr>
	
	<tr>
	<td align="center">
	?
	</td>
	<td>
	remplace 0 à 1 caractère
	</td>
	<td>
	<code>transport?</code> retournera les notices contenant "transport", "transports" ou "transporti".
	</td>
	</tr>
	
	<tr>
	<td align="center">
	*
	</td>
	<td>
	remplace 0 ou plusieurs caractères
	</td>
	<td>
	<code>transport*</code> retournera les notices contenant "transport", "transports", "transporti" mais aussi "transportation".
	</td>
	</tr>
	</table>
      
      <br/><br/>
      
      <table border="1" cellpadding="3" width="80%">
	<tr>
	<td colspan="3" align="center">
	<b><a name="booleen"/>Opérateurs booléens</b>
		&#160;&#160;
		<a href="#haut">
			<img src="icons/haut.gif" width="16" height="13" border="0"/>
		</a>
	</td>
	</tr>
	
	<tr>
	<td>
	<b>Code</b>
	</td>
	<td>
	<b>Signification</b>
	</td>
	<td>
	<b>Exemple</b>
	</td>
	</tr>
	
	
	<tr>
	<td align="center">
	Et
	</td>
	<td>
	les termes saisis sont présents en même temps
	</td>
	<td>
	<code>transport public</code> correspond à "transport" ET "public".
	</td>
	</tr>
	
	<tr>
	<td align="center">
	Ou
	</td>
	<td>
	l'un ou l'autre terme est présent
	</td>
	<td>
	<code>transport public</code> correspond à "transport" OU "public".
	</td>
	</tr>
	
	
	<tr>
	<td align="center">
	Sauf
	</td>
	<td>
	le premier terme est présent et non le second terme. 
	</td>
	<td>
	<code>transport public</code> correspond à "transport" SAUF "public".
	</td>
	</tr>
	</table>
      
      <br/><br/>
      
      <table border="1" cellpadding="3" width="80%">
	<tr>
	<td colspan="3" align="center">
	<b><a name="booleen"/>Expressions</b>
		&#160;&#160;
		<a href="#haut">
			<img src="icons/haut.gif" width="16" height="13" border="0"/>
		</a>
	</td>
	</tr>
	
	<tr>
	<td>
	<b>Code</b>
	</td>
	<td>
	<b>Signification</b>
	</td>
	<td>
	<b>Exemple</b>
	</td>
	</tr>
	
	
	<tr>
	<td align="center">
	""
	</td>
	<td>
	les termes saisis entre guillemets sont présents consécutivement
	</td>
	<td>
	<code>"transport public"</code> correspond à l'expression "transport public", et non à "transport" ET "public" qui est plus général.
	</td>
	</tr>
      
      </table>
          </div>
 </xsl:template>
  	
	
<xsl:template match="aidesimple">
	  <p>Aide simplifiée... à remplir</p>
	  
</xsl:template>

<xsl:template name="ecritchampcache">
	 <xsl:param name="nomchamp"/>
	 <xsl:param name="nb"/>
	 <xsl:if test="$nb>0">
	 	<xsl:call-template name="ecritchampcache">
			<xsl:with-param name="nomchamp" select="$nomchamp"/>
			<xsl:with-param name="nb" select="$nb - 1"/>
		</xsl:call-template>
		<div id="div{$nomchamp}{$nb}" style="display: none;">
			<input name="{$nomchamp}{$nb}" size="35" readonly="readonly"/> 
			<a href="#" title="Enlever ce champ de la recherche" onClick="javascript:return vide('{$nomchamp}{$nb}');">
			<img src="icons/picto_supprimer.gif" border="0" width="21" height="21" align="absmiddle"/>
			</a>
		</div>
	</xsl:if>
</xsl:template>	



<xsl:template name="ecrit_operateur_champ">
	<xsl:param name="nomchamp"/>
	<tr>
                <td colspan="2"/> 
	      <td align="center">
		<div id="div_op_champ_{$nomchamp}" style="display: visible;">
			<input type="radio" name="op_champ_{$nomchamp}" value="and" checked="checked"/>Et
			<input type="radio" name="op_champ_{$nomchamp}" value="or"/>Ou
			<input type="radio" name="op_champ_{$nomchamp}" value="not"/>Sauf
		</div>
	       </td>
	       <td/>
	</tr>
</xsl:template>

  
  
<xsl:template name="ecrit_operateur_mots">
	<xsl:param name="nomchamp"/>
	<select name="op_mots_{$nomchamp}">
		<option value="and" selected="selected">Et</option>
		<option value="or">Ou</option>
		<option value="not">Sauf</option>
	</select>
</xsl:template>

 <xsl:template match="item">
	    <option value="{.}"><xsl:value-of select="."/></option>
    </xsl:template>
    

</xsl:stylesheet>

```

</details>


---

### 📄 `admin/xsl/recherchelucene.xsl` [1.992 octets]
<a id="admin-xsl-recherchelucene-xsl"></a> [↩ Retour à l'arborescence](#tree-admin-xsl-recherchelucene-xsl)

> **Chemin relatif** : `admin/xsl/recherchelucene.xsl`  
> **Taille** : 1.992 octets  
> **Lignes** : 49  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet xmlns="http://www.w3.org/1999/xhtml" version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" exclude-result-prefixes="sdx">
    <xsl:import href="../../xsl/skin.xsl"/>
    <xsl:template match="recherchelucene">
        
	    <h4>Recherche en exécutant une requête interprétée directement par Lucene</h4>
	    <form name="recherche" action="../results.xsp" method="get">
		<input type="text" name="q" size="50" />
		<input type="hidden" name="log" value="true"/>
		&#160;
		<b><a href="#" title="afficher les options de recherche avancée pour ce champ" onclick="return afficheRechercheAvancee('q');">
                    options
		</a>
		</b>
		<br/>
		<input type="submit" value="Rechercher" name="submit"/>
	  </form>
    </xsl:template>
</xsl:stylesheet>

```


---

### 📄 `admin/xsl/skin.xsl` [16.016 octets]
<a id="admin-xsl-skin-xsl"></a> [↩ Retour à l'arborescence](#tree-admin-xsl-skin-xsl)

> **Chemin relatif** : `admin/xsl/skin.xsl`  
> **Taille** : 16.016 octets  
> **Lignes** : 349  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (349 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<o:stylesheet xmlns:o="http://www.w3.org/1999/XSL/Transform" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:xfm="http://www.w3.org/2002/01/xforms" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" version="1.0" sdx:copy="for namespace">
    <!-- parameter language to choose a message set -->
    <o:param name="lang-default" select="'fr'"/>
    <xsl:param name="lang" select="/sdx:document/@xml:lang"/>
    <!-- take set of language -->
    <o:variable name="messages" select="document('')/*/xfm:messages[substring($lang, 1, 2)=substring(@xml:lang, 1, 2)]"/>
    <!-- provide by request param, passed by sitemap -->
    <xsl:param name="app"/>
    <!-- (if not <map:parameter name="use-request-parameters" value="true"/>)
select="/sdx:document/sdx:parameters/sdx:parameter[@name='q']/@value" -->
    <!-- modèle racine de page HTML -->
    <xsl:template match="/">
        <xsl:apply-templates/>
    </xsl:template>
    <xsl:template match="*[@show='replace'][@actuate='onload']" mode="head">
        <meta http-equiv="refresh" content="{@time};URL={@href}"/>
    </xsl:template>
    <xsl:template match="sdx:document">
        <html>
            <head>
                <META HTTP-EQUIV="expires" CONTENT="Wed, 26 Feb 1997 08:21:57 GMT"/>
                <link rel="stylesheet" type="text/css" href="res/html.css"/>
                <link rel="stylesheet" type="text/css" href="res/xform.css"/>
                <link rel="stylesheet" type="text/css" href="res/sdx.css"/>
                <script type="text/javascript" src="res/selects.js">//</script>
                <xsl:call-template name="xfm:script"/>
                <xsl:apply-templates mode="head"/>
                <title>
                    <xsl:call-template name="title"/>
                </title>
            </head>
            <body>
                <xsl:attribute name="onload">
                    <xsl:apply-templates mode="onload"/>
                </xsl:attribute>
                <xsl:call-template name="page"/>
            </body>
        </html>
    </xsl:template>
    <xsl:template name="title">SDX</xsl:template>
    <xsl:template name="page" match="page">
        <p> </p>
        <!-- page -->
        <table width="80%" border="0" cellspacing="0" cellpadding="0" align="center">
            <tr>
                <td>
                    <!-- logo-cell -->
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" bgcolor="#000000">
                        <tr>
                            <td>
                                <table width="100%" border="0" cellspacing="1" cellpadding="20" align="center">
                                    <tr bgcolor="#FFFFFF">
                                        <td align="center">
                                            <a href="http://sdx.culture.fr/sdx/">
                                                <img src="res/sdx.gif" width="200" height="60" border="0"/>
                                            </a>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                    <!-- /logo-cell -->
                    <!-- bar-cell -->
                    <xsl:call-template name="bar"/>
                    <!-- /bar-cell -->
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" bgcolor="#000000">
                        <tr>
                            <td>
                                <table width="100%" border="0" cellspacing="1" cellpadding="20" align="center">
                                    <!-- body-cell -->
                                    <tr bgcolor="#FFFFFF">
                                        <td>
                                            <xsl:apply-templates select="*"/>
                                        </td>
                                    </tr>
                                    <!-- /body-cell -->
                                    <!-- bottom-cell -->
                                    <tr bgcolor="#FFFFFF">
                                        <td align="center">
                                            <small>
                                                <xsl:call-template name="sdx:user"/>
                                            </small>
                                        </td>
                                    </tr>
                                    <!-- /bottom-cell -->
                                </table>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
        <!-- /page -->
        <p> </p>
        <div>
            <small>SDX - version:<xsl:value-of select="/sdx:document/@version"/>, 
                build:<xsl:value-of select="/sdx:document/@build"/>.
            </small>
        </div>
    </xsl:template>
    <!-- display user -->
    <xsl:template name="sdx:user">
        <xsl:for-each select="/sdx:document/sdx:user">
            <xsl:value-of select="@firstname"/> <xsl:value-of select="@lastname"/>
          <xsl:if test="@id">(<xsl:value-of select="@id"/>), </xsl:if>
            <o:apply-templates select="($messages/xfm:caption[@id=&#34;login-as&#34;] )[1]"/>
            <xsl:choose>
                <xsl:when test="@anonymous">
                    <o:apply-templates select="($messages/xfm:caption[@id=&#34;anonymous&#34;] )[1]"/>
                </xsl:when>
                <xsl:when test="@superuser='true'">
                    <o:apply-templates select="($messages/xfm:caption[@id=&#34;su&#34;] )[1]"/>
                </xsl:when>
                <xsl:when test="@admin='true'">
                    <o:apply-templates select="($messages/xfm:caption[@id=&#34;admin-app&#34;] )[1]"/>
                    <xsl:value-of select="@app"/>
                </xsl:when>
                <xsl:when test="@app">
                    <o:apply-templates select="($messages/xfm:caption[@id=&#34;user-app&#34;] )[1]"/>
                    <xsl:value-of select="@app"/>
                </xsl:when>
            </xsl:choose>
            <xsl:text>. </xsl:text>
        </xsl:for-each>
    </xsl:template>
    <!-- links 
                td.klink {	font-weight: bold; color: #FFFFFF; background:#6287C4; cursor:pointer}
                a.klink {display:block; color:White; padding:5; text-decoration: none;}
                a.klink:hover { background-color: #FF3300; color:White}
                a.klink:visited {color:White}
            <table border="0" cellspacing="0" cellpadding="0" align="center">
                <tr bgcolor="#000000">
                    <td>
                        <table border="0" cellspacing="1" cellpadding="0">
                            <tr>
                                <td nowrap="nowrap" class="klink" bgcolor="White">
                                    <a class="klink"  href="login.sp?app={$app}&amp;lang={$lang}">&#160;<xfm:caption id="login"/>&#160;</a>
                                </td>
                                <td nowrap="nowrap" class="klink" bgcolor="White">
                                    <a class="klink" href="users.xsp?app={$app}&amp;lang={$lang}">&#160;<xfm:caption id="users"/>&#160;</a>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
            -->
    <!-- BAR -->
    <xsl:template name="bar">
        <xsl:for-each select="//bar[1]">
            <table class="sdx_bar" border="0" cellspacing="0" cellpadding="0" align="center" width="100%">
                <form action="{/sdx:document/@uri}" method="get">
                    <tr>
                        <td valign="top">
                            <input type="hidden" name="app" value="{$app}"/>
                            <xsl:apply-templates select="button"/>
                        </td>
                        <td align="right" class="sdx_bar" nowrap="nowrap">
                            <xsl:call-template name="langs"/>
                            <o:apply-templates select="$messages/xfm:help[@id=&#34;bar&#34;][1]"/>
                        </td>
                    </tr>
                </form>
            </table>
        </xsl:for-each>
    </xsl:template>
    <xsl:template match="button">
        <input type="submit" onclick="this.form.action='{@href}'" title="{$messages/xfm:hint[@id=current()/@id]}" value="{$messages/xfm:caption[@id=current()/@id]}">
            <xsl:attribute name="style">
                <xsl:text>cursor:pointer; </xsl:text>
                <xsl:if test="boolean(@self)">border:inset 2; </xsl:if>
            </xsl:attribute>
        </input>
        <xsl:apply-templates select="parameter"/>
    </xsl:template>
    <xsl:template match="parameter">
        <input type="hidden" name="{@name}" value="{@value}"/>
    </xsl:template>
    <xsl:template name="langs">
        <!-- langs available -->
        <span style="white-space:nowrap">
            <xsl:text> </xsl:text>
            <o:apply-templates select="($messages/xfm:caption[@id=&#34;lang&#34;] )[1]"/>
            <xsl:text> </xsl:text>
            <select onchange="this.form.submit()" type="text" onblur="if (window.xfm_blur) xfm_blur(this);" onfocus="if (window.xfm_focus) xfm_focus(this);" class="xfm_selectOne" name="lang">
                <o:variable name="xfm:ad0e292" select="substring($lang, 1, 2)"/>
                <o:for-each select="document('messages.langs')/*/xfm:messages">
                    <o:sort select="@xml:lang"/>
                    <option value="{substring(@xml:lang,1,2)}">
                        <o:if test="$xfm:ad0e292=normalize-space(substring(@xml:lang,1,2))">
                            <o:attribute name="selected">selected</o:attribute>
                        </o:if>
                        <o:value-of select="@xml:lang"/>
                    </option>
                </o:for-each>
            </select>
        </span>
    </xsl:template>
    <xsl:template match="superuser-not-set">
        <p>
            <o:apply-templates select="($messages/xfm:caption[@id=&#34;superuser-not-set&#34;] )[1]"/>
        </p>
        <br/>
    </xsl:template>
    <!-- ======== STRUCTURE ========== -->
    <!--
    <xsl:template match="*|text()" mode="onload"/>
    <xsl:template match="sdx:*"/>
    <xsl:template match="*" priority="-1">
        <xsl:element name="{name()}">
            <xsl:copy-of select="@*"/>
            <xsl:apply-templates select="comment()|text()| node()"/>
        </xsl:element>
    </xsl:template>
    <xsl:template match="text()|processing-instruction()|comment()" priority="-1">
        <xsl:copy>
            <xsl:apply-templates select="*|text()|processing-instruction()|comment()"/>
        </xsl:copy>
    </xsl:template>
-->
    <!-- Les autres éléments SDX ne sont pas sortis -->
    <xsl:template match="sdx:*"/>
    <xsl:template match="*"/>
    <xsl:template match="node()" mode="onload"/>
    <xsl:template match="node()" mode="head"/>
    <!-- ====== SCRIPT ====================== -->
    <o:template name="xfm:script">
        <script type="text/javascript" language="javascript">
    
    function xfm_blur(o)
    {
        if (!o.className) return true;
        o.className=o.className.replace(/ ?xfm_focus/gi, ''); 
        return true;
    }

    function xfm_focus(o) 
    {
        document.xfm_last = o;
        if (!o.className) return true;
        o.className=o.className + ' xfm_focus'; 
        return true;
    }
    

            function xfm_load()
            {
                
                return true;
            }

            function xfm_badControl(form, name)
            {
                if (!form || !name) return false;
                if(form[name])
                {
                    // if (form[name].selectedIndex &amp;&amp; form[name].selectedIndex == -1) return true;
                    if (!form[name].value) return true;
                }
                return false;
            }

            
            function xfm_submit(form)
            {
                var message="";
                var name="";
                
                if (!message) return true ;
                alert(message);
                return false;
            }
            
            function xfm_reset(form)
            {
            
            }

                </script>
    </o:template>
    <!-- ======  COMMON TEMPLATES  ====================== 
        short templates to format messages
        known issues : no correct id for a repeated help button 
        then hide/show message can't work
        but is it useful to repeat the same help ?
        
-->
    <o:template match="xfm:help">
        <o:param name="id" select="@id"/>
        <input type="button" class="xfm_help" tabindex="32767" value="?">
            <o:attribute name="onclick">if(document.getElementById) var o=document.getElementById('<o:value-of select="$id"/>_help'); if (o!=null) o.style.display=(o.style.display=='none')?'':'none'; </o:attribute>
        </input>
        <table cellpadding="1" cellspacing="0" border="0" class="xfm_help" style="display:none;">
            <o:attribute name="id">
                <o:value-of select="$id"/>_help</o:attribute>
            <tr>
                <td width="90%" class="xfm_bar">
                    <o:value-of select="(caption | title | h1 )[1]"/>
                </td>
                <td align="right" class="xfm_bar">
                    <input type="button" class="xfm_key" value="X">
                        <o:attribute name="onclick">if(document.getElementById) var o=document.getElementById('<o:value-of select="$id"/>_help'); if (o!=null) o.style.display=(o.style.display=='none')?'':'none'; </o:attribute>
                    </input>
                </td>
            </tr>
            <tr>
                <td colspan="2" class="xfm_text">
                    <o:apply-templates mode="copy"/>
                </td>
            </tr>
        </table>
    </o:template>
    <o:template match="xfm:caption" priority="-1">
        <o:apply-templates mode="copy"/>
    </o:template>
    <!--
        Escape js string (or other search/replace)-->
    <o:template match="* | @* | text()" mode="replace" name="xfm:replace">
        <o:param name="string" select="normalize-space(.)"/>
        <o:param name="search">'</o:param>
        <o:param name="replace">\'</o:param>
        <o:choose>
            <o:when test="contains($string, $search)">
                <o:value-of select="concat(substring-before($string, $search), $replace)"/>
                <o:call-template name="xfm:replace">
                    <o:with-param name="string" select="substring-after($string, $search)"/>
                    <o:with-param name="search" select="$search"/>
                    <o:with-param name="replace" select="$replace"/>
                </o:call-template>
            </o:when>
            <o:otherwise>
                <o:value-of select="$string"/>
            </o:otherwise>
        </o:choose>
    </o:template>
    <o:template match="*" priority="-1" mode="copy">
        <o:element name="{name()}">
            <o:apply-templates select="@*" mode="copy"/>
            <o:apply-templates mode="copy"/>
        </o:element>
    </o:template>
    <o:template match="@*" mode="copy">
        <o:copy/>
    </o:template>
    <o:template match="node()" mode="onload" priority="-2"/>
</o:stylesheet>

```

</details>


---

### 📄 `admin/xsl/suppqid.xsl` [1.909 octets]
<a id="admin-xsl-suppqid-xsl"></a> [↩ Retour à l'arborescence](#tree-admin-xsl-suppqid-xsl)

> **Chemin relatif** : `admin/xsl/suppqid.xsl`  
> **Taille** : 1.909 octets  
> **Lignes** : 49  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet xmlns="http://www.w3.org/1999/xhtml" version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" exclude-result-prefixes="sdx">
    <xsl:import href="../../xsl/skin.xsl"/>
     <xsl:template match="retour">
            <p><a href="suppression.xsp">Retour page de suppression</a></p>
    </xsl:template>

     <xsl:template match="sdx:deletions">
            <xsl:if test="sdx:deletion">
		<br/>
	     <br/>Suppression document  id=<b><xsl:value-of select="sdx:deletion/@id"/></b>, base=<xsl:value-of select="@base"/>, app=<xsl:value-of select="@app"/>
	</xsl:if>
	<xsl:if test="sdx:exception">
	     <br/><xsl:apply-templates/>
	</xsl:if>
    </xsl:template>
    

</xsl:stylesheet>

```


---

### 📄 `admin/xsl/suppression.xsl` [6.476 octets]
<a id="admin-xsl-suppression-xsl"></a> [↩ Retour à l'arborescence](#tree-admin-xsl-suppression-xsl)

> **Chemin relatif** : `admin/xsl/suppression.xsl`  
> **Taille** : 6.476 octets  
> **Lignes** : 180  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (180 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet xmlns="http://www.w3.org/1999/xhtml" version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" exclude-result-prefixes="sdx">
    <xsl:import href="../../xsl/skin.xsl"/>

	<xsl:template match="sdx:results">
		<h1>Notices à supprimer</h1>
		<xsl:if test="(@nb='0')">
			<p>Aucune notice n'a été trouvée</p>
		</xsl:if>

	<xsl:if test="not(@nb='0')">
		<table cloass="basket" cellpadding="3" cellspacing="0">
			<tr>
				<td>
					<a href="suppqid.xsp?qid={@qid}">Supprimer définitivement les notices</a>
				</td>
			</tr>
		</table>

		<table width="100%" cellpadding="0" cellspacing="0" border="0">
			<tr>
				<td class="highlight">
					<div>
						<xsl:apply-templates select="." mode="sdx:head">
							<xsl:with-param name="bqidParam" select="'bqid'"/>
						</xsl:apply-templates>
					</div>
				</td>
			</tr>
				<form action="../ajoutepanier.xsp" id="ajoutpanier" method="get">
					<xsl:apply-templates>
						<xsl:with-param name="action" select="'../document.xsp'"/>
					</xsl:apply-templates>
				</form>
			</table>
			<br/>
			<div class="highlight">
				<!--<xsl:apply-templates select="." mode="sdx:foot"/>-->
				<!--
				<xsl:apply-templates select="." mode="sdx:head">
					<xsl:with-param name="bqidParam" select="'bqid'"/>
				</xsl:apply-templates>
				-->
			</div>
		</xsl:if>
	</xsl:template>
    
	<xsl:template match="sdx:result">
		<tr>
			<td>
				<xsl:text>&#160;</xsl:text>
				<xsl:value-of select="@no"/>
			</td>
			<td>
				<xsl:text>&#160;</xsl:text>
				<xsl:value-of select="sdx:field[@name='id']"/>
			</td>
			<td>
			</td>
			<td>
				<xsl:if test="sdx:field[@name='TI']">
					<xsl:for-each select="sdx:field[@name='TI']">
						<xsl:variable name="doc"><xsl:value-of select="translate(normalize-space(.),' ','_')"/></xsl:variable>
						<xsl:variable name="rep">
							<xsl:text>documents/</xsl:text>
							<xsl:if test="contains($doc,'_')">
								<xsl:value-of select="substring-before(normalize-space($doc),'_')"/>
							</xsl:if>
							<xsl:if test="not(contains($doc,'_'))">
								<xsl:value-of select="substring-before(normalize-space($doc),'.')"/>
							</xsl:if>
							<xsl:text>/</xsl:text>
						</xsl:variable>
						<xsl:variable name="extension"><xsl:value-of select="substring-after(normalize-space($doc),'.')"/></xsl:variable>
						<xsl:choose>
							<xsl:when test="$extension='pdf' or $extension='PDF'">
								<a href="{$rep}{$doc}" class="img_link pdf_link">
									<xsl:call-template name="popup-window">
										<xsl:with-param name="link_text">
											<xsl:value-of select="substring(../sdx:field[@name='titre'],0,50)"/>
											<xsl:if test="string-length(../sdx:field[@name='titre']) &gt; 50">
												<xsl:text>...</xsl:text>
											</xsl:if>
											<xsl:text> - PDF</xsl:text>
										</xsl:with-param>
									</xsl:call-template>
									<xsl:value-of select="$serverURI" />
									<xsl:value-of select="substring-after($rep,'..')" /><xsl:value-of select="$doc" />
								</a>
							</xsl:when>
							<xsl:when test="$extension='htm' or $extension='HTM' or $extension='html' or $extension='HTML'">
								<a href="{$rep}{$doc}" class="img_link html_link">
									<xsl:call-template name="popup-window">
										<xsl:with-param name="link_text">
											<xsl:value-of select="substring(../sdx:field[@name='titre'],0,50)"/>
											<xsl:if test="string-length(../sdx:field[@name='titre']) &gt; 50">
												<xsl:text>...</xsl:text>
											</xsl:if>
											<xsl:text> - HTML</xsl:text>
										</xsl:with-param>
									</xsl:call-template>
									<xsl:value-of select="$serverURI" />
									<xsl:value-of select="substring-after($rep,'..')" /><xsl:value-of select="$doc" />
								</a>
							</xsl:when>
					<xsl:otherwise>
						<a href="{$rep}{$doc}" class="img_link txt_link">
							<xsl:call-template name="popup-window">
								<xsl:with-param name="link_text">
									<xsl:value-of select="substring(../sdx:field[@name='titre'],0,50)"/>
									<xsl:if test="string-length(../sdx:field[@name='titre']) &gt; 50">
										<xsl:text>...</xsl:text>
									</xsl:if>
									<xsl:text> - TXT</xsl:text>
								</xsl:with-param>
							</xsl:call-template>
							<xsl:value-of select="$serverURI" />
							<xsl:value-of select="substring-after($rep,'..')" /><xsl:value-of select="$doc" />
						</a>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:for-each>
		</xsl:if>
	</td>
       
	    <td>
	    <a href="../document.xsp?app={sdx:field[@name='sdxappid']}&amp;base={sdx:field[@name='sdxdbid']}&amp;id={sdx:field[@name='sdxdocid']}&amp;qid={../@id}&amp;n={@no}&amp;q={/sdx:document/sdx:parameters/sdx:parameter[@name='q']/@value}">
            	<xsl:value-of select="sdx:field[@name='titre']"/>
	   </a>
	    </td>
	    <td>
	    	<xsl:for-each select="sdx:field[@name='auteur']">
			<xsl:value-of select="."/>
			<xsl:if test="position()!=last()"><br/></xsl:if>
		</xsl:for-each>
	    </td>
	     <td align="center">
	
		<xsl:variable name="date"><xsl:value-of select="sdx:field[@name='date']"/></xsl:variable>
		<xsl:value-of select="substring($date,0,5)"/>
    	
	    </td>
	     
	    
	 
	</tr>
    </xsl:template>

    <xsl:template match="sdx:field"/>
</xsl:stylesheet>

```

</details>


---

### 📄 `admin/xsl/upload.xsl` [5.123 octets]
<a id="admin-xsl-upload-xsl"></a> [↩ Retour à l'arborescence](#tree-admin-xsl-upload-xsl)

> **Chemin relatif** : `admin/xsl/upload.xsl`  
> **Taille** : 5.123 octets  
> **Lignes** : 169  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (169 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet xmlns="http://www.w3.org/1999/xhtml" version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" exclude-result-prefixes="sdx">
	<xsl:import href="../../sdxlib/xsl/skin.xsl"/>
	<xsl:template match="sdx:uploadDocuments">
		<p class="right"><a href="admin.xsp">Retour page admin</a></p>
		<h1>
			<xsl:text>Import de document</xsl:text>
			<xsl:if test="number(sdx:summary/@additions) &gt; 1">s</xsl:if>
		</h1>
		<xsl:apply-templates select="sdx:summary"/>
		<ul>
			<xsl:apply-templates select="sdx:uploadDocument"/>
		</ul>
	</xsl:template>
    
	<xsl:template match="sdx:uploadDocument">
		<li>
			<strong>
				<xsl:value-of select="@id"/>
			</strong>
			<xsl:text> indexé. </xsl:text>
		</li>
		<xsl:if test="/sdx:document/sdx:parameters/sdx:parameter[@name='url']">
			<iframe width="100%" height="200" src="{/sdx:document/sdx:parameters/sdx:parameter[@name='url']/@value}" title="Un nouveau document cherchable"/>
		</xsl:if>
	</xsl:template>
    
	<xsl:template match="sdx:uploadDocument[sdx:exception]">
		<li>
			<strong>
				<xsl:value-of select="@id"/>
			</strong>
			<xsl:text> erreur. </xsl:text>
			<xsl:apply-templates select="sdx:exception/sdx:message"/>
		</li>
	</xsl:template>
    
	<xsl:template match="sdx:summary">
		<div>
			<xsl:apply-templates select="@*"/>
		</div>
	</xsl:template>
	
	<xsl:template match="@additions">
		<xsl:if test="number(.) &gt; 0">
			<xsl:value-of select="."/>
			<xsl:text> document</xsl:text>
			<xsl:if test="number(.) &gt; 1">s</xsl:if>
			<xsl:text> ajouté</xsl:text>
			<xsl:if test="number(.) &gt; 1">s</xsl:if>
			<xsl:text>, </xsl:text>
		</xsl:if>
	</xsl:template>
	
	<xsl:template match="@failures">
		<xsl:if test="number(.) &gt; 0">
			<xsl:value-of select="."/>
			<xsl:text> échec</xsl:text>
			<xsl:if test="number(.) &gt; 1">s</xsl:if>
			<xsl:text>, </xsl:text>
		</xsl:if>
	</xsl:template>
    
	<xsl:template match="@replacements">
		<xsl:value-of select="."/>
		<xsl:text> document</xsl:text>
		<xsl:if test="number(.) &gt; 1">s</xsl:if>
		<xsl:text> remplacé</xsl:text>
		<xsl:if test="number(.) &gt; 1">s</xsl:if>
	</xsl:template>
	
	<xsl:template match="@duration"> (<xsl:value-of select="."/> secondes).</xsl:template>
    
	<xsl:template match="sdx:uploadDocument/sdx:exception">
		<h2>Erreur</h2>
		<xsl:apply-templates/>
	</xsl:template>
	
	<xsl:template match="sdx:uploadDocument/sdx:exception/sdx:message">
		<small>
			<xsl:apply-templates/>
		</small>
	</xsl:template>
	
	<xsl:template match="sdx:results">
		<div style="font-family:sans-serif">
			<strong>Champs indexés</strong>
			<xsl:apply-templates select="sdx:result"/>
		</div>
	</xsl:template>
    
	<xsl:template match="sdx:result">
		<xsl:apply-templates select="sdx:field">
			<xsl:sort select="@name"/>
			<xsl:sort select="@value"/>
		</xsl:apply-templates>
	</xsl:template>
	
	<!-- sdx:field -->
	<xsl:template match="sdx:field">
		<div>
			<span class="sdx_field-name" style="font-weight:bold">
				<xsl:value-of select="@name"/>
			</span>
			<xsl:text>:"</xsl:text>
			<span class="sdx_field-value">
				<xsl:value-of select="@value"/>
			</span>
			<xsl:text>"</xsl:text>
		</div>
	</xsl:template>
	
	<xsl:template match="sdx:field[@name='lien']">
		<div>
			<a href="{normalize-space(.)}">
				<xsl:value-of select="."/>
			</a>
		</div>
	</xsl:template>
    
	<!-- url d'image -->
	<xsl:template match="sdx:field[@name='image']">
		<img src="{.}"/>
	</xsl:template>
	
	<xsl:template match="sdx:terms">
		<div>
			<strong>Termes indexés</strong>
		</div>
		<small>
			<xsl:apply-templates select="sdx:term"/>
		</small>
	</xsl:template>
	
	<xsl:template match="sdx:term">
		<xsl:value-of select="@value"/>
		<xsl:text>&#32;</xsl:text>
	</xsl:template>
</xsl:stylesheet>

```

</details>


---

### 📄 `conf/application.xconf` [35.696 octets]
<a id="conf-application-xconf"></a> [↩ Retour à l'arborescence](#tree-conf-application-xconf)

> **Chemin relatif** : `conf/application.xconf`  
> **Taille** : 35.696 octets  
> **Lignes** : 688  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (688 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<sdx:application xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" id="fr.gouv.equipement.documentation.balise" xml:lang="fr-FR" xmlns="http://www.culture.gouv.fr/ns/sdx/sdx">
    <sdx:userDocumentBase>
        <sdx:repositories>
            <sdx:repository id="users" type="FS" baseDirectory="users/xml" depth="0" extent="1000"/>
        </sdx:repositories>
        <sdx:fieldList xml:lang="fr-FR" variant="">
            <sdx:field name="name" type="field" brief="true"/>
            <sdx:field name="firstname" type="field" brief="true"/>
            <sdx:field name="lastname" type="field" brief="true"/>
            <sdx:field name="description" type="eord"/>
            <sdx:field name="lang" type="field" brief="true"/>
            <sdx:field name="variant" type="field" brief="true"/>
            <sdx:field name="email" type="field" brief="true"/>
            <sdx:field name="content" type="word" default="true">
                <sdx:name xml:lang="fr-FR">Texte intégral</sdx:name>
            </sdx:field>
        </sdx:fieldList>
        <sdx:index>
            <sdx:pipeline>
                <sdx:transformation id="step1" type="XSLT" src="/sdx/resources/indexation/index-identity.xsl"/>
            </sdx:pipeline>
        </sdx:index>
    </sdx:userDocumentBase>
    <sdx:admin groupId="admins" userId="pandoc" userPassword="pan2oc"/>
    <sdx:database type="MYSQL" dsi="balise"/>
      <sdx:documentBases>

	<sdx:documentBase xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" xmlns:notix="http://portail.documentation.equipement.gouv.fr/ns/notix" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dcq="http://purl.org/dc/terms/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#" xmlns:rng="http://relaxng.org/ns/structure/1.0" xmlns:xf="http://www.w3.org/2002/xforms" id="balise" name="Base balise" type="lucene" default="true" keepOriginalDocuments="true">
	  <sdx:queryParser class="fr.gouv.culture.sdx.search.lucene.queryparser.DefaultQueryParser"/>
	  <sdx:repositories>
	    <sdx:repository id="baliserep" type="MYSQL" dsi="balise"/>
	  </sdx:repositories>
	  <sdx:fieldList xml:lang="fr-FR" variant="" analyzerConf="/sdx/resources/conf/analysis/fr.xml">
	    <sdx:field name="id" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">id</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET-DOCUMENT-content_word" type="word" brief="true">
	      <sdx:name xml:lang="fr-FR">Objet et contenu des documents (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET-DOCUMENT-content_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Objet et contenu des documents (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="TYPE_TEXTE_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Type de texte</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Objet du document</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Objet du document (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET_word" type="word">
	      <sdx:name xml:lang="fr-FR">Objet du document (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Objet du document (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DATE_date" type="date" brief="true">
	      <sdx:name xml:lang="fr-FR">Date du document</sdx:name>
	    </sdx:field>
	    <sdx:field name="ETAT_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Etat</sdx:name>
	    </sdx:field>
	    <sdx:field name="ETAT_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Etat (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="REMPLACE_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Remplace</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOMAINE_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Domaine</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOMAINE_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Domaine (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="PUB_ACTUS_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Publication actualités</sdx:name>
	    </sdx:field>
	    <sdx:field name="PUB_ACTUS_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Publication actualités (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="SUJET_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Sujet</sdx:name>
	    </sdx:field>
	    <sdx:field name="SUJET_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Sujet (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBSERVATION_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Observation</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBSERVATION_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Observation (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBSERVATION_word" type="word">
	      <sdx:name xml:lang="fr-FR">Observation (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBSERVATION_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Observation (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DESCRIPTION_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Description</sdx:name>
	    </sdx:field>
	    <sdx:field name="DESCRIPTION_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Description (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DESCRIPTION_word" type="word">
	      <sdx:name xml:lang="fr-FR">Description (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DESCRIPTION_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Description (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="REFERENCE_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Référence</sdx:name>
	    </sdx:field>
	    <sdx:field name="REFERENCE_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Référence (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="REFERENCE_word" type="word">
	      <sdx:name xml:lang="fr-FR">Référence (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="REFERENCE_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Référence (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="APPAREILS_RM_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Appareils RM</sdx:name>
	    </sdx:field>
	    <sdx:field name="APPAREILS_RM_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Appareils RM (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="APPAREILS_TG_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Appareils TG</sdx:name>
	    </sdx:field>
	    <sdx:field name="APPAREILS_TG_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Appareils TG (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="VEHICULES_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Véhicules</sdx:name>
	    </sdx:field>
	    <sdx:field name="VEHICULES_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Véhicules (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="CONSTRUCTEURS_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Constructeurs</sdx:name>
	    </sdx:field>
	    <sdx:field name="CONSTRUCTEURS_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Constructeurs (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DIFFUSION_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Diffusion</sdx:name>
	    </sdx:field>
	    <sdx:field name="DIFFUSION_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Diffusion (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOCUMENT_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Document attaché</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOCUMENT_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Document attaché (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOCUMENT-content_word" type="word">
	      <sdx:name xml:lang="fr-FR">Document attaché (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOCUMENT-content_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Document attaché (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="UTIL_CREAT_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Saisie par</sdx:name>
	    </sdx:field>
	    <sdx:field name="DATE_CREAT_date" type="date" brief="true">
	      <sdx:name xml:lang="fr-FR">Saisie le</sdx:name>
	    </sdx:field>
	    <sdx:field name="UTIL_MAJ_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Modifiée par</sdx:name>
	    </sdx:field>
	    <sdx:field name="DATE_MAJ_date" type="date" brief="true">
	      <sdx:name xml:lang="fr-FR">Modifiée le</sdx:name>
	    </sdx:field>
	  </sdx:fieldList>
	  <sdx:index>
	    <sdx:pipeline>
	      <sdx:transformation id="index-balise" type="XSLT" src="index-balise.xsl"/>
	    </sdx:pipeline>
	  </sdx:index>
	</sdx:documentBase>

	<sdx:documentBase xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" xmlns:notix="http://portail.documentation.equipement.gouv.fr/ns/notix" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dcq="http://purl.org/dc/terms/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#" xmlns:rng="http://relaxng.org/ns/structure/1.0" xmlns:xf="http://www.w3.org/2002/xforms" id="balise_public" name="Base balise publique" type="lucene" default="true" keepOriginalDocuments="true">
	  <sdx:queryParser class="fr.gouv.culture.sdx.search.lucene.queryparser.DefaultQueryParser"/>
	  <sdx:repositories>
	    <sdx:repository id="balise_publicrep" type="MYSQL" dsi="balise"/>
	  </sdx:repositories>
	  <sdx:fieldList xml:lang="fr-FR" variant="" analyzerConf="/sdx/resources/conf/analysis/fr.xml">
	    <sdx:field name="id" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">id</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET-DOCUMENT-content_word" type="word" brief="true">
	      <sdx:name xml:lang="fr-FR">Objet et contenu des documents (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET-DOCUMENT-content_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Objet et contenu des documents (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="TYPE_TEXTE_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Type de texte</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Objet du document</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Objet du document (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET_word" type="word">
	      <sdx:name xml:lang="fr-FR">Objet du document (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Objet du document (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DATE_date" type="date" brief="true">
	      <sdx:name xml:lang="fr-FR">Date du document</sdx:name>
	    </sdx:field>
	    <sdx:field name="ETAT_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Etat</sdx:name>
	    </sdx:field>
	    <sdx:field name="ETAT_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Etat (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="REMPLACE_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Remplace</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOMAINE_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Domaine</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOMAINE_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Domaine (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="PUB_ACTUS_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Publication actualités</sdx:name>
	    </sdx:field>
	    <sdx:field name="PUB_ACTUS_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Publication actualités (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="SUJET_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Sujet</sdx:name>
	    </sdx:field>
	    <sdx:field name="SUJET_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Sujet (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBSERVATION_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Observation</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBSERVATION_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Observation (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBSERVATION_word" type="word">
	      <sdx:name xml:lang="fr-FR">Observation (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBSERVATION_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Observation (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DESCRIPTION_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Description</sdx:name>
	    </sdx:field>
	    <sdx:field name="DESCRIPTION_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Description (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DESCRIPTION_word" type="word">
	      <sdx:name xml:lang="fr-FR">Description (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DESCRIPTION_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Description (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="REFERENCE_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Référence</sdx:name>
	    </sdx:field>
	    <sdx:field name="REFERENCE_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Référence (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="REFERENCE_word" type="word">
	      <sdx:name xml:lang="fr-FR">Référence (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="REFERENCE_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Référence (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="APPAREILS_RM_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Appareils RM</sdx:name>
	    </sdx:field>
	    <sdx:field name="APPAREILS_RM_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Appareils RM (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="APPAREILS_TG_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Appareils TG</sdx:name>
	    </sdx:field>
	    <sdx:field name="APPAREILS_TG_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Appareils TG (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="VEHICULES_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Véhicules</sdx:name>
	    </sdx:field>
	    <sdx:field name="VEHICULES_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Véhicules (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="CONSTRUCTEURS_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Constructeurs</sdx:name>
	    </sdx:field>
	    <sdx:field name="CONSTRUCTEURS_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Constructeurs (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DIFFUSION_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Diffusion</sdx:name>
	    </sdx:field>
	    <sdx:field name="DIFFUSION_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Diffusion (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOCUMENT_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Document attaché</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOCUMENT_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Document attaché (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOCUMENT-content_word" type="word">
	      <sdx:name xml:lang="fr-FR">Document attaché (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOCUMENT-content_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Document attaché (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="UTIL_CREAT_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Saisie par</sdx:name>
	    </sdx:field>
	    <sdx:field name="DATE_CREAT_date" type="date" brief="true">
	      <sdx:name xml:lang="fr-FR">Saisie le</sdx:name>
	    </sdx:field>
	    <sdx:field name="UTIL_MAJ_field" type="date" brief="true">
	      <sdx:name xml:lang="fr-FR">Modifiée par</sdx:name>
	    </sdx:field>
	    <sdx:field name="DATE_MAJ_date" type="date" brief="true">
	      <sdx:name xml:lang="fr-FR">Modifiée le</sdx:name>
	    </sdx:field>
	  </sdx:fieldList>
	  <sdx:index>
	    <sdx:pipeline>
	      <sdx:transformation id="index-balise_public" type="XSLT" src="index-balise.xsl"/>
	    </sdx:pipeline>
	  </sdx:index>
	</sdx:documentBase>


	<sdx:documentBase xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" xmlns:notix="http://portail.documentation.equipement.gouv.fr/ns/notix" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dcq="http://purl.org/dc/terms/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#" xmlns:rng="http://relaxng.org/ns/structure/1.0" xmlns:xf="http://www.w3.org/2002/xforms" id="balise_pro" name="Base balise pro" type="lucene" default="true" keepOriginalDocuments="true">
	  <sdx:queryParser class="fr.gouv.culture.sdx.search.lucene.queryparser.DefaultQueryParser"/>
	  <sdx:repositories>
	    <sdx:repository id="balise_prorep" type="MYSQL" dsi="balise"/>
	  </sdx:repositories>
	  <sdx:fieldList xml:lang="fr-FR" variant="" analyzerConf="/sdx/resources/conf/analysis/fr.xml">
	    <sdx:field name="id" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">id</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET-DOCUMENT-content_word" type="word" brief="true">
	      <sdx:name xml:lang="fr-FR">Objet et contenu des documents (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET-DOCUMENT-content_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Objet et contenu des documents (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="TYPE_TEXTE_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Type de texte</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Objet du document</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Objet du document (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET_word" type="word">
	      <sdx:name xml:lang="fr-FR">Objet du document (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Objet du document (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DATE_date" type="date" brief="true">
	      <sdx:name xml:lang="fr-FR">Date du document</sdx:name>
	    </sdx:field>
	    <sdx:field name="ETAT_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Etat</sdx:name>
	    </sdx:field>
	    <sdx:field name="ETAT_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Etat (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="REMPLACE_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Remplace</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOMAINE_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Domaine</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOMAINE_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Domaine (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="PUB_ACTUS_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Publication actualités</sdx:name>
	    </sdx:field>
	    <sdx:field name="PUB_ACTUS_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Publication actualités (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="SUJET_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Sujet</sdx:name>
	    </sdx:field>
	    <sdx:field name="SUJET_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Sujet (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBSERVATION_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Observation</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBSERVATION_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Observation (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBSERVATION_word" type="word">
	      <sdx:name xml:lang="fr-FR">Observation (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBSERVATION_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Observation (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DESCRIPTION_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Description</sdx:name>
	    </sdx:field>
	    <sdx:field name="DESCRIPTION_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Description (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DESCRIPTION_word" type="word">
	      <sdx:name xml:lang="fr-FR">Description (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DESCRIPTION_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Description (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="REFERENCE_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Référence</sdx:name>
	    </sdx:field>
	    <sdx:field name="REFERENCE_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Référence (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="REFERENCE_word" type="word">
	      <sdx:name xml:lang="fr-FR">Référence (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="REFERENCE_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Référence (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="APPAREILS_RM_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Appareils RM</sdx:name>
	    </sdx:field>
	    <sdx:field name="APPAREILS_RM_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Appareils RM (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="APPAREILS_TG_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Appareils TG</sdx:name>
	    </sdx:field>
	    <sdx:field name="APPAREILS_TG_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Appareils TG (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="VEHICULES_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Véhicules</sdx:name>
	    </sdx:field>
	    <sdx:field name="VEHICULES_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Véhicules (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="CONSTRUCTEURS_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Constructeurs</sdx:name>
	    </sdx:field>
	    <sdx:field name="CONSTRUCTEURS_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Constructeurs (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DIFFUSION_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Diffusion</sdx:name>
	    </sdx:field>
	    <sdx:field name="DIFFUSION_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Diffusion (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOCUMENT_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Document attaché</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOCUMENT_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Document attaché (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOCUMENT-content_word" type="word">
	      <sdx:name xml:lang="fr-FR">Document attaché (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOCUMENT-content_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Document attaché (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="UTIL_CREAT_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Saisie par</sdx:name>
	    </sdx:field>
	    <sdx:field name="DATE_CREAT_date" type="date" brief="true">
	      <sdx:name xml:lang="fr-FR">Saisie le</sdx:name>
	    </sdx:field>
	    <sdx:field name="UTIL_MAJ_field" type="date" brief="true">
	      <sdx:name xml:lang="fr-FR">Modifiée par</sdx:name>
	    </sdx:field>
	    <sdx:field name="DATE_MAJ_date" type="date" brief="true">
	      <sdx:name xml:lang="fr-FR">Modifiée le</sdx:name>
	    </sdx:field>
	  </sdx:fieldList>
	  <sdx:index>
	    <sdx:pipeline>
	      <sdx:transformation id="index-balise_pro" type="XSLT" src="index-balise.xsl"/>
	    </sdx:pipeline>
	  </sdx:index>
	</sdx:documentBase>


	<sdx:documentBase xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" xmlns:notix="http://portail.documentation.equipement.gouv.fr/ns/notix" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dcq="http://purl.org/dc/terms/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#" xmlns:rng="http://relaxng.org/ns/structure/1.0" xmlns:xf="http://www.w3.org/2002/xforms" id="balise_strmtg" name="Base balise strmtg" type="lucene" default="true" keepOriginalDocuments="true">
	  <sdx:queryParser class="fr.gouv.culture.sdx.search.lucene.queryparser.DefaultQueryParser"/>
	  <sdx:repositories>
	    <sdx:repository id="balise_strmtgrep" type="MYSQL" dsi="balise"/>
	  </sdx:repositories>
	  <sdx:fieldList xml:lang="fr-FR" variant="" analyzerConf="/sdx/resources/conf/analysis/fr.xml">
	    <sdx:field name="id" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">id</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET-DOCUMENT-content_word" type="word" brief="true">
	      <sdx:name xml:lang="fr-FR">Objet et contenu des documents (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET-DOCUMENT-content_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Objet et contenu des documents (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="TYPE_TEXTE_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Type de texte</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Objet du document</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Objet du document (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET_word" type="word">
	      <sdx:name xml:lang="fr-FR">Objet du document (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBJET_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Objet du document (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DATE_date" type="date" brief="true">
	      <sdx:name xml:lang="fr-FR">Date du document</sdx:name>
	    </sdx:field>
	    <sdx:field name="ETAT_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Etat</sdx:name>
	    </sdx:field>
	    <sdx:field name="ETAT_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Etat (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="REMPLACE_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Remplace</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOMAINE_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Domaine</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOMAINE_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Domaine (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="PUB_ACTUS_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Publication actualités</sdx:name>
	    </sdx:field>
	    <sdx:field name="PUB_ACTUS_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Publication actualités (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="SUJET_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Sujet</sdx:name>
	    </sdx:field>
	    <sdx:field name="SUJET_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Sujet (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBSERVATION_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Observation</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBSERVATION_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Observation (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBSERVATION_word" type="word">
	      <sdx:name xml:lang="fr-FR">Observation (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="OBSERVATION_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Observation (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DESCRIPTION_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Description</sdx:name>
	    </sdx:field>
	    <sdx:field name="DESCRIPTION_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Description (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DESCRIPTION_word" type="word">
	      <sdx:name xml:lang="fr-FR">Description (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DESCRIPTION_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Description (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="REFERENCE_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Référence</sdx:name>
	    </sdx:field>
	    <sdx:field name="REFERENCE_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Référence (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="REFERENCE_word" type="word">
	      <sdx:name xml:lang="fr-FR">Référence (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="REFERENCE_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Référence (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="APPAREILS_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Appareils</sdx:name>
	    </sdx:field>
	    <sdx:field name="APPAREILS_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Appareils (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="VEHICULES_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Véhicules</sdx:name>
	    </sdx:field>
	    <sdx:field name="VEHICULES_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Véhicules (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="CONSTRUCTEURS_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Constructeurs</sdx:name>
	    </sdx:field>
	    <sdx:field name="CONSTRUCTEURS_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Constructeurs (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DIFFUSION_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Diffusion</sdx:name>
	    </sdx:field>
	    <sdx:field name="DIFFUSION_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Diffusion (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOCUMENT_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Document attaché</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOCUMENT_sort" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Document attaché (Tri)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOCUMENT-content_word" type="word">
	      <sdx:name xml:lang="fr-FR">Document attaché (Mots)</sdx:name>
	    </sdx:field>
	    <sdx:field name="DOCUMENT-content_mots" type="word" analyzerClass="fr.gouv.culture.sdx.search.lucene.analysis.Analyzer_shingle">
	      <sdx:name xml:lang="fr-FR">Document attaché (Extraits)</sdx:name>
	    </sdx:field>
	    <sdx:field name="UTIL_CREAT_field" type="field" brief="true">
	      <sdx:name xml:lang="fr-FR">Saisie par</sdx:name>
	    </sdx:field>
	    <sdx:field name="DATE_CREAT_date" type="date" brief="true">
	      <sdx:name xml:lang="fr-FR">Saisie le</sdx:name>
	    </sdx:field>
	    <sdx:field name="UTIL_MAJ_field" type="date" brief="true">
	      <sdx:name xml:lang="fr-FR">Modifiée par</sdx:name>
	    </sdx:field>
	    <sdx:field name="DATE_MAJ_date" type="date" brief="true">
	      <sdx:name xml:lang="fr-FR">Modifiée le</sdx:name>
	    </sdx:field>
	  </sdx:fieldList>
	  <sdx:index>
	    <sdx:pipeline>
	      <sdx:transformation id="index-balise_strmtg" type="XSLT" src="index-balise.xsl"/>
	    </sdx:pipeline>
	  </sdx:index>
	</sdx:documentBase>

    </sdx:documentBases>
</sdx:application>

```

</details>


---

### 📄 `conf/index-balise.xsl` [12.945 octets]
<a id="conf-index-balise-xsl"></a> [↩ Retour à l'arborescence](#tree-conf-index-balise-xsl)

> **Chemin relatif** : `conf/index-balise.xsl`  
> **Taille** : 12.945 octets  
> **Lignes** : 366  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (366 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output method="xml" indent="yes" encoding="utf-8"/>
  <xsl:variable name="noticeid">
    <xsl:value-of select="/record/@xml:id"/>
  </xsl:variable>
  <xsl:template match="record">
    <sdx:document>
      <xsl:attribute name="id">
        <xsl:value-of select="$noticeid"/>
      </xsl:attribute>
      <sdx:field code="id">
        <xsl:value-of select="$noticeid"/>
      </sdx:field>
      <!--OBJET (Mots) : Objet du document-->
      <xsl:if test="//OBJET and //DOCUMENT">
        <sdx:field code="OBJET-DOCUMENT-content_word">
          <xsl:for-each select="//OBJET">
            <xsl:value-of select="." mode="fulltext"/>
          </xsl:for-each>
	  <xsl:for-each select="//DOCUMENT">
	    <xsl:text> </xsl:text>
            <xsl:call-template name="extractDocContent">
              <xsl:with-param name="docName" select="."/>
            </xsl:call-template>
          </xsl:for-each>
        </sdx:field>
      </xsl:if>
      <!--OBJET (Extraits) : Objet du document-->
      <xsl:if test="//OBJET and //DOCUMENT">
        <sdx:field code="OBJET-DOCUMENT-content_mots">
          <xsl:for-each select="//OBJET">
            <xsl:value-of select="." mode="fulltext"/>
          </xsl:for-each>
	  <xsl:for-each select="//DOCUMENT">
	    <xsl:text> </xsl:text>
            <xsl:call-template name="extractDocContent">
              <xsl:with-param name="docName" select="."/>
            </xsl:call-template>
          </xsl:for-each>
        </sdx:field>
      </xsl:if>
      <!--TYPE_TEXTE (Expression) : Type de texte-->
      <xsl:for-each select="//TYPE_TEXTE">
        <sdx:field code="TYPE_TEXTE_field">
          <xsl:value-of select="."/>
        </sdx:field>
      </xsl:for-each>
      <!--OBJET (Expression) : Objet du document-->
      <xsl:for-each select="//OBJET">
        <sdx:field code="OBJET_field">
          <xsl:value-of select="."/>
        </sdx:field>
      </xsl:for-each>
      <!--OBJET (Tri) : Objet du document-->
      <xsl:if test="//OBJET">
        <sdx:field code="OBJET_sort">
          <xsl:for-each select="//OBJET">
            <xsl:value-of select="normalize-space(.)"/>
            <xsl:if test="position()!=last()">
              <xsl:text>; </xsl:text>
            </xsl:if>
          </xsl:for-each>
        </sdx:field>
      </xsl:if>
      <!--OBJET (Mots) : Objet du document-->
      <xsl:if test="//OBJET">
        <sdx:field code="OBJET_word">
          <xsl:for-each select="//OBJET">
            <xsl:value-of select="." mode="fulltext"/>
          </xsl:for-each>
        </sdx:field>
      </xsl:if>
      <!--OBJET (Extraits) : Objet du document-->
      <xsl:if test="//OBJET">
        <sdx:field code="OBJET_mots">
          <xsl:for-each select="//OBJET">
            <xsl:value-of select="."/>
          </xsl:for-each>
        </sdx:field>
      </xsl:if>
      <!--DATE (Dates) : Date du document-->
      <xsl:if test="//DATE">
        <sdx:field code="DATE_date">
          <xsl:value-of select="DATE"/>
        </sdx:field>
      </xsl:if>
      <!--ETAT (Expression) : Etat-->
      <xsl:for-each select="//ETAT">
        <sdx:field code="ETAT_field">
          <xsl:value-of select="."/>
        </sdx:field>
      </xsl:for-each>
      <!--REMPLACE (Expression) : Remplace-->
      <xsl:for-each select="//REMPLACE">
        <sdx:field code="REMPLACE_field">
          <xsl:value-of select="."/>
        </sdx:field>
      </xsl:for-each>
      <!--DOMAINE (Expression) : Domaine-->
      <xsl:for-each select="//DOMAINE">
        <sdx:field code="DOMAINE_field">
          <xsl:value-of select="."/>
        </sdx:field>
      </xsl:for-each>
      <!--PUB_ACTUS (Expression) : Sujet-->
      <xsl:for-each select="//PUB_ACTUS">
        <sdx:field code="PUB_ACTUS_field">
          <xsl:value-of select="."/>
        </sdx:field>
      </xsl:for-each>
      <!--SUJET (Expression) : Sujet-->
      <xsl:for-each select="//SUJET">
        <sdx:field code="SUJET_field">
          <xsl:value-of select="."/>
        </sdx:field>
      </xsl:for-each>
      <!--OBSERVATION (Expression) : Observation-->
      <xsl:for-each select="//OBSERVATION">
        <sdx:field code="OBSERVATION_field">
          <xsl:value-of select="."/>
        </sdx:field>
      </xsl:for-each>
      <!--OBSERVATION (Tri) : Observation-->
      <xsl:if test="//OBSERVATION">
        <sdx:field code="OBSERVATION_sort">
          <xsl:for-each select="//OBSERVATION">
            <xsl:value-of select="normalize-space(.)"/>
            <xsl:if test="position()!=last()">
              <xsl:text>; </xsl:text>
            </xsl:if>
          </xsl:for-each>
        </sdx:field>
      </xsl:if>
      <!--OBSERVATION (Mots) : Observation-->
      <xsl:if test="//OBSERVATION">
        <sdx:field code="OBSERVATION_word">
          <xsl:for-each select="//OBSERVATION">
            <xsl:value-of select="." mode="fulltext"/>
          </xsl:for-each>
        </sdx:field>
      </xsl:if>
      <!--OBSERVATION (Extraits) : Observation-->
      <xsl:if test="//OBSERVATION">
        <sdx:field code="OBSERVATION_mots">
          <xsl:for-each select="//OBSERVATION">
            <xsl:value-of select="."/>
          </xsl:for-each>
        </sdx:field>
      </xsl:if>
      <!--DESCRIPTION (Expression) : Description-->
      <xsl:for-each select="//DESCRIPTION">
        <sdx:field code="DESCRIPTION_field">
          <xsl:value-of select="."/>
        </sdx:field>
      </xsl:for-each>
      <!--DESCRIPTION (Tri) : Description-->
      <xsl:if test="//DESCRIPTION">
        <sdx:field code="DESCRIPTION_sort">
          <xsl:for-each select="//DESCRIPTION">
            <xsl:value-of select="normalize-space(.)"/>
            <xsl:if test="position()!=last()">
              <xsl:text>; </xsl:text>
            </xsl:if>
          </xsl:for-each>
        </sdx:field>
      </xsl:if>
      <!--DESCRIPTION (Mots) : Description-->
      <xsl:if test="//DESCRIPTION">
        <sdx:field code="DESCRIPTION_word">
          <xsl:for-each select="//DESCRIPTION">
            <xsl:value-of select="." mode="fulltext"/>
          </xsl:for-each>
        </sdx:field>
      </xsl:if>
      <!--DESCRIPTION (Extraits) : Description-->
      <xsl:if test="//DESCRIPTION">
        <sdx:field code="DESCRIPTION_mots">
          <xsl:for-each select="//DESCRIPTION">
            <xsl:value-of select="."/>
          </xsl:for-each>
        </sdx:field>
      </xsl:if>
      <!--REFERENCE (Expression) : Référence-->
      <xsl:for-each select="//REFERENCE">
        <sdx:field code="REFERENCE_field">
          <xsl:value-of select="."/>
        </sdx:field>
      </xsl:for-each>
      <!--REFERENCE (Tri) : Référence-->
      <xsl:if test="//REFERENCE">
        <sdx:field code="REFERENCE_sort">
          <xsl:for-each select="//REFERENCE">
            <xsl:value-of select="normalize-space(.)"/>
            <xsl:if test="position()!=last()">
              <xsl:text>; </xsl:text>
            </xsl:if>
          </xsl:for-each>
        </sdx:field>
      </xsl:if>
      <!--REFERENCE (Mots) : Référence-->
      <xsl:if test="//REFERENCE">
        <sdx:field code="REFERENCE_word">
          <xsl:for-each select="//REFERENCE">
            <xsl:value-of select="." mode="fulltext"/>
          </xsl:for-each>
        </sdx:field>
      </xsl:if>
      <!--REFERENCE (Extraits) : Référence-->
      <xsl:if test="//REFERENCE">
        <sdx:field code="REFERENCE_mots">
          <xsl:for-each select="//REFERENCE">
            <xsl:value-of select="."/>
          </xsl:for-each>
        </sdx:field>
      </xsl:if>
      <!--APPAREILS (Expression) : Appareils RM-->
      <xsl:for-each select="//APPAREILS">
        <sdx:field code="APPAREILS_RM_field">
          <xsl:value-of select="."/>
        </sdx:field>
      </xsl:for-each>
      <!--APPAREILS (Expression) : Appareils TG-->
      <xsl:for-each select="//APPAREILS_TG">
        <sdx:field code="APPAREILS_TG_field">
          <xsl:value-of select="."/>
        </sdx:field>
      </xsl:for-each>
      <!--VEHICULES (Expression) : Véhicules-->
      <xsl:for-each select="//VEHICULES">
        <sdx:field code="VEHICULES_field">
          <xsl:value-of select="."/>
        </sdx:field>
      </xsl:for-each>
      <!--CONSTRUCTEURS (Expression) : Constructeurs-->
      <xsl:for-each select="//CONSTRUCTEURS">
        <sdx:field code="CONSTRUCTEURS_field">
          <xsl:value-of select="."/>
        </sdx:field>
      </xsl:for-each>
      <!--DIFFUSION (Expression) : Diffusion-->
      <xsl:for-each select="//DIFFUSION">
        <sdx:field code="DIFFUSION_field">
          <xsl:value-of select="."/>
        </sdx:field>
      </xsl:for-each>
      <!--DOCUMENT (Expression) : Document attaché-->
      <xsl:for-each select="//DOCUMENT">
        <sdx:field code="DOCUMENT_field">
          <xsl:value-of select="."/>
        </sdx:field>
      </xsl:for-each>
      <!--DOCUMENT (Tri) : Document attaché-->
      <xsl:if test="//DOCUMENT">
        <sdx:field code="DOCUMENT_sort">
          <xsl:for-each select="//DOCUMENT">
            <xsl:value-of select="normalize-space(.)"/>
            <xsl:if test="position()!=last()">
              <xsl:text>; </xsl:text>
            </xsl:if>
          </xsl:for-each>
        </sdx:field>
      </xsl:if>
      <!--DOCUMENT (Texte intégral) : Document attaché-->
      <xsl:if test="//DOCUMENT">
        <sdx:field code="DOCUMENT-content_word">
          <xsl:for-each select="//DOCUMENT">
            <xsl:call-template name="extractDocContent">
              <xsl:with-param name="docName" select="."/>
            </xsl:call-template>
          </xsl:for-each>
        </sdx:field>
      </xsl:if>
      <!--OBJET (Extraits) : Objet du document-->
      <xsl:if test="//DOCUMENT">
        <sdx:field code="DOCUMENT-content_mots">
	  <xsl:for-each select="//DOCUMENT">
            <xsl:call-template name="extractDocContent">
              <xsl:with-param name="docName" select="."/>
            </xsl:call-template>
          </xsl:for-each>
        </sdx:field>
      </xsl:if>
      <!--UTIL_CREAT (Expression) : Saisie par-->
<!--
      <xsl:for-each select="//UTIL_CREAT">
        <sdx:field code="UTIL_CREAT_field">
          <xsl:value-of select="."/>
        </sdx:field>
      </xsl:for-each>
-->
      <!--DATE_CREAT (Dates) : Saisie le-->
      <xsl:if test="//DATE_CREAT">
        <sdx:field code="DATE_CREAT_date">
          <xsl:value-of select="DATE_CREAT"/>
        </sdx:field>
      </xsl:if>
      <!--UTIL_MAJ (Expression) : Modifiée par-->
<!--
      <xsl:for-each select="//UTIL_MAJ">
        <sdx:field code="UTIL_MAJ_field">
          <xsl:value-of select="."/>
        </sdx:field>
      </xsl:for-each>
-->
      <!--DATE_MAJ (Dates) : Modifiée le-->
      <xsl:if test="//DATE_MAJ">
        <sdx:field code="DATE_MAJ_date">
          <xsl:value-of select="DATE_MAJ"/>
        </sdx:field>
      </xsl:if>
    </sdx:document>
  </xsl:template>
  <!--+++++++++-->
  <!--Fonctions-->
  <!--+++++++++-->
  <xsl:template name="extractDocContent">
    <xsl:param name="docName"/>
    <xsl:variable name="doclink">
      <xsl:value-of select="'cocoon://balise/extraction.xml?fichier='"/>
      <xsl:value-of select="substring-before($noticeid, '-')"/>
      <xsl:text>/</xsl:text>
      <xsl:value-of select="substring($noticeid, string-length(substring-before($noticeid, '-'))+2, 4)"/>
      <xsl:text>/</xsl:text>
      <xsl:value-of select="$noticeid"/>
      <xsl:text>/</xsl:text>
      <xsl:value-of select="$docName"/>
    </xsl:variable>
    <xsl:choose>
      <xsl:when test="substring($doclink, string-length($doclink)-3)='.zip'">
        <xsl:message>
          <xsl:text>Pièce jointe ignorée : </xsl:text>
          <xsl:value-of select="$doclink"/>
        </xsl:message>
      </xsl:when>
      <xsl:otherwise>
        <xsl:value-of select="document($doclink)/extracteur//text()"/>
      </xsl:otherwise>
    </xsl:choose>
	<xsl:message>
	<xsl:value-of select="$doclink"/>
	</xsl:message>
  </xsl:template>
  <xsl:template name="splitdate">
    <xsl:param name="date"/>
    <xsl:value-of select="substring($date,0,5)"/>
    <xsl:if test="substring($date,5,2)">
      <xsl:text>-</xsl:text>
      <xsl:value-of select="substring($date,5,2)"/>
      <xsl:if test="substring($date,7,2)">
        <xsl:text>-</xsl:text>
        <xsl:value-of select="substring($date,7,2)"/>
      </xsl:if>
    </xsl:if>
  </xsl:template>
  <xsl:template match="*" mode="fulltext">
    <xsl:apply-templates select="*|text()" mode="fulltext"/>
  </xsl:template>
  <xsl:template match="text()" mode="fulltext">
    <xsl:value-of select="normalize-space(.)"/>
    <xsl:if test="normalize-space(.) !=''">
      <xsl:text/>
    </xsl:if>
  </xsl:template>
</xsl:stylesheet>

```

</details>


---

### 📄 `conf/logicsheets/sdxUtil.xsl` [25.943 octets]
<a id="conf-logicsheets-sdxUtil-xsl"></a> [↩ Retour à l'arborescence](#tree-conf-logicsheets-sdxUtil-xsl)

> **Chemin relatif** : `conf/logicsheets/sdxUtil.xsl`  
> **Taille** : 25.943 octets  
> **Lignes** : 730  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (730 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../../../transform/xmldoc/xsl2html.xsl"?>
<!--

Notix, SDX - Logicsheet d'indexation
************************************


Titre        : Notix, SDX - Logicsheet générale
Copyright    : © 2005 "Ministère des Transports", "AJLSM" <http://ajlsm.com>.
Licence      : "GPL" <http://www.gnu.org/copyleft/gpl.html>
Créateur     : [JC] Johan Cwiklinski <johan AT x-tnd DOT be>
Description  : Contient en particulier le code d'indexation.


<license>

Notix : notices bibliographiques et d'autorités, dans une base XML.

Copyright (C) 2005 Ministère de l'Équipement, AJLSM.Copyright (C) 2005 Ministère des Transports, AJLSM.

Ministère des Transports, de l'Équipement, du Tourisme et de la Mer (FRANCE),
    Centre d'Études Technique de l’Équipement Nord - Picardie (CETE Nord - Picardie),
    Point d'appui national documentaire (Pandoc),
    2 rue de Bruxelles – BP 275, 59019 LILLE Cedex, France.
AJLSM,
    17 rue Vital-Carles, 33000 Bordeaux, France

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html

</license>
-->
<xsl:stylesheet version="1.1"
	xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
	xmlns:xsp="http://apache.org/xsp"
	xmlns:xsp-sdxUtil="http://portail.documentation.equipement.gouv.fr/ns/sdx/sdxUtil"
	exclude-result-prefixes="xsl xsp xsp-notixUtil"
>

	<xsl:template match="xsp:page">
	 <xsl:copy>
	  <xsl:apply-templates select="@*"/>
	  <xsl:apply-templates/>
	 </xsl:copy>
	</xsl:template>

	<xsl:template match="xsp-sdxUtil:validateInputsFunctions">
		<xsp:logic>
<!-- lesser version -->
		public String processParameters(String contenu) {
			if(contenu!=null &amp;&amp; !contenu.trim().equals("")){
				contenu=cleanupParameter(contenu);
				//DEBUG System.out.println("cleanedUp : "+contenu);

				// On retire les expressions exactes :
				String temp="";
				int current=0;
				int end= contenu.length();
				int firstIndex=0;
				int nextIndex=0;
				int arrayIndex=0;
				String[] exprs= new String[compteOccurences(contenu, '"')/2];
				while( contenu.substring(current, end).contains("\"")  ){
					firstIndex=current+contenu.substring(current, contenu.length()).indexOf("\"");
					nextIndex=firstIndex+contenu.substring(firstIndex+1, contenu.length()).indexOf("\"")+1;
					temp+=new String(contenu.substring(current, firstIndex+1))+"\"";
					exprs[arrayIndex]=new String(contenu.substring(firstIndex+1, nextIndex));
					current=nextIndex+1;
					arrayIndex+=1;
				}				
				temp+=new String(contenu.substring(current, end));
				contenu=temp;

				// On s'occupe des prefixes génants: +-| !:~^
				contenu=prefixRemover(contenu);

				//On restaure les expression exactes
				temp="";
				current=0;
				end= contenu.length();
				firstIndex=0;
				nextIndex=0;
				 arrayIndex=0;
				while( contenu.substring(current, end).contains("\"")  ){
					firstIndex=current+contenu.substring(current, contenu.length()).indexOf("\"");
					nextIndex=firstIndex+contenu.substring(firstIndex+1, contenu.length()).indexOf("\"")+1;
					temp+=new String(contenu.substring(current, firstIndex+1))+exprs[arrayIndex]+"\"";
					current=nextIndex+1;
					arrayIndex+=1;
				}				
				temp+=new String(contenu.substring(current, end));
				contenu=temp;

			}
			return contenu;
		}

		public int compteOccurences(String chaine, char sousChaine) {
			String temp=chaine;
			String tmp=chaine;
			int occ=0;
			while(temp.indexOf(sousChaine)!=-1){
				temp=temp.substring(temp.indexOf(sousChaine)+1);
				occ+=1;		
			}
			return occ;
		}

		public String cleanPrefixes(String chaine) {
			String cleaned="";
			String[] splitted = chaine.split(" ");
			for(int i=0; i&lt;splitted.length; i++){
				cleaned+= checkFirstChar(splitted[i])+" ";
				//DEBUG System.out.println(splitted[i]);
			}
			cleaned=cleaned.trim();
			return cleaned;
		}

		public String prefixRemover(String chaine) {

			String temp;
			if(chaine.indexOf('(')!=-1){
				temp=cleanPrefixes( chaine.substring(0,chaine.indexOf('(')) )+"(";
				temp+=prefixRemover( chaine.substring( chaine.indexOf( '(' ) +1 , chaine.lastIndexOf(')') ) );
				temp+=")"+cleanPrefixes( chaine.substring(chaine.lastIndexOf(')')+1, chaine.length() ));
			}else{
				temp=cleanPrefixes(chaine);
			}
			  return temp;
		}

		public String cleanupParameter(String input) {
			// On vérifie les parenthèses, crochets, accolades, guillemets

			// Quotes
			//Si le nombre de guillemets est impair
			if(((" "+input+" ").split("\"").length-1)%2!=0){
				if(input.lastIndexOf("\"")!=input.length()-1){
					input=input+"\"";	
				}else {
					input= new String( input.substring(0,input.length()-1) );
				}
			}

			//Brackets
			//Si le nombre de parenthèses est impair
			if( compteOccurences(input,'(') != compteOccurences(input,')') ){
				if( compteOccurences(input,'(') > compteOccurences(input,')') ){
					while(compteOccurences(input,'(') &gt; compteOccurences(input,')')){
						input=input+")";	
					}
				}else {
					while(compteOccurences(input,'(') &lt; compteOccurences(input,')')){
						input="("+input;	
					}
				}

				while(input.indexOf("()")!=-1){
					input=input.substring(0,input.indexOf("()")) + input.substring(input.indexOf("()")+2, input.length());	
				}
			}

			//Angle,Square,Curly brackets
			if( compteOccurences(input,'[') != compteOccurences(input,']') ){
				input="";
			}
			if( compteOccurences(input,'{') != compteOccurences(input,'}') ){
				input="";
			}
			if( compteOccurences(input,'&lt;') != compteOccurences(input,'&gt;') ){
				input="";
			}

			return input;	

		}

		public String checkFirstChar(String word) {
			if(word.startsWith("+") || word.startsWith("-") || word.startsWith(" ") || word.startsWith("|") || word.startsWith("!") || word.startsWith(":") || word.startsWith("~") || word.startsWith("^")){
				word=checkFirstChar(word.substring(1));
			}
			return word;
		}



		public String spacesRemover(String chaine) {

			String temp;
			if(chaine.indexOf('(')!=-1){
				temp=(chaine.substring(0,chaine.indexOf('(') ).trim()+"(").trim();
				temp+=( chaine.substring( chaine.indexOf( '(' ) +1 , chaine.lastIndexOf(')') ).trim() ).trim();
				temp+=(")"+chaine.substring(chaine.lastIndexOf(')')+1, chaine.length() ).trim()).trim();
			}else{
				temp=chaine.trim();
			}
			  return temp;
		}

		public String addQuotesIfNoneExists(String chaine) {
				if (chaine==null){
					return null;
				}else if( chaine.equals("")){
					return chaine;
				}else if( chaine.indexOf("\"") != -1 ){
					return chaine;
				}else{
				return "\""+chaine+"\"";
				}
		}

		public String escapeParameter(String chaine) {
			return escapeParameter(chaine, false);
		}

		public String escapeParameter(String chaine, boolean shingle) {


			//chaine=checkQuery(chaine);

			if(chaine!=null &amp;&amp; !chaine.equals("")){


				if (shingle){
					chaine=chaine.replace('"',' ');
				//	chaine=chaine.replace('-',' ');
				}else{
					//Do noting
				}

				// Quotes
				//Si le nombre de guillemets est impair
				if(((" "+chaine+" ").split("\"").length-1)%2!=0){
					if(chaine.lastIndexOf("\"")!=chaine.length()-1){
						chaine+="\"";	
					}else {
						chaine= new String( chaine.substring(0,chaine.length()-1) );
					}
				}
			
				
				if ( chaine.indexOf("\"")!=-1){
						
					// Split string and do not escape what's inside quotes.
					chaine = spareExpressions(chaine);
					//chaine = escapeString(chaine);

				} else {
					chaine = escapeString(chaine);
				}

	
	
			}else{
				chaine="";
			}
			//System.out.println(chaine);
			return chaine.trim();
		
		}


		public String checkQuery(String chaine) {
			
			if (chaine!=null){
			 return chaine.replace(" to ", " TO ");
			}
			return null;

		}

		public String escapeString( String chaine ){

			chaine=chaine.replace("\"\"","\" \"");
		
			//String[] whatWeHave={"\\", "+", "-", "&amp;&amp;", "||", "!", "(", ")", "{", "}", "[", "]", "^", "\"", "~", "*", "?", ":",};
			//String[] whatWeWant={"\\\\", "\\+", "\\-", "\\&amp;\\&amp;", "\\|\\|", "\\!", "\\(", "\\)", "\\{", "\\}", "\\[", "\\]", "\\^", "\\\"", "\\~", "\\*", "\\?", "\\:",};
			String[] whatWeHave={"\\", "+", "-", "&amp;&amp;", "||", "!", "(", ")", "{", "}", "[", "]", "^", "~", ":",};
			String[] whatWeWant={"\\\\", "\\+", "\\-", "\\&amp;\\&amp;", "\\|\\|", "\\!", "\\(", "\\)", "\\{", "\\}", "\\[", "\\]", "\\^", "\\~", "\\:",};
			for(int i=0; i&lt;whatWeHave.length;i+=1){
				chaine=chaine.replace(whatWeHave[i],whatWeWant[i]);
			}

			return chaine;	
		}


		public String spareExpressions(String contenu) {
			if(contenu!=null &amp;&amp; !contenu.trim().equals("")){

			//DEBUG System.out.println("Contenu 1 : "+contenu);
				// On retire les expressions exactes :
				String temp="";
				int current=0;
				int end= contenu.length();
				int firstIndex=0;
				int nextIndex=0;
				int arrayIndex=0;
				String[] exprs= new String[compteOccurences(contenu, '"')/2];
				while( contenu.substring(current, end).contains("\"")  ){
					firstIndex=current+contenu.substring(current, contenu.length()).indexOf("\"");
					nextIndex=firstIndex+contenu.substring(firstIndex+1, contenu.length()).indexOf("\"")+1;
					temp+=new String(contenu.substring(current, firstIndex+1))+"\"";
					exprs[arrayIndex]=new String(contenu.substring(firstIndex+1, nextIndex));
					current=nextIndex+1;
					arrayIndex+=1;
				}				
				temp+=new String(contenu.substring(current, end));
				contenu=temp;

			//DEBUG System.out.println("Contenu 2 : "+contenu);
			
				// Escape parameters
				contenu = escapeString(contenu);

			//DEBUG System.out.println("Contenu 3 : "+contenu);

				//On restaure les expressions exactes
				temp="";
				current=0;
				end= contenu.length();
				firstIndex=0;
				nextIndex=0;
				 arrayIndex=0;
				while( contenu.substring(current, end).contains("\"")  ){
					firstIndex=current+contenu.substring(current, contenu.length()).indexOf("\"");
					nextIndex=firstIndex+contenu.substring(firstIndex+1, contenu.length()).indexOf("\"")+1;
					temp+=new String(contenu.substring(current, firstIndex+1))+exprs[arrayIndex]+"\"";
					current=nextIndex+1;
					arrayIndex+=1;
				}				
				temp+=new String(contenu.substring(current, end));
				contenu=temp;

			//DEBUG System.out.println("Contenu 4 : "+contenu);
			}
			return contenu;
		}


		</xsp:logic>
	</xsl:template>

	<xsl:template match="xsp-sdxUtil:queryProcessFunctions">
		<xsp:logic>
public static String[] decoupe(String str){
        // decoupe le contenu d'un champ saisi en une liste de mot ou d'expressions entre "" ou entre | |
        java.util.ArrayList list = new java.util.ArrayList();

        int deb = 0;
        int idx;
        int length = str.length();

        while (deb &lt; length) {
                switch (str.charAt(deb)){
                        case '"' :
                                idx = str.indexOf('"', deb+1);
                                list.add(str.substring(deb, idx + 1));
                                deb = idx + 2;
                                break;
                        case '|' :
                                idx = str.indexOf('|', deb+1);
                                list.add(str.substring(deb, idx + 1));
                                deb = idx + 2;
                                break;
                        case ' ' :
                        default :
                                // On supprime tous les espaces successifs.
                                while ((deb &lt; length) &amp;&amp; (str.charAt(deb) == ' '))
                                        deb++;
                                idx = str.indexOf(' ', deb);
                                if (idx == -1){
                                        // On est en fin de chaîne.
                                        list.add(str.substring(deb));
                                        deb = length + 1;
                                }else{
                                        list.add(str.substring(deb, idx));
                                        deb = idx + 1;
                                }
                                break;
                }
        }
        return (String[]) list.toArray(new String[0]);
}

public static String traitement(String champ,String contenu,String op_mots,String op_champ) {
        if(contenu==null || contenu.equals(""))
                return "";
        if(champ==null || champ.equals(""))
                return "";
        if(op_mots==null || op_mots.equals(""))
                op_mots="and";
        if(op_champ==null || op_champ.equals(""))
                op_champ="and";

        String resultat=" ";

        // traitement opérateur entre les champs
        if(op_champ.equals("and")){
                resultat+="+";
        }else if(op_champ.equals("not")){
                resultat+="-";
        }else if(op_champ.equals("or")){
                // on ne fait rien
        }

        resultat+=champ+":";

        // traitement du contenu
        String listemots[]=decoupe(contenu);

        //out.print(listemots.length);
        if(listemots.length==1)
                resultat+=listemots[0];
        else{
                resultat+="(";
                for (int i = 0; i &lt; listemots.length; i++){
                        // traitement opérateur entre les mots du champ
                        if(op_mots.equals("and")){
                                resultat+="+"+listemots[i];
                        }else if(op_mots.equals("not")){
                                if(i==0)
                                        resultat+="+"+listemots[i];
                                else
                                        resultat+="-"+listemots[i];
                        }else if(op_mots.equals("or")){
                                resultat+=listemots[i];
                        }
                        if(i&lt;(listemots.length-1))
                                resultat+=" ";
                }
                resultat+=")";
        }
        return resultat;
}

public static String traitementShingleSeul(String champ,String contenu,String operateur, String op_champ) {
        if(contenu==null || contenu.equals(""))
                return "";
        return champ+":|"+contenu+"| ";
}


public static String traitement(String champ,String contenu,String operateur) {
        if(contenu==null || contenu.equals(""))
                return "";
        if(operateur!=null){
                if(operateur.equals("and")){
                        String newcontenu="";
                        boolean inChaine=false;

                        java.util.StringTokenizer st = new java.util.StringTokenizer(contenu," ");
                        if(st.countTokens()>1){
                                while (st.hasMoreTokens()) {
                                        String mot=st.nextToken();

                                        if(inChaine){
                                                newcontenu+=mot+" ";
                                        }
                                        else
                                                newcontenu+="+"+mot+" ";
                                        if(mot.startsWith("\"")){
                                                inChaine=true;
                                        }
                                        if(mot.endsWith("\""))
                                                inChaine=false;
                                }
                        }
                        else
                                newcontenu=contenu;
                        return "+"+champ+":("+newcontenu+") ";
                }
                else if(operateur.equals("or")){
                        return "+"+champ+":("+contenu+") ";
                }
                else if(operateur.equals("notequal")){
                        //return "-"+champ+":("+contenu+") ";
                        String newcontenu="";
                        boolean inChaine=false;
                        boolean first=true;

                        java.util.StringTokenizer st = new java.util.StringTokenizer(contenu," ");
                        if(st.countTokens()>1){
                                while (st.hasMoreTokens()) {
                                        String mot=st.nextToken();
                                        if(inChaine){
                                                newcontenu+=mot+" ";
                                        }else{
                                                if(first)
                                                        newcontenu+="+"+mot+" ";
                                                else
                                                        newcontenu+="-"+mot+" ";
                                                first=false;
                                        }
                                        if(mot.startsWith("\"")){
                                                inChaine=true;
                                        }
                                        if(mot.endsWith("\""))
                                                inChaine=false;
                                }
                        }else
                                newcontenu=contenu;
                        return "+"+champ+":("+newcontenu+") ";
                }else
                        return "+"+champ+":("+contenu+") ";
        }else
                return contenu;
}

public static String traitement2(String champ,String contenu,String operateur,String operateur_champ) {
        return traitement2(champ, contenu, operateur, operateur_champ, false);
}

public static String traitement2(String champ,String contenu,String operateur,String operateur_champ, boolean exact){
        if(contenu==null || contenu.equals(""))
                return "";
        if(operateur==null){
		operateur="or";
	}

                if(operateur_champ==null || operateur_champ.equals(""))
                        operateur_champ="and";
                String newcontenu=" ";

                // traitement opérateur entre les champs
                if(operateur_champ.equals("and")){
                        newcontenu+="+";
                }else if(operateur_champ.equals("not")){
                        newcontenu+="-";
                }else if(operateur_champ.equals("or")){
                        // on ne fait rien
                }

                if(exact &amp;&amp; !contenu.startsWith("\"")){
                        contenu = "\"" + contenu + "\"";
                }
	

                if(operateur.equals("and")){
                        /*String newcontenu="";*/
                        newcontenu += "(";
                        boolean inChaine=false;

                        java.util.StringTokenizer st = new java.util.StringTokenizer(contenu," ");
                        while (st.hasMoreTokens()) {
                                String mot=st.nextToken();

                                if(inChaine){
                                        newcontenu+=mot+" ";
                                        if(mot.endsWith("\""))
                                                inChaine=false;
                                }else{
                                        if(mot.startsWith("\"")){
                                                inChaine=true;
                                                newcontenu+="+"+champ+":"+mot+" ";
                                                if(mot.endsWith("\""))
                                                        inChaine=false;
                                        }else
                                                newcontenu+="+"+champ+"_mot:(+"+mot+") ";

                                }
                        }


                        newcontenu=newcontenu.replace('\"','|');
                        newcontenu += ")";
                        return newcontenu;
                }else if(operateur.equals("or")){
                        /*String newcontenu="+";*/
                        newcontenu += "(";
                        boolean inChaine=false;

                        java.util.StringTokenizer st = new java.util.StringTokenizer(contenu," ");
                        while (st.hasMoreTokens()) {
                                String mot=st.nextToken();

                                if(inChaine){
                                        newcontenu+=mot+" ";
                                        if(mot.endsWith("\""))
                                                inChaine=false;
                                }else{
                                        if(mot.startsWith("\"")){
                                                inChaine=true;
                                                newcontenu+=champ+":"+mot+" ";
                                                if(mot.endsWith("\""))
                                                        inChaine=false;
                                        }else{
                                                newcontenu+=champ+"_mot:(+"+mot+") ";
                                        }
                                }
                        }

                        newcontenu=newcontenu.replace('\"','|');
                        newcontenu += ")";
                        return newcontenu;
                }else if(operateur.equals("not")){
                        /*String newcontenu="+";*/
                        newcontenu += "(";
                        boolean inChaine=false;
                        boolean first=true;
                        String signe="";
                        java.util.StringTokenizer st = new java.util.StringTokenizer(contenu," ");
                        while (st.hasMoreTokens()) {
                                String mot=st.nextToken();
                                if(inChaine){
                                        newcontenu+=mot+" ";
                                        first=false;
                                        if(mot.endsWith("\""))
                                                inChaine=false;
                                }else{
                                        if (!first)
                                                newcontenu+="-";
                                        if(mot.startsWith("\"")){
                                                inChaine=true;
                                                newcontenu+=champ+":"+mot+" ";
                                                first=false;
                                                if(mot.endsWith("\""))
                                                        inChaine=false;
                                        }else{
                                                newcontenu+=champ+"_mot:(+"+mot+") ";
                                                first=false;
                                        }
                                }
                        }
                        newcontenu=newcontenu.replace('\"','|');
                        newcontenu += ")";
                        return newcontenu;
                }else
                        return contenu;
}

public static String getRequeteDate(String annee,String operateur){
	
	String requete="";

	if(annee!=null&amp;&amp;operateur!=null&amp;&amp;(annee.length()==4)&amp;&amp;operateur.endsWith("equal")){
		if(operateur.equals("equal")){
			requete=" +date:["+annee+"-01-01 TO "+annee+"-12-31]";
		}
		else if(operateur.equals("supequal")){
			requete=" +date:["+annee+"-01-01 TO "+"2100-12-31]";
		}
		else if(operateur.equals("lessequal")){
			requete=" +date:[1900-01-01 TO "+annee+"-12-31]";
		}
		else if(operateur.equals("notequal")){
			requete=" -date:["+annee+"-01-01 TO "+annee+"-12-31]";
		}
	}
    	return requete;
}	

public static String getRequeteDateNumop(String annee,String operateur){
	
	String requete="";

	if(annee!=null&amp;&amp;operateur!=null&amp;&amp;(annee.length()==4)&amp;&amp;operateur.endsWith("eq")){
		if(operateur.equals("eq")){
			requete=" +date:["+annee+"-01-01 TO "+annee+"-12-31]";
		}
		else if(operateur.equals("gteq")){
			requete=" +date:["+annee+"-01-01 TO "+"2100-12-31]";
		}
		else if(operateur.equals("lteq")){
			requete=" +date:[1900-01-01 TO "+annee+"-12-31]";
		}
		else if(operateur.equals("neq")){
			requete=" -date:["+annee+"-01-01 TO "+annee+"-12-31]";
		}
	}
    	return requete;
}	

public static String getDateInterval(String field,String operateur, String dateFrom, String dateTo){

	String newcontenu="";

	if ( "and".equals(operateur)){
        	newcontenu += "+(";
	}
	else if ( "or".equals(operateur)){
        	newcontenu += "(";
	}
	else if ( "not".equals(operateur)){
        	newcontenu += "-(";
	}
	else {
        	newcontenu += "+(";
	}

	if (null == dateFrom || "".equals(dateFrom)){
		dateFrom="0001-01-01";
	}
	if (null == dateTo || "".equals(dateTo)){
		dateTo="9999-01-01";
	}

	newcontenu+= field + ":[ " + dateFrom + " TO " + dateTo + " ]";

	newcontenu +=")";

	return newcontenu;
}
		</xsp:logic>
	</xsl:template>

	<xsl:template match="@*|node()" priority="-1">
	 <xsl:copy>
	  <xsl:apply-templates select="@*|node()"/>
	 </xsl:copy>
	</xsl:template>
	
</xsl:stylesheet>

```

</details>


---

### 📄 `conf/security.ini` [615 octets]
<a id="conf-security-ini"></a> [↩ Retour à l'arborescence](#tree-conf-security-ini)

> **Chemin relatif** : `conf/security.ini`  
> **Taille** : 615 octets  
> **Lignes** : 24  
> **Type** : ini

```ini
[users]
#remy.delmotte@developpement-durable.gouv.fr=admin
#Remy.Delmotte@developpement-durable.gouv.fr=admin
#Remy.Delmotte@developpement-durable.gouv.fr= reseau, profession

[services]
#SG/SPSSI/CPII/DONP/PANDOC=admin,reseau,profession

[profils-cerbere]
ADMINISTRATEUR= reseau,profession
CONTROLEUR= reseau,profession
CONSULTANT= reseau,profession
PROFESSIONNEL=profession
EXPLOITANT=profession
SIEGEMODIF=reseau,profession
ORGAMODIF=profession
ORGACONSULT=profession
OISGSMODIF=profession

[roles]
admin = balise:admin:sdx
reseau = balise:balise-diffusion:reseau
profession = balise:balise-diffusion:profession

```


---

### 📄 `css/local.css` [1.306 octets]
<a id="css-local-css"></a> [↩ Retour à l'arborescence](#tree-css-local-css)

> **Chemin relatif** : `css/local.css`  
> **Taille** : 1.306 octets  
> **Lignes** : 61  
> **Type** : css

```css
.tete #titrepage {
    /*
    background-image: url("../images/balise-1.jpg");
    background-image: url("../images/balise-2.jpg");
    background-image: url("../images/balise-3.jpg");
    background-image: url("../images/balise-4.jpg");
    background-image: url("../images/balise-5.jpg");
    background-image: url("../images/balise-6.jpg");
	background: #5b509c url("../images/balise-moa.png") no-repeat scroll right top ;
	background: #5b509c url("../images/balise-moa-2.png") no-repeat scroll right top ;
    */
	background: #5b509c url("../images/balise-moa-4.png") no-repeat scroll right top ;
}
.menu-head {
    background: transparent url("../images/strmtg-logo.png") no-repeat bottom right;
}

div.balise-radio-type{
	margin:auto;
	width:53%;
}

div.balise-radio-type label{
	font-size:11px;
}

.blocimage-logo-balise{
	background:#5b509c url("../images/logo-balise.png") 0 0 no-repeat;
}


.contenu p { text-indent:0px; }

.contenu h2 {
	margin:0px;
}

.tete #titrepage span{
/*
	margin-top:20px;
*/
	text-shadow: 0 0 9px #000;
}

.local-rightcolheader{
	width:60%;
	height:154px;
	float:right;
	text-shadow: 0 0 9px #000;
}

.local-rightcolheader h2, .local-rightcolheader h2 strong{
	font-size: 16px;
	color: #FFF;
	font-weight: bold;
	font-variant: small-caps;
	margin: 80px 0px 0px 0px;
}



```


---

### 📄 `README.md` [268 octets]
<a id="README-md"></a> [↩ Retour à l'arborescence](#tree-README-md)

> **Chemin relatif** : `README.md`  
> **Taille** : 268 octets  
> **Lignes** : 12  
> **Type** : markdown

```markdown
# balise

Recupéré depuis: http://10.167.70.210/pandoc/

**Accès par svn :**
http://10.167.70.210/pandoc/
pysamyn / p3a5**** (demander le mot de passe à Jérôme Lombart)

**Documentation : **
https://balise-b86492.gitlab-pages.din.developpement-durable.gouv.fr/


```


---

### 📄 `sdxlib/conf/logicsheets/sdxSearch.xsl` [3.589 octets]
<a id="sdxlib-conf-logicsheets-sdxSearch-xsl"></a> [↩ Retour à l'arborescence](#tree-sdxlib-conf-logicsheets-sdxSearch-xsl)

> **Chemin relatif** : `sdxlib/conf/logicsheets/sdxSearch.xsl`  
> **Taille** : 3.589 octets  
> **Lignes** : 104  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (104 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../../../transform/xmldoc/xsl2html.xsl"?>
<!--

Notix, SDX - Logicsheet d'indexation
************************************


Titre        : Notix, SDX - Logicsheet générale
Copyright    : © 2005 "Ministère des Transports", "AJLSM" <http://ajlsm.com>.
Licence      : "GPL" <http://www.gnu.org/copyleft/gpl.html>
Créateur     : [JC] Johan Cwiklinski <johan AT x-tnd DOT be>
Description  : Contient en particulier le code d'indexation.


<license>

Notix : notices bibliographiques et d'autorités, dans une base XML.

Copyright (C) 2005 Ministère de l'Équipement, AJLSM.Copyright (C) 2005 Ministère des Transports, AJLSM.

Ministère des Transports, de l'Équipement, du Tourisme et de la Mer (FRANCE),
    Centre d'Études Technique de l’Équipement Nord - Picardie (CETE Nord - Picardie),
    Point d'appui national documentaire (Pandoc),
    2 rue de Bruxelles – BP 275, 59019 LILLE Cedex, France.
AJLSM,
    17 rue Vital-Carles, 33000 Bordeaux, France

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html

</license>
-->
<xsl:stylesheet version="1.1"
	xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
	xmlns:xsp="http://apache.org/xsp"
	xmlns:xsp-sdxSearch="http://portail.documentation.equipement.gouv.fr/ns/sdx/sdxSearch"
	exclude-result-prefixes="xsl xsp"
>

	<xsl:template match="xsp:page">
	 <xsl:copy>
	  <xsl:apply-templates select="@*"/>
	  <xsl:apply-templates/>
	 </xsl:copy>
	</xsl:template>

	<xsl:template match="xsp-sdxSearch:saveQuery">
		<xsl:param name="query"><xsl:value-of select="query"/> </xsl:param>

		<xsp:logic>
			String sdxSearchLuceneQuery="<xsl:value-of select="$query"/>";

			fr.gouv.equipement.documentation.search.RequestHelper requestHelper = new fr.gouv.equipement.documentation.search.RequestHelper(session,request);;
			fr.gouv.equipement.documentation.search.RequestInfo requestInfo = new fr.gouv.equipement.documentation.search.RequestInfo();
			
			requestHelper.add(requestInfo,query);

			//String requestId = requestInfo.getId();
			//System.out.println("Request Info id : " + requestId);

			//String lQuery = requestInfo.getLuceneQuery();
			//System.out.println("Request Info LuceneQuery : " + lQuery);

			//String qString = requestInfo.getQueryString();
			//System.out.println("Request Info query String : " + requestInfo.getQueryString());
                        //System.out.println("requestId : " + session.getAttribute ("requestId"));


			//String pageName = requestInfo.getPageName();
			//System.out.println("Page Name : " + pageName);

			
			<request-info>
				<xsp:attribute name="luceneQuery"><xsp:expr>requestInfo.getId()</xsp:expr></xsp:attribute>
			</request-info>



		</xsp:logic>
	</xsl:template>

	<xsl:template match="@*|node()" priority="-1">
	 <xsl:copy>
	  <xsl:apply-templates select="@*|node()"/>
	 </xsl:copy>
	</xsl:template>
	
</xsl:stylesheet>

```

</details>


---

### 📄 `sdxlib/conf/logicsheets/sdxSecurity.xsl` [4.334 octets]
<a id="sdxlib-conf-logicsheets-sdxSecurity-xsl"></a> [↩ Retour à l'arborescence](#tree-sdxlib-conf-logicsheets-sdxSecurity-xsl)

> **Chemin relatif** : `sdxlib/conf/logicsheets/sdxSecurity.xsl`  
> **Taille** : 4.334 octets  
> **Lignes** : 123  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (123 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../../../transform/xmldoc/xsl2html.xsl"?>
<!--

Notix, SDX - Logicsheet d'indexation
************************************


Titre        : Notix, SDX - Logicsheet générale
Copyright    : © 2005 "Ministère des Transports", "AJLSM" <http://ajlsm.com>.
Licence      : "GPL" <http://www.gnu.org/copyleft/gpl.html>
Créateur     : [JC] Johan Cwiklinski <johan AT x-tnd DOT be>
Description  : Contient en particulier le code d'indexation.


<license>

Notix : notices bibliographiques et d'autorités, dans une base XML.

Copyright (C) 2005 Ministère de l'Équipement, AJLSM.Copyright (C) 2005 Ministère des Transports, AJLSM.

Ministère des Transports, de l'Équipement, du Tourisme et de la Mer (FRANCE),
    Centre d'Études Technique de l’Équipement Nord - Picardie (CETE Nord - Picardie),
    Point d'appui national documentaire (Pandoc),
    2 rue de Bruxelles – BP 275, 59019 LILLE Cedex, France.
AJLSM,
    17 rue Vital-Carles, 33000 Bordeaux, France

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html

</license>
-->
<xsl:stylesheet version="1.1"
	xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
	xmlns:xsp="http://apache.org/xsp"
	xmlns:xsp-sdxSecurity="http://portail.documentation.equipement.gouv.fr/ns/sdx/sdxSecurity"
	exclude-result-prefixes="xsl xsp"
>

	<xsl:template match="xsp:page">
	 <xsl:copy>
	  <xsl:apply-templates select="@*"/>
	  <xsl:apply-templates/>
	 </xsl:copy>
	</xsl:template>

	<xsl:template match="xsp-sdxSecurity:HasPermission">
		<xsl:param name="base"/>
		<xsp:logic>
		

		</xsp:logic>
	</xsl:template>

	<xsl:template match="xsp-sdxSecurity:init">
		<xsp:logic>
			org.apache.shiro.subject.Subject subject = org.apache.shiro.SecurityUtils.getSubject();
			System.out.println("HERE : User : "+subject.isAuthenticated() + " => " + subject.getPrincipal() + " : LoggedIn Role : "+ subject.hasRole("loggedIn"));

			String sdxSecurityBaseName=null;
                        String sdxSecurityDocType=null;
                        String sdxSecurityNoticeId=null;
                        String permission=null;

                        String sdxSecurityPermission = "";
		</xsp:logic>
	</xsl:template>

	<xsl:template match="xsp-sdxSecurity:hasPermission">
		<xsl:param name="sdxBase"><xsl:value-of select="@sdxBase"/></xsl:param>
		<xsl:param name="noticeId"><xsl:value-of select="@noticeId"/></xsl:param>
		<xsl:param name="docType"><xsl:value-of select="@docType"/></xsl:param>
		<xsl:param name="permission"><xsl:value-of select="@permission"/></xsl:param>
		<xsp:logic>
			sdxSecurityBaseName="<xsl:value-of select="$sdxBase"/>";
			sdxSecurityDocType="<xsl:value-of select="$docType"/>";
			sdxSecurityNoticeId="<xsl:value-of select="$noticeId"/>";
			permission="<xsl:value-of select="$permission"/>";

			sdxSecurityPermission = "";

			if( ! "".equals(sdxSecurityBaseName)){
				sdxSecurityPermission="idee:"+sdxSecurityBaseName;
			}else if( ! "".equals(sdxSecurityDocType)){
				sdxSecurityPermission="idee:docType:"+sdxSecurityDocType;
			}else if( ! "".equals(sdxSecurityNoticeId)){
				sdxSecurityPermission="idee:doc:"+sdxSecurityNoticeId;
			}else if(!"".equals(permission)){
				sdxSecurityPermission=permission;
			}

			System.out.println("perms:"+sdxSecurityPermission);
			if ( subject.isPermitted(sdxSecurityPermission) ){
				<xsp:logic>
					<xsl:apply-templates select="*[name()!='sdx:fallback']"/>
				</xsp:logic>
			}
		</xsp:logic>
	</xsl:template>

	<xsl:template match="@*|node()" priority="-1">
	 <xsl:copy>
	  <xsl:apply-templates select="@*|node()"/>
	 </xsl:copy>
	</xsl:template>
	
</xsl:stylesheet>

```

</details>


---

### 📄 `sdxlib/css/autocomplete.css` [573 octets]
<a id="sdxlib-css-autocomplete-css"></a> [↩ Retour à l'arborescence](#tree-sdxlib-css-autocomplete-css)

> **Chemin relatif** : `sdxlib/css/autocomplete.css`  
> **Taille** : 573 octets  
> **Lignes** : 41  
> **Type** : css

```css
.ac_results {
	padding: 0px;
	border: 1px solid #999;
	background-color: white;
	overflow: hidden;
}

.ac_results ul {
	width: 100%;
	list-style-position: outside;
	list-style: none;
	padding: 0;
	margin: 0;
}

.ac_results li {
	margin: 0px;
	padding: 2px 5px;
	cursor:pointer;
	display: block;
	font: menu;
	font-size: 12px;
	overflow: hidden;
}

.ac_loading {
	background : #666 url('../images/indicator.gif') right center no-repeat;
}

.ac_over {
	background-color: black;
	color: white;
}

/*.ac_results li strong{
	color:#3C0;
}*/

.ac_over{
	color:white!important;
}
```


---

### 📄 `sdxlib/css/color-blue.css` [4.113 octets]
<a id="sdxlib-css-color-blue-css"></a> [↩ Retour à l'arborescence](#tree-sdxlib-css-color-blue-css)

> **Chemin relatif** : `sdxlib/css/color-blue.css`  
> **Taille** : 4.113 octets  
> **Lignes** : 114  
> **Type** : css

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (114 lignes) - Cliquer pour déplier</summary>

```css
	.bgcolortheme{
		background-color:#00a8b5;
	}

	.tete #titrepage {
		/* Activer localement pour un titre sans image */
		background: #00a8b5 url("../images/masque-titre-2.png") no-repeat scroll right top ;
	}
/*	
	.menu{
		background: transparent url("../images/bg_menu_bottom_blue.gif") repeat-x scroll center bottom;
	}
*/
	.menu ul li a{
		color: #00a8b5;
	}
	/*
	.m1:hover{ background:url(../images/menu_main_blue.png) 0px 101px; }
	.m1{ background:url(../images/menu_main_blue.png) 0px 2px; }
	.m2:hover{ background:url(../images/menu_main_blue.png) -150px 101px; }
	.m2{ background:url(../images/menu_main_blue.png) -150px 2px; }
	.m3:hover{ background:url(../images/menu_main_blue.png) -300px 101px; }
	.m3{ background:url(../images/menu_main_blue.png) -300px 2px; }
	.m4:hover{ background:url(../images/menu_main_blue.png) -450px 101px; }
	.m4{ background:url(../images/menu_main_blue.png) -450px 2px; }
	.m5:hover{ background:url(../images/menu_main_blue.png) -600px 101px; }
	.m5{ background:url(../images/menu_main_blue.png) -600px 2px; }
	*/
	
	.m1:hover{ background:url(../images/menu-blue-base-green.png) 0px 101px; }
	.m1{ background:url(../images/menu-blue-base-green.png) 0px 2px; }
	.m2:hover{ background:url(../images/menu-blue-base-green.png) -150px 101px; }
	.m2{ background:url(../images/menu-blue-base-green.png) -150px 2px; }
	.m3:hover{ background:url(../images/menu-blue-base-green.png) -300px 101px; }
	.m3{ background:url(../images/menu-blue-base-green.png) -300px 2px; }
	.m4:hover{ background:url(../images/menu-blue-base-green.png) -450px 101px; }
	.m4{ background:url(../images/menu-blue-base-green.png) -450px 2px; }
	.m5:hover{ background:url(../images/menu-blue-base-green.png) -600px 101px; }
	.m5{ background:url(../images/menu-blue-base-green.png) -600px 2px; }

	.search-tools .basket span{ 
		background: transparent url("../images/porte-document-blue.png") -1px -1px no-repeat;
	}
	
	.search-tools .histo{
		background: transparent url("../images/puce_blue_right.gif") no-repeat scroll 5px;
	}
	
	.stick{
		border-left:solid #00a8b5 5px;
		color:#00a8b5;
	}
	
	.box{
		background:#00a8b5 url("../images/bg_bloc3c_head_empty.png");
	}
	
	a.print{ background: transparent url("../images/panier-3.png") no-repeat; }
	a.print{ background: transparent url("../images/pict_actionprint_blue.gif") no-repeat; }
	a.pmoins{ background: transparent url("../images/pict_actionsmaller_blue.gif") no-repeat; }
	a.pplus{ background: transparent url("../images/pict_actionlarger_blue.gif") no-repeat; }
	
	.widget ul li, .colorwidget ul li{
		background:transparent url("../images/puce_blue_right.gif") no-repeat scroll 8px 7px;
	}
	
	.colorwidget h2{
		color: #00a8b5;
		border-bottom:3px solid #00a8b5;
	}
	
	.menu-bottom h4{
		color:#00a8b5;
	}
	
	.module h2, .aroundTitle h2, span.title, .module h1{
		border-left:solid #00a8b5 5px;
	}
	
	.liste ul li{
		background: url("../images/puce_blue_square.png") no-repeat scroll 6px 7px transparent;
	}
	
	.blocimage{
		background:#00a8b5 0 0 no-repeat;
	}
	
	.formline .left{
		color:#00a8b5;
	}
	
	.formline button.submit{
		background: transparent url("../images/btn_rechercher_blue.png") no-repeat;
	}
	
	.form button.submit:active{ background: transparent url("../images/btn_rechercher_blue_hover.png") no-repeat; }
	
	.AddToBasket{ background:transparent url("../images/ajout-porte-document-blue.png") 0 bottom no-repeat; }
	.AddToBasket:active{ }
	.printSelected{ background:transparent url("../images/imprimante-blue.png") 0 bottom no-repeat; }
	.printSelected:active{ }
	.sendSelected{ background:transparent url("../images/enveloppe-blue.png") 0 bottom no-repeat; }
	.sendSelected:active{ }
	.deleteSelected{ background:transparent url("../images/suppression-blue.png") 0 bottom no-repeat; }
	.deleteSelected:active{ }
	
	.thesaurus{
		background: transparent url("../images/index_blue.gif") no-repeat; }
	}
	
	.valeur li{
		background: url("../images/puce_blue_square.png") no-repeat scroll 0px 7px transparent;
	}
	
```

</details>


---

### 📄 `sdxlib/css/color-gray.css` [4.210 octets]
<a id="sdxlib-css-color-gray-css"></a> [↩ Retour à l'arborescence](#tree-sdxlib-css-color-gray-css)

> **Chemin relatif** : `sdxlib/css/color-gray.css`  
> **Taille** : 4.210 octets  
> **Lignes** : 132  
> **Type** : css

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (132 lignes) - Cliquer pour déplier</summary>

```css
	.bgcolortheme{
		background-color:#6C6C6D;
	}

	.tete #titrepage {
		/* Activer localement pour un titre sans image */
		background: #6C6C6D url("../images/masque-titre-2.png") no-repeat scroll right top ;
	}
/*
	.menu{
		background: transparent url("../images/bg_menu_bottom_gray.gif") repeat-x scroll center bottom;
	}
*/

	.menu{
		background: transparent url("../images/bg_menu_bottom_gray.gif") repeat-x scroll center bottom;
	}

	.menu ul li a{
		color: #6C6C6D;
	}
	/*	
	.m1:hover{ background:url(../images/menu_main_gray.png) 0px 101px; }
	.m1{ background:url(../images/menu_main_gray.png) 0px 2px; }
	.m2:hover{ background:url(../images/menu_main_gray.png) -150px 101px; }
	.m2{ background:url(../images/menu_main_gray.png) -150px 2px; }
	.m3:hover{ background:url(../images/menu_main_gray.png) -300px 101px; }
	.m3{ background:url(../images/menu_main_gray.png) -300px 2px; }
	.m4:hover{ background:url(../images/menu_main_gray.png) -450px 101px; }
	.m4{ background:url(../images/menu_main_gray.png) -450px 2px; }
	.m5:hover{ background:url(../images/menu_main_gray.png) -600px 101px; }
	.m5{ background:url(../images/menu_main_gray.png) -600px 2px; }
	*/
	
	.m1:hover{ background:url(../images/menu-gray-base-gray.png) 0px 101px; }
	.m1{ background:url(../images/menu-gray-base-gray.png) 0px 2px; }
	.m2:hover{ background:url(../images/menu-gray-base-gray.png) -150px 101px; }
	.m2{ background:url(../images/menu-gray-base-gray.png) -150px 2px; }
	.m3:hover{ background:url(../images/menu-gray-base-gray.png) -300px 101px; }
	.m3{ background:url(../images/menu-gray-base-gray.png) -300px 2px; }
	.m4:hover{ background:url(../images/menu-gray-base-gray.png) -450px 101px; }
	.m4{ background:url(../images/menu-gray-base-gray.png) -450px 2px; }
	.m5:hover{ background:url(../images/menu-gray-base-gray.png) -600px 101px; }
	.m5{ background:url(../images/menu-gray-base-gray.png) -600px 2px; }

	.search-tools .basket span{ 
		background: transparent url("../images/porte-document-gray.png") -1px -1px no-repeat;
	}
	
	.search-tools .histo{
		background: transparent url("../images/puce_gray_right.gif") no-repeat scroll 5px;
	}
	
	.stick{
		border-left:solid #6C6C6D 5px;
		color:#6C6C6D;
	}
	
	.box{
		background:#6C6C6D url("../images/bg_bloc3c_head_empty.png");
	}
	
	a.print{ background: transparent url("../images/panier-3.png") no-repeat; }
	a.print{ background: transparent url("../images/pict_actionprint_gray.gif") no-repeat; }
	a.pmoins{ background: transparent url("../images/pict_actionsmaller_gray.gif") no-repeat; }
	a.pplus{ background: transparent url("../images/pict_actionlarger_gray.gif") no-repeat; }
	
	.widget ul li, .colorwidget ul li{
		background:transparent url("../images/puce_gray_right.gif") no-repeat scroll 8px 7px;
	}
	
	.colorwidget h2{
		color: #6C6C6D;
		border-bottom:3px solid #6C6C6D;
	}
	
	.menu-bottom h4{
		color:#6C6C6D;
	}
	
	.module h2, .aroundTitle h2, span.title, .module h1{
		border-left:solid #6C6C6D 5px;

	}
	
	.liste ul li{
		background: url("../images/puce_gray_square.png") no-repeat scroll 6px 7px transparent;
	}
	
	.blocimage{
		/*
		background:#6C6C6D 0 0 no-repeat;
		*/
		background:#fff 0 0 no-repeat;
	}

	.blocimage .bloctexte{
		color:#454545;
	}
	
	.formline .left{
		color:#6C6C6D;
	}
	
	.formline button.submit{
		background: transparent url("../images/btn_rechercher_gray.png") no-repeat;
	}
	
	.form button.submit:active{ background: transparent url("../images/btn_rechercher_gray_hover.png") no-repeat; }
	
	.AddToBasket{ background:transparent url("../images/ajout-porte-document-gray.png") 0 bottom no-repeat; }
	.printSelected{ background:transparent url("../images/imprimante-gray.png") 0 bottom no-repeat; }
	.sendSelected{ background:transparent url("../images/enveloppe-gray.png") 0 bottom no-repeat; }
	.deleteSelected{ background:transparent url("../images/suppression-gray.png") 0 bottom no-repeat; }
	
	.thesaurus {
		background: transparent url("../images/index_gray.gif") no-repeat;
	}

	.valeur li{
		background: url("../images/puce_gray_square.png") no-repeat scroll 0px 7px transparent;
	}
	
	
	 .contenu ul li {
	 background: url("../images/puce_gray_square.png") no-repeat scroll 6px 7px transparent;
	 }
	
	
	
	

```

</details>


---

### 📄 `sdxlib/css/color-green.css` [4.047 octets]
<a id="sdxlib-css-color-green-css"></a> [↩ Retour à l'arborescence](#tree-sdxlib-css-color-green-css)

> **Chemin relatif** : `sdxlib/css/color-green.css`  
> **Taille** : 4.047 octets  
> **Lignes** : 118  
> **Type** : css

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (118 lignes) - Cliquer pour déplier</summary>

```css
	.bgcolortheme{
		background-color:#7ab51e;
	}

	.tete #titrepage {
		/* Activer localement pour un titre sans image */
		background: #7ab51e url("../images/masque-titre-2.png") no-repeat scroll right top ;
	}
/*
	.menu{
		background: transparent url("../images/bg_menu_bottom_green.gif") repeat-x scroll center bottom;
	}
*/
	.menu ul li a{
		color: #79B41a;
	}
	/*	
	.m1:hover{ background:url(../images/menu_main_green.png) 0px 101px; }
	.m1{ background:url(../images/menu_main_green.png) 0px 2px; }
	.m2:hover{ background:url(../images/menu_main_green.png) -150px 101px; }
	.m2{ background:url(../images/menu_main_green.png) -150px 2px; }
	.m3:hover{ background:url(../images/menu_main_green.png) -300px 101px; }
	.m3{ background:url(../images/menu_main_green.png) -300px 2px; }
	.m4:hover{ background:url(../images/menu_main_green.png) -450px 101px; }
	.m4{ background:url(../images/menu_main_green.png) -450px 2px; }
	.m5:hover{ background:url(../images/menu_main_green.png) -600px 101px; }
	.m5{ background:url(../images/menu_main_green.png) -600px 2px; }
	*/
	
	.m1:hover{ background:url(../images/menu-green-base-green.png) 0px 101px; }
	.m1{ background:url(../images/menu-green-base-green.png) 0px 2px; }
	.m2:hover{ background:url(../images/menu-green-base-green.png) -150px 101px; }
	.m2{ background:url(../images/menu-green-base-green.png) -150px 2px; }
	.m3:hover{ background:url(../images/menu-green-base-green.png) -300px 101px; }
	.m3{ background:url(../images/menu-green-base-green.png) -300px 2px; }
	.m4:hover{ background:url(../images/menu-green-base-green.png) -450px 101px; }
	.m4{ background:url(../images/menu-green-base-green.png) -450px 2px; }
	.m5:hover{ background:url(../images/menu-green-base-green.png) -600px 101px; }
	.m5{ background:url(../images/menu-green-base-green.png) -600px 2px; }

	.search-tools .basket span{ 
		background: transparent url("../images/porte-document-green.png") -1px -1px no-repeat;
	}
	
	.search-tools .histo{
		background: transparent url("../images/puce_green_right.gif") no-repeat scroll 5px;
	}
	
	.stick{
		border-left:solid #7ab51e 5px;
		color:#7ab51e;
	}
	
	.box{
		background:#7ab51e url("../images/bg_bloc3c_head_empty.png");
	}
	
	a.print{ background: transparent url("../images/panier-3.png") no-repeat; }
	a.print{ background: transparent url("../images/pict_actionprint_green.gif") no-repeat; }
	a.pmoins{ background: transparent url("../images/pict_actionsmaller_green.gif") no-repeat; }
	a.pplus{ background: transparent url("../images/pict_actionlarger_green.gif") no-repeat; }
	
	.widget ul li, .colorwidget ul li{
		background:transparent url("../images/puce_green_right.gif") no-repeat scroll 8px 7px;
	}
	
	.colorwidget h2{
		color: #79B41a;
		border-bottom:3px solid #79B41a;
	}
	
	.menu-bottom h4{
		color:#7AB51E;
	}
	
	.module h2, .aroundTitle h2, span.title, .module h1{
		border-left:solid #7ab51e 5px;

	}
	
	.liste ul li{
		background: url("../images/puce_green_square.png") no-repeat scroll 6px 7px transparent;
	}
	
	.blocimage{
		background:#7ab51e 0 0 no-repeat;
	}
	
	.formline .left{
		color:#5b8e28;
	}
	
	.formline button.submit{
		background: transparent url("../images/btn_rechercher.png") no-repeat;
	}
	
	.form button.submit:active{ background: transparent url("../images/btn_rechercher_hover.png") no-repeat; }
	
	.AddToBasket{ background:transparent url("../images/ajout-porte-document-green.png") 0 bottom no-repeat; }
	.RemoveFromBasket{ background:transparent url("../images/retrait-porte-document-green.png") 0 bottom no-repeat; }
	.printSelected{ background:transparent url("../images/imprimante-green.png") 0 bottom no-repeat; }
	.sendSelected{ background:transparent url("../images/enveloppe-green.png") 0 bottom no-repeat; }
	.deleteSelected{ background:transparent url("../images/suppression-green.png") 0 bottom no-repeat; }
	
	.thesaurus {
		background: transparent url("../images/index_green.gif") no-repeat;
	}

	.valeur li{
		background: url("../images/puce_green_square.png") no-repeat scroll 0px 7px transparent;
	}
	
	
	
	
	
	

```

</details>


---

### 📄 `sdxlib/css/color-purple.css` [4.065 octets]
<a id="sdxlib-css-color-purple-css"></a> [↩ Retour à l'arborescence](#tree-sdxlib-css-color-purple-css)

> **Chemin relatif** : `sdxlib/css/color-purple.css`  
> **Taille** : 4.065 octets  
> **Lignes** : 122  
> **Type** : css

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (122 lignes) - Cliquer pour déplier</summary>

```css
	.bgcolortheme{
		background-color:#5b509c;
	}

	.tete #titrepage {
		/* Activer localement pour un titre sans image */
		background: #5b509c url("../images/masque-titre-2.png") no-repeat scroll right top ;
	}
/*
	.menu{
		background: transparent url("../images/bg_menu_bottom_purple.gif") repeat-x scroll center bottom;
	}
*/
	.menu ul li a{
		color: #5b509c;
	}
	/*	
	.m1:hover{ background:url(../images/menu_main_purple.png) 0px 101px; }
	.m1{ background:url(../images/menu_main_purple.png) 0px 2px; }
	.m2:hover{ background:url(../images/menu_main_purple.png) -150px 101px; }
	.m2{ background:url(../images/menu_main_purple.png) -150px 2px; }
	.m3:hover{ background:url(../images/menu_main_purple.png) -300px 101px; }
	.m3{ background:url(../images/menu_main_purple.png) -300px 2px; }
	.m4:hover{ background:url(../images/menu_main_purple.png) -450px 101px; }
	.m4{ background:url(../images/menu_main_purple.png) -450px 2px; }
	.m5:hover{ background:url(../images/menu_main_purple.png) -600px 101px; }
	.m5{ background:url(../images/menu_main_purple.png) -600px 2px; }
	*/
	
	.m1:hover{ background:url(../images/menu-purple-base-green.png) 0px 101px; }
	.m1{ background:url(../images/menu-purple-base-green.png) 0px 2px; }
	.m2:hover{ background:url(../images/menu-purple-base-green.png) -150px 101px; }
	.m2{ background:url(../images/menu-purple-base-green.png) -150px 2px; }
	.m3:hover{ background:url(../images/menu-purple-base-green.png) -300px 101px; }
	.m3{ background:url(../images/menu-purple-base-green.png) -300px 2px; }
	.m4:hover{ background:url(../images/menu-purple-base-green.png) -450px 101px; }
	.m4{ background:url(../images/menu-purple-base-green.png) -450px 2px; }
	.m5:hover{ background:url(../images/menu-purple-base-green.png) -600px 101px; }
	.m5{ background:url(../images/menu-purple-base-green.png) -600px 2px; }

	.search-tools .basket span{ 
		background: transparent url("../images/porte-document-purple.png") -1px -1px no-repeat;
	}
	
	.search-tools .histo{
		background: transparent url("../images/puce_purple_right.gif") no-repeat scroll 5px;
	}
	
	.stick{
		border-left:solid #5b509c 5px;
		color:#5b509c;
	}
	
	.box{
		background:#5b509c url("../images/bg_bloc3c_head_empty.png");
	}
	
	a.print{ background: transparent url("../images/panier-3.png") no-repeat; }
	a.print{ background: transparent url("../images/pict_actionprint_purple.gif") no-repeat; }
	a.pmoins{ background: transparent url("../images/pict_actionsmaller_purple.gif") no-repeat; }
	a.pplus{ background: transparent url("../images/pict_actionlarger_purple.gif") no-repeat; }
	
	.widget ul li, .colorwidget ul li{
		background:transparent url("../images/puce_purple_right.gif") no-repeat scroll 8px 7px;
	}
	
	.colorwidget h2{
		color: #5b509c;
		border-bottom:3px solid #5b509c;
	}
	
	.menu-bottom h4{
		color:#7AB51E;
	}
	
	.module h2, .aroundTitle h2, span.title, .module h1{
		border-left:solid #5b509c 5px;

	}
	
	.liste ul li{
		background: url("../images/puce_purple_square.png") no-repeat scroll 6px 7px transparent;
	}
	
	.blocimage{
		background:#5b509c 0 0 no-repeat;
	}
	
	.formline .left{
		color:#5b509c;
	}
	
	.formline button.submit{
		background: transparent url("../images/btn_rechercher-purple.png") no-repeat;
	}
	
	.form button.submit:active{ background: transparent url("../images/btn_rechercher_hover-purple.png") no-repeat; }
	
	.AddToBasket{ background:transparent url("../images/ajout-porte-document-purple.png") 0 bottom no-repeat; }
	.printSelected{ background:transparent url("../images/imprimante-purple.png") 0 bottom no-repeat; }
	.sendSelected{ background:transparent url("../images/enveloppe-purple.png") 0 bottom no-repeat; }
	.deleteSelected{ background:transparent url("../images/suppression-purple.png") 0 bottom no-repeat; }
	
	.thesaurus {
		background: transparent url("../images/index_purple.gif") no-repeat;
	}

	.valeur li{
		background: url("../images/puce_purple_square.png") no-repeat scroll 0px 7px transparent;
	}
	
	.contenu p.warn{
/*
		background-color:  #f2f1f7; 
*/
		background-color:  #dfdbef; 
	}


	
	

```

</details>


---

### 📄 `sdxlib/css/jquery-ui/jquery-ui-1.10.3.custom.css` [2.888 octets]
<a id="sdxlib-css-jquery-ui-jquery-ui-1-10-3-custom-css"></a> [↩ Retour à l'arborescence](#tree-sdxlib-css-jquery-ui-jquery-ui-1-10-3-custom-css)

> **Chemin relatif** : `sdxlib/css/jquery-ui/jquery-ui-1.10.3.custom.css`  
> **Taille** : 2.888 octets  
> **Lignes** : 169  
> **Type** : css

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (169 lignes) - Cliquer pour déplier</summary>

```css
/*! jQuery UI - v1.10.3 - 2013-06-04
* http://jqueryui.com
* Includes: jquery.ui.core.css, jquery.ui.autocomplete.css, jquery.ui.menu.css
* Copyright 2013 jQuery Foundation and other contributors Licensed MIT */

/* Layout helpers
----------------------------------*/
.ui-helper-hidden {
	display: none;
}
.ui-helper-hidden-accessible {
	border: 0;
	clip: rect(0 0 0 0);
	height: 1px;
	margin: -1px;
	overflow: hidden;
	padding: 0;
	position: absolute;
	width: 1px;
}
.ui-helper-reset {
	margin: 0;
	padding: 0;
	border: 0;
	outline: 0;
	line-height: 1.3;
	text-decoration: none;
	font-size: 100%;
	list-style: none;
}
.ui-helper-clearfix:before,
.ui-helper-clearfix:after {
	content: "";
	display: table;
	border-collapse: collapse;
}
.ui-helper-clearfix:after {
	clear: both;
}
.ui-helper-clearfix {
	min-height: 0; /* support: IE7 */
}
.ui-helper-zfix {
	width: 100%;
	height: 100%;
	top: 0;
	left: 0;
	position: absolute;
	opacity: 0;
	filter:Alpha(Opacity=0);
}

.ui-front {
	z-index: 100;
}


/* Interaction Cues
----------------------------------*/
.ui-state-disabled {
	cursor: default !important;
}


/* Icons
----------------------------------*/

/* states and images */
.ui-icon {
	display: block;
	text-indent: -99999px;
	overflow: hidden;
	background-repeat: no-repeat;
}


/* Misc visuals
----------------------------------*/

/* Overlays */
.ui-widget-overlay {
	position: fixed;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
}
.ui-autocomplete {
	position: absolute;
	top: 0;
	left: 0;
	cursor: default;
}
.ui-menu {
	list-style: none;
	padding: 2px;
	margin: 0;
	display: block;
	outline: none;
	border: 1px solid #999;
	background-color: white;
	overflow: hidden;
}
.ui-menu .ui-menu {
	margin-top: -3px;
	position: absolute;
}
.ui-menu .ui-menu-item {
	margin: 0;
	padding: 0;
	width: auto;
	/* support: IE10, see #8844 */
	list-style-image: url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7);
	overflow: hidden;
}
.ui-menu .ui-menu-divider {
	margin: 5px -2px 5px -2px;
	height: 0;
	font-size: 0;
	line-height: 0;
	border-width: 1px 0 0 0;
}
.ui-menu .ui-menu-item a {
	text-decoration: none;
	display: block;
	padding: 2px .4em;
	line-height: 1.5;
	min-height: 0; /* support: IE7 */
	font-weight: normal;
}
.ui-menu .ui-menu-item a.ui-state-focus,
.ui-menu .ui-menu-item a.ui-state-active {
	font-weight: normal;
	margin: -1px;
	background-color: black;
        color: white;
}

.ui-menu .ui-state-disabled {
	font-weight: normal;
	margin: .4em 0 .2em;
	line-height: 1.5;
}
.ui-menu .ui-state-disabled a {
	cursor: default;
}

/* icon support */
.ui-menu-icons {
	position: relative;
}
.ui-menu-icons .ui-menu-item a {
	position: relative;
	padding-left: 2em;
}

/* left-aligned */
.ui-menu .ui-icon {
	position: absolute;
	top: .2em;
	left: .2em;
}

/* right-aligned */
.ui-menu .ui-menu-icon {
	position: static;
	float: right;
}

```

</details>


---

### 📄 `sdxlib/css/jquery-ui/jquery-ui-1.10.3.custom.min.css` [2.008 octets]
<a id="sdxlib-css-jquery-ui-jquery-ui-1-10-3-custom-min-css"></a> [↩ Retour à l'arborescence](#tree-sdxlib-css-jquery-ui-jquery-ui-1-10-3-custom-min-css)

> **Chemin relatif** : `sdxlib/css/jquery-ui/jquery-ui-1.10.3.custom.min.css`  
> **Taille** : 2.008 octets  
> **Lignes** : 6  
> **Type** : css

```css
/*! jQuery UI - v1.10.3 - 2013-06-04
* http://jqueryui.com
* Includes: jquery.ui.core.css, jquery.ui.autocomplete.css, jquery.ui.menu.css
* Copyright 2013 jQuery Foundation and other contributors Licensed MIT */

.ui-helper-hidden{display:none}.ui-helper-hidden-accessible{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.ui-helper-reset{margin:0;padding:0;border:0;outline:0;line-height:1.3;text-decoration:none;font-size:100%;list-style:none}.ui-helper-clearfix:before,.ui-helper-clearfix:after{content:"";display:table;border-collapse:collapse}.ui-helper-clearfix:after{clear:both}.ui-helper-clearfix{min-height:0}.ui-helper-zfix{width:100%;height:100%;top:0;left:0;position:absolute;opacity:0;filter:Alpha(Opacity=0)}.ui-front{z-index:100}.ui-state-disabled{cursor:default!important}.ui-icon{display:block;text-indent:-99999px;overflow:hidden;background-repeat:no-repeat}.ui-widget-overlay{position:fixed;top:0;left:0;width:100%;height:100%}.ui-autocomplete{position:absolute;top:0;left:0;cursor:default}.ui-menu{list-style:none;padding:2px;margin:0;display:block;outline:0}.ui-menu .ui-menu{margin-top:-3px;position:absolute}.ui-menu .ui-menu-item{margin:0;padding:0;width:100%;list-style-image:url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)}.ui-menu .ui-menu-divider{margin:5px -2px 5px -2px;height:0;font-size:0;line-height:0;border-width:1px 0 0}.ui-menu .ui-menu-item a{text-decoration:none;display:block;padding:2px .4em;line-height:1.5;min-height:0;font-weight:400}.ui-menu .ui-menu-item a.ui-state-focus,.ui-menu .ui-menu-item a.ui-state-active{font-weight:400;margin:-1px}.ui-menu .ui-state-disabled{font-weight:400;margin:.4em 0 .2em;line-height:1.5}.ui-menu .ui-state-disabled a{cursor:default}.ui-menu-icons{position:relative}.ui-menu-icons .ui-menu-item a{position:relative;padding-left:2em}.ui-menu .ui-icon{position:absolute;top:.2em;left:.2em}.ui-menu .ui-menu-icon{position:static;float:right}
```


---

### 📄 `sdxlib/css/jquery.autocomplete.css` [744 octets]
<a id="sdxlib-css-jquery-autocomplete-css"></a> [↩ Retour à l'arborescence](#tree-sdxlib-css-jquery-autocomplete-css)

> **Chemin relatif** : `sdxlib/css/jquery.autocomplete.css`  
> **Taille** : 744 octets  
> **Lignes** : 39  
> **Type** : css

```css
/**
 * @fileOverview CSS for jquery-autocomplete, the jQuery Autocompleter
 * @author <a href="mailto:dylan@dyve.net">Dylan Verheul</a>
 * @license MIT | GPL | Apache 2.0, see LICENSE.txt
 * @see https://github.com/dyve/jquery-autocomplete
 */
.acResults {
	padding: 0px;
	border: 1px solid WindowFrame;
	background-color: Window;
	overflow: hidden;
}

.acResults ul {
	margin: 0px;
	padding: 0px;
	list-style-position: outside;
	list-style: none;	
}

.acResults ul li {
	margin: 0px;
	padding: 2px 5px;
	cursor: pointer;
	display: block;
	font: menu;
	font-size: 12px;
	overflow: hidden;
}

.acLoading {
	background : url('../images/indicator.gif') right center no-repeat;
}

.acSelect {
	background-color: Highlight;
	color: HighlightText;
}

```


---

### 📄 `sdxlib/css/pandoc-base.css` [25.651 octets]
<a id="sdxlib-css-pandoc-base-css"></a> [↩ Retour à l'arborescence](#tree-sdxlib-css-pandoc-base-css)

> **Chemin relatif** : `sdxlib/css/pandoc-base.css`  
> **Taille** : 25.651 octets  
> **Lignes** : 1452  
> **Type** : css

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (1452 lignes) - Cliquer pour déplier</summary>

```css
/* http://meyerweb.com/eric/tools/css/reset/ 
   v2.0 | 20110126
   License: none (public domain)
   
   START
*/

html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, embed, 
figure, figcaption, footer, header, hgroup, 
menu, nav, output, ruby, section, summary,
time, mark, audio, video {
	margin: 0;
	padding: 0;
	border: 0;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section {
	display: block;
}
body {
	line-height: 1;
}
ol, ul {
	list-style: none;
}
blockquote, q {
	quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: '';
	content: none;
}
table {
	border-collapse: collapse;
	border-spacing: 0;
}

strong{
	font-weight:bold;
}
/* 
	END
	
   http://meyerweb.com/eric/tools/css/reset/ 
   v2.0 | 20110126
   License: none (public domain)
*/



/* Styles généraux
=========================== */

	body {
		background: #fff;
		background-image: url("../images/bg_body.gif");
		background-repeat: repeat-x;
		font: 12px/21px Arial, sans-serif;
		color: #454545;
		-webkit-font-smoothing: antialiased;
		-webkit-text-size-adjust: 100%;
		margin-top:15px;
	}
	
	a {
    color: #454545;
    text-decoration: none;
}

	input[type="text"],
	input[type="password"],
	input[type="email"],
	textarea,
	select {
		border: 1px solid #ccc;
		outline:none;
	}

	
	 /* Structure
=========================== */

	.container	{ position: relative; width: 980px; margin: 0 auto; padding: 0; }
/*	.container:after { display: block; height: 0; clear: both; visibility: hidden; }
	*/
	.cols3-1,
	.cols3-2,
	.cols3-3,
	.colsleft2-1,
	.colsleft2-2,
	.colsright2-1,
	.colsright2-2	{float: left; display: inline; margin-left: 0px; margin-right: 0px;}

	.cols3-1	{width: 190px;}
	.cols3-2	{width: 562px;}
	.cols3-3	{width: 228px;}
	
	.colsleft2-1	{width: 190px;}
	.colsleft2-2	{width: 790px;}

	.colsright2-1	{width: 752px;}
	.colsright2-2	{width: 228px;}
	
	.clear {
		clear: both;
		display: block;
		overflow: hidden;
		visibility: hidden;
		width: 0;
		height: 0;
	}
	
	.space {
		clear: both;
		display: block;
		overflow: hidden;
		visibility: hidden;
		width: 0;
		height: 0;
		margin: 10px 0 10px;
	}
	
	
	.page{
			background: #fff url("../images/bg_top.gif") repeat-x;
	}
	 
	.tete {
		/*background: transparent url("../images/bg_gerbe_court.png") no-repeat scroll right 10px bottom ;*/
		/*background: transparent url("../images/flammes-low.png") no-repeat scroll right 20px bottom 10px ;*/
		/*height: 190px;*/
		height: 154px;
	}

	/*.tete img{margin: 25px 25px 0px 25px;float:left;}*/
	.tete img{margin: 13px 25px 0px 25px;float:left;}
	
	.tete #titrepage {
		float:left;
		height:154px;
		width:600px;
	/*	background-image:url("../images/masque-titre-photo.png");*/
	}
	
	.tete #titrepage span{
		display:inline-block;
		font-size:30px;
		color:#fff;
		font-weight:bold;
		font-variant:small-caps;
		margin:110px 0 0 25px;
	}

	.menu-head{
		background: transparent url("../images/bg_gerbe_court.png") no-repeat bottom right ;
		float:left;
		/*height: 190px;*/
		height: 154px;
		width:230px;
	}
	
	.menu-head ul{
		margin:25px 0px 0 0px;
		padding:0 10px 10px 10px;
		background: url("../images/bg_menu-head.png") repeat-x scroll left bottom transparent ;
		float:right;
		height: 30px;
	}
	
	.menu-head ul li{
		display:inline;
	}
	
	.menu-head ul li.leftpipe{
		border-left:solid 1px #444;
		padding-left:5px;
		margin-left:5px;
	}
	
	.menu-head ul li a{
		color: #454545;
		font-weight:bold;
		font-family: arial,helvetica,verdana,sans-serif;
	}
	
	.menu-head ul li a:hover{
		text-decoration: underline;
	}
	
	.menu{
		min-height: 35px; 
		height:auto !important; 
		height: 35px; 
		background: transparent url("../images/bg_menu_bottom_green.gif") repeat-x scroll center bottom;
	}
	
	.menu ul{
		height:100px;
		width:100%;
	}
	
	.menu ul li{
		display:block;
		height:100px;
		width:150px;	
		float:left;
	}

	.menu ul li a{
		display:block;
		height:100px;
		width:150px;
		/*float:left;*/
		/*margin-left:20px;*/
		text-align:center;
	
/*		vertical-align:top;*/
		font-size:12px;
		font-weight:bold;
		text-transform:uppercase;
	}
	
	.menu ul li a span{
		display:inline-block;
		margin-top:5px;
		background-color:#fff;
	}
	
	.search-tools {
		display:inline-block;
		float:right;
		margin-right:5px;
	}
	
	.search-tools  .basket, .search-tools  .histo{
		float:right;
		margin-left:20px;
		font-size:11px;
		position:relative;
		top:-10px;
	}

	.search-tools  .basket:hover, .search-tools  .histo:hover{
		text-decoration:underline;
	}
	
	.search-tools .basket{ 
		padding-left: 0px;
	}
	.search-tools .basket span{ 
	   display:inline-block;
	   width:18px;
	   color: #FFFFFF;
	   padding-right:9px;
	   font-size: 9px;
	   font-weight:bold;
	   text-align:right;
	}
	
	.search-tools .histo{
		padding-left: 15px;
	}
	
	.ariane{
		display:inline-block;
		width:60%;
		float:left;
	}
	
	
	
	/*.menu ul li a:hover{
		background:url(../images/menu-test-green.png) 0px 1px;
	}*/
	
	.corp{
			background-color: #fff;
		}
		
	.header-corp{
		/*height:46px;*/
		min-height: 46px; 
		height:auto !important; 
		height: 46px;
		/*background: transparent url("../images/bg_bloc_head.gif") bottom no-repeat;*/
		background: transparent url("../images/bg_bloc3c_head_full.png") bottom no-repeat;
	}
				
	/* 	.header-corp h1.box {*/
	.box{
		height:35px;
		float:left;
		/*overflow:hidden;*/
		display:inline-block;
		padding:9px 20px 0 20px;
		font-size:18px;
		font-weight:bold;
		color:#fff;
		margin-left:10px;
		text-transform:uppercase;
		}
	
	/*.header-corp h1.stick{*/
	.stick{
		float:left;
		max-width:675px;
		overflow:hidden;
		display:inline-block;
		margin:0 0 5px 20px;
		padding: 0px 0 0 7px;
		font-size:20px;
		}

	.header-corp .tools {
		float:right;
		padding:0;
		position:relative;
		top:10px;
	}
	
	.header-corp .tools a {
		margin:0 10px 0 0;
		padding:0;
	}
	
	.header-corp .tools a {
		display:inline-block;
		/*border: solid 1px #ccc;*/
		width:19px;
		height:15px;
		
	}

	.pied{
		/*background: transparent url("../images/bg_bottom.png") repeat-x scroll left bottom ;*/
		background: transparent url("../images/footer_bg.jpg") repeat-x;
	}
	
	.pied .maj{
		text-align:center;
		position:relative;
		top:25px;
	}
	
	.pied h3 {
		padding:10px 0 0px 30px;
		color:#fff;
		height:38px;
		background: url("../images/bg_footer.png") no-repeat top transparent;
	}
	
	.pied h3:hover{ cursor: pointer; }	
	
	.pied h3 span{
		padding:0 0 0 15px;
	}
	
	.pied h3 span.close{
		background: url("../images/puce_right-grey.png") no-repeat scroll left 3px transparent;
	}

	.pied h3 span.open{
		background: url("../images/puce_down-grey.png") no-repeat scroll left 3px transparent;
	}
	
	.rightcol{
		background: #fff url("../images/bg_rightcol.gif") repeat-y scroll right top;
	}
	
	.rightcol .filler{
		height:9px;
		width:1px;
		border-left:solid 1px #ccc;
		position:relative;
		top:-9px;
		left:752px;
	}

   	.copyright{
		padding: 18px 0 18px 0;
		font-size:11px;
	}

	.copyright, .bottom-links{
		text-align:center;
		background-color:#ececeb;
		}

	.onglet {width:120px; height:20px; float: right; background: transparent url("../images/onglet.png") no-repeat; margin-right:1px; color:#164c94; font-size:10px; text-align:center; margin-top:6px;}
	.onglet a{ color: #164c94; }
	.onglet a:hover{ text-decoration: underline; }
	
	.onglet_bk {min-width:60px; height:26px; float: left; background: transparent url("../images/onglet_bk.png") no-repeat center; border-right: 1px solid #B5B1AC; color:#fff; font-size:13px; text-align:center; padding:0 15px;}
	
	.onglet_bk a{ color: #fff; }
	.onglet_bk a:hover{ text-decoration: underline; }
	
	
	
	
	/* Modules
=========================== */
	
	
	.widget{
		width:90%;
		margin:5% 10px 0 5%;
		border: solid 1px #CACACA;
		overflow:hidden;
	}
	
	.widget h2{
		background: #6C6C6D url("../images/pict_h2pict1.gif") no-repeat scroll 5px;
		color: #fff;
		font-weight: bold;
		font-size:14px;
		padding: 5px 5px 5px 27px;
		margin-bottom:4px;
	}
	
	.widget ul li, .colorwidget ul li{
		padding-left:16px;
		overflow:hidden;
		word-wrap: break-word;
	}
	
	.widget ul li a, .colorwidget ul li a{
		font-size:11px;
		overflow:hidden;
	}
	
	.widget ul li a:hover, .colorwidget ul li a:hover{ text-decoration: underline; }
	
	.colorwidget{
		background: url("../images/bg_widget.gif") repeat-x scroll left top transparent;
		width:90%;
		margin:5% 10px 0 5%;
		border: solid 1px #CACACA;
		overflow:hidden;
	}
	
	.colorwidget h2{
		font-weight: bold;
		font-size:14px;
		padding: 10px 3px 5px 7px;
		margin: 0 5px 4px 5px;
	}
	
	.footer{
		display:none;
	}
	
	.menu-footer{
		display:block;
		width:12%;
		float:left;
		padding: 0 0 30px 30px;
	}
	
	.menu-footer h4{
		font-size:12	px;
		font-family:verdana;
		font-weight:bold;
		font-variant:small-caps;
	}

	.menu-footer ul li{
		color:#454545;
		font-size:9px;
		font-family:verdana;
	}
	
	.blocmodule{
		/*border:1px solid #ccc;*/
		width:90%;
		margin-top:20px;
		margin:auto;
		padding: 20px 10px 0px 10px;
	}
	
	.module{
		/*border:1px solid #ccc;*/
		width:94%;
		/*margin-top:20px;*/
		margin:auto;
		padding: 0px 10px 0px 10px;
		background: url("../images/bg_form-2.png") repeat-x scroll left bottom transparent;
	}
	
	.splitdisplay{
		width:100%;
		clear:both;
	}
	
	.split{
			width:50%;
			float:left;
	}
	
	
	.form{
		padding-top:20px;
		padding-bottom:30px;
	}
	
	div.form hr{
		margin-bottom:30px;
	}
	
	.form .chapeau{
		margin-bottom:0px;
		padding:10px;
		/*border:solid 1px #bbb;*/
		position:relative;
		top:-30px;
	}
	
	.form .chapeau a{ text-decoration:underline;}
	
	.formline{
		margin: 0 10px 10px 0;
	}
	
	.formline .left{
		font-family: Arial;
		font-weight:bold;
		font-size: 12px;
		font-variant:small-caps;	
		display:inline-block;
		width:20%;
		text-align:right;
		margin-right:5%;
	}

	.formline .center{
		width:40%;
		display:inline-block;
		margin-right:2%;
	}
	
	.formline .right{
		width:10%;
		display:inline-block;
		margin-right:2%;
	}
	
	.formline .date{
		width:auto;
	}

	.date-range select{
		margin-right:5px;
	}


	.range_wrapper{
		margin-left:3px;
	}

	.range_wrapper input{
		margin:1px;
	}

	.oneDay_wrapper{
		margin-left:5px;
	}
	
	.formline span.texte{
		margin-right:1%;
	}
	
	.formline .thesaurus{
		display:inline-block;
		border:none;
		width:29px;
		height:20px;
	}

	.formline button.submit{
		height: 50px;
		width: 186px;
		border:none;
		/*margin-left:70%;*/
		float:right;
		clear:right;
	}

	.formline button.reset{
		border-radius: 7px;
		-moz-border-radius: 7px;
		-webkit-border-radius: 7px;
		height: 30px;
		width: 136px;
		border:solid 1px #fff;
		box-shadow: 0 0 10px #888;
		margin-top:12px;
		float:left;
		/*
		background-color:#00A8B5;
		color:#fff;
		*/
		font-variant:small-caps;
	}

	.formline .oneDay_wrapper{
		width:auto;
		display:inline-block;
		margin-right:2%;
	}

	.formline .range_wrapper{
		width:auto;
		display:inline-block;
		margin-right:2%;
	}
	
	.radioline{
			margin:0 10px 10px 0;
	}
	
	.radioline div input{
		vertical-align:-3px;
			
	}

	.form button:hover{ cursor: pointer; }	

	div.aroundTitle {

		background: url("../images/bg_h2.gif") no-repeat scroll left bottom transparent;
		height: 40px;
		width: 100%;
		margin:0 0 20px 0;

	}
	
	.module h2, .aroundTitle h2, span.title, .module h1{
		overflow:hidden;
		display:inline-block;
		padding: 0px 0 0 7px;
		font-size:18px;
		width: 94%;
	}

	.aroundTitle h2 {
		width:450px;
	}
	
	.module hr{
		display: block;
		height: 1px;
		border: 0;
		border-top: 1px solid #ccc;
		margin-bottom:0px;
	}
	
	.liste {
		border:solid 1px #ccc;
		padding-bottom:15px;
		margin-bottom:30px;
		padding-top:20px;
		width:90%;
	}
	
	.liste h2{
		color:#454545;
	}
	
	.liste hr{
		margin-bottom:0px;
	}
	
	.liste ul{
		padding:10px;
	}
	
	.liste ul li{
		padding-left:18px;
	}
	
	.liste ul li.resultdata{
        list-style-type:none;
        background:none;
	}
	
	.liste ul li a:hover{ text-decoration:underline; }
	
	.texte{
		width:100%;
		margin: 10px 0 20px 0;
		/*
		-moz-box-shadow: 0 0 3px 1px rgba(0,0,0,.2);
		-webkit-box-shadow: 0 0 3px 1px rgba(0,0,0,.2);
		box-shadow:  0 0 3px 3px rgba(0,0,0,.2);
		*/
		padding:15px 15px 15px 15px;
		/*color:#fff;*/
		font-size:12px;		
	}
	
	.blocimage{
		height:234px;
		width:100%;
		margin: 10px 0 20px 0;
		-moz-box-shadow: 0 0 3px 1px rgba(0,0,0,.2);
		-webkit-box-shadow: 0 0 3px 1px rgba(0,0,0,.2);
		box-shadow:  0 0 3px 3px rgba(0,0,0,.2);
		
	}

	.blocimage .bloctexte{
		padding:15px 15px 15px 0;
		margin-left:290px;
		color:#fff;
		font-size:12px;
	}
	
	.results{
		/*margin-top:20px;*/
		background: #fff;
	}

	.results .noresults{
		margin: 12px 0 0 0;
		border: solid 1px #ccc;
		padding:15px;
		text-align:center;
	}
	
	.results ul li{
		width:100%;
		min-height: 40px; 
		height:auto !important; 
		height: 40px; 
		padding:20px 0 10px 5px;
		background:transparent url("../images/bg_result.png") 0 0 no-repeat;
		/*background-image:url("../images/bg_home_spt.png");
		background-position: -268px -239px;*/
		clear:both;
	}
	
	.results ul li a{
		font-family:arial;
		font-size:14px;
		font-weight:bold;
		display:inline-block;
		float:left;*/
		width:80%;
		margin-bottom:10px;
	}

	.results ul li a:hover{ text-decoration:underline; }
	
	.results ul li span.order{
		color:#bbb;
		display:inline-block;
		float:left;	
		width:20px;
		padding:0 5px 0 0;
	}
	
	.results ul li span.sousTitre{
		display:inline-block;
		float:left;	
		clear:both;
		position:relative;
		top:-10px;
		font-size:11px;
		padding-bottom:15px;
	}
	
	.results ul li.synthese span.sousTitre{
		display:none;
	}
	
	
	.results table{
		border:1px solid #D3D3D3;
		width:100%;
	}

	.results table tr.odd{
		background-color:#f0f0f0;
	}
	
	.results table tr th{
		/*background-color:#D1EFF1;*/
		/*background: #00a8b5 url("../images/table_header.png") 0 bottom repeat-x;*/
		background: #fff url("../images/bg_criteres_h2.gif") 0 bottom repeat-x;	
		border-left:1px solid #D3D3D3;
		border-right:1px solid #D3D3D3;
		padding:5px;
		font-weight:bold;
		vertical-align: middle;
	}
	
	.results table tr th a{
		text-decoration:underline;
	}

	.results table tr th a.sort-arrow img{
		margin:0 5px 0 5px;
	}
	
	.results table tr td{
		border-left:1px solid #D3D3D3;
		border-right:1px solid #D3D3D3;
		padding:5px;
		vertical-align: middle;
	}

	.results table tr td.date{
		text-align: right;
	}
	
	.results .liste-resultat {
		display:block;
		background:transparent url("../images/bg_result.png") 0 0 no-repeat;
		min-height: 70px;
		margin : 5px 0 5px 0;
	}

	.results .liste-resultats .liste-resultat .coche-resultats{
		margin:15px;
		display:block;
		width:30px;
		float:left;        
	}

	.results .liste-resultats .liste-resultat .contenu-resultats-header{
		padding-top:15px;
		display:block;
		margin-left:30px;
	}

	.results .liste-resultats .liste-resultat .contenu-resultats-header span a{
		display:block;
		font-weight:bold;
	}

	.results .liste-resultats .liste-resultat .contenu-resultats{
		display:block;
		margin-left:60px;
	}	
	.results .liste-resultats .liste-resultat .contenu-resultats span{
		display:block;
	}	
	
	.results .query {
		margin-bottom:12px;
		position:relative;
		top:-20px;
		
	}

	.results .queryselect{
		margin-bottom:12px;
		position:relative;
		top:-20px;
		font-size:14px;
		color:#454545;
		font-weight:bold;
	}

	.results form .chapeau{
		margin:0 0 18px 0;
		padding:3px;
		text-align:center;
		border:solid 1px #ccc;
		font-weight:bold;
		
	}
	
	.results .pagination {
		/*border-bottom:solid 1px #ccc;*/

		padding: 5px 0 5px 0;
	}
	
	.pagination .pages{
		display:inline-block;
		font-weight:bold;
		float:left;
	}

	.pagination .hppSelector{
		display:inline-block;
		font-weight:bold;
		float:left;
		margin-left:50px
	}
	
	.pagination .suivantes{
		display:inline-block;
		float:right;
		font-size:14px;
	}


	.pagination .suivantes a{  color:#454545; }
	.pagination .suivantes a:hover{  text-decoration:underline; }
	
	.pagination .suivantes .page_courante{  color:#B82A2A; }
	
	.results .tri , .liste .tri {
		margin-bottom:12px;
		padding: 5px 0 5px 0;
	}
	
	.results .tri span,  .liste .tri span{
		margin:0 0 0 7px;
	}
			
	.results .tri span a,  .liste .tri span a{
		padding: 0 5px 0 7px;
		margin:0 0 0 5px;
		background:transparent url("../images/puce_grey_right.gif") 0 5px no-repeat;
	}
	
	.results .tri span a:hover,  .liste .tri span a:hover{
		text-decoration:underline;
	}
	
	.context-tools{
		float:right;
		clear:both;
	}
	
	.context-tools *{
		margin-left:5px;
	}

	.AddToBasket, .RemoveFromBasket{
		/*background:transparent url("../images/ajout-panier-round-blue-medium.png") 0 bottom no-repeat;*/
		display:inline-block;
		width:26px;
		height:26px;
		/*border:solid 1px #ccc;*/
	}

	
	.doc .AddToBasket, .doc .RemoveFromBasket{
		float:right;
	}
	.doc .sendSelected{
		float:right;
	}
	
	.deleteSelected{
		/*background:transparent url("../images/ajout-panier-round-blue-medium.png") 0 bottom no-repeat;*/
		display:inline-block;
		width:26px;
		height:26px;
		border:none;
		padding:0;
		margin-bottom:0;
		position:relative;
		top:3px;
	}
	
	.deleteSelected:hover{ cursor: pointer; }
	
	.printSelected{
		/*background:transparent url("../images/print_selected_blue_medium.png") 0 bottom no-repeat;*/
		display:inline-block;
		width:26px;
		height:26px;
		/*border:solid 1px #ccc;*/
	}
	
	.sendSelected{
		/*background:transparent url("../images/print_selected_blue_medium.png") 0 bottom no-repeat;*/
		display:inline-block;
		width:26px;
		height:26px;
		/*border:solid 1px #ccc;*/
	}

	.exportPdf{
		display:inline-block;
		width:16px;
		height:23px;
		background:transparent url("../images/telecharger.png") -5px 0px no-repeat;
	}
	
	.doc{
		width:90%;
		/*border:solid 1px #ccc;*/
		/*box-shadow:1px 1px 5px -2px;*/
		margin-bottom:30px;
	}
	
	.doc .chapeau{
		margin-bottom:30px;
		padding:10px;
		border:solid 1px #bbb;
	}
	
	.doc .chapeau a{ text-decoration:underline;}
	
	.doc h2, .doc h1{
		width:88%;
		color:#454545;
	}
	
	.retour-top{
		float:left;
		margin-left:8px;
		position:relative;
		top:14px;
	}
	
	.retour{
		width:100%;
		height:18px;;
		clear:both;
		border-top: 1px solid #ccc;
	}
	
	.retour a,.retour-top a{
		float:right;
		font-size:10px;
	}
	
	.retour a:hover, .retour-top a:hover{
		text-decoration: underline;
	}
	
	.retour a:before, .retour-top a:before{
		font-size:12px;
		font-weight:bold;
		content: "< ";
	}
	
	.pagination-document{
		width:100%;
		display:block;
		float:left;
		/*
		border-bottom: 1px solid #ccc;
		border-top: 1px solid #ccc;
		*/
	}
	
	.pagination-document a:hover{
		text-decoration: underline;
	}
	
	.pagination-document .precedente{
		float:left;
		width:49%;
	}
	.pagination-document .precedente span{
		font-weight:bold;
	}
	
	.pagination-document .precedente span a {
		background: url("../images/puce_grey_left.gif") no-repeat scroll 8px 7px rgba(0, 0, 0, 0);
		font-size:11px;
		padding-left:14px;
	}
	
	.pagination-document .precedente a{
		display:block;
		height:20px;
		width:90%;
		overflow: hidden;
		white-space: nowrap;
		word-wrap:break-word;
		text-overflow: ellipsis;
	}
	
	.pagination-document .suivante{
		float:left;
		width:49%;
	}
	.pagination-document .suivante span{
		float:right;
		font-weight:bold;
	}
	
	.pagination-document .suivante a{
		display:block;
		height:20px;
		width:90%;
		float:right;
		overflow: hidden;
		white-space: nowrap;
		word-wrap:break-word;
		text-overflow: ellipsis;
	}
	
	.pagination-document .suivante span a {
		background: url("../images/puce_grey_right.gif") no-repeat scroll right 7px rgba(0, 0, 0, 0);
		width:100%;
		text-overflow:inherit;
		font-size:11px;
		padding-right:3px;
		
	}

	.pagination-document-sans-texte{
		width:100%;
                display:block;
                float:left;
	}

	.pagination-document-sans-texte .precedente{
		float:left;
		margin-left:95%;
	}

	.pagination-document-sans-texte .precedente span a {
		background: url("../images/puce_grey_left.gif") no-repeat scroll 8px 7px rgba(0, 0, 0, 0);
		font-size:11px;
		padding-left:14px;
	}

	.pagination-document-sans-texte .suivante{
		float:right;
		margin-right:1%;
	}

        .pagination-document-sans-texte .suivante span a {
                background: url("../images/puce_grey_right.gif") no-repeat scroll right 7px rgba(0, 0, 0, 0);
                width:100%;
                text-overflow:inherit;
                font-size:11px;
                padding-right:3px;

        }

	
	.doc .ligne{
		width:100%;
		clear:both;
	}
	
	.en1{ width:100%; }
	.en2{ width:49%; float:left; }
	.en3{ width:33%; float:left; margin-left:0.3%; }
	
	.champ{
		clear:both;
	}
	
	.champ .clef{
		display:block;
		font-weight:bold;
		float:left;
		padding: 0 5px 0 8px ;
		/*background:url(../images/tick-green.png) 0px 4px no-repeat;*/
		/*border-left: solid 3px #7AB51E;*/
		margin-bottom:2px;
		word-wrap: break-word;
		width:90px;
	}
	
	.en1 .valeur{width:78%;}
	.en2 .valeur{width:60%;}
	
	.valeur{
		display:block;
		padding: 0 5px 0 10px;
		float:left;	
	}
	
	.valeur li{
		padding-left:10px;
		display:block;
		word-wrap: break-word;
	}
	
	.valeur li a{	

	}
	
	.valeur li a:hover{	
			text-decoration:underline;
	}
	
	.champliste .valeur li{
		background: url("../images/puce_grey_right.gif") no-repeat scroll 0px 7px transparent;
		margin-bottom:6px;
		padding-left:16px;
	}

	.valeurEnLigne {
		display:block;
		padding: 0 5px 0 17px;
		float:left;	
	}
	
	.valeurEnLigne li{
		display:inline-block;
		float:left;
		padding: 0 0 0 3px;		
	}
		
	.pdflink{
		padding-left:20px;
		background:url("../images/pdf_petit.png") 0 0 no-repeat;
	}

	.pj{
		font-weight:bold;
	}

	.pj_pdf{
		padding-top:2px;
		padding-left:20px;
		background:url("../images/pdf_petit.png") 0 0 no-repeat;	
	}

	.pj_doc{
		padding-top:2px;
		padding-left:20px;
		background:url("../images/doc_petit.png") 0 0 no-repeat;	
	}

	.pj_epub{
		padding-top:2px;
		padding-left:20px;
		background:url("../images/epub_petit.png") 0 0 no-repeat;	
	}

	.lien_externe{
		padding-left:20px;
		background:url("../images/lien_externe_petit.png") 0 0 no-repeat;;
	}
	
	.docformat{
		font-weight:none;
	}
	
	
	.contenu{
		border:solid 1px #ccc;
		padding-bottom:15px;
		margin-bottom:30px;
		padding-top:20px;
		width:90%;
	}
	
	.contenu h2{
		color:#454545;
		/*
		border:none;
		padding:0;
		margin:0;
		*/
		margin:10px 0;
	}
	
	.contenu h3{
		color:#454545;
		font-size:14px;
		margin-bottom:10px;
		font-weight:bold;
	}
	
	.contenu ul li {
		background: url("../images/puce_4.png") no-repeat scroll 6px 7px transparent;
		margin:5px 0 5px 10px;
		padding-left: 16px;
	}
	
	.contenu ol{
		margin-left:10px;
	}
	
	.contenu ol li {
		/*background: url("../images/puce_4.png") no-repeat scroll 6px 7px transparent;*/
		margin:5px 0 5px 10px;
		padding-left: 5px;
		list-style-type: decimal;
	}
	
	.contenu ol li a{
		/*background: url("../images/puce_4.png") no-repeat scroll 6px 7px transparent;*/
		margin:5px 0 5px 10px;
		padding-left: 5px;
		list-style-type: decimal;
		font-weight:bold;
	}
	
	.contenu p { text-indent:10px; }
 
  	.contenu p a{ font-weight:bold;}
   	.contenu pre a{ font-weight:bold;}
 
 	.contenu a:hover{ text-decoration:underline; }
 	.contenu pre a:hover{ text-decoration:underline; }
	
	.contenu img{
		display:block;
		margin:auto;
	} 
	

	.contenu p.warn{
		padding: 10px;
		margin: 10px 0% 10px 0%;

	}
	
	.context{
		/*padding-top:20px;*/
		width:90%;
		margin:0px 0% 10px 5%;
		/*border: solid 1px #CACACA;*/
		overflow:hidden;
	}
	
	.requete span.requetetitle{
		background: #fff url("../images/bg_criteres_h2.gif") 0px bottom repeat-x;
		display:block;
		padding: 12px 8px 12px 10px;
		font-weight:bold;
		text-align:center;
		font-size:13px;
		
	}
	
	.requete h2{
		 background: none repeat scroll 0 0 #F0F0F0;
		 margin-top:4px;
		 margin-bottom: 10px;
		 padding: 12px 10px;
	}
	
	.modifier{
		float: right;
		font-size: 11px;
		position: relative;
		top: -20px;
	}

	.modifier a:hover{
	text-decoration:underline
	}

	.historique{
		border: 1px solid #ccc;
	}
	
	.historique ul li{
		background: url("../images/puce_grey_right.gif") no-repeat scroll 0px 7px transparent;
		margin-bottom:6px;
		padding-left:16px;		
	}
	
	.historique ul li a{ 
		font-size:11px;
	}

	.historique ul li a:hover{ 
		text-decoration:underline;
	}	
	
	.flush-history{
		margin:30px;
	}
	
	.flush-history input{
		background-color:#fff;
	}
	
	.flush-history input:hover{ cursor: pointer; }


#player {
	display:block;
    margin-bottom: 10px;
    width: 100%;
	height:24px;
}


ul.playlist li {
    border-bottom: 1px solid #000000;
    padding: 5px 0 5px 15px;
}

ul.playlist li:hover {
    background-color:#ccc;
}

ul.playlist li.selected {
    background:url(../images/puce_grey_right.gif) no-repeat 5px 12px;
	background-color:#eee;
}	
	
	
.galerie img{

        width:185px;
        margin-left:10px;;
	margin-top: 6px;

}
	
	
	
	
	
/* Styles particuliers
=========================== */


	.results ul li.synthese a{
		color:#5B8E28;
	}


	
/* Positionnement
=========================== */

	



	
/* Media Queries
=========================== */
	
/*
    @media only screen and (max-width: 480px) {
        .container { width: 300px; }
		.cols3-1,
		.cols3-2,
		.cols3-3,
		.cols2-1,
		.cols2-2	{width:100%}
		}
*/

```

</details>


---

### 📄 `sdxlib/images/onglet_fichiers/pandoc-base.css` [2.991 octets]
<a id="sdxlib-images-onglet_fichiers-pandoc-base-css"></a> [↩ Retour à l'arborescence](#tree-sdxlib-images-onglet_fichiers-pandoc-base-css)

> **Chemin relatif** : `sdxlib/images/onglet_fichiers/pandoc-base.css`  
> **Taille** : 2.991 octets  
> **Lignes** : 156  
> **Type** : css

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (156 lignes) - Cliquer pour déplier</summary>

```css
/* http://meyerweb.com/eric/tools/css/reset/ 
   v2.0 | 20110126
   License: none (public domain)
   
   START
*/

html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, embed, 
figure, figcaption, footer, header, hgroup, 
menu, nav, output, ruby, section, summary,
time, mark, audio, video {
	margin: 0;
	padding: 0;
	border: 0;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section {
	display: block;
}
body {
	line-height: 1;
}
ol, ul {
	list-style: none;
}
blockquote, q {
	quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: '';
	content: none;
}
table {
	border-collapse: collapse;
	border-spacing: 0;
}
/* 
	END
	
   http://meyerweb.com/eric/tools/css/reset/ 
   v2.0 | 20110126
   License: none (public domain)
*/



/* Styles généraux
=========================== */

	body {
		background: #fff;
		background-image: url("../images/bg_body.gif");
		background-repeat: repeat-x;
		font: 12px/21px Arial, sans-serif;
		color: #454545;
		-webkit-font-smoothing: antialiased;
		-webkit-text-size-adjust: 100%;
		margin-top:15px;
 }
 
.tete {
	background: #fff url("../images/bg_top.gif") repeat-x;
    /*
	background: #fff url("../images/bg_up.png") repeat-x;
	*/

    /*
	border-bottom: 6px solid #76B11B;
	*/
    height: 190px;
}

.corp{
		background-color: #ffffff;
	}

.pied{
	background-color: #fff;
    background-image: url("../images/bg_contentfooter_planbg2.gif");
    background-repeat: no-repeat;
	    height: 190px;
}

 
  
 
 /* Structure
=========================== */

	.container	{ position: relative; width: 980px; margin: 0 auto; padding: 0; }

	.cols3-1,
	.cols3-2,
	.cols3-3,
	.colsleft2-1,
	.colsleft2-2,
	.colsright2-1,
	.colsright2-2	{float: left; display: inline; margin-left: 6px; margin-right: 10px;border:solid 1px #000;}

	.cols3-1	{width: 174px;}
	.cols3-2	{width: 543px;}
	.cols3-3	{width: 208px;}
	
	.colsleft2-1	{width: 174px;}
	.colsleft2-2	{width: 769px;}

	.colsright2-1	{width: 735px;}
	.colsright2-2	{width: 208px;}
	
	.onglet {width:90px; height:15px; float: right; background: #fff url("../images/onglet.png") no-repeat;}
	
	.clear {
		clear: both;
		display: block;
		overflow: hidden;
		visibility: hidden;
		width: 0;
		height: 0;
	}
	
/* Positionnement
=========================== */

	
/* Modules
=========================== */


	
/* Media Queries
=========================== */
	
/*
    @media only screen and (max-width: 480px) {
        .container { width: 300px; }
		.cols3-1,
		.cols3-2,
		.cols3-3,
		.cols2-1,
		.cols2-2	{width:100%}
		}
*/
```

</details>


---

### 📄 `sdxlib/js/jquery/jquery.tooltip.css` [588 octets]
<a id="sdxlib-js-jquery-jquery-tooltip-css"></a> [↩ Retour à l'arborescence](#tree-sdxlib-js-jquery-jquery-tooltip-css)

> **Chemin relatif** : `sdxlib/js/jquery/jquery.tooltip.css`  
> **Taille** : 588 octets  
> **Lignes** : 34  
> **Type** : css

```css
#tooltip {
	position: absolute;
	z-index: 3000;
	border: 1px solid #111;
	background-color: #eee;
	padding: 5px;
	opacity: 0.95;
}
#tooltip h3, #tooltip div { margin: 0; }

#tooltip.tipped{
	width:20em;
	text-align:left;
	background-image:url(../images/info.png);
	background-position:center left;
	background-repeat:no-repeat;
	padding-left:25px;
}
#tooltip.tipped h3 {
	font-size: 1em;
	text-align: center;
	opacity:0.9
}

#tooltip.ntipped{
	width:20em;
	text-align:center;
}
#tooltip.ntipped h3 {
	font-size: 0.8em;
	text-align: center;
	opacity:0.9
}

```


---

### 📄 `sdxlib/js/webshims/shims/FlashCanvas/proxy.php` [2.392 octets]
<a id="sdxlib-js-webshims-shims-FlashCanvas-proxy-php"></a> [↩ Retour à l'arborescence](#tree-sdxlib-js-webshims-shims-FlashCanvas-proxy-php)

> **Chemin relatif** : `sdxlib/js/webshims/shims/FlashCanvas/proxy.php`  
> **Taille** : 2.392 octets  
> **Lignes** : 74  
> **Type** : php

```php
<?php

/**
 * Proxy script to load a file from other domain
 *
 * PHP versions 4 and 5
 *
 * Copyright (c) 2010-2011 Shinya Muramatsu
 *
 * Permission is hereby granted, free of charge, to any person obtaining a
 * copy of this software and associated documentation files (the "Software"),
 * to deal in the Software without restriction, including without limitation
 * the rights to use, copy, modify, merge, publish, distribute, sublicense,
 * and/or sell copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
 * DEALINGS IN THE SOFTWARE.
 *
 * @author     Shinya Muramatsu <revulon@gmail.com>
 * @copyright  2010-2011 Shinya Muramatsu
 * @license    http://www.opensource.org/licenses/mit-license.php  MIT License
 * @link       http://flashcanvas.net/
 * @link       http://code.google.com/p/flashcanvas/
 */

// Whether we check referrer or not
define('CHECK_REFERRER', true);

// Check that the request is from FlashCanvas
if (CHECK_REFERRER) {
    if (empty($_SERVER['HTTP_REFERER'])) {
        exit;
    }
    if (!preg_match('#/flash\d*canvas\.swf$#', $_SERVER['HTTP_REFERER'])) {
        exit;
    }
}

// Check that the request has a valid URL parameter
if (empty($_GET['url'])) {
    exit;
}
if (!preg_match('#^https?://#', $_GET['url'])) {
    exit;
}

// Percent-encode special characters in the URL
$search  = array(  '%',   '#',   ' ');
$replace = array('%25', '%23', '%20');
$url     = str_replace($search, $replace, $_GET['url']);

// Disable compression
header('Content-Encoding: none');

// Load and output the file
if (extension_loaded('curl')) {
    // Use cURL extension
    $ch = curl_init($url);
    curl_exec($ch);
    curl_close($ch);
} else {
    // Use the http:// wrapper
    readfile($url);
}

```


---

### 📄 `sdxlib/js/webshims/shims/FlashCanvas/save.php` [1.945 octets]
<a id="sdxlib-js-webshims-shims-FlashCanvas-save-php"></a> [↩ Retour à l'arborescence](#tree-sdxlib-js-webshims-shims-FlashCanvas-save-php)

> **Chemin relatif** : `sdxlib/js/webshims/shims/FlashCanvas/save.php`  
> **Taille** : 1.945 octets  
> **Lignes** : 50  
> **Type** : php

```php
<?php

/**
 * Save the input as a PNG file
 *
 * PHP versions 4 and 5
 *
 * Copyright (c) 2010-2011 Shinya Muramatsu
 *
 * Permission is hereby granted, free of charge, to any person obtaining a
 * copy of this software and associated documentation files (the "Software"),
 * to deal in the Software without restriction, including without limitation
 * the rights to use, copy, modify, merge, publish, distribute, sublicense,
 * and/or sell copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
 * DEALINGS IN THE SOFTWARE.
 *
 * @author     Shinya Muramatsu <revulon@gmail.com>
 * @copyright  2010-2011 Shinya Muramatsu
 * @license    http://www.opensource.org/licenses/mit-license.php  MIT License
 * @link       http://flashcanvas.net/
 * @link       http://code.google.com/p/flashcanvas/
 */

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    // Force download
    header('Content-Type: application/octet-stream');
    header('Content-Disposition: attachment; filename="canvas.png"');

    if (isset($_POST['dataurl'])) {
        // Decode the base64-encoded data
        $data = $_POST['dataurl'];
        $data = substr($data, strpos($data, ',') + 1);
        echo base64_decode($data);
    } else {
        // Output the raw data
        readfile('php://input');
    }
}

```


---

### 📄 `sdxlib/js/webshims/shims/FlashCanvasPro/proxy.php` [2.392 octets]
<a id="sdxlib-js-webshims-shims-FlashCanvasPro-proxy-php"></a> [↩ Retour à l'arborescence](#tree-sdxlib-js-webshims-shims-FlashCanvasPro-proxy-php)

> **Chemin relatif** : `sdxlib/js/webshims/shims/FlashCanvasPro/proxy.php`  
> **Taille** : 2.392 octets  
> **Lignes** : 74  
> **Type** : php

```php
<?php

/**
 * Proxy script to load a file from other domain
 *
 * PHP versions 4 and 5
 *
 * Copyright (c) 2010-2011 Shinya Muramatsu
 *
 * Permission is hereby granted, free of charge, to any person obtaining a
 * copy of this software and associated documentation files (the "Software"),
 * to deal in the Software without restriction, including without limitation
 * the rights to use, copy, modify, merge, publish, distribute, sublicense,
 * and/or sell copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
 * DEALINGS IN THE SOFTWARE.
 *
 * @author     Shinya Muramatsu <revulon@gmail.com>
 * @copyright  2010-2011 Shinya Muramatsu
 * @license    http://www.opensource.org/licenses/mit-license.php  MIT License
 * @link       http://flashcanvas.net/
 * @link       http://code.google.com/p/flashcanvas/
 */

// Whether we check referrer or not
define('CHECK_REFERRER', true);

// Check that the request is from FlashCanvas
if (CHECK_REFERRER) {
    if (empty($_SERVER['HTTP_REFERER'])) {
        exit;
    }
    if (!preg_match('#/flash\d*canvas\.swf$#', $_SERVER['HTTP_REFERER'])) {
        exit;
    }
}

// Check that the request has a valid URL parameter
if (empty($_GET['url'])) {
    exit;
}
if (!preg_match('#^https?://#', $_GET['url'])) {
    exit;
}

// Percent-encode special characters in the URL
$search  = array(  '%',   '#',   ' ');
$replace = array('%25', '%23', '%20');
$url     = str_replace($search, $replace, $_GET['url']);

// Disable compression
header('Content-Encoding: none');

// Load and output the file
if (extension_loaded('curl')) {
    // Use cURL extension
    $ch = curl_init($url);
    curl_exec($ch);
    curl_close($ch);
} else {
    // Use the http:// wrapper
    readfile($url);
}

```


---

### 📄 `sdxlib/js/webshims/shims/FlashCanvasPro/save.php` [1.945 octets]
<a id="sdxlib-js-webshims-shims-FlashCanvasPro-save-php"></a> [↩ Retour à l'arborescence](#tree-sdxlib-js-webshims-shims-FlashCanvasPro-save-php)

> **Chemin relatif** : `sdxlib/js/webshims/shims/FlashCanvasPro/save.php`  
> **Taille** : 1.945 octets  
> **Lignes** : 50  
> **Type** : php

```php
<?php

/**
 * Save the input as a PNG file
 *
 * PHP versions 4 and 5
 *
 * Copyright (c) 2010-2011 Shinya Muramatsu
 *
 * Permission is hereby granted, free of charge, to any person obtaining a
 * copy of this software and associated documentation files (the "Software"),
 * to deal in the Software without restriction, including without limitation
 * the rights to use, copy, modify, merge, publish, distribute, sublicense,
 * and/or sell copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
 * DEALINGS IN THE SOFTWARE.
 *
 * @author     Shinya Muramatsu <revulon@gmail.com>
 * @copyright  2010-2011 Shinya Muramatsu
 * @license    http://www.opensource.org/licenses/mit-license.php  MIT License
 * @link       http://flashcanvas.net/
 * @link       http://code.google.com/p/flashcanvas/
 */

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    // Force download
    header('Content-Type: application/octet-stream');
    header('Content-Disposition: attachment; filename="canvas.png"');

    if (isset($_POST['dataurl'])) {
        // Decode the base64-encoded data
        $data = $_POST['dataurl'];
        $data = substr($data, strpos($data, ',') + 1);
        echo base64_decode($data);
    } else {
        // Output the raw data
        readfile('php://input');
    }
}

```


---

### 📄 `sdxlib/js/webshims/shims/i18n/formcfg-de.txt` [3.195 octets]
<a id="sdxlib-js-webshims-shims-i18n-formcfg-de-txt"></a> [↩ Retour à l'arborescence](#tree-sdxlib-js-webshims-shims-i18n-formcfg-de-txt)

> **Chemin relatif** : `sdxlib/js/webshims/shims/i18n/formcfg-de.txt`  
> **Taille** : 3.195 octets  
> **Lignes** : 75  
> **Type** : text

```text
//errormessages for de are already included in webshims core, this is only for information:
jQuery.webshims.validityMessages.de = {
	"typeMismatch": {
		"defaultMessage": "{%value} ist in diesem Feld nicht zulässig.",
		"email": "{%value} ist keine zulässige E-Mail-Adresse",
		"url": "{%value} ist keine zulässige Webadresse",
		"number": "{%value} ist keine Nummer!",
		"date": "{%value} ist kein Datum",
		"time": "{%value} ist keine Uhrzeit",
		"month": "{%value} ist in diesem Feld nicht zulässig.",
		"range": "{%value} ist keine Nummer!",
		"datetime-local": "{%value} ist kein Datum-Uhrzeit Format."
	},
	"rangeUnderflow": {
		"defaultMessage": "{%value} ist zu niedrig. {%min} ist der unterste Wert, den Sie benutzen können.",
		"date": "{%value} ist zu früh. {%min} ist die früheste Zeit, die Sie benutzen können.",
		"time": "{%value} ist zu früh. {%min} ist die früheste Zeit, die Sie benutzen können.",
		"datetime-local": "{%value} ist zu früh. {%min} ist die früheste Zeit, die Sie benutzen können.",
		"month": "{%value} ist zu früh. {%min} ist die früheste Zeit, die Sie benutzen können."
	},
	"rangeOverflow": {
		"defaultMessage": "{%value} ist zu hoch. {%max} ist der oberste Wert, den Sie benutzen können.",
		"date": "{%value} ist zu spät. {%max} ist die späteste Zeit, die Sie benutzen können.",
		"time": "{%value} ist zu spät. {%max} ist die späteste Zeit, die Sie benutzen können.",
		"datetime-local": "{%value} ist zu spät. {%max} ist die späteste Zeit, die Sie benutzen können.",
		"month": "{%value} ist zu spät. {%max} ist die späteste Zeit, die Sie benutzen können."
	},
	"stepMismatch": "Der Wert {%value} ist in diesem Feld nicht zulässig. Hier sind nur bestimmte Werte zulässig. {%title}",
	"tooLong": "Der eingegebene Text ist zu lang! Sie haben {%valueLen} Zeichen eingegeben, dabei sind {%maxlength} das Maximum.",
	"patternMismatch": "{%value} hat für dieses Eingabefeld ein falsches Format! {%title}",
	"valueMissing": {
		"defaultMessage": "Bitte geben Sie einen Wert ein",
		"checkbox": "Bitte aktivieren Sie das Kästchen",
		"select": "Bitte wählen Sie eine Option aus",
		"radio": "Bitte wählen Sie eine Option aus"
	}
};
jQuery.webshims.formcfg.de = {
	numberFormat: {
		",": ".",
		".": ","
	},
	timeSigns: ":. ",
	numberSigns: ',',
	dateSigns: '.',
	dFormat: ".",
	patterns: {
		d: "dd.mm.yy"
	},
	month:  {
		currentText: 'Aktueller Monat'
	},
	"week": {
		"currentText": "Aktuelle Woche"
	},
	date: {
		close: 'schließen',
		clear: 'Löschen',
		prevText: 'zurück',
		nextText: 'Vor',
		currentText: 'heute',
		monthNames: ['Januar','Februar','März','April','Mai','Juni',
		'Juli','August','September','Oktober','November','Dezember'],
		monthNamesShort: ['Jan','Feb','Mär','Apr','Mai','Jun',
		'Jul','Aug','Sep','Okt','Nov','Dez'],
		dayNames: ['Sonntag','Montag','Dienstag','Mittwoch','Donnerstag','Freitag','Samstag'],
		dayNamesShort: ['So','Mo','Di','Mi','Do','Fr','Sa'],
		dayNamesMin: ['So','Mo','Di','Mi','Do','Fr','Sa'],
		weekHeader: 'KW',
		firstDay: 1,
		isRTL: false,
		showMonthAfterYear: false,
		yearSuffix: ''
	}
};
```


---

### 📄 `sdxlib/js/webshims/shims/i18n/formcfg-en.txt` [2.745 octets]
<a id="sdxlib-js-webshims-shims-i18n-formcfg-en-txt"></a> [↩ Retour à l'arborescence](#tree-sdxlib-js-webshims-shims-i18n-formcfg-en-txt)

> **Chemin relatif** : `sdxlib/js/webshims/shims/i18n/formcfg-en.txt`  
> **Taille** : 2.745 octets  
> **Lignes** : 107  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (107 lignes) - Cliquer pour déplier</summary>

```text
//errormessages for en are already included in webshims core, this is only for information (by default en is equal to jQuery.webshims.validityMessages[""]):

jQuery.webshims.validityMessages.en = {
	"typeMismatch": {
		"defaultMessage": "Please enter a valid value.",
		"email": "Please enter an email address.",
		"url": "Please enter a URL.",
		"number": "Please enter a number.",
		"date": "Please enter a date.",
		"time": "Please enter a time.",
		"range": "Invalid input.",
		"month": "Please enter a valid value.",
		"datetime-local": "Please enter a datetime."
	},
	"rangeUnderflow": {
		"defaultMessage": "Value must be greater than or equal to {%min}.",
		"date": "Value must be at or after {%min}.",
		"time": "Value must be at or after {%min}.",
		"datetime-local": "Value must be at or after {%min}.",
		"month": "Value must be at or after {%min}."
	},
	"rangeOverflow": {
		"defaultMessage": "Value must be less than or equal to {%max}.",
		"date": "Value must be at or before {%max}.",
		"time": "Value must be at or before {%max}.",
		"datetime-local": "Value must be at or before {%max}.",
		"month": "Value must be at or before {%max}."
	},
	"stepMismatch": "Invalid input.",
	"tooLong": "Please enter at most {%maxlength} character(s). You entered {%valueLen}.",
	"patternMismatch": "Invalid input. {%title}",
	"valueMissing": {
		"defaultMessage": "Please fill out this field.",
		"checkbox": "Please check this box if you want to proceed.",
		"select": "Please select an option.",
		"radio": "Please select an option."
	}
};
jQuery.webshims.formcfg.en = {
	"numberFormat": {
		".": ".",
		",": ","
	},
	"numberSigns": ".-",
	"dateSigns": "/",
	"timeSigns": ":. ",
	"dFormat": "/",
	"patterns": {
		"d": "mm/dd/yy"
	},
	"month": {
		"currentText": "This month"
	},
	"week": {
		"currentText": "This week"
	},
	"date": {
		"closeText": "Done",
		"clear": "Clear",
		"prevText": "Prev",
		"nextText": "Next",
		"currentText": "Today",
		"monthNames": [
			"January",
			"February",
			"March",
			"April",
			"May",
			"June",
			"July",
			"August",
			"September",
			"October",
			"November",
			"December"
		],
		"monthNamesShort": [
			"Jan",
			"Feb",
			"Mar",
			"Apr",
			"May",
			"Jun",
			"Jul",
			"Aug",
			"Sep",
			"Oct",
			"Nov",
			"Dec"
		],
		"dayNames": [
			"Sunday",
			"Monday",
			"Tuesday",
			"Wednesday",
			"Thursday",
			"Friday",
			"Saturday"
		],
		"dayNamesShort": ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
		"dayNamesMin": ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"],
		"weekHeader": "Wk",
		"firstDay": 0,
		"isRTL": false,
		"showMonthAfterYear": false,
		"yearSuffix": ""
};
```

</details>


---

### 📄 `sdxlib/js/webshims/shims/jpicker/ChangeLog.txt` [10.137 octets]
<a id="sdxlib-js-webshims-shims-jpicker-ChangeLog-txt"></a> [↩ Retour à l'arborescence](#tree-sdxlib-js-webshims-shims-jpicker-ChangeLog-txt)

> **Chemin relatif** : `sdxlib/js/webshims/shims/jpicker/ChangeLog.txt`  
> **Taille** : 10.137 octets  
> **Lignes** : 121  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (121 lignes) - Cliquer pour déplier</summary>

```text
﻿Change Log
______________
1.1.6
  Corrected bug preventing selections inside input values in some browsers - the onselectstart function no longer captures on input boxes.
  Added support for up/down arrow adjustments of the currently focused input box making the picker more keyboard friendly.
  Added ticks around the backgroundImage assignments to correct for paths with whitespace.

1.1.5
  Corrected Color object constructor to allow setting of the "alpha" value as per the documentation which previously didn't work.
  Added support for translucency for quickList colors with checkered background - Only available if "alphaSupport" is enabled.
  Restricted default color to "alpha" of 255 if "alphaSupport" is disabled - It will now assign an explicit alpha of 255 when disabled.
  Added new setting variable "alphaPrecision" which indicates the number of decimal points to allow in the alpha percentage display - Now defaults to 0.

1.1.4
  Changed "alpha" range from 0-100 to 0-255 to correct truncating and rounding errors caused by attempting to get an integer percentage that matches a hex value.
  "alpha" percentage display will now show up to 1 decimal point for more accurate representation of "alpha" value.
  Color object now accepts "alpha" values in a range of 0-255 and also returns the same when getting the "alpha" value. You will need to run ((alpha * 100) / 255) to retrieve a percentage value.
  Reworked the table layout and labels to remove the need for the label to reference the radio input box. This reduces injected code and removes the need to generate unique ids on the radio buttons.
  Transparent/invisible caret on NULL color is now corrected - uses the same caret color as a white color.
  Setting a binded input value of "" or no value attribute will now create a NULL color on initialization instead of the settings default color.
  Added a dynamic, invisible "iframe" behind a dialog picker in all browsers that fail jQuery.support.boxModel (currently IE <= 7 Quirks Mode). This prevents "select" box from showing through the picker.

1.1.3
  Now adding popup color pickers to document.body instead of inline with the popup control. This corrects issues with the picker not showing beyond a relative container scope.
  No longer need to hide popup icon in Internet Explorer for picker elements lower in the DOM than the currently active one since the picker itself is attached to document.body (it is always higher in the DOM now).
  Popup pickers are now bring-to-front selectable. Clicking on the picker will bring it above all other pickers on the page instead of having to drag one out from underneath another.
  Corrected jPicker.List/setTimeout bug which allowed an instance to bind to the List in an order other than the order the initialization function was called.
  Added a updateInputColor option (default true) to allow for a binded input field that does not automatically update its background/text color.

1.1.2
  Reworked the find methods and contexts for element searches. Now using ":first" instead of ".eq(0)" to take advantage of early out searches. Much faster initialization of the picker, on the order of 6 times.
  Now using setTimeout for calling visual updates. Dramatically improved marker dragging in all browsers. Reduces blocking as re-rendering is internal to the browser and independent of the other javascript still in progress.
  Marker updates can now cancel a previous valueChanged event when a new mouseMove event comes in. IE8 marker dragging is still slower, much over 5 times faster than it was.
  Reworked entire quickPick list creation. It now adds up source code and does a single "html" method instead of multiple "append" methods. This is a large part of the speed increase on initialization.
  The vast majority of all running scripts on both initialization and dragging is now occupied altering the style rules and finding elements (init only) instead of jPicker code.
  All methods previously called with global context now use the "call" method for using the context of the class running the method. "this" in a callback is now the DOM node (jQuery style) and jPicker instead of "window".
  Added "effects" section of window settings to allow different show/hide effects and durations.
  Removed change log and read me from the full source code to separate files (ChangeLog.txt and ReadMe.txt) and an HTML demonstration/documentation page (Example.txt).

1.1.1
  Correct IE exception caused by attempting to set "#transparent" to CSS background-color.

1.1.0
  Reworked nearly the entire plugin including the internal and external event model, bindings, DOM searches, classes, and overall presentation.
  The Color object now supports a changed event that you can bind to (or just bind to the picker events still included).
  Event order has been reversed, instead of a change event on the map/bar/text fields updating the display, they now update the Color object which then fires the events that update the display.
  alphaSupport re-implemented by request - default behavior is off.
  Hex code now only 6 characters again.
  Color object can now have its value changed from code, using the "val" method, and it will fire all events necessary to update the display.
  Removed all "get_*" methods from the color object, instead opting for a single "val" method for getting and setting, more in line with familiar jQuery methods.
  Better rendering for all IE versions in Quirks mode.

1.0.13
  Updated transparency algorithm for red/green/blue color modes. The algorithm from John Dyers' color picker was close but incorrect. Bar colors are now pixel perfect with the new algorithm.
  Changed from using "background-position" on the color maps to an element of full height using the "top" attribute for image-map location using "overflow: hidden" to hide overdraw.
  IE7/8 ignores opacity on elements taller than 4096px. Image maps therefore no longer include a blank first map so the Bar is just under 4096. Blank is now accomplished by setting the "top" setting to below the map display.
  New colorBar picker image that does not draw outside of the element since the elements now hide overdraw.
  Added IE5.5/6 support for the picker. This is why it now uses maps of full height and the "top" attribute for map locations.
  Moved the images in the maps to 4 pixels apart from each other. IE7/8 change the first pixel of the bottom-border of 2px to partially transparent showing a portion of a different color map without this.

1.0.12
  Added minified CSS file.
  Added IE7/8 Quirks Mode support.
  Added configurable string constants for all text and tooltips. You can now change the default values for different languages.
  Privatized the RGBA values in the Color object for better NULL handling. YOU MUST USE THE NEW GET FUNCTIONS TO ACCESS THE COLOR PROPERTIES.
  Better NULL color handling and an additional "No Color Selected" quick pick color.
  More consistent behavior across multiple versions of browsers.
  Added alpha response to the binded color picker icon.
  Removed "alphaSupport" variable. It is now always supported.

1.0.11b
  Corrected NULL behavior in IE. jQuery was getting an exception when attempting to assign a backgroundColor style of '#'. Now assigns 'transparent' if color is NULL.
  Can now create new Color object WITH OR WITHOUT the '#' prefix.

1.0.11
  Added ability for NULL colors (delete the hex value). Color will be returned as color.hex == ''. Can set the default color to an empty hex string as well.
  cancelCallback now returns the original color for use in programming responses.

1.0.10
  Corrected table layout and tweaked display for more consisent presentation. Nice catch from Jonathan Pasquier.

1.0.9
  Added optional title variable for each jPicker window.

1.0.8
  Moved all images into a few sprites - now using backgroundPosition to change color maps and bars instead of changing the image - this should be faster to download and run.
   
1.0.7
  RENAMED CSS FILE TO INCLUDE VERSION NUMBER!!! YOU MUST USE THIS VERSIONED CSS FILE!!! There will be no need to do your own CSS version number increments from now on.
  Added opacity feedback to color preview boxes.
  Removed reliance on "id" value of containing object. Subobjects are now found by class and container instead of id's. This drastically reduces injected code.
  Removed (jQuery).jPicker.getListElementById(id) function since "id" is no longer incorporated or required.

1.0.6
  Corrected picker bugs introduced with 1.0.5.
  Removed alpha slider bar until activated - default behavior for alpha is now OFF.
  Corrected Color constructor bug not allowing values of 0 for initial value (it was evaluating false and missing the init code - Thanks Pavol).
  Removed title tags (tooltips) from color maps and bars - They get in the way in some browsers (e.g. IE - dragging marker does NOT prevent or hide the tooltip).
  THERE WERE CSS FILE CHANGES WITH THIS UPDATE!!! IF YOU USE NEVER-EXPIRE HEADERS, YOU WILL NEED TO INCREMENT YOUR CSS FILE VERSION NUMBER!!!

1.0.5
  Added opacity support to picker and color/callback methods. New property "a" (alpha - range from 0-100) in all color objects now - defaults to 100% opaque. (Thank you Pavol)
  Added title attributes to input elements - gives short tooltip directions on what button or field does.
  Commit callback used to fire on control initialization (twice actually) - This has been corrected, it does not fire on initialization.
  THERE WERE CSS FILE CHANGES WITH THIS UPDATE!!! IF YOU USE NEVER-EXPIRE HEADERS, YOU WILL NEED TO INCREMENT YOUR CSS FILE VERSION NUMBER!!!

1.0.4
  Added ability for smaller picker icon with expandable window on any DOM element (not just input).
  "draggable" property renamed to "expandable" and its scope increased to create small picker icon or large static picker.

1.0.3
  Added cancelCallback function for registering an external function when user clicks cancel button. (Thank you Jeff and Pavol)

1.0.2
  Random bug fixes - speed concerns.

1.0.1
  Corrected closure based memeory leak - there may be others?

1.0.0
  First Release.
```

</details>


---

### 📄 `sdxlib/js/webshims/shims/jpicker/jpicker.css` [4.436 octets]
<a id="sdxlib-js-webshims-shims-jpicker-jpicker-css"></a> [↩ Retour à l'arborescence](#tree-sdxlib-js-webshims-shims-jpicker-jpicker-css)

> **Chemin relatif** : `sdxlib/js/webshims/shims/jpicker/jpicker.css`  
> **Taille** : 4.436 octets  
> **Lignes** : 1  
> **Type** : css

```css
.jPicker .Icon{display:inline-block;height:24px;position:relative;text-align:left;width:25px}.jPicker .Icon span.Color,.jPicker .Icon span.Alpha{background-position:2px 2px;display:block;height:100%;left:0;position:absolute;top:0;width:100%}.jPicker .Icon span.Image{background-repeat:no-repeat;cursor:pointer;display:block;height:100%;left:0;position:absolute;top:0;width:100%}.jPicker.Container{color:#000;z-index:10}table.jPicker{font-family:Arial,Helvetica,Sans-Serif;font-size:12px!important;margin:0;padding:0;width:545px;z-index:20}.jPicker hr{margin:7px 0}.jPicker .Move{background-color:#ddd;border-color:#fff #666 #666 #fff;border-style:solid;border-width:1px;cursor:move;height:12px;padding:0}.jPicker .Title{display:none}.jPicker div.Map{border-bottom:2px solid #fff;border-left:2px solid #9a9a9a;border-right:2px solid #fff;border-top:2px solid #9a9a9a;cursor:crosshair;height:260px;margin:0 10px 10px;overflow:hidden;padding:0;position:relative;width:260px}.jPicker div[class=Map]{height:256px;width:256px}.jPicker div.Bar{border-bottom:2px solid #fff;border-left:2px solid #9a9a9a;border-right:2px solid #fff;border-top:2px solid #9a9a9a;cursor:n-resize;height:260px;margin:-11px 10px 0 5px;overflow:hidden;padding:0;position:relative;width:24px}.jPicker div[class=Bar]{height:256px;width:20px}.jPicker .Map .Map1,.jPicker .Map .Map2,.jPicker .Map .Map3,.jPicker .Bar .Map1,.jPicker .Bar .Map2,.jPicker .Bar .Map3,.jPicker .Bar .Map4,.jPicker .Bar .Map5,.jPicker .Bar .Map6{background-color:transparent;background-image:none;display:block;left:0;position:absolute;top:0}.jPicker .Map .Map1,.jPicker .Map .Map2,.jPicker .Map .Map3{height:2596px;width:256px}.jPicker .Bar .Map1,.jPicker .Bar .Map2,.jPicker .Bar .Map3,.jPicker .Bar .Map4{height:3896px;width:20px}.jPicker .Bar .Map5,.jPicker .Bar .Map6{height:256px;width:20px}.jPicker .Map .Map1,.jPicker .Map .Map2,.jPicker .Bar .Map6{background-repeat:no-repeat}.jPicker .Map .Map3,.jPicker .Bar .Map5{background-repeat:repeat}.jPicker .Bar .Map1,.jPicker .Bar .Map2,.jPicker .Bar .Map3,.jPicker .Bar .Map4{background-repeat:repeat-x}.jPicker .Map .Arrow{display:block;position:absolute}.jPicker .Bar .Arrow{display:block;left:0;position:absolute}.jPicker .Preview{font-size:9px;padding:5px 0 0;text-align:center}.jPicker .Preview div{border:2px inset #eee;height:62px;margin:0 auto;padding:0;width:62px}.jPicker .Preview div span{border:1px solid #000;display:block;height:30px;margin:0 auto;padding:0;width:60px}.jPicker .Preview .Active{border-bottom-width:0}.jPicker .Preview .Current{border-top-width:0;cursor:pointer}.jPicker input{font-size:13px}.jPicker .Button{text-align:center;padding:0 4px;width:115px}.jPicker .Button input{padding:2px 0;width:100px}.jPicker .Button .Ok{margin:12px 0 5px}.jPicker td{margin:0;padding:0}.jPicker td.Radio{margin:0;padding:0;width:31px}.jPicker td.Radio input{margin:0 5px 0 0;padding:0}.jPicker td.Text{font-size:12px!important;height:22px;margin:0;padding:0;text-align:left;width:70px}.jPicker tr.Hex td.Text{width:100px}.jPicker td.Text input{background-color:#fff;border:1px inset #aaa;height:19px;margin:0 0 0 5px;text-align:left;width:30px}.jPicker td[class=Text] input{height:15px}.jPicker tr.Hex td.Text input.Hex{width:45px;margin-left:2px;text-align:center}.jPicker.no-alpha-picker tr.Hex td.Text input.Hex{width:50px;margin-left:5px}.jPicker tr.Hex td.Text input.AHex{width:15px}.jPicker.no-alpha-picker tr.Hex td.Text input.AHex{display:none}.jPicker.no-alpha-picker tr.Alpha{visibility:hidden}.jPicker .Grid{text-align:center;width:114px}.jPicker .Grid span.QuickColor{border:1px inset #aaa;cursor:pointer;display:inline-block;height:15px;line-height:15px;margin:0;padding:0;width:19px}.jPicker .Grid span[class=QuickColor]{width:17px}@media all{#jPicker{margin:0 8px;text-align:left}#jPicker ul{font-size:15px;margin:0 0 0 15px;padding:0}#jPicker ul li{list-style:disc;padding:2px 0}#jPicker ul li ul{margin-bottom:10px}#jPicker ul li ul li{list-style:circle}#jPicker p{font-size:13px;padding:0 10px}#jPicker hr{clear:both}#jPicker h2.jPicker{font-size:16px;padding:20px 10px}#jPicker code{color:#8bd;font-size:14px;font-weight:700}#jPicker pre{background:#eee;border:1px solid #000;color:#000;display:block;font-size:11px;margin:10px 5px;padding:5px}#jPicker span{font-size:13px;text-align:center}#jPicker a{color:#ff8050}#jPicker input{font-size:13px;padding:2px 5px}#jPicker h2{font-size:16px;margin:10px 0}}
```


---

### 📄 `sdxlib/js/webshims/shims/jpicker/ReadMe.txt` [1.986 octets]
<a id="sdxlib-js-webshims-shims-jpicker-ReadMe-txt"></a> [↩ Retour à l'arborescence](#tree-sdxlib-js-webshims-shims-jpicker-ReadMe-txt)

> **Chemin relatif** : `sdxlib/js/webshims/shims/jpicker/ReadMe.txt`  
> **Taille** : 1.986 octets  
> **Lignes** : 47  
> **Type** : text

```text
﻿jPicker 1.1.6

jQuery Plugin for Photoshop style color picker

Copyright (c) 2010 Christopher T. Tillman
Digital Magic Productions, Inc. (http://www.digitalmagicpro.com/)
MIT style license, FREE to use, alter, copy, sell, and especially ENHANCE

Painstakingly ported from John Dyers' excellent work on his own color picker based on the Prototype framework.

John Dyers' website: (http://johndyer.name)
Color Picker page:   (http://johndyer.name/post/2007/09/PhotoShop-like-JavaScript-Color-Picker.aspx)


    jPicker is a fast, lightweight jQuery plugin for including an advanced color picker in your web projects.
It has been painstakenly ported from John Dyers' awesome work on his picker using the Prototype framework.

    jPicker supports all current browsers and has been extensively tested in Chrome, Firefox, IE5.5+, Safari,
and Opera.

    If you are updating a current version, you MUST always use the CSS and image files from the download as
there may have been changes.

    If you are moving from a V1.0.* version, you MUST read the docs below to implement some changes to the
Color object returned by the callback functions.


Known Issues
______________
Attaching multiple jPicker objects on a single page will slow performance.
  jPicker creates a new instance of the picker for every element. Performance will suffer when binding dozens of instances.


Coming Soon
______________

    Will consider supporting jQuery ThemeRoller CSS API for theming the UI if demand exists.

Planned For Future Release
______________

  Move the jPicker object to a single instance that all selection instances point to.
     - This will result in much faster operation and initialization for pages with multiple pickers.

  Add activateCallback option for calling a callback function when the jPicker is activated or its binding is switched to a different picker element.
  
  Add multiple window modes for picker operation, include modal, popup, windowed, and exclusive.
```


---

### 📄 `sdxlib/js/webshims/shims/styles/config.rb` [251 octets]
<a id="sdxlib-js-webshims-shims-styles-config-rb"></a> [↩ Retour à l'arborescence](#tree-sdxlib-js-webshims-shims-styles-config-rb)

> **Chemin relatif** : `sdxlib/js/webshims/shims/styles/config.rb`  
> **Taille** : 251 octets  
> **Lignes** : 12  
> **Type** : ruby

```ruby
# compass config

http_path = "/"
css_dir = "/"
sass_dir = "scss"
images_dir = "/"
javascripts_dir = "/"

# output_style = :expanded or :nested or :compact or :compressed
output_style = :expanded
relative_assets = true
line_comments = false
```


---

### 📄 `sdxlib/js/webshims/shims/styles/scss/shim.scss` [20.873 octets]
<a id="sdxlib-js-webshims-shims-styles-scss-shim-scss"></a> [↩ Retour à l'arborescence](#tree-sdxlib-js-webshims-shims-styles-scss-shim-scss)

> **Chemin relatif** : `sdxlib/js/webshims/shims/styles/scss/shim.scss`  
> **Taille** : 20.873 octets  
> **Lignes** : 1285  
> **Type** : scss

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (1285 lignes) - Cliquer pour déplier</summary>

```scss
%clearfix {
	zoom: 1;

	&:before,
	&:after {
		display: table;
		clear: both;
		content: ' ';
	}
}

.ws-important-hide {
	display: none !important;
	visibility: hidden !important;
	position: absolute;
	top: -999999px;
}

/*
.webshims-debug-list {
	position: fixed;
	bottom: 0;
	left: 0;
	right: 0;
	margin: 5px;
	padding: 5px;
	list-style: none;
	background: #fff;
	color: #930;
	font-size: 16px;
	font-weight: bold;
	max-height: 200px;
	z-index: 99999;
	overflow-y: auto;
	
	li {
		border: 1px solid #c60;
		margin: 2px 0;
		padding: 5px;
	}
}*/

article, aside, canvas, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary {
	display: block;
}

dialog {
	display: none;
	postion: absolute;
	left: 0;
	right: 0;
	border: solid;
	background: #fff;
	color: #000;
	padding: 1em;
	
	&[open] {
		display: block;
	}
}

audio {
	display: none;
	height: 0;
	width: 0;
	overflow: hidden;
}

video {
	overflow: hidden;
}

video,
audio[controls],
audio.webshims-controls {
	display: inline-block;
	min-height: 45px;
	min-width: 40px;
}

video > *,
audio > * {
	visibility: hidden;

	.no-swf & {
		visibility: inherit;
	}
}

.flashblocker-assumed {
	min-height: 20px;
	min-width: 20px;
	z-index: 2147483647;
}

.cue-display {
	position: absolute !important;
	margin: 0;
	padding: 0px !important;
	max-width: 100% !important;
	max-height: 100% !important;
	border: none !important;
	background: none !important;
	text-align: center;
	visibility: hidden;
	font-family: sans-serif;
	font-size: 12px;
	white-space: pre-wrap;
	overflow: hidden;

	b {
		font-weight: bold;
	}

	i {
		font-style: italic;
	}

	u {
		text-decoration: underline;
	}

	span.cue-wrapper {
		position: absolute;
		left: 0;
		bottom: 0;
		right: 0;
		display: block;
		padding: 0;
		margin: 0;
		width: 100%;
		font-size: 160%;
		color: #fff;
		visibility: visible !important;
	}

	.cue-line {
		display: block;
	}

	span.cue {
		display: inline-block;
		padding: 3px 5px;
		background: #000;
		background: rgba(0, 0, 0, 0.8);
		color: #fff;
	}

	.description-cues {
		position: absolute;
		top: -99px;
		left: -99px;
		display: block;
		width: 5px;
		height: 5px;
		overflow: hidden;
	}
}

mark {
	background-color: #ff9;
	color: #000;
	font-style: italic;
	font-weight: bold;
}

/* reset */
.ws-range,
.ws-range *,
.placeholder-box,
.placeholder-text,
.input-buttons,
.input-buttons *,
.details-open-indicator,
.ws-input-seperator,
progress span.progress-value {
	margin: 0;
	padding: 0;
	border: none;
	width: auto;
	background: transparent none;
}
output {
	position: relative;
}

.webshims-visual-hide {
	position: absolute !important;
	top: 0 !important;
	left: 0 !important;
	visibility: hidden !important;
	width: 0 !important;
	height: 0 !important;
	overflow: hidden !important;
}

.webshims-visual-hide * {
	visibility: hidden !important;
}

/* placeholder */
.placeholder-box {
	position: relative;
	display: inline-block;
	zoom: 1;

	.polyfill-important & {
		position: relative !important;
		display: inline-block !important;
		margin: 0 !important;
		padding: 0 !important;
		width: auto !important;
		height: auto !important;
	}
}

.placeholder-box-input {
	vertical-align: bottom;
}

.placeholder-box-left {
	float: left;
}

.placeholder-box-right {
	float: right;
}

.placeholder-text {
	position: absolute;
	display: none;
	top: 0;
	left: 0;
	overflow: hidden;
	color: #999;
	line-height: 1;
	cursor: text;

	.polyfill-important & {
		margin: 0 !important;
		padding-right: 0 !important;
		padding-bottom: 0 !important;
		display: none !important;
	}

	.placeholder-visible &,
	&.placeholder-visible {
		display: inline-block;
	}

	.placeholder-box-input & {
		white-space: nowrap;
	}
}

.placeholder-visible {
	color: #999;
}

.placeholder-focused.placeholder-visible {
	color: #ccc;
}

.polyfill-important {
	.placeholder-visible .placeholder-text, .placeholder-text.placeholder-visible {
		display: inline-block !important;
	}
}


/* spinner control for time, number (usable for date, datetime-local) */
.has-input-buttons {
	display: inline-block;
}
.polyfill-important .has-input-buttons {
	display: inline-block !important;
}

.input-buttons,
.step-controls,
.ws-popover-opener {
	zoom: 1;
	overflow: hidden;
	display: inline-block;
	font-size: 0;
	vertical-align: middle;
	margin-top: -3px;
	margin-left: -20px;
}

.step-controls,
.ws-popover-opener {
	position: relative;
	float: left;
	margin: 0;
	height: 19px;
	width: 15px;
}

.ws-popover-opener {
	position: relative;
	zoom: 1;
	overflow: visible;
	margin: 0 0 0 2px;
	width: 19px;
	border-radius: 3px;
	cursor: pointer;
	background: #ccc;
	
	span {
		display: block;
		position: absolute;
		top: 50%;
		left: 50%;
		width: 16px;
		height: 16px;
		margin: -8px 0 0 -8px;
		background: url(forms.png) no-repeat -321px -1px;
		
		
		.color-input-buttons & {
			background-position: -348px 0;
		}
		
		&.ws-color-indicator-bg {
			background: url(../jpicker/images/preview-opacity.png) no-repeat 0;
		}
		&.ws-color-indicator {
			background: none;
		}
	}
}

input[type="color"] {
	width: 6.5em;
}

.input-buttons {
	.polyfill-important & {
		display: inline-block !important;
		padding: 0 !important;
		vertical-align: middle !important;
	}
	&.color-input-buttons {
		margin-left: 2px;
	}
	&.input-button-size-1 {
		&.month-input-buttons,
		&.date-input-buttons {
			margin-left: -24px;
		}
	}
	&.input-button-size-2 {
		margin-left: -39px;
	}
	&.ws-disabled {
		opacity: 0.95;
	}
	&.ws-disabled *,
	&.ws-readonly * {
		cursor: default;
	}
}

.step-controls {

	span {
		position: absolute;
		display: inline-block;
		overflow: hidden;
		margin: 0 !important;
		padding: 0 !important;
		width: 15px;
		height: 9px;
		cursor: pointer;
		font-size: 0;
		line-height: 0;
		background: url(forms.png) no-repeat 0 0;

		.polyfill-important & {
			display: inline-block !important;
			margin: 0 !important;
			padding: 0 !important;
			font-size: 0 !important;
		}

		&.step-up {
			top: 0;
			background-position: -80px 0;
			&:hover {
				background-position: -105px 0;
			}
			&.mousepress-ui {
				background-position: -105px -20px;
			}
			.ws-disabled & {
				background-position: -130px 0;
			}
		}
		&.step-down {
			bottom: 0;
			background-position: -155px 0;
			&:hover {
				background-position: -180px 0;
			}
			&.mousepress-ui {
				background-position: -180px -20px;
			}
			.ws-disabled & {
				background-position: -205px 0;
			}
		}

	}
}


.ws-input {

	letter-spacing: -0.31em;
    word-spacing: -0.43em;
	
	> * {
		text-align: center;
		letter-spacing: normal;
		word-spacing: normal;
	}
	.ws-input-seperator {
		vertical-align: middle;
		width: 2%;
		overflow: hidden;
	}
	
	& + .input-buttons {
		margin-left: 2px;
	}
	
	input,
	.ws-input-seperator	{
		-moz-box-sizing: border-box;
		box-sizing: border-box;
		text-align: center;
		display: inline-block;
		
		.polyfill-important & {
			display: inline-block !important;
		}
	}
	
	
}

.ws-date {

	.mm,
	.dd {
		width: 23.5%;
		
		.no-boxsizing & {
			width: 16%;
		}
	}
	.yy {
		width: 48%;
		
		.no-boxsizing & {
			width: 40%;
		}
	}
}

.ws-month {
	.mm,
	.yy {
		width: 47.9%;
		
		.no-boxsizing & {
			width: 41%;
		}
	}
}

/* range */
.ws-range {
	position: relative;
	display: inline-block;
	vertical-align: middle;
	margin: 0;
	zoom: 1;
	border: none;
	height: 19px;
	width: 155px;
	border-radius: 1px;
	background: url(range-track.png) 0 center no-repeat;
	cursor: pointer;
	font-size: 0;
	line-height: 0;

	.polyfill-important & {
		display: inline-block !important;
		padding: 0 !important;
		font-size: 0 !important;
	}

	.ws-range-thumb {
		top: 0;
		position: absolute;
		display: block;
		z-index: 4;
		overflow: hidden;
		margin: -2px 0 0 -6px;
		height: 22px;
		width: 11px;
		background: url(forms.png) -3px 1px no-repeat;
		cursor: pointer;
		outline: none;
		font-size: 0;
		line-height: 0;

		&:hover {
			background-position: -20px 1px;
		}
	}

	&.ws-focus .ws-range-thumb {
		background-position: -20px 1px;
	}
	
	&.ws-active .ws-range-thumb {
		background-position: -37px 1px;
	}
	
	&[aria-disabled="true"],
	&[aria-readonly="true"] {
		cursor: default;
		opacity: 0.95;
	}
	
	&[aria-disabled="true"]  .ws-range-thumb,
	&[aria-readonly="true"]  .ws-range-thumb {
		cursor: default;
	}
	
	&[aria-disabled="true"] .ws-range-thumb {
		background-position: -54px 1px;
	}

	.ws-range-rail {
		position: absolute;
		display: block;
		top: 0;
		left: 5px;
		right: 5px;
		bottom: 0;
		margin: 0;
		zoom: 1;
	}

	.ws-range-min {
		position: absolute !important;
		display: block;
		padding: 0 !important;
		top: 0;
		height: 1px;
		left: 0;
		z-index: 1;
		overflow: hidden;
		background: #b6e2fb;
	}

	.ws-range-ticks {
		overflow: hidden;
		position: absolute;
		bottom: 0px;
		left: 0;
		height: 4px;
		width: 1px;
		margin: 0 0 0 -1.5px;
		font-size: 0;
		line-height: 0;
		text-indent: -999px;
		background: #ccc;
	}

	&.vertical-range {
		background: url(vertical-range.png) center bottom no-repeat;
		width: 20px;

		.ws-range-thumb {
			top: 0;
			left: 3px;
			bottom: auto;
			background: url(vertical-range.png) 0 -51px no-repeat;
			margin: -6px 0 0 0;
			height: 11px;
			width: 22px;

		}
		.ws-range-thumb:hover,
		&.ws-focus .ws-range-thumb {
			background-position: 0 -34px;
		}
		&.ws-active .ws-range-thumb {
			background-position: 0 -17px;
		}

		&[aria-disabled="true"] .ws-range-thumb {
			background-position: 0 0;
		}

		.ws-range-min {
			top: auto;
			bottom: 1px;
			left: 0;
			width: 1px;
			height: 0;
		}

		.ws-range-rail {
			top: 5px;
			left: 0;
			right: 0;
			bottom: 5px;
		}

		.ws-range-ticks {
			bottom: auto;
			left: auto;
			right: 0;
			height: 1px;
			width: 4px;
		}
	}

}






/*
 * popovers
 */
.ws-popover {
	display: block;
	visibility: hidden;
	overflow: hidden;
	position: absolute;
	top: 0;
	left: 0;
	padding: 0 6px 0;
	margin: 0 0 0 -6px;
	z-index: 1000;
	min-width: 90px;
	transition: visibility 400ms ease-in-out;
	
	.no-csstransitions &,
	.no-opacity & {
		display: none;
	}

	button {
		display: inline-block;
		overflow: visible;
		position: relative;
		margin: 0;
		border: 0;
		padding: 0;
		-moz-box-sizing: content-box;
		box-sizing: content-box;
		-webkit-appearance: none;
		appearance: none;
		box-sizing: content-box;
		font-family: arial, sans-serif;
		background: transparent;
		cursor: pointer;

		&::-moz-focus-inner {
			border: 0;
			padding: 0;
		}

		&[disabled] {
			cursor: default;
			color: #888;
		}
	}
	
	&.ws-po-visible {
		visibility: visible;
		display: block;
	}
}

.ws-po-outerbox {
	position: relative;
	opacity: 0;
	padding: 11px 0 4px;
	-webkit-transform: translate(0, -100%);
	transform: translate(0, -100%);
	transition: all 400ms ease-in-out;

	.ws-popover.ws-po-visible & {
		opacity: 1;
		-webkit-transform: translate(0, 0);
		transform: translate(0, 0);
	}
}

.ws-po-box {
	border: 1px solid #ccc;
	background: #fefefe;
	padding: 5px;
	box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
}

.ws-po-arrow {
	position: absolute;
	top: 4px;
	left: 20px;
	display: block;
	width: 0;
	height: 0;
	border-left: 9px solid transparent;
	border-right: 9px solid transparent;
	border-bottom: 7px solid #ccc;
	border-top: none;
	zoom: 1;
	font-size: 0;

	html & {
		border-left-color: transparent;
		border-right-color: transparent;

		.ws-po-arrowbox {
			border-left-color: transparent;
			border-right-color: transparent;
		}
	}

	.polyfill-important & {
		border-left-color: transparent !important;
		border-right-color: transparent !important;

		.ws-po-arrowbox {
			border-left-color: transparent !important;
			border-right-color: transparent !important;
		}
	}

	* html & {
		display: none;
	}

	.ws-po-arrowbox {
		position: relative;
		top: 1px;
		left: -9px;
		display: block;
		width: 0;
		height: 0;
		border-left: 9px solid transparent;
		border-right: 9px solid transparent;
		border-bottom: 7px solid #fefefe;
		border-top: none;
		z-index: 999999999;
	}
}




//date popover
$border-light: 1px solid #ddd;
$button-bgcolor: #f5f5f5;
%ws-button {
	border-radius: 4px;
	background: #ccc;
	padding: 5px 8px;
	display: inline-block;
	border: 1px solid transparent;
}
.input-picker {
	outline: none;
	text-align: center;
	font-family: sans-serif;
	width: 330px;
	
	&.ws-size-2 {
		width: 645px;
	}
	
	&.ws-size-3 {
		width: 960px;
	}
	
	&.color-popover {
		width: 590px;
	}
	
	abbr[title] {
		cursor: help;
	}
	
	li,
	button {
		font-size: 13px;
		line-height: 16px;
		color: #000;
		transition: all 400ms;
	}
	
	.ws-focus,
	:focus {
		outline: 1px dotted #000;
	}
	

	.ws-po-box {
		position: relative;
		padding: 10px 20px 15px;
		border-radius: 5px;
		box-shadow: 0 0 2px rgba(0, 0, 0, .3);
	}

	.ws-prev,
	.ws-next {
		@extend %ws-button;
		position: absolute;
		top: 10px;
		border: 1px solid #ccc;
		border-radius: 5px;
		padding: 0;
		width: 24px;
		height: 24px;
		background: #eee url(forms.png) no-repeat 0 0;
		z-index: 1;
		
		span {
			display: none;
		}
	}

	.ws-picker-body {
		@extend %clearfix;
		position: relative;
		padding: 46px 0 0;
		zoom: 1;
		margin: 0 -10px;
	}

	.ws-prev {
		left: 20px;
		background-position: -243px 5px;
	}
	.ws-next {
		right: 20px;
		background-position: -275px 5px;
	}
	
	.ws-prev:hover,
	.ws-next:hover {
		border-color: #666;
	}
	
	.ws-prev[disabled],
	.ws-next[disabled] {
		opacity: 0.4;
		border-color: #eee;
	}

	.ws-button-row {
		@extend %clearfix;
		position: relative;
		margin: 10px 0 0;
		border-top: 1px solid #eee;
		padding: 10px 0 0;
		text-align: left;
		z-index: 2;

		button {
			@extend %ws-button;
			
			border: 1px solid #ccc;
			border-radius: 5px;
			box-shadow: 1px 1px 0 #fff;
			background-color: #ddd;
			background-image: -webkit-linear-gradient(top, #ececec 0%, #ddd 100%);
			background-image: linear-gradient(to bottom, #ececec 0%, #ddd 100%);
			transition: border-color 200ms linear;
			float: left;

			&.ws-empty {
				float: right;
			}
		}
	}
	
	&[data-currentview="setMonthList"] .ws-picker-header  select {
		max-width: 95%;
	}
	
	&[data-currentview="setDayList"] .ws-picker-header select {
		max-width: 40%;
	}
	
	&[data-currentview="setDayList"] .ws-picker-header select.month-select {
		max-width: 55%;
	}

	.ws-picker-header {
		position: absolute;
		top: -44px;
		right: 0;
		left: 0;
		margin: 0 40px;

		button {
			display: inline-block;
			width: 100%;
			margin: 0;
			padding: 4px 0;
			font-weight: 700;
			color: #000;
			

			&:hover {
				text-decoration: underline;
			}
			
			&[disabled]:hover {
				text-decoration: none;
			}
		}
	 }
	
	.picker-grid {
		@extend %clearfix;
		position: relative;
		zoom: 1;
		overflow: hidden;
	}
	
	&.ws-size-1 .picker-list  {
		float: none;
		width: auto;
	}
	
	.picker-list {
		@extend %clearfix;
		position: relative;
		zoom: 1;
		width: 290px;
		float: left;
		margin: 0 10px;
		
		
		tr {
			border: 0;
		}

		th,
		td {
			padding: 3px 5px;
		}
		
		&.day-list td {
			padding: 2px 1px;
		}


		td button {
			display: block;
			padding: 4px 0;
			width: 100%;
			border-radius: 5px;
			color: #000;
			background-color: #fff;

			&.othermonth {
				color: #888;
			}

			&:hover,
			&.checked-value {
				color: #fff;
				background: #000;
			}

			&[disabled],
			&[disabled]:hover {
				color: #888;
				background-color: #fff;
			}
			
			
		}
		
		table {
			width: 100%;
			border: 0 none;
			border-collapse: collapse;
		}

		th,
		td.week-cell{
			font-size: 13px;
			line-height: 1.1em;
			padding-bottom: 3px;
			text-transform: uppercase;
			font-weight: 700;
		}

		th, td {
			width: 14.2856%;
		}
	}


	.ws-options {
		margin: 10px 0 0;
		border-top: 1px solid #eee;
		padding: 10px 0 0;
		text-align: left;
		
		h5 {
			margin: 0 0 5px;
			padding: 0;
			font-size: 14px;
			font-weight: bold;
		}
		
		ul,
		li {
			padding: 0;
			margin: 0;
			list-style: none;
		}
		
		button {
			display: block;
			padding: 2px 0;
			width: 100%;
			text-align: left;
			
			&.ws-focus,
			&:focus,
			&:hover {
				text-decoration: underline;
			}
			
			&[disabled],
			&[disabled].ws-focus,
			&[disabled]:focus,
			&[disabled]:hover {
				color: #888;
				text-decoration: none;
			}
		}
		
		
	}
}


//data list
datalist {
	display: none;
}

.datalist-polyfill {
	position: absolute !important;
	font-family: "Lucida Grande", "MS Shell Dlg", "Calibri", sans-serif;
	font-size: 100%;

	.datalist-box {
		position: relative;
		max-height: 200px;
		overflow: hidden;
		overflow-x: hidden !important;
		overflow-y: auto;
	}

	ul, li {
		font-size: 100%;
		list-style: none !important;
	}

	ul {
		position: static !important;
		overflow: hidden;
		margin: 0;
		padding: 2px 0;
		height: auto !important;
		background-color: #fff;
		color: #000;
	}

	li {
		margin: 1px 1px 1px 0;
		padding: 2px 2px 2px 5px;
		overflow: hidden;
		white-space: nowrap;
		cursor: default;
		zoom: 1;
		overflow: hidden;
		text-overflow: ellipsis;
		background-color: #fff;
		transition: background-color 400ms;
	}

	mark {
		font-weight: normal;
		font-style: normal;
	}

	.option-value {
		display: inline-block;
		text-overflow: ellipsis;
		max-width: 100%;
		color: #000;
		float: left;
		transition: color 400ms;
	}
	
	.option-label {
		display: none;
		max-width: 100%;
		float: right;
		font-size: 90%;
		color: #666;
		text-overflow: ellipsis;
		vertical-align: bottom;
		margin-top: 0.15em;
		margin-left: 10px;
		text-align: right;
		transition: color 400ms;
	}
	
	.has-option-label  {
		.option-label {
			display: inline-block;
		}
	}


	.hidden-item {
		display: none !important;
	}

	.active-item {
		background-color: #39f;
		.option-value {
			color: #fff;
		}
		.option-label {
			color: #eee;
		}
		cursor: default;
	}
}


.validity-alert {
	display: inline-block;
	font: 12px/140% sans-serif;
	z-index: 1000000000;
}

.ws-errorbox {
	display: none;
	border: none;
	margin: 0;
	padding: 0;
	overflow: hidden;
	position: relative;
	
	p {
		margin: 2px 0 3px;
		padding: 0;
		color: #933;
		font: 90%/120% sans-serif;
	}
}

progress {
	position: relative;
	display: inline-block;
	width: 160px;
	height: 16px;

	&[data-position] {
		vertical-align: -0.2em;
		border: 1px solid #ccc;
		background: #e6e6e6;
	}

	> * {
		display: none !important;
	}

	span.progress-value {
		position: absolute;
		display: block !important;
		top: 0;
		left: 0;
		bottom: 0;
		height: 100%;
		background: #a66300;
	}

	&[aria-valuenow] span.progress-value {
		background: #0063a6;
	}
}


/* localStorage */
#swflocalstorageshim-wrapper {
	position: absolute;
	top: -999px;
	left: -9999px;
	overflow: hidden;
	width: 215px;
	min-width: 215px !important;
	z-index: 2147483647;

	.polyfill-exceeded-message {
		margin: 0 0 5px;
		padding: 5px;
		background: #ffd;
		color: #000;
		font-size: 13px;
	}

	object {
		min-height: 138px !important;
		min-width: 215px !important;
	}
}

details {
	overflow: hidden;
}
summary {
	position: relative;
}
.closed-details-child {
	display: none !important;
}

.details-open-indicator {
	margin: -1px 0 0;
	display: inline-block;
	width: 16px;
	height: 11px;
	background: url(details-arrows.png) no-repeat 0 0;
	vertical-align: middle;

	.closed-details-summary & {
		background-position: 0 -20px;
	}

	.polyfill-important & {
		margin: -1px 0 0 !important;
		padding: 0 !important;
		border: 0 !important;
		display: inline-block !important;
		width: 16px !important;
		height: 11px !important;
		background: url(details-arrows.png) no-repeat 0 0 !important;
		vertical-align: middle !important;
	}

	.polyfill-important .closed-details-summary & {
		background-position: 0 -20px !important;
	}
}

summary.summary-has-focus {
	outline: 1px dotted #aaa;
	outline-offset: -1px;
}

```

</details>


---

### 📄 `sdxlib/js/webshims/shims/styles/shim.css` [18.322 octets]
<a id="sdxlib-js-webshims-shims-styles-shim-css"></a> [↩ Retour à l'arborescence](#tree-sdxlib-js-webshims-shims-styles-shim-css)

> **Chemin relatif** : `sdxlib/js/webshims/shims/styles/shim.css`  
> **Taille** : 18.322 octets  
> **Lignes** : 1  
> **Type** : css

```css
.input-picker .ws-picker-body,.input-picker .ws-button-row,.input-picker .picker-grid,.input-picker .picker-list{zoom:1}.input-picker .ws-picker-body:before,.input-picker .ws-button-row:before,.input-picker .picker-grid:before,.input-picker .picker-list:before,.input-picker .ws-picker-body:after,.input-picker .ws-button-row:after,.input-picker .picker-grid:after,.input-picker .picker-list:after{display:table;clear:both;content:' '}.ws-important-hide{display:none!important;visibility:hidden!important;position:absolute;top:-999999px}article,aside,canvas,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}dialog{display:none;postion:absolute;left:0;right:0;border:solid;background:#fff;color:#000;padding:1em}dialog[open]{display:block}audio{display:none;height:0;width:0;overflow:hidden}video{overflow:hidden}video,audio[controls],audio.webshims-controls{display:inline-block;min-height:45px;min-width:40px}video>*,audio>*{visibility:hidden}.no-swf video>*,.no-swfaudio>*{visibility:inherit}.flashblocker-assumed{min-height:20px;min-width:20px;z-index:2147483647}.cue-display{position:absolute!important;margin:0;padding:0!important;max-width:100%!important;max-height:100%!important;border:0!important;background:none!important;text-align:center;visibility:hidden;font-family:sans-serif;font-size:12px;white-space:pre-wrap;overflow:hidden}.cue-display b{font-weight:700}.cue-display i{font-style:italic}.cue-display u{text-decoration:underline}.cue-display span.cue-wrapper{position:absolute;left:0;bottom:0;right:0;display:block;padding:0;margin:0;width:100%;font-size:160%;color:#fff;visibility:visible!important}.cue-display .cue-line{display:block}.cue-display span.cue{display:inline-block;padding:3px 5px;background:#000;background:rgba(0,0,0,.8);color:#fff}.cue-display .description-cues{position:absolute;top:-99px;left:-99px;display:block;width:5px;height:5px;overflow:hidden}mark{background-color:#ff9;color:#000;font-style:italic;font-weight:700}.ws-range,.ws-range *,.placeholder-box,.placeholder-text,.input-buttons,.input-buttons *,.details-open-indicator,.ws-input-seperator,progress span.progress-value{margin:0;padding:0;border:0;width:auto;background:transparent none}output{position:relative}.webshims-visual-hide{position:absolute!important;top:0!important;left:0!important;visibility:hidden!important;width:0!important;height:0!important;overflow:hidden!important}.webshims-visual-hide *{visibility:hidden!important}.placeholder-box{position:relative;display:inline-block;zoom:1}.polyfill-important .placeholder-box{position:relative!important;display:inline-block!important;margin:0!important;padding:0!important;width:auto!important;height:auto!important}.placeholder-box-input{vertical-align:bottom}.placeholder-box-left{float:left}.placeholder-box-right{float:right}.placeholder-text{position:absolute;display:none;top:0;left:0;overflow:hidden;color:#999;line-height:1;cursor:text}.polyfill-important .placeholder-text{margin:0!important;padding-right:0!important;padding-bottom:0!important;display:none!important}.placeholder-visible .placeholder-text,.placeholder-text.placeholder-visible{display:inline-block}.placeholder-box-input .placeholder-text{white-space:nowrap}.placeholder-visible{color:#999}.placeholder-focused.placeholder-visible{color:#ccc}.polyfill-important .placeholder-visible .placeholder-text,.polyfill-important .placeholder-text.placeholder-visible{display:inline-block!important}.has-input-buttons{display:inline-block}.polyfill-important .has-input-buttons{display:inline-block!important}.input-buttons,.step-controls,.ws-popover-opener{zoom:1;overflow:hidden;display:inline-block;font-size:0;vertical-align:middle;margin-top:-3px;margin-left:-20px}.step-controls,.ws-popover-opener{position:relative;float:left;margin:0;height:19px;width:15px}.ws-popover-opener{position:relative;zoom:1;overflow:visible;margin:0 0 0 2px;width:19px;border-radius:3px;cursor:pointer;background:#ccc}.ws-popover-opener span{display:block;position:absolute;top:50%;left:50%;width:16px;height:16px;margin:-8px 0 0 -8px;background:url(forms.png) no-repeat -321px -1px}.color-input-buttons .ws-popover-opener span{background-position:-348px 0}.ws-popover-opener span.ws-color-indicator-bg{background:url(../jpicker/images/preview-opacity.png) no-repeat 0}.ws-popover-opener span.ws-color-indicator{background:0}input[type=color]{width:6.5em}.polyfill-important .input-buttons{display:inline-block!important;padding:0!important;vertical-align:middle!important}.input-buttons.color-input-buttons{margin-left:2px}.input-buttons.input-button-size-1.month-input-buttons,.input-buttons.input-button-size-1.date-input-buttons{margin-left:-24px}.input-buttons.input-button-size-2{margin-left:-39px}.input-buttons.ws-disabled{opacity:.95}.input-buttons.ws-disabled *,.input-buttons.ws-readonly *{cursor:default}.step-controls span{position:absolute;display:inline-block;overflow:hidden;margin:0!important;padding:0!important;width:15px;height:9px;cursor:pointer;font-size:0;line-height:0;background:url(forms.png) no-repeat 0 0}.polyfill-important .step-controls span{display:inline-block!important;margin:0!important;padding:0!important;font-size:0!important}.step-controls span.step-up{top:0;background-position:-80px 0}.step-controls span.step-up:hover{background-position:-105px 0}.step-controls span.step-up.mousepress-ui{background-position:-105px -20px}.ws-disabled .step-controls span.step-up{background-position:-130px 0}.step-controls span.step-down{bottom:0;background-position:-155px 0}.step-controls span.step-down:hover{background-position:-180px 0}.step-controls span.step-down.mousepress-ui{background-position:-180px -20px}.ws-disabled .step-controls span.step-down{background-position:-205px 0}.ws-input{letter-spacing:-.31em;word-spacing:-.43em}.ws-input>*{text-align:center;letter-spacing:normal;word-spacing:normal}.ws-input .ws-input-seperator{vertical-align:middle;width:2%;overflow:hidden}.ws-input+.input-buttons{margin-left:2px}.ws-input input,.ws-input .ws-input-seperator{-moz-box-sizing:border-box;box-sizing:border-box;text-align:center;display:inline-block}.polyfill-important .ws-input input,.polyfill-important.ws-input .ws-input-seperator{display:inline-block!important}.ws-date .mm,.ws-date .dd{width:23.5%}.no-boxsizing .ws-date .mm,.no-boxsizing.ws-date .dd{width:16%}.ws-date .yy{width:48%}.no-boxsizing .ws-date .yy{width:40%}.ws-month .mm,.ws-month .yy{width:47.9%}.no-boxsizing .ws-month .mm,.no-boxsizing.ws-month .yy{width:41%}.ws-range{position:relative;display:inline-block;vertical-align:middle;margin:0;zoom:1;border:0;height:19px;width:155px;border-radius:1px;background:url(range-track.png) 0 center no-repeat;cursor:pointer;font-size:0;line-height:0}.polyfill-important .ws-range{display:inline-block!important;padding:0!important;font-size:0!important}.ws-range .ws-range-thumb{top:0;position:absolute;display:block;z-index:4;overflow:hidden;margin:-2px 0 0 -6px;height:22px;width:11px;background:url(forms.png) -3px 1px no-repeat;cursor:pointer;outline:0;font-size:0;line-height:0}.ws-range .ws-range-thumb:hover{background-position:-20px 1px}.ws-range.ws-focus .ws-range-thumb{background-position:-20px 1px}.ws-range.ws-active .ws-range-thumb{background-position:-37px 1px}.ws-range[aria-disabled=true],.ws-range[aria-readonly=true]{cursor:default;opacity:.95}.ws-range[aria-disabled=true] .ws-range-thumb,.ws-range[aria-readonly=true] .ws-range-thumb{cursor:default}.ws-range[aria-disabled=true] .ws-range-thumb{background-position:-54px 1px}.ws-range .ws-range-rail{position:absolute;display:block;top:0;left:5px;right:5px;bottom:0;margin:0;zoom:1}.ws-range .ws-range-min{position:absolute!important;display:block;padding:0!important;top:0;height:1px;left:0;z-index:1;overflow:hidden;background:#b6e2fb}.ws-range .ws-range-ticks{overflow:hidden;position:absolute;bottom:0;left:0;height:4px;width:1px;margin:0 0 0 -1.5px;font-size:0;line-height:0;text-indent:-999px;background:#ccc}.ws-range.vertical-range{background:url(vertical-range.png) center bottom no-repeat;width:20px}.ws-range.vertical-range .ws-range-thumb{top:0;left:3px;bottom:auto;background:url(vertical-range.png) 0 -51px no-repeat;margin:-6px 0 0 0;height:11px;width:22px}.ws-range.vertical-range .ws-range-thumb:hover,.ws-range.vertical-range.ws-focus .ws-range-thumb{background-position:0 -34px}.ws-range.vertical-range.ws-active .ws-range-thumb{background-position:0 -17px}.ws-range.vertical-range[aria-disabled=true] .ws-range-thumb{background-position:0 0}.ws-range.vertical-range .ws-range-min{top:auto;bottom:1px;left:0;width:1px;height:0}.ws-range.vertical-range .ws-range-rail{top:5px;left:0;right:0;bottom:5px}.ws-range.vertical-range .ws-range-ticks{bottom:auto;left:auto;right:0;height:1px;width:4px}.ws-popover{display:block;visibility:hidden;overflow:hidden;position:absolute;top:0;left:0;padding:0 6px;margin:0 0 0 -6px;z-index:1000;min-width:90px;transition:visibility 400ms ease-in-out}.no-csstransitions .ws-popover,.no-opacity .ws-popover{display:none}.ws-popover button{display:inline-block;overflow:visible;position:relative;margin:0;border:0;padding:0;-moz-box-sizing:content-box;box-sizing:content-box;-webkit-appearance:none;appearance:none;box-sizing:content-box;font-family:arial,sans-serif;background:transparent;cursor:pointer}.ws-popover button::-moz-focus-inner{border:0;padding:0}.ws-popover button[disabled]{cursor:default;color:#888}.ws-popover.ws-po-visible{visibility:visible;display:block}.ws-po-outerbox{position:relative;opacity:0;padding:11px 0 4px;-webkit-transform:translate(0,-100%);transform:translate(0,-100%);transition:all 400ms ease-in-out}.ws-popover.ws-po-visible .ws-po-outerbox{opacity:1;-webkit-transform:translate(0,0);transform:translate(0,0)}.ws-po-box{border:1px solid #ccc;background:#fefefe;padding:5px;box-shadow:2px 2px 4px rgba(0,0,0,.5)}.ws-po-arrow{position:absolute;top:4px;left:20px;display:block;width:0;height:0;border-left:9px solid transparent;border-right:9px solid transparent;border-bottom:7px solid #ccc;border-top:0;zoom:1;font-size:0}html .ws-po-arrow{border-left-color:transparent;border-right-color:transparent}html .ws-po-arrow .ws-po-arrowbox{border-left-color:transparent;border-right-color:transparent}.polyfill-important .ws-po-arrow{border-left-color:transparent!important;border-right-color:transparent!important}.polyfill-important .ws-po-arrow .ws-po-arrowbox{border-left-color:transparent!important;border-right-color:transparent!important}* html .ws-po-arrow{display:none}.ws-po-arrow .ws-po-arrowbox{position:relative;top:1px;left:-9px;display:block;width:0;height:0;border-left:9px solid transparent;border-right:9px solid transparent;border-bottom:7px solid #fefefe;border-top:0;z-index:999999999}.input-picker .ws-prev,.input-picker .ws-next,.input-picker .ws-button-row button{border-radius:4px;background:#ccc;padding:5px 8px;display:inline-block;border:1px solid transparent}.input-picker{outline:0;text-align:center;font-family:sans-serif;width:330px}.input-picker.ws-size-2{width:645px}.input-picker.ws-size-3{width:960px}.input-picker.color-popover{width:590px}.input-picker abbr[title]{cursor:help}.input-picker li,.input-picker button{font-size:13px;line-height:16px;color:#000;transition:all 400ms}.input-picker .ws-focus,.input-picker :focus{outline:1px dotted #000}.input-picker .ws-po-box{position:relative;padding:10px 20px 15px;border-radius:5px;box-shadow:0 0 2px rgba(0,0,0,.3)}.input-picker .ws-prev,.input-picker .ws-next{position:absolute;top:10px;border:1px solid #ccc;border-radius:5px;padding:0;width:24px;height:24px;background:#eee url(forms.png) no-repeat 0 0;z-index:1}.input-picker .ws-prev span,.input-picker .ws-next span{display:none}.input-picker .ws-picker-body{position:relative;padding:46px 0 0;zoom:1;margin:0 -10px}.input-picker .ws-prev{left:20px;background-position:-243px 5px}.input-picker .ws-next{right:20px;background-position:-275px 5px}.input-picker .ws-prev:hover,.input-picker .ws-next:hover{border-color:#666}.input-picker .ws-prev[disabled],.input-picker .ws-next[disabled]{opacity:.4;border-color:#eee}.input-picker .ws-button-row{position:relative;margin:10px 0 0;border-top:1px solid #eee;padding:10px 0 0;text-align:left;z-index:2}.input-picker .ws-button-row button{border:1px solid #ccc;border-radius:5px;box-shadow:1px 1px 0 #fff;background-color:#ddd;background-image:-webkit-linear-gradient(top,#ececec 0,#ddd 100%);background-image:linear-gradient(to bottom,#ececec 0,#ddd 100%);transition:border-color 200ms linear;float:left}.input-picker .ws-button-row button.ws-empty{float:right}.input-picker[data-currentview=setMonthList] .ws-picker-header select{max-width:95%}.input-picker[data-currentview=setDayList] .ws-picker-header select{max-width:40%}.input-picker[data-currentview=setDayList] .ws-picker-header select.month-select{max-width:55%}.input-picker .ws-picker-header{position:absolute;top:-44px;right:0;left:0;margin:0 40px}.input-picker .ws-picker-header button{display:inline-block;width:100%;margin:0;padding:4px 0;font-weight:700;color:#000}.input-picker .ws-picker-header button:hover{text-decoration:underline}.input-picker .ws-picker-header button[disabled]:hover{text-decoration:none}.input-picker .picker-grid{position:relative;zoom:1;overflow:hidden}.input-picker.ws-size-1 .picker-list{float:none;width:auto}.input-picker .picker-list{position:relative;zoom:1;width:290px;float:left;margin:0 10px}.input-picker .picker-list tr{border:0}.input-picker .picker-list th,.input-picker .picker-list td{padding:3px 5px}.input-picker .picker-list.day-list td{padding:2px 1px}.input-picker .picker-list td button{display:block;padding:4px 0;width:100%;border-radius:5px;color:#000;background-color:#fff}.input-picker .picker-list td button.othermonth{color:#888}.input-picker .picker-list td button:hover,.input-picker .picker-list td button.checked-value{color:#fff;background:#000}.input-picker .picker-list td button[disabled],.input-picker .picker-list td button[disabled]:hover{color:#888;background-color:#fff}.input-picker .picker-list table{width:100%;border:0 none;border-collapse:collapse}.input-picker .picker-list th,.input-picker .picker-list td.week-cell{font-size:13px;line-height:1.1em;padding-bottom:3px;text-transform:uppercase;font-weight:700}.input-picker .picker-list th,.input-picker .picker-list td{width:14.2856%}.input-picker .ws-options{margin:10px 0 0;border-top:1px solid #eee;padding:10px 0 0;text-align:left}.input-picker .ws-options h5{margin:0 0 5px;padding:0;font-size:14px;font-weight:700}.input-picker .ws-options ul,.input-picker .ws-options li{padding:0;margin:0;list-style:none}.input-picker .ws-options button{display:block;padding:2px 0;width:100%;text-align:left}.input-picker .ws-options button.ws-focus,.input-picker .ws-options button:focus,.input-picker .ws-options button:hover{text-decoration:underline}.input-picker .ws-options button[disabled],.input-picker .ws-options button[disabled].ws-focus,.input-picker .ws-options button[disabled]:focus,.input-picker .ws-options button[disabled]:hover{color:#888;text-decoration:none}datalist{display:none}.datalist-polyfill{position:absolute!important;font-family:"Lucida Grande","MS Shell Dlg",Calibri,sans-serif;font-size:100%}.datalist-polyfill .datalist-box{position:relative;max-height:200px;overflow:hidden;overflow-x:hidden!important;overflow-y:auto}.datalist-polyfill ul,.datalist-polyfill li{font-size:100%;list-style:none!important}.datalist-polyfill ul{position:static!important;overflow:hidden;margin:0;padding:2px 0;height:auto!important;background-color:#fff;color:#000}.datalist-polyfill li{margin:1px 1px 1px 0;padding:2px 2px 2px 5px;overflow:hidden;white-space:nowrap;cursor:default;zoom:1;overflow:hidden;text-overflow:ellipsis;background-color:#fff;transition:background-color 400ms}.datalist-polyfill mark{font-weight:400;font-style:normal}.datalist-polyfill .option-value{display:inline-block;text-overflow:ellipsis;max-width:100%;color:#000;float:left;transition:color 400ms}.datalist-polyfill .option-label{display:none;max-width:100%;float:right;font-size:90%;color:#666;text-overflow:ellipsis;vertical-align:bottom;margin-top:.15em;margin-left:10px;text-align:right;transition:color 400ms}.datalist-polyfill .has-option-label .option-label{display:inline-block}.datalist-polyfill .hidden-item{display:none!important}.datalist-polyfill .active-item{background-color:#39f;cursor:default}.datalist-polyfill .active-item .option-value{color:#fff}.datalist-polyfill .active-item .option-label{color:#eee}.validity-alert{display:inline-block;font:12px/140% sans-serif;z-index:1000000000}.ws-errorbox{display:none;border:0;margin:0;padding:0;overflow:hidden;position:relative}.ws-errorbox p{margin:2px 0 3px;padding:0;color:#933;font:90%/120% sans-serif}progress{position:relative;display:inline-block;width:160px;height:16px}progress[data-position]{vertical-align:-.2em;border:1px solid #ccc;background:#e6e6e6}progress>*{display:none!important}progress span.progress-value{position:absolute;display:block!important;top:0;left:0;bottom:0;height:100%;background:#a66300}progress[aria-valuenow] span.progress-value{background:#0063a6}#swflocalstorageshim-wrapper{position:absolute;top:-999px;left:-9999px;overflow:hidden;width:215px;min-width:215px!important;z-index:2147483647}#swflocalstorageshim-wrapper .polyfill-exceeded-message{margin:0 0 5px;padding:5px;background:#ffd;color:#000;font-size:13px}#swflocalstorageshim-wrapper object{min-height:138px!important;min-width:215px!important}details{overflow:hidden}summary{position:relative}.closed-details-child{display:none!important}.details-open-indicator{margin:-1px 0 0;display:inline-block;width:16px;height:11px;background:url(details-arrows.png) no-repeat 0 0;vertical-align:middle}.closed-details-summary .details-open-indicator{background-position:0 -20px}.polyfill-important .details-open-indicator{margin:-1px 0 0!important;padding:0!important;border:0!important;display:inline-block!important;width:16px!important;height:11px!important;background:url(details-arrows.png) no-repeat 0 0!important;vertical-align:middle!important}.polyfill-important .closed-details-summary .details-open-indicator{background-position:0 -20px!important}summary.summary-has-focus{outline:1px dotted #aaa;outline-offset:-1px}
```


---

### 📄 `sdxlib/services/xsp/thumbnailService.xsp` [2.651 octets]
<a id="sdxlib-services-xsp-thumbnailService-xsp"></a> [↩ Retour à l'arborescence](#tree-sdxlib-services-xsp-thumbnailService-xsp)

> **Chemin relatif** : `sdxlib/services/xsp/thumbnailService.xsp`  
> **Taille** : 2.651 octets  
> **Lignes** : 76  
> **Type** : text

```text
<?xml version="1.0"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page xmlns:xsp="http://apache.org/xsp">
    <sdx:page xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" show="user get post additions">
		<title>Thumbnail Service</title>
		<xsp:logic>
			String docId = request.getParameter("docId");
			String imageName = request.getParameter("imageName");


			String uri = request.getRequestURI();		
			//App
			String contextPath = request.getContextPath();
			int stringStart = contextPath.length() +1;
			int stringEnd = uri.indexOf("/", stringStart);
			String sdxApp = uri.substring(stringStart, stringEnd);

			String prefix;
			String imagesPath;
			String thumbnailPath;
			File imagesDirectory;
			String[] images;
			String image;
			String imagesBasePath = context.getRealPath("/")+"documents/"+sdxApp;
			String thumbnailBasePath = context.getRealPath("/")+"thumbnails/"+sdxApp;


			prefix = docId.substring( 0, docId.lastIndexOf("-") ) + File.separator;	
			prefix += docId.substring( docId.lastIndexOf("-")+1, docId.lastIndexOf("-")+5 ) + File.separator;	
			prefix += docId + File.separator;	

			imagesPath = imagesBasePath + File.separator + prefix + File.separator;
			thumbnailPath = thumbnailBasePath + File.separator + prefix + File.separator;
			System.out.println(imagesPath);
			System.out.println(thumbnailPath);


			image=imageName;
			System.out.println(image);
			if (image!=null){

				
				fr.gouv.equipement.documentation.pandoc.files.ThumbnailTool.generate(imagesPath+image, thumbnailPath);
			}
		</xsp:logic>
	</sdx:page>
</xsp:page>

```


---

### 📄 `sdxlib/xsl/404.xsl` [2.296 octets]
<a id="sdxlib-xsl-404-xsl"></a> [↩ Retour à l'arborescence](#tree-sdxlib-xsl-404-xsl)

> **Chemin relatif** : `sdxlib/xsl/404.xsl`  
> **Taille** : 2.296 octets  
> **Lignes** : 75  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../../transforml/xmldoc/xsl2html.xsl"?>
<!--

   Notix, suppression, présentation xhtml
   **************************************


Titre        : Notix, suppression, présentation xhtml
Copyright    : © 2005 "Ministère des Transports", "AJLSM" <http://ajlsm.com>.
Licence      : "GPL" <http://www.gnu.org/copyleft/gpl.html>
Créateur     : [FG] "Frédéric Glorieux" <frederic.glorieux@ajlsm.com>
              ("AJLSM" <http://ajlsm.com>)



<license>

Notix : notices bibliographiques et d'autorités, dans une base XML.

Copyright (C) 2005 Ministère des Transports, AJLSM.

Ministère des Transports, de l'Équipement, du Tourisme et de la Mer (FRANCE),
    Centre d'Études Technique de l’Équipement Nord - Picardie (CETE Nord - Picardie),
    Point d'appui national documentaire (Pandoc),
    2 rue de Bruxelles – BP 275, 59019 LILLE Cedex, France.
AJLSM,
    17 rue Vital-Carles, 33000 Bordeaux, France

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html

</license>




-->
<xsl:transform version="1.1"
	xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:i18n="http://apache.org/cocoon/i18n/2.1"
	xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx"
>

	<xsl:template match="/">
	<html
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:i18n="http://apache.org/cocoon/i18n/2.1"
	>
		<head>
			<title>404</title>
			<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
		</head>
		<body>
			<h1>Ressource non trouvée</h1>
		</body>
	</html>
	</xsl:template>
</xsl:transform>

```


---

### 📄 `sdxlib/xsl/ajoutepanier.xsl` [1.535 octets]
<a id="sdxlib-xsl-ajoutepanier-xsl"></a> [↩ Retour à l'arborescence](#tree-sdxlib-xsl-ajoutepanier-xsl)

> **Chemin relatif** : `sdxlib/xsl/ajoutepanier.xsl`  
> **Taille** : 1.535 octets  
> **Lignes** : 44  
> **Type** : text

```text
﻿<?xml version="1.0" encoding = "UTF-8" ?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet   
	xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
	xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" 
	version="1.0" 
	exclude-result-prefixes="sdx xsl">
	<xsl:output method="text" omit-xml-declaration="yes" indent="no"/>


	<xsl:template match="/">
		<size><xsl:value-of select="sdx:document/panier/size"/></size>
	</xsl:template>
	
</xsl:stylesheet>

```


---

### 📄 `sdxlib/xsl/contenupanier.xsl` [1.670 octets]
<a id="sdxlib-xsl-contenupanier-xsl"></a> [↩ Retour à l'arborescence](#tree-sdxlib-xsl-contenupanier-xsl)

> **Chemin relatif** : `sdxlib/xsl/contenupanier.xsl`  
> **Taille** : 1.670 octets  
> **Lignes** : 53  
> **Type** : text

```text
﻿<?xml version="1.0" encoding = "UTF-8" ?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet   
	xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
	xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" 
	version="1.0" 
	exclude-result-prefixes="sdx xsl">
	<xsl:output method="text" omit-xml-declaration="yes" indent="no"/>


	<xsl:template match="panier">
		<racine>
		[
			<xsl:for-each select="id">
				"<xsl:value-of select="."/>"
				<xsl:if test="position() != last()">
					<xsl:text>,</xsl:text>
				</xsl:if>
			</xsl:for-each>
		]
		</racine>
	</xsl:template>

</xsl:stylesheet>

```


---

### 📄 `sdxlib/xsl/extract-id.xsl` [1.989 octets]
<a id="sdxlib-xsl-extract-id-xsl"></a> [↩ Retour à l'arborescence](#tree-sdxlib-xsl-extract-id-xsl)

> **Chemin relatif** : `sdxlib/xsl/extract-id.xsl`  
> **Taille** : 1.989 octets  
> **Lignes** : 57  
> **Type** : text

```text
﻿<?xml version="1.0" encoding = "UTF-8" ?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet   
	xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
	xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" 
	version="1.0" 
	exclude-result-prefixes="sdx xsl">


	<xsl:template match="/">
		<result>		
			<xsl:variable name="npages"><xsl:value-of select="//sdx:results/@nbPages"/></xsl:variable>
			<xsl:variable name="page"><xsl:value-of select="//sdx:results/@page"/></xsl:variable>
			<xsl:if test="number($page)=1">
				<isFirst/>
			</xsl:if>
			<xsl:if test="number($page)=number($npages)">
				<isLast/>
			</xsl:if>
				<page><xsl:value-of select="$page"/></page>
				<npages><xsl:value-of select="$npages"/></npages>
			<xsl:for-each select="//sdx:result/sdx:field[@name='sdxdocid']">
				<docid><xsl:value-of select="@value"/></docid>
			</xsl:for-each>
		</result>
	</xsl:template>
	
</xsl:stylesheet>

```


---

### 📄 `sdxlib/xsl/retraitpanier.xsl` [1.535 octets]
<a id="sdxlib-xsl-retraitpanier-xsl"></a> [↩ Retour à l'arborescence](#tree-sdxlib-xsl-retraitpanier-xsl)

> **Chemin relatif** : `sdxlib/xsl/retraitpanier.xsl`  
> **Taille** : 1.535 octets  
> **Lignes** : 44  
> **Type** : text

```text
﻿<?xml version="1.0" encoding = "UTF-8" ?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet   
	xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
	xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" 
	version="1.0" 
	exclude-result-prefixes="sdx xsl">
	<xsl:output method="text" omit-xml-declaration="yes" indent="no"/>


	<xsl:template match="/">
		<size><xsl:value-of select="sdx:document/panier/size"/></size>
	</xsl:template>
	
</xsl:stylesheet>

```


---

### 📄 `sdxlib/xsl/sdx-default.xsl` [38.508 octets]
<a id="sdxlib-xsl-sdx-default-xsl"></a> [↩ Retour à l'arborescence](#tree-sdxlib-xsl-sdx-default-xsl)

> **Chemin relatif** : `sdxlib/xsl/sdx-default.xsl`  
> **Taille** : 38.508 octets  
> **Lignes** : 1035  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (1035 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet xmlns="http://www.w3.org/1999/xhtml"  version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" xmlns:url="http://www.jclark.com/xt/java/java.net.URLEncoder" exclude-result-prefixes="xsl sdx url">
	<!--
	|
	|  ======== SDX DEFAULT ==========
	|
	|  Cette feuille fournie des modèles basés sur les
	|  éléments SDX par défaut.
	|  Elle est augmentée à l'occasion d'une application
	|  dont certains modèles s'avèrent génériques.
	|
	|  TODO: modulariser plus
	|        relier à une feuille sdx.css
	|        localiser les messages (sans fonction document())
	|
	|-->
	<!--
	|
	|    Présentation de résultats
	|
	|-->
	<!-- sdx:results -->

	<xsl:variable name="queryParameters">
		<xsl:call-template name="getQueryParameters"/>
	</xsl:variable>

	<xsl:variable name="sortParameters">
		<xsl:call-template name="getSortParameters"/>
	</xsl:variable>
	<xsl:variable name="luceneQuery">
		<xsl:value-of select="/sdx:document/sdx:results/sdx:query/@escapedLuceneQuery"/>
	</xsl:variable>
	<xsl:variable name="qURLParam">
		<xsl:value-of select="//sdx:parameters/sdx:parameter[@name='q']/@escapedValue"/>
	</xsl:variable>
	<xsl:variable name="nURLParam">
		<xsl:value-of select="//sdx:parameters/sdx:parameter[@name='n']/@escapedValue"/>
	</xsl:variable>
	<xsl:variable name="sortURLParam">
		<xsl:value-of select="//sdx:parameters/sdx:parameter[@name='sort']/@escapedValue"/>
	</xsl:variable>
	<xsl:variable name="orderURLParam">
		<xsl:value-of select="//sdx:parameters/sdx:parameter[@name='order']/@escapedValue"/>
	</xsl:variable>
	<xsl:variable name="idURLParam">
		<xsl:value-of select="//sdx:parameters/sdx:parameter[@name='id']/@escapedValue"/>
	</xsl:variable>

	<xsl:template match="sdx:results" name="sdx:results">
		<xsl:param name="sdx:results" select="."/>
		<xsl:apply-templates select="$sdx:results" mode="sdx:head"/>
		<hr/>
		<div class="sdx_results">
			<xsl:apply-templates/>
		</div>
		<hr/>
		<xsl:apply-templates select="$sdx:results" mode="sdx:foot"/>
	</xsl:template>
    
    
	<xsl:template name="sdx:resultsindex-head" match="sdx:results">
		<xsl:param name="sdx:results" select="."/>
		<xsl:param name="action" select="/sdx:document/@uri"/>
		<!-- target is forbidden in stricts DTDs -->
		<!--<xsl:param name="target" select="'_self'"/>-->
		<xsl:param name="search" select="true()"/>
		<xsl:param name="queryParam" select="'q'"/>
		<xsl:param name="bqidParam"/>
		<xsl:param name="qidParam" select="'qid'"/>
	
		<xsl:param name="champ"/>
		<xsl:param name="debut"/>
		<xsl:if test="$search">
			<xsl:call-template name="sdx:results-search">
				<xsl:with-param name="sdx:results" select="$sdx:results"/>
				<xsl:with-param name="bqidParam" select="$bqidParam"/>
				<xsl:with-param name="queryParam" select="$queryParam"/>
				<xsl:with-param name="champ" select="$champ"/>
				<xsl:with-param name="debut" select="$debut"/>
			</xsl:call-template>
		</xsl:if>

		<form class="sdx_results-head" action="{$action}">
			<div>
				<input type="hidden" name="{$qidParam}" value="{$sdx:results/@qid}"/>	    
				<input type="hidden" name="champ" value="{$champ}"/>
				<input type="hidden" name="debut" value="{$debut}"/>
		  
				<xsl:apply-templates select="$sdx:results/@pages"/>
				<xsl:text> &#160; </xsl:text>
				<xsl:apply-templates select="$sdx:results/@nb"/>
				<xsl:text> &#160; </xsl:text>
				<xsl:apply-templates select="$sdx:results/@hpp"/>
			</div>
		</form>
	</xsl:template>
    
    
	<!-- ligne d'information de résultats -->
	<xsl:template name="sdx:results-head" match="sdx:results" mode="sdx:head">
		<xsl:param name="sdx:results" select="."/>
		<xsl:param name="action" select="/sdx:document/@uri"/>
		<xsl:param name="search" select="true()"/>
		<xsl:param name="queryParam" select="'q'"/>
		<xsl:param name="bqidParam"/>
		<xsl:param name="qidParam" select="'qid'"/>
		<xsl:param name="id_prefix" />
	
		<xsl:param name="champ"/>
		<xsl:param name="debut"/>
	
		<xsl:if test="$search">
			<xsl:call-template name="sdx:results-search">
				<xsl:with-param name="sdx:results" select="$sdx:results"/>
				<xsl:with-param name="bqidParam" select="$bqidParam"/>
				<xsl:with-param name="queryParam" select="$queryParam"/>
				<xsl:with-param name="champ" select="$champ"/>
				<xsl:with-param name="debut" select="$debut"/>
			</xsl:call-template>
		</xsl:if>

		<!-- 2004-09-30 action="{$action}" remplace par action="" en raison des problemes de DNS i2 et equipement.gouv.fr -->
		<form class="sdx_results-head" action="">
			<div>
				<!--
				<input type="hidden" name="{$qidParam}" value="{$sdx:results/@qid}"/>
				-->
				<input type="hidden" name="champ" value="{$champ}"/>
				<input type="hidden" name="debut" value="{$debut}"/>
				<!--
				<input type="hidden" name="sf" value="{//sdx:parameter[@name='sf']/@value}"/>
				<input type="hidden" name="so" value="{//sdx:parameter[@name='so']/@value}"/>
				-->
				<xsl:call-template name="getQueryParametersAsInput"/>
				<xsl:call-template name="getSortParametersAsInput"/>
		
				<!-- Navigation Pages -->
				<xsl:apply-templates select="$sdx:results/@pages">
					<xsl:with-param name="id_prefix"><xsl:value-of select="$id_prefix" /></xsl:with-param>
				</xsl:apply-templates>
				<!-- Nombre de documents -->
				<xsl:text> &#160; </xsl:text>
				<xsl:apply-templates select="$sdx:results/@nb" />
				<!-- ?? -->
				<xsl:text> &#160; </xsl:text>
				<xsl:apply-templates select="$sdx:results/@hpp"/>
			</div>
		</form>
	</xsl:template>

	<!-- rechercher dans ces résultats -->
	<xsl:template name="sdx:results-search">

	</xsl:template>

	<!-- présentation des pages -->
	<!--
	<xsl:template match="sdx:results/@pages[number(.) &gt; 1] | sdx:terms/@pages[number(.) &gt; 1]" name="sdx:results-pages">
	<xsl:template match="sdx:results/@pages  | sdx:terms/@pages[number(.) &gt; 1]" name="sdx:results-pages">
	-->
	<xsl:template match="sdx:results/@pages[number(.) &gt; 1] | sdx:terms/@pages[number(.) &gt; 1] | sdx:results/@pages[number(.) = 1][//sdx:parameters/sdx:parameter[@name='q']/@escapedValue!='']" name="sdx:results-pages">
		<xsl:param name="pages" select="."/>
		<xsl:param name="id_prefix" />
		<xsl:variable name="action" select="/sdx:document/@uri"/>

		<xsl:if test="contains($action,'document.xsp')">
			<xsl:text>Document</xsl:text>
		</xsl:if>
		<xsl:if test="not(contains($action,'document.xsp') or contains($action,'document_eng.xsp'))">
			<xsl:text>Page</xsl:text>
		</xsl:if>
		<xsl:text>&#160;</xsl:text>
		
		<xsl:apply-templates select="$pages/../@page">
			<xsl:with-param name="id_prefix"><xsl:value-of select="$id_prefix" /></xsl:with-param>
		</xsl:apply-templates>

<!--
		<xsl:text>/</xsl:text>
		<xsl:value-of select="$pages"/>
		<xsl:text>&#32;</xsl:text>
		-->
	</xsl:template>

	<!-- boutons pages précédente-actuelle-suivante, dans un formulaire -->
	<xsl:template match="sdx:results/@page | sdx:terms/@page" name="sdx:results-page">
		<xsl:param name="page" select="."/>
		<xsl:param name="size" select="string-length(string($page/../@pages))"/>
		<xsl:param name="pages" select="$page/../@pages"/>
		<xsl:param name="id_prefix" />
		<xsl:param name="pageParam">
			<xsl:choose>
				<!-- si navigation de résultat en résultat -->
				<xsl:when test="number(../@hpp)=1">n</xsl:when>
				<xsl:otherwise>p</xsl:otherwise>
			</xsl:choose>
		</xsl:param>
		<!--
		<xsl:param name="sfParam" select="//sdx:parameter[@name='sf']/@value"/>
		<xsl:param name="soParam" select="//sdx:parameter[@name='so']/@value"/>
		-->
		<xsl:param name="sortParam" select="//sdx:parameter[@name='sort']/@value"/>
		<xsl:param name="orderParam" select="//sdx:parameter[@name='order']/@value"/>
		<xsl:variable name="prev">
			<xsl:choose>
				<xsl:when test="number($page) &gt; 1">
					<xsl:value-of select="number($page)-1"/>
				</xsl:when>
				<xsl:otherwise>1</xsl:otherwise>
			</xsl:choose>
		</xsl:variable>
		<xsl:variable name="next">
			<xsl:choose>
				<xsl:when test="number($page) &lt; number($pages)">
					<xsl:value-of select="number($page) +1"/>
				</xsl:when>
				<xsl:otherwise>
					<xsl:value-of select="number($pages)"/>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:variable>
		<xsl:variable name="current_baseuri">
			<xsl:call-template name="current_uri">
				<xsl:with-param name="text"><xsl:value-of select="/sdx:document/@uri" /></xsl:with-param>
			</xsl:call-template>
			<xsl:text>?</xsl:text>
		</xsl:variable>
		<xsl:variable name="current_uri">
			<xsl:call-template name="current_uri">
				<xsl:with-param name="text"><xsl:value-of select="/sdx:document/@uri" /></xsl:with-param>
			</xsl:call-template>
			<xsl:text>?</xsl:text>
			<xsl:value-of select="$queryParameters"/>
			<!--
			<xsl:text>?qid=</xsl:text>
			<xsl:value-of select="//sdx:results/@qid" />
			
			<xsl:if test="//debut">
				<xsl:text>&amp;debut=</xsl:text>
				<xsl:value-of select="//debut" />
			</xsl:if>
			<xsl:if test="//champ">
				<xsl:text>&amp;champ=</xsl:text>
				<xsl:value-of select="//champ" />
			</xsl:if>
			<xsl:if test="//type">
				<xsl:text>&amp;type=</xsl:text>
				<xsl:value-of select="//type" />
			</xsl:if>
			<xsl:if test="//nominput">
				<xsl:text>&amp;nominput=</xsl:text>
				<xsl:value-of select="//nominput" />
			</xsl:if>
			<xsl:if test="//sdx:parameter[@name='js']">
				<xsl:text>&amp;js=</xsl:text>
				<xsl:value-of select="//sdx:parameter[@name='js']/@value" />
			</xsl:if>
			-->
		</xsl:variable>
<!--
		<span class="nowrap">
			<a href="{$current_uri}&amp;{$pageParam}={$prev}&amp;sf={$sfParam}&amp;so={$soParam}" id="{$id_prefix}sdx_prev" accesskey="-" title=" &lt; page {$prev} (alt -) ">
				<img src="icons/prec.png" alt="&lt;" height="20" width="20" />
			</a>
			<label for="{$id_prefix}sdx_active" class="hidden">Page</label>
			<input id="{$id_prefix}sdx_active" type="text" name="{$pageParam}" value="{$page}" size="{$size}"/>
			<a href="{$current_uri}&amp;{$pageParam}={$next}&amp;sf={$sfParam}&amp;so={$soParam}" id="{$id_prefix}sdx_next" accesskey="=" title=" (alt +) page {$next} &gt;">
				<img src="icons/suiv.png" alt="&gt;" height="20" width="20" />
			</a>
		</span>
-->
<!--
		<span class="nowrap">
			<a href="{$current_uri}&amp;{$pageParam}={$prev}&amp;sort={$sortParam}&amp;order={$orderParam}" id="{$id_prefix}sdx_prev" accesskey="-" title=" &lt; page {$prev} (alt -) ">
				<img src="icons/prec.png" alt="&lt;" height="20" width="20" />
			</a>
			<label for="{$id_prefix}sdx_active" class="hidden">Page</label>
			<input id="{$id_prefix}sdx_active" type="text" name="{$pageParam}" value="{$page}" size="{$size}"/>
			<a href="{$current_uri}&amp;{$pageParam}={$next}&amp;sort={$sortParam}&amp;order={$orderParam}" id="{$id_prefix}sdx_next" accesskey="=" title=" (alt +) page {$next} &gt;">
				<img src="icons/suiv.png" alt="&gt;" height="20" width="20" />
			</a>
		</span>
-->
		<xsl:choose>
			<xsl:when test="contains($current_uri, 'document.xsp') and contains(//sdx:query/@luceneQuery, 'sdxdocid')">
				<xsl:variable name="docurl">
					<xsl:value-of select="concat('cocoon:/extract-id.xml?q=',$qURLParam,'&amp;',$pageParam,'=',$nURLParam,'&amp;sort=',$sortURLParam,'&amp;order=',$orderURLParam)"/>
				</xsl:variable>
				<span class="nowrap">
					<xsl:if test="not(document($docurl)/result/isFirst)">
						<xsl:variable name="prevp"><xsl:value-of select="number($nURLParam)-1"/></xsl:variable>
						<xsl:variable name="prevIdURL"><xsl:value-of select="concat('cocoon:/extract-id.xml?q=',$qURLParam,'&amp;',$pageParam,'=',$prevp,'&amp;sort=',$sortURLParam,'&amp;order=',$orderURLParam)"/></xsl:variable>
						<xsl:variable name="prevId"><xsl:value-of select="document($prevIdURL)/result/docid"/></xsl:variable>				
						<a href="{$current_baseuri}id={$prevId}&amp;q={$qURLParam}&amp;{$pageParam}={$prevp}&amp;sort={$sortURLParam}&amp;order={$orderURLParam}" id="{$id_prefix}sdx_prev" accesskey="-" title=" &lt; page {$prev} (alt -) ">
							<img src="icons/prec.png" alt="&lt;" height="20" width="20" />
						</a>
					</xsl:if>
						<xsl:variable name="npages"><xsl:value-of select="document($docurl)/result/npages"/></xsl:variable>
						<label for="{$id_prefix}sdx_active" class="hidden">Page</label>
						<input id="{$id_prefix}sdx_active" type="text" name="{$pageParam}" value="{$nURLParam}" size="{$size}"/>
					<xsl:if test="not(document($docurl)/result/isLast)">
						<xsl:variable name="nextp"><xsl:value-of select="number($nURLParam)+1"/></xsl:variable>
						<xsl:variable name="nextIdURL"><xsl:value-of select="concat('cocoon:/extract-id.xml?q=',$qURLParam,'&amp;',$pageParam,'=',$nextp,'&amp;sort=',$sortURLParam,'&amp;order=',$orderURLParam)"/></xsl:variable>
						<xsl:variable name="nextId"><xsl:value-of select="document($nextIdURL)/result/docid"/></xsl:variable>						
						<a href="{$current_baseuri}id={$nextId}&amp;q={$qURLParam}&amp;{$pageParam}={$nextp}&amp;sort={$sortURLParam}&amp;order={$orderURLParam}" id="{$id_prefix}sdx_next" accesskey="=" title=" (alt +) page {$next} &gt;">
							<img src="icons/suiv.png" alt="&gt;" height="20" width="20" />
						</a>
					</xsl:if>
					<xsl:text>/</xsl:text>
					<xsl:value-of select="document($docurl)/result/npages"/>
					<xsl:text>&#32;</xsl:text>
				</span>
			</xsl:when>
			<xsl:otherwise>
				<span class="nowrap">
					<a href="{$current_uri}&amp;{$pageParam}={$prev}&amp;sort={$sortParam}&amp;order={$orderParam}" id="{$id_prefix}sdx_prev" accesskey="-" title=" &lt; page {$prev} (alt -) ">
						<img src="icons/prec.png" alt="&lt;" height="20" width="20" />
					</a>
					<label for="{$id_prefix}sdx_active" class="hidden">Page</label>
					<input id="{$id_prefix}sdx_active" type="text" name="{$pageParam}" value="{$page}" size="{$size}"/>
					<a href="{$current_uri}&amp;{$pageParam}={$next}&amp;sort={$sortParam}&amp;order={$orderParam}" id="{$id_prefix}sdx_next" accesskey="=" title=" (alt +) page {$next} &gt;">
						<img src="icons/suiv.png" alt="&gt;" height="20" width="20" />
					</a>
				</span>
				<xsl:text>/</xsl:text>
				<xsl:value-of select="$pages"/>
				<xsl:text>&#32;</xsl:text>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	
	<xsl:template name="current_uri"> 
		<xsl:param name="text" select="."/> 

		<xsl:choose> 
			<xsl:when test="contains($text, '/')">       
				<!--<xsl:value-of select="substring-before($text, '/')" disable-output-escaping="yes"/> 
				<br/> -->
				<xsl:call-template name="current_uri"> 
					<xsl:with-param name="text" select="substring-after($text,'/')"/> 
				</xsl:call-template> 
			</xsl:when> 
			<xsl:otherwise> 
				<xsl:value-of select="$text" disable-output-escaping="yes" /> 
			</xsl:otherwise> 
		</xsl:choose> 
	</xsl:template> 

    
	<!-- nombre de résultats -->
	<xsl:template match="sdx:results/@nb[number(.)&lt;1] | sdx:terms/@nb[number(.)&lt;1]">
		<xsl:text>Aucun résultat</xsl:text>
	</xsl:template>
    
	<xsl:template match="sdx:results/@nb[number(.) &gt; 1][../@start != ../@end] | sdx:terms/@nb[number(.) &gt; 1][../@start != ../@end]" name="sdx:results-nb">
		<xsl:param name="nb" select="."/>
		<xsl:param name="start" select="$nb/../@start"/>
		<xsl:param name="end" select="$nb/../@end"/>
		<xsl:param name="uri" select="/sdx:document/@uri"/>

		<xsl:text>Document&#160;</xsl:text>
		<xsl:value-of select="$start"/>
		<xsl:text>&#160;à&#160;</xsl:text>
		<xsl:value-of select="$end"/>
		<xsl:text>&#160;/&#160;</xsl:text>
		<xsl:value-of select="$nb"/>
		<xsl:text>&#32;</xsl:text>
	</xsl:template>
	
	<!-- navigation page Ã  page de rÃ©sultats -->
	<xsl:template name="sdx:results-foot" match="sdx:results | sdx:terms" mode="sdx:foot">
		<!-- noeud contextuel -->
		<xsl:param name="sdx:results" select="."/>
		<xsl:param name="page" select="$sdx:results/@page"/>
		<xsl:param name="pages" select="$sdx:results/@pages"/>
		<!-- url cible -->
		<xsl:param name="action" select="/sdx:document/@uri"/>
		<xsl:param name="target" select="'_self'"/>
		<xsl:param name="method" select="'get'"/>
		<xsl:param name="search" select="true()"/>
		<!-- paramÃ¨tres http -->
		<xsl:param name="qidParam" select="'qid'"/>
		<xsl:param name="hppParam" select="'hpp'"/>
		<xsl:param name="pageParam">
			<xsl:choose>
				<!-- si navigation de rÃ©sultat en rÃ©sultat -->
				<xsl:when test="number(@hpp)=1">n</xsl:when>
				<xsl:otherwise>p</xsl:otherwise>
			</xsl:choose>
		</xsl:param>
		<xsl:param name="size" select="5"/>
		<!-- style bouton -->
		<xsl:variable name="style-key" select="concat(
		'cursor: pointer; font-family: monospace; font-weight:900; text-align: center; width:',
		string-length($pages)+2,
		'ex;'
		)"/>
		<!-- style lien -->
		<xsl:variable name="style-link" select="concat('text-align:center; width:', string-length(string(@pages)), 'ex')"/>
		<xsl:variable name="href" select="concat($action, '?', $qidParam, '=', @qid, '&amp;', $hppParam, '=', @hpp, '&amp;', $pageParam, '=')"/>
		<xsl:if test="number(@pages) &gt; 1">
			<table width="100%" cellpadding="0" cellspacing="1" class="pages">
				<tr>
					<!--<form action="{$action}" target="{$target}" method="{$method}">-->
					<form action="{$action}" method="{$method}">
						<input type="hidden" name="{$qidParam}" value="{@qid}"/>
						<input type="hidden" name="{$hppParam}" value="{@hpp}"/>
						<td class="nowrap">
							<!-- |< -->
							<input class="sdx_first" onclick="this.form.{$pageParam}.value='1'; return true; " type="submit" style="{$style-key}">
								<xsl:attribute name="value">1</xsl:attribute>
								<xsl:attribute name="title"> |&lt; page 1 </xsl:attribute>
							</input>
							<!-- << -->
							<xsl:if test="($page - $size - 1) &gt; 1">
								<input class="sdx_prev" onclick="this.form.{$pageParam}.value='{$page - $size - 1}'; return true; " type="submit" style="{$style-key}">
									<xsl:attribute name="value">&lt;&lt;</xsl:attribute>
									<xsl:attribute name="title">  &lt;&lt; page <xsl:value-of select="($page - $size - 1)"/></xsl:attribute>
								</input>
							</xsl:if>
						</td>
						<!-- pages - -->
						<td width="50%" align="right" class="nowrap">&#160;
							<xsl:text>&#160;</xsl:text>
							<xsl:if test="number(@page)&gt;1">
								<xsl:call-template name="_hppCount">
									<xsl:with-param name="min">
										<xsl:choose>
											<xsl:when test="number(@page)-$size &gt; 0">
												<xsl:value-of select="number(@page)-$size"/>
											</xsl:when>
											<xsl:otherwise>1</xsl:otherwise>
										</xsl:choose>
									</xsl:with-param>
									<xsl:with-param name="max" select="number(@page)-1"/>
									<xsl:with-param name="href" select="$href"/>
								</xsl:call-template>
							</xsl:if>
							<xsl:text>&#160;</xsl:text>
						</td>
						<!-- page active -->
						<td align="center" valign="middle" class="nowrap">
							<xsl:apply-templates select="$sdx:results/@page">
								<xsl:with-param name="pageParam" select="$pageParam"/>
							</xsl:apply-templates>
						</td>
						<!-- pages + -->
						<td width="50%" align="left" class="nowrap">
							<xsl:text>&#160;</xsl:text>
							<xsl:if test="number(@page) &lt; number(@pages)">
								<xsl:call-template name="_hppCount">
									<xsl:with-param name="min" select="number(@page) + 1"/>
									<xsl:with-param name="max">
										<xsl:choose>
											<xsl:when test="(number(@page)+$size) &lt;= number(@pages)">
												<xsl:value-of select="number(@page)+$size"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:value-of select="number(@pages)"/>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:with-param>
									<xsl:with-param name="href" select="$href"/>
									<xsl:with-param name="page" select="$page"/>
								</xsl:call-template>
							</xsl:if>
							<xsl:text>&#160;</xsl:text>
						</td>
						<td class="nowrap">
							<xsl:if test="($page + $size +1) &lt; $pages">
								<input class="sdx_next" onclick="this.form.{$pageParam}.value='{$page + $size +1}'; return true; " type="submit" style="{$style-key}">
									<xsl:attribute name="value">&gt;&gt;</xsl:attribute>
									<xsl:attribute name="title"> page <xsl:value-of select="$page + $size + 1"/> &gt;&gt; </xsl:attribute>
								</input>
							</xsl:if>
							<!-- derniÃ¨re page -->
							<input class="sdx_last" onclick="this.form.{$pageParam}.value='{$pages}';return true;" value="{$pages}" type="submit" style="{$style-key}">
								<xsl:attribute name="title"> page <xsl:value-of select="$pages"/> &gt;| </xsl:attribute>
							</input>
						</td>
					</form>
					<xsl:if test="$search">
						<td class="nowrap">
							<xsl:call-template name="sdx:results-search">
								<xsl:with-param name="sdx:results" select="$sdx:results"/>
							</xsl:call-template>
						</td>
					</xsl:if>
				</tr>
			</table>
		</xsl:if>
	</xsl:template>
	
	<!-- modÃ¨le privÃ© de comptage des pages "hitsPerPage" -->
	<xsl:template name="_hppCount">
		<xsl:param name="href"/>
		<xsl:param name="min"/>
		<xsl:param name="max"/>
		<xsl:variable name="style-link" select="concat('width:', string-length(string(@pages)), 'ex')"/>
		<xsl:text>&#160;</xsl:text>
		<a class="sdx_page" href="{$href}{$min}">
			<xsl:value-of select="
				format-number(
				$min,
				substring (
					'000000000', 1,
					string-length(@pages)
				)
			)
                        "/>
		</a>
		<xsl:text>&#160;</xsl:text>
		<xsl:if test="$min &lt; $max">
			<xsl:call-template name="_hppCount">
				<xsl:with-param name="min" select="$min+1"/>
				<xsl:with-param name="max" select="$max"/>
				<xsl:with-param name="href" select="$href"/>
			</xsl:call-template>
		</xsl:if>
	</xsl:template>

	<!-- delete results
	should be used in a sdx:results scope
	parameters action and target specifies the page wich do the job
	-->
	<xsl:template name="sdx:results-delete">
		<xsl:param name="action" select="/sdx:document/@uri"/>
		<xsl:param name="target" select="'_self'"/>
		<xsl:param name="sdx:results" select="."/>
		<xsl:variable name="query">
			<xsl:apply-templates select="$sdx:results/sdx:query" mode="string"/>
		</xsl:variable>
		<!-- delete documents -->
		<!--<form style="margin:0; display:inline" action="{$action}" target="{$target}" method="get">-->
		<form style="margin:0; display:inline" action="{$action}" method="get">
			<xsl:for-each select="$sdx:results/sdx:sort/sdx:field">
				<input type="hidden" name="sf" value="{@name}"/>
				<input type="hidden" name="so" value="{@order}"/>
			</xsl:for-each>
			<input type="hidden" name="q" value="{$sdx:results/@luceneQuery}"/>
			<input type="hidden" name="qid" value="{$sdx:results/@qid}"/>
			<input type="hidden" name="p" value="{$sdx:results/@page}"/>
			<input type="hidden" name="hpp" value="{$sdx:results/@hpp}"/>
			<input type="hidden" name="delete" value="true"/>
			<xsl:text>Supprimer&#160;</xsl:text>
			<input type="submit" name="deletePage" value="Page {$sdx:results/@page}" title=" Supprimer {$sdx:results/@end - $sdx:results/@start +1} documents, page {$sdx:results/@page} de la requête [{$query}]. " onclick="return confirm(' êtes-vous sûr de vouloir supprimer {$sdx:results/@end - $sdx:results/@start + 1} documents ? ');"/>
			<input type="submit" name="delete" value="Tout supprimer" title=" Supprimer {$sdx:results/@nb} documents, les {$sdx:results/@pages} pages de la requÃªte [{$query}]. " onclick="this.form.hpp.value=-1; this.form.p.value=1 ; return confirm(' êtes-vous sûr de vouloir supprimer {$sdx:results/@nb} documents ? ');"/>
		</form>
	</xsl:template>
    
	<!-- sdx:query -->
	<xsl:template match="sdx:query" mode="string">
		<xsl:choose>
			<xsl:when test="sdx:query[2]">
				<xsl:value-of select="@luceneQuery"/>
			</xsl:when>
			<xsl:when test="sdx:query">
				<xsl:value-of select="sdx:query/@luceneQuery"/>
			</xsl:when>
			<xsl:when test="@type='simple'">
				<xsl:value-of select="@text"/>
			</xsl:when>
			<xsl:otherwise>
				<xsl:value-of select="@luceneQuery"/>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	
	<!-- sdx:result -->
	<xsl:template match="sdx:result" name="sdx:result">
		<xsl:param name="sdx:result" select="."/>
		<!-- paramÃ¨tre du template -->
		<xsl:param name="action" select="/sdx:document/@uri"/>
		<xsl:param name="target" select="'_self'"/>
		<xsl:param name="delete" select="'false'"/>
		<xsl:param name="action-delete" select="$action"/>
		<xsl:param name="target-delete" select="$target"/>
		<!-- information SDX -->
		<xsl:variable name="id" select="$sdx:result/sdx:field[@name='sdxdocid']/@value"/>
		<table class="sdx_result" border="0" cellpadding="0" cellspacing="0">
			<form action="{$action}">
			<!--<form action="{$action}" target="{$target}">-->
				<input type="hidden" name="qid" value="{$sdx:result/../@qid}"/>
				<input type="hidden" name="no" value="{$sdx:result/@no}"/>
				<input type="hidden" name="id" value="{$id}"/>
				<input type="hidden" name="base" value="{$sdx:result/sdx:field[@name='sdxbaseid']/@value}"/>
				<input type="hidden" name="app" value="{$sdx:result/sdx:field[@name='sdxappid']/@value}"/>
				<tr>
					<td>&#160;</td>
					<td valign="top" width="20">
						<b>
							<xsl:value-of select="
								format-number(
								$sdx:result/@no,
								substring (
									'00000000', 1,
									string-length($sdx:result/../@nb)
								)            
							)
							"/>
						</b>
					</td>
					<td>&#160;</td>
					<xsl:if test="$delete='true'">
						<td valign="top" width="15">
							<input type="hidden" name="del"/>
							<input onclick="
								this.form.no.value=''; 
								this.form.qid.value=''; 
								this.form.del.value='?'; 
								this.form.action='{$action-delete}'; 
								" type="submit" class="sdx_key" title=" Supprimer le document id={$id} " name="del" value="X"/>
						</td>
					</xsl:if>
					<td valign="top" width="15">
						<input type="submit" class="sdx_key" title=" Voir le document id={$id} " name="go" value="&gt;"/>
					</td>
					<td>&#160;</td>
					<td width="100%">
						<xsl:apply-templates select="$sdx:result/node()">
						<xsl:sort select="@name"/>
						<xsl:sort select="@value"/>
						</xsl:apply-templates>
					</td>
					<td>&#160;&#160;&#160;</td>
				</tr>
			</form>
		</table>
	</xsl:template>
    
	<!-- sdx:field -->
	<xsl:template match="sdx:field">
		<div class="sdx_field">
			<span class="sdx_field-name" style="font-weight:bold">
				<xsl:value-of select="@name"/>
			</span>
			<xsl:text>:|</xsl:text>
			<span style="font-weight:bold;" class="sdx_field-value">
				<xsl:value-of select="@value"/>
			</span>
			<xsl:text>|</xsl:text>
		</div>
	</xsl:template>
    
	<!-- sdx:terms -->
	<xsl:template match="sdx:terms">
		<h2>Termes</h2>
		<ol>
			<xsl:apply-templates/>
		</ol>
	</xsl:template>
	
	<xsl:template match="sdx:terms[@nb=0]">
		<h2>Aucun résultat.</h2>
	</xsl:template>
	
	<!-- sdx:term -->
	<xsl:template match="sdx:term">
		<li>
			<xsl:value-of select="@field"/> : <xsl:value-of select="@value"/>
		</li>
	</xsl:template>
	
	<!--
	|
	| SUPPRESSIONS
	|
	|-->
	<xsl:template match="sdx:deletions[@qid]">
		<div class="sdx_deletions" style="margin-top:1ex; margin-bottom:1ex">
			<h2>
				<xsl:text>Suppressions </xsl:text>
				<small>
					[<xsl:apply-templates select="sdx:query" mode="string"/>],
					<xsl:if test="number(@pages)&gt;1">
						<xsl:text> page  </xsl:text>
						<xsl:value-of select="@page"/>,
					</xsl:if>
					<xsl:value-of select="number(@end) - number(@start) + 1"/>
					<xsl:text> documents </xsl:text>
				</small>
			</h2>
			<xsl:apply-templates/>
		</div>
	</xsl:template>
	
	<xsl:template match="sdx:deletions[@app]">
		<xsl:choose>
			<xsl:when test="parent::*[name()= 'sdx:deletions']">
				<h3>
					<xsl:text>sdxappid:</xsl:text>
					<span style="color:Highlight; font-weight:bold">
						<xsl:value-of select="@app"/>
					</span>
					<xsl:text> &#160; sdxbaseid:</xsl:text>
					<span style="color:Highlight; font-weight:bold">
						<xsl:value-of select="@base"/>
					</span>
				</h3>
				<xsl:apply-templates/>
			</xsl:when>
			<xsl:otherwise>
				<div class="sdx_deletions" style="margin-top:1ex; margin-bottom:1ex">
					<h2>
						<xsl:text>Suppressions </xsl:text>
						<small>
							<xsl:text> sdxappid:</xsl:text>
							<span style="color:Highlight; font-weight:bold">
								<xsl:value-of select="@app"/>
							</span>
							<xsl:text> &#160; sdxbaseid:</xsl:text>
							<span style="color:Highlight; font-weight:bold">
								<xsl:value-of select="@base"/>
							</span>
						</small>
					</h2>
					<xsl:apply-templates/>
				</div>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	
	<xsl:template match="sdx:deletions">
		<xsl:apply-templates/>
	</xsl:template>
    
	<!-- sdx:deletion -->
	<xsl:template match="sdx:deletion">
		<div class="sdx_deletion" style="margin-left:2em">
			<xsl:text> id:</xsl:text>
			<span style="color:Highlight; font-weight:bold">
				<xsl:value-of select="sdx:document/@id"/>
			</span>
		</div>
	</xsl:template>
	
	<!-- sdx:user -->
	<!-- should take messages from a file -->
	<xsl:template match="sdx:user">
		<br/>
		<br/>
		<hr/>
		<small>
			<xsl:if test="not(@anonymous)">
				<xsl:value-of select="@firstname"/>&#160;<xsl:value-of select="@lastname"/>
				&#160;(<xsl:value-of select="@id"/>),
				vous êtes identifié comme
				<xsl:choose>
					<xsl:when test="@anonymous"/>
					<xsl:when test="@superuser='true'">
						superutilisateur.
					</xsl:when>
					<xsl:when test="@admin='true'">
						administrateur de l'application
						<xsl:value-of select="@app"/>.
					</xsl:when>
					<xsl:when test="@app">
						utilisateur de lapplication
						<xsl:value-of select="@app"/>.
					</xsl:when>
				</xsl:choose>
				<br/>
			</xsl:if>
		</small>
		<br/>
		<br/>
	</xsl:template>
	
	<!-- match sdx:navigation for an include document -->
	<xsl:template name="sdx:navigation" match="sdx:navigation">
		<table cellpadding="0" cellspacing="0" border="0">
			<tr>
				<form>
					<td>
						<xsl:apply-templates select="sdx:previous"/>
					</td>
					<td width="100%">&#32;</td>
					<td class="right">
						<xsl:apply-templates select="sdx:next"/>
					</td>
				</form>
			</tr>
		</table>
	</xsl:template>
	
	<!-- sdx:next -->
	<xsl:template match="sdx:next">
		<input type="button" class="sdx_next">
			<xsl:attribute name="value">&gt;</xsl:attribute>
			<xsl:attribute name="title"> document suivant de la requête &gt; </xsl:attribute>
			<xsl:attribute name="style">cursor: pointer; font-family: Arial, sans-serif; font-weight:900; width: 3ex; </xsl:attribute>
			<xsl:attribute name="onclick">
				<!-- target ? -->
				<xsl:text>window.location.href='</xsl:text>
				<xsl:value-of select="/sdx:document/@uri"/>
				<xsl:text>?</xsl:text>
				<xsl:text>app=</xsl:text><xsl:value-of select="@app"/>
				<xsl:text>&amp;</xsl:text><xsl:text>base=</xsl:text><xsl:value-of select="@base"/>
				<xsl:text>&amp;</xsl:text><xsl:text>id=</xsl:text><xsl:value-of select="@docId"/>
				<xsl:text>&amp;</xsl:text><xsl:text>qid=</xsl:text><xsl:value-of select="../@queryId"/>
				<xsl:text>&amp;</xsl:text><xsl:text>n=</xsl:text><xsl:value-of select="@no"/>
				<xsl:text>'</xsl:text>
			</xsl:attribute>
		</input>
	</xsl:template>
    
	<!-- sdx:previous -->
	<xsl:template match="sdx:previous">
		<input type="button" class="sdx_prev">
			<xsl:attribute name="value">&lt;</xsl:attribute>
			<xsl:attribute name="title"> &lt; document précédent de la requête </xsl:attribute>
			<xsl:attribute name="style">cursor: pointer; font-family: Arial, sans-serif; font-weight:900; width: 3ex; </xsl:attribute>
			<xsl:attribute name="onclick">
				<!-- target ? -->
				<xsl:text>window.location.href='</xsl:text>
				<xsl:value-of select="/sdx:document/@uri"/>
				<xsl:text>?</xsl:text>
				<xsl:text>app=</xsl:text>
				<xsl:value-of select="@app"/>
				<xsl:text>&amp;</xsl:text>
				<xsl:text>base=</xsl:text>
				<xsl:value-of select="@base"/>
				<xsl:text>&amp;</xsl:text>
				<xsl:text>id=</xsl:text>
				<xsl:value-of select="@docId"/>
				<xsl:text>&amp;</xsl:text>
				<xsl:text>qid=</xsl:text>
				<xsl:value-of select="../@queryId"/>
				<xsl:text>&amp;</xsl:text>
				<xsl:text>n=</xsl:text>
				<xsl:value-of select="@no"/>
				<xsl:text>'</xsl:text>
			</xsl:attribute>
		</input>
	</xsl:template>
    
	<!-- UPLOAD -->
	<xsl:template match="sdx:uploadDocuments">
		<div style="margin-bottom:1em" class="sdx_uploadDocuments">
		<xsl:apply-templates select="sdx:summary"/>
		<xsl:apply-templates select="sdx:uploadDocument"/>
		</div>
	</xsl:template>
	
	<xsl:template match="sdx:uploadDocument">
		<div style="margin-left:2em" class="sdx_uploadDocument">
			<strong>
				<xsl:value-of select="@id"/>
			</strong>
			<xsl:text> indexé. </xsl:text>
		</div>
	</xsl:template>
		
	<xsl:template match="sdx:uploadDocument[sdx:exception]">
			<li>
				<strong>
					<xsl:value-of select="@id"/>
				</strong>
				<xsl:text> erreur. </xsl:text>
				<xsl:apply-templates select="sdx:exception/sdx:message"/>
			</li>
	</xsl:template>
	
	<xsl:template match="sdx:summary">
		<div class="sdx_summary">
			<xsl:apply-templates select="@*"/>
		</div>
	</xsl:template>
	
	<xsl:template match="@additions">
		<xsl:if test="number(.) &gt; 0">
			<xsl:value-of select="."/> document<xsl:if test="number(.) &gt; 1">s</xsl:if>
			ajouté<xsl:if test="number(.) &gt; 1">s</xsl:if>,
		</xsl:if>
	</xsl:template>
    
	<xsl:template match="@failures">
		<xsl:if test="number(.) &gt; 0">
			<xsl:value-of select="."/> échec<xsl:if test="number(.) &gt; 1">s</xsl:if>,
		</xsl:if>
	</xsl:template>
    
	<xsl:template match="@replacements">
		<xsl:value-of select="."/> document<xsl:if test="number(.) &gt; 1">s</xsl:if> remplacé<xsl:if test="number(.) &gt; 1">s</xsl:if>
	</xsl:template>
	
	<xsl:template match="@duration"> (<xsl:value-of select="."/> secondes).</xsl:template>
	
	<xsl:template match="sdx:uploadDocument/sdx:exception">
		<h2>Erreur</h2>
		<xsl:apply-templates/>
	</xsl:template>
    
	<xsl:template match="sdx:uploadDocument/sdx:exception/sdx:message">
		<small>
			<xsl:apply-templates/>
		</small>
	</xsl:template>
    
	<!-- HILITE -->
	<xsl:template match="sdx:hilite">
		<span class="sdx_hilite">
			<xsl:apply-templates/>
		</span>
	</xsl:template>
    
	<xsl:template match="sdx:*" priority="-1">
		<xsl:apply-templates/>
	</xsl:template>
	
	<xsl:template match="sdx:*/@*" priority="-1"/>

	<!-- Crée une liste d'options en fonction de la langue pour les critères de
	jointure de recherches	-->
	<xsl:template name="draw_select">
		<xsl:param name="nom" />
		<xsl:param name="alt" />
		<xsl:param name="tabindex" />

		<label for="{$nom}" class="hidden"><xsl:value-of select="$alt" /></label>

		<select name="{$nom}" id="{$nom}">			
			<option value="and" selected="selected">Et</option>
			<option value="or">Ou</option>
			<option value="not">Sauf</option>
		</select>
	</xsl:template>

	<!-- Affiche une image dans un lien pour le retour en haut de page -->
	<xsl:template name="back2top">
		<a href="#haut"><img height="13" src="icons/haut.gif" width="16">
				<xsl:attribute name="alt">Retour en haut de page</xsl:attribute>
		</img></a>
	</xsl:template>


	<xsl:template name="getQueryParameters">
		<xsl:param name="pageParam">p</xsl:param>
		<xsl:param name="sortParam">sort</xsl:param>
		<xsl:param name="orderParam">order</xsl:param>
		<xsl:for-each select="//sdx:parameters/sdx:parameter">
			<xsl:choose>
				<xsl:when test="@name='n' or @name=$pageParam or @name='sf' or @name='so' or @name=$sortParam or @name=$orderParam ">
					<!-- Do nothing -->
				</xsl:when>
				<xsl:otherwise>	
					<xsl:if test="@escapedValue!=''">
						<xsl:value-of select="@name"/><xsl:text>=</xsl:text><xsl:value-of select="@escapedValue"/><xsl:text>&amp;amp;</xsl:text>
					</xsl:if>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:for-each>
	</xsl:template>


	<xsl:template name="getQueryParametersAsInput">
		<xsl:for-each select="//sdx:parameters/sdx:parameter">
			<xsl:choose>
				<xsl:when test="@name='n' or @name='p' or @name='sf' or @name='so' or @name='sort' or @name='order' ">
					<!-- Do nothing -->
				</xsl:when>
				<xsl:otherwise>	
					<xsl:if test="@value!=''">
						<input type="hidden" name="{@name}" value="{@value}"/>
					</xsl:if>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:for-each>
	</xsl:template>

	<xsl:template name="getSortParameters">
		<xsl:param name="sortParam">sort</xsl:param>
		<xsl:param name="orderParam">order</xsl:param>
		<xsl:for-each select="//sdx:parameters/sdx:parameter">
			<xsl:choose>
				<xsl:when test="@name=$sortParam or @name=$orderParam">
					<xsl:if test="@escapedValue!=''">
						<xsl:value-of select="@name"/><xsl:text>=</xsl:text><xsl:value-of select="@escapedValue"/><xsl:text>&amp;amp;</xsl:text>
					</xsl:if>
				</xsl:when>
				<xsl:otherwise>	
					<!-- Do nothing -->
				</xsl:otherwise>	
			</xsl:choose>
		</xsl:for-each>
	</xsl:template>

	<xsl:template name="getSortParametersAsInput">
		<xsl:for-each select="//sdx:parameters/sdx:parameter">
			<xsl:choose>
				<xsl:when test="@name='sort' or @name='order' ">
					<xsl:if test="@value!=''">
						<input type="hidden" name="{@name}" value="{@value}"/>
					</xsl:if>
				</xsl:when>
				<xsl:otherwise>	
					<!-- Do nothing -->
				</xsl:otherwise>	
			</xsl:choose>
		</xsl:for-each>
	</xsl:template>

</xsl:stylesheet>


```

</details>


---

### 📄 `sdxlib/xsl/skin.xsl` [211.053 octets]
<a id="sdxlib-xsl-skin-xsl"></a> [↩ Retour à l'arborescence](#tree-sdxlib-xsl-skin-xsl)

> **Chemin relatif** : `sdxlib/xsl/skin.xsl`  
> **Taille** : 211.053 octets  
> **Lignes** : 4698  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (4698 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet xmlns="http://www.w3.org/1999/xhtml"  version="1.0" 
	xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
	xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" 
 	xmlns:dir="http://apache.org/cocoon/directory/2.0"
	xmlns:xlink="http://www.w3.org/1999/xlink"
	xmlns:xi="http://www.w3.org/2001/XInclude"
	xmlns:exsl="http://exslt.org/common"
	exclude-result-prefixes="xsl sdx dir xlink xi exsl">
	<xsl:import href="sdx-default.xsl"/>
	<xsl:param name="q"/>
	<xsl:param name="uri" select="/sdx:document/@uri"/>
	<xsl:param name="lang">
		<xsl:value-of select="//lang/@value" />
	</xsl:param>
	<xsl:param name="space" select="' '"/>
	<xsl:variable name="no_results" select="false" />
	<xsl:variable name="no_entry_selected">
		<xsl:if test="not(//noentry)">false</xsl:if>
		<xsl:if test="//noentry">true</xsl:if>
	</xsl:variable>	
	<xsl:variable name="serverURI">
		<xsl:value-of select="sdx:document/@server" />
	</xsl:variable>
	<xsl:variable name="apppath">
		<xsl:value-of select="sdx:document/@appbypath" />
	</xsl:variable>
	<xsl:variable name="titre_page">
		<xsl:if test="$apppath = 'dad'">
			<xsl:text>DAD : </xsl:text>
			<xsl:choose>
				<xsl:when test="$lang = 'en'">Direct Access to Documents</xsl:when>
				<xsl:when test="$lang = 'es'">Acceso al texto integral de los documentos</xsl:when>
				<xsl:otherwise>Documents en Accès Direct</xsl:otherwise>
			</xsl:choose>
		</xsl:if>
		<xsl:if test="$apppath = 'urbamet'">
			<xsl:text>GDAC</xsl:text>
		</xsl:if>
	</xsl:variable>

	<xsl:variable name="site-props" select="document('cocoon:/site-properties.xml')/site"/>

	<xsl:variable name="admin" select="boolean(/sdx:document/sdx:user/@admin)"/>

	<xsl:variable name="rightcol">
		<xsl:choose>
			<xsl:when test="//contenu/@rightcol">
				<xsl:choose>
					<xsl:when test="//contenu/@rightcol = 'true'">
						<xsl:text>true</xsl:text>
					</xsl:when>
					<xsl:otherwise>
						<xsl:text>false</xsl:text>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$site-props//skin/page/contenu/@rightcol ='true'">
				<xsl:text>true</xsl:text>
			</xsl:when>
			<xsl:otherwise>
				<xsl:text>false</xsl:text>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:variable>
	<xsl:variable name="leftcol">
		<xsl:choose>
			<xsl:when test="//contenu/@leftcol">
				<xsl:choose>
				<xsl:when test="//contenu/@leftcol = 'true'">
					<xsl:text>true</xsl:text>
				</xsl:when>
				<xsl:otherwise>
					<xsl:text>false</xsl:text>
				</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:when test="$site-props//skin/page/contenu/@leftcol ='true'">
				<xsl:text>true</xsl:text>
			</xsl:when>
			<xsl:otherwise>
				<xsl:text>false</xsl:text>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:variable>

	<xsl:variable name="siteColor">
		<xsl:choose>
			<xsl:when test="$site-props//information/color">
				<xsl:value-of select="$site-props//information/color"/>
			</xsl:when>
			<xsl:otherwise>
				<xsl:text>green</xsl:text>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:variable>

	<xsl:variable name="titleDisplay">
		<xsl:choose>
			<xsl:when test="$site-props//information/title-display">
				<xsl:value-of select="$site-props//information/title-display"/>
			</xsl:when>
			<xsl:otherwise>
				<xsl:text>box</xsl:text>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:variable>

	<!-- template de base -->
	<xsl:template match="/sdx:document">
<html lang="fr">

	<head>

		<meta charset="utf-8"/>
		<title>
			<xsl:choose>
				<xsl:when test="//page-title[@qref][@field]">
					<xsl:for-each select="//page-title[@qref][@field]">
						<xsl:value-of select="//query[@qid=current()/@qref]/sdx:results/sdx:result/sdx:field[@name=current()/@field]/@value"/>
					</xsl:for-each>
				</xsl:when>
				<xsl:when test="//page-title">
					<xsl:value-of select="//page-title"/>
				</xsl:when>
				<xsl:when test="//sdx:document/title and //sdx:document/title != ''">
					<xsl:value-of select="//sdx:document/title"/>
				</xsl:when>
				<xsl:otherwise>
					&#160;
				</xsl:otherwise>
			</xsl:choose>
			<xsl:if test="$site-props//information/default-title">
				<xsl:text> - </xsl:text>
				<xsl:value-of select="$site-props//information/default-title"/>
			</xsl:if>
		</title>
		<link rel="stylesheet" href="css/pandoc-base.css"/>
		<link rel="stylesheet" href="css/color-{$siteColor}.css"/>
		<link rel="stylesheet" href="css/local.css"/>
		<link rel="stylesheet" type="text/css" href="css/jquery-ui/jquery-ui-1.10.3.custom.css" media="screen" title="Normal"/>
		<!-- jquery-ui -->
		<script type="text/javascript" src="js/jquery-ui/jquery-1.10.1.min.js">&#160;</script>
		<script type="text/javascript" src="js/jquery-ui/jquery-ui-1.10.3.custom.min.js">&#160;</script>
		<script type="text/javascript" src="js/modernizr/modernizr.custom.70630.js">&#160;</script>
		<script type="text/javascript" src="js/webshims/polyfiller.js">&#160;</script>
		<script>
			//implement all unsupported features || call polyfill before DOM-Ready to implement everything as soon and as fast as possible
			$.webshims.polyfill('forms forms-ext');
			//or load only specific features you need
			//$.webshims.polyfill('forms json-storage');
			$(function(){
				 //use all implemented API-features on DOM-ready 
			});
		</script>
		<xsl:if test="//entry[@type='mediaplayer']">
			<script type="text/javascript" src="js/flowplayer/flowplayer-3.2.13.min.js">&#160;</script>
		</xsl:if>
		<!--
		<script type="text/javascript" src="js/jquery/jquery-1.2.6.pack.js">&#160;</script>
		<script type="text/javascript" src="js/jquery/jquery.bgiframe.pack.js">&#160;</script>
		<script type="text/javascript" src="js/jquery/jquery.dimensions.pack.js">&#160;</script>
		<script type="text/javascript" src="js/jquery/jquery.autocomplete.pack.js">&#160;</script>
		-->
		<script type="text/javascript" src="js/suggest.js">&#160;</script>
		<script type="text/javascript" src="js/search-actions.js">&#160;</script>
		<script type="text/javascript" src="js/pandoc.js">&#160;</script>
		<script type="text/javascript" src="js/common.js">&#160;</script>
	</head>
	<body>
		<div class="container">
			<div class="container">
				<xsl:call-template name="menu-top"/>
				<xsl:call-template name="menu-connexion"/>
				<br class="clear"/>
			</div>
			<div class="container page">
				<div class="container tete">
					<xsl:call-template name="logo"/>
					<a>
						<xsl:choose>
							<xsl:when test="//information/bandeau-link">
								<xsl:attribute name="href"><xsl:value-of select="//information/bandeau-link"/></xsl:attribute>
							</xsl:when>
							<xsl:when test="$site-props//information/bandeau-link">
								<xsl:attribute name="href"><xsl:value-of select="$site-props//information/bandeau-link"/></xsl:attribute>
							</xsl:when>
							<xsl:otherwise>
								<xsl:attribute name="href">index.html</xsl:attribute>
							</xsl:otherwise>
						</xsl:choose>
						<xsl:call-template name="titrepage"/>
					</a>
					<div class="menu-head">
						<xsl:call-template name="menu-head"/>
<!--
						<ul>
							<li><a href="#">Aide</a> | </li>
							<li><a href="">Aller au contenu</a></li>
						</ul>
-->
					</div>
				</div>
				<div class="container menu">
						<xsl:call-template name="menu-main"/>
				</div>
				
				<xsl:if test="not(//no-search-tools)">
					<xsl:call-template name="menu-search-tools"/>
				</xsl:if>
<!--
				<div class="container ariane">
				&#160;
				</div>	
-->
				<div class="container corp" id="contenu">
					<div class="header-corp">
						<xsl:call-template name="menu-tools"/>
						<xsl:choose>
							<xsl:when test="//title[not(parent::module)][not(parent::widget)][not(parent::context)][@qref][@field]">
								<xsl:for-each select="//title[not(parent::module)][not(parent::widget)][not(parent::context)][@qref][@field]">
									<h1 class="{$titleDisplay}"><xsl:value-of select="//query[@qid=current()/@qref]/sdx:results/sdx:result/sdx:field[@name=current()/@field]/@value"/></h1>
								</xsl:for-each>
							</xsl:when>
							<xsl:when test="//title[@type='span'][not(parent::module)][not(parent::widget)][not(parent::context)]">
								<span class="{$titleDisplay}"><xsl:value-of select="//title"/></span>
							</xsl:when>
							<xsl:when test="//title[not(parent::module)][not(parent::widget)][not(parent::context)]">
								<h1 class="{$titleDisplay}"><xsl:value-of select="//title"/></h1>
							</xsl:when>
							<xsl:otherwise>
								&#160;
							</xsl:otherwise>
						</xsl:choose>
					</div>
					<div class="container">
						<xsl:if test="$rightcol = 'true'">
							<xsl:attribute name="class">container rightcol</xsl:attribute>
						</xsl:if>
						<div class="filler">&#160;</div>

						<xsl:choose>
							<xsl:when test="$rightcol='true' and $leftcol='true'">
								<div class="cols3-1">
									<xsl:apply-templates select="//leftcol"/>
									&#160;
								</div>
								<div class="cols3-2">
									<xsl:apply-templates select="*[not(local-name()='rightcol')][not(local-name()='leftcol')]"/>
									&#160;
								</div>
								<div class="cols3-3">
									<xsl:apply-templates select="//rightcol"/>
									<!--
									<div class="colorwidget">
										<h2>Dernières publications</h2>
										<ul>
											<li><a href="#">Contenu de widget</a></li>
											<li><a href="#">Contenu de widget</a></li>
										</ul>
									</div>
									-->
									&#160;
								</div>
						
							</xsl:when>
							<xsl:when test="$leftcol='true'">
								<div class="colsleft2-1">
									<xsl:apply-templates select="//leftcol"/>
									&#160;
								</div>
								<div class="colsleft2-2">
									<xsl:apply-templates select="*[not(local-name()='leftcol')]"/>
									&#160;
								</div>
							</xsl:when>
							<xsl:when test="$rightcol='true'">
								<div class="colsright2-1">
									<xsl:apply-templates select="*[not(local-name()='rightcol')]"/>
									&#160;
								</div>
								<div class="colsright2-2">
									<xsl:apply-templates select="//rightcol"/>
									<!--
									<div class="colorwidget">
										<h2>Dernières publications</h2>
										<ul>
											<li><a href="#">Contenu de widget</a></li>
											<li><a href="#">Contenu de widget</a></li>
										</ul>
									</div>
									-->
									&#160;
								</div>
						
							</xsl:when>
							<xsl:otherwise>
								<div class="container">
									<xsl:apply-templates/>
								</div>
							</xsl:otherwise>
						</xsl:choose>

						<br class="clear"/>
					</div>
				</div>
				<br class="clear"/>
				<br class="space"/>
				<br class="clear"/>
				<div class="container pied">
					<!--
					<div class="container maj">Dernière mise à jour : 00/00/0000</div>
					-->
					<xsl:call-template name="footer-menu"/>
					<br class="space"/>
					<br class="clear"/>
					<br class="space"/>
					<br class="clear"/>
					<div class="container copyright">© Ministère de la Transition écologique et solidaire</div>
				</div>
			</div>
			<xsl:call-template name="bottom-menu"/>
		</div>
	</body>
	<xsl:if test="$site-props//information/xiti/@id and $site-props//information/xiti/@id != ''">
		<xsl:call-template name="xiti"/>
	</xsl:if>
</html>
	</xsl:template>

	<!-- ============================   Templates de mise en forme communs ============================== -->

	<xsl:template match="hr">
			<hr/>
	</xsl:template>

	<!-- retour à la ligne, clear:both, sans espace  -->
	<xsl:template match="clear">
			<br class="clear"/>
	</xsl:template>

	<!-- retour à la ligne, clear:both, avec espace  -->
	<xsl:template match="space">
			<br class="space"/>
	</xsl:template>

	<!-- ============================   site-properties rules ============================== -->

	<xsl:template name="xiti">
		<xsl:variable name="xitiId" select="$site-props//information/xiti/@id"/>
		<xsl:variable name="xitiPrefix" select="$site-props//information/xiti"/>

		<xsl:variable name="pageName">
			<xsl:choose>
				<xsl:when test="//page-title[@qref][@field]">
					<xsl:for-each select="//page-title[@qref][@field]">
						<xsl:value-of select="//query[@qid=current()/@qref]/sdx:results/sdx:result/sdx:field[@name=current()/@field]/@value"/>
					</xsl:for-each>
				</xsl:when>
				<xsl:when test="//page-title">
					<xsl:value-of select="//page-title"/>
				</xsl:when>
				<xsl:when test="//sdx:document/title and //sdx:document/title != ''">
					<xsl:value-of select="//sdx:document/title"/>
				</xsl:when>
				<xsl:otherwise>
					Autre Page
				</xsl:otherwise>
			</xsl:choose>
		</xsl:variable>

		<xsl:variable xmlns:pregexp="java:fr.gouv.equipement.documentation.pandoc.string.Regexp" name="pageNameNoDiacritics">
			<xsl:value-of select="pregexp:stripDiacritics($pageName)"/>
		</xsl:variable>

		<script type="text/javascript">
		xtnv = document;
		xtsd = "http://logc407";
		xtsite = "<xsl:value-of select="$xitiId"/>";
		xtn2 = ""; // level 2 site
		xtpage = "<xsl:value-of select="$xitiPrefix"/><xsl:value-of select="translate($pageNameNoDiacritics,' ','-')"/>";
		xtdi = ""; //implication degree
		//
		</script>
		<script type="text/javascript" src="js/xtcore.js"></script>
		<noscript>
		<div id="xiti-logo-noscript">
		<img width="1" height="1" alt="XiTi" src="http://logc407.xiti.com/hit.xiti?s={$xitiId}&amp;p={$xitiPrefix}{translate($pageNameNoDiacritics,' ','-')}&amp;di=&amp;" />
		</div>
		</noscript>
	</xsl:template>

	<xsl:template name="menu-top">
		<xsl:choose>
			<xsl:when test="//menu[@name='top-menu']">
				<xsl:for-each select="//menu[@name='top-menu']/entry">
					<div class="onglet_bk"><a href="{.}" target="_blank"><xsl:value-of select="@name"/></a></div>
				</xsl:for-each>
			</xsl:when>
			<xsl:when test="$site-props//menu[@name='top-menu'][not(enable='false')]">
				<xsl:for-each select="$site-props//menu[@name='top-menu']/entry">
					<div class="onglet_bk"><a href="{.}" target="_blank"><xsl:value-of select="@name"/></a></div>
				</xsl:for-each>
			</xsl:when>
			<xsl:otherwise>
				<!-- Do nothing -->
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>

	<xsl:template name="menu-connexion">
			<xsl:choose>
				<xsl:when test="//menu[@name='connexion']">
					<xsl:for-each select="//menu[@name='connexion']/entry">
						<xsl:call-template name="ongletConnexion">
							<xsl:with-param name="entry" select="."/>
						</xsl:call-template>
					</xsl:for-each>
				</xsl:when>
				<xsl:when test="$site-props//menu[@name='connexion']">
					<xsl:for-each select="$site-props//menu[@name='connexion']/entry">
						<xsl:call-template name="ongletConnexion">
							<xsl:with-param name="entry" select="."/>
						</xsl:call-template>
					</xsl:for-each>
				</xsl:when>
				<xsl:otherwise>
				</xsl:otherwise>
			</xsl:choose>
	</xsl:template>

	<xsl:template name="ongletConnexion">
		<xsl:param name="entry"/>
		<div class="onglet">
			<!--
			<a href="{substring(normalize-space($entry),' ','')}">
			-->
			<xsl:variable name="link" select="translate(normalize-space($entry/text()),' ','')"/>
			<a href="{$link}">
			<xsl:if test="$entry/@login">
				<xsl:attribute name="title">Déconnexion de <xsl:value-of select="$entry/@login"/></xsl:attribute>
			</xsl:if>
			<xsl:value-of select="$entry/@name"/></a>
		</div>
	</xsl:template>

	<xsl:template name="logo">
			<xsl:choose>
				<xsl:when test="//information/logo-link">
					<a href="{//information/logo-link}">
						<img src="images/bm.png" alt="logo MEEM"/>
					</a>
				</xsl:when>
				<xsl:when test="$site-props//information/logo-link">
					<a href="{$site-props//information/logo-link}">
						<img src="images/bm.png" alt="logo MEEM"/>
					</a>
				</xsl:when>
				<xsl:otherwise>
					<img src="images/bm.png" alt="logo MEEM"/>
				</xsl:otherwise>
			</xsl:choose>
	</xsl:template>

	<xsl:template name="menu-head">
		<xsl:choose>
			<xsl:when test="//menu[@name='menu-head'] | $site-props//menu[@name='menu-head']/entry">
				<ul>
					<xsl:choose>
						<xsl:when test="//menu[@name='menu-head']">
							<xsl:for-each select="//menu[@name='menu-head']/entry">
								<li><a href="{.}"><xsl:value-of select="@name"/></a></li>
							</xsl:for-each>
						</xsl:when>
						<xsl:when test="$site-props//menu[@name='menu-head']/entry">
							<xsl:for-each select="$site-props//menu[@name='menu-head']/entry">
								<li>
								<xsl:if test="position()!= 1"><xsl:attribute name="class">leftpipe</xsl:attribute></xsl:if>
									<a href="{.}">
										<xsl:if test="@accesskey">
											<xsl:attribute name="accesskey"><xsl:value-of select="@accesskey"/></xsl:attribute>
										</xsl:if>
										<xsl:value-of select="@name"/>
									</a>
								</li>
								<!-- <xsl:if test="position()!=last()"> | </xsl:if> -->
							</xsl:for-each>
						</xsl:when>
						<xsl:otherwise>
							<!-- Can't append -->
						</xsl:otherwise>
					</xsl:choose>
				</ul>
			</xsl:when>
			<xsl:otherwise>
				<xsl:text>&#160;</xsl:text>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>

	<xsl:template name="titrepage">
		<div id="titrepage">
			<span><xsl:value-of select="$site-props//tete/titre"/></span>
		</div>
	</xsl:template>

	<xsl:template name="menu-search-tools">
		<xsl:variable name="mstprops" select="//menu[@name='search-tools'] | $site-props//menu[@name='search-tools']"/>
		<xsl:if test="$mstprops">	
			<div class="container middle-bar">
				<div class="ariane">&#160;</div> <!-- Not implemented -->
				<div class="search-tools">
					<xsl:for-each select="$mstprops//entry">
						<xsl:if test="@type='basket'">
							<a class="basket" href="{.}"><span>&#160;</span><xsl:value-of select="@name"/></a>
						</xsl:if>
						<xsl:if test="@type='histo'">
							<a class="histo" href="{.}"><xsl:value-of select="@name"/></a>
						</xsl:if>
					</xsl:for-each>
				</div>
			</div>
			<br class="clear"/>
		</xsl:if>
	</xsl:template>

	<xsl:template name="menu-main">
		<xsl:choose>
			<xsl:when test="//menu[@name='menu-main'] | $site-props//menu[@name='menu-main']/entry">
				<ul>
					<xsl:choose>
						<xsl:when test="//menu[@name='menu-main']">
							<xsl:for-each select="//menu[@name='menu-main']/entry">
								<li><a class="m{position()}" href="{.}"><span><xsl:value-of select="@name"/></span></a></li>
							</xsl:for-each>
						</xsl:when>
						<xsl:when test="$site-props//menu[@name='menu-main']/entry">
							<xsl:for-each select="$site-props//menu[@name='menu-main']/entry">
								<li><a class="m{position()}" href="{.}"><span><xsl:value-of select="@name"/></span></a></li>
							</xsl:for-each>
						</xsl:when>
						<xsl:otherwise>
							<!-- Can't append -->
						</xsl:otherwise>
					</xsl:choose>
				</ul>
			</xsl:when>
			<xsl:otherwise>
				<xsl:text>&#160;</xsl:text>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>

	<xsl:template name="menu-tools">
		<xsl:choose>
			<xsl:when test="//menu[@name='menu-tools'] | $site-props//menu[@name='menu-tools']/entry">
				<div class="tools">
					<xsl:choose>
						<xsl:when test="//menu[@name='menu-tools']">
							<xsl:for-each select="//menu[@name='menu-tools']/entry">
								<xsl:choose>
									<xsl:when test="@type='panier'">
										<!--
										<a href="#"><img src="images/caddie-2.png" alt="panier"/></a>
										-->
										<a href="#" class="panier" title="Accéder au porte-documents">&#160;</a>
									</xsl:when>
									<xsl:when test="@type='print'">
										<a href="javascript:print();" class="print" title="Imprimer la page">&#160;</a>
									</xsl:when>
									<xsl:when test="@type='pplus'">
										<a href="#" class="pplus" title="Agrandir la taille du texte">
											<xsl:attribute name="onclick">$('*').stop().animate({fontSize: '+=1pt'},300);</xsl:attribute>
                                                                                        <xsl:text>&#160;</xsl:text></a>
									</xsl:when>
									<xsl:when test="@type='pmoins'">
										<a href="#" class="pmoins" title="Réduire la taille du texte">
										<xsl:attribute name="onclick">$('*').stop().animate({fontSize: '-=1pt'},300);</xsl:attribute>
                                                                                        <xsl:text>&#160;</xsl:text></a>
									</xsl:when>
									<xsl:otherwise>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:for-each>
						</xsl:when>
						<xsl:when test="$site-props//menu[@name='menu-tools']/entry">
							<xsl:for-each select="$site-props//menu[@name='menu-tools']/entry">
								<xsl:choose>
									<xsl:when test="@type='panier'">
										<!--
										<a href="#"><img src="images/caddie-2.png" alt="panier"/></a>
										-->
										<a href="#" class="panier" title="Accéder au porte-documents">&#160;</a>
									</xsl:when>
									<xsl:when test="@type='print'">
										<a href="javascript:print();" class="print" title="Imprimer la page">&#160;</a>
									</xsl:when>
									<xsl:when test="@type='pplus'">
										<a href="#" class="pplus" title="Agrandir la taille du texte">
											<xsl:attribute name="onclick">$('*').stop().animate({fontSize: '+=1pt'},300);</xsl:attribute>
											<xsl:text>&#160;</xsl:text></a>
									</xsl:when>
									<xsl:when test="@type='pmoins'">
										<a href="#" class="pmoins" title="Réduire la taille du texte">
											<xsl:attribute name="onclick">$('*').stop().animate({fontSize: '-=1pt'},300);</xsl:attribute>
											<xsl:text>&#160;</xsl:text></a>
									</xsl:when>
									<xsl:otherwise>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:for-each>
						</xsl:when>
						<xsl:otherwise>
							<!-- Can't append -->
						</xsl:otherwise>
					</xsl:choose>
				</div>
			</xsl:when>
			<xsl:otherwise>
				<xsl:text>&#160;</xsl:text>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>

	<xsl:template name="footer-menu">
		<xsl:if test="//menu[@name='footer-menu'] | $site-props//menu[@name='footer-menu']/section">
			<!--<div class="container maj">Dernière mise à jour : 00/00/0000</div>-->
			<h3><span class="switch_menu close">Accès direct aux rubriques</span></h3>
			<br class="clear"/>
			<xsl:choose>
				<xsl:when test="//menu[@name='footer-menu'] | $site-props//menu[@name='footer-menu']/section">
					<div class="footer">
						<xsl:choose>
							<xsl:when test="//menu[@name='footer-menu']">
								<xsl:for-each select="//menu[@name='footer-menu']/section">
									<div class="menu-footer">
										<h4><a href="{@link}"><xsl:value-of select="@name"/></a></h4>
										<xsl:if test="entry">
											<ul>
											<xsl:for-each select="entry">
												<li><a href="{.}"><xsl:value-of select="@name"/></a></li>
											</xsl:for-each>
											</ul>
										</xsl:if>
									</div>
								</xsl:for-each>
							</xsl:when>
							<xsl:when test="$site-props//menu[@name='footer-menu']/section">
								<xsl:for-each select="$site-props//menu[@name='footer-menu']/section">
									<div class="menu-footer">
										<h4><a href="{@link}"><xsl:value-of select="@name"/></a></h4>
										<xsl:if test="entry">
											<ul>
											<xsl:for-each select="entry">
												<li><a href="{.}"><xsl:value-of select="@name"/></a></li>
											</xsl:for-each>
											</ul>
										</xsl:if>
									</div>
								</xsl:for-each>
							</xsl:when>
							<xsl:otherwise>
								<!-- Can't append -->
							</xsl:otherwise>
						</xsl:choose>
					</div>
				</xsl:when>
				<xsl:otherwise>
					<xsl:text>&#160;</xsl:text>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:if>
	</xsl:template>

	<xsl:template name="bottom-menu">
		<xsl:choose>
			<xsl:when test="//menu[@name='bottom-menu'] | $site-props//menu[@name='bottom-menu']/entry">
				<div class="container bottom-links">
					<xsl:choose>
						<xsl:when test="//menu[@name='bottom-menu']">
							<xsl:for-each select="//menu[@name='bottom-menu']/entry">
								<xsl:if test="position()=1">| </xsl:if>
								<span><a href="{.}"><xsl:value-of select="@name"/></a></span>
								<xsl:text> |</xsl:text>
							</xsl:for-each>
						</xsl:when>
						<xsl:when test="$site-props//menu[@name='bottom-menu']/entry">
							<xsl:for-each select="$site-props//menu[@name='bottom-menu']/entry">
								<xsl:if test="position()=1">| </xsl:if>
								<span><a href="{.}"><xsl:value-of select="@name"/></a></span>
								<xsl:text> |</xsl:text>
							</xsl:for-each>
						</xsl:when>
						<xsl:otherwise>
							<!-- Can't append -->
						</xsl:otherwise>
					</xsl:choose>
				</div>
			</xsl:when>
			<xsl:otherwise>
				<xsl:text>&#160;</xsl:text>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>

	<!-- ============================   modules definition  ============================== -->

	<xsl:template match="module[@type='contenu']">
		<div class="module contenu">
			<xsl:if test="@class"><xsl:attribute name="class">module contenu <xsl:value-of select="@class"/></xsl:attribute></xsl:if>
			<xsl:if test="title">
					<h2><xsl:value-of select="title"/></h2>
					<hr/>
					<br class="space"/>
			</xsl:if>
			<!-- <xsl:copy-of select="text()|*"/> -->
			<xsl:apply-templates select="*|text()" mode="htmlcopy"/>
		</div>
	</xsl:template>

	<xsl:template match="display[@type='split']">
		<div class="splitdisplay">
			<xsl:for-each select="*">
				<div class="split">
					<xsl:apply-templates select="."/>				
				</div>
			</xsl:for-each>
		</div>
		<br class="clear"/>
	</xsl:template>

	<!-- Module Liste -->

	<xsl:template match="module[@type='liste'][@subtype='doc']">
		<div class="module liste">
			<xsl:if test="title">
					<h2><xsl:value-of select="title"/></h2>
					<hr/>
			</xsl:if>
			<ul>
				<!--<xsl:for-each select="entry | .//sdx:result/sdx:field[@name='titre']/@value">-->
				<xsl:variable name="mprops" select="."/>
				<xsl:for-each select=".//sdx:result[sdx:field/@name=$mprops/@field]">
					<xsl:variable name="fieldValue" select="sdx:field[@name=$mprops/@field]/@value"/>
					<xsl:variable name="rpos" select="position()"/>
					<li>
						<a href="{$mprops/@linkto}?id={sdx:field[@name=$mprops/@linktofield]}"><xsl:value-of select="$fieldValue"/></a>
						<xsl:if test="$mprops/@dateField">
							<xsl:variable name="ldate"><xsl:value-of select="sdx:field[@name=$mprops/@dateField]/@value"/></xsl:variable>
							( <xsl:value-of select="substring($ldate,9,2)"/>/<xsl:value-of select="substring($ldate,6,2)"/>/<xsl:value-of select="substring($ldate,1,4)"/> )
						</xsl:if>
					</li>
				</xsl:for-each>
			</ul>
		</div>
	</xsl:template>

	<xsl:template match="module[@type='liste'][not(@subtype)]">
		<div class="module liste">
			<xsl:if test="title">
				<h2><xsl:value-of select="title"/></h2>
				<hr/>
			</xsl:if>
			<ul>
				<xsl:for-each select="entry">
					<li>
						<a href="{.}"><xsl:value-of select="@name"/></a>
						<xsl:if test="@rss">
							<xsl:text> </xsl:text>
							<a href="{@rss}"><img src="images/rss_icon.gif" alt="@name"/></a>
						</xsl:if>
					</li>
				</xsl:for-each>
			</ul>
		</div>
	</xsl:template>

	<!-- Module bloc image-->

	<xsl:template match="module[@type='blocimage']">
		<div class="blocmodule">
			<div class="blocimage">
				<xsl:if test="@class"><xsl:attribute name="class">blocimage <xsl:value-of select="@class"/></xsl:attribute></xsl:if>
				<!--<h2><xsl:value-of select="title"/></h2>-->
				<div class="bloctexte">
					<!-- <xsl:copy-of select="content/text()|content/*"/> -->
					<xsl:apply-templates select="content/*|content/text()" mode="htmlcopy"/>
				</div>
			</div>
		</div>
		<br class="clear"/>
	</xsl:template>

	<!-- Module bloc texte (Un bloc image sans image) -->

	<xsl:template match="module[@type='bloctexte']">
		<div class="blocmodule">
			<div class="texte bgcolortheme">
				<xsl:if test="@class"><xsl:attribute name="class">blocimage <xsl:value-of select="@class"/></xsl:attribute></xsl:if>
				<xsl:apply-templates select="content/*|content/text()" mode="htmlcopy"/>
			</div>
		</div>
		<br class="clear"/>
	</xsl:template>

	<!-- Module Recherche -->

	<xsl:template match="module[@type='recherche']">
                <xsl:variable name="mprops" select="." />
		<div class="module form">
			<xsl:if test="title">
				<h2>
					<xsl:if test="title/@id"><xsl:attribute name="id"><xsl:value-of select="title/@id"/></xsl:attribute></xsl:if>
					<xsl:value-of select="title"/>
				</h2>
				<hr/>
			</xsl:if>
			<xsl:if test="header">
				<!--
				<div class="chapeau"><xsl:copy-of select="header/text()|header/*"/></div>
				-->
				<div class="chapeau"><xsl:apply-templates select="header/*|header/text()" mode="htmlcopy"/></div>
			</xsl:if>
			<form method="get" action="{@action}">
				<xsl:apply-templates/>
				<div class="formline">
					<xsl:if test="$mprops/@reset='true'">
						<script type="text/javascript">
						   function resetForm(form)
						   {
						       for (var i = 0; i &lt; form.elements.length; i++)
						       {
							   if ('submit' != form.elements[i].type &amp;&amp; 'reset' != form.elements[i].type)
							   {
							       if (form.elements[i].type != "radio"){
								       form.elements[i].checked = false;
								       form.elements[i].value = '';
								       form.elements[i].selectedIndex = 0;
							       }
							   }
							   if (form.elements[i].type == "radio" &amp;&amp; form.elements[i-1] &amp;&amp; form.elements[i].name != form.elements[i-1].name){
							   	form.elements[i].checked = true;
							   }
						       }
						   }
						</script>
						<button class="reset" type="reset" onclick="resetForm(this.form); return false;" value="Réinitialiser le formulaire">Réinitialiser</button>
					</xsl:if>
					<button class="submit" type="submit" value="rechercher">&#160;</button>
					&#160;
				</div>
			</form>
		</div>
	</xsl:template>

        <xsl:template match="formline[@type='none']">
                <br />
        </xsl:template>

        <xsl:template match="formline[@type='hidden']">
		<input type="hidden" name="{@name}" value="{@value}"/>
        </xsl:template>

	<xsl:template match="formline[@type='text']">
		<xsl:variable name="fill" select="ancestor::module[@type='recherche']/@fill"/>
		<xsl:variable name="sprops" select="suggest"/>
		<div class="formline">
			<xsl:if test="@class"><xsl:attribute name="class">formline <xsl:value-of select="@class"/></xsl:attribute></xsl:if>
			<label class="left"><xsl:value-of select="@display"/></label>
			<xsl:if test="@andor='true'">
				<select class="right" name="op_champ_{@name}">
					<xsl:choose>
						<xsl:when test="$fill">
							<xsl:variable name="andorValue"><xsl:value-of select="//sdx:parameter[@name=concat('op_champ_',current()/@name)]/@value"/></xsl:variable>
							<option value="and">
								<xsl:if test="$andorValue='and'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
							ET</option>
							<option value="or">
								<xsl:if test="$andorValue='or'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
							OU</option>
							<option value="not">
								<xsl:if test="$andorValue='not'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
							SAUF</option>
						</xsl:when>
						<xsl:otherwise>
							<option value="and">ET</option>
							<option value="or">OU</option>
							<option value="not">SAUF</option>
						</xsl:otherwise>
					</xsl:choose>
				</select>
			</xsl:if>
			<input type="text" name="{@name}" id="{@id}" class="center" title="{@display}">
				<xsl:if test="$fill">
					<xsl:attribute name="value"><xsl:value-of select="//sdx:parameter[@name=current()/@name]/@htmlEscapedValue"/></xsl:attribute>
				</xsl:if>
				<xsl:if test="$sprops/@suggestField">
					<xsl:attribute name="data-suggest-field"><xsl:value-of select="$sprops/@suggestField"/></xsl:attribute>
				</xsl:if>
				<xsl:if test="$sprops/@quote">
					<xsl:attribute name="data-suggest-quote"><xsl:value-of select="$sprops/@quote"/></xsl:attribute>
				</xsl:if>
				<xsl:if test="$sprops/@index">
					<xsl:attribute name="data-suggest-index"><xsl:value-of select="$sprops/@index"/></xsl:attribute>
				</xsl:if>
				<xsl:if test="$sprops/@base">
					<xsl:attribute name="data-suggest-base"><xsl:value-of select="$sprops/@base"/></xsl:attribute>
				</xsl:if>
				<xsl:if test="$sprops/@baseSelector">
					<xsl:attribute name="data-suggest-baseselector"><xsl:value-of select="$sprops/@baseSelector"/></xsl:attribute>
				</xsl:if>
				<xsl:if test="$sprops/@fieldSelector">
					<xsl:attribute name="data-suggest-fieldselector"><xsl:value-of select="$sprops/@fieldSelector"/></xsl:attribute>
				</xsl:if>
				<xsl:if test="$sprops/@sortAlpha">
					<xsl:attribute name="data-suggest-sortalpha"><xsl:value-of select="$sprops/@sortAlpha"/></xsl:attribute>
				</xsl:if>
			</input>
			<xsl:if test="@andormot='true'">
				<select class="right" name="op_mot_{@name}" title="opérateur entre chaque mot">
					<xsl:choose>
						<xsl:when test="$fill">
							<xsl:variable name="andorValue"><xsl:value-of select="//sdx:parameter[@name=concat('op_mot_',current()/@name)]/@value"/></xsl:variable>
							<option value="and">
								<xsl:if test="$andorValue='and'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
							ET</option>
							<option value="or">
								<xsl:if test="$andorValue='or'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
							OU</option>
							<option value="not">
								<xsl:if test="$andorValue='not'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
							SAUF</option>
						</xsl:when>
						<xsl:otherwise>
							<option value="and">ET</option>
							<option value="or">OU</option>
							<option value="not">SAUF</option>
						</xsl:otherwise>
					</xsl:choose>
				</select>
			</xsl:if>
			<xsl:if test="@thesaurus='true'">
				<a class="right thesaurus" onclick="window.open(this.href); return false;" href="http://thesurb.documentation.equipement.gouv.fr/" title="{@thesaurus-info}">&#160;</a>
			</xsl:if>
		</div>
	</xsl:template>

	<xsl:template match="formline[@type='select']">
		<xsl:variable name="fill" select="ancestor::module[@type='recherche']/@fill"/>
		<xsl:variable name="fprops" select="."/>
		<xsl:variable name="quote">"</xsl:variable>
		<div class="formline">
			<label class="left" for="{@id}"><xsl:value-of select="@display"/></label>
			<xsl:variable name="fieldname" select="@optionfieldname"/>
			<xsl:variable name="fieldvalue" select="@optionfieldvalue"/>
			<xsl:variable name="fquote" select="@quote"/>
			<xsl:if test="@andor='true'">
				<select class="right" name="op_champ_{@name}">
					<option value="and">ET</option>
					<option value="or">OU</option>
					<option value="not">SAUF</option>
				</select>
			</xsl:if>
			<select name="{@name}" class="center" id="{@id}">
				<option value=""></option>
				<xsl:for-each select="entry | .//sdx:result | .//sdx:term">
					<xsl:variable name="cfieldvalue">
						<xsl:if test="$fquote='true'">&amp;quot;</xsl:if>
						<xsl:choose>
							<xsl:when test="sdx:field"><xsl:value-of select="sdx:field[@name=$fieldvalue]/@value"/></xsl:when>
							<xsl:when test="local-name()='term'"><xsl:value-of select="@value"/></xsl:when>
							<xsl:when test="local-name()='entry'"><xsl:value-of select="."/></xsl:when>
							<xsl:otherwise></xsl:otherwise>
						</xsl:choose>
						<xsl:if test="$fquote='true'">&amp;quot;</xsl:if>
					</xsl:variable>
					<xsl:variable name="cfieldname">
						<xsl:choose>
							<xsl:when test="sdx:field"><xsl:value-of select="sdx:field[@name=$fieldname]/@value"/></xsl:when>
							<xsl:when test="local-name()='term'"><xsl:value-of select="@value"/></xsl:when>
							<xsl:when test="local-name()='entry'"><xsl:value-of select="@name"/></xsl:when>
							<xsl:otherwise></xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:variable name="cfieldoption">
						<xsl:choose>
							<xsl:when test="local-name()='entry'"><xsl:value-of select="@option"/></xsl:when>
							<xsl:otherwise></xsl:otherwise>
						</xsl:choose>
					</xsl:variable>
					<xsl:choose>
						<xsl:when test="$fill">
							<option value="{$cfieldvalue}">
								<xsl:if test="$cfieldoption='disabled'"><xsl:attribute name="disabled">disabled</xsl:attribute></xsl:if>
								<xsl:for-each select="//sdx:parameter[@name=$fprops/@name]">
									<xsl:choose>
										<xsl:when test="$fquote='true'">
											<xsl:if test="concat('&amp;quot;',translate(@value,$quote,''),'&amp;quot;') = $cfieldvalue"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
										</xsl:when>
										<xsl:otherwise>
											<xsl:if test="@value = $cfieldvalue"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
										</xsl:otherwise>
									</xsl:choose>
								</xsl:for-each>
								<xsl:value-of select="$cfieldname"/>
							</option>
						</xsl:when>
						<xsl:otherwise>
							<option value="{$cfieldvalue}">
								<xsl:if test="$cfieldoption='disabled'"><xsl:attribute name="disabled">disabled</xsl:attribute></xsl:if>
								<xsl:value-of select="$cfieldname"/>
							</option>
						</xsl:otherwise>
					</xsl:choose>
				</xsl:for-each>
			</select>
		</div>
	</xsl:template>

        <xsl:template match="formline[@type='checkbox']">
                <xsl:variable name="fill" select="ancestor::module[@type='recherche']/@fill"/>
                <xsl:variable name="fprops" select="."/>
                <xsl:variable name="modifier" select="//sdx:parameter[@name='modifier']/@htmlEscapedValue"/>
                <div class="formline">
			<xsl:if test="@class"><xsl:attribute name="class">formline <xsl:value-of select="@class"/></xsl:attribute></xsl:if>
                        <label class="left" for="{@id}">
				<xsl:if test="@title"><xsl:attribute name="title"><xsl:value-of select="@title"/></xsl:attribute></xsl:if>
				<xsl:value-of select="@display"/>
			</label>
                        <input type="checkbox" name="{@fieldname}" id="{@name}">
				<xsl:if test="@title"><xsl:attribute name="title"><xsl:value-of select="@title"/></xsl:attribute></xsl:if>
				<xsl:choose>
					<xsl:when test="$fill and $modifier='oui'">
						<xsl:variable name="checked"><xsl:value-of select="//sdx:parameter[@name=current()/@name]/@htmlEscapedValue"/></xsl:variable>
						<xsl:if test="$checked='on'">
							<xsl:attribute name="checked">checked</xsl:attribute>
						</xsl:if>
					</xsl:when>
					<xsl:when test="not($modifier) and $fprops/@checked='true'">
						<xsl:attribute name="checked">checked</xsl:attribute>
					</xsl:when>
					<xsl:otherwise>
						<!-- Do nothing -->
					</xsl:otherwise>
				</xsl:choose>
			</input>
                </div>
        </xsl:template>

	<xsl:template match="formline[@type='radio']">
		<xsl:variable name="fill" select="ancestor::module[@type='recherche']/@fill"/>
		<xsl:variable name="fprops" select="."/>
		<div class="radioline">
			<xsl:if test="@class"><xsl:attribute name="class">radioline <xsl:value-of select="@class"/></xsl:attribute></xsl:if>
			<xsl:for-each select="item">
				<xsl:variable name="rvalue" select="@value"/>
			<div class="en3">
				<input type="radio" name="{parent::formline/@name}" value="{$rvalue}" id="{@id}">
					<xsl:choose>
						<xsl:when test="$fill='true'">
							<xsl:for-each select="//sdx:parameter[@name=$fprops/@name]">
								<xsl:if test="@value = $rvalue"><xsl:attribute name="checked">checked</xsl:attribute></xsl:if>
							</xsl:for-each>
							<xsl:if test="not( //sdx:parameter[@name=$fprops/@name] ) and position()=1">
								<xsl:attribute name="checked">checked</xsl:attribute>
							</xsl:if>
						</xsl:when>
						<xsl:when test="not($fill='true') and position()=1">
							<xsl:attribute name="checked">checked</xsl:attribute>
						</xsl:when>
					<xsl:otherwise>
						<!-- Do nothing -->
						</xsl:otherwise>
					</xsl:choose>
				</input>
				<label class="left" for="{@id}"><xsl:value-of select="@display"/></label>
			</div>
			</xsl:for-each>
			&#160;
		</div>
	</xsl:template>

	<xsl:template match="formline[@type='date']">
		<xsl:variable name="fill" select="ancestor::module[@type='recherche']/@fill"/>
		<div class="formline">
			<label class="left" for="{@id}"><xsl:value-of select="@display"/></label>
			<xsl:if test="@andormot='true'">
			<select class="right" name="op_mot_{@name}">
				<xsl:choose>
					<xsl:when test="$fill">
						<xsl:variable name="andorValue"><xsl:value-of select="//sdx:parameter[@name=concat('op_mot_',current()/@name)]/@value"/></xsl:variable>
						<option value="and">
							<xsl:if test="$andorValue='and'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
						ET</option>
						<option value="or">
							<xsl:if test="$andorValue='or'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
						OU</option>
						<option value="not">
							<xsl:if test="$andorValue='not'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
						SAUF</option>
					</xsl:when>
					<xsl:otherwise>
						<option value="and">ET</option>
						<option value="or">OU</option>
						<option value="not">SAUF</option>
					</xsl:otherwise>
				</xsl:choose>
			</select>
			</xsl:if>
			<input type="date" name="{@name}" id="{@id}" class="center date">
				<xsl:if test="$fill">
					<xsl:attribute name="value"><xsl:value-of select="//sdx:parameter[@name=current()/@name]/@htmlEscapedValue"/></xsl:attribute>
				</xsl:if>
			</input>
			<xsl:if test="@andor='true'">
			<select class="right" name="op_champ_{@name}">
				<xsl:choose>
					<xsl:when test="$fill">
						<xsl:variable name="andorValue"><xsl:value-of select="//sdx:parameter[@name=concat('op_champ_',current()/@name)]/@value"/></xsl:variable>
						<option value="and">
							<xsl:if test="$andorValue='and'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
						ET</option>
						<option value="or">
							<xsl:if test="$andorValue='or'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
						OU</option>
						<option value="not">
							<xsl:if test="$andorValue='not'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
						SAUF</option>
					</xsl:when>
					<xsl:otherwise>
						<option value="and">ET</option>
						<option value="or">OU</option>
						<option value="not">SAUF</option>
					</xsl:otherwise>
				</xsl:choose>
			</select>
			</xsl:if>
			<xsl:if test="@thesaurus='true'">
				<a class="right thesaurus" onclick="window.open(this.href); return false;" href="http://thesurb.documentation.equipement.gouv.fr/">&#160;</a>
			</xsl:if>
		</div>
	</xsl:template>

	<xsl:template match="formline[@type='number']">
		<xsl:variable name="fill" select="ancestor::module[@type='recherche']/@fill"/>
		<div class="formline">
			<label class="left" for="{@id}"><xsl:value-of select="@display"/></label>
			<xsl:if test="@andormot='true'">
			<select class="right" name="op_mot_{@name}">
				<xsl:choose>
					<xsl:when test="$fill">
						<xsl:variable name="andorValue"><xsl:value-of select="//sdx:parameter[@name=concat('op_mot_',current()/@name)]/@value"/></xsl:variable>
						<option value="and">
							<xsl:if test="$andorValue='and'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
						ET</option>
						<option value="or">
							<xsl:if test="$andorValue='or'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
						OU</option>
						<option value="not">
							<xsl:if test="$andorValue='not'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
						SAUF</option>
					</xsl:when>
					<xsl:otherwise>
						<option value="and">ET</option>
						<option value="or">OU</option>
						<option value="not">SAUF</option>
					</xsl:otherwise>
				</xsl:choose>
			</select>
			</xsl:if>
			<xsl:if test="@numop='true'">
			<select class="right" name="numop_champ_{@name}">
				<xsl:choose>
					<xsl:when test="$fill">
						<xsl:variable name="numopValue"><xsl:value-of select="//sdx:parameter[@name=concat('numop_champ_',current()/@name)]/@value"/></xsl:variable>
						<option value="eq">
							<xsl:if test="$numopValue='and'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
							<xsl:text>=</xsl:text>
						</option>
						<option value="gteq">
							<xsl:if test="$numopValue='or'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
							<xsl:text>&gt;=</xsl:text>
						</option>
						<option value="lteq">
							<xsl:if test="$numopValue='not'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
							<xsl:text>&lt;=</xsl:text>
						</option>
						<option value="neq">
							<xsl:if test="$numopValue='not'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
							<xsl:text>Sauf</xsl:text>
						</option>
					</xsl:when>
					<xsl:otherwise>
						<option value="eq">=</option>
						<option value="gteq">&gt;=</option>
						<option value="lteq">&lt;=</option>
						<option value="neq">Sauf</option>
					</xsl:otherwise>
				</xsl:choose>
			</select>
			</xsl:if>
			<input type="number" name="{@name}" id="{@id}" class="center date">
				<xsl:if test="$fill">
					<xsl:attribute name="value"><xsl:value-of select="//sdx:parameter[@name=current()/@name]/@htmlEscapedValue"/></xsl:attribute>
				</xsl:if>
			</input>
			<xsl:if test="@andor='true'">
			<select class="right" name="op_champ_{@name}">
				<xsl:choose>
					<xsl:when test="$fill">
						<xsl:variable name="andorValue"><xsl:value-of select="//sdx:parameter[@name=concat('op_champ_',current()/@name)]/@value"/></xsl:variable>
						<option value="and">
							<xsl:if test="$andorValue='and'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
						ET</option>
						<option value="or">
							<xsl:if test="$andorValue='or'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
						OU</option>
						<option value="not">
							<xsl:if test="$andorValue='not'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
						SAUF</option>
					</xsl:when>
					<xsl:otherwise>
						<option value="and">ET</option>
						<option value="or">OU</option>
						<option value="not">SAUF</option>
					</xsl:otherwise>
				</xsl:choose>
			</select>
			</xsl:if>
			<xsl:if test="@thesaurus='true'">
				<a class="right thesaurus" onclick="window.open(this.href); return false;" href="http://thesurb.documentation.equipement.gouv.fr/">&#160;</a>
			</xsl:if>
		</div>
	</xsl:template>

	<xsl:template match="formline[@type='date-range']">
		<xsl:variable name="fill" select="ancestor::module[@type='recherche']/@fill"/>
		<div class="formline date-range">
			<label class="left"><xsl:value-of select="@display"/></label>
			<xsl:if test="@andormot='true'">
			<select class="right" name="op_mot_{@name}">
				<xsl:choose>
					<xsl:when test="$fill">
						<xsl:variable name="andorValue"><xsl:value-of select="//sdx:parameter[@name=concat('op_mot_',current()/@name)]/@value"/></xsl:variable>
						<option value="and">
							<xsl:if test="$andorValue='and'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
						ET</option>
						<option value="or">
							<xsl:if test="$andorValue='or'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
						OU</option>
						<option value="not">
							<xsl:if test="$andorValue='not'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
						SAUF</option>
					</xsl:when>
					<xsl:otherwise>
						<option value="and">ET</option>
						<option value="or">OU</option>
						<option value="not">SAUF</option>
					</xsl:otherwise>
				</xsl:choose>
			</select>
			</xsl:if>
			<xsl:choose>
				<xsl:when test="@oneDay='true'">
					<select name="{@name}_select" id="{@name}_select">
                                            <option value="entre">
						<xsl:if test="$fill">
							<xsl:if test="//sdx:parameter[@name=concat(current()/@name,'_select')]/@value = 'entre'">
								<xsl:attribute name="selected"><xsl:text>selected</xsl:text></xsl:attribute>
							</xsl:if>
						</xsl:if>
						<xsl:text>entre</xsl:text>
					    </option>
                                            <option value="le">
						<xsl:choose>
							<xsl:when test="$fill">
								<xsl:choose>
									<xsl:when test="//sdx:parameter[@name=concat(current()/@name,'_select')]/@value = 'entre'">
									</xsl:when>
									<xsl:otherwise>
										<xsl:attribute name="selected"><xsl:text>selected</xsl:text></xsl:attribute>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:when>
							<xsl:otherwise>
								<xsl:attribute name="selected"><xsl:text>selected</xsl:text></xsl:attribute>
							</xsl:otherwise>
						</xsl:choose>
						<xsl:text>le</xsl:text>
					    </option>
                                        </select>
					<div class="range_wrapper" id="{@name}_range_wrapper">
						<input type="date" name="{@name}_from" id="{@name}_from" class="center date">
							<xsl:if test="$fill">
								<xsl:attribute name="value"><xsl:value-of select="//sdx:parameter[@name=concat(current()/@name,'_from')]/@value"/></xsl:attribute>
							</xsl:if>
						</input>
						<span class="texte">et </span>
						<input type="date" name="{@name}_to" id="{@name}_to" class="center date">
							<xsl:if test="$fill">
								<xsl:attribute name="value"><xsl:value-of select="//sdx:parameter[@name=concat(current()/@name,'_to')]/@value"/></xsl:attribute>
							</xsl:if>
						</input>
					</div>
					<div class="oneDay_wrapper" id="{@name}_oneDay_wrapper">
						<input type="date" name="{@name}_oneDay" id="{@name}_oneDay" class="center date">
							<xsl:if test="$fill">
								<xsl:attribute name="value"><xsl:value-of select="//sdx:parameter[@name=concat(current()/@name,'_oneDay')]/@value"/></xsl:attribute>
							</xsl:if>
						</input>
					</div>
					<script type="text/javascript">
						function <xsl:value-of select="@name"/>_select_display(){
							var dSelect=$("#<xsl:value-of select="@name"/>_select option:selected").val();

							if ( dSelect == "le") {
									$("#<xsl:value-of select="@name"/>_range_wrapper input").each(function(){
										$(this).val("");
									});
									$("#<xsl:value-of select="@name"/>_range_wrapper").css("display","none");
									$("#<xsl:value-of select="@name"/>_oneDay_wrapper").css("display","inline");
							} else {
									$("#<xsl:value-of select="@name"/>_oneDay_wrapper input").each(function(){
										$(this).val("");
									});
									$("#<xsl:value-of select="@name"/>_oneDay_wrapper").css("display","none");
									$("#<xsl:value-of select="@name"/>_range_wrapper").css("display","inline");
							}
						}

						<xsl:value-of select="@name"/>_select_display();

						$('#<xsl:value-of select="@name"/>_select').on('change', function () {
						
							<xsl:value-of select="@name"/>_select_display();
						    
						});
					 </script>
				</xsl:when>
				<xsl:otherwise>
					<span class="texte">entre </span>
					<input type="date" name="{@name}_from" id="{@name}_from" class="center date">
						<xsl:if test="$fill">
							<xsl:attribute name="value"><xsl:value-of select="//sdx:parameter[@name=concat(current()/@name,'_from')]/@value"/></xsl:attribute>
						</xsl:if>
					</input>
					<span class="texte">et </span>
					<input type="date" name="{@name}_to" id="{@name}_to" class="center date">
						<xsl:if test="$fill">
							<xsl:attribute name="value"><xsl:value-of select="//sdx:parameter[@name=concat(current()/@name,'_to')]/@value"/></xsl:attribute>
						</xsl:if>
					</input>
				</xsl:otherwise>
			</xsl:choose>
			<xsl:if test="@andor='true'">
			<select class="right" name="op_champ_{@name}">
				<xsl:choose>
					<xsl:when test="$fill">
						<xsl:variable name="andorValue"><xsl:value-of select="//sdx:parameter[@name=concat('op_champ_',current()/@name)]/@value"/></xsl:variable>
						<option value="and">
							<xsl:if test="$andorValue='and'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
						ET</option>
						<option value="or">
							<xsl:if test="$andorValue='or'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
						OU</option>
						<option value="not">
							<xsl:if test="$andorValue='not'"><xsl:attribute name="selected">selected</xsl:attribute></xsl:if>
						SAUF</option>
					</xsl:when>
					<xsl:otherwise>
						<option value="and">ET</option>
						<option value="or">OU</option>
						<option value="not">SAUF</option>
					</xsl:otherwise>
				</xsl:choose>
			</select>
			</xsl:if>
			<xsl:if test="@thesaurus='true'">
				<a class="right thesaurus" onclick="window.open(this.href); return false;" href="http://thesurb.documentation.equipement.gouv.fr/">&#160;</a>
			</xsl:if>
		</div>
	</xsl:template>

		<!-- Module résultats -->
	
	<xsl:template match="module[@type='résultats']">
		<div>
			<xsl:attribute name="class">
				<xsl:text>module </xsl:text>
				<xsl:choose>
					<xsl:when test="@subtype='liste-bloc'">
						<xsl:text>liste </xsl:text>
					</xsl:when>
					<xsl:otherwise>
						<xsl:text>results </xsl:text>
					</xsl:otherwise>
				</xsl:choose>
				<xsl:if test="@class"><xsl:value-of select="@class"/><xsl:text> </xsl:text></xsl:if>
			</xsl:attribute>
				<!--
				<xsl:if test="@class"><xsl:attribute name="class">module results <xsl:value-of select="@class"/></xsl:attribute></xsl:if>
				-->
			<!-- Contrôle des résultats -->
			<xsl:variable name="gsdxresults"><xsl:value-of select=".//sdx:results | //query[@qid=current()/results/@qref]/sdx:results"/></xsl:variable>
			<xsl:variable name="sdxrnum"><xsl:value-of select=".//sdx:results/@pages | //query[@qid=current()/results/@qref]/sdx:results/@pages"/></xsl:variable>
			<xsl:if test="not( $gsdxresults ) or $sdxrnum = 0">
				<!-- <xsl:text>Il n'y a aucune réponse à votre question</xsl:text> -->
				<div class="noresults">
				<xsl:text>Aucune réponse n’a été trouvée.</xsl:text>
				</div>
			</xsl:if>
			<!-- Affichage du titre -->
			<xsl:choose>
				<xsl:when test="title[@qref][@field]">
					<xsl:for-each select="title[@qref][@field]">
						<xsl:if test="//query[@qid=current()/@qref]/sdx:results/sdx:result/sdx:field[@name=current()/@field]/@value">
							<h1><xsl:value-of select="//query[@qid=current()/@qref]/sdx:results/sdx:result/sdx:field[@name=current()/@field]/@value"/></h1>
						</xsl:if>
					</xsl:for-each>
					<hr/>
					<br class="space"/>
				</xsl:when>
				<xsl:when test="title">
					<h2><xsl:value-of select="title"/></h2>
					<hr/>
					<br class="space"/>
				</xsl:when>
				<xsl:otherwise>
				</xsl:otherwise>
			</xsl:choose>
			<!--
			<xsl:apply-templates select="query"/>
			<xsl:apply-templates select="pagination"/>
			<xsl:apply-templates select="sort"/>
			<xsl:apply-templates select=".//results"/>
			<xsl:apply-templates select="pagination"/>
			-->
			<xsl:choose>
				<xsl:when test="@basket='true'">
					<form action="results.html" method="GET">
						<xsl:apply-templates/>
					</form>
				</xsl:when>
				<xsl:otherwise>
					<xsl:apply-templates/>
				</xsl:otherwise>
			</xsl:choose>
		</div>
	</xsl:template>

	<xsl:template match="query[parent::module/@type='résultats'][@type='select']">
		<xsl:variable name="qprops" select="."/>
		<div class="queryselect">
			<xsl:for-each select="$qprops/param">
				<xsl:if test="//sdx:parameters/sdx:parameter[@name=current()/@name]">
					<xsl:value-of select="@display"/><xsl:text> : </xsl:text>
				</xsl:if>
				<xsl:for-each select="//sdx:parameters/sdx:parameter[@name=current()/@name]">
					<span><xsl:value-of select="@value"/> </span>
				</xsl:for-each>
			</xsl:for-each>
		</div>
	</xsl:template>

	<xsl:template match="query[parent::module/@type='résultats'][not(@type)]">
		<div class="query">
			<xsl:apply-templates select="ancestor::module[@type='résultats']//sdx:results/sdx:query | //query[@qid=current()/@qref]/sdx:results/sdx:query" mode="string"/>
		</div>
	</xsl:template>

	<xsl:template match="sort[parent::module/@type='résultats'][not(@type)]">
		<xsl:variable name="gsdxresults" select="ancestor::module[@type='résultats']//sdx:results | //query[@qid=current()/@qref]/sdx:results"/>
		<xsl:variable name="sdxrnum" select="ancestor::module[@type='résultats']//sdx:results/@pages | //query[@qid=current()/@qref]/sdx:results/@pages"/>
		<xsl:if test="$gsdxresults and $sdxrnum != 0">
			<div class="tri">
				<xsl:if test="not(@nodisplay='true')">
				Trier par :  
				</xsl:if>
				<xsl:variable name="sprops" select="."/>
				<xsl:for-each select="$sprops/field">
					<span>
					<xsl:if test="@display and @display != ''">
						<xsl:value-of select="@display"/>
					</xsl:if>
					<xsl:if test="@asc">
						<a href="{concat($sprops/@to,'?',$queryParameters,'sort=',@name,'&amp;amp;order=ascendant')}"><xsl:value-of select="@asc"/></a>
					</xsl:if>
					<xsl:if test="@dsc">
						<a href="{concat($sprops/@to,'?',$queryParameters,'sort=',@name,'&amp;amp;order=descendant')}"><xsl:value-of select="@dsc"/></a>
					</xsl:if>
					</span>
					<xsl:if test="position()!=last()"> | </xsl:if>
				</xsl:for-each>
			</div>
			<hr/>
			<br class="clear"/>
		</xsl:if>
	</xsl:template>

	<xsl:template match="results[@type='liste'][parent::module/@type='résultats']">
		<ul>
			<xsl:variable name="rprops" select="."/>
			<xsl:for-each select=".//sdx:result |  //query[@qid=$rprops/@qref]/sdx:results/sdx:result">
				<xsl:variable name="result" select="."/>
				<li>
					<xsl:choose>
						<xsl:when test="$rprops/fields/evenodd[@type='checkfield']">
							<xsl:for-each select="$rprops/fields/evenodd[@type='checkfield']">
								<xsl:if test="$result/sdx:field[@name=current()/@field][@value=current()/@fieldValue]">	
									<xsl:attribute name="class"><xsl:value-of select="@class"/></xsl:attribute>
								</xsl:if>
							</xsl:for-each>
						</xsl:when>
					</xsl:choose>
					<div>&#160;
					<xsl:for-each select="$rprops/fields/field">
						<xsl:choose>
							<xsl:when test="@type='num'">
								<span class="order"><xsl:value-of select="$result/@no"/></span>
							</xsl:when>
							<xsl:when test="@type='field'">
								<a href="{$rprops/@linkto}?id={$result/sdx:field[@name='sdxdocid']/@value}"><xsl:value-of select="$result/sdx:field[@name=current()/@name]/@value"/></a>
							</xsl:when>
							<xsl:when test="@type='staticfield'">
								<xsl:choose>
									<xsl:when test="@process='date'">
										<xsl:variable name="fvalue" select="$result/sdx:field[@name=current()/@name]/@value"/>
										<span class="sousTitre"><xsl:value-of select="substring($fvalue,9,2)"/>/<xsl:value-of select="substring($fvalue,6,2)"/>/<xsl:value-of select="substring($fvalue,1,4)"/></span>
									</xsl:when>
                                                                        <xsl:when test="@process='annee'">
                                                                                <xsl:variable name="fvalue" select="$result/sdx:field[@name=current()/@name]/@value"/>
                                                                                <span class="sousTitre"><xsl:value-of select="substring($fvalue,1,4)"/></span>
                                                                        </xsl:when>
									<xsl:otherwise>
										<span class="sousTitre"><xsl:value-of select="$result/sdx:field[@name=current()/@name]/@value"/></span>
									</xsl:otherwise>
								</xsl:choose>
							</xsl:when>
							<xsl:when test="@type='date'">
								<xsl:variable name="fvalue"><xsl:value-of select="$result/sdx:field[@name=current()/@name]/@value"/></xsl:variable>
								<xsl:value-of select="substring($fvalue,9,2)"/>/<xsl:value-of select="substring($fvalue,6,2)"/>/<xsl:value-of select="substring($fvalue,1,4)"/>
							</xsl:when>
							<xsl:otherwise>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:for-each>
					</div>
				</li>
			</xsl:for-each>
		</ul>
	</xsl:template>

	<xsl:template match="results[parent::module/@subtype='liste-bloc'][parent::module/@type='résultats']">
		<ul>
			<xsl:variable name="rprops" select="."/>
			<xsl:for-each select=".//sdx:result |  //query[@qid=$rprops/@qref]/sdx:results/sdx:result">
				<xsl:variable name="result" select="."/>
				<li>
					<xsl:choose>
						<xsl:when test="$rprops/fields/evenodd[@type='checkfield']">
							<xsl:for-each select="$rprops/fields/evenodd[@type='checkfield']">
								<xsl:if test="$result/sdx:field[@name=current()/@field][@value=current()/@fieldValue]">	
									<xsl:attribute name="class"><xsl:value-of select="@class"/></xsl:attribute>
								</xsl:if>
							</xsl:for-each>
						</xsl:when>
					</xsl:choose>
					<xsl:for-each select="$rprops/fields/field[position()=1]">
						<xsl:choose>
							<xsl:when test="@type='num'">
								<span class="order"><xsl:value-of select="$result/@no"/></span>
							</xsl:when>
							<xsl:when test="@type='field'">
								<a href="{$rprops/@linkto}?id={$result/sdx:field[@name='sdxdocid']/@value}"><xsl:value-of select="$result/sdx:field[@name=current()/@name]/@value"/></a>
							</xsl:when>
							<xsl:when test="@type='staticfield'">
								<span class="sousTitre"><xsl:value-of select="$result/sdx:field[@name=current()/@name]/@value"/></span>
							</xsl:when>
							<xsl:otherwise>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:for-each>
				</li>
				<xsl:if test="count( $rprops/fields/field) &gt; 1">
					<xsl:for-each select="$rprops/fields/field[position() &gt; 1]">
						<li class="resultdata">
						<xsl:choose>
							<xsl:when test="@type='num'">
								<span class="order"><xsl:value-of select="$result/@no"/></span>
							</xsl:when>
							<xsl:when test="@type='field'">
								<a href="{$rprops/@linkto}?id={$result/sdx:field[@name='sdxdocid']/@value}"><xsl:value-of select="$result/sdx:field[@name=current()/@name]/@value"/></a>
							</xsl:when>
							<xsl:when test="@type='staticfield'">
								<span class="sousTitre"><xsl:value-of select="$result/sdx:field[@name=current()/@name]/@value"/></span>
							</xsl:when>
							<xsl:when test="@type='date'">
								<xsl:variable name="fvalue"><xsl:value-of select="$result/sdx:field[@name=current()/@name]/@value"/></xsl:variable>
								<xsl:value-of select="substring($fvalue,9,2)"/>/<xsl:value-of select="substring($fvalue,6,2)"/>/<xsl:value-of select="substring($fvalue,1,4)"/>
							</xsl:when>
							<xsl:otherwise>
							</xsl:otherwise>
						</xsl:choose>
						</li>
					</xsl:for-each>
				</xsl:if>
			</xsl:for-each>
		</ul>
	</xsl:template>

			<!-- Sous-modules commun résultats/Panier -->

        <xsl:template match="results[@type='table'][parent::module/@type='résultats' or parent::module/@type='panier']">
		<xsl:variable name="gsdxresults" select="ancestor::module[@type='résultats']//sdx:results | //query[@qid=current()/@qref]/sdx:results"/>
		<xsl:variable name="sdxrnum" select="ancestor::module[@type='résultats']//sdx:results/@pages | //query[@qid=current()/@qref]/sdx:results/@pages"/>
		<xsl:if test="$gsdxresults and $sdxrnum != 0">
                <xsl:variable name="rprops" select="."/>
                <table>
                        <tr>
                                <xsl:for-each select="fields/field">
                                        <th>
						<xsl:attribute name="class"><xsl:value-of select="@class"/></xsl:attribute>
                                                <xsl:choose>
                                                        <xsl:when test="@sort='true' and @sortType='arrows'">
								<a class="sort-arrow" href="{concat(@to,'?',$queryParameters,'sort=',@name,'&amp;amp;order=ascendant')}"><xsl:value-of select="@asc"/><img src="images/arrow_up.png"/></a>
									<xsl:value-of select="@display"/>
								<a class="sort-arrow" href="{concat(@to,'?',$queryParameters,'sort=',@name,'&amp;amp;order=descendant')}"><xsl:value-of select="@dsc"/><img src="images/arrow_down.png"/></a>
                                                        </xsl:when>
                                                        <xsl:when test="@sort='true'">
                                                                <!-- Nom des paramètres de tri et d'ordre -->
                                                                <xsl:variable name="sortFieldName"><xsl:value-of select="//query[@qid=$rprops/@qref]/sdx:dynamicParameters/@sortFieldParam | .//sdx:dynamicParameters/@sortFieldParam"/></xsl:variable>
                                                                <xsl:variable name="sortOrderName"><xsl:value-of select="//query[@qid=$rprops/@qref]/sdx:dynamicParameters/@sortOrderParam | .//sdx:dynamicParameters/@sortOrderParam"/></xsl:variable>
                                                                <xsl:variable name="pageParamName"><xsl:value-of select="//query[@qid=$rprops/@qref]/sdx:dynamicParameters/@pageParam | .//sdx:dynamicParameters/@pageParam"/></xsl:variable>
                                                                <!-- Les valeurs par défaut des paramètres sont getQueryParameters / getSortParameters-->
                                                                <!--
                                                                <xsl:variable name="sfName"><xsl:value-of select="//query[@qid=$rprops/@qref]/sdx:dynamicParameters/@sortFieldParam | .//sdx:dynamicParameters/@sortFieldParam"/></xsl:variable>
                                                                <xsl:variable name="soName"><xsl:value-of select="//query[@qid=$rprops/@qref]/sdx:dynamicParameters/@sortOrderParam | .//sdx:dynamicParameters/@sortOrderParam"/></xsl:variable>
                                                                <xsl:variable name="pageParam"><xsl:value-of select="//query[@qid=$rprops/@qref]/sdx:dynamicParameters/@pageParam | .//sdx:dynamicParameters/@pageParam"/></xsl:variable>
                                                                <xsl:variable name="pageParamName"><xsl:choose>
                                                                        <xsl:when test="$pageParam!=''"><xsl:value-of select="$pageParam"/></xsl:when>
                                                                        <xsl:otherwise>p</xsl:otherwise>
                                                                </xsl:choose></xsl:variable>
                                                                <xsl:variable name="sortFieldName"><xsl:choose>
                                                                        <xsl:when test="$sfName!=''"><xsl:value-of select="$sfName"/></xsl:when>
                                                                        <xsl:otherwise>sort</xsl:otherwise>
                                                                </xsl:choose></xsl:variable>
                                                                <xsl:variable name="sortOrderName"><xsl:choose>
                                                                        <xsl:when test="$soName!=''"><xsl:value-of select="$soName"/></xsl:when>
                                                                        <xsl:otherwise>order</xsl:otherwise>
                                                                </xsl:choose></xsl:variable>
                                                                -->

                                                                <xsl:variable name="sortField"><xsl:choose>
                                                                        <xsl:when test="@sortField"><xsl:value-of select="@sortField"/></xsl:when>
                                                                        <xsl:otherwise><xsl:value-of select="@name"/></xsl:otherwise>
                                                                </xsl:choose></xsl:variable>
                                                                <xsl:variable name="sortOrder"><xsl:choose>
									<xsl:when test="//sdx:parameter[@name=$sortOrderName]/@value='ascendant'">
										<xsl:text>descendant</xsl:text>
									</xsl:when>
									<xsl:when test="//sdx:parameter[@name=$sortOrderName]/@value='descendant'">
										<xsl:text>ascendant</xsl:text>
									</xsl:when>
                                                                        <xsl:when test="@sortOrder"><xsl:value-of select="@sortOrder"/></xsl:when>
									<xsl:otherwise>ascendant</xsl:otherwise>
                                                                </xsl:choose></xsl:variable>
                                                                <xsl:variable name="customQueryParameters">
                                                                        <xsl:call-template name="getQueryParameters">
                                                                                <xsl:with-param name="pageParam"><xsl:value-of select="$pageParamName"/></xsl:with-param>
                                                                                <xsl:with-param name="sortParam"><xsl:value-of select="$sortFieldName"/></xsl:with-param>
                                                                                <xsl:with-param name="orderParam"><xsl:value-of select="$sortOrderName"/></xsl:with-param>
                                                                        </xsl:call-template>
                                                                </xsl:variable>
                                                                <a href="{concat(@to,'?',$customQueryParameters,$sortFieldName,'=',$sortField,'&amp;amp;',$sortOrderName,'=', $sortOrder)}"><xsl:value-of select="@display"/></a>
                                                        </xsl:when>
                                                        <xsl:when test="@type='checkbox'">
                                                                        <input type="checkbox" name="selectAll" value="true" title="Sélectionner tout" data-select-all="{@boxesname}"/>
                                                        </xsl:when>
                                                        <xsl:otherwise>
                                                                <xsl:value-of select="@display"/>
                                                        </xsl:otherwise>
                                                </xsl:choose>
                                        </th>
                                </xsl:for-each>
                        </tr>
                                <xsl:for-each select=".//sdx:result |  //query[@qid=$rprops/@qref]/sdx:results/sdx:result">
                                        <tr>
                                                <xsl:variable name="result" select="."/>
						<xsl:variable name="rid" select="$result/sdx:field[@name='sdxdocid']/@value"/>
                                                <xsl:choose>
                                                        <xsl:when test="$rprops/fields/evenodd[@type='checkfield']">
                                                                <xsl:for-each select="$rprops/fields/evenodd[@type='checkfield']">
                                                                        <xsl:if test="$result/sdx:field[@name=current()/@field][@value=current()/@fieldValue]">
                                                                                <xsl:attribute name="class"><xsl:value-of select="@class"/></xsl:attribute>
                                                                        </xsl:if>
                                                                </xsl:for-each>
                                                        </xsl:when>
                                                        <xsl:when test="$rprops/fields/evenodd[@type='odd']">
                                                                <xsl:for-each select="$rprops/fields/evenodd[@type='odd']">
                                                                        <xsl:if test="$result/@no mod 2 = 0">
                                                                                        <xsl:attribute name="class"><xsl:value-of select="@class"/></xsl:attribute>
                                                                        </xsl:if>
                                                                </xsl:for-each>
                                                        </xsl:when>
                                                        <xsl:when test="$rprops/fields/evenodd[@type='even']">
                                                                <xsl:for-each select="$rprops/fields/evenodd[@type='even']">
                                                                        <xsl:if test="$result/@no mod 2 = 1">
                                                                                        <xsl:attribute name="class"><xsl:value-of select="@class"/></xsl:attribute>
                                                                        </xsl:if>
                                                                </xsl:for-each>
                                                        </xsl:when>
                                                        <xsl:otherwise>
                                                        </xsl:otherwise>
                                                </xsl:choose>
                                                <xsl:variable name="requestId">
							<!--
                                                        <xsl:value-of select="$rprops/request-info" />
							-->
							<xsl:value-of select="//query[@qid=$rprops/@qref]/request-info/@luceneQuery | .//request-info/@luceneQuery"/>
                                                </xsl:variable>
                                                <xsl:for-each select="$rprops/fields/field">
                                                        <xsl:variable name="resultlink">
                                                                <xsl:choose>
                                                                        <xsl:when test="$rprops/@linkFromField">
                                                                                <xsl:value-of select="$result/sdx:field[@name=$rprops/@linkFromField]"/>
                                                                        </xsl:when>
                                                                        <xsl:when test="@rebond">
										<!--
                                                                                <xsl:value-of select="concat('?',$result/sdx:field[@name=current()/@name]/local-name(),'=',$result/sdx:field[@name=current()/@name]/@value)"/>
										-->
                                                                                <xsl:value-of select="concat('?',@rebond,'=','%22',$result/sdx:field[@name=current()/@name]/@escapedValue,'%22')"/>
                                                                        </xsl:when>
                                                                        <xsl:otherwise>
                                                                                <xsl:value-of select="concat($rprops/@linkto,'?id=',$result/sdx:field[@name='sdxdocid']/@value,'&amp;requestId=',$requestId,'&amp;number=',$result/@no)"/>
                                                                        </xsl:otherwise>
                                                                </xsl:choose>
                                                        </xsl:variable>
                                                        <td>
                                                        <xsl:choose>
                                                                <xsl:when test="@type='num'">
                                                                        <xsl:value-of select="$result/@no"/>
                                                                </xsl:when>
                                                                <xsl:when test="@type='checkbox'">
                                                                        <input type="checkbox" name="{@boxesname}" value="{$result/sdx:field[@name='sdxdocid']/@value}" title="sélectionner">
										<xsl:if test="@disable and $rprops/*[local-name()=current()/@disable]/id[$result/sdx:field[@name='sdxdocid']/@value] = $result/sdx:field[@name='sdxdocid']/@value">
												<xsl:attribute name="disabled">disabled</xsl:attribute>
												<xsl:attribute name="checked">checked</xsl:attribute>
										</xsl:if>
									</input>
                                                                </xsl:when>
                                                                <xsl:when test="@type='field'">
                                                                        <xsl:choose>
                                                                                <xsl:when test="@process='date'">
                                                                                        <xsl:variable name="fvalue" select="$result/sdx:field[@name=current()/@name]/@value"/>
<!--
                                                                                        <a href="{$rprops/@linkto}?id={$result/sdx:field[@name='sdxdocid']/@value}"><xsl:value-of select="substring($fvalue,9,2)"/>/<xsl:value-of select="substring($fvalue,6,2)"/>/<xsl:value-of select="substring($fvalue,1,4)"/></a>
-->
                                                                                        <a href="{$resultlink}">
                                                                                                <xsl:if test="$rprops/@linkFromField">
                                                                                                        <xsl:attribute name="target">_blank</xsl:attribute>
                                                                                                </xsl:if>
                                                                                                <xsl:if test="$fvalue">
                                                                                                        <xsl:value-of select="substring($fvalue,9,2)"/>/<xsl:value-of select="substring($fvalue,6,2)"/>/<xsl:value-of select="substring($fvalue,1,4)"/>
                                                                                                </xsl:if>
                                                                                        </a>
                                                                                </xsl:when>
                                                                                <xsl:when test="@process='annee'">
											<xsl:attribute name="class">date</xsl:attribute>
                                                                                        <xsl:variable name="fvalue" select="$result/sdx:field[@name=current()/@name]/@value"/>
<!--
                                                                                        <a href="{$rprops/@linkto}?id={$result/sdx:field[@name='sdxdocid']/@value}"><xsl:value-of select="substring($fvalue,9,2)"/>/<xsl:value-of select="substring($fvalue,6,2)"/>/<xsl:value-of select="substring($fvalue,1,4)"/></a>
-->
                                                                                        <a href="{$resultlink}">
                                                                                                <xsl:if test="$rprops/@linkFromField">
                                                                                                        <xsl:attribute name="target">_blank</xsl:attribute>
                                                                                                </xsl:if>
                                                                                                <xsl:if test="$fvalue">
                                                                                                        <xsl:value-of select="substring($fvalue,1,4)"/>
                                                                                                </xsl:if>
                                                                                        </a>
                                                                                </xsl:when>
										<xsl:when test="@process='text-pj'">
											<xsl:variable name="linkedText">
												<xsl:call-template name="temis-pj">
													<xsl:with-param name="text" select="$result/sdx:field[@name=current()/@name]/@value"/>
												</xsl:call-template>
											</xsl:variable>
											<xsl:call-template name="cr2br">
												<xsl:with-param name="text" select="$linkedText"/>
											</xsl:call-template>
										</xsl:when>
										<xsl:when test="@process='text-nopj'">
                                                                                        <xsl:variable name="fvalue" select="$result/sdx:field[@name=current()/@name]/@value"/>
                                                                                        <a href="{$resultlink}">
                                                                                                <xsl:if test="$rprops/@linkFromField">
                                                                                                        <xsl:attribute name="target">_blank</xsl:attribute>
                                                                                                </xsl:if>
												<xsl:variable name="linkedText">
													<xsl:call-template name="no-pj">
														<xsl:with-param name="text" select="$fvalue"/>
													</xsl:call-template>
												</xsl:variable>
												<xsl:call-template name="cr2br">
													<xsl:with-param name="text" select="$linkedText"/>
												</xsl:call-template>
                                                                                        </a>
										</xsl:when>
                                                                                <xsl:when test="@process='heures'">
											<xsl:if test="$result/sdx:field[@name=current()/@name]/@value">
                                                                                		<xsl:value-of select="$result/sdx:field[@name=current()/@name]/@value"/> heure(s)
											</xsl:if>
										</xsl:when>

                                                                                <xsl:otherwise>
<!--
                                                                                        <a href="{$rprops/@linkto}?id={$result/sdx:field[@name='sdxdocid']/@value}"><xsl:value-of select="$result/sdx:field[@name=current()/@name]/@value"/></a>
-->
											<xsl:for-each select="$result/sdx:field[@name=current()/@name]">	
                                                                                        <a href="{$resultlink}">
                                                                                                <xsl:if test="$rprops/@linkFromField">
                                                                                                        <xsl:attribute name="target">_blank</xsl:attribute>
                                                                                                </xsl:if>
                                                                                                <xsl:value-of select="@value"/>
                                                                                        </a>
											<xsl:if test="position()!=last()">, </xsl:if>
											</xsl:for-each>
                                                                                </xsl:otherwise>
                                                                        </xsl:choose>
                                                                </xsl:when>
                                                                <xsl:when test="@type='haspjfield'">
									<xsl:if test="$result/sdx:field[@name=current()/@name]">
										<xsl:variable name="docPath">
											<xsl:call-template name="composePath">
												<xsl:with-param name="name" select="$result/sdx:field[@name=current()/@name]/@value" />
												<xsl:with-param name="rid" select="$rid" />
											</xsl:call-template>
										</xsl:variable>
										<xsl:choose>
											<xsl:when test="contains($result/sdx:field[@name=current()/@name]/@value, '.epub')">
												<a class="pj" href="{$resultlink}">
													<img alt="{$result/sdx:field[@name=current()/@name]/@value}" title="{$result/sdx:field[@name=current()/@name]/@value}" src="images/epub_petit.png"/>
												</a>
											</xsl:when>
											<xsl:otherwise>
												<a class="pj" href="{$resultlink}">
													<img alt="{$result/sdx:field[@name=current()/@name]/@value}" title="{$result/sdx:field[@name=current()/@name]/@value}" src="images/pdf_petit.png"/>
												</a>
											</xsl:otherwise>
										</xsl:choose>
									</xsl:if>
                                                                </xsl:when>
                                                                <xsl:when test="@type='pjfield'">
									<xsl:for-each select="$result/sdx:field[@name=current()/@name]">
										<xsl:variable name="docPath">
											<xsl:call-template name="composePath">
												<xsl:with-param name="name" select="@value" />
												<xsl:with-param name="rid" select="$rid" />
											</xsl:call-template>
										</xsl:variable>
										<a class="pj" href="{$docPath}">
                                                                                	<img alt="{@value}" title="{@value}" src="images/pdf_petit.png"/>
										</a>
									</xsl:for-each>
                                                                </xsl:when>
                                                                <xsl:when test="@type='urlfield'">
									<xsl:for-each select="$result/sdx:field[@name=current()/@name]">
										<a class="pj" href="{@value}">
                                                                                	<img alt="{@value}" title="{@value}" src="images/lien_externe_petit.png"/>
										</a>
									</xsl:for-each>
                                                                </xsl:when>
                                                                <xsl:when test="@type='multipjfield'">
									<xsl:for-each select="entry">
										<xsl:choose>
											<xsl:when test="@type='pj'">
												<xsl:for-each select="$result/sdx:field[@name=current()/@name]">
													<xsl:variable name="ext">
														<xsl:call-template name="getFileExtension">
															<xsl:with-param name="filename" select="@value"/>
														</xsl:call-template>
													</xsl:variable>
													<xsl:variable name="docPath">
														<xsl:call-template name="composePath">
															<xsl:with-param name="name" select="@value" />
															<xsl:with-param name="rid" select="$rid" />
														</xsl:call-template>
													</xsl:variable>
													<a class="pj" href="{$docPath}">
														<!--
														<xsl:attribute name="class">
															<xsl:choose>
																<xsl:when test="$ext='doc'">
																	<xsl:text>pj pj-doc</xsl:text>
																</xsl:when>
																<xsl:when test="$ext='pdf'">
																	<xsl:text>pj pj-pdf</xsl:text>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:text>pj pj-pdf</xsl:text>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:attribute>
														-->
														<xsl:choose>
															<xsl:when test="$ext='doc'">
																<img alt="{@value}" title="{@value}" src="images/doc_petit.png"/>
																</xsl:when>
																<xsl:when test="$ext='pdf'">
																	<img alt="{@value}" title="{@value}" src="images/pdf_petit.png"/>
																</xsl:when>
																<xsl:otherwise>
																	<img alt="{@value}" title="{@value}" src="images/pdf_petit.png"/>
																</xsl:otherwise>
															</xsl:choose>
													</a>
												</xsl:for-each>
											</xsl:when>
											<xsl:when test="@type='url'">
												<xsl:for-each select="$result/sdx:field[@name=current()/@name]">
													<a class="pj" href="{@value}">
														<img alt="{@value}" title="{@value}" src="images/lien_externe_petit.png"/>
													</a>
												</xsl:for-each>
											</xsl:when>
											<xsl:otherwise>
												<!-- Do nothing -->
											</xsl:otherwise>
										</xsl:choose>
									</xsl:for-each>
                                                                </xsl:when>
                                                                <xsl:otherwise>
                                                                </xsl:otherwise>
                                                        </xsl:choose>
                                                        </td>
                                                </xsl:for-each>
                                        </tr>
                                </xsl:for-each>
                </table>
                <br class="clear"/>
		</xsl:if>
        </xsl:template>


	<!-- Version liste -->
        <xsl:template match="results[@type='liste'][parent::module/@type='résultats' or parent::module/@type='panier']">
                <xsl:variable name="rprops" select="."/>
                <div class="liste-resultats">
                                <xsl:for-each select=".//sdx:result |  //query[@qid=$rprops/@qref]/sdx:results/sdx:result">
                                        <div class="liste-resultat">
                                                <xsl:variable name="result" select="."/>
                                                <xsl:variable name="requestId">
							<!--
                                                        <xsl:value-of select="$rprops/request-info" />
							-->
							<xsl:value-of select="//query[@qid=$rprops/@qref]/request-info/@luceneQuery | .//request-info/@luceneQuery"/>
                                                </xsl:variable>
                                                <xsl:for-each select="$rprops/fields/field[@type='checkbox']">
                                                        <xsl:choose>
								<xsl:when test="@type='checkbox'">
									<div class="coche-resultats">
										<span>
											<input type="checkbox" name="{@boxesname}" value="{$result/sdx:field[@name='sdxdocid']/@value}" title="sélectionner"/>
										</span>
									</div>
								</xsl:when>
								<xsl:otherwise>
								</xsl:otherwise>
                                                        </xsl:choose>
						</xsl:for-each>
                                                <xsl:for-each select="$rprops/fields/field[not(@type='checkbox')][position()=1]">
							<div class="contenu-resultats-header">
                                                        <xsl:variable name="resultlink">
                                                                <xsl:choose>
                                                                        <xsl:when test="$rprops/@linkFromField">
                                                                                <xsl:value-of select="$result/sdx:field[@name=$rprops/@linkFromField]"/>
                                                                        </xsl:when>
                                                                        <xsl:otherwise>
                                                                                <xsl:value-of select="concat($rprops/@linkto,'?id=',$result/sdx:field[@name='sdxdocid']/@value,'&amp;requestId=',$requestId,'&amp;number=',$result/@no)"/>
                                                                        </xsl:otherwise>
                                                                </xsl:choose>
                                                        </xsl:variable>
								<span>
								<xsl:for-each select="$result/sdx:field[@name=current()/@name]">	
									<a href="{$resultlink}">
										<xsl:if test="$rprops/@linkFromField">
											<xsl:attribute name="target">_blank</xsl:attribute>
										</xsl:if>
										<xsl:value-of select="@value"/>
									</a>
									<xsl:if test="position()!=last()">, </xsl:if>
								</xsl:for-each>
								</span>
							</div>
						</xsl:for-each>
						<div class="contenu-resultats">
                                                <xsl:for-each select="$rprops/fields/field[not(@type='checkbox')][position()!=1]">
                                                        <xsl:variable name="resultlink">
                                                                <xsl:choose>
                                                                        <xsl:when test="$rprops/@linkFromField">
                                                                                <xsl:value-of select="$result/sdx:field[@name=$rprops/@linkFromField]"/>
                                                                        </xsl:when>
                                                                        <xsl:otherwise>
                                                                                <xsl:value-of select="concat($rprops/@linkto,'?id=',$result/sdx:field[@name='sdxdocid']/@value,'&amp;requestId=',$requestId,'&amp;number=',$result/@no)"/>
                                                                        </xsl:otherwise>
                                                                </xsl:choose>
                                                        </xsl:variable>
                                                        <span>
                                                        <xsl:choose>
                                                                <xsl:when test="@type='num'">
                                                                        <xsl:value-of select="$result/@no"/>
                                                                </xsl:when>
                                                                <xsl:when test="@type='field'">
                                                                        <xsl:choose>
                                                                                <xsl:when test="@process='date'">
                                                                                        <xsl:variable name="fvalue" select="$result/sdx:field[@name=current()/@name]/@value"/>
<!--
                                                                                        <a href="{$rprops/@linkto}?id={$result/sdx:field[@name='sdxdocid']/@value}"><xsl:value-of select="substring($fvalue,9,2)"/>/<xsl:value-of select="substring($fvalue,6,2)"/>/<xsl:value-of select="substring($fvalue,1,4)"/></a>
-->
                                                                                        <a href="{$resultlink}">
                                                                                                <xsl:if test="$rprops/@linkFromField">
                                                                                                        <xsl:attribute name="target">_blank</xsl:attribute>
                                                                                                </xsl:if>
                                                                                                <xsl:if test="$fvalue">
                                                                                                        <xsl:value-of select="substring($fvalue,9,2)"/>/<xsl:value-of select="substring($fvalue,6,2)"/>/<xsl:value-of select="substring($fvalue,1,4)"/>
                                                                                                </xsl:if>
                                                                                        </a>
                                                                                </xsl:when>
                                                                                <xsl:when test="@process='annee'">
                                                                                        <xsl:variable name="fvalue" select="$result/sdx:field[@name=current()/@name]/@value"/>
<!--
                                                                                        <a href="{$rprops/@linkto}?id={$result/sdx:field[@name='sdxdocid']/@value}"><xsl:value-of select="substring($fvalue,9,2)"/>/<xsl:value-of select="substring($fvalue,6,2)"/>/<xsl:value-of select="substring($fvalue,1,4)"/></a>
-->
                                                                                        <a href="{$resultlink}">
                                                                                                <xsl:if test="$rprops/@linkFromField">
                                                                                                        <xsl:attribute name="target">_blank</xsl:attribute>
                                                                                                </xsl:if>
                                                                                                <xsl:if test="$fvalue">
                                                                                                        <xsl:value-of select="substring($fvalue,1,4)"/>
                                                                                                </xsl:if>
                                                                                        </a>
                                                                                </xsl:when>

                                                                                <xsl:otherwise>
<!--
                                                                                        <a href="{$rprops/@linkto}?id={$result/sdx:field[@name='sdxdocid']/@value}"><xsl:value-of select="$result/sdx:field[@name=current()/@name]/@value"/></a>
-->
											<xsl:for-each select="$result/sdx:field[@name=current()/@name]">	
                                                                                        <a href="{$resultlink}">
                                                                                                <xsl:if test="$rprops/@linkFromField">
                                                                                                        <xsl:attribute name="target">_blank</xsl:attribute>
                                                                                                </xsl:if>
                                                                                                <xsl:value-of select="@value"/>
                                                                                        </a>
											<xsl:if test="position()!=last()">, </xsl:if>
											</xsl:for-each>
                                                                                </xsl:otherwise>
                                                                        </xsl:choose>
                                                                </xsl:when>
                                                                <xsl:when test="@type='pjfield'">
                                                                        <xsl:if test="$result/sdx:field[@name=current()/@name]/@value">
                                                                                <img alt="Présence de texte intégtal" title="Présence de texte intégtal" src="images/PDF.gif"/>
                                                                        </xsl:if>
                                                                </xsl:when>
                                                                <xsl:otherwise>
                                                                </xsl:otherwise>
                                                        </xsl:choose>
                                                        </span>
                                                </xsl:for-each>
						</div>
                                        </div>
                                </xsl:for-each>
                </div>
                <br class="clear"/>
        </xsl:template>


	<xsl:template match="pagination[parent::module/@type='résultats' or parent::module/@type='panier' or parent::entry/@type='search'][@type='next5']">
		<xsl:variable name="pprops" select="."/>
		<xsl:variable name="qref" select="@qref"/>
		<xsl:variable name="sdxresults" select="ancestor::module[@type='résultats']//sdx:results | //query[@qid=$qref]/sdx:results"/>
		<xsl:if test="$sdxresults and $sdxresults/@pages != 0">
			<div class="pagination">
				<xsl:for-each select="$sdxresults">
					<div class="pages">
						<xsl:value-of select="@start"/><xsl:text> - </xsl:text><xsl:value-of select="@end"/>
						<xsl:text> résultats affichés sur </xsl:text><xsl:value-of select="@nb"/>
					</div>

					<xsl:if test="$pprops/@hppSelector='true'">
					<xsl:variable name="hppSelectorParam" select="//query[@qid=$qref]/sdx:dynamicParameters/@hppParam"/>
					<xsl:variable name="hpp" select="//query[@qid=$qref]/sdx:results/@hpp"/>
					<div class="hppSelector" >
						<select name="{$hppSelectorParam}">
							<option value="10">
								<xsl:if test="$hpp='10' or $hpp=''">
									<xsl:attribute name="selected">selected</xsl:attribute>
								</xsl:if>
								10 résultats par page
							</option>
							<option value="20">
								<xsl:if test="$hpp='20'">
									<xsl:attribute name="selected">selected</xsl:attribute>
								</xsl:if>
								20 résultats par page
							</option>
							<option value="50">
								<xsl:if test="$hpp='50'">
									<xsl:attribute name="selected">selected</xsl:attribute>
								</xsl:if>
								50 résultats par page
							</option>
							<option value="100">
								<xsl:if test="$hpp='100'">
									<xsl:attribute name="selected">selected</xsl:attribute>
								</xsl:if>
								100 résultats par page
							</option>
						</select>
					</div>
					</xsl:if>

					<div class="suivantes">
						&#160;
						<xsl:variable name="ppos" select="number(@page)-1"/>
						<xsl:variable name="vend">
							<xsl:choose>
								<xsl:when test="number( substring($ppos, string-length($ppos), string-length($ppos)+1)) &lt; 5">
									<xsl:text>1</xsl:text>
								</xsl:when>
								<xsl:otherwise>
									<xsl:text>6</xsl:text>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:variable>

						<xsl:variable name="startAt">
							<xsl:value-of select="concat(substring($ppos, 1, string-length($ppos)-1),$vend)"/>
						</xsl:variable>

						<xsl:call-template name="suivantes">
							<xsl:with-param name="qprops" select="."/>
							<xsl:with-param name="startAt" select="$startAt"/>
							<xsl:with-param name="qref" select="$qref"/>
						</xsl:call-template>
					</div>
				</xsl:for-each>
			</div>
			<br class="clear"/>
			<hr/>
			<br class="space"/>
		</xsl:if>
	</xsl:template>

	<xsl:template name="suivantes">
		<xsl:param name="qprops"/>
		<xsl:param name="qref"/>
		<xsl:param name="startAt" select="'1'"/>
<!--
		<xsl:param name="startAt" select="$startAt"/>
-->
		<xsl:param name="pos" select="'0'"/>

		<xsl:variable name="suiv" select="$startAt + $pos"/>
		<!-- Définition du paramètre de pagination en cas de résultats multiples -->
		<xsl:variable name="pparam" select="//query[@qid=$qref]/sdx:dynamicParameters/@pageParam"/>
		<xsl:variable name="pageParam">
			<xsl:choose>
				<xsl:when test="$pparam!=''"><xsl:value-of select="$pparam"/></xsl:when>
				<xsl:otherwise>p</xsl:otherwise>
			</xsl:choose>
		</xsl:variable>
		<!-- <xsl:variable name="pageParam" select="//query[@qid=$qref]/sdx:dynamicParameters/@pageParam"/> -->
		<xsl:variable name="sortParam" select="//query[@qid=$qref]/sdx:dynamicParameters/@sortFieldParam"/>
		<xsl:variable name="sortOrderParam" select="//query[@qid=$qref]/sdx:dynamicParameters/@sortOrderParam"/>
		<!-- Les valeurs par défaut des paramètres sont getQueryParameters / getSortParameters-->
		<!--
		<xsl:variable name="sparam" select="//query[@qid=$qref]/sdx:dynamicParameters/@sortFieldParam"/>
		<xsl:variable name="soparam" select="//query[@qid=$qref]/sdx:dynamicParameters/@sortOrderParam"/>
		<xsl:variable name="sortParam">
			<xsl:choose>
				<xsl:when test="$sparam!=''"><xsl:value-of select="$sparam"/></xsl:when>
				<xsl:otherwise>sort</xsl:otherwise>
			</xsl:choose>
		</xsl:variable>
		<xsl:variable name="sortOrderParam">
			<xsl:choose>
				<xsl:when test="$soparam!=''"><xsl:value-of select="$soparam"/></xsl:when>
				<xsl:otherwise>order</xsl:otherwise>
			</xsl:choose>
		</xsl:variable>
		-->
		<xsl:variable name="customQueryParameters">
			<xsl:call-template name="getQueryParameters">
				<xsl:with-param name="pageParam"><xsl:value-of select="$pageParam"/></xsl:with-param>
				<xsl:with-param name="sortParam"><xsl:value-of select="$sortParam"/></xsl:with-param>
				<xsl:with-param name="orderParam"><xsl:value-of select="$sortOrderParam"/></xsl:with-param>
			</xsl:call-template>
		</xsl:variable>
		<xsl:variable name="customSortParameters">
			<xsl:call-template name="getSortParameters">
				<xsl:with-param name="sortParam"><xsl:value-of select="$sortParam"/></xsl:with-param>
				<xsl:with-param name="orderParam"><xsl:value-of select="$sortOrderParam"/></xsl:with-param>
			</xsl:call-template>
		</xsl:variable>

		<xsl:if test="$suiv &lt;= $qprops/@pages and $qprops/@pages !='1'">
			<xsl:if test="$startAt &gt; 1 and $suiv=$startAt">
				<a href="{$qprops/@to}?{$customQueryParameters}{$pageParam}={number($suiv)-1}&amp;amp;{$customSortParameters}">&lt; </a>
			</xsl:if>
			<xsl:choose>
				<xsl:when test="$suiv=$qprops/@page">
					<span class="page_courante"><xsl:value-of select="$suiv"/></span>
				</xsl:when>
				<xsl:otherwise>
					<a href="{$qprops/@to}?{$customQueryParameters}{$pageParam}={$suiv}&amp;amp;{$customSortParameters}"><xsl:value-of select="$suiv"/></a>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:if>

		<xsl:choose>
			<xsl:when test="$pos &lt; 4 and $suiv &lt; $qprops/@pages">
				<xsl:text> | </xsl:text>
				<xsl:call-template name="suivantes">
					<xsl:with-param name="qprops" select="$qprops"/>
					<xsl:with-param name="qref" select="$qref"/>
					<xsl:with-param name="startAt" select="$startAt"/>
					<xsl:with-param name="pos" select="$pos+1"/>
				</xsl:call-template>
			</xsl:when>
			<xsl:when test="$suiv &lt; $qprops/@pages">
				<a href="{$qprops/@to}?{$customQueryParameters}&amp;amp;{$pageParam}={$suiv+1}&amp;amp;{$customSortParameters}"> &gt;</a>
			</xsl:when>
			<xsl:otherwise>
			</xsl:otherwise>
		</xsl:choose>

	</xsl:template>

	<xsl:template match="context-tools[parent::module/@type='résultats' or parent::module/@type='panier']">
		<xsl:variable name="boxesname" select="@boxesname"/>
		<xsl:variable name="gsdxresults" select="ancestor::module[@type='résultats' or ancestor::module/@type='panier']//sdx:results | //query[@qid=current()/@qref]/sdx:results"/>
		<xsl:variable name="sdxrnum" select="ancestor::module[@type='résultats' or ancestor::module/@type='panier']//sdx:results/@pages | //query[@qid=current()/@qref]/sdx:results/@pages"/>
		<xsl:if test="$gsdxresults and $sdxrnum != 0">
		<div class="context-tools">
			<xsl:for-each select="tool">
				<xsl:if test="@type='addToBasket'">
					<a class="AddToBasket" data-basket-action="addSelected" data-basket-boxesname="{$boxesname}" title="Ajouter au porte-documents" href="javascript: void(0)">&#160;</a>
				</xsl:if>
				<xsl:if test="@type='deleteSelected'">
					<!--
					<a class="deleteSelected" data-basket-action="deleteSelected" data-basket-boxesname="{@boxesname}" title="Supprimer la sélection du panier" href="#">&#160;</a>
					-->
					<input type="hidden" name="action" value="remove"/>
					<input type="hidden" name="boxesname" value="{$boxesname}"/>
					<input type="submit" class="deleteSelected" data-basket-action="deleteSelected" data-basket-boxesname="{$boxesname}" title="Supprimer la sélection" value="&#160;"/>
				</xsl:if>
				<xsl:if test="@type='printSelected'">
					<a class="printSelected" title="Imprimer la sélection" data-print-action="printSelected" data-print-boxesname="{$boxesname}" href="javascript: void(0)">&#160;</a>
				</xsl:if>
				<xsl:if test="@type='sendSelected'">
					<a class="sendSelected" title="Envoyer la sélection par mail" data-send-action="sendSelected" data-send-boxesname="{$boxesname}" href="javascript: void(0)">&#160;</a>
				</xsl:if>
				<xsl:if test="@type='pdf'">
					<a class="exportPdf" title="exporter au format pdf" href="export-panier.pdf" target="_blank">&#160;</a>
				</xsl:if>
			</xsl:for-each>
		</div>
		<br class="clear"/>
		<br class="space"/>
		</xsl:if>
	</xsl:template>


	<xsl:template match="text[parent::module/@type='résultats' or parent::module/@type='panier']">
			<xsl:if test=".!=''">
				<div class="chapeau"><xsl:value-of select="."/></div>	
			</xsl:if>
	</xsl:template>
	<!--
        <xsl:template match="text[parent::module/@type='résultats' or parent::module/@type='panier']">
                <xsl:variable name="gsdxresults" select="ancestor::module[@type='résultats']//sdx:results | //query[@qid=current()/@qref]/sdx:results"/>
                <xsl:variable name="sdxrnum" select="ancestor::module[@type='résultats']//sdx:results/@pages | //query[@qid=current()/@qref]/sdx:results/@pages"/>
                <xsl:if test="$gsdxresults and $sdxrnum != 0">
                        <xsl:if test=".!=''">
                                <div class="chapeau"><xsl:value-of select="."/></div>
                        </xsl:if>
                </xsl:if>
        </xsl:template>
	-->


	<!-- Module Document -->


	<xsl:template match="module[@type='doc']">
		<xsl:variable name="dprops" select="."/>

		<div class="module doc">

			<xsl:choose>
				<xsl:when test="title[@qref][@field]">
					<xsl:for-each select="title[@qref][@field]">
						<h1>
							<xsl:choose>
								<xsl:when test="title/@process='text'">
									<xsl:call-template name="cr2br">
										<xsl:with-param name="text" select="//query[@qid=current()/@qref]/sdx:results/sdx:result/sdx:field[@name=current()/@field]/@value"/>
									</xsl:call-template>
								</xsl:when>
								<xsl:otherwise>
									<xsl:value-of select="//query[@qid=current()/@qref]/sdx:results/sdx:result/sdx:field[@name=current()/@field]/@value"/>
								</xsl:otherwise>
							</xsl:choose>
						</h1>
						<!--
						<xsl:if test="parent::*/@addToBasket='true'">
							<a class="AddToBasket" data-basket-action="addCurrent" data-basket-value="{//query[@qid=current()/@qref]/sdx:results/sdx:result/sdx:field[@name='sdxdocid']/@value}" title="Ajouter au porte-documents" href="#">&#160;</a>
						</xsl:if>
						<xsl:if test="parent::*/@sendCurrent='true'">
							<a class="sendSelected" title="Envoyer la sélection par mail" data-send-action="sendCurrent" data-send-value="{//query[@qid=current()/@qref]/sdx:results/sdx:result/sdx:field[@name='sdxdocid']/@value}" href="javascript: void(0)">&#160;</a>
						</xsl:if>
						-->
					</xsl:for-each>
					<!--
					<br class="space"/>
					-->
				</xsl:when>
				<xsl:when test="title[@qref][@docfield]">
					<xsl:for-each select="title[@qref][@docfield]">
						<h1>
							<xsl:choose>
								<xsl:when test="@process='text'">
									<xsl:call-template name="cr2br">
										
										<xsl:with-param name="text" select=".//record/*[local-name()=current()/@docfield] | //query[@qid=current()/@qref]/sdx:results/sdx:result/record/*[local-name()=current()/@docfield]"/>
									</xsl:call-template>
								</xsl:when>
								<xsl:when test="@process='text-pj'">
									<xsl:variable name="linkedText">
										<xsl:call-template name="temis-pj">
											<xsl:with-param name="text" select=".//record/*[local-name()=current()/@docfield] | //query[@qid=current()/@qref]/sdx:results/sdx:result/record/*[local-name()=current()/@docfield]"/>
										</xsl:call-template>
									</xsl:variable>
									<xsl:call-template name="cr2br">
										<xsl:with-param name="text" select="$linkedText"/>
									</xsl:call-template>
								</xsl:when>
								<xsl:otherwise>
									<xsl:value-of select=".//record/*[local-name()=current()/@docfield] | //query[@qid=current()/@qref]/sdx:results/sdx:result/record/*[local-name()=current()/@docfield]"/>
								</xsl:otherwise>
							</xsl:choose>
						</h1>
					</xsl:for-each>
					<!--
					<hr/>
					<br class="space"/>
					-->
				</xsl:when>
				<xsl:when test="title">
					<h2><xsl:value-of select="title"/></h2>
					<hr/>
					<!--
					<br class="space"/>
					-->
				</xsl:when>
				<xsl:otherwise>
				</xsl:otherwise>
			</xsl:choose>
			<xsl:if test="title[@qref]">
					<xsl:if test="@tools-under-title='true'">
						<hr/>
					</xsl:if>
					<xsl:for-each select="title[@qref]">
						<xsl:if test="parent::*/@addToBasket='true'">
									<xsl:variable name="panier" select="parent::*/@basket"/>
							<xsl:choose>
								<xsl:when test="$dprops/*[local-name()=parent::*/@basket]/id[.=//query[@qid=current()/@qref]/sdx:results/sdx:result/sdx:field[@name='sdxdocid']/@value]">
									<a class="RemoveFromBasket" data-basket-action="removeCurrent" data-basket-value="{//query[@qid=current()/@qref]/sdx:results/sdx:result/sdx:field[@name='sdxdocid']/@value}" title="Retirer du porte-documents" href="#">&#160;</a>
								</xsl:when>
								<xsl:otherwise>
									<a class="AddToBasket" data-basket-action="addCurrent" data-basket-value="{//query[@qid=current()/@qref]/sdx:results/sdx:result/sdx:field[@name='sdxdocid']/@value}" title="Ajouter au porte-documents" href="#">&#160;</a>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:if>
						<xsl:if test="parent::*/@sendCurrent='true'">
							<a class="sendSelected" title="Envoyer la sélection par mail" data-send-action="sendCurrent" data-send-value="{//query[@qid=current()/@qref]/sdx:results/sdx:result/sdx:field[@name='sdxdocid']/@value}" href="javascript: void(0)">&#160;</a>
						</xsl:if>
					</xsl:for-each>
					<xsl:if test="not(@tools-under-title='true')">
						<hr/>
					</xsl:if>
			</xsl:if>

                        <xsl:apply-templates select="pagination|retour-resultats"/>
                        <!-- <xsl:apply-templates mode="doc" /> -->

			<!--<xsl:for-each select=".//record | //query[@qid=current()/@qref]/sdx:results/sdx:result/record">-->
				<xsl:variable name="record" select=".//record | //query[@qid=current()/@qref]/sdx:results/sdx:result/record"/>
				<!--
				<xsl:if test="TITRE">
					<h1><xsl:value-of select="TITRE"/></h1>
				</xsl:if>
				<hr/>
				-->
				<xsl:for-each select="line">
					<!-- On teste la présence de contenus pour de ne pas générer de html superflu :
					Chaque élément présent génère 1, si le résultat final est supérieur à zero, la ligne est affichée -->
					<xsl:variable name="notempty">
						<xsl:text>0</xsl:text>
						<xsl:for-each select="bloc/entry">
							<xsl:choose>
								<xsl:when test="@type='texte'or @type='chapeau' or @type='textfield'">
									<xsl:text>1</xsl:text>
								</xsl:when>
								<xsl:when test="@type='other'">
									<xsl:text>1</xsl:text>
								</xsl:when>
								<xsl:when test="@type='pjsearch'">
										<xsl:if test=" .//query/sdx:results/sdx:result | //query[@qid=current()/@qref]/sdx:results/sdx:result">
											<xsl:text>1</xsl:text>
										</xsl:if>
								</xsl:when>
								<xsl:when test="@type='search'">
										<xsl:if test=" .//query/sdx:results/sdx:result | //query[@qid=current()/@qref]/sdx:results/sdx:result">
											<xsl:text>1</xsl:text>
										</xsl:if>
								</xsl:when>
								<xsl:when test="@type='mediaplayer'">
										<xsl:if test=" .//query/sdx:results/sdx:result | //query[@qid=current()/@qref]/sdx:results/sdx:result">
											<xsl:text>1</xsl:text>
										</xsl:if>
								</xsl:when>
								<xsl:when test="@type='mediaplayer-dash'">
										<xsl:if test=" .//query/sdx:results/sdx:result | //query[@qid=current()/@qref]/sdx:results/sdx:result">
											<xsl:text>1</xsl:text>
										</xsl:if>
								</xsl:when>
								<xsl:when test="@type='docfield'">
									<xsl:for-each select="@name">
										<xsl:if test="$record/*[local-name()=current()] and $record/*[local-name()=current()]!=''">
											<xsl:text>1</xsl:text>
										</xsl:if>
									</xsl:for-each>
								</xsl:when>
								<xsl:when test="@type='pjdocfield'">
									<xsl:for-each select="@name">
										<xsl:if test="$record/*[local-name()=current()] and $record/*[local-name()=current()]!=''">
											<xsl:text>1</xsl:text>
										</xsl:if>
									</xsl:for-each>
								</xsl:when>
								<xsl:when test="@type='urldocfield'">
									<xsl:for-each select="@name">
										<xsl:if test="$record/*[local-name()=current()] and $record/*[local-name()=current()]!=''">
											<xsl:text>1</xsl:text>
										</xsl:if>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:text>0</xsl:text>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:for-each>
					</xsl:variable>

					<xsl:if test="number($notempty)&gt;0">
						<div class="ligne">
							<xsl:variable name="cols" select="@cols"/>
							<xsl:for-each select="bloc">
								<div class="en{$cols}">
									<xsl:apply-templates/>
								</div>
							</xsl:for-each>
						</div>
						<br class="clear"/>
						<xsl:if test="position()!=last() and not(bloc/entry/@type='chapeau')">
							<hr/>
						</xsl:if>
					</xsl:if>
				</xsl:for-each>
				<br class="clear"/>
		</div>
	</xsl:template>

        <xsl:template match="module[@type='listedoc']">

                <xsl:variable name="mprops" select="." />

                <xsl:for-each select="//record | //query[@qid=current()/@qref]/sdx:results/sdx:result/record">
                        <xsl:variable name="record" select="." />
                        <div class="module doc">

                                <xsl:for-each select="$mprops/line">
                                	<xsl:choose>
                                        	<xsl:when test="$mprops/title[@qref][@field]">
                                                	<xsl:for-each select="$mprops/title[@qref][@field]">
                                                        	<h1><xsl:value-of select="//query[@qid=current()/@qref]/sdx:results/sdx:result[record = $record]/sdx:field[@name=current()/@field]/@value"/></h1>
                                                        	<xsl:if test="parent::*/@addToBasket='true'">
                                                                	<a class="AddToBasket" data-basket-action="addCurrent" data-basket-value="{//query[@qid=current()/@qref]/sdx:results/sdx:result/sdx:field[@name='sdxdocid']/@value}" title="Ajouter au porte-documents" href="#">&#160;</a>
                                                        	</xsl:if>
                                                	</xsl:for-each>
                                                	<hr/>
                                                	<br class="space"/>
                                        	</xsl:when>
                                        	<xsl:when test="$mprops/title">
                                                	<h2><xsl:value-of select="$mprops/title"/></h2>
                                                	<hr/>
                                                	<br class="space"/>
                                        	</xsl:when>
                                        	<xsl:otherwise>
                                        	</xsl:otherwise>
                                	</xsl:choose>

                                        <!-- On teste la présence de contenus pour de ne pas générer de html superflu :
                                        Chaque élément présent génère 1, si le résultat final est supérieur à zero, la ligne est affichée -->
                                        <xsl:variable name="notempty">
                                                <xsl:text>0</xsl:text>
                                                <xsl:for-each select="bloc/entry">
<!--
                                                        <xsl:value-of select="@display" />
                                                        <xsl:text>&#160;:&#160;</xsl:text>
                                                        <xsl:for-each select="@name">
                                                                <xsl:value-of select="$record/*[local-name()=current() ]" />
                                                        </xsl:for-each>
                                                        <hr />
-->
                                                        <xsl:choose>
                                                                <xsl:when test="@type='texte'or @type='chapeau' or @type='textfield'">
                                                                        <xsl:text>1</xsl:text>
                                                                </xsl:when>
                                                                <xsl:when test="@type='other'">
                                                                        <xsl:text>1</xsl:text>
                                                                </xsl:when>
                                                               <xsl:when test="@type='pjsearch'">
                                                                                <xsl:if test=" .//query/sdx:results/sdx:result | //query[@qid=current()/@qref]/sdx:results/sdx:result">
                                                                                        <xsl:text>1</xsl:text>
                                                                                </xsl:if>
                                                                </xsl:when>
                                                                <xsl:when test="@type='search'">
                                                                                <xsl:if test=" .//query/sdx:results/sdx:result | //query[@qid=current()/@qref]/sdx:results/sdx:result">
                                                                                        <xsl:text>1</xsl:text>
                                                                                </xsl:if>
                                                                </xsl:when>
                                                                <xsl:when test="@type='mediaplayer'">
                                                                                <xsl:if test=" .//query/sdx:results/sdx:result | //query[@qid=current()/@qref]/sdx:results/sdx:result">
                                                                                        <xsl:text>1</xsl:text>
                                                                                </xsl:if>
                                                                </xsl:when>
			                                                  <xsl:when test="@type='mediaplayer-dash'">
                                                                                <xsl:if test=" .//query/sdx:results/sdx:result | //query[@qid=current()/@qref]/sdx:results/sdx:result">
                                                                                        <xsl:text>1</xsl:text>
                                                                                </xsl:if>
                                                                </xsl:when>
                                                                <xsl:when test="@type='docfield'">
                                                                        <xsl:for-each select="@name">
                                                                                <xsl:if test="$record/*[local-name()=current()] and $record/*[local-name()=current()]!=''">
                                                                                        <xsl:text>1</xsl:text>
                                                                                </xsl:if>
                                                                        </xsl:for-each>
                                                                </xsl:when>
                                                                <xsl:when test="@type='pjdocfield'">
                                                                        <xsl:for-each select="@name">
                                                                                <xsl:if test="$record/*[local-name()=current()] and $record/*[local-name()=current()]!=''">
                                                                                        <xsl:text>1</xsl:text>
                                                                                </xsl:if>
                                                                        </xsl:for-each>
                                                                </xsl:when>
                                                                <xsl:otherwise>
                                                                        <xsl:text>0</xsl:text>
                                                                </xsl:otherwise>
                                                        </xsl:choose>
                                                </xsl:for-each>
                                        </xsl:variable>
                                        <xsl:if test="number($notempty)&gt;0">
                                                <div class="ligne">
                                                        <xsl:variable name="cols" select="@cols"/>
                                                        <xsl:for-each select="bloc">
                                                                <div class="en{$cols}">
                                                                        <xsl:apply-templates>
                                                                                <xsl:with-param name="record" select="$record" />
                                                                        </xsl:apply-templates>
                                                                </div>
                                                        </xsl:for-each>
                                                </div>
                                                <br class="clear"/>
                                                <xsl:if test="position()!=last() and not(bloc/entry/@type='chapeau')">
                                                        <hr/>
                                                </xsl:if>
                                        </xsl:if>

                                </xsl:for-each>
                        </div>
                </xsl:for-each>
        </xsl:template>

        <xsl:template match="pagination[parent::module/@type='doc' or parent::module/@type='listedoc']">
                <xsl:variable name="pprops" select="." />
                <xsl:variable name="id" select="//query/sdx:results/sdx:result/sdx:field[@name='sdxdocid']/@value" />
		<xsl:variable name="result" select="/sdx:document/sdx:results/sdx:result[sdx:field/@name='sdxdocid'][@value=$id]" />

		<xsl:variable name="previous" />
		<xsl:if test="/sdx:document/sdx:results/sdx:result[sdx:field[@name='sdxdocid']/@value=$id]">
		<div class="pagination-document">
			<xsl:if test="$pprops/@notext and $pprops/@notext='true'">
				<xsl:attribute name="class">pagination-document-sans-texte</xsl:attribute>
			</xsl:if>
		<xsl:for-each select="/sdx:document/sdx:results/sdx:result">
			<xsl:if test="sdx:field[@name='sdxdocid']/@value=$id">
				<div class="precedente">
				<xsl:if test="position()=1 and position()!=last()"><xsl:attribute name="style">visibility:hidden;</xsl:attribute></xsl:if>
				<span>
				<xsl:choose>
					<xsl:when test="position()=1 and position()=last()">
					</xsl:when>
					<xsl:when test="position()=1 and position()!=last()">
						<!-- No previous results -->
					</xsl:when>
					<xsl:when test="position()!=1 and position()=last()">
						<xsl:variable name="previous-id" select="preceding-sibling::*[1]/sdx:field[@name='sdxdocid']/@value" />
						<xsl:variable name="previous-number" select="preceding-sibling::*[1]/@no" />
						<xsl:variable name="uri" select="concat($pprops,'?id=',$previous-id,'&amp;requestId=',//request-info/@qid,'&amp;number=',$previous-number)" />
						<xsl:choose>
							<xsl:when test="$pprops/@notext and $pprops/@notext='true'">
								<a href="{$uri}">&#160;</a>
							</xsl:when>
							<xsl:otherwise>
								<a href="{$uri}">Document précédent</a>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:when>
					<xsl:otherwise>
						<xsl:variable name="previous-id" select="preceding-sibling::*[1]/sdx:field[@name='sdxdocid']/@value" />
						<xsl:variable name="previous-number" select="preceding-sibling::*[1]/@no" />
						<xsl:variable name="uri" select="concat($pprops,'?id=',$previous-id,'&amp;requestId=',//request-info/@qid,'&amp;number=',$previous-number)" />
						<xsl:choose>
							<xsl:when test="$pprops/@notext and $pprops/@notext='true'">
								<a href="{$uri}">&#160;</a>
							</xsl:when>
							<xsl:otherwise>
								<a href="{$uri}">Document précédent</a>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:otherwise>
				</xsl:choose>
				</span>
				</div>
			</xsl:if>
		</xsl:for-each>

		<xsl:variable name="next" />
		<xsl:for-each select="/sdx:document/sdx:results/sdx:result">
			<xsl:if test="sdx:field[@name='sdxdocid']/@value=$id">
				<div class="suivante">
				<span>
				<xsl:choose>
					<xsl:when test="position()=1 and position()=last()">
					</xsl:when>
					<xsl:when test="position()=1 and position()!=last()">
						<xsl:variable name="following-id" select="following-sibling::*[1]/sdx:field[@name='sdxdocid']/@value" />
						<xsl:variable name="following-number" select="following-sibling::*[1]/@no" />
						<xsl:variable name="uri" select="concat($pprops,'?id=',$following-id,'&amp;requestId=',//request-info/@qid,'&amp;number=',$following-number)" />
						<xsl:choose>
							<xsl:when test="$pprops/@notext and $pprops/@notext='true'">
								<a href="{$uri}">&#160;</a>
							</xsl:when>
							<xsl:otherwise>
								<a href="{$uri}">Document suivant</a>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:when>
					<xsl:when test="position()!=1 and position()=last()">
					</xsl:when>
					<xsl:otherwise>
						<xsl:variable name="following-id" select="following-sibling::*[1]/sdx:field[@name='sdxdocid']/@value" />
						<xsl:variable name="following-number" select="following-sibling::*[1]/@no" />
						<xsl:variable name="uri" select="concat($pprops,'?id=',$following-id,'&amp;requestId=',//request-info/@qid,'&amp;number=',$following-number)" />
						<xsl:choose>
							<xsl:when test="$pprops/@notext and $pprops/@notext='true'">
								<a href="{$uri}">&#160;</a>
							</xsl:when>
							<xsl:otherwise>
								<a href="{$uri}">Document suivant</a>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:otherwise>
				</xsl:choose>
				</span>
				</div>
			</xsl:if>
		</xsl:for-each>
		</div>
		</xsl:if>

        </xsl:template>

        <xsl:template match="retour-resultats[parent::module/@type='doc']">
                <xsl:variable name="rprops" select="." />

                <xsl:variable name="uri" select="concat(//request-info/@pageName,'?',//request-info/@queryString)" />
		<xsl:if test="//request-info/@qid!=''">
			<div class="retour">
			<a href="{$uri}">Retour liste résultats</a><xsl:text>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</xsl:text>
			</div>
		</xsl:if>
        </xsl:template>

	<xsl:template match="entry[parent::bloc][@type='chapeau']">
		<div class="chapeau"><xsl:copy-of select="text()|*"/></div>
		<br class="space"/>
	</xsl:template>

	<xsl:template match="entry[parent::bloc][@type='texte']">
		<p><xsl:copy-of select="text()|*"/></p>
		<br class="space"/>
	</xsl:template>

	<xsl:template match="entry[parent::bloc][@type='link']">
		<xsl:variable name="eprops" select="."/>
		<div class="champ">
			<xsl:if test="not( $eprops/@nameAfterDisplay = 'true')">
				<span class="clef"><xsl:value-of select="@display"/></span>
			</xsl:if>
			<ul class="valeur">
				<li>
					<a>
						<xsl:attribute name="href">
							<xsl:copy-of select="text()|*"/>
						</xsl:attribute>
						<xsl:copy-of select="text()|*"/>
					</a>
				</li>
			</ul>
		</div>
		<br class="space"/>
	</xsl:template>

	<xsl:template match="entry[parent::bloc][@type='textfield']">
		<xsl:variable name="eprops" select="."/>
		<div class="champ">
			<xsl:if test="not( $eprops/@nameAfterDisplay = 'true')">
				<span class="clef"><xsl:value-of select="@display"/></span>
			</xsl:if>
			<ul class="valeur">
				<li><xsl:copy-of select="text()|*"/></li>
			</ul>
		</div>
		<br class="space"/>
	</xsl:template>

	<xsl:template match="entry[parent::bloc][@type='docfield']">
		<xsl:param name="qref" select="ancestor::module[@type='doc']/@qref"/>
		<xsl:param name="record" select=".//record | //query[@qid=$qref]/sdx:results/sdx:result/record"/>
		<xsl:variable name="eprops" select="."/>
		<xsl:variable name="linkprops" select="link"/>
		<xsl:choose>
			<xsl:when test="$record/*[local-name()=current()/@name] and $record/*[local-name()=current()/@name]!=''">
				<div class="champ">
					<xsl:if test="@class">
						<xsl:attribute name="class"><xsl:value-of select="@class"/> champ</xsl:attribute>
					</xsl:if>
					<xsl:if test="not( $eprops/@nameAfterDisplay = 'true')">
						<span class="clef"><xsl:value-of select="@display"/></span>
					</xsl:if>
					<xsl:choose>
						<xsl:when test="not($linkprops)">
							<ul class="valeur">
								<xsl:if test="$eprops/@inlineValues='true'"><xsl:attribute name="class">valeurEnLigne</xsl:attribute></xsl:if>
								<xsl:for-each select="$record/*[local-name()=current()/@name]">
									<li>
									<xsl:choose>
										<xsl:when test="$eprops/@process='date'">
											<xsl:value-of select="substring(.,9,2)"/>/<xsl:value-of select="substring(.,6,2)"/>/<xsl:value-of select="substring(.,3,2)"/>
										</xsl:when>
										<xsl:when test="$eprops/@process='text'">
											<xsl:call-template name="cr2br">
                                								<xsl:with-param name="text" select="."/>
                        								</xsl:call-template>
										</xsl:when>
										<xsl:when test="$eprops/@process='text-pj'">
											<xsl:variable name="linkedText">
												<xsl:call-template name="temis-pj">
													<xsl:with-param name="text" select="."/>
												</xsl:call-template>
											</xsl:variable>
											<xsl:call-template name="cr2br">
                                								<xsl:with-param name="text" select="$linkedText"/>
                        								</xsl:call-template>
										</xsl:when>
										<xsl:otherwise>
											<xsl:value-of select="."/>
										</xsl:otherwise>
									</xsl:choose>
									<xsl:if test="$eprops/@inlineValues='true' and position()!=last()"><xsl:text> ; </xsl:text></xsl:if>
									</li>
								</xsl:for-each>
							</ul>
						</xsl:when>
						<xsl:when test="$linkprops">
							<ul class="valeur">
								<xsl:if test="$eprops/@inlineValues='true'"><xsl:attribute name="class">valeurEnLigne</xsl:attribute></xsl:if>
								<xsl:for-each select="$record/*[local-name()=current()/@name]">
									<xsl:variable name="nposition" select="position()"/>
									<li><a>
										<xsl:attribute name="href">
											<xsl:value-of select="$linkprops/@to"/>
											<xsl:text>?</xsl:text>
											<xsl:for-each select="$linkprops/param">
												<xsl:value-of select="@name"/>
												<xsl:text>=</xsl:text>
												<xsl:if test="@quote='true'">%22</xsl:if>
												<xsl:choose>	
													<xsl:when test="@value='@id'">
														<xsl:value-of select="$record/@xml:id"/>
													</xsl:when>
													<xsl:when test="@useXlink">
														<xsl:value-of select="$record/*[local-name()=current()/@value]/@xlink:href"/>
													</xsl:when>
													<xsl:when test="@useValue">
														<xsl:value-of select="@value"/>
													</xsl:when>
													<xsl:when test="$eprops/@process='date'">
															<xsl:value-of select="substring(.,9,2)"/>/<xsl:value-of select="substring(.,6,2)"/>/<xsl:value-of select="substring(.,3,2)"/>
													</xsl:when>
													<xsl:when test="$eprops/@process='text'">
														<xsl:call-template name="cr2br">
															<xsl:with-param name="text" select="."/>
														</xsl:call-template>
													</xsl:when>
													<xsl:when test="$eprops/@process='text-pj'">
														<xsl:variable name="linkedText">
															<xsl:call-template name="temis-pj">
																<xsl:with-param name="text" select="."/>
															</xsl:call-template>
														</xsl:variable>
														<xsl:call-template name="cr2br">
															<xsl:with-param name="text" select="$linkedText"/>
														</xsl:call-template>
													</xsl:when>
													<xsl:otherwise>
														<xsl:choose>
															<xsl:when test="$record/*[local-name()=current()/@value][position()=$nposition]">
																<xsl:value-of select="$record/*[local-name()=current()/@value][position()=$nposition]"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:value-of select="$record/*[local-name()=current()/@value]"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:otherwise>
												</xsl:choose>
												<xsl:if test="@quote='true'">%22</xsl:if>
												<xsl:if test="@andor">
													<xsl:text>&amp;amp;</xsl:text>
													<xsl:value-of select="concat('op_champ_',@name)"/>
													<xsl:text>=</xsl:text>
													<xsl:value-of select="@andor"/>
												</xsl:if>
												<xsl:if test="position()!=last()">
													<xsl:text>&amp;amp;</xsl:text>
												</xsl:if>
											</xsl:for-each>
										</xsl:attribute>
										<xsl:choose>
											<xsl:when test="$eprops/@nameAfterDisplay ='true'">
												<xsl:value-of select="$eprops/@display"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:value-of select="."/>
											</xsl:otherwise>
										</xsl:choose>
									</a>
									<xsl:if test="$eprops/@inlineValues='true' and position()!=last()"><xsl:text> ; </xsl:text></xsl:if>
									</li>
								</xsl:for-each>
							</ul>
						</xsl:when>
						<xsl:otherwise>
						</xsl:otherwise>
					</xsl:choose>
				</div>
			</xsl:when>
			<xsl:otherwise>
				&#160;
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>

	<xsl:template match="entry[parent::bloc][@type='docfield-addprop']">
		<xsl:param name="qref" select="ancestor::module[@type='doc']/@qref"/>
		<xsl:param name="record" select=".//record | //query[@qid=$qref]/sdx:results/sdx:result/record"/>
		<xsl:variable name="eprops" select="."/>
		<xsl:variable name="linkprops" select="link"/>
		<xsl:choose>
			<xsl:when test="$record/*[local-name()=current()/@name]">
				<div class="champ">
					<xsl:if test="not( $eprops/@nameAfterDisplay = 'true')">
						<span class="clef"><xsl:value-of select="@display"/></span>
					</xsl:if>
					<xsl:choose>
						<xsl:when test="not($linkprops)">
							<ul class="valeur">
								<xsl:if test="$eprops/@inlineValues='true'"><xsl:attribute name="class">valeurEnLigne</xsl:attribute></xsl:if>
								<xsl:for-each select="$record/*[local-name()=current()/@name][@xlink:title=current()/@addprop-title]">
									<li>
									<xsl:choose>
										<xsl:when test="$eprops/@process='date'">
											<xsl:value-of select="substring(.,9,2)"/>/<xsl:value-of select="substring(.,6,2)"/>/<xsl:value-of select="substring(.,3,2)"/>
										</xsl:when>
										<xsl:when test="$eprops/@process='text'">
											<xsl:call-template name="cr2br">
                                								<xsl:with-param name="text" select="."/>
                        								</xsl:call-template>
										</xsl:when>
										<xsl:otherwise>
											<xsl:value-of select="."/>
										</xsl:otherwise>
									</xsl:choose>
									<xsl:if test="$eprops/@inlineValues='true' and position()!=last()"><xsl:text> ; </xsl:text></xsl:if>
									</li>
								</xsl:for-each>
							</ul>
						</xsl:when>
						<xsl:when test="$linkprops">
							<ul class="valeur">
								<xsl:if test="$eprops/@inlineValues='true'"><xsl:attribute name="class">valeurEnLigne</xsl:attribute></xsl:if>
								<xsl:for-each select="$record/*[local-name()=current()/@name][@xlink:title=current()/@addprop-title]">
									<xsl:variable name="nposition" select="position()"/>
									<li><a>
										<xsl:attribute name="href">
											<xsl:value-of select="$linkprops/@to"/>
											<xsl:text>?</xsl:text>
											<xsl:for-each select="$linkprops/param">
												<xsl:value-of select="@name"/>
												<xsl:text>=</xsl:text>
												<xsl:if test="@quote='true'">%22</xsl:if>
												<xsl:choose>	
													<xsl:when test="@value='@id'">
														<xsl:value-of select="$record/@xml:id"/>
													</xsl:when>
													<xsl:when test="@useXlink">
														<xsl:value-of select="$record/*[local-name()=current()/@value]/@xlink:href"/>
													</xsl:when>
													<xsl:when test="@useValue">
														<xsl:value-of select="@value"/>
													</xsl:when>
													<xsl:when test="$eprops/@process='date'">
															<xsl:value-of select="substring(.,9,2)"/>/<xsl:value-of select="substring(.,6,2)"/>/<xsl:value-of select="substring(.,3,2)"/>
													</xsl:when>
													<xsl:when test="$eprops/@process='text'">
														<xsl:call-template name="cr2br">
															<xsl:with-param name="text" select="."/>
														</xsl:call-template>
													</xsl:when>
													<xsl:otherwise>
														<xsl:choose>
															<xsl:when test="$record/*[local-name()=current()/@value][position()=$nposition]">
																<xsl:value-of select="$record/*[local-name()=current()/@value][position()=$nposition]"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:value-of select="$record/*[local-name()=current()/@value]"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:otherwise>
												</xsl:choose>
												<xsl:if test="@quote='true'">%22</xsl:if>
												<xsl:if test="@andor">
													<xsl:text>&amp;amp;</xsl:text>
													<xsl:value-of select="concat('op_champ_',@name)"/>
													<xsl:text>=</xsl:text>
													<xsl:value-of select="@andor"/>
												</xsl:if>
												<xsl:if test="position()!=last()">
													<xsl:text>&amp;amp;</xsl:text>
												</xsl:if>
											</xsl:for-each>
										</xsl:attribute>
										<xsl:choose>
											<xsl:when test="$eprops/@nameAfterDisplay ='true'">
												<xsl:value-of select="$eprops/@display"/>
											</xsl:when>
											<xsl:otherwise>
												<xsl:value-of select="."/>
											</xsl:otherwise>
										</xsl:choose>
									</a>
									<xsl:if test="$eprops/@inlineValues='true' and position()!=last()"><xsl:text> ; </xsl:text></xsl:if>
									</li>
								</xsl:for-each>
							</ul>
						</xsl:when>
						<xsl:otherwise>
						</xsl:otherwise>
					</xsl:choose>
				</div>
				<br class="space"/>
			</xsl:when>
			<xsl:otherwise>
				&#160;
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>

	<xsl:template match="entry[parent::bloc][@type='pjdocfield']">
		<xsl:param name="qref" select="ancestor::module[@type='doc']/@qref"/>
		<xsl:param name="record" select=".//record | //query[@qid=$qref]/sdx:results/sdx:result/record"/>
		<xsl:variable name="eprops" select="."/>
		<xsl:choose>
			<xsl:when test="$record/*[local-name()=current()/@name] and $record/*[local-name()=current()/@name] !=''">
				<xsl:variable name="rid"><xsl:value-of select="$record/@xml:id"/></xsl:variable>
				<div class="champ">
					<xsl:if test="@class">
						<xsl:attribute name="class"><xsl:value-of select="@class"/> champ</xsl:attribute>
					</xsl:if>
					<xsl:if test="not( @nameAfterDisplay = 'true' )">
						<span class="clef"><xsl:value-of select="@display"/></span>
					</xsl:if>
					<ul class="valeur">
						<xsl:choose>
							<xsl:when test="@nameAfterDisplay = 'true'">
								<xsl:for-each select="$record/*[local-name()=current()/@name]">
									<xsl:variable name="docPath">
										<xsl:call-template name="composePath">
											<xsl:with-param name="name" select="." />
											<xsl:with-param name="rid" select="$rid" />
										</xsl:call-template>
									</xsl:variable>
									<li>
										<xsl:call-template  name="displayPj">
											<xsl:with-param name="display" select="$eprops/@display"/>
											<xsl:with-param name="filename" select="."/>
											<xsl:with-param name="docpath" select="$docPath"/>
											<xsl:with-param name="props" select="$eprops"/>
										</xsl:call-template>
									</li>
								</xsl:for-each>
							</xsl:when>
							<xsl:otherwise>
								<xsl:for-each select="$record/*[local-name()=current()/@name]">
									<xsl:variable name="docPath">
										<xsl:call-template name="composePath">
											<xsl:with-param name="name" select="." />
											<xsl:with-param name="rid" select="$rid" />
										</xsl:call-template>
									</xsl:variable>
									<li>
										<xsl:call-template  name="displayPj">
											<xsl:with-param name="display" select="."/>
											<xsl:with-param name="filename" select="."/>
											<xsl:with-param name="docpath" select="$docPath"/>
											<xsl:with-param name="props" select="$eprops"/>
										</xsl:call-template>
									</li>
								</xsl:for-each>
							</xsl:otherwise>
						</xsl:choose>
					</ul>
				</div>
			</xsl:when>
			<xsl:otherwise>
				&#160;
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>

	<xsl:template match="entry[parent::bloc][@type='urldocfield']">
		<xsl:param name="qref" select="ancestor::module[@type='doc']/@qref"/>
		<xsl:param name="record" select=".//record | //query[@qid=$qref]/sdx:results/sdx:result/record"/>
		<xsl:variable name="eprops" select="."/>
		<xsl:choose>
			<xsl:when test="$record/*[local-name()=current()/@name] and $record/*[local-name()=current()/@name] !=''">
				<xsl:variable name="rid"><xsl:value-of select="$record/@xml:id"/></xsl:variable>
				<div class="champ">
					<xsl:if test="not( @nameAfterDisplay = 'true' )">
						<span class="clef"><xsl:value-of select="@display"/></span>
					</xsl:if>
					<ul class="valeur">
						<xsl:for-each select="$record/*[local-name()=current()/@name]">
							<li>
								<a class="lien_externe" href="{.}"><xsl:value-of select="."/></a>
							</li>
						</xsl:for-each>
					</ul>
				</div>
				<br class="space"/>
			</xsl:when>
			<xsl:otherwise>
				&#160;
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>

	<xsl:template match="entry[parent::bloc][@type='search']">
		<xsl:variable name="linkprops" select="link"/>
		<xsl:variable name="eprops" select="."/>
		<xsl:variable name="sdxresults" select=".//sdx:results | //query[@qid=current()/@qref]/sdx:results"/>
		<xsl:apply-templates/>
		<xsl:if test="$sdxresults and $sdxresults/sdx:result/sdx:field[@name=current()/@field]">
			<xsl:variable name="field" select="@field"/>
			<div class="champ">
				<xsl:if test="@class">
					<xsl:attribute name="class"><xsl:value-of select="@class"/> champ</xsl:attribute>
				</xsl:if>
				<span class="clef"><xsl:value-of select="@display"/></span>
				<ul class="valeur">
					<xsl:for-each select="$sdxresults/sdx:result">
						<xsl:variable name="rposition" select="position()"/>
						<!--
						<xsl:copy-of select="."/>
						-->
						<xsl:for-each select="sdx:field[@name=$field]">
							<xsl:variable name="fprops" select="."/>
							<xsl:variable name="sdxresult" select="ancestor::sdx:result"/>
							<xsl:variable name="nposition" select="position()"/>
							<xsl:variable name="fposition" select="position()"/>
							<li>
								<xsl:choose>
									<xsl:when test="$linkprops">
										<!--
										<a href="{$linkprops/@to}?id={../../sdx:field[@name=$eprops/@linktofield]}">
										-->
										<a>
											<xsl:attribute name="href">
												<xsl:value-of select="$linkprops/@to"/>
												<xsl:text>?</xsl:text>
												<xsl:for-each select="$linkprops/param">
													<xsl:value-of select="@name"/>
													<xsl:text>=</xsl:text>
													<xsl:if test="@quote and @quote='true'">%22</xsl:if>
													<xsl:choose>	
														<xsl:when test="@value='@id'">
															<xsl:value-of select="$sdxresult/sdx:field[@name='sdxdocid']/@escapedValue"/>
														</xsl:when>
														<xsl:when test="@useValue">
															<xsl:value-of select="@value"/>
														</xsl:when>
														<xsl:when test="$eprops/@process='date'">
																<xsl:variable name="rawDate" select="$sdxresult/sdx:field[@name=current()/@value][position()=$fposition]/@escapedValue"/>
																<xsl:value-of select="substring($rawDate,9,2)"/>/<xsl:value-of select="substring($rawDate,6,2)"/>/<xsl:value-of select="substring($rawDate,3,2)"/>
														</xsl:when>
														<xsl:when test="$eprops/@process='text'">
															<xsl:call-template name="cr2br">
																<xsl:with-param name="text" select="$sdxresult/sdx:field[@name=current()/@value][position()=$fposition]/@escapedValue"/>
															</xsl:call-template>
														</xsl:when>
														<xsl:otherwise>
															<xsl:value-of select="$sdxresult/sdx:field[@name=current()/@value][position()=$fposition]/@escapedValue"/>
														</xsl:otherwise>
													</xsl:choose>
													<xsl:if test="@quote and @quote='true'">%22</xsl:if>
													<xsl:if test="@andor">
														<xsl:text>&amp;amp;</xsl:text>
														<xsl:value-of select="concat('op_champ_',@name)"/>
														<xsl:text>=</xsl:text>
														<xsl:value-of select="@andor"/>
													</xsl:if>
													<xsl:if test="position()!=last()">
														<xsl:text>&amp;amp;</xsl:text>
													</xsl:if>
												</xsl:for-each>
											</xsl:attribute>
											<xsl:value-of select="$fprops/@value"/>
										</a>
									</xsl:when>
									<xsl:when test="$eprops/@value">
										<xsl:value-of select="$eprops/@value"/>
										<xsl:if test="$eprops/@suffix">
											<xsl:value-of select="$eprops/@suffix"/>
										</xsl:if>
									</xsl:when>
									<xsl:when test="$eprops/@process='link'">
										<a>
											<xsl:attribute name="href">
												<xsl:value-of select="$fprops/@value"/>
											</xsl:attribute>
											<xsl:value-of select="$fprops/@value"/>
										</a>
									</xsl:when>
									<xsl:otherwise>
										<xsl:value-of select="$fprops/@value"/>
										<xsl:if test="$eprops/@suffix">
											<xsl:value-of select="$eprops/@suffix"/>
										</xsl:if>
									</xsl:otherwise>
								</xsl:choose>
							</li>
						</xsl:for-each>
					</xsl:for-each>
				</ul>
			</div>
		</xsl:if>
		<xsl:apply-templates/>
	</xsl:template>

	<xsl:template match="entry[parent::bloc][@type='pjsearch']">
		<xsl:variable name="eprops" select="."/>
		<div class="champ">
			<xsl:if test="not( @nameAfterDisplay ='true')">
				<span class="clef"><xsl:value-of select="@display"/></span>
			</xsl:if>
			<ul class="valeur">
				<xsl:variable name="lqref" select="@qref"/>
				<xsl:for-each select=".//sdx:result/sdx:field[@name=current()/@field]/@value | //query[@qid=current()/@qref]/sdx:results/sdx:result/sdx:field[@name=current()/@field]/@value ">
					<xsl:variable name="rid"><xsl:value-of select="ancestor::sdx:result/sdx:field[@name='id']/@value"/></xsl:variable>
                                                <xsl:variable name="docPath">
                                                        <xsl:call-template name="composePath">
                                                                <xsl:with-param name="name" select="." />
                                                                <xsl:with-param name="rid" select="$rid" />
                                                        </xsl:call-template>
                                                </xsl:variable>
 
					<li>
						<xsl:choose>
							<xsl:when test="$eprops/@nameAfterDisplay='true'">
								<xsl:call-template  name="displayPj">
									<xsl:with-param name="display" select="$eprops/@display"/>
									<xsl:with-param name="filename" select="."/>
									<xsl:with-param name="docpath" select="$docPath"/>
									<xsl:with-param name="props" select="$eprops"/>
								</xsl:call-template>
							</xsl:when>
							<xsl:otherwise>
								<xsl:call-template  name="displayPj">
									<xsl:with-param name="display" select="."/>
									<xsl:with-param name="filename" select="."/>
									<xsl:with-param name="docpath" select="$docPath"/>
									<xsl:with-param name="props" select="$eprops"/>
								</xsl:call-template>
							</xsl:otherwise>
						</xsl:choose>
					</li>
				</xsl:for-each>
			</ul>
		</div>
	</xsl:template>

	<xsl:template match="entry[parent::bloc][@type='mediaplayer']">
		<xsl:variable name="eprops" select="."/>
		<xsl:variable name="linkprops" select="link"/>
		<xsl:variable name="sdxresult" select=".//sdx:result | //query[@qid=current()/@qref]/sdx:results/sdx:result"/>

		<script type="text/javascript" src="js/flowplayer/pandoc-player.js">&#160;</script>

		<div 
			 href="#"
			 id="player">&#160;Lecteur</div> 


		<div class="champ">
			<xsl:if test="@display!=''">
				<span class="clef"><xsl:value-of select="@display"/></span>
			</xsl:if>
			<ul id="playlist" class="playlist">
				<xsl:variable name="playlistLength" select="count($sdxresult/sdx:field[@name=current()/@field])"/>
				<xsl:for-each select="$sdxresult/sdx:field[@name=current()/@field]/@value">
					<xsl:variable name="eid"><xsl:value-of select="ancestor::sdx:result/sdx:field[@name='id']/@value"/></xsl:variable>
					<xsl:variable name="eduree"><xsl:value-of select="ancestor::sdx:result/sdx:field[@name='duree']/@value"/></xsl:variable>
					<xsl:variable name="docPath">
						<xsl:text>mp3/</xsl:text>
						<xsl:value-of select="substring-before($eid, '-')"/><xsl:text>/</xsl:text>
						<xsl:value-of select="substring($eid, string-length(substring-before($eid, '-'))+2, 4)"/><xsl:text>/</xsl:text>
						<xsl:value-of select="$eid"/><xsl:text>/</xsl:text>
						<xsl:value-of select="."/>
					</xsl:variable>
					<!--
					<li data-pandoc-stream="rto/Manifestation-0000041/04_00_35_21092012_AmenagtDecentralisationSynthese_1.mp3"><a href="#">rto/Manifestation-0000041/04_00_35_21092012_AmenagtDecentralisationSynthese_1.mp3</a></li>
					-->
					<xsl:variable name="streamPath">
						<xsl:text>mp3:</xsl:text>
						<xsl:value-of select="/sdx:document/@appbypath"/><xsl:text>/</xsl:text>
						<xsl:value-of select="substring-before($eid, '-')"/><xsl:text>/</xsl:text>
						<xsl:value-of select="substring($eid, string-length(substring-before($eid, '-'))+2, 4)"/><xsl:text>/</xsl:text>
						<xsl:value-of select="$eid"/><xsl:text>/</xsl:text>
						<xsl:value-of select="substring-before(.,'.mp3')"/>
					</xsl:variable>
					<xsl:variable xmlns:streamingClientHelper="java:fr.gouv.equipement.documentation.pandoc.streaming.ClientHelper" name="securedStreamPath">
						<xsl:value-of select="streamingClientHelper:getSecuredPath($streamPath)" />
					</xsl:variable>
					<xsl:choose>
						<xsl:when test="$eprops/@playlistItemName and number($playlistLength)=1">
							<li data-pandoc-stream="{$securedStreamPath}"><a href="#"><xsl:value-of select="concat($eprops/@playlistItemName,' (',$eduree,')')"/></a></li>
						</xsl:when>
						<xsl:when test="$eprops/@playlistItemName">
							<li data-pandoc-stream="{$securedStreamPath}"><a href="#"><xsl:value-of select="concat($eprops/@playlistItemName,' ',position(),' (',$eduree,')')"/></a></li>
						</xsl:when>
						<xsl:when test="$eprops/@playlistItemNameDocField">
							<xsl:variable name="currentSdxResult" select="current()/parent::*/parent::sdx:result"/>
							<xsl:variable name="itemName" select="$currentSdxResult/sdx:field[@name=$eprops/@playlistItemNameDocField]/@value"/>
							<li data-pandoc-stream="{$securedStreamPath}"><a href="#"><xsl:value-of select="concat($itemName,' ',' (',$eduree,')')"/></a></li>
						</xsl:when>
						<xsl:otherwise>
							<li data-pandoc-stream="{$securedStreamPath}"><a href="#"><xsl:value-of select="concat('Partie ',position(),' (',$eduree,')')"/></a></li>
						</xsl:otherwise>
					</xsl:choose>
				</xsl:for-each>
			</ul>
		</div>
	</xsl:template>

	<xsl:template match="entry[parent::bloc][@type='mediaplayer-dash']">
		<xsl:variable name="eprops" select="."/>
		<xsl:variable name="linkprops" select="link"/>
		<xsl:variable name="sdxresult" select=".//sdx:result | //query[@qid=current()/@qref]/sdx:results/sdx:result"/>

		<script type="text/javascript" src="js/dash/pandoc-player.js">&#160;</script>

		<audio  id="player" controls="controls"  style="width:100%">&#160;Lecteur</audio>

		<script type="text/javascript" src="js/dash/dash.all.min.js">&#160;</script>

		<div class="champ">
			<xsl:if test="@display!=''">
				<span class="clef"><xsl:value-of select="@display"/></span>
			</xsl:if>
			<ul id="playlist" class="playlist">
				<xsl:variable name="playlistLength" select="count($sdxresult/sdx:field[@name=current()/@field])"/>
				<xsl:for-each select="$sdxresult/sdx:field[@name=current()/@field]/@value">
					<xsl:variable name="eid"><xsl:value-of select="ancestor::sdx:result/sdx:field[@name='id']/@value"/></xsl:variable>
					<xsl:variable name="eduree"><xsl:value-of select="ancestor::sdx:result/sdx:field[@name='duree']/@value"/></xsl:variable>
					<!--
					<li data-pandoc-stream="rto/Manifestation-0000041/04_00_35_21092012_AmenagtDecentralisationSynthese_1.mp3"><a href="#">rto/Manifestation-0000041/04_00_35_21092012_AmenagtDecentralisationSynthese_1.mp3</a></li>
					-->
					<xsl:variable name="streamPath">
						<xsl:text>/media/</xsl:text>
						<!-- <xsl:value-of select="/sdx:document/@appbypath"/><xsl:text>/</xsl:text> -->
						<xsl:value-of select="substring-before($eid, '-')"/><xsl:text>/</xsl:text>
						<xsl:value-of select="substring($eid, string-length(substring-before($eid, '-'))+2, 4)"/><xsl:text>/</xsl:text>
						<xsl:value-of select="$eid"/><xsl:text>/</xsl:text>
						<xsl:value-of select="substring-before(.,'.mp3')"/>
						<xsl:text>.mpd</xsl:text>
					</xsl:variable>
					<xsl:variable name="filePath">
						<xsl:text>/media/</xsl:text>
						<!-- <xsl:value-of select="/sdx:document/@appbypath"/><xsl:text>/</xsl:text> -->
						<xsl:value-of select="substring-before($eid, '-')"/><xsl:text>/</xsl:text>
						<xsl:value-of select="substring($eid, string-length(substring-before($eid, '-'))+2, 4)"/><xsl:text>/</xsl:text>
						<xsl:value-of select="$eid"/><xsl:text>/</xsl:text>
						<!-- <xsl:value-of select="substring-before(.,'.mp3')"/> -->
						<xsl:value-of select="'media-audio-und-mp4a'"/>
						<xsl:text>.mp4</xsl:text>
					</xsl:variable>
					<!-- <xsl:variable xmlns:streamingDashClientHelper="java:fr.gouv.equipement.documentation.pandoc.streaming.DashClientHelper" name="securedStreamPath">
						<xsl:value-of select="streamingDashClientHelper:getSecuredPath('/dl/','/media/bbb_all_ears/bbb_all_ears.mpd')" />
					</xsl:variable> -->
					<xsl:variable xmlns:streamingDashClientHelper="java:fr.gouv.equipement.documentation.pandoc.streaming.DashClientHelper" name="securedStreamPath">
						<xsl:value-of select="streamingDashClientHelper:getSecuredPath('/dl/',$streamPath)" />
					</xsl:variable>
					<xsl:variable xmlns:streamingDashClientHelper="java:fr.gouv.equipement.documentation.pandoc.streaming.DashClientHelper" name="securedFilePath">
						<xsl:value-of select="streamingDashClientHelper:getSecuredPath('/dl/',$filePath)" />
					</xsl:variable>
					<xsl:choose>
						<xsl:when test="$eprops/@playlistItemName and number($playlistLength)=1">
							<li data-pandoc-stream="{$securedStreamPath}" data-pandoc-file="{$securedFilePath}"><a href="#"><xsl:value-of select="concat($eprops/@playlistItemName,' (',$eduree,')')"/></a></li>
						</xsl:when>
						<xsl:when test="$eprops/@playlistItemName">
							<li data-pandoc-stream="{$securedStreamPath}" data-pandoc-file="{$securedFilePath}"><a href="#"><xsl:value-of select="concat($eprops/@playlistItemName,' ',position(),' (',$eduree,')')"/></a></li>
						</xsl:when>
						<xsl:when test="$eprops/@playlistItemNameDocField">
							<xsl:variable name="currentSdxResult" select="current()/parent::*/parent::sdx:result"/>
							<xsl:variable name="itemName" select="$currentSdxResult/sdx:field[@name=$eprops/@playlistItemNameDocField]/@value"/>
							<li data-pandoc-stream="{$securedStreamPath}" data-pandoc-file="{$securedFilePath}"><a href="#"><xsl:value-of select="concat($itemName,' ',' (',$eduree,')')"/></a></li>
						</xsl:when>
						<xsl:otherwise>
							<li data-pandoc-stream="{$securedStreamPath}" data-pandoc-file="{$securedFilePath}"><a href="#"><xsl:value-of select="concat('Partie ',position(),' (',$eduree,')')"/></a></li>
						</xsl:otherwise>
					</xsl:choose>
				</xsl:for-each>
			</ul>
		</div>
	</xsl:template>

		<!-- Module panier -->

	<xsl:template match="module[@type='panier']">
		<div class="module results">
			<!-- Contrôle des résultats -->
			<xsl:variable name="gsdxresults"><xsl:value-of select=".//sdx:results | //query[@qid=current()/results/@qref]/sdx:results"/></xsl:variable>
			<xsl:variable name="sdxrnum"><xsl:value-of select=".//sdx:results/@pages | //query[@qid=current()/results/@qref]/sdx:results/@pages"/></xsl:variable>
			<!-- Affichage du titre -->
			<xsl:choose>
				<xsl:when test="title[@qref][@field]">
					<xsl:for-each select="title[@qref][@field]">
						<h1><xsl:value-of select="//query[@qid=current()/@qref]/sdx:results/sdx:result/sdx:field[@name=current()/@field]/@value"/></h1>
					</xsl:for-each>
					<hr/>
					<br class="space"/>
				</xsl:when>
				<xsl:when test="title">
					<h2><xsl:value-of select="title"/></h2>
					<hr/>
					<br class="space"/>
				</xsl:when>
				<xsl:otherwise>
				</xsl:otherwise>
			</xsl:choose>
			<xsl:choose>
				<xsl:when test="not( $gsdxresults ) or $gsdxresults='' or ( $sdxrnum = 0)">
					<xsl:text>Aucun document</xsl:text>
				</xsl:when>
				<xsl:otherwise>
					<form action="panier.html" method="POST">
						<xsl:apply-templates/>
					</form>
				</xsl:otherwise>
			</xsl:choose>
		</div>
	</xsl:template>

		<!-- Module historique -->

	<xsl:template match="module[@type='historique']">
		<div class="module historique">
			<!-- Contrôle des résultats -->
			<xsl:variable name="hprops" select="."/>
			<xsl:variable name="hist" select="//sdx:historic/sdx:search[@base=$hprops/@base]"/>
			<xsl:variable name="hsnum" select="count($hist)"/>
			<!-- Affichage du titre -->
			<xsl:choose>
				<xsl:when test="title[@qref][@field]">
					<xsl:for-each select="title[@qref][@field]">
						<h1><xsl:value-of select="//query[@qid=current()/@qref]/sdx:results/sdx:result/sdx:field[@name=current()/@field]/@value"/></h1>
					</xsl:for-each>
					<hr/>
					<br class="space"/>
				</xsl:when>
				<xsl:when test="title">
					<h2><xsl:value-of select="title"/></h2>
					<hr/>
					<br class="space"/>
				</xsl:when>
				<xsl:otherwise>
				</xsl:otherwise>
			</xsl:choose>
			<xsl:choose>
				<xsl:when test="not( $hsnum ) or $hsnum=0">
					<xsl:text>Aucune recherche</xsl:text>
				</xsl:when>
				<xsl:otherwise>
					<form action="historique.html" method="POST">
						<ul>
						<xsl:for-each select="$hist">
							<li><a href="{$hprops/@linkto}?{@query}">
								<xsl:value-of select="substring(@date,9,2)"/>/<xsl:value-of select="substring(@date,6,2)"/>/<xsl:value-of select="substring(@date,1,4)"/><xsl:text> </xsl:text><xsl:value-of select="substring(@date,12,8)"/>
								<xsl:text> : </xsl:text><xsl:value-of select="@lucene"/>
								<xsl:text> - </xsl:text><xsl:value-of select="@nb"/><xsl:text> résultat(s) </xsl:text>
							</a></li>
						</xsl:for-each>
						</ul>
					</form>
				</xsl:otherwise>
			</xsl:choose>
			<br class="clear"/>
			<br class="space"/>
		</div>
		<br class="clear"/>
		<br class="space"/>
	</xsl:template>

	<xsl:template match="module[@type='vide-historique']">
		<xsl:if test="//sdx:historic/sdx:search">
		<div class="flush-history">
			<form action="historique.html" method="POST">
				<input type="hidden" name="action" value="vider"/>
				<input title="Vider l'historique" type="submit" value="Vider l'historique"/>
			</form>
		</div>
		</xsl:if>
	</xsl:template>

	<!-- ============================   widget definition  ============================== -->

	<xsl:template match="widget[@type='entry']">
			<xsl:if test="entry">
				<div>
					<xsl:choose>
						<xsl:when test="@color='true'"><xsl:attribute name="class">colorwidget</xsl:attribute></xsl:when>
						<xsl:otherwise><xsl:attribute name="class">widget</xsl:attribute></xsl:otherwise>
					</xsl:choose>
					<h2><xsl:value-of select="title"/></h2>
					<ul>
					<xsl:for-each select="entry">
						<li>
							<a href="{.}"><xsl:value-of select="@name"/></a>
						</li>
					</xsl:for-each>
					</ul>
				</div>
			</xsl:if>
	</xsl:template>

	<xsl:template match="widget[@type='sdxdocfields']">
			<xsl:if test=".//sdx:field[@name=current()/@field]/@value | //query[@qid=current()/@qref]/sdx:results/sdx:result/sdx:field[@name=current()/@field]/@value">
				<div>
					<xsl:choose>
						<xsl:when test="@color='true'"><xsl:attribute name="class">colorwidget</xsl:attribute></xsl:when>
						<xsl:otherwise><xsl:attribute name="class">widget</xsl:attribute></xsl:otherwise>
					</xsl:choose>
					<h2><xsl:value-of select="title"/></h2>
					<ul>
					<xsl:variable name="wprops" select="."/>
					<xsl:for-each select=".//sdx:field[@name=current()/@field] | //query[@qid=current()/@qref]/sdx:results/sdx:result/sdx:field[@name=current()/@field]">
						<xsl:sort/>
						<li>
							<xsl:choose>
								<xsl:when test="$wprops/@linkto">
									<a href="{$wprops/@linkto}?{$wprops/@linktoname}=%22{@escapedValue}%22"><xsl:value-of select="@value"/></a>
								</xsl:when>
								<xsl:otherwise>
									<xsl:value-of select="@value"/>
								</xsl:otherwise>
							</xsl:choose>
						</li>
					</xsl:for-each>
					</ul>
				</div>
			</xsl:if>
	</xsl:template>

	<xsl:template match="widget[@type='docfields'][@subtype!='image']">
			<xsl:if test=".//record/*[local-name()=current()/@field] | //query[@qid=current()/@qref]/sdx:results/sdx:result/record/*[local-name()=current()/@field]">
				<div>
					<xsl:choose>
						<xsl:when test="@color='true'"><xsl:attribute name="class">colorwidget</xsl:attribute></xsl:when>
						<xsl:otherwise><xsl:attribute name="class">widget</xsl:attribute></xsl:otherwise>
					</xsl:choose>
					<h2><xsl:value-of select="title"/></h2>
					<ul>
					<xsl:variable name="wprops" select="."/>
					<xsl:choose>
						<xsl:when test="$wprops/@subtype='link'">
							<xsl:for-each select=".//record/*[local-name()=current()/@field] | //query[@qid=current()/@qref]/sdx:results/sdx:result/record/*[local-name()=current()/@field]">
								<li>
									<a href="{.}"><xsl:value-of select="."/></a>
								</li>
							</xsl:for-each>
						</xsl:when>
						<xsl:when test="$wprops/@subtype='hreflink'">
							<xsl:for-each select=".//record/*[local-name()=current()/@field] | //query[@qid=current()/@qref]/sdx:results/sdx:result/record/*[local-name()=current()/@field]">
								<li>
									<a href="{$wprops/@linkto}?{$wprops/@linktoname}={@xlink:href}"><xsl:value-of select="."/></a>
								</li>
							</xsl:for-each>
						</xsl:when>
						<xsl:otherwise>
							<xsl:for-each select=".//record/*[local-name()=current()/@field] | //query[@qid=current()/@qref]/sdx:results/sdx:result/record/*[local-name()=current()/@field]">
								<li>
									<xsl:value-of select="."/>
								</li>
							</xsl:for-each>
						</xsl:otherwise>
					</xsl:choose>
					</ul>
				</div>
			</xsl:if>
	</xsl:template>

	<xsl:template match="widget[@type='docfields'][@subtype='image']">
			<xsl:if test=".//record/*[local-name()=current()/@field] | //query[@qid=current()/@qref]/sdx:results/sdx:result/record/*[local-name()=current()/@field]">
				<div>
					<xsl:choose>
						<xsl:when test="@color='true'"><xsl:attribute name="class">galerie colorwidget</xsl:attribute></xsl:when>
						<xsl:otherwise><xsl:attribute name="class">galerie widget</xsl:attribute></xsl:otherwise>
					</xsl:choose>
					<xsl:if test="title">
						<h2><xsl:value-of select="title"/></h2>
					</xsl:if>
					<xsl:variable name="wprops" select="."/>
					<xsl:for-each select=".//record/*[local-name()=current()/@field] | //query[@qid=current()/@qref]/sdx:results/sdx:result/record/*[local-name()=current()/@field]">
						<xsl:variable name="rid"><xsl:value-of select="ancestor::record/@xml:id"/></xsl:variable>
						<xsl:variable name="docPath">
							<xsl:call-template name="composePath">
								<xsl:with-param name="name" select="." />
								<xsl:with-param name="rid" select="$rid" />
								<xsl:with-param name="prefixPath" select="'thumbnails'" />
								<xsl:with-param name="filePrefix" select="'widget-'"/>
							</xsl:call-template>
						</xsl:variable>
						<img alt="illustration" src="{$docPath}"/>

					</xsl:for-each>
				</div>
			</xsl:if>
	</xsl:template>

	<xsl:template match="widget[@type='pjdocfields']">
			<xsl:if test=".//record/*[local-name()=current()/@field] | //query[@qid=current()/@qref]/sdx:results/sdx:result/record/*[local-name()=current()/@field]">
				<div>
					<xsl:choose>
						<xsl:when test="@color='true'"><xsl:attribute name="class">colorwidget</xsl:attribute></xsl:when>
						<xsl:otherwise><xsl:attribute name="class">widget</xsl:attribute></xsl:otherwise>
					</xsl:choose>
					<h2><xsl:value-of select="title"/></h2>
					<ul>
					<xsl:variable name="wprops" select="."/>
					<xsl:for-each select=".//record/*[local-name()=current()/@field] | //query[@qid=current()/@qref]/sdx:results/sdx:result/record/*[local-name()=current()/@field]">
						<xsl:variable name="rid"><xsl:value-of select="ancestor::record/@xml:id"/></xsl:variable>
						<xsl:variable name="docPath">
                                                        <xsl:call-template name="composePath">
                                                                <xsl:with-param name="name" select="." />
                                                                <xsl:with-param name="rid" select="$rid" />
                                                        </xsl:call-template>
						</xsl:variable>

						<li>
							<xsl:call-template  name="displayPj">
								<xsl:with-param name="display" select="."/>
								<xsl:with-param name="filename" select="."/>
								<xsl:with-param name="docpath" select="$docPath"/>
								<xsl:with-param name="props" select="$wprops"/>
							</xsl:call-template>
							<xsl:if test="$wprops/@suffix != ''"><xsl:value-of select="$wprops/@suffix"/></xsl:if>
							<xsl:if test="$wprops/@suffix-field != ''"><xsl:value-of select="parent::*/*[local-name()=$wprops/@suffix-field]"/></xsl:if>
						</li>
					</xsl:for-each>
					</ul>
				</div>
			</xsl:if>
	</xsl:template>

	<xsl:template match="widget[@type='sdxpjdocfields']">
		<xsl:if test=".//sdx:field[@name=current()/@field]/@value | //query[@qid=current()/@qref]/sdx:results/sdx:result/sdx:field[@name=current()/@field]/@value">
			<div>
				<xsl:choose>
					<xsl:when test="@color='true'"><xsl:attribute name="class">colorwidget</xsl:attribute></xsl:when>
					<xsl:otherwise><xsl:attribute name="class">widget</xsl:attribute></xsl:otherwise>
				</xsl:choose>
				<h2><xsl:value-of select="title"/></h2>
				<ul>
				<xsl:variable name="wprops" select="."/>
				<xsl:for-each select=".//sdx:field[@name=current()/@field]/@value | //query[@qid=current()/@qref]/sdx:results/sdx:result/sdx:field[@name=current()/@field]/@value">
					<xsl:variable name="rid"><xsl:value-of select="ancestor::sdx:result/sdx:field[@name='sdxdocid']/@value"/></xsl:variable>
                                        <xsl:variable name="docPath">
                                                <xsl:call-template name="composePath">
                                                        <xsl:with-param name="name" select="." />
                                                        <xsl:with-param name="rid" select="$rid" />
                                                </xsl:call-template>
                                        </xsl:variable>
					<xsl:variable name="fieldDisplay" select="ancestor::sdx:result/sdx:field[@name=$wprops/@displayAfterField]/@value"/>

					<li>
						<xsl:choose>
							<xsl:when test="$wprops/@displayAfterField !='' and $fieldDisplay != ''">
								<xsl:call-template  name="displayPj">
									<xsl:with-param name="display" select="$fieldDisplay"/>
									<xsl:with-param name="filename" select="."/>
									<xsl:with-param name="docpath" select="$docPath"/>
									<xsl:with-param name="props" select="$wprops"/>
								</xsl:call-template>
								<xsl:if test="$wprops/@suffix != ''"><xsl:value-of select="$wprops/@suffix"/></xsl:if>
								<xsl:if test="$wprops/@suffix-field != ''"><xsl:value-of select="parent::*/*[local-name()=$wprops/@suffix-field]"/></xsl:if>
							</xsl:when>
							<xsl:otherwise>
								<xsl:call-template  name="displayPj">
									<xsl:with-param name="display" select="."/>
									<xsl:with-param name="filename" select="."/>
									<xsl:with-param name="docpath" select="$docPath"/>
									<xsl:with-param name="props" select="$wprops"/>
								</xsl:call-template>
								<xsl:if test="$wprops/@suffix != ''"><xsl:value-of select="$wprops/@suffix"/></xsl:if>
								<xsl:if test="$wprops/@suffix-field != ''"><xsl:value-of select="parent::*/*[local-name()=$wprops/@suffix-field]"/></xsl:if>
							</xsl:otherwise>
						</xsl:choose>
					</li>
				</xsl:for-each>
				</ul>
			</div>
		</xsl:if>
	</xsl:template>

	<!-- ======================================    Context definition    =====================================  -->

	<xsl:template match="context[@type='requête'][@subtype='url']">
		<xsl:variable name="cprops" select="."/>
		<xsl:if test="//sdx:parameters/sdx:parameter">
		<div class="context requete">
			<xsl:if test="title">
				<span class="requetetitle"><xsl:value-of select="title"/></span>
			</xsl:if>
			<xsl:if test="$cprops/@search-form">
				<xsl:choose>
					<xsl:when test="$cprops/@search-form-anchor">
						<span class="modifier"><a href="{$cprops/@search-form}?modifier=oui&amp;{$queryParameters}#{$cprops/@search-form-anchor}">modifier</a></span>
					</xsl:when>
					<xsl:otherwise>
						<span class="modifier"><a href="{$cprops/@search-form}?modifier=oui&amp;{$queryParameters}">modifier</a></span>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:if>
			<xsl:for-each select="$cprops/param">
				<xsl:if test="//sdx:parameters/sdx:parameter[@name=current()/@name][@htmlEscapedValue != '']">
					<h2>
						<xsl:if test="@display!=''">
							<xsl:value-of select="@display"/>
						</xsl:if>
						<xsl:if test="@display!='' and not(@displayOnly='true')">
							<xsl:text> : </xsl:text>
						</xsl:if>
						<xsl:if test="not(@displayOnly='true')">
							<xsl:choose>
								<xsl:when test="@process='annee'">
									<xsl:choose>
										<xsl:when test="//sdx:parameters/sdx:parameter[@name=concat('numop_champ_',current()/@name)]/@value='gteq'">
											<xsl:text>&gt;= </xsl:text>
										</xsl:when>
										<xsl:when test="//sdx:parameters/sdx:parameter[@name=concat('numop_champ_',current()/@name)]/@value='lteq'">
											<xsl:text>&lt;= </xsl:text>
										</xsl:when>	
										<xsl:otherwise>
											<!-- Do nothing, égal à l'année affichée -->
										</xsl:otherwise>
									</xsl:choose>
									<xsl:for-each select="//sdx:parameters/sdx:parameter[@name=current()/@name]">
										<span><xsl:value-of select="@htmlEscapedValue"/> </span>
									</xsl:for-each>
								</xsl:when>
								<xsl:when test="@process='date'">
									<xsl:for-each select="//sdx:parameters/sdx:parameter[@name=current()/@name]">
										<span><xsl:value-of select="substring(@htmlEscapedValue,9,2)"/>/<xsl:value-of select="substring(@htmlEscapedValue,6,2)"/>/<xsl:value-of select="substring(@value,1,4)"/> </span>
									</xsl:for-each>
								</xsl:when>
								<xsl:when test="@process='hidden'">
									<xsl:attribute name="style">display:none</xsl:attribute>
									<xsl:for-each select="//sdx:parameters/sdx:parameter[@name=current()/@name]">
										<span><xsl:value-of select="@htmlEscapedValue"/> </span>
									</xsl:for-each>
								</xsl:when>
								<xsl:otherwise>
									<xsl:for-each select="//sdx:parameters/sdx:parameter[@name=current()/@name]">
										<span><xsl:value-of select="@htmlEscapedValue"/> </span>
									</xsl:for-each>
								</xsl:otherwise>
							</xsl:choose>
						</xsl:if>
					</h2>
				</xsl:if>
			</xsl:for-each>
		</div>
		</xsl:if>
	</xsl:template>

	<!--
	<xsl:template match="context[@type='modifier'][@subtype='url']">
		<xsl:variable name="cprops" select="."/>
		<xsl:if test="//sdx:parameters/sdx:parameter">
		<div class="context">
			<xsl:if test="title">
			<span class="requetetitle"><xsl:value-of select="title"/></span>
			</xsl:if>
			test
		</div>
		</xsl:if>
	</xsl:template>
	-->

	<!-- ======================================    Fonctions (templates nommés )    =====================================  -->

	<xsl:template name="getFileExt">
		<xsl:param name="filename"/>
		<xsl:value-of select="translate( substring($filename, string-length($filename)-2, 3 ), 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz')"/>
	</xsl:template>

	<xsl:template name="addIconClass">
		<xsl:param name="filename"/>

		<xsl:variable name="ext">
			<xsl:value-of select="translate( substring($filename, string-length($filename)-2, 3 ), 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz')"/>
		</xsl:variable>
		<xsl:choose>
			<xsl:when test="$ext='pdf'">
				<xsl:attribute name="class">pdflink</xsl:attribute>
			</xsl:when>
			<xsl:otherwise>
			</xsl:otherwise>
		</xsl:choose>

	</xsl:template>

	<xsl:template name="displayPj">
		<xsl:param name="display"/>
		<xsl:param name="filename"/>
		<xsl:param name="docpath"/>
		<xsl:param name="props"/>

		<xsl:variable name="ext">
			<xsl:call-template name="getFileExtension">
				<xsl:with-param name="filename" select="$filename"/>
			</xsl:call-template>
		</xsl:variable>
		<a class="pj" target="_blank" href="{$docpath}">
		<xsl:choose>
			<xsl:when test="$site-props//information/xiti/@id and $site-props//information/xiti/@id != ''">
					<xsl:attribute name="onclick">
						return xt_click(this,'C','','<xsl:value-of select="$filename"/>','T')
					</xsl:attribute>
			</xsl:when>
			<xsl:otherwise>
			</xsl:otherwise>
		</xsl:choose>
		<xsl:if test="($props and $props/@filetype='img')">
			<xsl:choose>
				<xsl:when test="$ext='pub'">
					<xsl:attribute name="class">pj pj_epub</xsl:attribute>
				</xsl:when>
				<xsl:when test="$ext='pdf'">
					<xsl:attribute name="class">pj pj_pdf</xsl:attribute>
				</xsl:when>
				<xsl:when test="$ext='xls'">
					<xsl:attribute name="class">pj pj_xls</xsl:attribute>
				</xsl:when>
				<xsl:when test="$ext='doc'">
					<xsl:attribute name="class">pj pj_doc</xsl:attribute>
				</xsl:when>
				<xsl:when test="$ext='zip'">
					<xsl:attribute name="class">pj pj_zip</xsl:attribute>
				</xsl:when>
				<xsl:otherwise>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:if>
			<xsl:value-of select="$display"/>
			<xsl:if test="($props and not($props/@filetype)) or (($props and $props/@filetype!='false') and ($props and $props/@filetype!='img'))">
				<xsl:choose>
					<xsl:when test="$ext='pub'">
						<span class="docformat">( EPUB )</span>
					</xsl:when>
					<xsl:when test="$ext='pdf'">
						<span class="docformat">( PDF )</span>
					</xsl:when>
					<xsl:when test="$ext='xls'">
						<span class="docformat">( XLS )</span>
					</xsl:when>
					<xsl:when test="$ext='doc'">
						<span class="docformat">( DOC )</span>
					</xsl:when>
					<xsl:when test="$ext='zip'">
						<span class="docformat">( ZIP )</span>
					</xsl:when>
					<xsl:otherwise>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:if>
		</a>
	</xsl:template>

	<xsl:template name="getFileExtension">
		<xsl:param name="filename"/>
		<xsl:value-of select="translate( substring($filename, string-length($filename)-2, 3 ), 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz')"/>
	</xsl:template>

	<!-- traitement des retours à la ligne remplacé par un balise br -->
	<xsl:template name="cr2br">
	  <xsl:param name="text" select="."/>

	  <xsl:choose>

	    <xsl:when test="contains($text, '&#x0A;')">


	<!--
	    <xsl:value-of select="substring-before($text, '&#x0A;')" disable-output-escaping="yes"/>
	-->
	    <xsl:value-of select="substring-before($text, '&#x0A;')"/>

	      <br/>
	      <xsl:call-template name="cr2br">
		<xsl:with-param name="text" select="substring-after($text,'&#x0A;')"/>
	      </xsl:call-template>
	    </xsl:when>
	    <xsl:otherwise>
		<!--
	      <xsl:value-of select="$text" disable-output-escaping="yes"/>
		-->
	      <xsl:value-of select="$text"/>
	    </xsl:otherwise>
	  </xsl:choose>

	</xsl:template>


	<xsl:template name="temis-pj">
	  <xsl:param name="text" select="."/>

	  <xsl:choose>

	    <xsl:when test="contains($text, 'href')">

	<!--
	    <xsl:value-of select="substring-before($text, '&#x0A;')" disable-output-escaping="yes"/>
	-->
		<xsl:value-of select="substring-before($text, 'href')"/>
		<xsl:text>href="</xsl:text>
			<xsl:variable name="doc">
				<xsl:value-of select="substring-before(substring-after($text, 'href=&quot;'),'&quot;')"/>
			</xsl:variable>
			<xsl:text>pj/</xsl:text>
			<xsl:value-of select="substring-before($doc,'_')"/>
			<xsl:text>/</xsl:text>
			<xsl:value-of select="$doc"/>
			<xsl:text>"</xsl:text>

		<xsl:call-template name="temis-pj">
			<xsl:with-param name="text" select="substring-after($text,concat($doc,'&quot;'))"/>
		</xsl:call-template>
	    </xsl:when>
	    <xsl:otherwise>
		<!--
	      <xsl:value-of select="$text" disable-output-escaping="yes"/>
		-->
	      <xsl:value-of select="$text"/>
	    </xsl:otherwise>
	  </xsl:choose>

	</xsl:template>

	<xsl:template name="no-pj">
	  <xsl:param name="text" select="."/>

	  <xsl:choose>

	    <xsl:when test="contains($text, '&lt;')">

	<!--
	    <xsl:value-of select="substring-before($text, '&#x0A;')" disable-output-escaping="yes"/>
	-->
		<xsl:value-of select="substring-before($text, '&lt;')"/>
		<xsl:call-template name="no-pj">
			<xsl:with-param name="text" select="substring-after($text,'&gt;')"/>
		</xsl:call-template>
	    </xsl:when>
	    <xsl:otherwise>
		<!--
	      <xsl:value-of select="$text" disable-output-escaping="yes"/>
		-->
	      <xsl:value-of select="$text"/>
	    </xsl:otherwise>
	  </xsl:choose>

	</xsl:template>


	<xsl:template name="composePath">
		<xsl:param name="name" />
		<xsl:param name="rid" />
		<xsl:param name="prefixPath">docs</xsl:param>
		<xsl:param name="filePrefix"></xsl:param>

		<xsl:value-of select="$prefixPath"/><xsl:text>/</xsl:text>
		<xsl:value-of select="substring-before($rid, '-')"/><xsl:text>/</xsl:text>
		<xsl:value-of select="substring($rid, string-length(substring-before($rid, '-'))+2, 4)"/><xsl:text>/</xsl:text>
		<xsl:value-of select="$rid"/><xsl:text>/</xsl:text>
		<xsl:value-of select="$filePrefix"/>
		<xsl:choose>
			<xsl:when test="$prefixPath = 'thumbnails'">
				<!-- Les thumbnails générés sont toujours des .jpg -->
				<xsl:choose>
					<xsl:when test="starts-with( substring($name,string-length($name)-2), '.' )">
						<xsl:value-of select="substring($name,0,string-length($name)-2)"/>
						<xsl:text>.jpg</xsl:text>
					</xsl:when>
					<xsl:when test="starts-with( substring($name,string-length($name)-3), '.' )">
						<xsl:value-of select="substring($name,0,string-length($name)-3)"/>
						<xsl:choose>
							<xsl:when test="substring-after($name,'.') = 'png'">
								<xsl:text>.png</xsl:text>
							</xsl:when>
							<xsl:otherwise>
								<xsl:text>.jpg</xsl:text>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:when>
					<xsl:when test="starts-with( substring($name,string-length($name)-4), '.' )">
						<xsl:value-of select="substring($name,0,string-length($name)-4)"/>
						<xsl:text>.jpg</xsl:text>
					</xsl:when>
					<xsl:otherwise>
						<xsl:value-of select="$name"/>
					</xsl:otherwise>
				</xsl:choose>
			</xsl:when>
			<xsl:otherwise>
				<xsl:value-of select="$name"/>
			</xsl:otherwise>
		</xsl:choose>

	</xsl:template>

	
	<!-- Copie un contenu html produit dans une xsp -->
	<xsl:template match="*" mode="htmlcopy">
		<xsl:element name="{local-name(.)}">
			<xsl:copy-of select="@*"/>
			<xsl:apply-templates mode="htmlcopy"/>
		</xsl:element>
	</xsl:template>



	<!-- ======================================    Catch former rules    =====================================  -->


	<xsl:template match="text()">
	</xsl:template>

	<xsl:template name="sdx:resultsindex-head" match="sdx:results">
	</xsl:template>





















	<xsl:template match="ghost">
		<div class="content_center">
			<div class="ghost">&#160;</div>
		</div>
	</xsl:template>
	
	<xsl:template name="pageheader">
		<xsl:param name="for_print"/>
		<head>
			<title>
 				<xsl:if test="//title">
 					<xsl:value-of select="concat($titre_page,' - ',//title)"/>
 				</xsl:if>
 				<xsl:if test="not(//title)">
 					<xsl:value-of select="concat($titre_page,' - ',//sdx:field[@name= 'titre']/@value)"/>
 				</xsl:if>
			</title>
			<!-- Feuilles de style -->
			<link rel="stylesheet" type="text/css" href="gdac.css" media="screen" title="Normal" />
			<!--
			<xsl:choose>
				<xsl:when test="$for_print = 'true'">
					<link rel="stylesheet" type="text/css" href="pandoc_print.css" media="screen" title="Normal" />
				</xsl:when>
				<xsl:otherwise>
					<link rel="stylesheet" type="text/css" href="pandoc.css" media="screen" title="Normal" />
				</xsl:otherwise>
			</xsl:choose>
			<link rel="stylesheet" type="text/css" href="pandoc_print.css" media="print" title="Normal" />
			-->
			<!-- Scripts inclus -->
			<!--
			<script type="text/javascript" src="pandoc.js"><xsl:text>&#160;</xsl:text></script>
			<script type="text/javascript" src="jquery/jquery-1.2.6.pack.js"><xsl:text>&#160;</xsl:text></script>
			<script type="text/javascript" src="jquery/jquery.bgiframe.pack.js"><xsl:text>&#160;</xsl:text></script>
			<script type="text/javascript" src="jquery/jquery.dimensions.pack.js"><xsl:text>&#160;</xsl:text></script>
			<script type="text/javascript" src="jquery/jquery.autocomplete.pack.js"><xsl:text>&#160;</xsl:text></script>
			<link rel="stylesheet" type="text/css" href="autocomplete.css" media="screen" title="Normal" />
			<script type="text/javascript" src="common.js"><xsl:text>&#160;</xsl:text></script>
			-->
			<!-- Stantdard metas -->
			<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
			<meta http-equiv="Content-Language" content="{$lang}" />
			<meta name="robots" content=" index, follow "/>
			<meta name="description" content=""/>
			<meta name="keywords" content=""/>
			<!-- meta Google Pandoc -->
			<meta name="verify-v1" content="uO8ysBsc6OOE3K9E6Kted3zwVOR3VsqslZ+/VLI7qDw=" />
			<!-- Dublin Core metas -->
			<meta name="DC.Title" scheme="RFC3066" content="{$titre_page}"/>
			<meta name="DC.Creator" scheme="RFC3066" content="Ministère de la Transition écologique et solidaire"/>
			<meta name="DC.Creator" scheme="RFC3066" content="Centre d'Etudes Techniques de l'Equipement Nord-Picardie"/>
			<meta name="DC.Creator" scheme="RFC3066" content="Point d'appui national documentaire"/>
			<meta name="DC.Publisher" scheme="RFC3066" content="Ministère de la Transition écologique et solidaire"/>
			<meta name="DC.Format" scheme="RFC3066" content="text/html"/>
			<meta name="DC.Language"  scheme="RFC3066" content="{$lang}" />
			<link rel='alternate' type='application/rss+xml' title="Dernières nouveautés" href='allnews.rss' />

			<xsl:apply-templates mode="head"/>
		</head>	
	</xsl:template>

	<xsl:template match="intro">
	</xsl:template>


	<!-- barre de navigation -->
	<xsl:template match="bar"/>
		
	<!-- barre de navigation charté CDU-URBAMET  -->
	<xsl:template name="barCDU">	
		<xsl:call-template name="show_logo" />
<!--
		<ul id="menu">
			<li>
				<a id="m_recherche" href="{$menu_url}recherche.xsp" accesskey="4">
					<xsl:choose>
						<xsl:when test="$lang='en'">Search</xsl:when>
						<xsl:when test="$lang='es'">Búsqueda</xsl:when>
						<xsl:otherwise>Recherche</xsl:otherwise>
					</xsl:choose>					
				</a> 
			</li>
			<li>
				<a id="m_historique" href="{$menu_url}historique.xsp">
					<xsl:choose>
						<xsl:when test="$lang='en'">History</xsl:when>
						<xsl:when test="$lang='es'">Historial</xsl:when>
						<xsl:otherwise>Historique</xsl:otherwise>
					</xsl:choose>					
				</a> 
			</li>
			<li>
				<a id="m_panier" href="{$menu_url}panier.xsp">
					<xsl:choose>
						<xsl:when test="$lang='en'">Selection basket</xsl:when>
						<xsl:when test="$lang='es'">Cesta de selección</xsl:when>
						<xsl:otherwise>Panier de sélection</xsl:otherwise>
					</xsl:choose>					
				</a> 
			</li>
			<li>
				<a id="m_voiraussi" href="{$menu_url}voiraussi.xsp">
					<xsl:choose>
						<xsl:when test="$lang='en'">See also</xsl:when>
						<xsl:when test="$lang='es'">Véase igualmente</xsl:when>
						<xsl:otherwise>Voir aussi</xsl:otherwise>
					</xsl:choose>
				</a> 
			</li>
			<li>
				<a id="m_nouveautes" href="{$menu_url}nouveautes.xsp">
					<xsl:choose>
						<xsl:when test="$lang='en'">Nouveautés</xsl:when>
						<xsl:when test="$lang='es'">Nouveautés</xsl:when>
						<xsl:otherwise>Nouveautés</xsl:otherwise>
					</xsl:choose>
				</a> 
			</li>
		</ul>
		<hr class="onmenu" />
-->
	</xsl:template>
    

	<!-- barre de recherche -->
	<xsl:template name="English">
		<li>
			<a id="en" lang="en">
				<xsl:attribute name="href">
					<xsl:text>?lang=en</xsl:text>
					<xsl:for-each select="//sdx:parameter[@type = 'get']">
						<xsl:if test="@name != 'lang'">
							<xsl:text>&#038;</xsl:text>
							<xsl:value-of select="@name" />
							<xsl:text>=</xsl:text>
							<xsl:value-of select="@escapedValue" />
						</xsl:if>
					</xsl:for-each>
				</xsl:attribute>
				<xsl:text>English</xsl:text>
			</a>
		</li>
	</xsl:template>

	<xsl:template name="Spanish">    
		<li>
			<a id="es" lang="es">
				<xsl:attribute name="href">
					<xsl:text>?lang=es</xsl:text>
					<xsl:for-each select="//sdx:parameter[@type = 'get']">
						<xsl:if test="@name != 'lang'">
							<xsl:text>&#038;</xsl:text>
							<xsl:value-of select="@name" />
							<xsl:text>=</xsl:text>
							<xsl:value-of select="@escapedValue" />
						</xsl:if>
					</xsl:for-each>
				</xsl:attribute>
				<xsl:text>Español</xsl:text>
			</a>
		</li>
	</xsl:template>

	<xsl:template name="French">    
		<li>
			<a id="fr" lang="fr">
				<xsl:attribute name="href">
					<xsl:text>?lang=fr</xsl:text>
					<xsl:for-each select="//sdx:parameter[@type = 'get']">
						<xsl:if test="@name != 'lang'">
							<xsl:text>&#038;</xsl:text>
							<xsl:value-of select="@name" />
							<xsl:text>=</xsl:text>
							<xsl:value-of select="@escapedValue" />
						</xsl:if>
					</xsl:for-each>
				</xsl:attribute>
				<xsl:text>Français</xsl:text>
			</a>
		</li>
	</xsl:template>

	<!-- fonction utilisée pour remplacer un apostrophe par 2 apostrophes pour le passage de paramètre en javascript -->
	<xsl:template name="escape-apos">
		<xsl:param name="string" />
		<!-- create an $apos variable to make it easier to refer to -->
		<xsl:variable name="apos"><xsl:text>'</xsl:text></xsl:variable>
		<xsl:choose>
			<!-- if the string contains an apostrophe... -->
			<xsl:when test="contains($string, $apos)">
				<!-- ... give the value before the apostrophe... -->
				<xsl:value-of select="substring-before($string, $apos)" />
				<!-- ... the escaped apostrophe ... -->
				<xsl:text>\'</xsl:text>
				<!-- ... and the result of applying the template to the
				string after the apostrophe -->
				<xsl:call-template name="escape-apos">
				<xsl:with-param name="string" select="substring-after($string, $apos)" />
				</xsl:call-template>
			</xsl:when>
			<!-- otherwise... -->
			<xsl:otherwise>
				<!-- ... just give the value of the string -->
				<xsl:value-of select="$string" />
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>

	<xsl:template name="onload">
		<!-- par défaut, rien, destiné à être surchargée par l'xsl qui importe -->
	</xsl:template>
    
	<xsl:template match="node()" mode="head" priority="-2">
		<!-- par défaut, le mode head ne sort rien -->
	</xsl:template>
    
    
	<xsl:template match="*[@show='replace'][@actuate='onload']" mode="head">
		<meta http-equiv="refresh" content="{@time};URL={@href}"/>
	</xsl:template>
    
	<xsl:template match="*[@show='replace'][@actuate='onload']">
		<div class="alert">
			<p>Si vous n'étiez pas redirigés dans
				<xsl:value-of select="@time"/>
				<xsl:if test="not(@time)">quelques</xsl:if>
				secondes cliquez <a class="but" href="{@href}">ICI</a>
			</p>
		</div>
	</xsl:template>
    
	<!-- display user -->
	<xsl:template match="sdx:user">
		<!-- Limitation de l'interface pour la page d'upload-->
		<xsl:if test="not(//upload) and not(//delete) ">
			<xsl:if test="not(@anonymous)">	
				<div class="logged">
				<hr class="onmenu"/>
					<xsl:if test="@firstname">
						<xsl:value-of select="@firstname"/>
						<xsl:text>&#160;</xsl:text>
						<xsl:value-of select="@lastname"/>
						<xsl:text>&#160;</xsl:text>
					</xsl:if>
					(<xsl:value-of select="@id"/>), 
					vous êtes identifié comme
					<xsl:choose>
						<xsl:when test="@anonymous"/>
						<xsl:when test="@superuser='true'">superutilisateur.</xsl:when>
						<xsl:when test="@admin='true'">administrateur de l'application<xsl:value-of select="@app"/></xsl:when>
						<xsl:when test="@app">
							utilisateur de l'application
							<xsl:value-of select="@app"/>.
						</xsl:when>
					</xsl:choose>
					<xsl:if test="@admin='true'">
						<br/>
						<a href="structure/admin/admin">Voir la page d'administration</a>.
					</xsl:if>
					<xsl:if test="@admin='true'">
						<br/>
						<xsl:call-template name="views"/>
					</xsl:if>
				</div>
			</xsl:if>
		</xsl:if>
	</xsl:template>
    
	<!-- views -->
	<xsl:template name="views">
		<div>
			Les étapes de cette page: 
			1) <strong><a title="XSP - la source XSP de cette page" href="{/sdx:document/@uri}2xsp{/sdx:document/@query}">XSP</a></strong>
			2) <strong><a title="Java - code Java/XSP résultant de la transformation SDX" href="{/sdx:document/@uri}2java{/sdx:document/@query}">Java</a></strong>
			3) <strong><a title="SDX - exécution SDX du code Java/XSP" href="{/sdx:document/@uri}2sdx{/sdx:document/@query}">SDX</a></strong>
			4) <strong><a title="XSL - transformation de présentation, avec imports et inclusions" href="{/sdx:document/@uri}2xsl{/sdx:document/@query}">XSL</a></strong>
			5) <strong><a title="HTML - le code après transformation de présentation" href="{/sdx:document/@uri}2htm{/sdx:document/@query}">HTM</a></strong>
		</div>
	</xsl:template>
	
	<xsl:template match="sdx:field"/>
	
	<xsl:template match="title"/>
	
	<xsl:template match="notadmin">
		<div class="alert">Vous n'êtes pas autorisé à administrer cette application.</div>
	</xsl:template>

 	<!-- Ouverture popup 
 	Cette possibilité doit être couplée avec un lien standard, de façon à ce que les pages 
	puissent s'afficher même si javascript est désactivé chez l'utilisateur.
 	-->
 	<xsl:template name="popup-window">
 		<!-- URL à ouvrir (this.href si non défini) -->
 		<xsl:param name="popurl" select="this.href" />
 		<!-- Nom de la fenêtre -->
 		<xsl:param name="popnom" />
 		<!-- Hauteur de la fenêtre en pixels -->
 		<xsl:param name="popheight" />
 		<!-- Largeur de la fenêtre en pixels -->
 		<xsl:param name="popwidth" />
 		<!-- Position de la fenêtre en pixels par rapport au haut de l'écran-->
 		<xsl:param name="poptop" />
 		<!-- Position de la fenêtre en pixels par rapport au bord gauche de l'écran -->
 		<xsl:param name="popleft" />
		<!-- La barre d'outils doit-elle être affichée ? (yes/no) -->
 		<xsl:param name="poptoolbar" />
 		<!-- La barre d'adresse doit-elle être affichée ? (yes/no) -->
 		<xsl:param name="poplocation" />
 		<!-- La barre de menus doit-elle être affichée ? (yes/no) -->
 		<xsl:param name="popmenubar" />
 		<!-- La taille de la fenêtre doit-elle être modifiable par l'internaute ? (yes/no) -->
 		<!--
 		La possibilité d'empêcher le redimensionnement de la fenêtre peut être problématique
 		en termes d'accessibilités sur certains naviguateurs ou systèmes d'exploitation. 
 		Elle ne sera donc pas activée ici.
 		<xsl:param name="resizable" />-->
 		<!-- Les barres de défilement doivent-elles être affichées ? (yes/no) -->
 		<!--
 		La possibilité de supprimer les barres de défilement comporte un fort risque
 		de rendre la page non accessible. Cette fonctionnalité ne sera donc pas utilisée ici.
 		<xsl:param name="scrollbars" />-->
 		<!-- La barre de statuts doit-elle être affichée ? (yes/no) -->
 		<xsl:param name="popstatus" />
		<!-- Texte du lien (pour le title -->
		<xsl:param name="link_text" />

		<xsl:variable name="event">
 			<xsl:text>window.open(</xsl:text>
 			<!-- Traitement de l'url -->
 			<xsl:if test="$popurl">
 				<xsl:text>'</xsl:text>
 				<xsl:value-of select="$popurl" />
 				<xsl:text>'</xsl:text>
 			</xsl:if>
 			<xsl:if test="not($popurl)">this.href</xsl:if>
 			<!-- Traitement du nom -->
 			<xsl:if test="$popnom">
 				<xsl:text>, '</xsl:text>
 				<xsl:value-of select="$popnom" />
 				<xsl:text>'</xsl:text>
 			</xsl:if>
 			<!-- Traitement des options -->
 			<xsl:if test="$popheight or $popwidth or $poptop or $popleft or $poptoolbar = 'yes' or $poptoolbar = 'no' or $poplocation = 'yes' or $poplocation = 'no' or $popmenubar = 'yes' or $popmenubar = 'no' or $popstatus = 'yes' or $popstatus = 'no'">
 				<xsl:text>, '</xsl:text>
 				<xsl:if test="$popheight">
 					<xsl:text>height=</xsl:text>
 					<xsl:value-of select="$popheight" />
 					<xsl:text>, </xsl:text>
 				</xsl:if>
 				<xsl:if test="$popwidth">
 					<xsl:text>width=</xsl:text>
 					<xsl:value-of select="$popwidth" />
 					<xsl:text>, </xsl:text>
 				</xsl:if>
 				<xsl:if test="$poptop">
 					<xsl:text>top=</xsl:text>
 					<xsl:value-of select="$poptop" />
 					<xsl:text>, </xsl:text>
 				</xsl:if>
 				<xsl:if test="$popleft">
 					<xsl:text>width=</xsl:text>
 					<xsl:value-of select="$popwidth" />
 					<xsl:text>, </xsl:text>
 				</xsl:if>
 				<xsl:if test="$poptoolbar = 'yes' or $poptoolbar = 'no'">
 					<xsl:text>toolbar=</xsl:text>
 					<xsl:value-of select="$poptoolbar" />
 					<xsl:text>, </xsl:text>
 				</xsl:if>
 				<xsl:if test="$poplocation = 'yes' or $poplocation = 'no'">
 					<xsl:text>location=</xsl:text>
 					<xsl:value-of select="$poplocation" />
 					<xsl:text>, </xsl:text>
 				</xsl:if>
 				<xsl:if test="$popmenubar = 'yes' or $popmenubar = 'no'">
 					<xsl:text>menubar=</xsl:text>
 					<xsl:value-of select="$popmenubar" />
 					<xsl:text>, </xsl:text>
 				</xsl:if>
 				<xsl:if test="$popstatus = 'yes' or $popstatus = 'no'">
 					<xsl:text>status=</xsl:text>
 					<xsl:value-of select="$popstatus" />
 					<xsl:text>, </xsl:text>
 				</xsl:if>
 				<xsl:text>'</xsl:text>
 			</xsl:if>
 			<!-- Fin de la fonction window.open -->
 			<xsl:text>);</xsl:text>
 			<!-- On annule l'effet du lien par défaut -->
 			<xsl:text> return false;</xsl:text>
		</xsl:variable>
		
		<xsl:attribute name="title">
			<xsl:value-of select="$link_text" />
			<xsl:value-of select="$space" />
			<xsl:choose>
				<xsl:when test="$lang= 'en'">(in a new window)</xsl:when>
				<xsl:when test="$lang = 'es'">(en una nueva ventana)</xsl:when>
				<xsl:otherwise>(dans une nouvelle fenêtre)</xsl:otherwise>
			</xsl:choose>
		</xsl:attribute>
		
		<xsl:attribute name="onclick">
			<xsl:value-of select="$event" />
 		</xsl:attribute>
		<!-- recommandée par le W3C :
		http://www.la-grange.net/w3c/WAI-WEBCONTENT-TECHS/#device-ind-events
		l'utilisation de "onkeypress" empêche la navigation au clavier.
		Dans le sens où l'activation du lien ne dépend pas de l'utilisation de la souris,
		cette directive ne sera pas suivie.
		-->
		<!--<xsl:attribute name="onkeypress">
			<xsl:value-of select="$event" />
		</xsl:attribute>-->
 	</xsl:template>

	<xsl:template name="show_logo">
		<xsl:param name="logoclass" />
		<div>
			<xsl:choose>
				<xsl:when test="$logoclass">
					<xsl:attribute name="class">
						<xsl:value-of select="$logoclass" />
					</xsl:attribute>
				</xsl:when>
				<xsl:otherwise>
					<xsl:attribute name="id">logo</xsl:attribute>
				</xsl:otherwise>
			</xsl:choose>
			<a href="http://www.urbamet.com" accesskey="1">
				<xsl:call-template name="popup-window">
					<xsl:with-param name="link_text">Urbamet</xsl:with-param>
				</xsl:call-template>
				<img width="74"  height="61" src="icons/logoUrbamet.gif" alt="Urbamet" />
			</a> 	
		</div>
	</xsl:template>
	
	<xsl:template name="no_results">
		<h1>
			<xsl:choose>
				<xsl:when test="$lang = 'en'">No result found.</xsl:when>
				<xsl:when test="$lang = 'es'">No hay respuesta</xsl:when>
				<xsl:otherwise>Aucun résultat.</xsl:otherwise>
			</xsl:choose>
		</h1>
		<p>
			<xsl:choose>
				<xsl:when test="$lang = 'en'">Complete at least one of 
					<a href="recherche.xsp">the search fields</a>.</xsl:when>
				<xsl:when test="$lang = 'es'">Complete al menos uno de los  
					<a href="recherche.xsp">campos de búsqueda </a>.</xsl:when>
				<xsl:otherwise>Vous devez renseigner au moins un des 
					champs du <a href="recherche.xsp">formulaire de recherche</a>.</xsl:otherwise>
			</xsl:choose>
		</p>
	</xsl:template>
	
	<xsl:template name="no_entry_selected">
		<xsl:param name="a_href">
			<xsl:text>results.xsp</xsl:text>
			<xsl:value-of select="//sdx:parameter[@name = 'result_query']/@value" />
		</xsl:param>
		<h1>
			<xsl:choose>
				<xsl:when test="$lang = 'en'">No reference selected</xsl:when>
				<xsl:when test="$lang = 'es'">No referencia seleccionada</xsl:when>
				<xsl:otherwise>Aucune notice sélectionnée</xsl:otherwise>
			</xsl:choose>
		</h1>
		<p>
			<xsl:choose>
				<xsl:when test="$lang = 'en'">You must select at least one reference in  
					<a href="{$a_href}">the search results</a>.</xsl:when>
				<xsl:when test="$lang = 'es'">Debe seleccionar al menos una referencia dentro de 
					<a href="{$a_href}">los resultados de búsqueda</a>.</xsl:when>
				<xsl:otherwise>Assurez-vous d'avoir sélectionné au moins une notice dans 
					<a href="{$a_href}">les résultats de votre recherche</a>.</xsl:otherwise>
			</xsl:choose>
		</p>	
	</xsl:template>

	<xsl:template name="lien_rebond">
		<xsl:param name="descripteur" />
		<xsl:param name="valeur" />
		<xsl:param name="overlib_caption"/>
		<xsl:param name="overlib_url"/>
		<xsl:param name="overlib_def"/>
		<xsl:param name="hilite">false</xsl:param>
	
		<a rel="nofollow">
			<xsl:attribute name="href">
				<xsl:text>results.xsp?q=</xsl:text>
				<xsl:if test="$descripteur">
					<xsl:text>+</xsl:text>
					<xsl:value-of select="$descripteur" />
					<xsl:text>:|</xsl:text>
					<xsl:value-of select="$valeur" />
					<xsl:text>|&amp;log=true</xsl:text>
				</xsl:if>
				<xsl:if test="not($descripteur)">
					<xsl:value-of select="$valeur" />
				</xsl:if>
			</xsl:attribute>
			<xsl:if test="$overlib_caption != ''">
				<xsl:attribute name="onmouseover">
					<xsl:text>return overlib('</xsl:text>
					<xsl:text>&lt;p&gt;</xsl:text>
					<xsl:call-template name="escape-apos">
						<xsl:with-param name="string"><xsl:value-of select="$overlib_def"/></xsl:with-param>
					</xsl:call-template>
					<xsl:text>&lt;/p&gt;</xsl:text>
					<xsl:text>&lt;p class=\"right\"&gt;&lt;a href="</xsl:text>
					<xsl:value-of select="$overlib_url"/>
					<xsl:text>" onclick="window.open(this.href); return false;"&gt;</xsl:text>
					<xsl:text>Article "</xsl:text>
					<xsl:call-template name="escape-apos">
						<xsl:with-param name="string"><xsl:value-of select="$overlib_caption"/></xsl:with-param>
					</xsl:call-template>
					<xsl:text>" sur Muleta</xsl:text>
					<xsl:text>&lt;/a&gt;</xsl:text>
					<xsl:text>', STICKY, CAPTION, 'Muleta : </xsl:text>
					<xsl:call-template name="escape-apos">
						<xsl:with-param name="string"><xsl:value-of select="$overlib_caption"/></xsl:with-param>
					</xsl:call-template>
					<xsl:text>', CENTER);</xsl:text>
				</xsl:attribute>
				<xsl:attribute name="onmouseout">nd();</xsl:attribute>
			</xsl:if>
			<xsl:choose>
				<xsl:when test="$overlib_caption != ''">
					<strong><xsl:apply-templates/></strong>
				</xsl:when>
				<xsl:when test="$hilite = 'false'">
					<xsl:value-of select="$valeur"/>
				</xsl:when>
				<xsl:otherwise>
					<xsl:apply-templates/>
				</xsl:otherwise>
			</xsl:choose>
		</a>
	</xsl:template>

	<xsl:template name="show_documents">
		<xsl:param name="doc_title"/>
		<xsl:variable name="doc">
			<!-- On autorise finalement les noms de fichiers avec des espaces
			<xsl:value-of select="translate(normalize-space(.),' ','_')"/>-->
			<xsl:value-of select="."/>
		</xsl:variable>
		<xsl:variable name="fieldid">
			<xsl:choose>
				<xsl:when test="not(../sdx:field[@name = 'sdxdocid'])">
					<xsl:value-of select="//sdx:field[@name = 'sdxdocid']" />
				</xsl:when>
				<xsl:otherwise>
					<xsl:value-of select="../sdx:field[@name = 'sdxdocid']" />
				</xsl:otherwise>
			</xsl:choose>
		</xsl:variable>
		<xsl:variable name="rep">
			<xsl:text>../documents/Urbamet/</xsl:text>
			<xsl:value-of select="substring(substring-after($fieldid,'-'),0,5)" />
			<xsl:text>/Urbamet-</xsl:text>
			<xsl:value-of select="substring-after($fieldid,'-')" />
			<xsl:text>/</xsl:text>
		</xsl:variable>
		<xsl:variable name="extension">
			<xsl:if test="contains($doc,'http') or contains($doc,'www')">
				<xsl:text>LINK</xsl:text>
			</xsl:if>
			<xsl:if test="not(contains($doc,'http') or contains($doc,'www'))">
				<xsl:value-of select="substring-after(normalize-space($doc),'.')"/>
			</xsl:if>
		</xsl:variable>
		<xsl:choose>
			<xsl:when test="$extension='pdf' or $extension='PDF'">
				<a href="{$rep}{$doc}" class="img_link pdf_link">
					<xsl:call-template name="popup-window">
						<xsl:with-param name="link_text">
							<xsl:value-of select="$doc_title"/>
							<xsl:text> - PDF</xsl:text>
						</xsl:with-param>
					</xsl:call-template>
					<xsl:value-of select="$serverURI" />
					<xsl:value-of select="substring-after($rep,'..')" /><xsl:value-of select="$doc" />
				</a>
			</xsl:when>
			<xsl:when test="$extension='LINK'">
				<a href="{$doc}" class="img_link html_link">
					<xsl:call-template name="popup-window">
						<xsl:with-param name="link_text">
							<xsl:value-of select="$doc_title"/>
							<xsl:text> - HTML</xsl:text>
						</xsl:with-param>
					</xsl:call-template>
					<!--<xsl:value-of select="$serverURI" />
					<xsl:value-of select="substring-after($rep,'..')" />--><xsl:value-of select="$doc" />
				</a>
			</xsl:when>
			<xsl:when test="$extension='htm' or $extension='HTM' or $extension='html' or $extension='HTML'">
				<a href="{$rep}{$doc}" class="img_link html_link">
					<xsl:call-template name="popup-window">
						<xsl:with-param name="link_text">
							<xsl:value-of select="$doc_title"/>
							<xsl:text> - HTML</xsl:text>
						</xsl:with-param>
					</xsl:call-template>
					<xsl:value-of select="$serverURI" />
					<xsl:value-of select="substring-after($rep,'..')" /><xsl:value-of select="$doc" />
				</a>
			</xsl:when>
			<xsl:otherwise>
				<a href="{$rep}{$doc}" class="img_link txt_link">
					<xsl:call-template name="popup-window">
						<xsl:with-param name="link_text">
							<xsl:value-of select="$doc_title"/>
							<xsl:text> - TXT</xsl:text>
						</xsl:with-param>
					</xsl:call-template>
					<xsl:value-of select="$rep" /><xsl:value-of select="$doc" />
				</a>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>

	<xsl:template name="lien_ext">
		<xsl:param name="href"/>
		<a href="{$href}">
			<xsl:if test="starts-with($href,'http://')">
				<xsl:attribute name="onclick">window.open(this.href); return false;</xsl:attribute>
			</xsl:if>
			<xsl:apply-templates/>
		</a>
	</xsl:template>


	<!-- sdx:term -->
	<xsl:template match="sdx:term">
	</xsl:template>

</xsl:stylesheet>

```

</details>


---

### 📄 `sdxlib/xsp/ajoutepanier.xsp` [2.309 octets]
<a id="sdxlib-xsp-ajoutepanier-xsp"></a> [↩ Retour à l'arborescence](#tree-sdxlib-xsp-ajoutepanier-xsp)

> **Chemin relatif** : `sdxlib/xsp/ajoutepanier.xsp`  
> **Taille** : 2.309 octets  
> **Lignes** : 73  
> **Type** : text

```text
﻿<?xml version="1.0"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx">
    <sdx:page>
          <panier>
	  <xsp:logic>
	  	java.util.HashSet liste=null;
		if (session!=null){
			liste=(java.util.HashSet)session.getAttribute("panier");
		}
		    if(liste==null){liste=new java.util.HashSet();}
		    
		    boolean nouvelElement=false;
		    
		    java.util.Enumeration e=request.getParameterNames();
		    while(e.hasMoreElements()){
			    Object obj=e.nextElement();
			    if(obj instanceof String){
				String id=(String)obj;
				if(id.startsWith("ids")){
					nouvelElement=true;						
					
					String[] values=request.getParameterValues(id);
					for (int i=0 ; i&lt; values.length; i++){
						liste.add(values[i]);			    
						<!--
						<notice><xsp:expr>values[i]</xsp:expr></notice>
						-->
					}
					/*
					String valeur=(String)request.getParameter(id);
					liste.add(valeur);			    
					*/
				}
			    }
		   }
		   if(nouvelElement){
			   session.setAttribute("panier",liste);
		   }
	    </xsp:logic>
		<size><xsp:expr>liste.size()</xsp:expr></size>
      </panier>  
    </sdx:page>
</xsp:page>

```


---

### 📄 `sdxlib/xsp/contenupanier.xsp` [1.630 octets]
<a id="sdxlib-xsp-contenupanier-xsp"></a> [↩ Retour à l'arborescence](#tree-sdxlib-xsp-contenupanier-xsp)

> **Chemin relatif** : `sdxlib/xsp/contenupanier.xsp`  
> **Taille** : 1.630 octets  
> **Lignes** : 48  
> **Type** : text

```text
﻿<?xml version="1.0"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx">
    <sdx:page>
          <panier>
	  <xsp:logic>
		    java.util.HashSet liste=(java.util.HashSet)session.getAttribute("panier");
		    if(liste==null){liste=new java.util.HashSet();}

		    java.util.Iterator it = liste.iterator();


		    while(it.hasNext()){
			<id><xsp:expr>it.next()</xsp:expr></id>
		    }
	   </xsp:logic>
      </panier>  
    </sdx:page>
</xsp:page>

```


---

### 📄 `sdxlib/xsp/extraction-pdf.xsp` [3.779 octets]
<a id="sdxlib-xsp-extraction-pdf-xsp"></a> [↩ Retour à l'arborescence](#tree-sdxlib-xsp-extraction-pdf-xsp)

> **Chemin relatif** : `sdxlib/xsp/extraction-pdf.xsp`  
> **Taille** : 3.779 octets  
> **Lignes** : 112  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (112 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<!-- $Id: extraction-pdf.xsp 17497 2010-01-12 09:47:36Z jcwiklinski $ -->

<!-- Ici, on extrait le contenu textuel des PDF.
Le fichier PDF à travailler doit etre libre de droit d'extraction. On ne prend
que le texte. Pas d'image ou autre.
TODO : Il faut encore tester l'extraction de texte depuis l'analyse OCR.

INFO Saxon 8 : on intercepte toutes les exceptions et on ne transmet ni ne crée
d'exception Cocoon (ProcessingException) car Saxon 8 les intercepte et bloque
alors l'indexation.

La sortie est cachée par Cocoon.

Deux formats de sortie sont disponibles :
1) txt
		Répond au paramètre format=txt. Le texte en englobé dans un élément
		extracteur. Ceci permet de récupérer l'extraction dans une XSL par la
		fonction document() (qui attend de l'XML).
2) xml
		Répond au paramètre format=xml. Il s'agit en fait d'une sortie HTML !
-->

<xsp:page language="java" xmlns:xsp="http://apache.org/xsp">

	<xsp:structure>
		<xsp:include>java.io.File</xsp:include>
		<xsp:include>java.io.InputStream</xsp:include>
		<xsp:include>java.io.FileInputStream</xsp:include>
		<xsp:include>org.xml.sax.ContentHandler</xsp:include>
		<xsp:include>org.apache.tika.parser.Parser</xsp:include>
		<xsp:include>org.apache.tika.parser.pdf.PDFParser</xsp:include>
		<xsp:include>org.apache.tika.parser.AutoDetectParser</xsp:include>
		<xsp:include>org.apache.tika.parser.ParseContext</xsp:include>
		<xsp:include>org.apache.tika.metadata.Metadata</xsp:include>
		<xsp:include>org.apache.tika.sax.BodyContentHandler</xsp:include>
		<xsp:include>org.apache.tika.exception.TikaException</xsp:include>
		<xsp:include>org.xml.sax.SAXException</xsp:include>
		<xsp:include>org.apache.commons.httpclient.*</xsp:include>
		<xsp:include>org.apache.commons.httpclient.methods.*</xsp:include>
	</xsp:structure>

	<extracteur>

		<xsp:logic>
			<!-- proxy settings -->

			String proxyHost="10.167.70.212";
			int proxyPort=3128;

			boolean processFile = null != request.getParameter("fichier");
			boolean processUrl = null != request.getParameter("url");
			String fichier	= parameters.getParameter("fichier", request.getParameter("fichier"));
			String url = parameters.getParameter("url", request.getParameter("url"));
			//System.out.println(fichier);
			//System.out.println(url);
			
			InputStream input = null;
			if ( processFile){
				File f = new File(fichier);
				input = new FileInputStream(f);
			} else if (processUrl){


				<!-- Client http -->
				try{
					HttpClient client = new HttpClient();
					client.getHostConfiguration().setProxy(proxyHost, proxyPort);
					GetMethod method = new GetMethod(url);
					//method.setRequestHeader("content-type","text/html");
					int statusCode = client.executeMethod(method);
					//System.out.println(statusCode);
					if (statusCode==200){
						input = method.getResponseBodyAsStream();
						//method.getResponseBodyAsString();
					}
				

				}catch(Exception e){

				}

			}
			ContentHandler textHandler = new BodyContentHandler(-1);


			try{
				Metadata metadata = new Metadata();
			//Parser parser = new PDFParser();
				Parser parser = new AutoDetectParser();

				parser.parse(input, textHandler, metadata, new ParseContext() );
			//System.out.println("Title: " + metadata.get("title"));
			//System.out.println("Author: " + metadata.get("Author"));
			//System.out.println("content: " + textHandler.toString());
			}catch(Exception e){
				e.printStackTrace();
			}finally{
				input.close();
				fr.gouv.culture.sdx.utils.SAXUtils.sendElementContent( this.contentHandler, textHandler.toString() , true ); 
			}



		</xsp:logic>

	</extracteur>

</xsp:page>



```

</details>


---

### 📄 `sdxlib/xsp/menu-connexion.xsp` [1.918 octets]
<a id="sdxlib-xsp-menu-connexion-xsp"></a> [↩ Retour à l'arborescence](#tree-sdxlib-xsp-menu-connexion-xsp)

> **Chemin relatif** : `sdxlib/xsp/menu-connexion.xsp`  
> **Taille** : 1.918 octets  
> **Lignes** : 53  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx"
	xmlns:xi="http://www.w3.org/2001/XInclude"
	xmlns:xsp-sdxSecurity="http://portail.documentation.equipement.gouv.fr/ns/sdx/sdxSecurity"
>
	<xsp:logicsheet location="sdxlib/conf/logicsheets/sdxSecurity.xsl"/>
	<xsp:structure>
		<xsp:include>fr.gouv.culture.sdx.search.lucene.DateField</xsp:include>
	</xsp:structure>
	<menu name="connexion">
		<xsp-sdxSecurity:init/>
	<xsp:logic>
		if ( subject.isAuthenticated() ){
			<entry name="Déconnexion">
				<xsp:attribute name="login"><xsp:expr>subject.getPrincipal()</xsp:expr></xsp:attribute>
				logout
			</entry>
		}else{
			<entry name="Connexion">login</entry>
		}
	</xsp:logic>
	</menu>
</xsp:page>

```


---

### 📄 `sdxlib/xsp/retraitpanier.xsp` [2.273 octets]
<a id="sdxlib-xsp-retraitpanier-xsp"></a> [↩ Retour à l'arborescence](#tree-sdxlib-xsp-retraitpanier-xsp)

> **Chemin relatif** : `sdxlib/xsp/retraitpanier.xsp`  
> **Taille** : 2.273 octets  
> **Lignes** : 70  
> **Type** : text

```text
﻿<?xml version="1.0"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx">
    <sdx:page>
          <panier>
	  <xsp:logic>
		    java.util.HashSet liste=(java.util.HashSet)session.getAttribute("panier");
		    if(liste==null){liste=new java.util.HashSet();}
		    
		    boolean nouvelElement=false;
		    
		    java.util.Enumeration e=request.getParameterNames();
		    while(e.hasMoreElements()){
			    Object obj=e.nextElement();
			    if(obj instanceof String){
				String id=(String)obj;
				if(id.startsWith("ids")){
					nouvelElement=true;						
					
					String[] values=request.getParameterValues(id);
					for (int i=0 ; i&lt; values.length; i++){
						liste.remove(values[i]);			    
						<!--
						<notice><xsp:expr>values[i]</xsp:expr></notice>
						-->
					}
					/*
					String valeur=(String)request.getParameter(id);
					liste.add(valeur);			    
					*/
				}
			    }
		   }
		   if(nouvelElement){
			   session.setAttribute("panier",liste);
		   }
	    </xsp:logic>
		<size><xsp:expr>liste.size()</xsp:expr></size>
      </panier>  
    </sdx:page>
</xsp:page>

```


---

### 📄 `sdxlib/xsp/suggest.xsp` [23.305 octets]
<a id="sdxlib-xsp-suggest-xsp"></a> [↩ Retour à l'arborescence](#tree-sdxlib-xsp-suggest-xsp)

> **Chemin relatif** : `sdxlib/xsp/suggest.xsp`  
> **Taille** : 23.305 octets  
> **Lignes** : 722  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (722 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../../transform/xmldoc/xmldoc.xsl"?>
<!--
Notix
***************************************************

Titre        : Notix
Copyright    : © 2006 "Ministère des Transports", "AJLSM" <http://ajlsm.com>.
Licence      : "GPL" <http://www.gnu.org/copyleft/gpl.html>
Créateur     : [MP] Malo Pichot <malo.pichot@ajlsm.com>
Contributeur : [JC] Johan Cwiklinski <johan AT x-tnd DOT be>
Contributeur : [AD] André Davignon <andre.davignon@free.fr>

<license>

Notix : notices bibliographiques et d'autorités, dans une base XML.

Copyright (C) 2005 Ministère des Transports, AJLSM.

Ministère des Transports, de l'Équipement, du Tourisme et de la Mer (FRANCE),
    Centre d'Études Technique de l’Équipement Nord - Picardie (CETE Nord - Picardie),
    Point d'appui national documentaire (Pandoc),
    2 rue de Bruxelles – BP 275, 59019 LILLE Cedex, France.
AJLSM,
    17 rue Vital-Carles, 33000 Bordeaux, France

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html

</license>
--><!--


-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns="http://www.w3.org/1999/xhtml">

	<xsp:structure>
		<xsp:include>fr.gouv.culture.sdx.application.Application</xsp:include>
		<xsp:include>fr.gouv.culture.sdx.documentbase.DocumentBase</xsp:include>
		<xsp:include>fr.gouv.culture.sdx.documentbase.LuceneDocumentBase</xsp:include>
		<xsp:include>fr.gouv.culture.sdx.exception.SDXException</xsp:include>
		<xsp:include>fr.gouv.culture.sdx.framework.Framework</xsp:include>
		<xsp:include>fr.gouv.culture.sdx.framework.FrameworkImpl</xsp:include>
		<!-- utilisé pour reconnaître le type d'un champ date -->
		<xsp:include>fr.gouv.culture.sdx.search.lucene.Field</xsp:include>
		<xsp:include>java.text.Collator</xsp:include>
		<xsp:include>java.text.RuleBasedCollator</xsp:include>
		<xsp:include>java.util.Iterator</xsp:include>
		<xsp:include>java.util.ArrayList</xsp:include>
		<xsp:include>java.util.Collections</xsp:include>
		<xsp:include>java.util.Locale</xsp:include>
		<xsp:include>java.text.SimpleDateFormat</xsp:include>
		<xsp:include>org.apache.avalon.framework.parameters.ParameterException</xsp:include>
		<xsp:include>org.apache.avalon.framework.service.ServiceException</xsp:include>
		<xsp:include>org.apache.avalon.framework.service.ServiceManager</xsp:include>
		<xsp:include>org.apache.avalon.framework.service.WrapperServiceManager</xsp:include>
		<xsp:include>org.apache.commons.lang.StringUtils</xsp:include>
		<xsp:include>org.apache.commons.lang.StringEscapeUtils</xsp:include>
<!--
		<xsp:include>org.apache.lucene.analysis.ISOLatin1AccentFilter</xsp:include>
-->
		<xsp:include>org.apache.lucene.index.IndexReader</xsp:include>
		<xsp:include>org.apache.lucene.index.Term</xsp:include>
		<xsp:include>org.apache.lucene.index.TermEnum</xsp:include>
		<xsp:include>org.apache.lucene.index.TermDocs</xsp:include>
		<xsp:include>org.apache.lucene.search.WildcardTermEnum</xsp:include>
		<xsp:include>org.apache.lucene.document.Document</xsp:include>
		<xsp:include>org.apache.lucene.search.regex.RegexTermEnum</xsp:include>
		<xsp:include>org.apache.lucene.search.regex.RegexCapabilities</xsp:include>
		<xsp:include>org.apache.regexp.RE</xsp:include>
		<xsp:include>org.apache.regexp.RegexpTunnel</xsp:include>
		<xsp:include>org.apache.commons.lang.builder.CompareToBuilder</xsp:include>

		<xsp:include>org.apache.solr.util.BoundedTreeSet</xsp:include>
		<xsp:include>org.apache.shiro.SecurityUtils</xsp:include>
    <!--<xsp:include>org.pleade.utils.SuggestRegexpCapabilities</xsp:include>-->
	</xsp:structure>
	
<xsp:logic>

   public class EnumResult implements Comparable {
        String term;
        Integer freq;
        boolean sortAlpha=false;

        public EnumResult( String term, Integer freq ) {
            this.term = term;
            this.freq = freq;
        }

        public EnumResult( String term, Integer freq, boolean sortAlpha ) {
            this.term = term;
            this.freq = freq;
	    this.sortAlpha = sortAlpha;
        }

	public String get(){
	    return term;
	}

	public String getTerm(){
	    return term;
	}

	public Integer getFreq(){
	    return freq;
	}

	public boolean equals(Object o) {
		return (o instanceof EnumResult)
		&amp;&amp; (0 == this.compareTo( o));
	}

	public int compareTo(Object o) {
		if(sortAlpha){
			EnumResult e = (EnumResult) o;
			int vc = term.compareTo(e.term);
			return vc;
		} else {
			EnumResult e = (EnumResult) o;
			int vc = e.freq.compareTo(freq);
			return (0 != vc ? vc : term.compareTo(e.term));
		}
	} 

<!--
        public int compareTo(Object o) {
            if( o instanceof EnumResult ) {
                EnumResult oFreq = (EnumResult) o;
                return new CompareToBuilder( )
                    .append( freq, oFreq.freq )
                    .append( term, oFreq.term )
                    .toComparison( );
            } else {
                return 0;
            }
        }
-->
    }





public class SuggestRegexpCapabilities
		implements RegexCapabilities
{

	private RE regexp;
	boolean isEscaped;
	
	public SuggestRegexpCapabilities (boolean escaped){
		this.isEscaped = escaped;
	}
		
	public SuggestRegexpCapabilities (){
		this.isEscaped = false;
	}
		
	public void compile(String pattern) {
		if (isEscaped) {
			pattern = pattern.replace("(","\\u0028");
			pattern = pattern.replace(")","\\u0029");
			pattern = pattern.replace("$","\\u0024");
			pattern = pattern.replace("*","\\u002A");
			pattern = pattern.replace("+","\\u002B");
			pattern = pattern.replace(".","\\u002E");
			pattern = pattern.replace("/","\\u002F");
			pattern = pattern.replace("?","\\u003F");
			/* Ces caractères réservés aux regexp sont traités dans la classe buildRegexValue
			pattern = pattern.replace("[","\\u005B");
			pattern = pattern.replace("]","\\u005D");
			 */
			pattern = pattern.replace("{","\\u007B");
			pattern = pattern.replace("}","\\u007D");
		}
		
		regexp = new RE(pattern, RE.MATCH_CASEINDEPENDENT);
	}

	public boolean match(String string) {
		return regexp.match(string);
	}

	public String prefix() {
//		char[] prefix = RegexpTunnel.getPrefix(regexp);
//		return prefix == null ? null : new String(prefix);
		return null;
	}

	public boolean equals(Object o) {
		if (this == o) return true;
		if (o == null || getClass() != o.getClass()) return false;

		final SuggestRegexpCapabilities that = (SuggestRegexpCapabilities) o;

		if (regexp != null ? !regexp.equals(that.regexp) : that.regexp != null) return false;

		return true;
	}

	public int hashCode() {
		return (regexp != null ? regexp.hashCode() : 0);
	}

}



</xsp:logic>

	<xsp:logic><![CDATA[
		/** Application sdx, ne pas oublier de fixer au départ */
		Application sdxApp;
		/** timer */
		long start;
		/** un collator pour tri alphabétique */
		Collator collator;

		private Application sdxGetApp() throws ServiceException, SDXException {
			// Application au sens sdx, on plante s'il n'y a rien de fourni par le sitemap
			String app = parameters.getParameter("app", request.getParameter("app"));
			//String app = "cataloguecdu";
			
			ServiceManager cocoon_serviceManager = new WrapperServiceManager(manager);
			FrameworkImpl sdx_frame = (FrameworkImpl) cocoon_serviceManager.lookup(Framework.ROLE);
			return sdx_frame.getApplicationByPath(app);
		}

		
		/* Récupération et sauvegarde d'un indexReader Lucene
		Ceci est mis en objet de contexte pour que d'ailleurs on puisse supprimer l'objet 
		(mise à jour de la liste de termes après suppression ou ajout de document)
		*/
		private IndexReader getIndexReader(String base, boolean recycle) throws ServiceException, SDXException {
			// le reader lucene à renvoyer
			IndexReader indexReader=null;
			
			DocumentBase sdx_base = sdxApp.getDocumentBase(base);
			//DEBUG System.out.println(sdx_base);
			fr.gouv.culture.sdx.search.lucene.query.LuceneIndex sdxLuc=((LuceneDocumentBase)sdx_base).getLuceneIndex();
			// Ici 60ms
			indexReader = sdxLuc.getReader();
			// on remet en contexte
			// context.setAttribute("suggestReaders", suggestReaders);
			//DEBUG System.out.println("[suggest] ouverture de "+indexReader.directory()+ " en "+(System.currentTimeMillis() - start)+" ms");
			return indexReader;
		}

		private String getSdxFieldType(String base, String field) throws ServiceException, IOException, SDXException {
			if (field == null) return null;
			DocumentBase sdx_base = sdxApp.getDocumentBase(base);
			Field sdxField=((LuceneDocumentBase)sdx_base).getIndex().getField(field);
			if(sdxField == null) return null;
			return sdxField.getTypeName();
		}


  /** Retourne l'expression reguliere correspondante de maniere a ne pas tenir
   * compte des accents
   * Boucle sur les caracteres de la String. Pour chaque caractere, on cree une
   * "Character class" composee de l'ensemble de ses declinaisons en minuscules :
   * caractere non accentue plus caractere(s) accentue(s).
   * On ne renvoie que des minuscules car on utilise la classe
   * org.pleade.utils.SuggestRegexCapabilities qui cree une expression reguliere
   * (org.apache.regexp.RE) insensible a la casse.
   */
  public static String buildRegexValue(String s)
  {
    return buildRegexValue( s, "ISO-8859-1", true );
  }
  public static String buildRegexValue(String s, boolean lazy)
  {
    return buildRegexValue( s, "ISO-8859-1", lazy);
  }
  public static String buildRegexValue(String s, String enc, boolean lazy)
  {

    String ret = s;
    try
    {

      if ( !enc.equals("ISO-8859-1") )
      {
        // DEBUG System.out.println("[PLEADE][SUGGEST] Erreur dans buildRegexValue avec s:"+s+" enc:"+enc+" : encodage non supporte !" );
      }
      else if ( enc.equals("ISO-8859-1") )
      {

        int l = s.length();
        StringBuffer chars = new StringBuffer( l );
        for ( int i = 0; i < l; i++ )
        {
		char c = s.charAt(i);
		switch (c) {
			/* NOTE (MP) : on echappe pas les caracteres reserves en
			* expression reguliere. on estime que ce qui vient est une
			* expression reguliere correcte. */
			// case '\u0028': // "("
			// case '\u0029': // ")"
			// case '\u002A': // "*"
			// case '\u002B': // "+"
			// case '\u002E': // "."
			// case '\\': // "\"
			    
			// [AD] on échappe ici les caractères "[" et "]"
			//les autres caractères réservés aux regexp (sauf "^" ), que l'on considère ici comme le seul pertinent,
			//sont traités dans la classe SuggestRegexpCapabilities
			case '\u005B':
				chars.append("\\u005B");
				break;
			case '\u005D':
				chars.append("\\u005D");
				break;
			// case '\u005E': // "^"
			// case '\u007B': // "{"
			// case '\u007C': // "|"
			// case '\u007D': // "}"
			//   chars.append("\\"+c); // caracteres reserves en expression reguliere
			//   break;
			case ' ':
			case '-':
			case ',':
			case '\'':
			case '.':
			case ':':
			case ';':
				chars.append("[\u0020\\\u002D\u002C\u002E\u003A\u003B\u0027]");
				//Les espaces doivent rester optionnels dans le suggest pour pouvoir accéder à tout les termes.
				if(lazy){chars.append("?");}
				break;
			case 'A':
			case '\u00C0':
			case '\u00C1':
			case '\u00C2':
			case '\u00C3':
			case '\u00C4':
			case '\u00C5':
			case 'a':
			case '\u00E0':
			case '\u00E1':
			case '\u00E2':
			case '\u00E3':
			case '\u00E4':
			case '\u00E5':
				chars.append("[A\u00C0\u00C1\u00C2\u00C3\u00C4\u00C5a\u00E0\u00E1\u00E2\u00E3\u00E4\u00E5]");
				break;
			case '\u00C6': // AE ligature
			case '\u00E6': // ae ligature
				//chars.append("((AE)|\u00E6)");
				break;
			case 'C':
			case '\u00C7':
			case 'c':
			case '\u00E7':
				chars.append("[C\u00C7c\u00E7]");
				break;
			case 'E':
			case '\u00C8':
			case '\u00C9':
			case '\u00CA':
			case '\u00CB':
			case 'e':
			case '\u00E8':
			case '\u00E9':
			case '\u00EA':
			case '\u00EB':
				chars.append("[E\u00C8\u00C9\u00CA\u00CBe\u00E8\u00E9\u00EA\u00EB]");
				break;
			case 'I':
			case '\u00CC':
			case '\u00CD':
			case '\u00CE':
			case '\u00CF':
			case 'i':
			case '\u00EC':
			case '\u00ED':
			case '\u00EE':
			case '\u00EF':
				chars.append("[I\u00CC\u00CD\u00CE\u00CFi\u00EC\u00ED\u00EE\u00EF]");
				break;
			case 'D':
			case '\u00D0':
			case 'd':
			case '\u00F0':
				chars.append("[D\u00D0d\u00F0]");
				break;
			case 'N':
			case '\u00D1':
			case 'n':
			case '\u00F1':
				chars.append("[N\u00D1n\u00F1]");
				break;
			case 'O':
			case '\u00D2':
			case '\u00D3':
			case '\u00D4':
			case '\u00D5':
			case '\u00D6':
			case '\u00D8':
			case 'o':
			case '\u00F2':
			case '\u00F3':
			case '\u00F4':
			case '\u00F5':
			case '\u00F6':
			case '\u00F8':
				chars.append("[O\u00D2\u00D3\u00D4\u00D5\u00D6\u00D8o\u00F2\u00F3\u00F4\u00F5\u00F6\u00F8]");
				break;
			case '\u0152':
			case '\u0153':
				chars.append("((oe)|\u0153)");
				break;
			case '\u00DE':
			case '\u00FE':
				chars.append("((th)|\u00FE)");
				break;
			case 'U':
			case '\u00D9':
			case '\u00DA':
			case '\u00DB':
			case '\u00DC':
			case 'u':
			case '\u00F9':
			case '\u00FA':
			case '\u00FB':
			case '\u00FC':
				chars.append("[U\u00D9\u00DA\u00DB\u00DCu\u00F9\u00FA\u00FB\u00FC]");
				break;
			case 'Y':
			case '\u00DD':
			case '\u0178':
			case 'y':
			case '\u00FD':
			case '\u00FF':
				chars.append("[Y\u00DD\u0178y\u00FD\u00FF]");
				break;
			case '\u00DF':
				chars.append("((ss)|"+c+")");
				break;
			default:
				chars.append( "["+Character.toUpperCase(c)+Character.toLowerCase(c)+"]" );
				break;
		}

				if(lazy){chars.append(" ?");}
        }

        ret = chars.toString();
	//DEBUG System.out.println("exp : "+ret);

      }

    } catch(Exception e) {
       // DEBUG System.out.println("[PLEADE][SUGGEST] Erreur dans buildRegexValue avec s:"+s+" enc:"+enc+" : "+e );
    } finally {
      // DEBUG System.out.println("[PLEADE][SUGGEST] Pour s:"+s+" enc:"+enc+" retourne:"+ret );
      return ret;
    }

  }

		
]]></xsp:logic>
<xsp:logic>
<!--
public String removeEmptyWords(String words){

	words = words.trim();
	String cleaned = words;

	String[] suffixes={" à la", " aux"," au", " de", " du", " d", " l"};

	for(int i=0; i&lt;suffixes.length; i++){
		if (words.endsWith(suffixes[i])){
			cleaned=new String( words.substring(0, words.length() - suffixes[i].length()) );
		}
	}
	return cleaned;
}
-->
</xsp:logic>

	<pre><xsp:logic>

			<!-- 
			I - Initialisation des variables et Traitement des paramètres
			--> 

			int limit = Integer.parseInt(request.getParameter("limit"));
			BoundedTreeSet queue = new BoundedTreeSet(limit);
			boolean sortAlpha=false;
			boolean isEscaped = true;
			SuggestRegexpCapabilities src = new SuggestRegexpCapabilities(isEscaped);

			<!-- objet application SDX à partager -->
			try {
				sdxApp = sdxGetApp();
			} catch (Exception e) {
				throw new ProcessingException(e);
			}
			ArrayList liste = new ArrayList();
			String separator="|";
			String base = parameters.getParameter("base", request.getParameter("base"));
			String recycleParam = parameters.getParameter("recycle", (String)request.getParameter("recycle"));
			boolean recycle=false;
			if (recycleParam !=  null &amp;&amp; !"".equals(recycleParam)) recycle=true;
			String defaultField=null;
			String quote = (String)request.getParameter("quote");
			String shingle = (String)request.getParameter("shingle");
			String field = request.getParameter("field");
			String json = request.getParameter("json");
			sortAlpha = "true".equals((String)request.getParameter("alpha"));
			String firstValue = "";

						
			String value = "";
			value = (String)request.getParameter("q");

			//DEBUG System.out.println(value);

			if ( ! value.trim().equals("") ){

				
				// On traite la requête selon le type d'index interrogé

				if (quote != null &amp;&amp; "true".equals(quote)) {
					if (value.lastIndexOf("\"") != -1) {
						firstValue = value.substring(0,value.lastIndexOf("\"")+2);
						value = value.substring(value.lastIndexOf("\"")+2);
					}
				}
				else if (shingle != null &amp;&amp; "true".equals(shingle)){
					value=value;
				}
				else {
					if (value.lastIndexOf(" ") != -1) {
						firstValue = value.substring(0,value.lastIndexOf(" ")+1);
						value = value.substring(value.lastIndexOf(" ")+1);
					}
				}


				IndexReader luceneReader =  null;
				try {
					luceneReader=getIndexReader(base, recycle);
				}
				catch (Exception e) {
					throw new ProcessingException(e);
				}
				<!-- Le type du champ, surtout pour les champs date, - de 10ms -->
				String type;
				try {
					type=getSdxFieldType(base, field);
				} catch (Exception e) {
					throw new ProcessingException(e);
				}
				// encoder la valeur cherchée en cas de date
				if("date".equals(type)) {
					//DEBUG System.out.println("value : "+value);
					// Pour plus de sûreté, on n'autorise que les chiffres; les "-" sont rajoutés ci-dessous
					value = value.replaceAll("\\D","");
					// on n'autorise pas les valeurs vides
					if ("".equals(value)) value += "1";
					// pour éviter l'exception java.lang.RuntimeException: time too early
					if ("0".equals(value)) value = "1";
					// on complète à 4 caractères pour que le suggest soit pertinent dès la saisie du 1er caractère
					if (value.length() == 1) value += "000";
					else if (value.length() == 2) value += "00";
					else if (value.length() == 3) value += "0";
					// les "-" ont été supprimés par value = value.replaceAll("\\D",""), on les réintroduit
					else if (value.length() == 5) value = value.substring(0,4) +"-" + value.substring(4,5);
					else if (value.length() == 6) value = value.substring(0,4) +"-" + value.substring(4,6);
					else if (value.length() == 7) value = value.substring(0,4) +"-" + value.substring(4,6) + "-" + value.substring(6,7);
					else if (value.length() &gt;= 8) value = value.substring(0,4) +"-" + value.substring(4,6) + "-" + value.substring(6,8);
					//DEBUG System.out.println("length : "+value.length());
					//DEBUG System.out.println("substring : "+value.substring(4,value.length()));
					//DEBUG System.out.println("indexOf : "+value.substring(4,value.length()).indexOf("-"));
					Date date=fr.gouv.culture.sdx.utils.Date.parseDate(value);
					if (date== null) value="";
					else value=fr.gouv.culture.sdx.search.lucene.DateField.dateToString(date);
				}


				<!-- 
				II - On interroge l'index : On ne récupère que les termes pertinents			
				-->

		Term term=new Term(field, value);
		TermEnum tenum;


		String convert = "^"+buildRegexValue(value);
		//DEBUG System.out.println(convert);
		RE r = new RE(convert);
		
		String strictConvert = "^"+buildRegexValue(value, false);
		RE r2 = new RE(strictConvert);

		tenum=luceneReader.terms(term);

		int i=0;
		while (true) {

			Term theTerm = tenum.term();
			if (theTerm==null ) break;
			String indexedText = theTerm.text();

			// stop if the prefix doesn't match
			if (value != null &amp;&amp; ! r.match(indexedText) ){
				//DEBUG System.out.println(indexedText + " " +  r.match(indexedText));
				//DEBUG tenum.next();
				//DEBUG System.out.println(tenum.term().text());
				
				 break;
			}
		    

			int docFreq = tenum.docFreq();
			String label = indexedText;

			if (r2.match(indexedText) ){
			queue.add(new EnumResult( label, new Integer(docFreq), sortAlpha ));
			//DEBUG System.out.println("ADD : " + label);
			}


			i++;
			tenum.next();
		}
		tenum.close();




		// Copie des items	
		i=0;
		for (Iterator it = queue.iterator(); it.hasNext();){
			      if (i &lt; limit) {
				EnumResult item = (EnumResult)it.next();
				liste.add(item);
				i++;
			      } else {
				break;
			      }
			}
		queue=null;


		<!--
			Affichage des Résultats 
		-->

		Iterator it = liste.iterator();
		int ii=0;
		if (json!=null &amp;&amp; "true".equals(json)){
			firstValue=firstValue.replace("\"","\\\"");
			<xsp:content>[</xsp:content>
                        while ( it.hasNext() &amp;&amp; ii &lt; limit) {
                                EnumResult result=(EnumResult)it.next();
                                String terme = (String)result.getTerm();
                                //terme = removeEmptyWords( (String)result.getTerm() );
                                String freq = String.valueOf(  result.getFreq() );
                                if (quote != null &amp;&amp; "true".equals(quote)) {
					<!--
                                	<xsp:content>{term:<xsp:expr>" \""+terme+"\""</xsp:expr>,freq:<xsp:expr>freq</xsp:expr>,firstValue:<xsp:expr>firstValue+"\""+terme+"\""</xsp:expr>,id:id}</xsp:content>
                                	<xsp:content>{label:"\"<xsp:expr>terme</xsp:expr>\" (<xsp:expr>freq</xsp:expr>)",value:"\"<xsp:expr>terme</xsp:expr>\""}</xsp:content>
					-->
                                	<xsp:content>{"term":"\"<xsp:expr>terme</xsp:expr>\"","freq":"<xsp:expr>freq</xsp:expr>","firstValue":"<xsp:expr>firstValue</xsp:expr>\"<xsp:expr>terme</xsp:expr>\"","id":"id"}</xsp:content>
                                }else {
					<!--
                                	<xsp:content>{term:<xsp:expr>terme</xsp:expr>,freq:<xsp:expr>freq</xsp:expr>,firstValue:<xsp:expr>firstValue+terme</xsp:expr>,id:id}</xsp:content>
                                	<xsp:content>{label:"<xsp:expr>terme</xsp:expr> (<xsp:expr>freq</xsp:expr>)",value:"<xsp:expr>terme</xsp:expr>"}</xsp:content>
					-->
                                	<xsp:content>{"term":"<xsp:expr>terme</xsp:expr>","freq":"<xsp:expr>freq</xsp:expr>","firstValue":"<xsp:expr>firstValue+terme</xsp:expr>","id":"id"}</xsp:content>
                                }
                                //DEBUG System.out.println("terme : " + terme);
                                ii++;
				if (it.hasNext() &amp;&amp; ii &lt; limit){<xsp:content>,<xsp:expr>"\n"</xsp:expr></xsp:content>}
                        }
			<xsp:content>]</xsp:content>
		}else{
			while ( it.hasNext() &amp;&amp; ii &lt; limit) {
				EnumResult result=(EnumResult)it.next();	
				String terme = (String)result.getTerm();
				//terme = removeEmptyWords( (String)result.getTerm() );
				String freq = String.valueOf(  result.getFreq() );
				if (quote != null &amp;&amp; "true".equals(quote)) {
				<xsp:content><xsp:expr>" \""+terme+"\""+separator+freq+separator+firstValue+"\""+terme+"\" "+separator+"id"+"\n"</xsp:expr></xsp:content>
				}else {
				<xsp:content><xsp:expr>terme+" "+separator+freq+separator+firstValue+terme+" "+separator+"id"+"\n"</xsp:expr></xsp:content>	
				}
				//DEBUG System.out.println("terme : " + terme);
				ii++;
			}
		}
		liste=null;




			}


		</xsp:logic>
	</pre>
</xsp:page>

```

</details>


---

### 📄 `site-properties.xml` [2.997 octets]
<a id="site-properties-xml"></a> [↩ Retour à l'arborescence](#tree-site-properties-xml)

> **Chemin relatif** : `site-properties.xml`  
> **Taille** : 2.997 octets  
> **Lignes** : 108  
> **Type** : xml

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (108 lignes) - Cliquer pour déplier</summary>

```xml
<site xmlns="" xmlns:xi="http://www.w3.org/2001/XInclude">
	<information>
		<default-title>Balise - Ministère de l’Écologie, du Développement durable et de l’Énergie</default-title>
		<color>purple</color><!-- blue, green, purple -->
		<title-display>box</title-display><!-- box, stick -->
		<logo-link>http://www.developpement-durable.gouv.fr/</logo-link>
	</information>
	<skin>
		<menu name="top-menu">
			<entry name="Site du STRMTG">http://www.strmtg.developpement-durable.gouv.fr/</entry>
		</menu>
		<!-- menu connexion dynamique-->
		<xi:include href="cocoon:/menu-connexion.xsp"/>
		<!--
		<menu name="connexion">
			<entry name="Votre Compte">#</entry>
		</menu>
		-->
		<menu name="menu-head">
			<entry name="Aide">aide.html</entry>
			<entry accesskey="s" name="Aller au contenu">#contenu</entry>
		</menu>
		<tete>
			<titre>Balise</titre>
		</tete>
		<menu name="search-tools">
			<entry type="basket" name="Porte-documents">panier.html</entry>
			<entry type="histo" name="Historique des recherches">historique.html</entry>
		</menu>
		<!-- menu-main dynamique -->
		<xi:include href="cocoon:/menu-main.xsp"/>
		<!--
		<menu name="menu-main">
			<entry name="Accueil">index.html</entry>
			<entry name="Recherche">recherche.html</entry>
			<entry name="Recherche avancée">recherche-avancee.html</entry>
		</menu>
		-->
		<menu name="menu-tools">
		<!--
			<entry name="Panier" type="panier">#</entry>
		-->
			<entry name="Panier" type="print">#</entry>
			<entry name="Panier" type="pmoins">#</entry>
			<entry name="Panier" type="pplus">#</entry>
		</menu>
<!--
		<pied>
			<copyright>© Ministère de l'Écologie, du Développement durable et de l'Énergie</copyright>
		</pied>
-->
		<!-- footer-menu dynamique -->
		<xi:include href="cocoon:/footer-menu.xsp"/>
		<!--
		<menu name="footer-menu">
			<section name="Recherche" link="recherche.html"/>
			<section name="Recherche avancée" link="recherche-avancee.html"/>
			<copyright>© Ministère de l'Écologie, du Développement durable et de l'Énergie</copyright>
		</menu>
		-->
		<menu name="bottom-menu" enable="true">
			<entry name="Mentions légales">mentions-legales.html</entry>
			<entry name="Contacts">contacts.html</entry>
			<entry name="Signaler une erreur">contacts.html</entry>
		</menu>
		<page>
			<contenu rightcol="true" leftcol="false">
				<col type="main"></col>
				<!--
				<col type="left">leftcol.xsp</col>
				-->
				<col type="right">rightcol.xsp</col>
			</contenu>
		</page>
	</skin>
	<pages>
		<page name="accueil">
			<contenu cols="1">
				<col num="1">
					Hello
				</col>
			</contenu>
		</page>
		<page name="consultation">
			<contenu cols="1">
				<col num="1">
					Hello
				</col>
			</contenu>
		</page>
		<page name="recherche-collection">
			<contenu cols="1">
				<col num="1">
					Hello
				</col>
			</contenu>
		</page>
		<page name="results-collection">
			<contenu cols="1">
				<col num="1">
					Hello
				</col>
			</contenu>
		</page>
	</pages>

</site>

```

</details>


---

### 📄 `sitemap.xmap` [23.522 octets]
<a id="sitemap-xmap"></a> [↩ Retour à l'arborescence](#tree-sitemap-xmap)

> **Chemin relatif** : `sitemap.xmap`  
> **Taille** : 23.522 octets  
> **Lignes** : 600  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (600 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<!-- Sitemap for the sdxworld application -->
<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">
    <!-- =========================== Components ================================ -->
    <map:components>
        <!-- generators -->
        <map:generators default="xsp">
            <map:generator name="file" src="org.apache.cocoon.generation.FileGenerator" label="content,data" logger="sitemap.generator.file" pool-max="32" pool-min="8" pool-grow="4"/>
            <map:generator name="xsp" src="org.apache.cocoon.generation.ServerPagesGenerator" logger="sitemap.generator.serverpages" pool-max="32" pool-min="4" pool-grow="2"/>
        </map:generators>

	<map:selectors default="exists">
		<map:selector name="exists" logger="sitemap.selector.resource-exists" src="org.apache.cocoon.selection.ResourceExistsSelector" />
<!--
		<map:selector name="session-attr" logger="sitemap.selector.session-attr" src="org.apache.cocoon.selection.SessionAttributeSelector" />
-->
	</map:selectors>

        <!-- readers -->
        <map:readers default="resource">
            <map:reader name="resource" src="org.apache.cocoon.reading.ResourceReader" logger="sitemap.reader.resource" pool-max="32"/>
        </map:readers>
        <!-- transformers -->
        <map:transformers default="xsl">
            <map:transformer name="xsl" src="org.apache.cocoon.transformation.TraxTransformer" logger="sitemap.transformer.xslt" pool-max="32" pool-min="8" pool-grow="2"/>
	    <map:transformer
	    logger="sitemap.transformer.xslt"
	    name="xslt"
	    pool-max="32"
	    src="org.apache.cocoon.transformation.TraxTransformer"
	    >
		    <use-request-parameters>false</use-request-parameters>
		    <use-session-parameters>false</use-session-parameters>
		    <use-cookie-parameters>false</use-cookie-parameters>
		    <xslt-processor-role>saxon</xslt-processor-role>
		    <check-includes>true</check-includes>
	    </map:transformer>
        </map:transformers>
        <!-- serializers -->
        <map:serializers default="xhtml">
            <map:serializer name="xml" src="org.apache.cocoon.serialization.XMLSerializer" mime-type="text/xml" logger="sitemap.serializer.xml"/>
            <map:serializer name="html" src="org.apache.cocoon.serialization.HTMLSerializer" mime-type="text/html" logger="sitemap.serializer.html" pool-max="32" pool-min="4" pool-grow="4">
                <buffer-size>1024</buffer-size>
                <encoding>ISO-8859-1</encoding>
            </map:serializer>
			<map:serializer
				name="xhtml"
				logger="sitemap.serializer.xhtml"
				mime-type="text/html"
				pool-max="64"
				src="org.apache.cocoon.serialization.XMLSerializer" >
					<doctype-public>-//W3C//DTD XHTML 1.0 Strict//EN</doctype-public>
					<doctype-system>http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd</doctype-system>
					<omit-xml-declaration>yes</omit-xml-declaration>
					<indent>yes</indent>
					<encoding>UTF-8</encoding>
			</map:serializer>
			<map:serializer name="html5" logger="sitemap.serializer.html5" mime-type="text/html" src="org.apache.cocoon.components.serializers.XHTMLSerializer">
				<omit-xml-declaration>yes</omit-xml-declaration>
				<doctype-default>xhtml5</doctype-default>
				<encoding>UTF-8</encoding>
				<use-entity-references>false</use-entity-references>
			</map:serializer>
			<map:serializer 
				name="text" 
				src="org.apache.cocoon.serialization.TextSerializer" 
				mime-type="text/plain" 
				logger="sitemap.serializer.xml">
					<encoding>UTF-8</encoding>
			</map:serializer>
			<map:serializer name="textXML"
			src="org.apache.cocoon.serialization.XMLSerializer"
			mime-type="text/plain"
			logger="sitemap.serializer.xml">
			
			<encoding>UTF-8</encoding>
            </map:serializer>

			<!-- Requis pour SDX23 et SDX24 inférieur à 24bis -->
			<map:serializer name="fo2pdf"
				mime-type="application/pdf"
				src="org.apache.cocoon.serialization.FOPSerializer"/>
			
			<!--Requis pour SDX24 supérieur ou égal à 24bis (build:2008012101) -->
			<!--<map:serializer name="fo2pdf"
				mime-type="application/pdf"
				src="org.apache.cocoon.serialization.FOPNGSerializer"/>-->

	<map:serializer name="fo2rtf"
                 mime-type="application/rtf"
	    src="org.apache.cocoon.serialization.RTFSerializer"/>

        </map:serializers>
        <!-- selectors -->
        <map:selectors default="browser"/>
        <!-- matchers -->
        <map:matchers default="wildcard">
            <map:matcher name="wildcard" src="org.apache.cocoon.matching.WildcardURIMatcher"/>
        </map:matchers>
        <!-- actions -->
        <map:actions default="isAdmin">
            <map:action name="isAdmin" logger="sdx.sitemap.AdminAction" src="fr.gouv.culture.sdx.sitemap.AdminAction"/>
        </map:actions>
    </map:components>
    <!-- =========================== Pipelines ================================= -->
    <map:pipelines>

	<map:component-configurations>
		<global-variables>
			<fs-doc>/home/tomcat/webapps/sdx/documents/balise</fs-doc>
		</global-variables>
	</map:component-configurations>

        <!-- Utility for viewing source xml or html -->
        <map:pipeline id="debug">
            <map:act type="isAdmin">
                <map:match pattern="**2file">
                    <map:generate type="xsp" src="xsp/file.xsp"/>
                    <map:serialize type="html"/>
                </map:match>
                <map:match pattern="**.xsp2xspX">
                    <map:generate type="file" src="xsp/{1}.xsp"/>
                    <map:serialize type="text"/>
                </map:match>
                <map:match pattern="**.xsp2xsp">
                    <map:generate type="file" src="xsp/{1}.xsp"/>
                    <map:transform src="../sdx/resources/xsl/xml.xsl">
                        <map:parameter name="action" value="{1}.xsp2file"/>
                        <map:parameter name="back" value="{1}.html"/>
                    </map:transform>
                    <map:serialize type="html"/>
                </map:match>
                <map:match pattern="**.xsp2java">
                    <map:generate type="file" src="xsp/{1}.xsp"/>
                    <map:transform src="resource://fr/gouv/culture/sdx/logicsheet/sdx.xsl"/>
                    <map:transform src="../sdx/resources/xsl/xml.xsl">
                        <map:parameter name="back" value="{1}.html"/>
                    </map:transform>
                    <map:serialize type="html"/>
                </map:match>
                <map:match pattern="**.xsp2javaX">
                    <map:generate type="file" src="xsp/{1}.xsp"/>
                    <map:transform src="resource://fr/gouv/culture/sdx/logicsheet/sdx.xsl"/>
                    <map:serialize type="text"/>
                </map:match>
                <map:match pattern="**.xsp2sdxX">
                    <map:generate type="xsp" src="xsp/{1}.xsp"/>
                    <map:serialize type="text"/>
                </map:match>
                <map:match pattern="**.xsp2sdx">
                    <map:generate type="xsp" src="xsp/{1}.xsp"/>
                    <map:transform src="../sdx/resources/xsl/xml.xsl">
                        <map:parameter name="back" value="{1}.html"/>
                    </map:transform>
                    <map:serialize type="html"/>
                </map:match>
                <map:match pattern="**.xsp2xslX">
                    <map:generate src="xsl/{1}.xsl" type="file"/>
                    <map:serialize type="text"/>
                </map:match>
                <map:match pattern="**.xsp2xsl">
                    <map:generate src="xsl/{1}.xsl" type="file"/>
                    <map:transform src="../sdx/resources/xsl/xml.xsl">
                        <map:parameter name="action" value="xsl/{1}.xsl2file"/>
                        <map:parameter name="back" value="{1}.html"/>
                    </map:transform>
                    <map:serialize type="html"/>
                </map:match>
                <map:match pattern="**.xsp2htmX">
                    <map:generate type="xsp" src="xsp/{1}.html"/>
                    <map:transform src="xsl/{1}.xsl">
                        <map:parameter name="use-request-parameters" value="true"/>
                    </map:transform>
                    <map:serialize type="text"/>
                </map:match>
                <map:match pattern="**.xsp2htm">
                    <map:generate type="xsp" src="xsp/{1}.xsp"/>
                    <map:transform src="xsl/{1}.xsl">
                        <map:parameter name="use-request-parameters" value="true"/>
                    </map:transform>
                    <map:transform src="../sdx/resources/xsl/xml.xsl">
                        <map:parameter name="back" value="{1}.html"/>
                    </map:transform>
                    <map:serialize type="html"/>
                </map:match>
            </map:act>
        </map:pipeline>

                <map:pipeline type="noncaching" internal-only="true">
                        <map:match pattern="extract-id.xml">
                                <map:generate type="xsp" src="xsp/extract-id.xsp"/>
                                <map:transform src="xsl/extract-id.xsl">
                                        <map:parameter name="use-request-parameters" value="true"/>
                                </map:transform>
                                <map:serialize type="xml"/>
                        </map:match>

			<map:match pattern="site-properties.xml">
				<map:generate type="file" src="site-properties.xml"/>
				<map:transform type="xinclude"/>
				<map:serialize type="xml"/>
			</map:match>

			<map:match pattern="extraction.xml">
                                <map:select type="resource-exists">
                                        <map:when test="{global:fs-doc}/{request-param:fichier}">
                                                <map:generate type="xsp" src="sdxlib/xsp/extraction-pdf.xsp">
                                                        <map:parameter name="fichier" value="{global:fs-doc}/{request-param:fichier}" />
						</map:generate>
                                                <map:serialize type="xml"/>
                                        </map:when>
					<map:otherwise>
					</map:otherwise>
                                </map:select>
			</map:match>

                </map:pipeline>

                <map:pipeline id="docs" type="caching">

                        <map:match pattern="pdf-exists/**.pdf">
                                <map:select type="resource-exists">
                                        <map:when test="{global:fs-pdf}/{1}.pdf">
                                                <map:generate type="file" src="statiques/200.xml"/>
                                                <map:serialize type="xml"/>
                                        </map:when>
                                </map:select>
                        </map:match>
                        <map:handle-errors>
                                <map:select type="exception">
                                        <map:when test="not-found">
                                                <map:generate type="file" src="cocoon:/{baselink:SitemapBaseLink}404.html" />
                                                <map:serialize type="xhtml" status-code="404" />
                                        </map:when>
                                        <map:otherwise>
                                                <map:generate type="file" src="cocoon:/{baselink:SitemapBaseLink}500.html" />
                                                <map:serialize type="xhtml" status-code="500"/>
                                        </map:otherwise>
                                </map:select>
                        </map:handle-errors>
                </map:pipeline>

        <map:pipeline type="noncaching">
	
            <!-- If no server redirection, a default welcome page  -->
            <map:match pattern="">
                <map:redirect-to uri="index.html"/>
            </map:match>
           

            <map:match pattern="login">
                <map:redirect-to uri="index.html"/>
            </map:match>


		<map:match pattern="panier.rtf">
			<map:generate src="xsp/exportpanier.xsp"/>
			<map:transform src="xsl/exportpanierRTF.xsl"/>
			<map:serialize type="fo2rtf"/>
		</map:match>


		<map:match pattern="panier.pdf2">
			<map:generate src="xsp/exportpanier.xsp"/>
			<map:transform src="xsl/exportpanierPDF.xsl">
				   <map:parameter name="use-request-parameters" value="true"/>
			</map:transform>
			<map:serialize type="fo2pdf"/>
		</map:match>

		<map:match pattern="panier2">
			<map:generate src="xsp/panier2.xsp"/>
			<map:serialize type="text"/>
		</map:match>

		<map:match pattern="panier">
			<map:generate src="xsp/panier2.xsp"/>
			<map:transform src="xsl/results2fo.xsl"/>
			<map:serialize type="text"/>
		</map:match>

		<map:match pattern="vuedoc">
			<map:generate src="xsp/document.xsp"/>
			
			<map:transform src="xsl/exportpanier.xsl">
				    <map:parameter name="use-request-parameters" value="true"/>
			</map:transform>
			
			<!--<map:transform src="xsl/exportpanier.xsl"/>-->
			<map:serialize/>
		</map:match>

		<map:match pattern="results.htm">
			<map:generate src="xsp/results.xsp"/>
			<map:transform src="xsl/exportpanier.xsl">
				   <map:parameter name="use-request-parameters" value="true"/>
			</map:transform>
			<map:serialize/>
		</map:match>

		<map:match pattern="results.pdf">
			<map:generate src="xsp/results.xsp"/>
			<map:transform src="xsl/exportpanierPDF.xsl">
				   <map:parameter name="use-request-parameters" value="true"/>
			</map:transform>
			<map:serialize type="fo2pdf"/>
		</map:match>

		<map:match pattern="texteintegral">
			<map:generate src="xsp/texteintegral.xsp"/>
			<map:transform src="xsl/results.xsl"/>
			<map:serialize/>
		</map:match>

		<map:match pattern="createmap.xml*">
				<!--<map:act type="copy-source" src="context:/pastel/google.xml{1}">-->
				<map:act type="copy-source" src="cocoon:/alldocs.xml">
					<map:parameter name="dest" value="sitemap.xml"/>
				</map:act>
			<map:generate src="xsp/createmap.xsp"/>
			<map:transform src="xsl/createmap.xsl">
				   <map:parameter name="use-request-parameters" value="true"/>
			</map:transform>
			<map:serialize/>
		</map:match>

		<map:match pattern="alldocs.xml">
			<map:generate src="xsp/results.xsp"/>
			<map:transform src="xsl/alldocs.xsl">
				   <map:parameter name="use-request-parameters" value="true"/>
			</map:transform>
			<map:serialize type="xml"/>
		</map:match>

			<!-- Admin directory - to include in each app that require Admin -->
			<map:match pattern="admin/**">
				<map:mount uri-prefix="" src="admin/admin.xmap" check-reload="yes" />
			</map:match>

			<map:match pattern="admin.xsp">
				<map:redirect-to uri="admin/admin.xsp" />
			</map:match>

 			<map:match pattern="suggest.html">
				<map:generate type="xsp" src="xsp/suggest.xsp">
					<map:parameter name="app" value="balise" />
					<map:parameter name="base" value="balise" />
					<!-- hpp configurable ? -->
					<!--<map:parameter name="hpp" value="30" />-->
					<map:parameter name="field" value="{request-param:field}" />
					<map:parameter name="value" value="{raw-request-param:value}" />
				</map:generate>
				<map:serialize type="text"/>
			</map:match>
			

		<map:match pattern="afficheindex.xsp">
			<map:generate type="xsp" src="xsp/afficheindex-lucene.xsp">
				<map:parameter name="base" value="notices" />
				<map:parameter name="app" value="cgpc" />
			</map:generate>
			<map:transform src="xsl/afficheindex-lucene.xsl"/>
			<map:serialize/>
		</map:match>

<!--
            <map:match pattern="rightcol.xsp">
                <map:generate type="xsp" src="xsp/rightcol.xsp"/>
		<map:serialize type="xml"/>
            </map:match>
-->
            <map:match pattern="searchQuery.xsp">
                <map:generate type="xsp" src="xsp/sdxQuery.xsp"/>
		<map:serialize type="xml"/>
            </map:match>

			
           <!-- General XSP processing with an XSLT stylesheet having the same name -->
	   <!--
            <map:match pattern="*.xsp">
                <map:generate type="xsp" src="{1}.xsp"/>
                <map:transform src="xsl/{1}.xsl">
                    <map:parameter name="use-request-parameters" value="true"/>
                </map:transform>
		<map:serialize type="xhtml"/>
            </map:match>
	    -->

        </map:pipeline>

	<!-- Internal pipelines -->
        <map:pipeline type="noncaching" internal-only="true">
            <map:match pattern="include/*.xsp">
                <map:generate type="xsp" src="include/{1}.xsp"/>
		<map:serialize type="xml"/>
            </map:match>
        </map:pipeline>
	
	<!-- Internal pipelines -->
        <map:pipeline type="noncaching" internal-only="true">

            <map:match pattern="xsl/*.xsl">
		<map:select type="resource-exists">
			<map:when test="xsl/{1}.xsl">
				<map:generate type="file" src="xsl/{1}.xsl"/>
			</map:when>
			<map:when test="sdxlib/xsl/{1}.xsl">
				<map:generate type="file" src="sdxlib/xsl/{1}.xsl"/>
			</map:when>
			<map:otherwise>
				 <map:redirect-to uri="cocoon:/xsl/skin.xsl"/>
			</map:otherwise>
		</map:select>
		<map:serialize type="xml"/>
            </map:match>

            <map:match pattern="*.xsp">
		<map:select type="resource-exists">
			<map:when test="xsp/{1}.xsp">
                		<map:generate type="xsp" src="xsp/{1}.xsp"/>
			</map:when>
			<map:when test="sdxlib/xsp/{1}.xsp">
                		<map:generate type="xsp" src="sdxlib/xsp/{1}.xsp"/>
			</map:when>
			<map:otherwise>
				<!-- TODO : sdxlib/xsp/notfound -->
                		<map:generate type="xsp" src="xsp/index.xsp"/>
			</map:otherwise>
		</map:select>
		<map:serialize type="xml"/>
            </map:match>

        </map:pipeline>


	    <!-- Readers and global matchers -->
        <map:pipeline type="noncaching">

	    <map:match pattern="test.test">
		    <map:generate type="file" src="Balise-0000001.xml"/>
		    <map:transform type="xsl" src="conf/index-balise.xsl"/>
		    <map:serialize type="xml"/>
	    </map:match>

		<!-- images -->
	    <map:match pattern="**.gif">
		<map:select type="resource-exists">
			<map:when test="{1}.gif">
				<map:read src="{1}.gif" mime-type="image/gif" />
			</map:when>
			<map:otherwise>
				<map:read src="sdxlib/{1}.gif" mime-type="image/gif" />
			</map:otherwise>
		</map:select>
	    </map:match>
	    <map:match pattern="**.png">
		<map:select type="resource-exists">
			<map:when test="{1}.png">
				<map:read src="{1}.png" mime-type="image/png" />
			</map:when>
			<map:otherwise>
				<map:read src="sdxlib/{1}.png" mime-type="image/png" />
			</map:otherwise>
		</map:select>
	    </map:match>
	    <map:match pattern="images/*.jpg">
		<map:select type="resource-exists">
			<map:when test="images/{1}.jpg">
				<map:read src="images/{1}.jpg" mime-type="image/jpg" />
			</map:when>
			<map:otherwise>
				<map:read src="sdxlib/images/{1}.jpg" mime-type="image/jpg" />
			</map:otherwise>
		</map:select>
	    </map:match>

		<!-- css -->
	    <map:match pattern="**.css">
		<map:select type="resource-exists">
			<map:when test="{1}.css">
				<map:read src="{1}.css" mime-type="text/css"/>
			</map:when>
			<map:otherwise>
				<map:read src="sdxlib/{1}.css" mime-type="text/css"/>
			</map:otherwise>
		</map:select>
	    </map:match>

		<!-- swf -->
	    <map:match pattern="**.swf">
		<map:select type="resource-exists">
			<map:when test="{1}.swf">
				<map:read src="{1}.swf" mime-type="application/x-shockwave-flash"/>
			</map:when>
			<map:otherwise>
				<map:read src="sdxlib/{1}.swf" mime-type="application/x-shockwave-flash"/>
			</map:otherwise>
		</map:select>
	    </map:match>

		<!-- javascript -->
	    <map:match pattern="**.js">
		<map:select type="resource-exists">
			<map:when test="{1}.js">
				<map:read src="{1}.js" mime-type="text/javascript"/>
			</map:when>
			<map:otherwise>
				<map:read src="sdxlib/{1}.js" mime-type="text/javascript"/>
			</map:otherwise>
		</map:select>
	    </map:match>

	    <map:match pattern="documents/*.pdf">
	    	<map:read src="documents/{1}.pdf" mime-type="application/pdf"/>
	    </map:match>

            <map:match pattern="mp3/*/*/*/*.mp3">
		<map:redirect-to uri="cocoon://documents/balise/{1}/{2}/{3}/{4}.mp3"/>
            </map:match>

            <map:match pattern="docs/*/*/*/*">
                <map:act type="xsp" src="xsp/checkUserPermission.xsp">
                        <map:parameter name="noticeId" value="{3}"/>
                        <map:redirect-to uri="cocoon://documents/balise/{../1}/{../2}/{../3}/{convert-encoding:{../4}}"/>
                </map:act>
            </map:match>
 
            <map:match pattern="recherche-avancee.html">
                <map:act type="xsp" src="xsp/userisLoggedIn.xsp">
                	<map:generate type="file" src="cocoon:/recherche-avancee.xsp"/>
			<map:transform type="xinclude"/>
			<map:transform type="xsl" src="cocoon:/xsl/recherche-avancee.xsl">
				<map:parameter name="use-request-parameters" value="true"/>
			</map:transform>
			<map:serialize type="html5"/>
                </map:act>
                <map:redirect-to uri="index.html"/>
            </map:match>

		<map:match pattern="ajoutepanier.txt">
			<map:generate type="file" src="cocoon:/ajoutepanier.xsp"/>
			<map:transform type="xsl" src="cocoon:/xsl/ajoutepanier.xsl"/>
			<map:serialize type="text"/>
		</map:match>

		<map:match pattern="document-acces-limite.html">
                	<map:generate type="file" src="cocoon:/document.xsp"/>
			<map:transform type="xinclude"/>
			<map:transform type="xsl" src="cocoon:/xsl/document.xsl">
				<map:parameter name="use-request-parameters" value="true"/>
			</map:transform>
			<map:serialize type="html5"/>
		</map:match>


		<!-- Process All .html pages -->

		<map:match pattern="*.html">
                	<map:generate type="file" src="cocoon:/{1}.xsp"/>
			<map:transform type="xinclude"/>
			<map:transform type="xsl" src="cocoon:/xsl/{1}.xsl">
				<map:parameter name="use-request-parameters" value="true"/>
			</map:transform>
			<map:serialize type="html5"/>
		</map:match>


        </map:pipeline>
    </map:pipelines>
</map:sitemap>

```

</details>


---

### 📄 `xsl/skin.xsl` [2.127 octets]
<a id="xsl-skin-xsl"></a> [↩ Retour à l'arborescence](#tree-xsl-skin-xsl)

> **Chemin relatif** : `xsl/skin.xsl`  
> **Taille** : 2.127 octets  
> **Lignes** : 59  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsl:stylesheet xmlns="http://www.w3.org/1999/xhtml"  version="1.0" 
	xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
	xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" 
 	xmlns:dir="http://apache.org/cocoon/directory/2.0"
	xmlns:xlink="http://www.w3.org/1999/xlink"
	xmlns:xi="http://www.w3.org/2001/XInclude"
	xmlns:exsl="http://exslt.org/common"
	exclude-result-prefixes="xsl sdx dir xlink xi exsl">

	<xsl:import href="../sdxlib/xsl/skin.xsl"/>

	<xsl:template name="titrepage">
		<div id="titrepage">
			<span><xsl:value-of select="$site-props//tete/titre"/></span>
			<div class="local-rightcolheader">
			<h2>
				<strong>BA</strong>se <strong>L</strong>égale <strong>I</strong>nformatisée pour la <strong>SE</strong>curité<br/>
				des remontées mécaniques<br/>
				et des transports guidés</h2>
			</div>
		</div>
	</xsl:template>

	<xsl:template name="local-process" mode="balise-search-type">
		<h2>local test</h2>
	</xsl:template>

</xsl:stylesheet>

```


---

### 📄 `xsp/actu.xsp` [2.061 octets]
<a id="xsp-actu-xsp"></a> [↩ Retour à l'arborescence](#tree-xsp-actu-xsp)

> **Chemin relatif** : `xsp/actu.xsp`  
> **Taille** : 2.061 octets  
> **Lignes** : 56  
> **Type** : text

```text
﻿<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" xmlns:xi="http://www.w3.org/2001/XInclude">
    <sdx:page>
        <title>Actualités</title>

	<contenu rightcol="false"/>


		<module type="liste" subtype="doc" field="OBJET_field" linkto="document.html" linktofield="sdxdocid" linktoname="id" dateField="DATE_MAJ_date" qref="balise">
			<query qid="balise">
				<xsp:logic>String query="sdxall:1";</xsp:logic>
			       <sdx:executeComplexQuery base="balise" sortField="DATE_MAJ_date" sortFieldParam="sort" sortOrder="descendant" sortOrderParam="order" hpp="10">
					<sdx:simpleQuery queryString="query"/>
				</sdx:executeComplexQuery>
			</query>
		</module>

<!--
	<includes>
		<xi:include href="cocoon:/site-properties.xml">
			<xi:fallback><nada>nada</nada></xi:fallback>
		</xi:include>
	</includes>
-->
    </sdx:page>
</xsp:page>

```


---

### 📄 `xsp/aide.xsp` [2.528 octets]
<a id="xsp-aide-xsp"></a> [↩ Retour à l'arborescence](#tree-xsp-aide-xsp)

> **Chemin relatif** : `xsp/aide.xsp`  
> **Taille** : 2.528 octets  
> **Lignes** : 58  
> **Type** : text

```text
﻿<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" xmlns:xi="http://www.w3.org/2001/XInclude">
    <sdx:page>
        <title>Aide pour les utilisateurs de BALISE</title>

	<contenu rightcol="false"/>
	
	<module type="contenu">

<img src="images/interface-balise.jpg" alt="Aperçu de l'interface" />

		<ol>
			<li><strong>Connexion : </strong>accès au portail d’authentification Cerbère pour "l’accès pro".</li>
			<li><strong>Aide : </strong>accès à la notice d’aide.</li>
			<li><strong>Aller au contenu : </strong></li>
			<li><strong>Historique des recherches : </strong>accès direct au contenu principal de la page.</li>
			<li><strong>Porte-documents : </strong>accès à la liste de toutes les recherches effectuées durant la session.</li>
			<li><strong>Imprimer la page : </strong>permet d’imprimer la page active.</li>
			<li><strong>Réduire et/ou agrandir : </strong>permet de modifier la taille des polices de texte de la page active.</li>
			<li><strong>Recherche : </strong>accès au formulaire de recherche dans la base de données BALISE.</li>
			<li><strong>Accueil : </strong>accès à la page d’accueil de BALISE.</li>
			<li><strong>Actualités : </strong>iste des derniers documents intégrés dans BALISE.</li>
		</ol>

	</module>

    </sdx:page>
</xsp:page>

```


---

### 📄 `xsp/checkUserPermission.xsp` [3.660 octets]
<a id="xsp-checkUserPermission-xsp"></a> [↩ Retour à l'arborescence](#tree-xsp-checkUserPermission-xsp)

> **Chemin relatif** : `xsp/checkUserPermission.xsp`  
> **Taille** : 3.660 octets  
> **Lignes** : 81  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx"
        xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xsp-sdxSecurity="http://portail.documentation.equipement.gouv.fr/ns/sdx/sdxSecurity"
>
    	<xsp:logicsheet location="sdxlib/conf/logicsheets/sdxSecurity.xsl"/>
                <xsp:logic>
              private org.apache.cocoon.environment.Redirector actionRedirector;
              private java.util.Map actionResultMap;
                </xsp:logic>
        <sdx:page>
        	<xsp-sdxSecurity:init/>

                <xsp:logic>

                        // initialisation des objets de retour de l'action
                        this.actionRedirector = (org.apache.cocoon.environment.Redirector) this.objectModel.get(org.apache.cocoon.acting.ServerPagesAction.REDIRECTOR_OBJECT);
                        this.actionResultMap = (java.util.Map) this.objectModel.get(org.apache.cocoon.acting.ServerPagesAction.ACTION_RESULT_OBJECT);

                        String noticeId=parameters.getParameter("noticeId", null);


                        String allowedBases = "balise_public";
                        if ( subject.isPermitted("balise:balise-diffusion:reseau") ){
                                allowedBases += " balise_strmtg";
                        }
                        if ( subject.isPermitted("balise:balise-diffusion:profession") ){
                                allowedBases += " balise_pro";
                        }
                        String[] bases = allowedBases.trim().split(" ");


                        // Recherche
                        <sdx:fieldQuery field="sdxdocid" valueString="noticeId" baseStrings="bases"/>
                        <sdx:results hpp="1"/>
                        org.apache.lucene.search.Hits h = sdx_results.getHits();


                        // On rends les paramètres passés
                        this.actionResultMap.put("noticeId", noticeId);

                        if (h.length()&gt;0){
                                // succès
                                this.objectModel.put(org.apache.cocoon.acting.ServerPagesAction.ACTION_SUCCESS_OBJECT, Boolean.TRUE);
                        }else{
                                // échec
                                this.objectModel.put(org.apache.cocoon.acting.ServerPagesAction.ACTION_SUCCESS_OBJECT, Boolean.FALSE);
                        }
                </xsp:logic>
        </sdx:page>
</xsp:page>


```


---

### 📄 `xsp/contacts.xsp` [1.655 octets]
<a id="xsp-contacts-xsp"></a> [↩ Retour à l'arborescence](#tree-xsp-contacts-xsp)

> **Chemin relatif** : `xsp/contacts.xsp`  
> **Taille** : 1.655 octets  
> **Lignes** : 47  
> **Type** : text

```text
﻿<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" xmlns:xi="http://www.w3.org/2001/XInclude">
    <sdx:page>
	<title>Contacts</title>

	<contenu rightcol="false" leftcol="true"/>
	
	<module type="contenu">

		<title>Contactez-nous</title>

		<p>Vous pouvez nous contacter par courriel en envoyant un message au <a href="mailto:webmestre.strmtg@developpement-durable.gouv.fr">webmestre</a>.</p>

	</module>

    </sdx:page>
</xsp:page>

```


---

### 📄 `xsp/document.xsp` [8.741 octets]
<a id="xsp-document-xsp"></a> [↩ Retour à l'arborescence](#tree-xsp-document-xsp)

> **Chemin relatif** : `xsp/document.xsp`  
> **Taille** : 8.741 octets  
> **Lignes** : 189  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (189 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx"
	xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xsp-sdxSecurity="http://portail.documentation.equipement.gouv.fr/ns/sdx/sdxSecurity"
>
    <xsp:logicsheet location="sdxlib/conf/logicsheets/sdxSecurity.xsl"/>
	<sdx:page>
    	<xsp-sdxSecurity:init/>
		<xsp:logic>
			String allowedBases = "balise_public";
			if ( subject.isPermitted("balise:balise-diffusion:reseau") ){
				allowedBases += " balise_strmtg";
			}
			if ( subject.isPermitted("balise:balise-diffusion:profession") ){
				allowedBases += " balise_pro";
			}
			String[] bases = allowedBases.trim().split(" ");

		</xsp:logic>
		<xsp:logic>
                        String lQuery = "";
                        String queryString = "";
                        String pageName = "";
                        String pageNumber = "";
                        String number = "";
                        int intNumber;

                        String getRequestId = (String)request.getParameter("requestId");
                        if (getRequestId!= null &amp;&amp; !"".equals(getRequestId)) {
                                Object attribute = session.getAttribute("requestId_"+getRequestId);
                                if (attribute!=null) {
                                        fr.gouv.equipement.documentation.search.RequestInfo requestInfo = (fr.gouv.equipement.documentation.search.RequestInfo) attribute;
                                        pageNumber = (String)request.getParameter("p");
                                        if (pageNumber == null || "".equals(pageNumber)) {
                                                pageNumber = "1";
                                        }
                                        number = (String)request.getParameter("number");
                                        if (number == null || "".equals(number)) {
                                                number = "1";
                                        }
                                        System.out.println("number : " + number);
                                        intNumber = Integer.parseInt(number);
                                        intNumber--;
                                        number = Integer.toString(intNumber);
                                        lQuery = requestInfo.getLuceneQuery();
                                        System.out.println("number - 1 : " + number);
                                        <sdx:executeComplexQuery baseStrings="bases" sortField="date" sortFieldParam="sort" startString="number" sortOrder="descendant" sortOrderParam="order" hpp="3">
                                                <sdx:simpleQuery queryString="lQuery"/>
                                        </sdx:executeComplexQuery>
                                        System.out.println("RequestId : " + getRequestId);
                                        System.out.println("LuceneQuery : " + lQuery);
                                        queryString = requestInfo.getQueryString();
                                        System.out.println("QueryString : " + queryString);
                                        pageName = requestInfo.getPageName();
                                        System.out.println("PageName : " + pageName);
                                }

                        }



			String getId = (String)request.getParameter("id");
			String[] a = null;
			if((getId==null) || ("".equals(getId))){
				getId = (String)parameters.getParameter("id","id");
			}
			<query qid="balise">
				<xsp:logic>
				<sdx:fieldQuery field="sdxdocid" valueString="getId" baseStrings="bases" docs="true"/>
				<sdx:results hpp="1"/>
				<sdx:show docs="true" hiliteParam="qid"/>
				</xsp:logic>
                                <request-info>
                                        <xsp:attribute name="qid"><xsp:expr>getRequestId</xsp:expr></xsp:attribute>
                                        <xsp:attribute name="luceneQuery"><xsp:expr>lQuery</xsp:expr></xsp:attribute>
                                        <xsp:attribute name="queryString"><xsp:expr>queryString</xsp:expr></xsp:attribute>
                                        <xsp:attribute name="pageName"><xsp:expr>pageName</xsp:expr></xsp:attribute>
                                </request-info>
			</query>

			<page-title qref="balise" field="OBJET_field"/>

			<menu name="menu-tools">
				<entry name="Panier" type="print">#</entry>
				<entry name="Panier" type="pplus">#</entry>
				<entry name="Panier" type="pmoins">#</entry>
			</menu>

			<title>Détail d'un document</title>

			<contenu rightcol="false"/>

			<module type="doc" qref="balise" addToBasket="true">
                                <pagination to="document.html"/>
                                <retour-resultats />

				<title qref="balise" field="OBJET_field"/>

				<line cols="1">
					<bloc>
						<entry type="search" field="ETAT_field" display="État" qref="balise">
							<link to="resultats.html">
								<param name="etats" value="ETAT_field" quote="true"/>
							</link>
						</entry>
						<entry type="search" field="TYPE_TEXTE_field" display="Type de texte" qref="balise">
							<link to="resultats.html">
								<param name="type_texte" value="TYPE_TEXTE_field" quote="true"/>
							</link>
						</entry>
						<entry type="docfield" process="date" name="DATE" display="Date du document"/>
						<entry type="search" field="DOMAINE_field" display="Domaine" qref="balise">
							<link to="resultats.html">
								<param name="domaine" value="DOMAINE_field" quote="true"/>
							</link>
						</entry>
						<entry type="search" field="SUJET_field" display="Sujet" qref="balise">
							<link to="resultats.html">
								<param name="sujets" value="SUJET_field" quote="true"/>
							</link>
						</entry>
						<entry type="docfield" name="REMPLACE" display="Remplace"/>
						<entry type="docfield" name="OBSERVATION" display="Observation"/>
						<entry type="docfield" name="DESCRIPTION" display="DESCRIPTION"/>
						<entry type="docfield" name="REFERENCE" display="Reference"/>
						<entry type="search" field="APPAREILS_field" display="Appareils" qref="balise">
							<link to="resultats.html">
								<param name="appareils" value="APPAREILS_field" quote="true"/>
							</link>
						</entry>
						<entry type="search" field="APPAREILS_RM_field" display="Appareils RM" qref="balise">
							<link to="resultats.html">
								<param name="appareils" value="APPAREILS_RM_field" quote="true"/>
							</link>
						</entry>
						<entry type="search" field="APPAREILS_TG_field" display="Appareils TG" qref="balise">
							<link to="resultats.html">
								<param name="appareils" value="APPAREILS_TG_field" quote="true"/>
							</link>
						</entry>
						<entry type="search" field="VEHICULES_field" display="Vehicules" qref="balise">
							<link to="resultats.html">
								<param name="vehicules" value="VEHICULES_field" quote="true"/>
							</link>
						</entry>
						<entry type="search" field="CONSTRUCTEURS_field" display="Constructeurs" qref="balise">
							<link to="resultats.html">
								<param name="constructeurs" value="CONSTRUCTEURS_field" quote="true"/>
							</link>
						</entry>
						<!--
						<entry type="docfield" name="DIFFUSION" display="Diffusion"/>
						-->
						<entry type="pjdocfield" name="DOCUMENT" display="Document(s)"/>
					</bloc>
				</line>
			</module>
		</xsp:logic>
	</sdx:page>
</xsp:page>

```

</details>


---

### 📄 `xsp/footer-menu.xsp` [1.944 octets]
<a id="xsp-footer-menu-xsp"></a> [↩ Retour à l'arborescence](#tree-xsp-footer-menu-xsp)

> **Chemin relatif** : `xsp/footer-menu.xsp`  
> **Taille** : 1.944 octets  
> **Lignes** : 50  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx"
	xmlns:xi="http://www.w3.org/2001/XInclude"
	xmlns:xsp-sdxSecurity="http://portail.documentation.equipement.gouv.fr/ns/sdx/sdxSecurity"
>
	<xsp:logicsheet location="sdxlib/conf/logicsheets/sdxSecurity.xsl"/>
	<xsp:structure>
		<xsp:include>fr.gouv.culture.sdx.search.lucene.DateField</xsp:include>
	</xsp:structure>
	<menu name="footer-menu">
		<xsp-sdxSecurity:init/>
		<section name="Recherche" link="recherche.html"/>
	<xsp:logic>
		if ( subject.isAuthenticated() ){
			<section name="Recherche avancée" link="recherche-avancee.html"/>
		}
	</xsp:logic>
		<copyright>© Ministère de l'Écologie, du Développement durable et de l'Énergie</copyright>
	</menu>
</xsp:page>

```


---

### 📄 `xsp/historique.xsp` [1.740 octets]
<a id="xsp-historique-xsp"></a> [↩ Retour à l'arborescence](#tree-xsp-historique-xsp)

> **Chemin relatif** : `xsp/historique.xsp`  
> **Taille** : 1.740 octets  
> **Lignes** : 52  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx">
    <sdx:page>
        <title>Historique des recherches</title>

		<contenu rightcol="false" leftcol="false"/>

	<xsp:logic>
		String action=request.getParameter("action");
		if( "vider".equals(action) ){
			session.removeAttribute("sdx_historic");
		}
	</xsp:logic>
	<sdx:showHistoric />

	<module type="historique" base="balise" linkto="resultats.html">
		<title>Recherches de documents</title>
	</module>
	<module type="vide-historique"/>
	
    </sdx:page>
</xsp:page>

```


---

### 📄 `xsp/index.xsp` [4.847 octets]
<a id="xsp-index-xsp"></a> [↩ Retour à l'arborescence](#tree-xsp-index-xsp)

> **Chemin relatif** : `xsp/index.xsp`  
> **Taille** : 4.847 octets  
> **Lignes** : 99  
> **Type** : text

```text
﻿<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xsp-sdxSecurity="http://portail.documentation.equipement.gouv.fr/ns/sdx/sdxSecurity">
    <xsp:logicsheet location="sdxlib/conf/logicsheets/sdxSecurity.xsl"/>
    <sdx:page>
    	<xsp-sdxSecurity:init/>


	<xsp:logic>
		<!--
		org.apache.shiro.subject.Subject currentUser = org.apache.shiro.SecurityUtils.getSubject();
		if (currentUser.isAuthenticated()){
		<menu name="connexion">
			<entry>
				<xsp:attribute name="name"><xsp:expr>currentUser.getPrincipal()</xsp:expr></xsp:attribute>
				#logout
			</entry>
		</menu>
		}
		-->
	</xsp:logic>


        <title>Accueil</title>

	<contenu rightcol="false"/>
	<module type="contenu">		
		<p>La base de données BALISE (<strong>BA</strong>se <strong>L</strong>égale <strong>I</strong>nformatisée pour la <strong>SÉ</strong>curité des remontées mécaniques et des transports guidés) recense l'ensemble des textes applicables aux remontées mécaniques, aux transports guidés et aux transports publics automatisés hors textes réglementaires pour lesquels Légifrance est le site officiel pour la diffusion des textes législatifs et réglementaires</p>
		<ul>
			<li><strong>BALISE - Accès libre </strong>Vous bénéficiez d'un accès libre par lequel vous pourrez consulter diverses règles techniques et de sécurité, certains guides d'application et autres documents du STRMTG</li>
			<li><strong>BALISE - Accès pro </strong>Si vous êtes un professionnel du secteur des remontées mécaniques ou des transports guidés, vous pouvez également bénéficier d’un accès sécurisé (avec identifiant et mot de passe) qui vous donnera accès, en plus des textes ci-dessus, aux circulaires, recommandations du STRMTG, etc. </li>
		</ul>
		<p class="warn"><strong>Note importante : </strong>Le STRMTG ne peut en aucun cas garantir l’exhaustivité des informations fournies dans la base de données BALISE, en particulier pour tous les textes n’émanant pas du STRMTG. <strong>La seule référence dans ce domaine étant les textes officiels dont la diffusion est assurée par le Journal Officiel.</strong></p>
	</module> 


	<module type="contenu">		
		<title>Annonce</title>
		<p class="warn">
		<strong>ATTENTION</strong> : le STRMTG effectue actuellement un toilettage de la base de données BALISE.
		Il est donc possible que, temporairement, certains textes soient inaccessibles.
		Nous mettons tout en œuvre pour que ces correctifs, ainsi que l'ajout des textes récents, soient effectifs dans les meilleurs délais.
		Nous vous remercions pour votre compréhension et votre patience. (le 26/10/2021)
		</p>
	</module>

		<module type="liste" subtype="doc" field="OBJET_field" linkto="document.html" linktofield="sdxdocid" linktoname="id" dateField="DATE_MAJ_date" qref="balise">
			<title>Actualités</title>
			<query qid="balise">
				<xsp:logic>
					//String query="sdxall:1";
					String query="PUB_ACTUS_field:|Oui|";
					String allowedBases = "balise_public";
					if ( subject.isPermitted("balise:balise-diffusion:reseau") ){
						allowedBases += " balise_strmtg";
					}
					if ( subject.isPermitted("balise:balise-diffusion:profession") ){
						allowedBases += " balise_pro";
					}
					String[] bases = allowedBases.trim().split(" ");

				</xsp:logic>
			       <sdx:executeComplexQuery baseStrings="bases" sortField="DATE_MAJ_date" sortFieldParam="sort" sortOrder="descendant" sortOrderParam="order" hpp="10">
					<sdx:simpleQuery queryString="query"/>
				</sdx:executeComplexQuery>
			</query>
		</module>

    </sdx:page>
</xsp:page>

```


---

### 📄 `xsp/menu-main.xsp` [1.886 octets]
<a id="xsp-menu-main-xsp"></a> [↩ Retour à l'arborescence](#tree-xsp-menu-main-xsp)

> **Chemin relatif** : `xsp/menu-main.xsp`  
> **Taille** : 1.886 octets  
> **Lignes** : 50  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx"
	xmlns:xi="http://www.w3.org/2001/XInclude"
	xmlns:xsp-sdxSecurity="http://portail.documentation.equipement.gouv.fr/ns/sdx/sdxSecurity"
>
	<xsp:logicsheet location="sdxlib/conf/logicsheets/sdxSecurity.xsl"/>
	<xsp:structure>
		<xsp:include>fr.gouv.culture.sdx.search.lucene.DateField</xsp:include>
	</xsp:structure>
	<menu name="menu-main">
		<entry name="Accueil">index.html</entry>
		<entry name="Recherche">recherche.html</entry>
		<xsp-sdxSecurity:init/>
		<xsp:logic>
			if ( subject.isAuthenticated() ){
				<entry name="Recherche avancée">recherche-avancee.html</entry>
			}
		</xsp:logic>
	</menu>
</xsp:page>

```


---

### 📄 `xsp/panier.xsp` [3.987 octets]
<a id="xsp-panier-xsp"></a> [↩ Retour à l'arborescence](#tree-xsp-panier-xsp)

> **Chemin relatif** : `xsp/panier.xsp`  
> **Taille** : 3.987 octets  
> **Lignes** : 121  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (121 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" xmlns:xsp-sdxSecurity="http://portail.documentation.equipement.gouv.fr/ns/sdx/sdxSecurity">
    <xsp:logicsheet location="sdxlib/conf/logicsheets/sdxSecurity.xsl"/>
    <sdx:page>
    	<xsp-sdxSecurity:init/>
        <title>Porte-documents</title>
	<xsp:logic>
		String allowedBases = "balise_public";
		if ( subject.isPermitted("balise:balise-diffusion:reseau") ){
			allowedBases += " balise_strmtg";
		}
		if ( subject.isPermitted("balise:balise-diffusion:profession") ){
			allowedBases += " balise_pro";
		}
		String[] bases = allowedBases.trim().split(" ");

	</xsp:logic>
	<xsp:logic>
		java.util.HashSet liste=(java.util.HashSet)session.getAttribute("panier");
			
		String action = request.getParameter("action");
		String boxesname = request.getParameter("boxesname");

		if("remove".equals(action) &amp;&amp; !"".equals(boxesname)){
			java.util.Enumeration e=request.getParameterNames();
			while(e.hasMoreElements()){
				Object obj=e.nextElement();
				if(obj instanceof String){
					String id=(String)obj;
					if(id.startsWith(boxesname)){
						String[] values=request.getParameterValues(id);
						for (int i=0 ; i&lt; values.length; i++){
							liste.remove(values[i]);			    
						}
					}
				}
			}
			session.setAttribute("panier",liste);
		
		}
		    
		   
		String query="";
		
//		java.util.HashSet liste=(java.util.HashSet)session.getAttribute("panier");
		if(liste!=null){
		
			java.util.Iterator i=liste.iterator();
			while(i.hasNext()){
				String id=(String)i.next();
				query+=" id:|"+id+"|";
			}
			
		}

		<contenu rightcol="false" leftcol="false"/>
		
		<query qid="basket">
			<sdx:executeComplexQuery queryParam="qid" baseStrings="bases" hpp="10">
				<sdx:simpleQuery queryString="query"/>
			</sdx:executeComplexQuery>
		</query>

		<module type="panier">
			<title>Documents</title>
			<context-tools boxesname="ids">
				<tool type="deleteSelected"/>
				<!--
				<tool type="printSelected"/>
				-->
				<tool type="sendSelected"/>
			</context-tools>
			<pagination type="next5" to="panier.html" qref="basket"/>
			<results linkto="document.html" type="table" qref="basket">
				<fields>
					<evenodd type="odd" class="odd"/>
					<field type="checkbox" display="" boxesname="ids"/>
					<field type="field" name="OBJET_field" display="Objet" sort="true"/>
					<field type="field" name="DOMAINE_field" display="Domaine" sort="true"/>
					<field type="field" name="TYPE_TEXTE_field" display="Type de texte" sort="true"/>
					<field type="field" name="DATE_date" display="Date du document" process="date"/>
				</fields>
			</results>
			<pagination type="next5" to="panier.html" qref="basket"/>
			<clear/>
		</module>
		
	</xsp:logic>
	
    </sdx:page>
</xsp:page>

```

</details>


---

### 📄 `xsp/recherche-avancee.xsp` [5.863 octets]
<a id="xsp-recherche-avancee-xsp"></a> [↩ Retour à l'arborescence](#tree-xsp-recherche-avancee-xsp)

> **Chemin relatif** : `xsp/recherche-avancee.xsp`  
> **Taille** : 5.863 octets  
> **Lignes** : 120  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (120 lignes) - Cliquer pour déplier</summary>

```text
﻿<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:pandoc="http://documentation.developpement-durable.gouv.fr/ns/pandoc" xmlns:xsp-sdxSecurity="http://portail.documentation.equipement.gouv.fr/ns/sdx/sdxSecurity">
	<xsp:logicsheet location="conf/logicsheets/sdxUtil.xsl"/>
	<xsp:logicsheet location="sdxlib/conf/logicsheets/sdxSecurity.xsl"/>
	<sdx:page>
	<xsp-sdxSecurity:init/>
        <title>Recherche</title>

	<xsp:logic>
		String allowedBases = "balise_public";
		if ( subject.isPermitted("balise:balise-diffusion:reseau") ){
			allowedBases += " balise_strmtg";
		}
		if ( subject.isPermitted("balise:balise-diffusion:profession") ){
			allowedBases += " balise_pro";
		}
		String[] bases = allowedBases.trim().split(" ");
	</xsp:logic>
	<!--
	<contenu rightcol="false"/>
	-->
	<contenu rightcol="false" leftcol="false"/>
	
		<module type="recherche" action="resultats.html" fill="true">
			<formline type="hidden" name="form" value="a"/>
			<formline type="text" name="recherche" display="Rechercher les mots suivants" suggest="true" indexType="shingle" andor="true">
				<suggest base="balise" index="string" quote="true" fieldSelector="type"/>
				<!--
				<suggest index="string" quote="true" suggestField="OBJET-DOCUMENT-content_mots" base="balise" fieldSelector="type"/>
				-->
			</formline>
			<formline type="radio" name="type" display="inline" class="balise-radio-type">
				<item display="Dans l'objet et dans le corps" value="OBJET-DOCUMENT-content_mots" id="objet-document"/>
				<item display="Uniquement dans l'objet" value="OBJET_mots" id="objet"/>
				<item display="Uniquement dans le corps" value="DOCUMENT-content_mots" id="document"/>
			</formline>
			<formline type="select" name="domaine" display="Domaine" optionfieldname="DOMAINE_field" optionfieldvalue="DOMAINE_field" quote="true" id="domaine">
				<sdx:terms baseStrings="bases" field="DOMAINE_field" hpp="-1" value="Remontées*mécaniques*et*Transports*guidés"/>
				<sdx:terms baseStrings="bases" field="DOMAINE_field" hpp="-1" value="Remontées*mécaniques*et*Transports*guidés" exclude="true"/>
				<!--
				<sdx:terms base="balise" field="DOMAINE_field" hpp="-1"/>
				-->
			</formline>
			<formline type="select" name="type_texte" display="Type de texte" optionfieldname="TYPE_TEXTE_field" optionfieldvalue="TYPE_TEXTE_field" quote="true" id="typedetexte">
				<sdx:terms baseStrings="bases" field="TYPE_TEXTE_field" hpp="-1"/>
			</formline>

			<xsp:logic>
				if ( subject.isPermitted("balise:balise-diffusion:profession") || subject.isPermitted("balise:balise-diffusion:reseau")  ){

					<formline type="select" name="sujets" display="Sujets" optionfieldname="SUJET_field" optionfieldvalue="SUJET_field" quote="true" id="appareils">
						<sdx:terms baseStrings="bases" field="SUJET_field" hpp="-1"/>
					</formline>
					<formline type="select" name="etats" display="États" optionfieldname="ETAT_field" optionfieldvalue="SUJETS_field" quote="true" id="etats">
						<sdx:terms baseStrings="bases" field="ETAT_field" hpp="-1"/>
					</formline>
					<formline type="select" name="appareils_rm" display="Appareils RM" optionfieldname="APPAREILS_RM_field" optionfieldvalue="APPAREILS_RM_field" quote="true" id="appareils">
						<sdx:terms baseStrings="bases" field="APPAREILS_RM_field" hpp="-1" value="Tous" exclude="true"/>
					</formline>
					<formline type="select" name="appareils_tg" display="Appareils TG" optionfieldname="APPAREILS_TG_field" optionfieldvalue="APPAREILS_TG_field" quote="true" id="appareils">
						<sdx:terms baseStrings="bases" field="APPAREILS_TG_field" hpp="-1" value="Tous" exclude="true"/>
					</formline>
					<formline type="select" name="vehicules" display="Vehicules" optionfieldname="VEHICULES_field" optionfieldvalue="VEHICULES_field" quote="true" id="vehicules">
						<sdx:terms baseStrings="bases" field="VEHICULES_field" hpp="-1" value="Tous" exclude="true"/>
					</formline>
					<formline type="select" name="constructeurs" display="Constructeurs" optionfieldname="CONSTRUCTEURS_field" optionfieldvalue="CONSTRUCTEURS_field" quote="true" id="vehicules">
						<sdx:terms baseStrings="bases" field="CONSTRUCTEURS_field" hpp="-1" value="Tous" exclude="true"/>
					</formline>
				}
			</xsp:logic>

			<formline type="date-range" name="date" display="Date du document" indexType="date" id="date"/>
		</module>

		<pandoc:test/>

		<break/>
		<space/>
		<break/>
		<space/>

<!--
	<includes>
		<xi:include href="cocoon:/site-properties.xml">
			<xi:fallback><nada>nada</nada></xi:fallback>
		</xi:include>
	</includes>
-->
    </sdx:page>
</xsp:page>

```

</details>


---

### 📄 `xsp/recherche.xsp` [4.116 octets]
<a id="xsp-recherche-xsp"></a> [↩ Retour à l'arborescence](#tree-xsp-recherche-xsp)

> **Chemin relatif** : `xsp/recherche.xsp`  
> **Taille** : 4.116 octets  
> **Lignes** : 97  
> **Type** : text

```text
﻿<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:pandoc="http://documentation.developpement-durable.gouv.fr/ns/pandoc" xmlns:xsp-sdxSecurity="http://portail.documentation.equipement.gouv.fr/ns/sdx/sdxSecurity">
	<xsp:logicsheet location="conf/logicsheets/sdxUtil.xsl"/>
	<xsp:logicsheet location="sdxlib/conf/logicsheets/sdxSecurity.xsl"/>
	<sdx:page>
	<xsp-sdxSecurity:init/>
        <title>Recherche</title>

	<xsp:logic>
		String allowedBases = "balise_public";
		if ( subject.isPermitted("balise:balise-diffusion:reseau") ){
			allowedBases += " balise_strmtg";
		}
		if ( subject.isPermitted("balise:balise-diffusion:profession") ){
			allowedBases += " balise_pro";
		}
		String[] bases = allowedBases.trim().split(" ");
	</xsp:logic>
	<!--
	<contenu rightcol="false"/>
	-->
	<contenu rightcol="false" leftcol="false"/>
	
		<module type="recherche" action="resultats.html" fill="true">
			<formline type="hidden" name="form" value="r"/>
			<formline type="text" name="recherche" display="Rechercher les mots suivants" suggest="true" indexType="shingle" andor="true">
				<suggest base="balise" index="string" quote="true" fieldSelector="type"/>
				<!--
				<suggest index="string" quote="true" suggestField="OBJET-DOCUMENT-content_mots" base="balise" fieldSelector="type"/>
				-->
			</formline>
			<formline type="radio" name="type" display="inline" class="balise-radio-type">
				<item display="Dans l'objet et dans le corps" value="OBJET-DOCUMENT-content_mots" id="objet-doc"/>
				<item display="Uniquement dans l'objet" value="OBJET_mots" id="objet"/>
				<item display="Uniquement dans le corps" value="DOCUMENT-content_mots" id="doc"/>
			</formline>
			<formline type="select" name="domaine" display="Domaine" optionfieldname="DOMAINE_field" optionfieldvalue="DOMAINE_field" quote="true" id="domaine">
				<sdx:terms baseStrings="bases" field="DOMAINE_field" hpp="-1" value="Remontées*mécaniques*et*Transports*guidés"/>
				<sdx:terms baseStrings="bases" field="DOMAINE_field" hpp="-1" value="Remontées*mécaniques*et*Transports*guidés" exclude="true"/>
				<!--
				<sdx:terms base="balise" field="DOMAINE_field" hpp="-1"/>
				<sdx:terms baseStrings="bases" field="DOMAINE_field" hpp="-1"/>
				-->
			</formline>
			<formline type="select" name="type_texte" display="Type de texte" optionfieldname="TYPE_TEXTE_field" optionfieldvalue="TYPE_TEXTE_field" quote="true" id="typedetexte">
				<sdx:terms baseStrings="bases" field="TYPE_TEXTE_field" hpp="-1"/>
			</formline>

			<formline type="date-range" name="date" display="Date du document" indexType="date" id="date"/>
		</module>

		<pandoc:test/>

		<break/>
		<space/>
		<break/>
		<space/>

<!--
	<includes>
		<xi:include href="cocoon:/site-properties.xml">
			<xi:fallback><nada>nada</nada></xi:fallback>
		</xi:include>
	</includes>
-->
    </sdx:page>
</xsp:page>

```


---

### 📄 `xsp/resultats.xsp` [10.034 octets]
<a id="xsp-resultats-xsp"></a> [↩ Retour à l'arborescence](#tree-xsp-resultats-xsp)

> **Chemin relatif** : `xsp/resultats.xsp`  
> **Taille** : 10.034 octets  
> **Lignes** : 255  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (255 lignes) - Cliquer pour déplier</summary>

```text
﻿<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xsp-sdxUtil="http://portail.documentation.equipement.gouv.fr/ns/sdx/sdxUtil" xmlns:xsp-sdxSecurity="http://portail.documentation.equipement.gouv.fr/ns/sdx/sdxSecurity" xmlns:xsp-sdxSearch="http://portail.documentation.equipement.gouv.fr/ns/sdx/sdxSearch">
<xsp:logicsheet location="conf/logicsheets/sdxUtil.xsl"/>
<xsp:logicsheet location="sdxlib/conf/logicsheets/sdxSecurity.xsl"/>
<xsp:logicsheet location="sdxlib/conf/logicsheets/sdxSearch.xsl"/>
	<xsp-sdxUtil:validateInputsFunctions/>
	<xsp-sdxUtil:queryProcessFunctions/>
	<sdx:page>
	<xsp-sdxSecurity:init/>
		<xsp:logic>
			String allowedBases = "balise_public";
			if ( subject.isPermitted("balise:balise-diffusion:reseau") ){
				allowedBases += " balise_strmtg";
			}
			if ( subject.isPermitted("balise:balise-diffusion:profession") ){
				allowedBases += " balise_pro";
			}
			String[] bases = allowedBases.trim().split(" ");

		</xsp:logic>
		<xsp:logic>
			String query=(String)request.getParameter("q");
			String contenu;
                        String operateur;
                        String op_champ;
                        String op_mots;
                        String expression;
			String date;

			if(query==null || query.equals("")){

				query="";

				// type (champ de recherche)
				String type=escapeParameter( (String)request.getParameter("type") );

				// recherche
				contenu=escapeParameter( addQuotesIfNoneExists( (String)request.getParameter("recherche")) );
				op_champ=(String)request.getParameter("op_champ_recherche");
				op_mots=(String)request.getParameter("op_mot_recherche");
				query+=traitement2(type,contenu,op_mots,op_champ);

				//query += contenu;


				// domaine
				contenu=escapeParameter( (String)request.getParameter("domaine") );
				op_champ=(String)request.getParameter("op_champ_domaine");
				op_mots=(String)request.getParameter("op_mot_domaine");
				if ("\"Remontées mécaniques et Transports guidés\"".equals(contenu)){
					query+=" +( (DOMAINE_field:|Remontées mécaniques|) (DOMAINE_field:|Transports guidés| ) (DOMAINE_field:|Remontées mécaniques et Transports guidés| ) )" ;
				} else {
					if ( !"".equals(contenu) ){
						query+=traitement2("DOMAINE_field",contenu,op_mots,op_champ);
						query+=" (DOMAINE_field:|Remontées mécaniques et Transports guidés| )" ;
					}
				}

				// Type de texte
				contenu=escapeParameter( (String)request.getParameter("type_texte") );
				op_champ=(String)request.getParameter("op_champ_type_texte");
				op_mots=(String)request.getParameter("op_mot_type_texte");
				query+=traitement2("TYPE_TEXTE_field",contenu,op_mots,op_champ);

				// Sujets
				contenu=escapeParameter( (String)request.getParameter("sujets") );
				op_champ=(String)request.getParameter("op_champ_type_sujets");
				op_mots=(String)request.getParameter("op_mot_type_sujets");
				query+=traitement2("SUJET_field",contenu,op_mots,op_champ);

				// Etats
				contenu=escapeParameter( (String)request.getParameter("etats") );
				op_champ=(String)request.getParameter("op_champ_type_etats");
				op_mots=(String)request.getParameter("op_mot_type_etats");
				query+=traitement2("ETAT_field",contenu,op_mots,op_champ);

				// Date
				String date_from = escapeParameter( (String)request.getParameter("date_from") );
				String date_to = escapeParameter( (String)request.getParameter("date_to") );
				op_champ=(String)request.getParameter("op_champ_date");
				if (!"".equals(date_from) || !"".equals(date_to)){
					query+=getDateInterval("DATE_date",op_champ, date_from, date_to);
				}


				// Appareils RM
				contenu=escapeParameter( (String)request.getParameter("appareils_rm") );
				if (! "".equals(contenu)){
					op_champ=(String)request.getParameter("op_champ_appareils_rm");
					op_mots=(String)request.getParameter("op_mot_appareils_rm");
					query+="(";
					query+=traitement2("APPAREILS_RM_field",contenu,op_mots,op_champ);
					query+="(APPAREILS_RM_field:|Tous| ) )" ;
				}

				// Appareils TG
				contenu=escapeParameter( (String)request.getParameter("appareils_tg") );
				if (! "".equals(contenu)){
					op_champ=(String)request.getParameter("op_champ_appareils_tg");
					op_mots=(String)request.getParameter("op_mot_appareils_tg");
					query+="(";
					query+=traitement2("APPAREILS_TG_field",contenu,op_mots,op_champ);
					query+="(APPAREILS_TG_field:|Tous| ) )" ;
				}

				// Vehicules
				contenu=escapeParameter( (String)request.getParameter("vehicules") );
				if (! "".equals(contenu)){
					op_champ=(String)request.getParameter("op_champ_vehicules");
					op_mots=(String)request.getParameter("op_mot_vehicules");
					query+="(";
					query+=traitement2("VEHICULES_field",contenu,op_mots,op_champ);
					query+="(VEHICULES_field:|Tous| ) )" ;
				}

				// Constructeurs
				contenu=escapeParameter( (String)request.getParameter("constructeurs") );
				if (! "".equals(contenu)){
					op_champ=(String)request.getParameter("op_champ_constructeurs");
					op_mots=(String)request.getParameter("op_mot_constructeurs");
					query+="(";
					query+=traitement2("CONSTRUCTEURS_field",contenu,op_mots,op_champ);
					query+="(CONSTRUCTEURS_field:|Tous| ) )" ;
				}



				contenu="";

				//if (query.equals("")){query="sdxall:1";}
				if (query.equals("")){query="";}

			}

			String securityQuery = " ( DIFFUSION_field:|PUBLIC| ) ";

			if ( subject.isPermitted("balise:balise-diffusion:reseau") ){
				securityQuery += " ( DIFFUSION_field:|STRMTG| ) ";
			}
			if ( subject.isPermitted("balise:balise-diffusion:profession") ){
				securityQuery += " (DIFFUSION_field:|PROFESSION|)";
			}

			query = "+(" + query +") +(" + securityQuery + ")";
			System.out.println(query);
		</xsp:logic>

		<query qid="docs">
			<xsp:expr>query</xsp:expr>
			<sdx:executeComplexQuery baseStrings="bases" sortField="DATE_MAJ_date" sortFieldParam="sort" sortOrder="ascendant" sortOrderParam="order" hpp="10" hppParam="hpp">
				<sdx:simpleQuery queryString="query"/>
			</sdx:executeComplexQuery>
			<xsp:logic>
				if(!query.equals("")){
					String queryString = request.getQueryString();
					<sdx:addToHistoric limit="100">
						<sdx:parameter name="qid" valueString="sdx_qid" />
						<sdx:parameter name="query" valueString="queryString" />
						<sdx:parameter name="base" value="balise" />
					</sdx:addToHistoric>
				}
			</xsp:logic>
			<xsp-sdxSearch:saveQuery>
				<query><xsp:expr>query</xsp:expr></query>
			</xsp-sdxSearch:saveQuery>
		</query>

		<title>Résultats de la recherche</title>

		<contenu rightcol="false" leftcol="true"/>

		<xsp:logic>
			String origin = "recherche.html";
			if ("a".equals((String)request.getParameter("form"))){
				origin = "recherche-avancee.html";
			}
		</xsp:logic>
		<leftcol>
			<context type="requête" subtype="url">
				<xsp:attribute name="search-form"><xsp:expr>origin</xsp:expr></xsp:attribute>
				<title>Termes de votre recherche</title>
				<param name="recherche" display="Texte"/>
				<param name="type" process="hidden"/>
				<param name="domaine" display="Domaines"/>
				<param name="type_texte" display="Type de texte"/>
				<param name="sujets" display="Sujets"/>
				<param name="etats" display="État"/>
				<param name="appareils_rm" display="Appareils RM"/>
				<param name="appareils_tg" display="Appareils TG"/>
				<param name="vehicules" display="Vehicules"/>
				<param name="constructeurs" display="Constructeurs"/>
				<param name="date_from" display="Date du document (depuis)" process="date"/>
				<param name="date_to" display="Date du document (jusque)" process="date"/>
			</context>
		</leftcol>

		<module type="résultats" basket="true">
			<context-tools boxesname="ids">
				<tool type="addToBasket"/>
				<!--
				<tool type="printSelected"/>
				-->
				<tool type="sendSelected"/>
			</context-tools>
			<pagination type="next5" hppSelector='true' to="resultats.html" qref="docs"/>

			<results linkto="document-acces-limite.html" type="table" qref="docs" conditionalLinkTo="document.html" conditionalField="DIFFUSION_field" conditionalValue="PUBLIC">
				<fields>
					<evenodd type="odd" class="odd"/>
					<field type="checkbox" display="" boxesname="ids"/>
					<field type="field" name="OBJET_field" display="Objet" sort="true"/>
					<!--
					<field type="field" name="DIFFUSION_field" display="DIFF" sort="true"/>
					-->
					<field type="field" name="DOMAINE_field" display="Domaine" sort="true"/>
					<field type="field" name="TYPE_TEXTE_field" display="Type de texte" sort="true"/>
					<field type="field" name="DATE_date" display="Date du document" process="date" sort="true"/>
				</fields>
			</results>
			<pagination type="next5" to="resultats.html" qref="docs"/>
			<clear/>
		</module>

    </sdx:page>
</xsp:page>

```

</details>


---

### 📄 `xsp/suggest.xsp` [23.894 octets]
<a id="xsp-suggest-xsp"></a> [↩ Retour à l'arborescence](#tree-xsp-suggest-xsp)

> **Chemin relatif** : `xsp/suggest.xsp`  
> **Taille** : 23.894 octets  
> **Lignes** : 734  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (734 lignes) - Cliquer pour déplier</summary>

```text
<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../../transform/xmldoc/xmldoc.xsl"?>
<!--
Notix
***************************************************

Titre        : Notix
Copyright    : © 2006 "Ministère des Transports", "AJLSM" <http://ajlsm.com>.
Licence      : "GPL" <http://www.gnu.org/copyleft/gpl.html>
Créateur     : [MP] Malo Pichot <malo.pichot@ajlsm.com>
Contributeur : [JC] Johan Cwiklinski <johan AT x-tnd DOT be>
Contributeur : [AD] André Davignon <andre.davignon@free.fr>

<license>

Notix : notices bibliographiques et d'autorités, dans une base XML.

Copyright (C) 2005 Ministère des Transports, AJLSM.

Ministère des Transports, de l'Équipement, du Tourisme et de la Mer (FRANCE),
    Centre d'Études Technique de l’Équipement Nord - Picardie (CETE Nord - Picardie),
    Point d'appui national documentaire (Pandoc),
    2 rue de Bruxelles – BP 275, 59019 LILLE Cedex, France.
AJLSM,
    17 rue Vital-Carles, 33000 Bordeaux, France

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html

</license>
--><!--


-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns="http://www.w3.org/1999/xhtml">

	<xsp:structure>
		<xsp:include>fr.gouv.culture.sdx.application.Application</xsp:include>
		<xsp:include>fr.gouv.culture.sdx.documentbase.DocumentBase</xsp:include>
		<xsp:include>fr.gouv.culture.sdx.documentbase.LuceneDocumentBase</xsp:include>
		<xsp:include>fr.gouv.culture.sdx.exception.SDXException</xsp:include>
		<xsp:include>fr.gouv.culture.sdx.framework.Framework</xsp:include>
		<xsp:include>fr.gouv.culture.sdx.framework.FrameworkImpl</xsp:include>
		<!-- utilisé pour reconnaître le type d'un champ date -->
		<xsp:include>fr.gouv.culture.sdx.search.lucene.Field</xsp:include>
		<xsp:include>java.text.Collator</xsp:include>
		<xsp:include>java.text.RuleBasedCollator</xsp:include>
		<xsp:include>java.util.Iterator</xsp:include>
		<xsp:include>java.util.ArrayList</xsp:include>
		<xsp:include>java.util.Collections</xsp:include>
		<xsp:include>java.util.Locale</xsp:include>
		<xsp:include>java.text.SimpleDateFormat</xsp:include>
		<xsp:include>org.apache.avalon.framework.parameters.ParameterException</xsp:include>
		<xsp:include>org.apache.avalon.framework.service.ServiceException</xsp:include>
		<xsp:include>org.apache.avalon.framework.service.ServiceManager</xsp:include>
		<xsp:include>org.apache.avalon.framework.service.WrapperServiceManager</xsp:include>
		<xsp:include>org.apache.commons.lang.StringUtils</xsp:include>
		<xsp:include>org.apache.commons.lang.StringEscapeUtils</xsp:include>
<!--
		<xsp:include>org.apache.lucene.analysis.ISOLatin1AccentFilter</xsp:include>
-->
		<xsp:include>org.apache.lucene.index.IndexReader</xsp:include>
		<xsp:include>org.apache.lucene.index.MultiReader</xsp:include>
		<xsp:include>org.apache.lucene.index.Term</xsp:include>
		<xsp:include>org.apache.lucene.index.TermEnum</xsp:include>
		<xsp:include>org.apache.lucene.index.TermDocs</xsp:include>
		<xsp:include>org.apache.lucene.search.WildcardTermEnum</xsp:include>
		<xsp:include>org.apache.lucene.document.Document</xsp:include>
		<xsp:include>org.apache.lucene.search.regex.RegexTermEnum</xsp:include>
		<xsp:include>org.apache.lucene.search.regex.RegexCapabilities</xsp:include>
		<xsp:include>org.apache.regexp.RE</xsp:include>
		<xsp:include>org.apache.regexp.RegexpTunnel</xsp:include>
		<xsp:include>org.apache.commons.lang.builder.CompareToBuilder</xsp:include>

		<xsp:include>org.apache.solr.util.BoundedTreeSet</xsp:include>
		<xsp:include>org.apache.shiro.SecurityUtils</xsp:include>
    <!--<xsp:include>org.pleade.utils.SuggestRegexpCapabilities</xsp:include>-->
	</xsp:structure>
	
<xsp:logic>

   public class EnumResult implements Comparable {
        String term;
        Integer freq;

        public EnumResult( String term, Integer freq ) {
            this.term = term;
            this.freq = freq;
        }

	public String getTerm(){
	    return term;
	}

	public Integer getFreq(){
	    return freq;
	}

	public boolean equals(Object o) {
		return (o instanceof EnumResult)
		&amp;&amp; (0 == this.compareTo( o));
	}

	public int compareTo(Object o) {
	EnumResult e = (EnumResult) o;
	int vc = e.freq.compareTo(freq);
	return (0 != vc ? vc : term.compareTo(e.term));
	} 

<!--
        public int compareTo(Object o) {
            if( o instanceof EnumResult ) {
                EnumResult oFreq = (EnumResult) o;
                return new CompareToBuilder( )
                    .append( freq, oFreq.freq )
                    .append( term, oFreq.term )
                    .toComparison( );
            } else {
                return 0;
            }
        }
-->
    }





public class SuggestRegexpCapabilities
		implements RegexCapabilities
{

	private RE regexp;
	boolean isEscaped;
	
	public SuggestRegexpCapabilities (boolean escaped){
		this.isEscaped = escaped;
	}
		
	public SuggestRegexpCapabilities (){
		this.isEscaped = false;
	}
		
	public void compile(String pattern) {
		if (isEscaped) {
			pattern = pattern.replace("(","\\u0028");
			pattern = pattern.replace(")","\\u0029");
			pattern = pattern.replace("$","\\u0024");
			pattern = pattern.replace("*","\\u002A");
			pattern = pattern.replace("+","\\u002B");
			pattern = pattern.replace(".","\\u002E");
			pattern = pattern.replace("/","\\u002F");
			pattern = pattern.replace("?","\\u003F");
			/* Ces caractères réservés aux regexp sont traités dans la classe buildRegexValue
			pattern = pattern.replace("[","\\u005B");
			pattern = pattern.replace("]","\\u005D");
			 */
			pattern = pattern.replace("{","\\u007B");
			pattern = pattern.replace("}","\\u007D");
		}
		
		regexp = new RE(pattern, RE.MATCH_CASEINDEPENDENT);
	}

	public boolean match(String string) {
		return regexp.match(string);
	}

	public String prefix() {
//		char[] prefix = RegexpTunnel.getPrefix(regexp);
//		return prefix == null ? null : new String(prefix);
		return null;
	}

	public boolean equals(Object o) {
		if (this == o) return true;
		if (o == null || getClass() != o.getClass()) return false;

		final SuggestRegexpCapabilities that = (SuggestRegexpCapabilities) o;

		if (regexp != null ? !regexp.equals(that.regexp) : that.regexp != null) return false;

		return true;
	}

	public int hashCode() {
		return (regexp != null ? regexp.hashCode() : 0);
	}

}



</xsp:logic>

	<xsp:logic><![CDATA[
		/** Application sdx, ne pas oublier de fixer au départ */
		Application sdxApp;
		/** timer */
		long start;
		/** un collator pour tri alphabétique */
		Collator collator;

		private Application sdxGetApp() throws ServiceException, SDXException {
			// Application au sens sdx, on plante s'il n'y a rien de fourni par le sitemap
			String app = parameters.getParameter("app", request.getParameter("app"));
			//String app = "cataloguecdu";
			
			ServiceManager cocoon_serviceManager = new WrapperServiceManager(manager);
			FrameworkImpl sdx_frame = (FrameworkImpl) cocoon_serviceManager.lookup(Framework.ROLE);
			return sdx_frame.getApplicationByPath(app);
		}

		
		/* Récupération et sauvegarde d'un indexReader Lucene
		Ceci est mis en objet de contexte pour que d'ailleurs on puisse supprimer l'objet 
		(mise à jour de la liste de termes après suppression ou ajout de document)
		*/
		private IndexReader getIndexReader(String base, boolean recycle) throws ServiceException, SDXException {
			// le reader lucene à renvoyer
			IndexReader indexReader=null;
			
			DocumentBase sdx_base = sdxApp.getDocumentBase(base);
			//DEBUG System.out.println(sdx_base);
			fr.gouv.culture.sdx.search.lucene.query.LuceneIndex sdxLuc=((LuceneDocumentBase)sdx_base).getLuceneIndex();
			// Ici 60ms
			indexReader = sdxLuc.getReader();
			// on remet en contexte
			// context.setAttribute("suggestReaders", suggestReaders);
			//DEBUG System.out.println("[suggest] ouverture de "+indexReader.directory()+ " en "+(System.currentTimeMillis() - start)+" ms");
			return indexReader;
		}

		private MultiReader getMultiReader(String[] bases) throws ServiceException, SDXException, IOException  {

			// le reader lucene à renvoyer
			MultiReader multiReader=null;
			IndexReader[] readers = new IndexReader[bases.length];
			for( int i=0; i<bases.length; i++){
				readers[i] = getIndexReader(bases[i],true);
			}
			multiReader = new MultiReader(readers);
			return multiReader;
			
		}

		private String getSdxFieldType(String base, String field) throws ServiceException, IOException, SDXException {
			if (field == null) return null;
			DocumentBase sdx_base = sdxApp.getDocumentBase(base);
			Field sdxField=((LuceneDocumentBase)sdx_base).getIndex().getField(field);
			if(sdxField == null) return null;
			return sdxField.getTypeName();
		}


  /** Retourne l'expression reguliere correspondante de maniere a ne pas tenir
   * compte des accents
   * Boucle sur les caracteres de la String. Pour chaque caractere, on cree une
   * "Character class" composee de l'ensemble de ses declinaisons en minuscules :
   * caractere non accentue plus caractere(s) accentue(s).
   * On ne renvoie que des minuscules car on utilise la classe
   * org.pleade.utils.SuggestRegexCapabilities qui cree une expression reguliere
   * (org.apache.regexp.RE) insensible a la casse.
   */
  public static String buildRegexValue(String s)
  {
    return buildRegexValue( s, "ISO-8859-1", true );
  }
  public static String buildRegexValue(String s, boolean lazy)
  {
    return buildRegexValue( s, "ISO-8859-1", lazy);
  }
  public static String buildRegexValue(String s, String enc, boolean lazy)
  {

    String ret = s;
    try
    {

      if ( !enc.equals("ISO-8859-1") )
      {
        // DEBUG System.out.println("[PLEADE][SUGGEST] Erreur dans buildRegexValue avec s:"+s+" enc:"+enc+" : encodage non supporte !" );
      }
      else if ( enc.equals("ISO-8859-1") )
      {

        int l = s.length();
        StringBuffer chars = new StringBuffer( l );
        for ( int i = 0; i < l; i++ )
        {
		char c = s.charAt(i);
		switch (c) {
			/* NOTE (MP) : on echappe pas les caracteres reserves en
			* expression reguliere. on estime que ce qui vient est une
			* expression reguliere correcte. */
			// case '\u0028': // "("
			// case '\u0029': // ")"
			// case '\u002A': // "*"
			// case '\u002B': // "+"
			// case '\u002E': // "."
			// case '\\': // "\"
			    
			// [AD] on échappe ici les caractères "[" et "]"
			//les autres caractères réservés aux regexp (sauf "^" ), que l'on considère ici comme le seul pertinent,
			//sont traités dans la classe SuggestRegexpCapabilities
			case '\u005B':
				chars.append("\\u005B");
				break;
			case '\u005D':
				chars.append("\\u005D");
				break;
			// case '\u005E': // "^"
			// case '\u007B': // "{"
			// case '\u007C': // "|"
			// case '\u007D': // "}"
			//   chars.append("\\"+c); // caracteres reserves en expression reguliere
			//   break;
			case ' ':
			case '-':
			case ',':
			case '\'':
			case '.':
			case ':':
			case ';':
				chars.append("[\u0020\\\u002D\u002C\u002E\u003A\u003B\u0027]");
				//Les espaces doivent rester optionnels dans le suggest pour pouvoir accéder à tout les termes.
				if(lazy){chars.append("?");}
				break;
			case 'A':
			case '\u00C0':
			case '\u00C1':
			case '\u00C2':
			case '\u00C3':
			case '\u00C4':
			case '\u00C5':
			case 'a':
			case '\u00E0':
			case '\u00E1':
			case '\u00E2':
			case '\u00E3':
			case '\u00E4':
			case '\u00E5':
				chars.append("[A\u00C0\u00C1\u00C2\u00C3\u00C4\u00C5a\u00E0\u00E1\u00E2\u00E3\u00E4\u00E5]");
				break;
			case '\u00C6': // AE ligature
			case '\u00E6': // ae ligature
				//chars.append("((AE)|\u00E6)");
				break;
			case 'C':
			case '\u00C7':
			case 'c':
			case '\u00E7':
				chars.append("[C\u00C7c\u00E7]");
				break;
			case 'E':
			case '\u00C8':
			case '\u00C9':
			case '\u00CA':
			case '\u00CB':
			case 'e':
			case '\u00E8':
			case '\u00E9':
			case '\u00EA':
			case '\u00EB':
				chars.append("[E\u00C8\u00C9\u00CA\u00CBe\u00E8\u00E9\u00EA\u00EB]");
				break;
			case 'I':
			case '\u00CC':
			case '\u00CD':
			case '\u00CE':
			case '\u00CF':
			case 'i':
			case '\u00EC':
			case '\u00ED':
			case '\u00EE':
			case '\u00EF':
				chars.append("[I\u00CC\u00CD\u00CE\u00CFi\u00EC\u00ED\u00EE\u00EF]");
				break;
			case 'D':
			case '\u00D0':
			case 'd':
			case '\u00F0':
				chars.append("[D\u00D0d\u00F0]");
				break;
			case 'N':
			case '\u00D1':
			case 'n':
			case '\u00F1':
				chars.append("[N\u00D1n\u00F1]");
				break;
			case 'O':
			case '\u00D2':
			case '\u00D3':
			case '\u00D4':
			case '\u00D5':
			case '\u00D6':
			case '\u00D8':
			case 'o':
			case '\u00F2':
			case '\u00F3':
			case '\u00F4':
			case '\u00F5':
			case '\u00F6':
			case '\u00F8':
				chars.append("[O\u00D2\u00D3\u00D4\u00D5\u00D6\u00D8o\u00F2\u00F3\u00F4\u00F5\u00F6\u00F8]");
				break;
			case '\u0152':
			case '\u0153':
				chars.append("((oe)|\u0153)");
				break;
			case '\u00DE':
			case '\u00FE':
				chars.append("((th)|\u00FE)");
				break;
			case 'U':
			case '\u00D9':
			case '\u00DA':
			case '\u00DB':
			case '\u00DC':
			case 'u':
			case '\u00F9':
			case '\u00FA':
			case '\u00FB':
			case '\u00FC':
				chars.append("[U\u00D9\u00DA\u00DB\u00DCu\u00F9\u00FA\u00FB\u00FC]");
				break;
			case 'Y':
			case '\u00DD':
			case '\u0178':
			case 'y':
			case '\u00FD':
			case '\u00FF':
				chars.append("[Y\u00DD\u0178y\u00FD\u00FF]");
				break;
			case '\u00DF':
				chars.append("((ss)|"+c+")");
				break;
			default:
				chars.append( "["+Character.toUpperCase(c)+Character.toLowerCase(c)+"]" );
				break;
		}

				if(lazy){chars.append(" ?");}
        }

        ret = chars.toString();
	//DEBUG System.out.println("exp : "+ret);

      }

    } catch(Exception e) {
       // DEBUG System.out.println("[PLEADE][SUGGEST] Erreur dans buildRegexValue avec s:"+s+" enc:"+enc+" : "+e );
    } finally {
      // DEBUG System.out.println("[PLEADE][SUGGEST] Pour s:"+s+" enc:"+enc+" retourne:"+ret );
      return ret;
    }

  }

		
]]></xsp:logic>
<xsp:logic>
<!--
public String removeEmptyWords(String words){

	words = words.trim();
	String cleaned = words;

	String[] suffixes={" à la", " aux"," au", " de", " du", " d", " l"};

	for(int i=0; i&lt;suffixes.length; i++){
		if (words.endsWith(suffixes[i])){
			cleaned=new String( words.substring(0, words.length() - suffixes[i].length()) );
		}
	}
	return cleaned;
}
-->
</xsp:logic>

	<pre><xsp:logic>

			<!-- 
			I - Initialisation des variables et Traitement des paramètres
			--> 

			int limit = Integer.parseInt(request.getParameter("limit"));
			BoundedTreeSet queue = new BoundedTreeSet(limit);
			boolean isEscaped = true;
			SuggestRegexpCapabilities src = new SuggestRegexpCapabilities(isEscaped);

			<!-- objet application SDX à partager -->
			try {
				sdxApp = sdxGetApp();
			} catch (Exception e) {
				throw new ProcessingException(e);
			}
			ArrayList liste = new ArrayList();
			String separator="|";
			String base = parameters.getParameter("base", request.getParameter("base"));
			String recycleParam = parameters.getParameter("recycle", (String)request.getParameter("recycle"));
			boolean recycle=false;
			if (recycleParam !=  null &amp;&amp; !"".equals(recycleParam)) recycle=true;
			String defaultField=null;
			String quote = (String)request.getParameter("quote");
			String shingle = (String)request.getParameter("shingle");
			String field = request.getParameter("field");
			String json = request.getParameter("json");
			String firstValue = "";

						
			String value = "";
			value = (String)request.getParameter("q");

			//DEBUG System.out.println(value);

			if ( ! value.trim().equals("") ){

				
				// On traite la requête selon le type d'index interrogé

				if (quote != null &amp;&amp; "true".equals(quote)) {
					if (value.lastIndexOf("\"") != -1) {
						firstValue = value.substring(0,value.lastIndexOf("\"")+2);
						value = value.substring(value.lastIndexOf("\"")+2);
					}
				}
				else if (shingle != null &amp;&amp; "true".equals(shingle)){
					value=value;
				}
				else {
					if (value.lastIndexOf(" ") != -1) {
						firstValue = value.substring(0,value.lastIndexOf(" ")+1);
						value = value.substring(value.lastIndexOf(" ")+1);
					}
				}

				String[] bases = null;
				if("balise".equals(base)){
					org.apache.shiro.subject.Subject subject = org.apache.shiro.SecurityUtils.getSubject();
					String allowedBases = "balise_public";
					if ( subject.isPermitted("balise:balise-diffusion:reseau") ){
						allowedBases += " balise_strmtg";
					}
					if ( subject.isPermitted("balise:balise-diffusion:profession") ){
						allowedBases += " balise_pro";
					}
					bases = allowedBases.trim().split(" ");
					base="balise_public";
				}

				IndexReader luceneReader =  null;
				try {
					if(bases.length == 1) {
						luceneReader=getIndexReader(bases[0], recycle);
					}else{
						luceneReader=(IndexReader)getMultiReader(bases);
					}
				}
				catch (Exception e) {
					throw new ProcessingException(e);
				}
				<!-- Le type du champ, surtout pour les champs date, - de 10ms -->
				String type;
				try {
					type=getSdxFieldType(base, field);
				} catch (Exception e) {
					throw new ProcessingException(e);
				}
				// encoder la valeur cherchée en cas de date
				if("date".equals(type)) {
					//DEBUG System.out.println("value : "+value);
					// Pour plus de sûreté, on n'autorise que les chiffres; les "-" sont rajoutés ci-dessous
					value = value.replaceAll("\\D","");
					// on n'autorise pas les valeurs vides
					if ("".equals(value)) value += "1";
					// pour éviter l'exception java.lang.RuntimeException: time too early
					if ("0".equals(value)) value = "1";
					// on complète à 4 caractères pour que le suggest soit pertinent dès la saisie du 1er caractère
					if (value.length() == 1) value += "000";
					else if (value.length() == 2) value += "00";
					else if (value.length() == 3) value += "0";
					// les "-" ont été supprimés par value = value.replaceAll("\\D",""), on les réintroduit
					else if (value.length() == 5) value = value.substring(0,4) +"-" + value.substring(4,5);
					else if (value.length() == 6) value = value.substring(0,4) +"-" + value.substring(4,6);
					else if (value.length() == 7) value = value.substring(0,4) +"-" + value.substring(4,6) + "-" + value.substring(6,7);
					else if (value.length() &gt;= 8) value = value.substring(0,4) +"-" + value.substring(4,6) + "-" + value.substring(6,8);
					//DEBUG System.out.println("length : "+value.length());
					//DEBUG System.out.println("substring : "+value.substring(4,value.length()));
					//DEBUG System.out.println("indexOf : "+value.substring(4,value.length()).indexOf("-"));
					Date date=fr.gouv.culture.sdx.utils.Date.parseDate(value);
					if (date== null) value="";
					else value=fr.gouv.culture.sdx.search.lucene.DateField.dateToString(date);
				}


				<!-- 
				II - On interroge l'index : On ne récupère que les termes pertinents			
				-->

		Term term=new Term(field, value);
		TermEnum tenum;


		String convert = "^"+buildRegexValue(value);
		//DEBUG System.out.println(convert);
		RE r = new RE(convert);
		
		String strictConvert = "^"+buildRegexValue(value, false);
		RE r2 = new RE(strictConvert);

		tenum=luceneReader.terms(term);

		int i=0;
		while (true) {

			Term theTerm = tenum.term();
			if (theTerm==null ) break;
			String indexedText = theTerm.text();

			// stop if the prefix doesn't match
			if (value != null &amp;&amp; ! r.match(indexedText) ){
				//DEBUG System.out.println(indexedText + " " +  r.match(indexedText));
				//DEBUG tenum.next();
				//DEBUG System.out.println(tenum.term().text());
				
				 break;
			}
		    

			int docFreq = tenum.docFreq();
			String label = indexedText;

			if (r2.match(indexedText) ){
			queue.add(new EnumResult( label, new Integer(docFreq) ));
			//DEBUG System.out.println("ADD : " + label);
			}


			i++;
			tenum.next();
		}
		tenum.close();




		// Copie des items	
		i=0;
		for (Iterator it = queue.iterator(); it.hasNext();){
			      if (i &lt; limit) {
				EnumResult item = (EnumResult)it.next();
				liste.add(item);
				i++;
			      } else {
				break;
			      }
			}
		queue=null;


		<!--
			Affichage des Résultats 
		-->

		Iterator it = liste.iterator();
		int ii=0;
		if (json!=null &amp;&amp; "true".equals(json)){
			firstValue=firstValue.replace("\"","\\\"");
			<xsp:content>[</xsp:content>
                        while ( it.hasNext() &amp;&amp; ii &lt; limit) {
                                EnumResult result=(EnumResult)it.next();
                                String terme = (String)result.getTerm();
                                //terme = removeEmptyWords( (String)result.getTerm() );
                                String freq = String.valueOf(  result.getFreq() );
                                if (quote != null &amp;&amp; "true".equals(quote)) {
					<!--
                                	<xsp:content>{term:<xsp:expr>" \""+terme+"\""</xsp:expr>,freq:<xsp:expr>freq</xsp:expr>,firstValue:<xsp:expr>firstValue+"\""+terme+"\""</xsp:expr>,id:id}</xsp:content>
                                	<xsp:content>{label:"\"<xsp:expr>terme</xsp:expr>\" (<xsp:expr>freq</xsp:expr>)",value:"\"<xsp:expr>terme</xsp:expr>\""}</xsp:content>
					-->
                                	<xsp:content>{"term":"\"<xsp:expr>terme</xsp:expr>\"","freq":"<xsp:expr>freq</xsp:expr>","firstValue":"<xsp:expr>firstValue</xsp:expr>\"<xsp:expr>terme</xsp:expr>\"","id":"id"}</xsp:content>
                                }else {
					<!--
                                	<xsp:content>{term:<xsp:expr>terme</xsp:expr>,freq:<xsp:expr>freq</xsp:expr>,firstValue:<xsp:expr>firstValue+terme</xsp:expr>,id:id}</xsp:content>
                                	<xsp:content>{label:"<xsp:expr>terme</xsp:expr> (<xsp:expr>freq</xsp:expr>)",value:"<xsp:expr>terme</xsp:expr>"}</xsp:content>
					-->
                                	<xsp:content>{"term":"<xsp:expr>terme</xsp:expr>","freq":"<xsp:expr>freq</xsp:expr>","firstValue":"<xsp:expr>firstValue+terme</xsp:expr>","id":"id"}</xsp:content>
                                }
                                //DEBUG System.out.println("terme : " + terme);
                                ii++;
				if (it.hasNext() &amp;&amp; ii &lt; limit){<xsp:content>,<xsp:expr>"\n"</xsp:expr></xsp:content>}
                        }
			<xsp:content>]</xsp:content>
		}else{
			while ( it.hasNext() &amp;&amp; ii &lt; limit) {
				EnumResult result=(EnumResult)it.next();	
				String terme = (String)result.getTerm();
				//terme = removeEmptyWords( (String)result.getTerm() );
				String freq = String.valueOf(  result.getFreq() );
				if (quote != null &amp;&amp; "true".equals(quote)) {
				<xsp:content><xsp:expr>" \""+terme+"\""+separator+freq+separator+firstValue+"\""+terme+"\" "+separator+"id"+"\n"</xsp:expr></xsp:content>
				}else {
				<xsp:content><xsp:expr>terme+" "+separator+freq+separator+firstValue+terme+" "+separator+"id"+"\n"</xsp:expr></xsp:content>	
				}
				//DEBUG System.out.println("terme : " + terme);
				ii++;
			}
		}
		liste=null;




			}


		</xsp:logic>
	</pre>
</xsp:page>

```

</details>


---

### 📄 `xsp/userisLoggedIn.xsp` [2.690 octets]
<a id="xsp-userisLoggedIn-xsp"></a> [↩ Retour à l'arborescence](#tree-xsp-userisLoggedIn-xsp)

> **Chemin relatif** : `xsp/userisLoggedIn.xsp`  
> **Taille** : 2.690 octets  
> **Lignes** : 59  
> **Type** : text

```text
<?xml version="1.0" encoding="UTF-8"?>
<!--
SDX: Documentary System in XML.
Copyright (C) 2000, 2001, 2002  Ministere de la culture et de la communication (France), AJLSM

Ministere de la culture et de la communication,
Mission de la recherche et de la technologie
3 rue de Valois, 75042 Paris Cedex 01 (France)
mrt@culture.fr, michel.bottin@culture.fr

AJLSM, 17, rue Vital Carles, 33000 Bordeaux (France)
sevigny@ajlsm.com

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the
Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
or connect to:
http://www.fsf.org/copyleft/gpl.html
-->
<xsp:page language="java" xmlns:xsp="http://apache.org/xsp" xmlns:sdx="http://www.culture.gouv.fr/ns/sdx/sdx"
        xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xsp-sdxSecurity="http://portail.documentation.equipement.gouv.fr/ns/sdx/sdxSecurity"
>
    	<xsp:logicsheet location="sdxlib/conf/logicsheets/sdxSecurity.xsl"/>
                <xsp:logic>
              private org.apache.cocoon.environment.Redirector actionRedirector;
              private java.util.Map actionResultMap;
                </xsp:logic>
        <sdx:page>
        	<xsp-sdxSecurity:init/>

                <xsp:logic>

                        // initialisation des objets de retour de l'action
                        this.actionRedirector = (org.apache.cocoon.environment.Redirector) this.objectModel.get(org.apache.cocoon.acting.ServerPagesAction.REDIRECTOR_OBJECT);
                        this.actionResultMap = (java.util.Map) this.objectModel.get(org.apache.cocoon.acting.ServerPagesAction.ACTION_RESULT_OBJECT);

                        if ( subject.isAuthenticated() ){
                                // succès
                                this.objectModel.put(org.apache.cocoon.acting.ServerPagesAction.ACTION_SUCCESS_OBJECT, Boolean.TRUE);
                        }else{
                                // échec
                                this.objectModel.put(org.apache.cocoon.acting.ServerPagesAction.ACTION_SUCCESS_OBJECT, Boolean.FALSE);
                        }
                </xsp:logic>
        </sdx:page>
</xsp:page>


```


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

````

</details>


---

### 📄 `si/causalis.wiki.md` [4.649 octets]
<a id="si-causalis-wiki-md"></a> [↩ Retour à l'arborescence](#tree-si-causalis-wiki-md)

> **Chemin relatif** : `si/causalis.wiki.md`  
> **Taille** : 4.649 octets  
> **Lignes** : 178  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (178 lignes) - Cliquer pour déplier</summary>

````markdown
﻿# Projet : causalis.wiki

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\causalis.wiki`

**Fichiers** : 1 fichiers non-binaires

## 📁 Arborescence des fichiers

└── <a id="tree-home-md"></a>[home.md](#home-md) *(670 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `home.md` [670 octets]
<a id="home-md"></a> [↩ Retour à l'arborescence](#tree-home-md)

> **Chemin relatif** : `home.md`  
> **Taille** : 670 octets  
> **Lignes** : 9  
> **Type** : markdown

```markdown
# Application de gestion des accidents du travail

## Membres

**Managers :** Adrien DESSARTRE, Anthony BOULOY, Anthony MEAUZOONE, Antoine DUBOIS, Christian ARBOGAST, Jeanne VODUNGBO, Julien GARDIN, Nicolas DEMEY

**Développeurs :** Ayoub CHAKHITE, Cédric CHAPE, Florian GARCIA, Grégoire GUITTET, Hervé MARCHAL, Jenkins CAUSALIS, Marc KANAAN, Maxime Careil, Pascal FORHAN, Songul YESILMEN, Vincent JUSTIN

**Rapporteurs :** Chantal CURBET, Christophe LOUVARD, Erwan SALMON, Farmin YARIRAD, Florent CAPPON, Geoffrey ARTHAUD, jenkins robot, Khalid MOKHTARI, Michel GIBELLI, Pascal BASTIEN, Patrick DOS SANTOS, Redouane RABBAH, Sarah MARAIS-LABALLERY, Thierry SOULABAIL
```


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

````

</details>


---

### 📄 `si/DAT-presentation.md` [14.042 octets]
<a id="si-DAT-presentation-md"></a> [↩ Retour à l'arborescence](#tree-si-DAT-presentation-md)

> **Chemin relatif** : `si/DAT-presentation.md`  
> **Taille** : 14.042 octets  
> **Lignes** : 233  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (233 lignes) - Cliquer pour déplier</summary>

```markdown
# Dossier d'architecture technique

**Document en chantier**

[TOC]

## Introduction et objectifs

### Vue d'ensemble

**Brève** description fonctionnelle du système créé.

Un résumé du système accompagné d'un schéma de blocs fonctionnels ou des principaux cas d'usage est adapté.

### Objectifs principaux de qualité

Indiquez ici les trois (maximum cinq) principaux objectifs de qualité auxquels devra répondre l'architecture retenue. Expliquez en quoi ces objectifs sont importants.<br>
La suite du document doit montrer comment l'architecture retenue répond à ces objectifs.

Il s'agit ici d'objectifs de qualité **orientés utilisateurs du système** (au sens large : bénéficiaires directes, exploitants, etc.). Ne les confondez pas avec les objectifs du projet. Ils ne sont pas nécessairement identiques. 

[Quelques **exemples** non exhaustifs](https://quality.arc42.org/  ) issus de Arc42. Cele reste des exemples, ils sont déclinables et doivent être **contextualisé au système** : 

- Fiable le système doit fonctionner sans panne ni défaut en mode nominal
- Flexible : le système est à même de s'adapter simplement à des exigences évolutives.
  - Ex. "*Les evolutions de la réglementation doivent être intégrables simplement et à coûts réduits.*"
- Efficient : le système peut fonctionner de bonne manière avec des ressources raisonnables, réduites. Un objectif de responsablité numérique. Le système peut évoluer à coût et délai maitrisé.
- Utilisable : le système est compréhensible de ses utilisateurs, non complexe à l'usage. Cela comprends tous les utilisateurs, donc les aspects d'accessiblité.
  - Ex : "*Le système doit être utilisable sur la tablette de l'inspecteur en visite terrain*"
  - Ex : "*Les graphiques et autres visualisations doivent tenir des comptes des difficultés visuelles (ex. daltonismes) et intégrer systématiquement un résumé textuel*"
- sûr : le système ne met pas en danger des vies humaines et plus globalement son environnement.  
- Sécurisé : le système protège ses données et son intégrité. Les données ne sont accssibles et modifiables que par leurs ayants-droits. Le sytème fait l'objet d'une maintenance régulière.
  - Ex. "*Tout modification des données est conditionné à une authentification sur un fournisseur d'idenitité reconnu (Cebere, AgentConnect, FranceConnect).*"
  - Ex. "*Toute modification des données doit être consignée dans un journal d'audit.*"
  - Ex. "*Toute modification de dossier doit être notifiée par mail à son bénéficaire.*"
- opérable : le système est déployable, exploitable, réparable sans complexité, à coûts convenus. Il est interopérable avec son environnement.
  - Ex. "*Le système doit pouvoir s'interfacer avec tout nouvel équipement de collecte transmettant ses données au format xxx.*"
  - Ex. "*Le déploiement d'une nouvelle version ne doit pas excéder 15'.*"
  - Ex. "*Le système doit exposer des métriques permettant sa surveillance en temps réel.*"

Exemples pratiques

### Parties prenantes

Vue d'ensemble explicite des parties prenantes du système, c'est-à-dire toutes les personnes, rôles ou organisations qui

- doivent connaître l'architecture ou
- doivent être convaincu de l'architecture ou
- doivent travailler avec l'architecture ou avec le code ou
- ont besoin de la documentation d'architecture pour leur travail ou
- doivent prendre des décisions concernant le système ou son développement ou

Ceci pour avoir une bonne vision des personnes ou organisations concernées par les choix architecturaux

Un tableau est la façon la plus efficace pour lister ces personnes ou organisations.

| Rôle/Nom    | Contact                   | Attentes       |
| ----------  | ------------------------- | -------------- |
| Role-1      | Contact-1 (@ typiquement) | Attente rôle 1 |
| Role-2      | Contact-2 (@ typiquement) | Attente rôle 2 |

## Constraintes 

### Contraintes d'architecture

Indiquez ici youte exigence qui limite la liberté des architectes dans leurs décisions de conception et de mise en œuvre ou dans leurs décisions concernant le processus de développement.

Les architectes doivent savoir exactement où ils sont libres dans leurs décisions de conception et où ils doivent respecter des contraintes. Les contraintes doivent toujours être prises en compte ; elles peuvent toutefois être négociables.

Les contraintes peuvent être de natures diverses : techniques, organisationnelles, politiques et convention, etc.

Exemples : 

- *Les developpement doivent se faire dans le langage xxx pour harmonisation avec les autres applications du SI (ou parceque compétences acquises de l'équipe).*
- *Le système doit être consultable sur un terminal mobile (smartphone)et bureau (desktop) avec la même application. Le budget et les ressouces ne permettent de développer une application native mobile.*
- *Le système sera publié en licence libre, il ne doit pas intégrer de composants sous licences.*
- *Une première version doit être ouverte à la date XXX pour raison réglementaire.*
- *Le système sera déployé sur le cloud xxx sur l'offre yyy*"

### Contraintes de sécurité

Indiquer ici les exigences de sécurité du système en terme de D(isponibilité), I(ntégrité), C(onfidentialité) et T(raçabilité).

## Contexte et périmètre

Le contexte et le périmètre délimitent votre système (c'est-à-dire votre périmètre) de tous ses partenaires de communication (systèmes voisins et utilisateurs, c'est-à-dire le contexte de votre système). Il spécifie ainsi les interfaces externes.

Le système est ici vue comme une **boite noire**

Les interfaces de domaine et les interfaces techniques avec les partenaires de communication font partie des aspects les plus critiques
de votre système.

Privilégiez une représentation simple et directe, schémas et tableaux, à un descriptif verbeux.

Les contextes métiers er techniques peuvent être fusionnés ou conservés distincts selon la complexité du système.

### Contexte métier

Spécification de **tous** les partenaires de communication (utilisateurs, systèmes informatiques, ...) avec des explications la nature fonctionnelle de l'interface (référentiel, service de validation, authentification, etc.)

### Contexte Technique

Descriptif succinct des interfaces techniques, des protocoles utilisés pour interconnecter les systèmes tiers.

N'entrez pas à ici dans le détail du protocole : https/443 OK, détails xml/json/etc. non. Si vous estimez nécessaire de détailler le format, faite le dans un document annexe et référencez le ici. 

## Stratégie de solution

Un résumé et une explication des décisions fondamentales et des stratégies de solution qui façonnent l'architecture du système. Il
comprend.\
Les explications relatives à ces décisions clés doivent être brèves et motivées si non évidentes. La motivation repose sur les objectifs de qualités et les contraintes.

- les décisions technologiques
- les décisions relatives à la décomposition du système au niveau le plus élevé, par exemple l'utilisation d'un modèle architectural ou d'un modèle de conception
- les décisions sur la manière d'atteindre les principaux objectifs de qualité
- les décisions organisationnelles pertinentes, par exemple la sélection d'un processus de développement ou la délégation de certaines tâches à des tiers.

Les sous-chapitres suivants peuvent être complétes selon les besoins et la complexité du système.

### Modèles de conception - Décisions d'architecture

Indiquez les principaux modèles de conception retenus accompagnés d'une brève motivation. Ce chapitre doit rester synthétique, si un choix justifie d'une explication détaillée faite le en annexe dans une [décision d'architecture -ADR](https://adr.github.io/  ) et réféfencez là ici.

Exemples :

- *Conception monolithe au vu de la simplicité du système et du couplage fort de tous ses services.*
- *Conception micro-services pour découpage des responsabilités et déploiements différenciés*
- *Exposition par API pour ouverture de la données (opendata)*
- *Bus de message, asynchronisme pour gestion des fortes charges ou des tâches différées*
- *etc.*

### Environnement technologique

Listez les solutions logicielles retenues: langage, produits logiciels, frameworks, etc.  

### Forge logicielle - CI/CD

Indiquez les solutions retenues pour gérer les sources applicatifs et les processus de construction (*build*) et déploiement (*run*).

## Vue en Briques

La vue en briques montre la décomposition statique du système en briques ainsi que leurs dépendances
(relations, associations, ...).

Cette vue est obligatoire pour toute documentation sur l'architecture. Par analogie avec une maison, il s'agit du *plan de masse*.

Plusieurs niveaux de vue sont possibles. Le [formalisme C4](https://c4model.com/  ) par exemple propose 4 niveaux

- Vue contextuelle, le système en tant que boite noire dans son ensemble. Si cette vue n'a pas été réalisée dans le chapitre "Contexte" vous pouvez la fournir ici.
- Vue conteneur (un conteneur est un élément déployable, exécutable, par forcément un conteneur OCI/Docker). Cette vue est obligatoire ici, c'estla vue en **boîte blancheù* de plus haut niveau. Fournissez un schéma décrivant l'ensemble des éléments déployés et leurs interactions.
- Vue en composants : un zoom sur chaque conteneur (au sens déploiment). Schématisez et décrivez **brièvement** les principaux conposants de chaque conteneur.
- Vue code: l'implémentation sous forme de code de chaque composant, sous forme par exemple de diagramme de classe. **Cette vue n'est pas souhiatée ici car trop fine**. Dans li'idéal le code doit être suffisament clair, structuré et documenté pour qu'un développeur n'ai pas besoin de ces vues pour comprendre le système. Si vous estimez préférable d'en disposez parcque votre organisation s'y prête ou par forte complexité du code, alors annexez le ou faire en un document distinct (conception logicielle).


## Vue Exécution

La vue d'exécution décrit le comportement concret et les interactions des briques du système sous la forme de scénarios.

Il n'est pas question de décrire ici tous les scénarios d'usages possibles du système. Retenez ceux qui se détachent par leur complexité, leur criticité ou leur particularité architecturale (ceux dont la compréhension n'est pas "évidente, immédiate").

Ces scénarios peuvent être décrits par exemple sous la forme de diagrammes de séquence, d'autres formalismes sont possibles.

### Scénario 1

Description scénario 1

### Scénario 2

Description scénario 2

[ ... Autres scénarios ... ]

## Vue Déploiement

La vue déploiement décrit l'infrastructure technique utilisée pour exécuter votre système avec des éléments d'infrastructure tels que les emplacements géographiques, les environnements, les serveurs, les processeurs, les canaux et les topologies de réseau, ainsi que d'autres éléments d'infrastructure, et la correspondance entre les briques (logicielles) et les éléments d'infrastructure.

Une représentation par schéma et/ou tableaux est appropriée. Plusieurs niveaux de vue sont possibles selont la complexité du système


Les systèmes sont souvent exécutés dans différents environnements, par exemple l'environnement de développement, l'environnement d'intégration, l'environnement de production, etc.

- Listez ces environnement
- Il est fortement recommandé que tous ces environnements soient similaires. Si tel n'est pas le cas décrivez les particularités de chacun d'entre eux.

## Sujets transverses

Ce chapitre concerne les sujets communs aux différentes briques du système, souvent non rattachables à un domaine métier. Ce sont souvent ds sujets génériques, quelques exemples ni exhaustifs ni systématiques :

- Mécanismes d'authentification (utilisateur, système)
- Gestion des API
- Mécanismes de journalisation, de traçabilité
- Règles ORM
- etc.

## Exigences de qualité

Lstez ici les exigences de qualités de façon plus complète que les principales déja citées en introduction. Les exigences de qualités sont un entrant essentiel des les choix d'architecture, elles sont pilotées par les besoins métiers, par l'expérience utilisateur.\

Pour chaque exigence retenue rédiger un scénario permettant de vérifier qu'elle est satisfaite.

Arc42 propose [un ensemble de critères de qualités](https://quality.arc42.org/  ) sur lesquels vous pouvez vous appuyer, ou en retenir d'autres. Il est important que chaque exigence fasse l'objet d'un ou plusieurs scénario(s) permettant de valider sa réalisation.

## Risques et Dettes techniques

Listez les risques ou dettes techniques identifiés, classés par ordre de priorité.\
Suggerez les mesures à prendre pour y remédier.

Exemples de risques

* *L'interface avec le système XXX impose un format défini par la norme ISO XXXX dont l'accès n'est pas aisé et gratuit pour les nouvaux venus*.
  - *=> Acquérir une exemple de cette norme pour le projet et rédiger une prise en main pour les nouveaux venus.*
- *Le système repose sur le framework XXX dont le support d'une version est limité à un an*
  - *=> Assurer une mise à jour régulière de ce framework, annuelle au plus*


## Crédits

Ce modèle est une adaptation des modèles de [Arc42](https://arc42.org  ) ( [License](https://arc42.org/license  ) ).

Principaux changements apportés :

- 
- Regroupement des chapitres "Stratégie de solution"  et "Décisions d'architectures" pour simplifier la rédaction du document et réduire les risques de redondances.

## Annexes

### Glossaire

Listez les termes et acronymes dont le compréhension de tous n'est pas acquise.

### Décisions d'architectures - ADR

Insérez les décisions d'architecture prise sous forme d'ADR, tel que mentionné dans le chapitre "Stratégie de solution"
```

</details>


---

### 📄 `si/datapop.wiki.md` [41.803 octets]
<a id="si-datapop-wiki-md"></a> [↩ Retour à l'arborescence](#tree-si-datapop-wiki-md)

> **Chemin relatif** : `si/datapop.wiki.md`  
> **Taille** : 41.803 octets  
> **Lignes** : 1331  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (1331 lignes) - Cliquer pour déplier</summary>

`````markdown
﻿# Projet : datapop.wiki

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\datapop.wiki`

**Fichiers** : 15 fichiers non-binaires

## 📁 Arborescence des fichiers

├── **Notes-d'installation/**
│   ├── <a id="tree-Notes-d'installation-DATAPOP-4-1-0-md"></a>[DATAPOP-4.1.0.md](#Notes-d'installation-DATAPOP-4-1-0-md) *(1.888 octets)*
│   ├── <a id="tree-Notes-d'installation-DATAPOP-4-2-0-(OIDC)-md"></a>[DATAPOP-4.2.0-(OIDC).md](#Notes-d'installation-DATAPOP-4-2-0-(OIDC)-md) *(1.597 octets)*
│   ├── <a id="tree-Notes-d'installation-DATAPOP-4-3-0-RC-md"></a>[DATAPOP-4.3.0-RC.md](#Notes-d'installation-DATAPOP-4-3-0-RC-md) *(2.379 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v3-1-1-md"></a>[Note-d'installation-v3.1.1.md](#Notes-d'installation-Note-d'installation-v3-1-1-md) *(2.110 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v3-1-2-md"></a>[Note-d'installation-v3.1.2.md](#Notes-d'installation-Note-d'installation-v3-1-2-md) *(2.081 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v3-1-3-md"></a>[Note-d'installation-v3.1.3.md](#Notes-d'installation-Note-d'installation-v3-1-3-md) *(2.009 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v3-1-4-md"></a>[Note-d'installation-v3.1.4.md](#Notes-d'installation-Note-d'installation-v3-1-4-md) *(1.916 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v3-1-5-md"></a>[Note-d'installation-v3.1.5.md](#Notes-d'installation-Note-d'installation-v3-1-5-md) *(2.006 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v3-1-6-md"></a>[Note-d'installation-v3.1.6.md](#Notes-d'installation-Note-d'installation-v3-1-6-md) *(2.041 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v3-1-7-md"></a>[Note-d'installation-v3.1.7.md](#Notes-d'installation-Note-d'installation-v3-1-7-md) *(2.053 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v4-0-0-md"></a>[Note-d'installation-v4.0.0.md](#Notes-d'installation-Note-d'installation-v4-0-0-md) *(1.845 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v4-0-1-md"></a>[Note-d'installation-v4.0.1.md](#Notes-d'installation-Note-d'installation-v4-0-1-md) *(2.177 octets)*
│   └── <a id="tree-Notes-d'installation-Template-Note-d'installation-vX-Y-Z-md"></a>[Template-Note-d'installation-vX.Y.Z.md](#Notes-d'installation-Template-Note-d'installation-vX-Y-Z-md) *(2.859 octets)*
├── **templates/**
│   └── <a id="tree-templates-Note-de-version-md"></a>[Note-de-version.md](#templates-Note-de-version-md) *(1.311 octets)*
└── <a id="tree-home-md"></a>[home.md](#home-md) *(646 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `home.md` [646 octets]
<a id="home-md"></a> [↩ Retour à l'arborescence](#tree-home-md)

> **Chemin relatif** : `home.md`  
> **Taille** : 646 octets  
> **Lignes** : 17  
> **Type** : markdown

```markdown
Index :

* Technique :
   * Item GTI n° 1
   * Item GTI n° 2
* Fonctionnel :
   * [Soutien-Export](Soutien-Export)
   * Item GPN n° 2



* Descriptif :
   * Outil permettant au bureau des partenariats, opérateurs et projets (POP) de la sous-direction stratégie, partenariats et affaires générales (SPAG) de la DAEI d’apporter son expertise sur les dossiers pilotés par la DG du Trésor, afin d’octroyer des fonds d’études et d’aides au secteur privé et de prêts du Trésor pour financer des démonstrations de technologie verte à l’international.
   * https://wikisi.e2.rie.gouv.fr/wikisi/application/584/



```


---

### 📄 `Notes-d'installation/DATAPOP-4.1.0.md` [1.888 octets]
<a id="Notes-d'installation-DATAPOP-4-1-0-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-DATAPOP-4-1-0-md)

> **Chemin relatif** : `Notes-d'installation/DATAPOP-4.1.0.md`  
> **Taille** : 1.888 octets  
> **Lignes** : 45  
> **Type** : markdown

````markdown
## Manuel d'installation:

Le manuel d'installation détaillé est disponible sur le README de la branche develop:

### Prérequis:

* Sauvegarder la base de données
* Sauvegarder les données métiers du dossier "src/document"

## Tickets traités:

* [remaniement docker + php 83 + config.php (](https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/produits/support/datapop/datapop/-/issues/15)#15[) · Issue · snum/pnm3/produits/support/datapop/datapop](https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/produits/support/datapop/datapop/-/issues/15)
* [accès "propre" aux ressources du dossier public/ (](https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/produits/support/datapop/datapop/-/issues/16)#16[) · Issue · snum/pnm3/produits/support/datapop/datapop](https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/produits/support/datapop/datapop/-/issues/16)
* [Fix (#17) · Issue · snum/pnm3/produits/support/datapop/datapop](https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/produits/support/datapop/datapop/-/issues/17)

> [!important]
>
> Cette version comprend le changement des environnements Docker PHP/Apache. une recette complète est nécéssaire
>
> Les accès aux ressources bloqués doivent être vérifiés

## Actions spécifiques à cette version:

* Création du fichier .env
* Recette des environnements de dev
* Recette des environnements de RUN
* Contrôle des droits sécurité sur les documents "uploadé"

## Variables d'environnement disponibles:

```properties
DEBUG: 1
HTTP_PROXY=
HTTPS_PROXY=
LOG_LEVEL: error
MYSQL_HOST: db
MYSQL_PASSWORD: xxxxxx
MYSQL_DATABASE: datapop
MYSQL_USER: xxxxxx
CAS_HOST=host.docker.internal
CAS_PORT=8085
CAS_CONTEXT=/cas
CAS_CLIENT_SERVICE_NAME = "https://localhost.e2.rie.gouv.fr:8044"
CAS_PROTOCOL=http
```
````


---

### 📄 `Notes-d'installation/DATAPOP-4.2.0-(OIDC).md` [1.597 octets]
<a id="Notes-d'installation-DATAPOP-4-2-0-(OIDC)-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-DATAPOP-4-2-0-(OIDC)-md)

> **Chemin relatif** : `Notes-d'installation/DATAPOP-4.2.0-(OIDC).md`  
> **Taille** : 1.597 octets  
> **Lignes** : 46  
> **Type** : markdown

````markdown
## Manuel d'installation:

> [!important]
>
> Cette version passe à l'authentification OIDC.


Le manuel d'installation détaillé est disponible sur le README de la branche develop:

### Prérequis:

* Sauvegarder la base de données
* Sauvegarder les données métiers du dossier "src/document"

## Tickets traités:

* https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/produits/support/datapop/datapop/-/issues/18


## Actions spécifiques à cette version:

* Création des identifiants Cerbère OIDC pour GESAPP
* Modification des paramètres du **.env** avec les variables OIDC
* Attention aux utilisateurs en BDD vs email compte Cerbère


## Variables d'environnement disponibles:

```properties
DEBUG: 1
HTTP_PROXY=
HTTPS_PROXY=
LOG_LEVEL: error
MYSQL_HOST: db
MYSQL_PASSWORD: xxxxxx
MYSQL_DATABASE: datapop
MYSQL_USER: xxxxxx
OIDCclientId=datapop
OIDCclientSecret=XXXXXXXXXXXXXXXXXX
OIDCredirectUri=https://localhost.e2.rie.gouv.fr:8043/public/connexion.php
OIDCurlAuthorize=https://authentification.recette.din.developpement-durable.gouv.fr/authSAML/oidc/datapop/user/authorize
OIDCurlAccessToken=https://authentification.recette.din.developpement-durable.gouv.fr/authSAML/oidc/datapop/user/token
OIDCurlResourceOwnerDetails=https://authentification.recette.din.developpement-durable.gouv.fr/authSAML/oidc/datapop/api/user
OIDCbaseLogoutUrl=https://authentification.recette.din.developpement-durable.gouv.fr/authSAML/oidc/datapop/api/logout
OIDCpostLogoutRedirectUri=https://localhost.e2.rie.gouv.fr:8043/public/index.php
```
````


---

### 📄 `Notes-d'installation/DATAPOP-4.3.0-RC.md` [2.379 octets]
<a id="Notes-d'installation-DATAPOP-4-3-0-RC-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-DATAPOP-4-3-0-RC-md)

> **Chemin relatif** : `Notes-d'installation/DATAPOP-4.3.0-RC.md`  
> **Taille** : 2.379 octets  
> **Lignes** : 54  
> **Type** : markdown

````markdown
---
title: DATAPOP 4.3.0 RC (Mysql9.5)
---
## Manuel d'installation:

Le manuel d'installation détaillé est disponible sur le README de la branche develop:

### Prérequis:

* Sauvegarder la base de données
* Sauvegarder les données métiers du dossier "src/document"
* **Installer et valider les environnements de la version 4.1.0-RC**
* **Installer et valider le paramétrage OIDC de la version 4.2.0-RC**

## Tickets traités:

> [!important]
>
> La base de données MYSQL5.7 doit être sauvegardée et exportée en UTF-8
>
> Le charset de la connexion de l'application a été passé en "latin1" pour des raisons de compatibilité avec le dump réalisé en Mysql5.7 et les soucis d'encodage.
>
> Les données présentes dans le dump possèdent des problèmes de double encodage UTF-8. Ces données devront probablement être nettoyées après export/import.
>
> le paramètre "sql_mode" de Mysql9.5 a du être modifié pour rétrocompatbilité avec Mysql5.7

* [montée de version MySQL 5.7->9.5 (#19) · Issue · snum/pnm3/produits/support/datapop/datapop](https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/produits/support/datapop/datapop/-/issues/19)

## Actions spécifiques à cette version:

1. Export de la base de données en Mysql5.7
2. Création du conteneur de base de données en Mysql9.5 (le dossier/volume "mysql_data" ne peut pas être réutilisé)
3. Import du dump Mysql5.7 dans la base Mysql9.5

## Variables d'environnement disponibles:

```properties
DEBUG: 1
HTTP_PROXY=
HTTPS_PROXY=
LOG_LEVEL: error
MYSQL_HOST: db
MYSQL_PASSWORD: xxxxxx
MYSQL_DATABASE: datapop
MYSQL_USER: xxxxxx
OIDCclientId=datapop
OIDCclientSecret=XXXXXXXXXXXXXXXXXX
OIDCredirectUri=https://localhost.e2.rie.gouv.fr:8043/public/connexion.php
OIDCurlAuthorize=https://authentification.recette.din.developpement-durable.gouv.fr/authSAML/oidc/datapop/user/authorize
OIDCurlAccessToken=https://authentification.recette.din.developpement-durable.gouv.fr/authSAML/oidc/datapop/user/token
OIDCurlResourceOwnerDetails=https://authentification.recette.din.developpement-durable.gouv.fr/authSAML/oidc/datapop/api/user
OIDCbaseLogoutUrl=https://authentification.recette.din.developpement-durable.gouv.fr/authSAML/oidc/datapop/api/logout
OIDCpostLogoutRedirectUri=https://localhost.e2.rie.gouv.fr:8043/public/index.php
```
````


---

### 📄 `Notes-d'installation/Note-d'installation-v3.1.1.md` [2.110 octets]
<a id="Notes-d'installation-Note-d'installation-v3-1-1-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v3-1-1-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v3.1.1.md`  
> **Taille** : 2.110 octets  
> **Lignes** : 73  
> **Type** : markdown

````markdown
# Tickets

- 165 : P2 - Actualiser noms et libellés applicatifs 
- 172 : P2 - Modifier les filtres des requêtes (structure et critères)

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_soutien-export_v3.1.1.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM3 > Soutien-Export > Livraisons > v3.1.1


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v3.1.1**.

Sinon, remonter une alerte [HENRI BERTHE / EMILIE DESAVOYE]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **src** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- config
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v3.1.2.md` [2.081 octets]
<a id="Notes-d'installation-Note-d'installation-v3-1-2-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v3-1-2-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v3.1.2.md`  
> **Taille** : 2.081 octets  
> **Lignes** : 72  
> **Type** : markdown

````markdown
# Tickets

- Evolution 164 : P1 - Ajouter champs "Nature d'acteur", "Piloté par le ministère" et "Année de clôture" 
- Anomalie 184 : Ano 165 - IHM - Dossiers - Liste des dossiers d'aide - Editer un dossier
- Anomalie 185 : Ano 172 - IHM-Ecrans : Requêtes - Toutes

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

La livraison 3.1.2 est disponible depuis Gitlab sous le tag 3.1.2-LIVREE. Elle comprend :
- un répertoire **src** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v3.1.2**.

Sinon, remonter une alerte [HENRI BERTHE / EMILIE DESAVOYE]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **src** vers celui du dossier **src** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- config
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Le script SQL "script_3.1.1_to_3.1.2.sql" situé dans le dossier db/ est à exécuter avant tout démarrage de recette.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v3.1.3.md` [2.009 octets]
<a id="Notes-d'installation-Note-d'installation-v3-1-3-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v3-1-3-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v3.1.3.md`  
> **Taille** : 2.009 octets  
> **Lignes** : 72  
> **Type** : markdown

````markdown
 # Tickets

- 164 : P1 - Ajouter champs "Nature d'acteur", "Piloté par le ministère" et "Année de clôture" (ajustements 1 et 2)
- 165 : P2 - Actualiser noms et libellés applicatifs (ajustements 1 et 3)
- 185 : Ano 172 - IHM-Ecrans : Requêtes - Toutes

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

La livraison 3.1.3 est disponible depuis Gitlab sous le tag 3.1.3-LIVREE. Elle comprend :
- un répertoire **src** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v3.1.3**.

Sinon, remonter une alerte [HENRI BERTHE / EMILIE DESAVOYE]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **src** vers celui du dossier **src** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- config
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v3.1.4.md` [1.916 octets]
<a id="Notes-d'installation-Note-d'installation-v3-1-4-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v3-1-4-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v3.1.4.md`  
> **Taille** : 1.916 octets  
> **Lignes** : 71  
> **Type** : markdown

````markdown
 # Tickets

- 164 : P1 - Ajouter champs "Nature d'acteur", "Piloté par le ministère" et "Année de clôture" ()
- 185 : Ano 172 - IHM-Ecrans : Requêtes - Toutes

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

La livraison 3.1.4 est disponible depuis Gitlab sous le tag 3.1.4-LIVREE. Elle comprend :
- un répertoire **src** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v3.1.4**.

Sinon, remonter une alerte [HENRI BERTHE / EMILIE DESAVOYE]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **src** vers celui du dossier **src** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- config
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v3.1.5.md` [2.006 octets]
<a id="Notes-d'installation-Note-d'installation-v3-1-5-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v3-1-5-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v3.1.5.md`  
> **Taille** : 2.006 octets  
> **Lignes** : 70  
> **Type** : markdown

````markdown
 # Tickets

- 163 : P1 - Associer la saisie multiple au champ de saisie des pays

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

La livraison 3.1.5 est disponible depuis Gitlab sous le tag 3.1.5-LIVREE. Elle comprend :
- un répertoire **src** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v3.1.5**.

Sinon, remonter une alerte [HENRI BERTHE / EMILIE DESAVOYE]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **src** vers celui du dossier **src** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- config
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Edit du 15/09/2023 : Suite à l'ajout de l'image "logo_data_pop.png" dans le répertoire src/public/images/, il faut redonner les droits de lecture/écriture dans ce dossier.

# Déploiement scripts SQL

## Exécution des scripts

Le script SQL "script_3.1.4_to_3.1.5.sql" situé dans le dossier db/ est à exécuter avant tout démarrage de recette.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v3.1.6.md` [2.041 octets]
<a id="Notes-d'installation-Note-d'installation-v3-1-6-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v3-1-6-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v3.1.6.md`  
> **Taille** : 2.041 octets  
> **Lignes** : 73  
> **Type** : markdown

````markdown
 # Tickets

- 190 : Ano 163 - Liste des dossiers - Champ "Dossiers multi-pays" - Alerte utilisateur
- 191 : Ano 163 - Export - ListeChampExport - Sélection des champs
- 193 : Ano 163 - Multi-sélection sur champ "Nature d'acteurs" inopérante
- 194 : Ano 163 - Liste des dossiers - En-tête colonne "Pays"

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

La livraison 3.1.6 est disponible depuis Gitlab sous le tag 3.1.6-LIVREE. Elle comprend :
- un répertoire **src** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v3.1.6**.

Sinon, remonter une alerte [HENRI BERTHE]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **src** vers celui du dossier **src** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- config
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v3.1.7.md` [2.053 octets]
<a id="Notes-d'installation-Note-d'installation-v3-1-7-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v3-1-7-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v3.1.7.md`  
> **Taille** : 2.053 octets  
> **Lignes** : 72  
> **Type** : markdown

````markdown
 # Tickets

- 197 : Actualisation bandeau et logo applicatifs
- 198 : REG - Requêtes - Pb de comptabilisation versus nb d'acteurs d'un dossier
- 199 : REG - Pb sur la fonction d'ajout de contact pour un acteur

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

La livraison 3.1.7 est disponible depuis Gitlab sous le tag 3.1.7-LIVREE. Elle comprend :
- un répertoire **src** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v3.1.7**.

Sinon, remonter une alerte [MAI PELLETIER]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **src** vers celui du dossier **src** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- config
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Suite à l'ajout de l'image "Logo_MTERCT-MTE-MER.PNG" dans le répertoire src/public/images/structure, il faut redonner les droits de lecture/écriture dans ce dossier.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v4.0.0.md` [1.845 octets]
<a id="Notes-d'installation-Note-d'installation-v4-0-0-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v4-0-0-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v4.0.0.md`  
> **Taille** : 1.845 octets  
> **Lignes** : 70  
> **Type** : markdown

````markdown
 # Tickets

- Migration de PHP5 vers PHP8

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

La livraison 4.0.0 est disponible depuis Gitlab sous le tag 4.0.0-LIVREE. Elle comprend :
- un répertoire **src** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v4.0.0**.

Sinon, remonter une alerte [MAI PELLETIER]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **src** vers celui du dossier **src** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- config
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v4.0.1.md` [2.177 octets]
<a id="Notes-d'installation-Note-d'installation-v4-0-1-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v4-0-1-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v4.0.1.md`  
> **Taille** : 2.177 octets  
> **Lignes** : 74  
> **Type** : markdown

````markdown
 # Tickets

ATTENTION, le processus d'installation a changé.

- Migration de PHP5 vers PHP8 + ajout d'un fichier de configuration

# Prérequis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

La livraison 4.0.1 est disponible depuis Gitlab sous le tag 4.0.1-LIVREE. Elle comprend :
- un répertoire **src** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL
- L'ajout d'un fichier de configuration "config.exemple.php"


### Vérification des sources applicatives

Vérifier la version applicative dans le fichier **version.php** . Celui-ci doit contenir la version **v4.0.1**.

Sinon, remonter une alerte [MAI PELLETIER]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires et fichiers suivants:
  - **src/** 
  - **config.php**
  - **version.php** 

- Copier/récupérer le fichier de configuration **config.php** lors du prochain déploiement.

Note: Le dossier "public" du dépôt doit également être déployé. 
- Si des données métiers sont présentes dans l'ancienne release, les récupérer et les copier dans la nouvelle release (ou réaliser un lien symbolique vers ce dossier)

Si besoin, contacter la TMA pour sortir des données métiers du dossier "public". 

## Modification à apporter sur les sources en exception.

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Template-Note-d'installation-vX.Y.Z.md` [2.859 octets]
<a id="Notes-d'installation-Template-Note-d'installation-vX-Y-Z-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Template-Note-d'installation-vX-Y-Z-md)

> **Chemin relatif** : `Notes-d'installation/Template-Note-d'installation-vX.Y.Z.md`  
> **Taille** : 2.859 octets  
> **Lignes** : 99  
> **Type** : markdown

````markdown
# Tickets

- XXXXX - Anomalie - Libellé de l'anomalie
- XXXXX - Evolution - Libellé de l'évolution

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

`X.Y.Z` version applicative à déployer.
> Exemple : 1.2.3 pour la v1.2.3.

## Entrants

La livraison X.Y.Z est disponible depuis Gitlab sous le tag X.Y.Z-LIVREE. Elle comprend :
- un répertoire **src** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **vX.Y.Z**.

Sinon, remonter une alerte [HENRI BERTHE / EMILIE DESAVOYE]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- config
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php

## Modification à apporter sur les sources en exception

Une nouvelle configuration Cerbere est à reporter.

Modifier le fichier **config/cerbere.php** et modifier la variable **$cas_context** comme suit :

    $cas_context = "/exemple-de-changement-de-contexte-cerbere";

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Les scripts sont à exécuter dans l'ordre présenté ici.

### 1 - script_delete_products_expired

Vérifier que le script sera utile en lançant la requête suivante :

    COUNT(1) FROM PRODUCTS WHERE expired = true;

Le résultat doit être supérieur à 0. Sinon, remonter une alerte.

Lancer le script **db/script_delete_products_expired.sql**.

Vérifier la bonne exécution du script en lançant la requête suivante :

    COUNT(1) FROM PRODUCTS WHERE expired = true;

Le résultat doit être égal à 0. Sinon, remonter un problème de déploiement.

### 2 - script_alter_weird_variables

Lancer le script **db/script_alter_weird_variables.sql**.

Il n'est pas possible de vérifier techniquement le bon fonctionnement du script à travers une requête de validation.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `templates/Note-de-version.md` [1.311 octets]
<a id="templates-Note-de-version-md"></a> [↩ Retour à l'arborescence](#tree-templates-Note-de-version-md)

> **Chemin relatif** : `templates/Note-de-version.md`  
> **Taille** : 1.311 octets  
> **Lignes** : 42  
> **Type** : markdown

````markdown
## Manuel d'installation:

Le manuel d'installation détaillé est disponible sur le README de la branche develop:

### Prérequis:

* Sauvegarder la base de données
* Sauvegarder les données métiers du dossier "src/document"

## Tickets traités:



> [!important]
>
>
> Les accès aux ressources bloqués doivent être vérifiés

## Actions spécifiques à cette version:



## Variables d'environnement disponibles:

```properties
DEBUG: 1
HTTP_PROXY=
HTTPS_PROXY=
LOG_LEVEL: error
MYSQL_HOST: db
MYSQL_PASSWORD: xxxxxx
MYSQL_DATABASE: datapop
MYSQL_USER: xxxxxx
OIDCclientId=datapop
OIDCclientSecret=XXXXXXXXXXXXXXXXXX
OIDCredirectUri=https://localhost.e2.rie.gouv.fr:8043/public/connexion.php
OIDCurlAuthorize=https://authentification.recette.din.developpement-durable.gouv.fr/authSAML/oidc/datapop/user/authorize
OIDCurlAccessToken=https://authentification.recette.din.developpement-durable.gouv.fr/authSAML/oidc/datapop/user/token
OIDCurlResourceOwnerDetails=https://authentification.recette.din.developpement-durable.gouv.fr/authSAML/oidc/datapop/api/user
OIDCbaseLogoutUrl=https://authentification.recette.din.developpement-durable.gouv.fr/authSAML/oidc/datapop/api/logout
OIDCpostLogoutRedirectUri=https://localhost.e2.rie.gouv.fr:8043/public/index.php
```
````


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

`````

</details>


---

### 📄 `si/formation-ecologie.analysis.md` [28.591 octets]
<a id="si-formation-ecologie-analysis-md"></a> [↩ Retour à l'arborescence](#tree-si-formation-ecologie-analysis-md)

> **Chemin relatif** : `si/formation-ecologie.analysis.md`  
> **Taille** : 28.591 octets  
> **Lignes** : 935  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (935 lignes) - Cliquer pour déplier</summary>

````markdown
# Analyse détaillée de l'application "Formation-Écologie"

> **Note:** Ce document est autoporté et peut être rendu directement dans un éditeur compatible Markdown avec la prise en charge de PlantUML (VSCode avec extension, Obsidian avec plugin, etc.)

## Table des matières
- [1. Introduction](#1-introduction)
- [2. Analyse fonctionnelle](#2-analyse-fonctionnelle)
  - [2.1 Acteurs principaux](#21-acteurs-principaux)
  - [2.2 Cas d'usage](#22-cas-dusage)
  - [2.3 Règles métier clés](#23-règles-métier-clés)
  - [2.4 Workflows métier](#24-workflows-métier)
- [3. Analyse technique](#3-analyse-technique)
  - [3.1 Architecture globale](#31-architecture-globale)
  - [3.2 Modules principaux](#32-modules-principaux)
  - [3.3 Dépendances externes](#33-dépendances-externes)
  - [3.4 Sécurité](#34-sécurité)
  - [3.5 Dette technique](#35-dette-technique)
- [4. Annexes](#4-annexes)
  - [4.1 Modèle de données détaillé](#41-modèle-de-données-détaillé)
  - [4.2 Algorithmes métier](#42-algorithmes-métier)

## 1. Introduction

L'application **Formation-Écologie** est un portail web développé pour le ministère de la Transition écologique, mettant à disposition le catalogue des formations disponibles et permettant leur exploration par différents moyens (recherche textuelle, cartographique, etc.).

```plantuml
@startuml
!theme aws-orange
skinparam wrapWidth 200

package "Formation-Écologie" {
  component "Frontend (DSFR)" as frontend
  component "Backend (Django)" as backend
  component "Base de données (PostgreSQL)" as database
  component "Moteur de recherche (Meilisearch)" as search
  component "Stockage de fichiers (Minio/S3)" as storage
}

actor "Agent public" as user
actor "Administrateur" as admin

user --> frontend
admin --> frontend

frontend --> backend : Requêtes HTTP
backend --> database : Opérations CRUD
backend --> search : Indexation/Recherche
backend --> storage : Téléversement/Récupération de fichiers

note right of user
  L'application est destinée
  aux agents du ministère de 
  la Transition écologique
  pour faciliter l'accès aux
  formations professionnelles
end note

@enduml
```

L'application est développée avec le framework Django (Python) et utilise le Design System de l'État (DSFR) pour l'interface utilisateur. Elle inclut des fonctionnalités avancées comme la recherche full-text via Meilisearch, l'exploration cartographique avec Leaflet, et la génération de documents (PDF/Excel).

## 2. Analyse fonctionnelle

### 2.1 Acteurs principaux

```plantuml
@startuml
!theme plain
left to right direction
skinparam packageStyle rectangle

actor "Agent public" as agent
actor "Administrateur" as admin
actor "Service RH" as rh
actor "Système externe (ZEL)" as zel

agent : "Consulte les formations\nS'abonne aux alertes\nTélécharge des documents"
admin : "Gère les contenus\nPublie des articles\nConfigure les paramètres"
rh : "Importe les données\nGénère des rapports\nTraite les inscriptions"
zel : "Synchronise les données\nFournit des informations sur les agents"

@enduml
```

D'après le code source, on identifie clairement 4 types d'acteurs :

1. **L'agent public** : utilisateur principal qui :
   - Recherche des formations par différents critères (domaine, département, etc.)
   - Consulte le détail des formations et sessions
   - S'abonne à des alertes personnalisées
   - Télécharge des documents (PDF, Excel)

2. **L'administrateur** : gère le contenu de l'application :
   - Publie des articles (actualités, réglementation)
   - Gère le bandeau d'accueil
   - Gère les partenaires et leur visibilité

3. **Le service RH** : responsable des données :
   - Importe les données de formations depuis des sources externes
   - Génère des rapports sur les formations
   - Peut potentiellement traiter les inscriptions (lien avec ZEL)

4. **Le système externe ZEL** (système métier) : 
   - Permettrait la récupération de l'identifiant agent (mentionné dans le TODO.md)
   - Synchroniserait potentielles données entre les systèmes

### 2.2 Cas d'usage

```plantuml
@startuml
left to right direction
skinparam usecaseFontSize 13
skinparam defaultFontSize 13

actor Agent as a
actor Admin as ad
actor RH as r

rectangle "Formation-Écologie" {
  (Rechercher des formations) as (search)
  (Consulter une formation) as (view)
  (S'abonner à des alertes) as (subscribe)
  (Exporter des résultats) as (export)
  (Consulter les articles) as (articles)
  (Gérer les contenus) as (manage)
  (Importer des données) as (import)
  
  a -- (search)
  a -- (view)
  a -- (subscribe)
  a -- (export)
  a -- (articles)
  
  ad -- (manage)
  ad -- (articles)
  
  r -- (import)
  r -- (export)
  
  (search) .> (view) : include
  (search) .> (subscribe) : include
  (search) .> (export) : include
  (manage) .> (articles) : include
}

@enduml
```

Cas d'usage principaux de l'application :

1. **Recherche de formations** : 
   - Par formulaire avec filtres multiples (domaine, sous-domaine, département, organisateur, etc.)
   - Par carte interactive avec clustering des résultats
   - Par mots-clés (recherche full-text)

2. **Consultation de formation** :
   - Affichage détaillé d'une formation et de ses sessions
   - Téléchargement d'un formulaire d'inscription (PDF)
   - Visualisation cartographique des lieux

3. **Gestion des abonnements** :
   - Création d'abonnements personnalisés avec critères de recherche
   - Réception d'alertes par email lors de nouvelles publications
   - Gestion (modification/suppression) des abonnements existants

4. **Consultation des publications** :
   - Articles d'actualité sur la formation
   - Articles de réglementation
   - Liste des partenaires

5. **Fonctionnalités administratives** :
   - Gestion des articles (CRUD)
   - Configuration du bandeau d'accueil
   - Gestion des partenaires

6. **Import et export de données** :
   - Import des données de formations depuis des fichiers sources
   - Export des résultats de recherche vers Excel
   - Génération de PDF pour les inscriptions

### 2.3 Règles métier clés

#### 2.3.1 Calcul de la durée des sessions

```plantuml
@startuml
title Calcul de la durée d'une session

start
:Récupération date début et fin;
if (Date de fin définie?) then (oui)
  :Calcul durée = Date fin - Date début + 1;
  :Retourner durée en jours;
else (non)
  if (Durée définie explicitement?) then (oui)
    :Retourner durée stockée;
  else (non)
    :Retourner "Durée non spécifiée";
  endif
endif
stop

@enduml
```

D'après le fichier `app/utils.py`, l'application utilise une fonction `get_duration_in_days` pour calculer la durée des sessions de formation :

```python
def get_duration_in_days(date_debut, date_fin=None, duree=None):
    if date_fin:
        return (date_fin - date_debut).days + 1
    elif duree:
        return duree
    else:
        return None
```

Cette règle métier indique que :
1. La durée est calculée à partir des dates de début et de fin si disponibles
2. Sinon, on utilise une durée explicitement définie
3. Le calcul inclut la journée de fin (+1 jour)

#### 2.3.2 Gestion des abonnements et alertes

```plantuml
@startuml
title Processus d'envoi d'alertes aux abonnés

start
:Initialisation processus cron;
:Récupération des abonnements actifs;
while (Pour chaque abonnement)
  :Exécution de la recherche associée;
  :Comparaison avec les résultats précédents;
  if (Nouveaux résultats?) then (oui)
    :Génération du contenu email;
    :Envoi de l'email à l'abonné;
    :Mise à jour de la date de dernière notification;
  else (non)
    :Pas d'action;
  endif
endwhile
:Fin du processus;
stop

@enduml
```

La logique des alertes est pilotée par un processus planifié (cron) qui :
1. Parcourt tous les abonnements actifs
2. Exécute la recherche associée aux critères de l'abonnement
3. Compare les résultats avec les derniers enregistrés
4. Envoie un email si de nouvelles formations correspondent aux critères
5. Met à jour la date de dernière notification pour ne pas renvoyer les mêmes résultats

Le template d'email est construit dynamiquement avec une mise en forme HTML enrichie, incluant les détails des nouvelles formations et un rappel des critères de recherche.

#### 2.3.3 Règles d'indexation Meilisearch

```plantuml
@startuml
title Processus d'indexation des formations

start
:Récupération des formations depuis la base de données;
while (Pour chaque formation)
  :Extraction des données principales;
  :Ajout des domaines associés;
  :Ajout des départements associés;
  :Ajout des types de stage;
  :Ajout des organisateurs;
  :Construction du document JSON;
  :Envoi à Meilisearch;
endwhile
:Optimisation de l'index;
:Enregistrement du statut de l'indexation;
stop

@enduml
```

L'application utilise Meilisearch pour la recherche full-text. La logique d'indexation est définie dans le modèle `Stage` :

```python
search_index = Search("stages")
def index(self):
    self.search_index.add_documents([{
        "id": self.id,
        "long_label": self.long_label,
        "organisateur_label": self.organisateur.label if self.organisateur else "",
        "code": self.code,
        "identifier": f"[{self.code}] {self.long_label}",
        "domaines": [d.nom for d in self.domaines.all()],
        "departements": [d.libelle for d in self.departements.all()],
        "types": [t.nom for t in self.types.all()],
        # Autres champs...
    }])
```

Les règles métier pour l'indexation :
1. Tous les champs textuels pertinents sont indexés
2. Les relations (domaines, départements, etc.) sont transformées en listes textuelles
3. Un champ "identifier" est créé pour faciliter l'identification rapide
4. Les index sont mis à jour lors des modifications des données

### 2.4 Workflows métier

#### 2.4.1 Workflow de recherche de formations

```plantuml
@startuml
title Workflow de recherche de formations

start
:Affichage du formulaire de recherche;
if (Type de recherche?) then (Formulaire)
  :Affichage formulaire avec critères avancés;
  :Sélection des critères par l'utilisateur;
  :Soumission du formulaire;
  :Appel API Meilisearch avec filtres;
elseif (Carte) then (non)
  :Affichage de la carte interactive;
  :Requête pour obtenir les coordonnées des formations;
  :Affichage des marqueurs avec clustering;
  :Clic sur un marqueur ou cluster;
  :Affichage des détails ou zoom;
endif
:Traitement des résultats;
:Affichage des sessions correspondantes;
if (Export demandé?) then (oui)
  :Génération du fichier Excel;
  :Téléchargement par l'utilisateur;
endif
stop

@enduml
```

Ce workflow illustre le processus complet de recherche de formations dans l'application, qui offre deux modes principaux :
1. **Recherche par formulaire** : permettant une recherche précise avec de multiples critères
2. **Recherche cartographique** : permettant une exploration géographique des formations

Les résultats peuvent être exportés vers Excel pour un traitement ultérieur.

#### 2.4.2 Workflow d'abonnement aux alertes

```plantuml
@startuml
title Workflow d'abonnement aux alertes

start
:Accès à la page d'abonnement;
:Affichage du formulaire d'abonnement;
while (Validation des critères?)
  :Sélection des critères (domaines, départements, etc.);
  :Configuration de la fréquence;
  :Saisie de l'adresse email;
  if (Email valide?) then (non)
    :Affichage erreur validation;
  else (oui)
    :Vérification unicité de l'abonnement;
    if (Abonnement existant?) then (oui)
      :Proposition de mise à jour;
    else (non)
      :Création du nouvel abonnement;
      :Envoi email de confirmation;
    endif
  endif
endwhile
:Redirection vers page de confirmation;
stop

@enduml
```

Le processus d'abonnement implique plusieurs étapes de validation et de vérification pour garantir que :
1. L'email fourni est valide
2. Les critères sélectionnés sont cohérents
3. Il n'existe pas déjà un abonnement identique pour cet email
4. Une confirmation est envoyée à l'utilisateur

## 3. Analyse technique

### 3.1 Architecture globale

```plantuml
@startuml
!theme aws-orange
skinparam componentStyle rectangle
skinparam wrapWidth 200

package "Frontend" {
  [Interface utilisateur (HTML/CSS/JS)]
  [Leaflet + MarkerCluster\n(cartographie)]
  [DSFR\n(Design System de l'État)]
}

package "Backend" {
  [Django\n(Application)]
  [Django REST Framework\n(API)]
  [Meilisearch\n(Recherche full-text)]
}

package "Stockage" {
  [PostgreSQL\n(Base de données)]
  [Minio/S3\n(Stockage objets)]
}

package "Services externes" {
  [Authentification CAS]
  [Système ZEL\n(intégration prévue)]
}

[Interface utilisateur (HTML/CSS/JS)] --> [Django\n(Application)] : Requêtes HTTP
[Django\n(Application)] --> [PostgreSQL\n(Base de données)] : Opérations CRUD
[Django\n(Application)] --> [Meilisearch\n(Recherche full-text)] : Indexation/Recherche
[Django\n(Application)] --> [Minio/S3\n(Stockage objets)] : Upload/Téléchargement
[Django\n(Application)] --> [Authentification CAS] : Validation des identifiants
[Django\n(Application)] -.-> [Système ZEL\n(intégration prévue)] : Future intégration (TODO)

@enduml
```

L'architecture de l'application suit un modèle classique MVC (Modèle-Vue-Contrôleur) avec Django, avec les composants suivants :

- **Frontend** : Interface utilisateur construite avec le DSFR (Design System de l'État), utilisant Leaflet pour la cartographie
- **Backend** : Application Django avec Django REST Framework pour les API, intégrant Meilisearch pour la recherche full-text
- **Stockage** : PostgreSQL pour la base de données principale et Minio/S3 pour le stockage des fichiers (documents, images)
- **Services externes** : Authentification via CAS et intégration prévue avec le système ZEL (système d'information RH)

L'application est déployée via Docker comme indiqué dans les fichiers `docker-compose*.yml`.

### 3.2 Modules principaux

```plantuml
@startuml
!theme plain
skinparam packageStyle rectangle
skinparam wrapWidth 150

package "formation" {
  [settings.py] : Configuration globale
  [urls.py] : Routage principal
  [feeds.py] : Flux RSS
}

package "app" {
  package "models" {
    [stage.py] : Formations
    [session.py] : Sessions
    [domaine.py] : Domaines
    [departement.py] : Départements
  }
  
  package "views" {
    [search_with_form.py] : Recherche par formulaire
    [search_with_map.py] : Recherche cartographique
    [subscribe.py] : Gestion abonnements
    [export.py] : Export Excel/PDF
  }
  
  package "forms" {
    [search.py] : Formulaire de recherche
    [subscription.py] : Formulaire d'abonnement
  }
  
  package "templates" {
    [common/base.html] : Template de base
    [search_with_form.html] : Vue recherche
    [training.html] : Détail formation
  }
  
  package "services" {
    [download_all_from_S3.py] : Récupération fichiers
    [log.py] : Journalisation
  }
  
  [admin.py] : Interface d'administration
  [urls.py] : Routage module
  [search.py] : Intégration Meilisearch
  [crons.py] : Tâches planifiées
}

[formation] --> [app] : Inclusion

@enduml
```

L'application est structurée en deux principaux modules :

1. **Le module `formation`** : 
   - Contient les configurations globales (`settings.py`)
   - Gère le routage principal (`urls.py`)
   - Implémente les flux RSS (`feeds.py`)

2. **Le module `app`** (application métier) :
   - **Models** : Définition des modèles de données (Stage, Session, Domaine, etc.)
   - **Views** : Logique métier pour les différentes vues (recherche, abonnements, etc.)
   - **Forms** : Définition des formulaires
   - **Templates** : Templates HTML pour l'affichage
   - **Services** : Fonctionnalités techniques (download_from_S3, log, etc.)
   - **Admin** : Interface d'administration personnalisée
   - **Search** : Intégration avec Meilisearch
   - **Crons** : Tâches planifiées (envoi des alertes)

### 3.3 Dépendances externes

```plantuml
@startuml
!theme material
title Dépendances externes

package "Django\n(^4.2.1)" as django #DDDDDD
package "django-model-utils\n(^4.3.1)" as modelutils #DDDDDD
package "django-cron\n(^0.6.0)" as cron #DDDDDD
package "meilisearch\n(^0.30.0)" as meili #DDDDDD
package "psycopg2\n(^2.9.9)" as pg #DDDDDD
package "fpdf2\n(^2.7.8)" as pdf #DDDDDD
package "openpyxl\n(^3.1.2)" as excel #DDDDDD
package "django-taggit\n(^5.0.1)" as taggit #DDDDDD
package "django-cas-ng\n(^5.0.1)" as cas #DDDDDD
package "boto3\n(^1.34.29)" as boto #DDDDDD
package "pillow\n(^10.2.0)" as pillow #DDDDDD

rectangle "Application\nformation-ecologie" as app {
  component "Core" as core
  component "Search module" as search
  component "Admin interface" as admin
  component "PDF generation" as pdfgen
  component "Authentication" as auth
}

core --> django : Framework principal
core --> modelutils : Utilitaires modèles
core --> pg : Connexion PostgreSQL
search --> meili : Moteur de recherche
admin --> cron : Tâches planifiées
pdfgen --> pdf : Génération PDF
pdfgen --> excel : Export Excel
core --> taggit : Gestion tags articles
auth --> cas : Authentification CAS
core --> boto : Stockage S3
core --> pillow : Manipulation images

@enduml
```

L'application utilise de nombreuses dépendances externes gérées par Poetry :

- **Framework principal** : Django (^4.2.1)
- **Utilitaires** : django-model-utils (^4.3.1), django-cron (^0.6.0)
- **Recherche** : meilisearch (^0.30.0)
- **Base de données** : psycopg2 (^2.9.9)
- **Génération de documents** : fpdf2 (^2.7.8), openpyxl (^3.1.2)
- **Fonctionnalités web** : django-taggit (^5.0.1), django-cas-ng (^5.0.1)
- **Stockage cloud** : boto3 (^1.34.29)
- **Traitement d'images** : pillow (^10.2.0)

L'intégration de Leaflet avec le plugin MarkerCluster est également importante pour la partie cartographique, bien que ces dépendances soient gérées côté client (statiques).

### 3.4 Sécurité

```plantuml
@startuml
!theme bluegray
title Mesures de sécurité

component "Authentification" as auth {
  [CAS] : Mode par défaut pour admins
  [Local] : Mode local pour tests
}

component "Protection CSRF" as csrf {
  [CSRF_COOKIE_HTTPONLY] : Protection contre vol cookie
  [SECURE_CROSS_ORIGIN_OPENER_POLICY] : Protection contexte navigateur
}

component "Configuration" as config {
  [.env] : Variables d'environnement séparées
  [.gitignore] : Fichiers sensibles exclus du dépôt
}

component "Données" as data {
  [Chiffrement] : Connexion sécurisée à PostgreSQL
  [Accès restreint] : Permissions sur fichiers sensibles
}

auth --> csrf
csrf --> config
config --> data

@enduml
```

Les mesures de sécurité implémentées dans l'application :

1. **Authentification** :
   - Mode CAS par défaut pour l'authentification centralisée des agents
   - Mode local disponible pour les environnements de développement/test
   - Configuration via les variables d'environnement (`AUTH_MODE`, `CAS_SERVER_URL`)

2. **Protection CSRF** :
   - Activation de la protection contre les attaques CSRF
   - Configuration `CSRF_COOKIE_HTTPONLY=true` pour éviter l'accès JavaScript au cookie CSRF
   - Politique de sécurité pour l'ouverture de contextes (`SECURE_CROSS_ORIGIN_OPENER_POLICY`)

3. **Gestion des secrets** :
   - Utilisation de `python-decouple` pour séparer les configurations sensibles du code
   - Fichier `.env.sample` fourni comme modèle, sans valeurs réelles
   - Fichiers sensibles (`data/`, `db/`, etc.) exclus via `.gitignore`

4. **Données** :
   - Paramètres de connexion à la base de données via variables d'environnement
   - Clé d'API Meilisearch configurée via variables d'environnement
   - Accès restreint aux fonctionnalités administratives

### 3.5 Dette technique

```plantuml
@startuml
!theme mars
title Dette technique identifiée

frame "Problèmes identifiés" {
  card "TODOs explicites" as todos #ffcccc {
    * Intégration ZEL non réalisée
    * Gestion des doublons lors de l'import
    * Meilisearch non branché sur l'import
  }
  
  card "Configuration" as config #ffcccc {
    * Variables en dur dans le code (ex: export Excel)
    * Chemins d'accès absolus parfois utilisés
  }
  
  card "Performance" as perf #ffcccc {
    * Pas de pagination côté client pour certaines recherches
    * Requêtes N+1 potentielles dans les vues
  }
  
  card "Tests" as tests #ffcccc {
    * Couverture de tests limitée (seulement tests/forms/article_form_test.py visible)
    * Absence de tests end-to-end
  }
}

todos -right-> config
config -right-> perf
perf -right-> tests

@enduml
```

D'après l'analyse du code, plusieurs éléments de dette technique sont identifiables :

1. **TODOs explicites** (fichier TODO.md) :
   - Ajout d'une date d'expiration aux actualités
   - Création d'une carte avec Leaflet (partiellement implémentée)
   - Intégration avec Meilisearch pour l'indexation lors de l'import
   - Vérification des doublons lors de l'import
   - Étude de la passerelle avec ZEL pour récupérer l'id agent

2. **Configuration** :
   - Certaines valeurs sont codées en dur (ex: dans `export.py`)
   - Utilisation de chemins d'accès qui pourraient être externalisés

3. **Performance** :
   - Absence de pagination visible pour certaines recherches qui pourraient retourner beaucoup de résultats
   - Potentielles requêtes N+1 dans les vues Django, non optimisées avec `select_related`/`prefetch_related`

4. **Tests** :
   - Couverture de tests très limitée (un seul fichier de test visible)
   - Absence de tests d'intégration et end-to-end
   - Absence de tests pour les aspects métier critiques (calculs, workflows)

## 4. Annexes

### 4.1 Modèle de données détaillé

```plantuml
@startuml
!theme plain
skinparam linetype ortho

class Stage {
  +id: BigIntegerField
  +code: CharField
  +long_label: TextField
  +objectifs: TextField
  +public_vise: TextField
  +contenu: TextField
  +prerequis: TextField
  +modalites_pedagogiques: TextField
  +moyens_techniques: TextField
  +lieu: CharField
  +modalites_evaluation: TextField
  +duree: IntegerField
  +elearning: BooleanField
  +non_publiable: BooleanField
  +new: BooleanField
  +id_stage_cisirh: CharField
  +public_cible: CharField
  +created: DateTimeField
  +modified: DateTimeField
  +search_index()
}

class Session {
  +id: BigIntegerField
  +code: CharField
  +label: CharField
  +date_debut: DateField
  +date_fin: DateField
  +date_fin_inscription: DateField
  +places: IntegerField
  +places_restantes: IntegerField
  +created: DateTimeField
  +modified: DateTimeField
}

class Domaine {
  +id: BigIntegerField
  +code: CharField
  +label: CharField
  +created: DateTimeField
  +modified: DateTimeField
}

class SousDomaine {
  +id: BigIntegerField
  +code: CharField
  +label: CharField
  +created: DateTimeField
  +modified: DateTimeField
}

class Departement {
  +id: BigIntegerField
  +code: CharField
  +libelle: CharField
}

class Organisateur {
  +id: BigIntegerField
  +code: CharField
  +label: CharField
}

class StageType {
  +id: BigIntegerField
  +code: CharField
  +nom: CharField
}

class Article {
  +id: BigIntegerField
  +title: CharField
  +type: IntegerField
  +text_intro: TextField
  +text_body: TextField
  +created: DateTimeField
  +modified: DateTimeField
}

class ArticleImage {
  +id: BigIntegerField
  +name: CharField
  +created: DateTimeField
  +modified: DateTimeField
}

class BandeauAccueil {
  +id: BigIntegerField
  +titre: CharField
  +message: TextField
  +lien: URLField
  +created: DateTimeField
  +modified: DateTimeField
}

class Subscriber {
  +id: BigIntegerField
  +email: EmailField
  +created_at: DateTimeField
  +confirmed: BooleanField
  +uuid_confirmation: UUIDField
}

class Subscription {
  +id: BigIntegerField
  +created_at: DateTimeField
  +last_notification: DateTimeField
  +uuid: UUIDField
  +domaine: Domaine
  +sous_domaine: SousDomaine
  +departement: Departement
  +organisateur: Organisateur
  +subscriber: Subscriber
}

Stage "1" *-- "0..*" Session : contient >
Stage "0..*" *-- "0..*" Domaine : appartient >
Stage "0..*" *-- "0..*" SousDomaine : appartient >
Stage "0..*" *-- "0..*" Departement : se déroule dans >
Stage "1" *-- "1" Organisateur : organisé par >
Stage "0..*" *-- "0..*" StageType : est de type >

Article "1" *-- "0..*" ArticleImage : contient >

Subscriber "1" *-- "0..*" Subscription : a >
Subscription "0..1" -- "0..1" Domaine : filtre sur >
Subscription "0..1" -- "0..1" SousDomaine : filtre sur >
Subscription "0..1" -- "0..1" Departement : filtre sur >
Subscription "0..1" -- "0..1" Organisateur : filtre sur >

@enduml
```

Le modèle de données est principalement centré autour des formations (`Stage`) et de leurs sessions (`Session`). Les formations sont organisées selon plusieurs dimensions :

- **Domaines et sous-domaines** de formation
- **Départements** géographiques
- **Types** de stage
- **Organisateurs** (structures responsables des formations)

Le système de gestion de contenu permet de publier des articles avec des images associées. Le système d'alertes est basé sur les abonnements (`Subscription`) des utilisateurs (`Subscriber`), avec des critères de recherche personnalisables.

### 4.2 Algorithmes métier

#### 4.2.1 Algorithme de génération de PDF pour inscription

```plantuml
@startuml
title Algorithme de génération de PDF

start
:Initialisation du document PDF\n(format A4, orientation portrait);
:Setup polices supplémentaires;
:Ajout de la page;
:Définition métadonnées document\n(titre, auteur, sujet, etc.);

:Création entête;
:Logo MTE;
:Titre du document;
:Code formation + numéro session;

:Section "Informations générales";
while (Pour chaque champ d'info générale)
  :Cellule gauche: libellé champ;
  if (Donnée disponible?) then (oui)
    :Cellule droite: valeur du champ;
  else (non)
    :Cellule droite: "Non précisé";
  endif
endwhile

:Sections supplémentaires\n(Objectifs, Pré-requis, etc.);
:Création pied de page;
:Enregistrement document;
:Retour réponse HTTP avec PDF;
stop

@enduml
```

L'algorithme de génération de PDF (fichier `app/utils.py`) suit une structure claire :

1. **Initialisation** du document avec format A4 et polices appropriées
2. **Création de l'entête** avec le logo et les informations principales
3. **Sections structurées** pour chaque type d'information :
   - Informations générales
   - Objectifs
   - Pré-requis
   - Public visé
   - Contenu
   - Organisation
   - Périodes
4. **Gestion des données manquantes** avec "Non précisé" quand une information n'est pas disponible
5. **Création du pied de page** avec les coordonnées et contacts
6. **Retour du document** en réponse HTTP avec les en-têtes appropriés

#### 4.2.2 Algorithme d'export Excel

```plantuml
@startuml
title Algorithme d'export Excel

start
:Création de la réponse HTTP\n(content_type=application/vnd.ms-excel);
:Définition nom fichier\n("recherche_formations.xlsx");
:Initialisation du classeur Excel;
:Création feuille active\n("Résultats de recherche");

:Ajout ligne titre;
while (Pour chaque colonne)
  :Définition entête colonne\n(à partir de headers);
endwhile

:Ajout données;
while (Pour chaque résultat)
  :Création ligne;
  while (Pour chaque champ)
    :Récupération valeur associée;
    if (Valeur date?) then (oui)
      :Formatage date;
    else (non)
      :Ajout valeur brute;
    endif
  endwhile
endwhile

:Ajustement largeur colonnes;
:Fusion cellules titre;
:Application style aux cellules;
:Sauvegarde classeur;
:Retour réponse HTTP;
stop

@enduml
```

L'algorithme d'export Excel (fichier `app/views/export.py`) implémente :

1. **Configuration de la réponse HTTP** pour un fichier Excel
2. **Initialisation du classeur** avec openpyxl
3. **Définition des entêtes** de colonnes (Libellé, Code, Début, Durée, etc.)
4. **Remplissage des données** avec formatage approprié selon le type
5. **Mise en forme** :
   - Ajustement automatique des largeurs de colonnes
   - Fusion des cellules pour le titre
   - Application de bordures aux cellules
6. **Retour du fichier** en réponse HTTP


````

</details>


---

### 📄 `si/formation-ecologie.dat.md` [8.861 octets]
<a id="si-formation-ecologie-dat-md"></a> [↩ Retour à l'arborescence](#tree-si-formation-ecologie-dat-md)

> **Chemin relatif** : `si/formation-ecologie.dat.md`  
> **Taille** : 8.861 octets  
> **Lignes** : 325  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (325 lignes) - Cliquer pour déplier</summary>

````markdown
---
title: Dossier d'architecture technique - Formation Écologie
---










**Document en chantier**

[TOC]

## Introduction et objectifs

### Vue d'ensemble

Le projet est un portail web permettant la consultation et la recherche dans le catalogue RenoiRH des formations. Il offre une exploration cartographique et des fonctionnalités de recherche avancée.

**Fonctionnalités principales:**
- Consultation du catalogue de formations RenoiRH
- Recherche avancée dans le catalogue
- Exploration cartographique des formations
- Visualisation détaillée des sessions de formation

```mermaid
graph TD
    A[Portail Formation] --> B[Catalogue RenoiRH]
    A --> C[Recherche]
    A --> D[Cartographie]
    B --> E[Sessions]
    B --> F[Stages]
    C --> G[MeiliSearch]
    D --> H[Visualisation Géographique]
```

### Objectifs principaux de qualité

1. **Performance de recherche**
   - Temps de réponse < 200ms pour les recherches
   - Pertinence des résultats
   - Interface réactive

2. **Accessibilité**
   - Conformité au RGAA
   - Compatible Design System de l'État
   - Responsive design

3. **Maintenabilité**
   - Code Python/Django structuré
   - Documentation claire
   - Tests automatisés

### Parties prenantes

| Rôle | Contact | Attentes |
|------|---------|----------|
| Utilisateurs ministériels | - | Recherche efficace des formations |
| GTI | gti@xxx.gouv.fr | Maintenance et évolutions |
| Maîtrise d'ouvrage | moa@xxx.gouv.fr | Conformité aux besoins métier |

## Contraintes

### Contraintes d'architecture

- Développement en Python/Django
- Utilisation du Design System de l'État
- Base de données PostgreSQL
- Moteur de recherche MeiliSearch
- Gestion des dépendances avec Poetry
- Python 3.11.7

### Contraintes de sécurité

- **Disponibilité**: Accès au catalogue en continu
- **Intégrité**: Données RenoiRH fiables
- **Confidentialité**: Données publiques uniquement
- **Traçabilité**: Logs applicatifs

## Contexte et périmètre

### Contexte métier

```mermaid
graph TD
    A[Portail Formation] --> B[RenoiRH]
    A --> C[MeiliSearch]
    A --> D[Interface Cartographique]
    B --> E[Catalogue Formations]
    C --> F[Index Sessions]
    C --> G[Index Stages]
    D --> H[Visualisation Géographique]
```

Interfaces fonctionnelles:
- Lecture catalogue RenoiRH
- Moteur de recherche MeiliSearch
- Visualisation cartographique
- Export des données de formation

### Contexte Technique

- Django pour le backend et les vues
- Design System de l'État pour le frontend
- PostgreSQL pour le stockage
- MeiliSearch pour la recherche

## Stratégie de solution

### Modèles de conception

- Architecture monolithique Django (MVT)
- Indexation asynchrone via Crons
- API REST pour les données cartographiques

### Environnement technologique

- Python 3.11.7
- Django dernière version stable
- Poetry pour la gestion des dépendances
- PostgreSQL
- MeiliSearch
- Docker pour le développement
- Design System de l'État (DSFR)

### Forge logicielle - CI/CD

- GitLab pour le versioning et CI/CD
- Tests unitaires Django
- Docker Compose pour le développement
- Makefile pour les commandes courantes

## Vue en Briques

```mermaid
flowchart TD
 subgraph Infrastructure["Infrastructure"]
        B["PostgreSQL"]
        A["Django App"]
        C["MeiliSearch"]
  end
 subgraph Import_RenoiRH["Import RenoiRH"]
        E["S3 Minio"]
        D["SFTP"]
        F["Temp Files"]
  end
    A --> B & C
    D -- "recup_data.sh" --> E
    E -- download_from_S3 --> F
    F -- import_cisirh --> B
    B -- index --> C
    classDef text fill:#fff,stroke:none
    linkStyle 2 stroke:#008000,stroke-width:2px,fill:none
    linkStyle 3 stroke:#0000FF,stroke-width:2px,fill:none
    linkStyle 4 stroke:#0000FF,stroke-width:2px,fill:none
    linkStyle 5 stroke:#0000FF,stroke-width:2px,fill:none
```
![Capture_d_écran_du_2025-05-16_12-26-27](uploads/79b3b9c8f4e8292e6f1ea5e6f48da749/Capture_d_écran_du_2025-05-16_12-26-27.png) Cron Import SFTP → S3 (Tous les mardis à samedis à 04h00)

![Capture_d_écran_du_2025-05-16_12-27-36](uploads/96652ac166a5da2a9fa20c533f381118/Capture_d_écran_du_2025-05-16_12-27-36.png) Cron Import S3 → DB (Tous les mardis à samedis à 04h30)

### Composants principaux

1. **Application Django**
   - **Models**
     - Stage (catalogue formations)
     - Session (instances formations)
     - Période (créneaux formation)
   
   - **Views**
     - Recherche catalogue
     - Visualisation cartographique
     - Filtres et facettes
   
   - **Templates**
     - Design System État (DSFR)
     - Interface responsive
     - Templates accessibles RGAA

2. **MeiliSearch**
   - **Index stages**
     - Titre formation
     - Mots-clés
     - Localisation
   
   - **Index sessions**
     - Dates
     - Lieux
     - Places disponibles

3. **PostgreSQL**
   - **Tables**
     - formations_stage
     - formations_session
     - formations_periode
   
   - **Contraintes**
     - Intégrité référentielle
     - Validations métier

4. **Intégration RenoiRH**
   - **Import SFTP → S3** (4h00)
     ```python
     # VM Sèche: 10.167.71.51
     # filepath: /home/admingti/recup_data.sh
     # Récupération quotidienne (mar-sam)
     # Archive jour précédent
     # Import nouveaux fichiers
     ```
   
   - **Import S3 → DB** (4h30)
     ```python
     # filepath: app/management/commands/import_cisirh.py
     # Parse fichiers CSV
     # Import PostgreSQL
     # Index MeiliSearch
     ```
## Vue Exécution

### Scénario 1: Indexation des données RenoiRH

```mermaid
sequenceDiagram
    Cron->>+Django: Déclenche ReindexAll
    Django->>+PostgreSQL: Récupère données
    PostgreSQL-->>-Django: Retourne stages/sessions
    Django->>+MeiliSearch: Indexe données
    MeiliSearch-->>-Django: Confirmation indexation
```

### Scénario 2: Recherche utilisateur

```mermaid
sequenceDiagram
    User->>+Frontend: Saisit recherche
    Frontend->>+MeiliSearch: Query API
    MeiliSearch->>+MeiliSearch: Recherche index
    MeiliSearch-->>-Frontend: Résultats
    Frontend->>+Django: Détails formations
    Django-->>-User: Affiche résultats
```

## Vue Déploiement

### Environnements

| Environnement | Serveur | Usage | URL |
|--------------|-------------|------------|------------|
| Développement | 192.168.5.139 | Tests et validation | http://dev.formation-ecologie.pnm3.eco4.cloud.e2.rie.gouv.fr/ |
| Production | 192.168.5.52 | Production | http://formation-ecologie.e2.rie.gouv.fr/ |

### Infrastructure

Le produit est hébergé sur le cloud interne ECO4 basé sur Openstack, dans le tenant 'pnm3' du département.
Le reverse-proxy Nginx du schéma ci-dessous est en fait une paire de Nginx load-balancés en frontal des produits hébergés sur le tenant.

```mermaid
graph TD
    A[Nginx] --> B[Django App]
    B --> C[PostgreSQL]
    B --> D[MeiliSearch]
```

### Supervision

Le produit est supervisé via le système standard du GTI pour ce faire :

* via Portainer pour la partie purement containérisation,
* via la stack Prometheus/Grafana/Loki/AlertManager,

Le produit dispose également d'une supervision PSIN.

### Sauvegardes

Les sauvegardes de la base de données sont assurées par des scripts standards du GTI permettant la création de dumps cryptés en AES-256 et déposés sur :

* le stockage objet B3 du IaaS ministériel,
* le stockage objet Outscale SecNumCloud (via la prestation qu'a le GTI sur le marché "Nuage Public"),
* le stockage objet standard de Google Cloud (via la prestation qu'a le GTI sur le marché "Nuage Public")

## Sujets transverses

1. **Gestion des données**
   - Import catalogue RenoiRH
   - Indexation MeiliSearch

2. **Monitoring**
   - Logs Django
   - Métriques MeiliSearch
   - Surveillance base de données

3. **Maintenance**
   - Commandes make
   - Crons d'indexation
   - Mises à jour dépendances Poetry

## Exigences de qualité

| Exigence | Validation | Mesure |
|----------|------------|--------|
| Performance recherche | < 200ms | Logs MeiliSearch |
| Conformité DSFR | Audit visuel | Checklist Design System |
| Maintenance | Poetry/Make | Facilité mise à jour |

## Risques et Dettes techniques

1. **Dette**: Documentation indexation
   - Impact: Moyen
   - Solution: Documentation des processus MeiliSearch

## Annexes

### Glossaire

- **RenoiRH**: Système RH source des données
- **DSFR**: Design System de l'État
- **GTI**: Groupe Technique Informatique

### Décisions d'architectures - ADR

- [ADR-001] Choix MeiliSearch vs Elasticsearch
````

</details>


---

### 📄 `si/gta-scripts.md` [17.100 octets]
<a id="si-gta-scripts-md"></a> [↩ Retour à l'arborescence](#tree-si-gta-scripts-md)

> **Chemin relatif** : `si/gta-scripts.md`  
> **Taille** : 17.100 octets  
> **Lignes** : 513  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (513 lignes) - Cliquer pour déplier</summary>

````markdown
﻿# Projet : gta-scripts

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\gta-scripts`

**Fichiers** : 3 fichiers non-binaires

## 📁 Arborescence des fichiers

├── **conf/**
│   └── <a id="tree-conf-adminrh-crontab"></a>[adminrh.crontab](#conf-adminrh-crontab) *(1.330 octets)*
├── **src/**
│   └── <a id="tree-src-GTA-py"></a>[GTA.py](#src-GTA-py) *(10.569 octets)*
└── <a id="tree-README-md"></a>[README.md](#README-md) *(234 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `conf/adminrh.crontab` [1.330 octets]
<a id="conf-adminrh-crontab"></a> [↩ Retour à l'arborescence](#tree-conf-adminrh-crontab)

> **Chemin relatif** : `conf/adminrh.crontab`  
> **Taille** : 1.330 octets  
> **Lignes** : 43  
> **Type** : text

```text
# =======================
# --- Traitements GTA ---
# ----- PRODUCTION -----
# =======================
#
# Lancement script 01_recuperation_pointages.sh tous les jours à 20 h 31
#
31 20 * * * /app/GTA/scripts/01_recuperation_pointages.sh
#
# Lancement script 02_lancement_Python.sh tous les jours à 20 h 33
#
33 20 * * * /app/GTA/scripts/02_lancement_Python.sh
#
# Lancement script 03_archivage_fichier_Paris.sh tous les jours à 21 h 05
#
35 20 * * * /app/GTA/scripts/03_archivage_fichier_Paris.sh
#
# Lancement script 04_deplacement_fichier_Paris.sh tous les jours à 21 h 07
#
37 20 * * * /app/GTA/scripts/04_deplacement_fichier_Paris.sh
#
# Lancement script 05_presence_fic_hstmlt.sh tous les jours à 04 h 31
#
31 04 * * * /app/GTA/scripts/05_presence_fic_hstmlt.sh
#
# Lancement script 06_suppression_pointages.sh tous les jours à 04 h 36
#
36 04 * * * /app/GTA/scripts/06_suppression_pointages.sh
#
# Lancement script 07_archivage_pointages_evenements.sh tous les jours à 07 h 01
#
01 07 * * * /app/GTA/scripts/07_archivage_pointages_evenements.sh
#


# Check des pointage de province
#
15 02 * * * docker run --rm -v "/app/gta:/app/gta" -v "/opt/ternet:/opt/ternet" pointage_province
#
# Lancement script count_pointage_paris.py tous les jours à 22 h 00
#
01 00 * * * python3 /app/gta/python/count_pointage_paris.py
#
```


---

### 📄 `README.md` [234 octets]
<a id="README-md"></a> [↩ Retour à l'arborescence](#tree-README-md)

> **Chemin relatif** : `README.md`  
> **Taille** : 234 octets  
> **Lignes** : 10  
> **Type** : markdown

```markdown
# Prérequis :

Python 3

# Exécution :

L'ensemble des scripts sont déclenchés via un crontab du user **adminrh** fourni dans le dossier _/conf_

Le schéma de fonctionnement de l'ensemble des scripts est disponible dans le wiki.

```


---

### 📄 `src/GTA.py` [10.569 octets]
<a id="src-GTA-py"></a> [↩ Retour à l'arborescence](#tree-src-GTA-py)

> **Chemin relatif** : `src/GTA.py`  
> **Taille** : 10.569 octets  
> **Lignes** : 254  
> **Type** : python

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (254 lignes) - Cliquer pour déplier</summary>

```python
# -*- coding: utf-8 -*-
"""
Version : 2.0
* Regle 1a)
* Regle 1b)
* Regle 2)
* Regle 3)
Date : 21/07/2022
PNM 6
"""
from datetime import datetime
from datetime import timedelta
import sys
#================ PARAMETRISATION MCO =======================
x1 = 180#secondes pour la regle 1A
x2 = 180#secondes pour la regle 1B
x3 = 15#minutes pour la regle 2, par defaut 15 minutes
x4 = 30#minutes pour la regle 3, par defaut 30 minutes
nom_fichier_regle = "POINTAGES.csv"#nom du fichier provenant de la DAF
nom_fichier_logs = "LOGS_POINTAGES.txt" #nom du fichier de logs produit quotidiennement
nom_fichier_resultat = "PARIS.CSV" #Nom du fichier genere par le script
#============================================================
    
#Structures globales
liste_logs=[]

#Etape 1
Liste_identifiants = []
fichier_csv = open(nom_fichier_regle, "r")
#next(fichier_csv)
lignes = fichier_csv.readlines()
for i in lignes:
    ligne=i.split(";")
    identifiant = ligne[0]
    Liste_identifiants.append(identifiant)
fichier_csv.close()
#suppression des doublons pour avoir la liste des matricules
Liste_identifiants = list(set(Liste_identifiants))
#Creation du dictionnaire matricules
dico_matricules = {}
for i in Liste_identifiants:
    dico_matricules[i]=[]
    

    
#Lecture du fichier
fichier_csv = open(nom_fichier_regle, "r")
#next(fichier_csv)
lignes = fichier_csv.readlines()
for i in lignes:
    ligne=i.split(";")
    if not "\n" in ligne[6]: #gestion de la derniere ligne vide le cas echeant
        ligne[6]=ligne[6]+"\n"
    identifiant = ligne[0]
    dico_matricules[identifiant].append(ligne)
    #print(dico_matricules)
fichier_csv.close()


#print(dico_matricules['000000B9201000'])

#pointage i et j ont des structures de listes
def Tester(pointage_i,pointage_j,x1,x2,x3,x4):
    date_annee_i = int(pointage_i[1].split('/')[2])
    date_mois_i = int(pointage_i[1].split('/')[1])
    date_jour_i = int(pointage_i[1].split('/')[0])
    date_heure_i = int(pointage_i[2])
    date_minute_i = int(pointage_i[3])
    date_seconde_i = int(pointage_i[4])
    date_i = datetime(date_annee_i, date_mois_i,date_jour_i,date_heure_i,date_minute_i,date_seconde_i,0)
    
    date_annee_j = int(pointage_j[1].split('/')[2])
    date_mois_j = int(pointage_j[1].split('/')[1])
    date_jour_j = int(pointage_j[1].split('/')[0])
    date_heure_j = int(pointage_j[2])
    date_minute_j = int(pointage_j[3])
    date_seconde_j = int(pointage_j[4])
    date_j = datetime(date_annee_j, date_mois_j,date_jour_j,date_heure_j,date_minute_j,date_seconde_j,0)
    
    #Difference entre deux dates
    delta = date_j - date_i 

    #Regle 1A
    if pointage_i[5] == pointage_j[5] and delta.total_seconds() <=x1 :
        return "1A"
    
    #Regle 1B 
    if pointage_i[5] != pointage_j[5] and delta.total_seconds() <=x2 :#Bug logique : sortie-entree ou entree-sortie en moins de x2 seconde
        return "1B"   

    #Regle 2
    if pointage_i[5] != pointage_j[5] and delta.total_seconds() <=x3*60 :#Bug logique : entree-sortie 
        if ''.join(pointage_i[6][0:3]) != ''.join(pointage_j[6][0:3]) :
            return "2"
      
    #Regle 3
    if pointage_i[5] != pointage_j[5] and delta.total_seconds() <=x4*60 :#Bug logique : entree-sortie avec mois de x4*60 secondes (x4 en min)
        if (''.join(pointage_i[6][0:3]) == "APS" or ''.join(pointage_i[6][0:3]) == "SEQ" or ''.join(pointage_i[6][0:3]) == "PLI") and ''.join(pointage_j[6][0:3]) == "NAN":                
            return "3"
        if ''.join(pointage_i[6][0:3]) == "NAN" and (''.join(pointage_j[6][0:3]) == "SEQ" or ''.join(pointage_j[6][0:3]) == "PLI" or ''.join(pointage_j[6][0:3]) == "APS"):                
            return "3"
        if ''.join(pointage_i[6][0:3]) == "STG" and (''.join(pointage_j[6][0:3]) == "SEQ" or ''.join(pointage_j[6][0:3]) == "PLI" or ''.join(pointage_j[6][0:3]) == "APS"):                
            return "3"
        if (''.join(pointage_i[6][0:3]) == "APS" or ''.join(pointage_i[6][0:3]) == "SEQ" or ''.join(pointage_i[6][0:3]) == "PLI") and ''.join(pointage_j[6][0:3])  == "STG":                
            return "3"
        if ''.join(pointage_i[6][0:3]) == "STG" and ''.join(pointage_j[6][0:3])  == "NAN" :
            return "3"                        
        if ''.join(pointage_i[6][0:3]) == "NAN" and ''.join(pointage_j[6][0:3]) == "STG" :
            return "3"  




#Regle
#1) Suppression des doublons proches
#Si on a à la fois le deuxième pointage à moins de x secondes du premier
#et les deux pointages dans le même sens, on supprime le deuxième badgeage (règle 1a).
            
"""
Première passe : On applique d'abord la règle 
1a pour tous les couples de pointages successifs (P1/P2, puis P2/P3, puis P3/P4,...). 
Quand la règle élimine le deuxième pointage du couple P1/P2, on considère ensuite le couple P1/P3.
"""        
def FONTION_PHASE_1(x1,x2,x3,x4):
    for i in dico_matricules:
        k = 0

        Max = len(dico_matricules[i])
        while k < Max-1:
            regle = Tester(dico_matricules[i][k],dico_matricules[i][k+1],x1,x2,x3,x4)
            

                
            if regle == "1A":
                liste_logs.append(str(dico_matricules[i][k+1])+" -> REGLE 1A")
                del dico_matricules[i][k+1]
                Max = Max - 1
#            elif regle == "1B" or regle == "2" or regle == "3":
#                if regle == "1B":
#                    liste_logs.append(str(dico_matricules[i][k])+" -> REGLE 1B")
#                    liste_logs.append(str(dico_matricules[i][k+1])+" -> REGLE 1B")                    
#                    del dico_matricules[i][k]
#                    del dico_matricules[i][k]
#                    Max = Max - 2
#                    if k > 1:
#                        k = k - 1
#                if regle == "2":
#                    liste_logs.append(str(dico_matricules[i][k])+" -> REGLE 2")
#                    liste_logs.append(str(dico_matricules[i][k+1])+" -> REGLE 2") 
#                    del dico_matricules[i][k]
#                    del dico_matricules[i][k]
#                    Max = Max - 2
#                    if k > 1:
#                        k = k - 1                        
#                if regle == "3":
#                    liste_logs.append(str(dico_matricules[i][k])+" -> REGLE 3")
#                    liste_logs.append(str(dico_matricules[i][k+1])+" -> REGLE 3") 
#                    del dico_matricules[i][k]
#                    del dico_matricules[i][k]
#                    Max = Max - 2
#                    if k > 1:
#                        k = k - 1                        
            else:
                k = k + 1
            #print(k)
    return dico_matricules
    
#print(dico_matricules)
FONTION_PHASE_1(x1,x2,x3,x4)

"""
Deuxième passe : On recommence en appliquant pour chaque couple de pointage les règles 
dans l'ordre 1b, 2 et 3, pour tous les couples de 
pointages successifs (P1/P2, puis P2/P3, puis P3/P4,...)
Dès qu'une règle élimine des pointages, on ne regarde plus les autres règles pour ce couple.
Si une règle élimine les deux pointages du couple P2/P3, 
on recule d'un pointage pour considérer le couple P1/P4.
Mais si on ne peux pas reculer, par exemple quand 
une règle élimine les deux pointages du couple P1/P2, on considère ensuite le couple P3/P4.
"""


def FONTION_PHASE_2(x1,x2,x3,x4):
    for i in dico_matricules:
        k = 0

        Max = len(dico_matricules[i])
        while k < Max-1:
            regle = Tester(dico_matricules[i][k],dico_matricules[i][k+1],x1,x2,x3,x4)
            

            if regle == "1B" or regle == "2" or regle == "3":
                if regle == "1B":
                    liste_logs.append(str(dico_matricules[i][k])+" -> REGLE 1B")
                    liste_logs.append(str(dico_matricules[i][k+1])+" -> REGLE 1B")                    
                    del dico_matricules[i][k]
                    del dico_matricules[i][k]
                    Max = Max - 2
                    if k > 1:
                        k = k - 1
                if regle == "2":
                    liste_logs.append(str(dico_matricules[i][k])+" -> REGLE 2")
                    liste_logs.append(str(dico_matricules[i][k+1])+" -> REGLE 2") 
                    del dico_matricules[i][k]
                    del dico_matricules[i][k]
                    Max = Max - 2
                    if k > 1:
                        k = k - 1                        
                if regle == "3":
                    liste_logs.append(str(dico_matricules[i][k])+" -> REGLE 3")
                    liste_logs.append(str(dico_matricules[i][k+1])+" -> REGLE 3") 
                    del dico_matricules[i][k]
                    del dico_matricules[i][k]
                    Max = Max - 2
                    if k > 1:
                        k = k - 1                        
            else:
                k = k + 1
            #print(k)

    return dico_matricules
FONTION_PHASE_2(x1,x2,x3,x4)




#Ecriture fichier #ne pas ecrire le sens les sorties ou des entrees "Pour information, l'information entrée ou sortie n'est pas à transmettre au CISIRH qui ne sait pas la traiter."
def Ecriture(dico_matricules):#suppression de la colonne E/S et de la colonne sur les sites (lieux de badgeage)
    Fichier = open(nom_fichier_resultat, 'w')
    for i in dico_matricules:#dico_matricules[i] est une liste de pointage pour un matricule specifique
        ligne=""
        #print(dico_matricules[&i])
        for j in range(0, len(dico_matricules[i])):#j est le nombre d'enregistrements par matricule
            #print(dico_matricules[i][j])
            del dico_matricules[i][j][5]
            del dico_matricules[i][j][5]            
            #A faire pour la colone des sites
            #print(dico_matricules[i][j])
            ligne = ';'.join(dico_matricules[i][j])
            #print(dico_matricules[i][j])
            Fichier.write(ligne)
        #Fichier.write("\n")
    Fichier.close()
Ecriture(dico_matricules)

#ecriture des logs
def Ecriture_logs():
    Fichier = open(nom_fichier_logs, 'w')
    Fichier.write("** PARAMETRES : x1 = "+ str(x1)+ ", x2 = "+ str(x2)+ ", x3 = "+ str(x3)+ ", x4 = "+ str(x4) + "**\n")   
    for i in liste_logs:
            Fichier.write(i+"\n")
    Fichier.close()
Ecriture_logs()

```

</details>


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

````

</details>


---

### 📄 `si/honore-front.md` [695.533 octets]
<a id="si-honore-front-md"></a> [↩ Retour à l'arborescence](#tree-si-honore-front-md)

> **Chemin relatif** : `si/honore-front.md`  
> **Taille** : 695.533 octets  
> **Lignes** : 21571  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (21571 lignes) - Cliquer pour déplier</summary>

`````markdown
﻿# Projet : honore-front

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\honore-front`

**Fichiers** : 84 fichiers non-binaires

## 📁 Arborescence des fichiers

├── **docker/**
│   └── <a id="tree-docker-nginx-conf"></a>[nginx.conf](#docker-nginx-conf) *(886 octets)*
├── **public/**
│   └── <a id="tree-public-index-html"></a>[index.html](#public-index-html) *(761 octets)*
├── **src/**
│   ├── **assets/**
│   │   └── <a id="tree-src-assets--gitkeep"></a>[.gitkeep](#src-assets--gitkeep) *(0 octets)*
│   ├── **components/**
│   │   ├── <a id="tree-src-components--gitkeep"></a>[.gitkeep](#src-components--gitkeep) *(0 octets)*
│   │   ├── <a id="tree-src-components-Alert-vue"></a>[Alert.vue](#src-components-Alert-vue) *(1.922 octets)*
│   │   ├── <a id="tree-src-components-Draft-vue"></a>[Draft.vue](#src-components-Draft-vue) *(6.923 octets)*
│   │   ├── <a id="tree-src-components-FeedbackModal-vue"></a>[FeedbackModal.vue](#src-components-FeedbackModal-vue) *(2.886 octets)*
│   │   ├── <a id="tree-src-components-Footer-vue"></a>[Footer.vue](#src-components-Footer-vue) *(3.568 octets)*
│   │   ├── <a id="tree-src-components-Header-vue"></a>[Header.vue](#src-components-Header-vue) *(13.643 octets)*
│   │   ├── <a id="tree-src-components-SearchApplicantDialog-vue"></a>[SearchApplicantDialog.vue](#src-components-SearchApplicantDialog-vue) *(5.121 octets)*
│   │   ├── <a id="tree-src-components-Selector-vue"></a>[Selector.vue](#src-components-Selector-vue) *(1.428 octets)*
│   │   └── <a id="tree-src-components-TextField-vue"></a>[TextField.vue](#src-components-TextField-vue) *(1.998 octets)*
│   ├── **modules/**
│   │   ├── **archives/**
│   │   │   └── **screens/**
│   │   │       └── <a id="tree-src-modules-archives-screens-ArchiveScreen-vue"></a>[ArchiveScreen.vue](#src-modules-archives-screens-ArchiveScreen-vue) *(25.477 octets)*
│   │   ├── **folders/**
│   │   │   ├── **components/**
│   │   │   │   ├── <a id="tree-src-modules-folders-components-AddTags-vue"></a>[AddTags.vue](#src-modules-folders-components-AddTags-vue) *(4.072 octets)*
│   │   │   │   ├── <a id="tree-src-modules-folders-components-AttributionDialog-vue"></a>[AttributionDialog.vue](#src-modules-folders-components-AttributionDialog-vue) *(2.474 octets)*
│   │   │   │   ├── <a id="tree-src-modules-folders-components-FolderComments-vue"></a>[FolderComments.vue](#src-modules-folders-components-FolderComments-vue) *(8.541 octets)*
│   │   │   │   ├── <a id="tree-src-modules-folders-components-FolderDetailHeader-vue"></a>[FolderDetailHeader.vue](#src-modules-folders-components-FolderDetailHeader-vue) *(9.618 octets)*
│   │   │   │   ├── <a id="tree-src-modules-folders-components-FolderInformationUpdate-vue"></a>[FolderInformationUpdate.vue](#src-modules-folders-components-FolderInformationUpdate-vue) *(15.029 octets)*
│   │   │   │   ├── <a id="tree-src-modules-folders-components-FolderResume-vue"></a>[FolderResume.vue](#src-modules-folders-components-FolderResume-vue) *(12.801 octets)*
│   │   │   │   ├── <a id="tree-src-modules-folders-components-LHONMPresentation-vue"></a>[LHONMPresentation.vue](#src-modules-folders-components-LHONMPresentation-vue) *(26.894 octets)*
│   │   │   │   ├── <a id="tree-src-modules-folders-components-MMPresentation-vue"></a>[MMPresentation.vue](#src-modules-folders-components-MMPresentation-vue) *(34.414 octets)*
│   │   │   │   ├── <a id="tree-src-modules-folders-components-MoveDialog-vue"></a>[MoveDialog.vue](#src-modules-folders-components-MoveDialog-vue) *(2.234 octets)*
│   │   │   │   ├── <a id="tree-src-modules-folders-components-PresentationList-vue"></a>[PresentationList.vue](#src-modules-folders-components-PresentationList-vue) *(3.125 octets)*
│   │   │   │   └── <a id="tree-src-modules-folders-components-PresentationsScreen-vue"></a>[PresentationsScreen.vue](#src-modules-folders-components-PresentationsScreen-vue) *(8.458 octets)*
│   │   │   ├── **layout/**
│   │   │   │   └── <a id="tree-src-modules-folders-layout-FilesFollowUpLayout-vue"></a>[FilesFollowUpLayout.vue](#src-modules-folders-layout-FilesFollowUpLayout-vue) *(289 octets)*
│   │   │   └── **screens/**
│   │   │       ├── <a id="tree-src-modules-folders-screens-ApplicantsList-vue"></a>[ApplicantsList.vue](#src-modules-folders-screens-ApplicantsList-vue) *(42.445 octets)*
│   │   │       └── <a id="tree-src-modules-folders-screens-FolderDetail-vue"></a>[FolderDetail.vue](#src-modules-folders-screens-FolderDetail-vue) *(6.066 octets)*
│   │   ├── **home/**
│   │   │   └── **screens/**
│   │   │       ├── <a id="tree-src-modules-home-screens-Accessibility-vue"></a>[Accessibility.vue](#src-modules-home-screens-Accessibility-vue) *(9.045 octets)*
│   │   │       ├── <a id="tree-src-modules-home-screens-Cookies-vue"></a>[Cookies.vue](#src-modules-home-screens-Cookies-vue) *(578 octets)*
│   │   │       ├── <a id="tree-src-modules-home-screens-DraftList-vue"></a>[DraftList.vue](#src-modules-home-screens-DraftList-vue) *(14.191 octets)*
│   │   │       ├── <a id="tree-src-modules-home-screens-Home-vue"></a>[Home.vue](#src-modules-home-screens-Home-vue) *(6.783 octets)*
│   │   │       ├── <a id="tree-src-modules-home-screens-LegalMentions-vue"></a>[LegalMentions.vue](#src-modules-home-screens-LegalMentions-vue) *(799 octets)*
│   │   │       └── <a id="tree-src-modules-home-screens-Privacy-vue"></a>[Privacy.vue](#src-modules-home-screens-Privacy-vue) *(1.061 octets)*
│   │   ├── **onBoarding/**
│   │   │   ├── **components/**
│   │   │   │   ├── **help/**
│   │   │   │   │   ├── **activityArea/**
│   │   │   │   │   │   ├── <a id="tree-src-modules-onBoarding-components-help-activityArea-ActivityAreaHelpDialog-vue"></a>[ActivityAreaHelpDialog.vue](#src-modules-onBoarding-components-help-activityArea-ActivityAreaHelpDialog-vue) *(1.955 octets)*
│   │   │   │   │   │   ├── <a id="tree-src-modules-onBoarding-components-help-activityArea-AdministrativeHelpContent-vue"></a>[AdministrativeHelpContent.vue](#src-modules-onBoarding-components-help-activityArea-AdministrativeHelpContent-vue) *(7.188 octets)*
│   │   │   │   │   │   └── <a id="tree-src-modules-onBoarding-components-help-activityArea-CivilHelpContent-vue"></a>[CivilHelpContent.vue](#src-modules-onBoarding-components-help-activityArea-CivilHelpContent-vue) *(3.358 octets)*
│   │   │   │   │   ├── <a id="tree-src-modules-onBoarding-components-help-ContingentTypeDialog-vue"></a>[ContingentTypeDialog.vue](#src-modules-onBoarding-components-help-ContingentTypeDialog-vue) *(3.500 octets)*
│   │   │   │   │   └── <a id="tree-src-modules-onBoarding-components-help-GradeHelpDialog-vue"></a>[GradeHelpDialog.vue](#src-modules-onBoarding-components-help-GradeHelpDialog-vue) *(2.187 octets)*
│   │   │   │   ├── <a id="tree-src-modules-onBoarding-components-DateBox-vue"></a>[DateBox.vue](#src-modules-onBoarding-components-DateBox-vue) *(960 octets)*
│   │   │   │   ├── <a id="tree-src-modules-onBoarding-components-DraggableFile-vue"></a>[DraggableFile.vue](#src-modules-onBoarding-components-DraggableFile-vue) *(2.661 octets)*
│   │   │   │   ├── <a id="tree-src-modules-onBoarding-components-LHOnmValidation-vue"></a>[LHOnmValidation.vue](#src-modules-onBoarding-components-LHOnmValidation-vue) *(15.601 octets)*
│   │   │   │   ├── <a id="tree-src-modules-onBoarding-components-MMValidation-vue"></a>[MMValidation.vue](#src-modules-onBoarding-components-MMValidation-vue) *(20.304 octets)*
│   │   │   │   ├── <a id="tree-src-modules-onBoarding-components-SaveConfirmation-vue"></a>[SaveConfirmation.vue](#src-modules-onBoarding-components-SaveConfirmation-vue) *(1.618 octets)*
│   │   │   │   ├── <a id="tree-src-modules-onBoarding-components-SearchArchive-vue"></a>[SearchArchive.vue](#src-modules-onBoarding-components-SearchArchive-vue) *(3.714 octets)*
│   │   │   │   └── <a id="tree-src-modules-onBoarding-components-Stepper-vue"></a>[Stepper.vue](#src-modules-onBoarding-components-Stepper-vue) *(2.427 octets)*
│   │   │   ├── **layout/**
│   │   │   │   └── <a id="tree-src-modules-onBoarding-layout-OnBoardingLayout-vue"></a>[OnBoardingLayout.vue](#src-modules-onBoarding-layout-OnBoardingLayout-vue) *(5.362 octets)*
│   │   │   └── **screens/**
│   │   │       ├── **lhOnm/**
│   │   │       │   ├── <a id="tree-src-modules-onBoarding-screens-lhOnm-ActivityScreen-vue"></a>[ActivityScreen.vue](#src-modules-onBoarding-screens-lhOnm-ActivityScreen-vue) *(20.217 octets)*
│   │   │       │   └── <a id="tree-src-modules-onBoarding-screens-lhOnm-Annuity-vue"></a>[Annuity.vue](#src-modules-onBoarding-screens-lhOnm-Annuity-vue) *(10.477 octets)*
│   │   │       ├── **meriteMaritime/**
│   │   │       │   ├── <a id="tree-src-modules-onBoarding-screens-meriteMaritime-DemandInformation-vue"></a>[DemandInformation.vue](#src-modules-onBoarding-screens-meriteMaritime-DemandInformation-vue) *(23.965 octets)*
│   │   │       │   └── <a id="tree-src-modules-onBoarding-screens-meriteMaritime-TrainingInformation-vue"></a>[TrainingInformation.vue](#src-modules-onBoarding-screens-meriteMaritime-TrainingInformation-vue) *(11.670 octets)*
│   │   │       ├── <a id="tree-src-modules-onBoarding-screens-DecorationChoice-vue"></a>[DecorationChoice.vue](#src-modules-onBoarding-screens-DecorationChoice-vue) *(3.408 octets)*
│   │   │       ├── <a id="tree-src-modules-onBoarding-screens-DocumentInformation-vue"></a>[DocumentInformation.vue](#src-modules-onBoarding-screens-DocumentInformation-vue) *(17.324 octets)*
│   │   │       ├── <a id="tree-src-modules-onBoarding-screens-PathValidated-vue"></a>[PathValidated.vue](#src-modules-onBoarding-screens-PathValidated-vue) *(3.970 octets)*
│   │   │       ├── <a id="tree-src-modules-onBoarding-screens-PersonalInformation-vue"></a>[PersonalInformation.vue](#src-modules-onBoarding-screens-PersonalInformation-vue) *(26.343 octets)*
│   │   │       ├── <a id="tree-src-modules-onBoarding-screens-SearchHonoreArchive-vue"></a>[SearchHonoreArchive.vue](#src-modules-onBoarding-screens-SearchHonoreArchive-vue) *(5.660 octets)*
│   │   │       └── <a id="tree-src-modules-onBoarding-screens-ValidationScreen-vue"></a>[ValidationScreen.vue](#src-modules-onBoarding-screens-ValidationScreen-vue) *(1.278 octets)*
│   │   ├── **recommandants/**
│   │   │   ├── **components/**
│   │   │   │   ├── <a id="tree-src-modules-recommandants-components-RecommandantForm-vue"></a>[RecommandantForm.vue](#src-modules-recommandants-components-RecommandantForm-vue) *(4.781 octets)*
│   │   │   │   ├── <a id="tree-src-modules-recommandants-components-RecommandantManagementForm-vue"></a>[RecommandantManagementForm.vue](#src-modules-recommandants-components-RecommandantManagementForm-vue) *(9.791 octets)*
│   │   │   │   ├── <a id="tree-src-modules-recommandants-components-RecommandantResume-vue"></a>[RecommandantResume.vue](#src-modules-recommandants-components-RecommandantResume-vue) *(1.891 octets)*
│   │   │   │   └── <a id="tree-src-modules-recommandants-components-Recommandations-vue"></a>[Recommandations.vue](#src-modules-recommandants-components-Recommandations-vue) *(5.234 octets)*
│   │   │   └── **screens/**
│   │   │       ├── <a id="tree-src-modules-recommandants-screens-RecommandantDetail-vue"></a>[RecommandantDetail.vue](#src-modules-recommandants-screens-RecommandantDetail-vue) *(6.106 octets)*
│   │   │       └── <a id="tree-src-modules-recommandants-screens-RecommandantsListScreen-vue"></a>[RecommandantsListScreen.vue](#src-modules-recommandants-screens-RecommandantsListScreen-vue) *(7.280 octets)*
│   │   ├── **sessions/**
│   │   │   ├── **components/**
│   │   │   │   ├── <a id="tree-src-modules-sessions-components-LHONMPromotion-vue"></a>[LHONMPromotion.vue](#src-modules-sessions-components-LHONMPromotion-vue) *(33.140 octets)*
│   │   │   │   ├── <a id="tree-src-modules-sessions-components-MMPromotion-vue"></a>[MMPromotion.vue](#src-modules-sessions-components-MMPromotion-vue) *(26.784 octets)*
│   │   │   │   ├── <a id="tree-src-modules-sessions-components-SessionDialog-vue"></a>[SessionDialog.vue](#src-modules-sessions-components-SessionDialog-vue) *(11.828 octets)*
│   │   │   │   └── <a id="tree-src-modules-sessions-components-UpdateSessionDialog-vue"></a>[UpdateSessionDialog.vue](#src-modules-sessions-components-UpdateSessionDialog-vue) *(6.539 octets)*
│   │   │   └── **screens/**
│   │   │       ├── <a id="tree-src-modules-sessions-screens-SessionList-vue"></a>[SessionList.vue](#src-modules-sessions-screens-SessionList-vue) *(10.696 octets)*
│   │   │       └── <a id="tree-src-modules-sessions-screens-SessionScreen-vue"></a>[SessionScreen.vue](#src-modules-sessions-screens-SessionScreen-vue) *(3.102 octets)*
│   │   └── <a id="tree-src-modules--gitkeep"></a>[.gitkeep](#src-modules--gitkeep) *(0 octets)*
│   └── **styles/**
│       ├── <a id="tree-src-styles-base-scss"></a>[base.scss](#src-styles-base-scss) *(8.588 octets)*
│       ├── <a id="tree-src-styles-functions-scss"></a>[functions.scss](#src-styles-functions-scss) *(60 octets)*
│       ├── <a id="tree-src-styles-variables-module-scss"></a>[variables.module.scss](#src-styles-variables-module-scss) *(1.813 octets)*
│       └── <a id="tree-src-styles-variables-scss"></a>[variables.scss](#src-styles-variables-scss) *(2.422 octets)*
├── <a id="tree--browserslistrc"></a>[.browserslistrc](#-browserslistrc) *(21 octets)*
├── <a id="tree--dockerignore"></a>[.dockerignore](#-dockerignore) *(13 octets)*
├── <a id="tree--editorconfig"></a>[.editorconfig](#-editorconfig) *(172 octets)*
├── <a id="tree--eslintignore"></a>[.eslintignore](#-eslintignore) *(39 octets)*
├── <a id="tree--gitignore"></a>[.gitignore](#-gitignore) *(214 octets)*
├── <a id="tree--gitlab-ci-yml"></a>[.gitlab-ci.yml](#-gitlab-ci-yml) *(130 octets)*
├── <a id="tree--npmrc"></a>[.npmrc](#-npmrc) *(128 octets)*
├── <a id="tree-Dockerfile"></a>[Dockerfile](#Dockerfile) *(95 octets)*
├── <a id="tree-README-md"></a>[README.md](#README-md) *(6.338 octets)*
├── <a id="tree-index-html"></a>[index.html](#index-html) *(1.338 octets)*
└── <a id="tree-junit-xml"></a>[junit.xml](#junit-xml) *(390 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `.browserslistrc` [21 octets]
<a id="-browserslistrc"></a> [↩ Retour à l'arborescence](#tree--browserslistrc)

> **Chemin relatif** : `.browserslistrc`  
> **Taille** : 21 octets  
> **Lignes** : 3  
> **Type** : text

```text
> 1%
last 2 versions

```


---

### 📄 `.dockerignore` [13 octets]
<a id="-dockerignore"></a> [↩ Retour à l'arborescence](#tree--dockerignore)

> **Chemin relatif** : `.dockerignore`  
> **Taille** : 13 octets  
> **Lignes** : 2  
> **Type** : text

```text
node_modules

```


---

### 📄 `.editorconfig` [172 octets]
<a id="-editorconfig"></a> [↩ Retour à l'arborescence](#tree--editorconfig)

> **Chemin relatif** : `.editorconfig`  
> **Taille** : 172 octets  
> **Lignes** : 13  
> **Type** : text

```text
root = true

[*]
indent_style = space
indent_size = 2
end_of_line = lf
charset = utf-8
trim_trailing_whitespace = true
insert_final_newline = true

[*.yml]
indent_size = 2

```


---

### 📄 `.eslintignore` [39 octets]
<a id="-eslintignore"></a> [↩ Retour à l'arborescence](#tree--eslintignore)

> **Chemin relatif** : `.eslintignore`  
> **Taille** : 39 octets  
> **Lignes** : 5  
> **Type** : text

```text
**/*.d.ts
.eslintrc.js
dist
migrations

```


---

### 📄 `.gitignore` [214 octets]
<a id="-gitignore"></a> [↩ Retour à l'arborescence](#tree--gitignore)

> **Chemin relatif** : `.gitignore`  
> **Taille** : 214 octets  
> **Lignes** : 22  
> **Type** : text

```text
.DS_Store
node_modules
/dist

# local env files
.env.local
.env.*.local

# Log files
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# Editor directories and files
.idea
.vscode
*.suo
*.ntvs*
*.njsproj
*.sln
*.sw?

```


---

### 📄 `.gitlab-ci.yml` [130 octets]
<a id="-gitlab-ci-yml"></a> [↩ Retour à l'arborescence](#tree--gitlab-ci-yml)

> **Chemin relatif** : `.gitlab-ci.yml`  
> **Taille** : 130 octets  
> **Lignes** : 7  
> **Type** : yaml

```yaml
include:
  - project: "snum/pnm3/public/pasta/pasta-ci"
    file: "applications/front.yml"
variables:
  USE_NEW_REGISTRY: "true"


```


---

### 📄 `.npmrc` [128 octets]
<a id="-npmrc"></a> [↩ Retour à l'arborescence](#tree--npmrc)

> **Chemin relatif** : `.npmrc`  
> **Taille** : 128 octets  
> **Lignes** : 2  
> **Type** : text

```text
@pnm3:registry=https://europe-west9-npm.pkg.dev/dpnm3-lab/pnm3/
@pasta:registry=https://europe-west9-npm.pkg.dev/dpnm3-lab/pnm3/
```


---

### 📄 `docker/nginx.conf` [886 octets]
<a id="docker-nginx-conf"></a> [↩ Retour à l'arborescence](#tree-docker-nginx-conf)

> **Chemin relatif** : `docker/nginx.conf`  
> **Taille** : 886 octets  
> **Lignes** : 33  
> **Type** : conf

```conf
# from https://cli.vuejs.org/guide/deployment.html#docker-nginx

user  nginx;
worker_processes  1;
error_log  /var/log/nginx/error.log warn;
pid        /var/run/nginx.pid;
events {
  worker_connections  1024;
}
http {
  include       /etc/nginx/mime.types;
  default_type  application/octet-stream;
  log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                    '$status $body_bytes_sent "$http_referer" '
                    '"$http_user_agent" "$http_x_forwarded_for"';
  access_log  /var/log/nginx/access.log  main;
  sendfile        on;
  keepalive_timeout  65;
  server {
    listen       80;
    server_name  localhost;
    location / {
      root   /app;
      index  index.html;
      try_files $uri $uri/ /index.html;
    }
    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
      root   /usr/share/nginx/html;
    }
  }
}

```


---

### 📄 `Dockerfile` [95 octets]
<a id="Dockerfile"></a> [↩ Retour à l'arborescence](#tree-Dockerfile)

> **Chemin relatif** : `Dockerfile`  
> **Taille** : 95 octets  
> **Lignes** : 7  
> **Type** : dockerfile

```dockerfile
FROM nginx:latest

RUN mkdir /app
COPY dist /app
COPY docker/nginx.conf /etc/nginx/nginx.conf


```


---

### 📄 `index.html` [1.338 octets]
<a id="index-html"></a> [↩ Retour à l'arborescence](#tree-index-html)

> **Chemin relatif** : `index.html`  
> **Taille** : 1.338 octets  
> **Lignes** : 38  
> **Type** : html

```html
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <link rel="icon" href="favicon.ico">
  <title><%= htmlWebpackPlugin.options.title %></title>
  <script>
    const matomoId = window.location.hostname === "honore-dev.snum-pnm3.dev" ? '1557' : '1556';
    var _paq = _paq || [];
    _paq.push(['setDocumentTitle', document.title]);
    _paq.push(['setDownloadClasses', ["LienTelecharg","document"]]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
      var u="//audience-sites.din.developpement-durable.gouv.fr/";
      _paq.push(['setTrackerUrl', u+'piwik.php']);
      _paq.push(['setSiteId', matomoId]);
      var d=document, g=d.createElement('script'),
        s=d.getElementsByTagName('script')[0];
      g.type='text/javascript'; g.async=true;
      g.defer=true; g.src=u+'piwik.js';
      s.parentNode.insertBefore(g,s);
    })();
    function piwikTrackVideo(type,section,page,x1){
      _paq.push(['trackEvent', 'Video', 'Play', page]);
    }
  </script>
</head>
<body>
<noscript>
  <strong>Désolé, cette application ne peut fonctionner sans JavaScript, merci de l'activer.</strong>
</noscript>
<div id="app"></div>
</body>
</html>

```


---

### 📄 `junit.xml` [390 octets]
<a id="junit-xml"></a> [↩ Retour à l'arborescence](#tree-junit-xml)

> **Chemin relatif** : `junit.xml`  
> **Taille** : 390 octets  
> **Lignes** : 7  
> **Type** : xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<testsuites name="honore-front" tests="1" failures="0" errors="0" time="1.142">
  <testsuite name="dummy.unit.test.ts" errors="0" failures="0" skipped="0" timestamp="2023-12-08T16:11:16" time="0.528" tests="1">
    <testcase classname="dummy.unit.test.ts" name="dummy test &gt; should say ok" time="0.001">
    </testcase>
  </testsuite>
</testsuites>
```


---

### 📄 `public/index.html` [761 octets]
<a id="public-index-html"></a> [↩ Retour à l'arborescence](#tree-public-index-html)

> **Chemin relatif** : `public/index.html`  
> **Taille** : 761 octets  
> **Lignes** : 20  
> **Type** : html

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="icon" href="<%= BASE_URL %>favicon.ico">
    <title>Suivi plan</title>
    <!--<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@latest/css/materialdesignicons.min.css">-->
  </head>
  <body>
    <noscript>
      <strong>Désolé, cette application ne peut fonctionner sans JavaScript, merci de l'activer.</strong>
    </noscript>
    <div id="app"></div>
    <!-- built files will be auto injected -->
  </body>
</html>

```


---

### 📄 `README.md` [6.338 octets]
<a id="README-md"></a> [↩ Retour à l'arborescence](#tree-README-md)

> **Chemin relatif** : `README.md`  
> **Taille** : 6.338 octets  
> **Lignes** : 93  
> **Type** : markdown

````markdown
# honore-front

Pasta-Front application for Honore

## Getting started

To make it easy for you to get started with GitLab, here's a list of recommended next steps.

Already a pro? Just edit this README.md and make it your own. Want to make it easy? [Use the template at the bottom](#editing-this-readme)!

## Add your files

- [ ] [Create](https://docs.gitlab.com/ee/user/project/repository/web_editor.html#create-a-file) or [upload](https://docs.gitlab.com/ee/user/project/repository/web_editor.html#upload-a-file) files
- [ ] [Add files using the command line](https://docs.gitlab.com/ee/gitlab-basics/add-file.html#add-a-file-using-the-command-line) or push an existing Git repository with the following command:

```
cd existing_repo
git remote add origin https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/gti/honore/honore-front.git
git branch -M main
git push -uf origin main
```

## Integrate with your tools

- [ ] [Set up project integrations](https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/gti/honore/honore-front/-/settings/integrations)

## Collaborate with your team

- [ ] [Invite team members and collaborators](https://docs.gitlab.com/ee/user/project/members/)
- [ ] [Create a new merge request](https://docs.gitlab.com/ee/user/project/merge_requests/creating_merge_requests.html)
- [ ] [Automatically close issues from merge requests](https://docs.gitlab.com/ee/user/project/issues/managing_issues.html#closing-issues-automatically)
- [ ] [Enable merge request approvals](https://docs.gitlab.com/ee/user/project/merge_requests/approvals/)
- [ ] [Automatically merge when pipeline succeeds](https://docs.gitlab.com/ee/user/project/merge_requests/merge_when_pipeline_succeeds.html)

## Test and Deploy

Use the built-in continuous integration in GitLab.

- [ ] [Get started with GitLab CI/CD](https://docs.gitlab.com/ee/ci/quick_start/index.html)
- [ ] [Analyze your code for known vulnerabilities with Static Application Security Testing(SAST)](https://docs.gitlab.com/ee/user/application_security/sast/)
- [ ] [Deploy to Kubernetes, Amazon EC2, or Amazon ECS using Auto Deploy](https://docs.gitlab.com/ee/topics/autodevops/requirements.html)
- [ ] [Use pull-based deployments for improved Kubernetes management](https://docs.gitlab.com/ee/user/clusters/agent/)
- [ ] [Set up protected environments](https://docs.gitlab.com/ee/ci/environments/protected_environments.html)

***

# Editing this README

When you're ready to make this README your own, just edit this file and use the handy template below (or feel free to structure it however you want - this is just a starting point!).  Thank you to [makeareadme.com](https://www.makeareadme.com/) for this template.

## Suggestions for a good README
Every project is different, so consider which of these sections apply to yours. The sections used in the template are suggestions for most open source projects. Also keep in mind that while a README can be too long and detailed, too long is better than too short. If you think your README is too long, consider utilizing another form of documentation rather than cutting out information.

## Name
Choose a self-explaining name for your project.

## Description
Let people know what your project can do specifically. Provide context and add a link to any reference visitors might be unfamiliar with. A list of Features or a Background subsection can also be added here. If there are alternatives to your project, this is a good place to list differentiating factors.

## Badges
On some READMEs, you may see small images that convey metadata, such as whether or not all the tests are passing for the project. You can use Shields to add some to your README. Many services also have instructions for adding a badge.

## Visuals
Depending on what you are making, it can be a good idea to include screenshots or even a video (you'll frequently see GIFs rather than actual videos). Tools like ttygif can help, but check out Asciinema for a more sophisticated method.

## Installation
Within a particular ecosystem, there may be a common way of installing things, such as using Yarn, NuGet, or Homebrew. However, consider the possibility that whoever is reading your README is a novice and would like more guidance. Listing specific steps helps remove ambiguity and gets people to using your project as quickly as possible. If it only runs in a specific context like a particular programming language version or operating system or has dependencies that have to be installed manually, also add a Requirements subsection.

## Usage
Use examples liberally, and show the expected output if you can. It's helpful to have inline the smallest example of usage that you can demonstrate, while providing links to more sophisticated examples if they are too long to reasonably include in the README.

## Support
Tell people where they can go to for help. It can be any combination of an issue tracker, a chat room, an email address, etc.

## Roadmap
If you have ideas for releases in the future, it is a good idea to list them in the README.

## Contributing
State if you are open to contributions and what your requirements are for accepting them.

For people who want to make changes to your project, it's helpful to have some documentation on how to get started. Perhaps there is a script that they should run or some environment variables that they need to set. Make these steps explicit. These instructions could also be useful to your future self.

You can also document commands to lint the code or run tests. These steps help to ensure high code quality and reduce the likelihood that the changes inadvertently break something. Having instructions for running tests is especially helpful if it requires external setup, such as starting a Selenium server for testing in a browser.

## Authors and acknowledgment
Show your appreciation to those who have contributed to the project.

## License
For open source projects, say how it is licensed.

## Project status
If you have run out of energy or time for your project, put a note at the top of the README saying that development has slowed down or stopped completely. Someone may choose to fork your project or volunteer to step in as a maintainer or owner, allowing your project to keep going. You can also make an explicit request for maintainers.

````


---

### 📄 `src/assets/.gitkeep` [0 octets]
<a id="src-assets--gitkeep"></a> [↩ Retour à l'arborescence](#tree-src-assets--gitkeep)

> **Chemin relatif** : `src/assets/.gitkeep`  
> **Taille** : 0 octets  
> **Lignes** : 0  
> **Type** : text

```text

```


---

### 📄 `src/components/.gitkeep` [0 octets]
<a id="src-components--gitkeep"></a> [↩ Retour à l'arborescence](#tree-src-components--gitkeep)

> **Chemin relatif** : `src/components/.gitkeep`  
> **Taille** : 0 octets  
> **Lignes** : 0  
> **Type** : text

```text

```


---

### 📄 `src/components/Alert.vue` [1.922 octets]
<a id="src-components-Alert-vue"></a> [↩ Retour à l'arborescence](#tree-src-components-Alert-vue)

> **Chemin relatif** : `src/components/Alert.vue`  
> **Taille** : 1.922 octets  
> **Lignes** : 90  
> **Type** : text

```text
<template>
  <v-dialog
    transition="dialog-bottom-transition"
    max-width="800"
    v-model="open"
    :persistent="true"
  >
    <v-card style="position: relative">
      <v-icon @click="onCloseBtnClick" style="position: absolute; cursor: pointer; right: 20px; top: 20px;" color="primary">
        {{close}}
      </v-icon>
      <v-card-text class="text-dialog-container pa-12">
        <slot name="title"></slot>
        <slot name="message"></slot>
      </v-card-text>
      <v-card-actions v-if="action" class="justify-end pb-5" >
        <v-btn
          :outlined="!!withConfirmation"
          color="primary"
          @click="onCloseBtnClick"
        >
          {{ withConfirmation ? "Annuler" : "J'ai compris" }}
        </v-btn>
        <v-btn
          color="primary"
          class="ml-5"
          v-if="withConfirmation === true"
          @click="onConfirmBtnClick"
        >
          Confirmer
        </v-btn>
      </v-card-actions>
    </v-card>
  </v-dialog>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import {Prop} from "vue-property-decorator";
import { mdiClose } from "@mdi/js"

@Component
export default class Alert extends Vue {

  @Prop({required: true, default: false})
  declare open: boolean;

  @Prop({required: true})
  declare onClose: () => Promise<void> | void;

  @Prop({required: false})
  declare onConfirm: () => Promise<void> | void;

  @Prop({required: false, default: false})
  declare withConfirmation: boolean;

  @Prop({required: false, default: true})
  declare action: boolean;


  close = mdiClose

  onCloseBtnClick() {
    return this.onClose();
  }

  onConfirmBtnClick() {
    return this.onConfirm();
  }


}
</script>

<style lang="scss">
.text-dialog-container {
  text-align: left;
  h2 {
    color: #161616;
    font-size: 24px;
  }
  p {
    font-size: 16px;
    color: #3A3A3A;
  }
}

</style>

```


---

### 📄 `src/components/Draft.vue` [6.923 octets]
<a id="src-components-Draft-vue"></a> [↩ Retour à l'arborescence](#tree-src-components-Draft-vue)

> **Chemin relatif** : `src/components/Draft.vue`  
> **Taille** : 6.923 octets  
> **Lignes** : 268  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (268 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <div class="mb-5">
      <div class="darft_box">
        <div style="display: flex; justify-content: space-between;">
          <div>
            <div class="draft_body">
              <h3 style="margin-bottom: 10px" class="draft_sub_title">{{
                  getName()
                }}</h3>
            </div>
            <div class="draft_body">
              <p class="draft_info">{{ formatBirthDate(draft.personalInformation.birthDate) }}</p>
            </div>
          </div>
          <div>
            <p :class="'decoration ' + draft.decorationType">{{toDecorationType(draft.decorationType)}}</p>
          </div>
        </div>
        <div class="draft_body" v-if="progress">
          <div class="draft_inline">
            <p class="draft_progress">Progression</p>
            <p class="draft_percent">{{computeProgress()}}%</p>
          </div>
        </div>
        <div class="draft_body" v-if="progress">
          <v-progress-linear aria-hidden="true" :value="computeProgress()" height="8" color="#1269ED" :rounded="true"></v-progress-linear>
        </div>
        <div class="draft_flex_start" v-if="progress">
          <p class="draft_step">Etape {{ getStep() }}/4</p>
        </div>
        <div class="draft_flex_end">
          <v-btn
            v-if="onDelete != null"
            class="mx-2"
            fab
            small
            @click="onDeleteButtonClick"
            aria-label="Supprimer le dossier"
            title="Supprimer le dossier"
            style="box-shadow: none;background-color: transparent;"
          >
            <v-icon style="color: #3A3A3A;">
              {{ deleteIcon }}
            </v-icon>
            <span class="d-sr-only">Supprimer le dossier</span>
          </v-btn>
          <v-btn outlined class="darft_button" @click="onPrimaryBtnClick">
            <span style="margin-bottom: 0" class="darft_text">{{ buttonLabel != null ? buttonLabel : "Continuer le dossier en cours" }}</span>
          </v-btn>
        </div>
      </div>
      <div class="divider"></div>
    <alert
      :open="open"
      :with-confirmation="true"
      :on-close="onClose"
      :on-confirm="() => onDelete(draft.id)"
    >
      <template v-slot:title>
        <h2 class="pb-3">
          <v-icon large style="margin-bottom: 5px; color: #161616">
            {{infoIcon}}
          </v-icon>
          <span>Êtes-vous sûr de vouloir supprimer votre brouillon ?</span>
        </h2>
      </template>
      <template v-slot:message>
        <p>
          En faisant cela, votre brouillon sera définitivement supprimé.
        </p>
      </template>
    </alert>
    </div>
</template>

<script lang="ts">
import Vue from "vue";
import {Applicant} from "@/core/entities/Applicant";
import {lazyInject} from "@pasta/box/src/lib/container";
import Component from "vue-class-component";
import {Prop} from "vue-property-decorator";
import dayjs from "dayjs";
import {
  PersonalInformationViewModel
} from "@/modules/onBoarding/viewModels/personalInformation/PersonalInformationViewModel";
import {mdiInformationOutline, mdiTrashCanOutline} from '@mdi/js';
import Alert from "@/components/Alert.vue";
import {OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {toDecorationType} from "../core/valueObjects/toDecorationType";


@Component({
  methods: {toDecorationType},
  components: {
    Alert,
  }
})
export default class Draft extends Vue {
  @Prop({ required: true })
  declare draft: Applicant;

  open = false;


  onClose() {
    this.open = false;
  }

  deleteIcon = mdiTrashCanOutline;
  infoIcon = mdiInformationOutline;

  @Prop({required: false})
  declare onDelete: (applicantId: string) => Promise<void>;

  @Prop({required: true})
  declare progress: boolean;

  @Prop({required: false})
  declare buttonLabel: string;

  @Prop({required: true})
  declare onPrimaryBtnClick: () => void;


  onDeleteButtonClick() {
    this.open = true;
  }


  @lazyInject(PersonalInformationViewModel)
  declare personalInformationViewModel: PersonalInformationViewModel;

  @lazyInject(OnBoardingViewModel)
  declare onBoardingViewModel: OnBoardingViewModel;

  formatBirthDate(date: string): string {
    if (!date) {
      return "";
    }
    return "Né le " + dayjs(date).format('DD/MM/YYYY');
  }

  capitalize(value: string) {
    return value.charAt(0).toUpperCase() + value.slice(1).toLowerCase();
  }

  getName() {
    return `
     ${this.draft.personalInformation.birthName.toUpperCase()} ${this.draft.personalInformation.legalName ? `Ep. ${this.draft.personalInformation.legalName}` : ''} ${this.capitalize(this.draft.personalInformation.firstName)}
    `
  }


  getStep() {
    if (this.draft.onBoardingSteps) {
      return this.draft.onBoardingSteps.length;
    }
    return 0;
  }

  computeProgress() {
    if (this.draft.onBoardingSteps) {
      return ((this.draft.onBoardingSteps.length / 4) * 100).toFixed(0);
    }
    return 0;
  }
}
</script>

<style lang="scss">

.draft_flex_end {
  display: flex;
  justify-content: flex-end;
}

.draft_flex_start {
  display: flex;
  justify-content: flex-start;
}

.darft_button {
  height: 40px;
  padding: 10px;
  text-align: center!important;
  align-self: flex-end!important;
  border: solid 1px #e5e5e5;
  cursor: pointer;
}
.darft_text {
  color: #000091;
  margin-top: -5px;
  font-size: 16px !important;
  font-weight: 500;
  line-height: 24px;
}

.draft_step {
  margin-top: 5px;
  color: #000000;
  font-size: 12px !important;
}
  .darft_box {
    margin-right: 24px;
    padding: 30px;
    border: solid 1px #e5e5e5;
    box-shadow: 0px 4px 0px 0px #000091;
    .draft_title {
      color: #161616;
      font-size: 16px;
      font-weight: 700;
    }
    .draft_body {
      display: flex;
      .draft_inline {
        display: flex;
        width: 100%;
        justify-content: space-between;
      }
      .draft_sub_title {
        color: #161616;
        font-size: 16px;
        font-weight: 700;
        text-transform: capitalize;
      }
      .draft_info {
        color: #3a3a3a;
        font-size: 15px !important;
        font-weight: 400;
        margin-top: -8px;
      }
      .draft_progress {
        color: #000000 !important;
        font-size: 15px !important;
        font-weight: 400;
        margin-bottom: 5px;
      }
      .draft_percent {
        color: #1e232c !important;
        font-size: 15px !important;
        font-weight: 400;
        text-align: right;
        align-self: flex-end;
        width: 238px;
        margin-bottom: 5px;
      }
  }
    .decoration {
      font-size: 13px;
      border: 1px solid;
      padding: 4px 10px;
      border-radius: 50px;
    }
    .merite_maritime {
      color: #666666;
    }
    .legion_honneur {
      color: #CE0500;
    }
    .ordre_national_du_merite {
      color: #0063CB;
    }
  .divider {
    border: solid 2px #000091;
  }
}
</style>

````

</details>


---

### 📄 `src/components/FeedbackModal.vue` [2.886 octets]
<a id="src-components-FeedbackModal-vue"></a> [↩ Retour à l'arborescence](#tree-src-components-FeedbackModal-vue)

> **Chemin relatif** : `src/components/FeedbackModal.vue`  
> **Taille** : 2.886 octets  
> **Lignes** : 120  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (120 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <div class="feedback-modal">
    <button class="floating-right" @click="openModal" title="Nous contacter" aria-label="Afficher la dialog de suggestions">
      <img :src="infoBulle" alt="info bulle20" />
    </button>
    <alert
        :open="showModal"
        :on-close="closeModal"
        :with-confirmation="true"
        :on-confirm="onConfirm"
    >
      <template v-slot:title>
        <h2 class="mb-5">Participez à améliorer Honoré !</h2>
      </template>

      <template v-slot:message>
        <div>
          <p>Vous avez des besoins ? Des suggestions de fonctionnalités ? Vous rencontrez un problème technique ?</p>
          <p class="mb-1" style="font-weight: 500">Décrivez-ci dessous votre remarque</p>
        <p class="body">
          Soyez le plus précis possible car le formulaire est anonyme, nous ne pourrons pas vous recontacter.
        </p>
        <text-field
            field-type="text-area"
            v-model="issue"
            label=""
            required
        />
        <div class="info-box-feedback">
          <v-icon color="#0063CB" class="icon">{{ infoIco }}</v-icon>
          <h3 class="ml-2">Veillez à ne communiquer aucune information permettant d’identifier un dossier.</h3>
        </div>
      </div>
      </template>
    </alert>
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import TextField from "@/components/TextField.vue";
import { mdiInformation } from "@mdi/js";
import Component from "vue-class-component";
import Alert from "@/components/Alert.vue";
import infoBulle from "@/assets/info_bulle.png"
import closeModalImg from "@/assets/open_modal.png"
import {lazyInject} from "@pasta/box";
import {HomeViewModel} from "@/modules/home/viewModels/HomeViewModel";

@Component({
  components: {
    Alert,
    TextField
  }
})
export default class FeedbackModal extends Vue {

  @lazyInject(HomeViewModel)
  declare homeViewModel: HomeViewModel;

  infoIco = mdiInformation;

  showModal = false;
  infoBulle = infoBulle
  closeModalImg = closeModalImg

  issue = ""

  openModal() {
    this.showModal = true;
  }
  closeModal() {
    this.showModal = false;
  }

  async onConfirm() {
    //send to trello
    await this.homeViewModel.createIssue({
      issue: `${this.issue}\nSur la page: ${window.location.pathname}`,
    })
    this.showModal = false;
  }
}

</script>

<style>
.feedback-modal {

  .icon {
    padding: 8px;
  }

  .info-text v-icon {
    margin-right: 10px;
  }
  .floating-right {
    position: fixed;
    right: 100px;
    z-index: 1000;
    bottom: 10%;
    background-color: #000091;
    height: 50px;
    width: 50px;
    border-radius: 100px!important;
  }
}
.info-box-feedback {
  background: #e8edff;
  display: flex;
  align-items: flex-start;
  padding: 10px;
  border-radius: 5px;
  margin-bottom: 32px;
  & h3 {
    color: #0063cb;
  }
}
</style>

````

</details>


---

### 📄 `src/components/Footer.vue` [3.568 octets]
<a id="src-components-Footer-vue"></a> [↩ Retour à l'arborescence](#tree-src-components-Footer-vue)

> **Chemin relatif** : `src/components/Footer.vue`  
> **Taille** : 3.568 octets  
> **Lignes** : 141  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (141 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <footer class="footer" role="contentinfo">
    <v-row align="center">
      <v-col lg="6">
        <v-img alt="" :src="MinistereLogoLight" class="logo-ministere" width="150"></v-img>
      </v-col>
      <v-col lg="6">
        <p>Application de proposition et de suivi des distinctions honorifiques</p>
        <div class="flex gouvwebsites">
          <p class="mr-5">
            <a href="https://mer.gouv.fr" target="_blank">
              mer.gouv.fr
              <v-icon small color="#3A3A3A" style="vertical-align: middle;">
                {{openInNew}}
              </v-icon>
            </a>
          </p>
          <p class="mr-5">
            <a href="https://www.ecologie.gouv.fr" target="_blank">
              ecologie.gouv.fr
              <v-icon small color="#3A3A3A" style="vertical-align: middle;">
                {{openInNew}}
              </v-icon>
            </a>
          </p>

          <p class="mr-5">
            <a href="https://www.legifrance.gouv.fr" target="_blank">
              legifrance.gouv.fr
              <v-icon small color="#3A3A3A" style="vertical-align: middle;">
                {{openInNew}}
              </v-icon>
            </a>
          </p>

          <p>
            <a href="https://www.data.gouv.fr" target="_blank">
              data.gouv.fr
              <v-icon small color="#3A3A3A" style="vertical-align: middle;">
                {{openInNew}}
              </v-icon>
            </a>
          </p>
        </div>
      </v-col>
    </v-row>
    <div class="bottom-footer">
      <div class="flex mt-8 ">
        <p class="mr-8">
          <a href="https://www.legifrance.gouv.fr" target="_blank">
            Plan du site
          </a>
        </p>
        <p>|</p>
        <p class="mr-8 ml-8">
          <a href="/accessibilite">
            Accessibilité
          </a>
        </p>
        <p>|</p>
        <p class="mr-8 ml-8">
          <a href="/mention-legales">
            Mentions légales
          </a>
        </p>
        <p>|</p>
        <p class="mr-8 ml-8">
          <a href="/donnee-personnelles">
            Données personnelles
          </a>
        </p>
        <p>|</p>
        <p class="ml-8">
          <a href="/cookies">
            Gestion des cookies
          </a>
        </p>
      </div>
      <p class="mt-8">
        Sauf mention contraire, tous les contenus de ce site sont sous <a href="https://github.com/etalab/licence-ouverte/blob/master/LO.md#licence-ouverte-20open-licence-20" target="_blank" style="text-decoration: underline;">licence etalab-2.0</a> <v-icon small style="vertical-align: middle;margin-bottom: 3px;">
        {{openInNew}}
      </v-icon>
      </p>
    </div>


  </footer>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import Logo from "../assets/logo.svg";
import { mdiOpenInNew } from '@mdi/js';


@Component
export default class Footer extends Vue {
  MinistereLogoLight = Logo;
  openInNew = mdiOpenInNew;

}
</script>

<style lang="scss">
.footer {
  border-top: 3px solid #000091;
  margin-top: 10rem;
  text-align: left;
  padding: 1rem 7rem;
  img {
    width: 100px;
  }
  a {
    text-decoration: unset;
  }
  .gouvwebsites {
    a {
      color: #3A3A3A!important;
      font-size: 14px;
      font-weight: 500;
    }
  }
  .bottom-footer {
    a {
      color: #666666!important;
    }
    p {
      color: #666666!important;
      font-size: 14px;
    }
  }
  .flex {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
  }
}

</style>

```

</details>


---

### 📄 `src/components/Header.vue` [13.643 octets]
<a id="src-components-Header-vue"></a> [↩ Retour à l'arborescence](#tree-src-components-Header-vue)

> **Chemin relatif** : `src/components/Header.vue`  
> **Taille** : 13.643 octets  
> **Lignes** : 440  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (440 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <div  class="nav">
    <v-app-bar role="banner" prominent extended elevation="0" class="secondary topbar">
      <div class="presentation" style="align-items: center;">
        <v-img alt="" :src="Logo" class="logo-ministere"></v-img>
        <a href="/"><v-img alt="" :src="MedalLogo" :aspect-ratio="1" class="logo-medal"></v-img></a>
        <div class="title">
          <h1 class="title-main">Honoré</h1>
          <span class="title-sub" style="color: #3a3a3a; font-weight: 400">Proposer et suivre les distinctions honorifiques</span>
        </div>
      </div>
      <div class="tools">
        <div class="tools-actions">
          <div v-if="isAdmin()" class="d-flex align-center">
            <v-btn @click="testEmail" color="primary">
              Test email
            </v-btn>
            <v-divider vertical></v-divider>
          </div>
          <div class="tools-actions-help d-flex align-center">
                      <v-btn :href="`mailto:${email}`" color="primary" text title="Contacter l'assistance" aria-label="Envoyer un email à l'assistance HONORE">
            <v-icon left>{{ mdiEmailFastOutline }}</v-icon>
            Obtenir de l'aide
          </v-btn>

          </div>
          <v-divider vertical></v-divider>
          <div class="d-flex align-center">
            <v-icon style="margin-right: 5px; vertical-align: middle;">{{ accountIcon }}</v-icon
            ><span>{{authModule.currentUser.groups[0].name}} - {{authModule.currentUser.lastName.toUpperCase()}} {{authModule.currentUser.firstName}}</span>
          </div>
          <v-divider vertical></v-divider>
          <div class="tools-actions-logout d-flex align-center" @click="logout">
          <v-btn color="primary" @click="logout" text>
            <v-icon left>{{ mdiLogout }}</v-icon>
            Se déconnecter
          </v-btn>
          </div>
        </div>
      </div>

      <template v-slot:extension>
        <v-tabs align-with-title optional>
          <v-tab
            class="nav-link"
            link
            v-for="route in navBarRoutes"
            :to="route.path"
            v-bind:data="route"
            v-bind:key="route.name"
          >
            {{ route.name.toUpperCase() }}
            <v-icon v-if="route.name === 'Suivi des dossiers' && homeViewModel.notifications.folderWaitingAction" style="color: #fa3e3e!important;width: 14px;margin-bottom: 10px">{{notifyIcon}}</v-icon>
          </v-tab>
        </v-tabs>
        <v-btn outlined color="primary" style="margin-right: 24px" elevation="0" @click="searchApplicant()">Recherche</v-btn>
        <v-btn color="primary" elevation="0" @click="createFolder()">Déposer un dossier</v-btn>
      </template>
    </v-app-bar>
    <v-subheader class="subnav" v-if="shouldDisplayBc">
      <v-breadcrumbs large :items="currentRoute.nodes" v-if="currentRoute.nodes.length > 1">
        <template v-slot:divider>
          <v-icon>{{ mdiChevronRight }}</v-icon>
        </template>
        <template v-slot:item="{ item }">
          <v-breadcrumbs-item :href="item.href" :disabled="item.disabled" class="subnav--link" >
            <u v-if="!item.disabled" style="color: #3A3A3A;">{{ item.text }}</u>
            <span v-else >{{ item.text }}</span>
          </v-breadcrumbs-item>
        </template>
      </v-breadcrumbs>
    </v-subheader>
    <search-applicant-dialog
      :open="searchApplicantOpen"
      :on-close="onCloseSearchApplicant"
    />
    <feedback-modal />
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import MedalLogo from "../assets/medal-logo.svg";
import Logo from "../assets/logo.svg";
import {mdiAccountCircle, mdiArrowLeftThin, mdiChevronRight, mdiEmailFastOutline, mdiLogout} from "@mdi/js";
import {isNil} from "lodash";
import {RouteRecordPublic} from "vue-router";
import {HomeRoute} from "@/modules/home/navigation/HomeRoute";
import {OnBoardingRoutes} from "@/modules/onBoarding/navigation/OnBoardingRoutes";
import {PersonalInformationRoute} from "@/modules/onBoarding/navigation/PersonalInformationRoute";
import {FilesFollowUpRoute} from "@/modules/folders/navigation/FilesFollowUpRoute";
import {TrainingInformationRoute} from "@/modules/onBoarding/navigation/TrainingInformationRoute";
import {DocumentsRoute} from "@/modules/onBoarding/navigation/DocumentsRoute";
import {ValidationRoute} from "@/modules/onBoarding/navigation/ValidationRoute";
import {PathValidatedRoute} from "@/modules/onBoarding/navigation/PathValidatedRoute";
import {DraftListRoute} from "@/modules/folders/navigation/DraftListRoute";
import {lazyInject} from "@pasta/box/src/lib/container";
import {HomeViewModel} from "@/modules/home/viewModels/HomeViewModel";
import {DemandInformationRoute} from "@/modules/onBoarding/navigation/DemandInformationRoute";
import {AuthModule} from "@pasta/front-auth";
import {FolderDetailRoute} from "@/modules/folders/navigation/FolderDetailRoute";
import {SessionRoute} from "@/modules/sessions/navigation/SessionRoute";
import {AuthRole} from "@/core/types/identity/AuthRole";
import {FolderViewModel} from "@/modules/folders/viewModels/FolderViewModel";
import {ArchiveRoute} from "@/modules/archives/navigation/ArchiveRoute";
import FeedbackModal from "@/components/FeedbackModal.vue";
import {RecommandantsRoutes} from "@/modules/recommandants/navigation/RecommandantsRoutes";
import {RecommandantListRoute} from "@/modules/recommandants/navigation/RecommandantListRoute";
import {RecommandantDetailRoute} from "@/modules/recommandants/navigation/RecommandantDetailRoute";
import Alert from "@/components/Alert.vue";
import TextField from "@/components/TextField.vue";
import SearchApplicantDialog from "@/components/SearchApplicantDialog.vue";
import { mdiCircle } from '@mdi/js';
import {SessionListRoute} from "@/modules/sessions/navigation/SessionListRoute";

@Component({
  components: {
    SearchApplicantDialog,
    TextField,
    Alert,
    FeedbackModal,
  }
})
export default class Header extends Vue {
  @lazyInject(HomeViewModel)
  declare homeViewModel: HomeViewModel;

  @lazyInject(AuthModule)
  declare authModule: AuthModule;

  @lazyInject(FolderViewModel)
  declare folderViewModel: FolderViewModel;




  searchApplicantOpen = false;

  Logo = Logo;
  MedalLogo = MedalLogo;
  notifyIcon = mdiCircle;
  mdiArrowLeftThin = mdiArrowLeftThin;
  mdiEmailFastOutline = mdiEmailFastOutline;
  mdiChevronRight = mdiChevronRight;
  accountIcon = mdiAccountCircle;
  mdiLogout = mdiLogout;

  shouldDisplayBc = false;

  declare isDarkTheme: boolean;
  // TODO Refactor this.
  //
  navBarRoutes = [new HomeRoute(), new FilesFollowUpRoute(), new ArchiveRoute()];

  registeredRoutes = [
    new HomeRoute(),
    new SessionListRoute(),
    new FilesFollowUpRoute(),
    new OnBoardingRoutes(),
    new PersonalInformationRoute(),
    new TrainingInformationRoute(),
    new DocumentsRoute(),
    new ValidationRoute(),
    new PathValidatedRoute(),
    new DraftListRoute(),
    new DemandInformationRoute(),
    new SessionRoute(),
    new ArchiveRoute(),
    new RecommandantsRoutes(),
    new RecommandantDetailRoute()
  ];
  currentRoute: { nodes: { text: string; disabled: boolean; href: string }[]; title: string; subtitle: string } = {
    nodes: [],
    title: "",
    subtitle: "",
  };

  title = "";
  subtitle = "";
  email = "assistance-honore@developpement-durable.gouv.fr";

  async mounted() {
    if (this.isAuthorizedForSession()) {
      await this.homeViewModel.initSessions();
      this.navBarRoutes.push(new RecommandantListRoute() as any)
      this.navBarRoutes.push(new SessionListRoute() as any);
    }
    await this.homeViewModel.getNotifications();
    await this.homeViewModel.getAllCabinets();
  }

  searchApplicant() {
    this.searchApplicantOpen = true;
  }

  onCloseSearchApplicant() {
    this.searchApplicantOpen = false;
  }

  async testEmail() {
    await this.homeViewModel.testEmail();
  }

  isAdmin() {
    const currentUser = this.authModule.currentUser;
    return currentUser?.highestRoleLevel && currentUser?.highestRoleLevel >= 1000;
  }

  isAuthorizedForSession() {
    const currentUser = this.authModule.currentUser;
    const role = currentUser?.highestRoleLevel ?? 0;
    return role === AuthRole.CHANCELLERY || role >= AuthRole.ADMIN;
  }

  async logout() {
    await this.authModule.logout();
    localStorage.clear();
  }

  created() {
    this.isDarkTheme = this.$vuetify.theme.dark;
    const routes = this.$router.getRoutes();
    const currentRoute = routes.find(route => {
      return this.$router.currentRoute.path === route.path;
    });
    if (currentRoute) {
      const nonBcRoutes = ['/', '/mes-dossiers', '/archives', '/recommandants']
      this.shouldDisplayBc = nonBcRoutes.find(elem => elem === currentRoute.path) == null && !currentRoute.path.includes('promotions')
      this.generateSubNav(currentRoute);
    }

    this.$router.afterEach(to => {
      this.currentRoute = { nodes: [], title: "", subtitle: "" };
      const nonBcRoutes = ['/', '/mes-dossiers', '/archives', '/recommandants']
      this.shouldDisplayBc = nonBcRoutes.find(elem => elem === to.path) == null && !to.path.includes('promotions')
      const nextRoute = routes.find(route => {
        return to.path === route.path;
      });

      if (nextRoute) {
        this.generateSubNav(nextRoute);
      }
    });
  }

  generateSubNav(route: RouteRecordPublic) {
    const getRoute = this.registeredRoutes.find(item => route.path === item.path);
    if (getRoute) {
      this.title = getRoute.title;
      this.subtitle = getRoute.subtitle;
    } else {
      this.title = "";
      this.subtitle = "";
    }
    this.currentRoute.nodes.push({
      text: route.name || "",
      disabled: false,
      href: route.path || "/",
    });

    if (!isNil((route as any).parent) && route.path !== "/") {
      let parent = (route as any).parent;
      while (!isNil(parent)) {
        this.currentRoute.nodes.push({
          text: parent.name || "Accueil",
          disabled: false,
          href: parent.path || "/",
        });

        if (parent.parent) {
          parent = parent.parent;
        } else {
          parent = null;
        }
      }
    }

    this.currentRoute.nodes.reverse();
    this.currentRoute.nodes[this.currentRoute.nodes.length - 1] = {
      text: this.currentRoute.nodes[this.currentRoute.nodes.length - 1].text,
      disabled: true,
      href: this.currentRoute.nodes[this.currentRoute.nodes.length - 1].href,
    };
  }

  createFolder() {
    this.homeViewModel.clear();
    this.$router.push("/archive/recherche");
  }
}
</script>

<style lang="scss">
@import "../styles/variables.scss";

$header-spacing: 1rem;
$half-spacing: 0.5rem;
.v-subheader {
  flex-direction: column;
  align-items: flex-start;
  justify-content: center;
}

.promotion-disabled {
  color: grey;
  cursor: initial!important;
}
.cabinet-item {
  display: flex;
  align-items: center;
}
.nav {
  .theme--light.v-breadcrumbs .v-breadcrumbs__divider, .theme--light.v-breadcrumbs .v-breadcrumbs__item--disabled {
    color: #161616;
  }
  .subnav--link u {
    color: #666666!important;
  }
  .v-slide-group__content {

  }
  .custom-nav-link {
    font-size: 0.875rem;
    font-weight: 500;
    margin: 5px 16px!important;
  }
  .custom-nav-link:hover {
    background-color: transparent;
  }
  .subnav-title {
    color: #161616;
    h2 {
      font-size: 40px;
      font-weight: 600;
    }
    h3 {
      font-size: 20px;
      font-weight: 400;
      color: #666666;
    }
    text-align: left;
  }
  .subnav {
    padding: 2rem 8rem;
    ul {
      padding-left: 0px !important;
    }
  }
  .topbar {
    box-shadow: 0px 1px 0px 0px #E5E5E5!important;
    > .v-toolbar__content {
      border-bottom: solid 1px $light-background-contrast-grey;
    }
    > div {
      padding: $header-spacing 5%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;

      .presentation {
        display: flex;
        flex-direction: row;
        max-height: 96px;
        justify-content: space-evenly;
        gap: 1rem;

        .logo {
          &-ministere {
            min-width: 116px;
          }

          &-medal {
            width: 53px;
            height: 51px;
            display:flex;
            align-items: center;
            align-self: center;
          }
        }

        .title {
          display: flex;
          flex-direction: column;
          align-self: center;
          align-items: flex-start;

          &-main {
            font-size: 2rem;
          }

          &-sub {
            width: 100%;
            @media only screen and (max-width: 1485px) {
              font-size: 1rem !important;
            }
          }
        }
      }

      .tools {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        align-items: stretch;

        &-actions {
          display: flex;
          flex-direction: row;

          div {
            margin: 0px $half-spacing;

            span {
              font-size: 1rem;
            }
          }

          .v-divider {
            margin: 0px $half-spacing;
          }
        }

        &-search {
          display: flex;

          // $text-field-filled-full-width-outlined-dense-slot-min-height: 47px; FIXME

          .v-text-field--filled.v-input--dense.v-text-field--single-line > .v-input__control > .v-input__slot {
            // NOTE delete this once above line is working
            min-height: 47px;
          }
        }
      }
    }
  }
}
</style>

````

</details>


---

### 📄 `src/components/SearchApplicantDialog.vue` [5.121 octets]
<a id="src-components-SearchApplicantDialog-vue"></a> [↩ Retour à l'arborescence](#tree-src-components-SearchApplicantDialog-vue)

> **Chemin relatif** : `src/components/SearchApplicantDialog.vue`  
> **Taille** : 5.121 octets  
> **Lignes** : 170  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (170 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <alert
    :open="open"
    :on-close="onClose"
    :with-confirmation="false"
  >
    <template v-slot:title>
      <div style="display: flex; align-items: flex-start;">
        <v-icon x-large style="color: #161616;vertical-align: middle;">
          {{ right }}
        </v-icon>
        <h2 class="pb-5" style="font-size: 20px;line-height: 1.5">
          Recherche
        </h2>
      </div>
    </template>

    <template v-slot:message>
      <div class="search-honore-folders">
        <div class="search-archive">
          <p class="subtitle">Affiner votre recherche :</p>
          <v-text-field
            v-model="search"
            :append-outer-icon="searchIcon"
            filled
            type="text"
          />
        </div>
        <div class="result-container">
          <div
            class="result"
            v-for="archive in homeViewModel.honoreFolders.slice((page * limit) - limit, page * limit)"
            v-bind:key="archive.value.refId"
          >
            <p style="font-weight: 500">{{archive.value.birthName}} {{archive.value.firstName}}</p>
            <p v-if="archive.value.birthDate">Né{{archive.value.civility === "MR" ? "" : "e"}} le {{dayjs(archive.value.birthDate).format('DD-MM-YYYY')}}</p>
            <p style="font-weight: 500">Historique des présentations :</p>
            <div
              v-for="presentation in archive.value.presentations"
              v-bind:key="presentation.presentationId"

              class="mb-3"
            >
              <div style="display: flex; align-items: center; justify-content: space-between;">
                <div>
                  <p v-if="presentation.status === 'draft'">Brouillon</p>
                  <p
                    v-if="presentation.decreeDate && presentation.status !== 'draft'"
                  >
                    Archivé
                  </p>
                  <p v-if="!presentation.decreeDate && presentation.status !== 'draft'">
                    En cours de présentation
                  </p>
                  <p>Décoration : {{presentation.decorationType}}</p>
                </div>
                <div class="mr-3">
                  <v-btn color="primary" @click="onPresentationClick(presentation)">
                    Accéder
                  </v-btn>
                </div>
              </div>
              <v-divider/>
            </div>

          </div>
        </div>
        <v-pagination
          :length="Math.round(homeViewModel.honoreFolders.length / limit)"
          :disabled="false"
          :page="page"
          class="mt-5"
          :value="page"
          v-model="page"
          :total-visible="8"
        ></v-pagination>
      </div>

    </template>
  </alert>
</template>

<script lang="ts">
import Component from "vue-class-component";
import Vue from "vue";
import Alert from "@/components/Alert.vue";
import {mdiArrowRight, mdiMagnify} from "@mdi/js";
import {Prop, Watch} from "vue-property-decorator";
import {lazyInject} from "@pasta/box";
import TextField from "@/components/TextField.vue";
import {HomeViewModel} from "@/modules/home/viewModels/HomeViewModel";
import dayjs from "dayjs";
import {PresentationSimplified} from "@/core/entities/HonoreFolder";
import {OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {FolderViewModel} from "@/modules/folders/viewModels/FolderViewModel";


@Component({
  methods: {dayjs},
  components: {
    Alert,
    TextField
  }
})
export default class SearchApplicantDialog extends Vue {
  right = mdiArrowRight;

  @Prop({required: true, default: false})
  declare open: boolean;

  @Prop({required: true})
  declare onClose: Function;

  @lazyInject(HomeViewModel)
  declare homeViewModel: HomeViewModel;

  @lazyInject(OnBoardingViewModel)
  declare onboardingViewModel: OnBoardingViewModel;

  @lazyInject(FolderViewModel)
  declare folderViewModel: FolderViewModel;

  page = 1;

  limit = 8;

  searchIcon = mdiMagnify;

  search = ""

  @Watch('search')
  async onSearch(value: string) {
    await this.homeViewModel.searchHonoreArchive(value);
  }

  async onPresentationClick(presentation: PresentationSimplified) {
    if (presentation.status === 'draft') {
      const draft = this.homeViewModel.drafts.find(item => item.id === presentation.presentationId);
      if (draft) {
        this.onboardingViewModel.clearAll();
        this.onboardingViewModel.enrich(draft);
        this.onboardingViewModel.updateEditMode(false);
        this.onboardingViewModel.selectDecoration(draft.decorationType);
        window.open("/depot-de-dossier/informations", "_blank")
        return;
      }
    }
    await this.folderViewModel.selectFolder(presentation.applicantId);
    window.open("/mes-dossiers/details", "_blank")
  }

}
</script>
<style>
.search-honore-folders {
  .result-container {
    display: flex;
    flex-wrap: wrap;
    .result {
      width: 100%;
      padding-left: 10px;
      padding-top: 15px;
      margin-top: 15px;
      border: 1px solid #DDDDDD;
      border-bottom: 5px solid #20209f;
    }
  }
}
</style>

```

</details>


---

### 📄 `src/components/Selector.vue` [1.428 octets]
<a id="src-components-Selector-vue"></a> [↩ Retour à l'arborescence](#tree-src-components-Selector-vue)

> **Chemin relatif** : `src/components/Selector.vue`  
> **Taille** : 1.428 octets  
> **Lignes** : 69  
> **Type** : text

```text
<template>
  <div class="select">
    <label style="color: #161616;" :for="label">{{label}}<span style="color: red" v-if="mandatory">*</span></label>
    <slot class="selector-sublabel" name="sublabel"></slot>
    <v-select
      class="mt-3"
      :items="items"
      :id="label"
      filled
      @input="$emit('input', $event)"
      :error-messages="errorMessages"
      :value="defaultValue"
      :placeholder="placeholder"
      :append-icon="chevronDown"
    />
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import {Prop} from "vue-property-decorator";
import { mdiChevronDown } from '@mdi/js';

@Component
export default class Selector extends Vue {

  chevronDown = mdiChevronDown;

  @Prop({required: true})
  declare label: string;

  @Prop({required: true})
  declare items: string[];

  @Prop({required: false})
  declare errorMessages: string[];

  @Prop({required: false})
  declare defaultValue: string;

  @Prop({required: false, default: ""})
  declare placeholder: string;

  @Prop({required: false, default: false})
  declare mandatory: boolean;

}
</script>

<style lang="scss">
.select {
  margin-top: 10px;
  p {
    color: #161616;
    margin-bottom: 3px!important;
  }
  input::placeholder {
    color: #161616!important;
  }
  .selector-sublabel {
    margin-top: 0px!important;
    font-size: 12px;
    color: #666666;
  }
}

</style>

```


---

### 📄 `src/components/TextField.vue` [1.998 octets]
<a id="src-components-TextField-vue"></a> [↩ Retour à l'arborescence](#tree-src-components-TextField-vue)

> **Chemin relatif** : `src/components/TextField.vue`  
> **Taille** : 1.998 octets  
> **Lignes** : 92  
> **Type** : text

```text
<template>
  <div class="textfield">
    <label style="color: #161616;" :for="label">{{label}}<span v-if="mandatory" style="color: red">*</span></label>
    <p class="sublabel" v-if="subLabel != null">
      {{subLabel}}
    </p>
    <v-text-field
      v-if="fieldType === 'text'"
      class="ma-0 pa-0 mt-3"
      single-line
      filled
      :id="label"
      :required="required"
      :type="type"
      @input="$emit('input', $event)"
      :value="defaultValue"
      :error-messages="errorMessages"
      :maxlength="maxLength ? maxLength : null"
      :autocomplete="autoCompleteAttribute"
    />
    <v-textarea
      v-if="fieldType === 'text-area'"
      class="ma-0 pa-0 mt-3"
      single-line
      filled
      :required="required"
      :id="label"
      :type="type"
      @input="$emit('input', $event)"
      :value="defaultValue"
      :error-messages="errorMessages"
    ></v-textarea>
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import {Prop} from "vue-property-decorator";

@Component
export default class TextField extends Vue {
  @Prop({required: true})
  declare label: string;

  @Prop({required: true})
  declare required: boolean;

  @Prop({required: false})
  declare subLabel: string;

  @Prop({required: false})
  declare defaultValue: string;

  @Prop({required: false})
  declare autoCompleteAttribute: string;

  @Prop({required: false, default: "text"})
  declare type: string;

  @Prop({required: false})
  declare errorMessages: string[];

  @Prop({required: false})
  declare maxLength: number;

  @Prop({required: false, default: false})
  declare mandatory: boolean;

  @Prop({required: false, default: 'text'})
  declare fieldType: 'text' | 'text-area'


}
</script>

<style lang="scss">
.textfield {
  margin-top: 10px;
  p {
    color: #161616;
    margin-bottom: 3px!important;
  }
  .sublabel {
    margin-top: 0px!important;
    font-size: 12px;
    color: #666666;
  }
}

</style>

```


---

### 📄 `src/modules/.gitkeep` [0 octets]
<a id="src-modules--gitkeep"></a> [↩ Retour à l'arborescence](#tree-src-modules--gitkeep)

> **Chemin relatif** : `src/modules/.gitkeep`  
> **Taille** : 0 octets  
> **Lignes** : 0  
> **Type** : text

```text

```


---

### 📄 `src/modules/archives/screens/ArchiveScreen.vue` [25.477 octets]
<a id="src-modules-archives-screens-ArchiveScreen-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-archives-screens-ArchiveScreen-vue)

> **Chemin relatif** : `src/modules/archives/screens/ArchiveScreen.vue`  
> **Taille** : 25.477 octets  
> **Lignes** : 788  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (788 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <div class="archive-screen">
    <div class="flex align-center mt-7">
      <img alt="" :src="documentImg" />
      <h1 class="pl-5">
        Archives
      </h1>
    </div>
    <v-row class="mt-3">
      <v-col lg="4">
        <text-field
          label="Recherche"
          :required="false"
          :default-value="search"
          v-model="search"
          field-type="text"
        />
      </v-col>
      <v-col lg="4" style="align-self: center">
        <v-btn color="primary" class="mt-4" @click="openSearchPopup">
          Recherche DECO
        </v-btn>
      </v-col>
    </v-row>
    <v-divider class="mb-3"/>
    <p class="mb-10 mt-5" style="font-weight: 500">
      Filtres :
    </p>
    <v-row>
      <v-col lg="3">
        <p>Proposé par</p>
        <v-menu
          bottom
          :close-on-content-click="false"
          offset-y
        >
          <template v-slot:activator="{ on, attrs }">
            <v-btn
              v-bind="attrs"
              v-on="on"
              class="select-btn"
              outlined
            >
              <span style="color: black">
                Sélectionner
              </span>
              <v-icon style="color: black">
                {{chevronDown}}
              </v-icon>
            </v-btn>
          </template>
          <v-list
            v-for="(item, index) in archiveViewModel.purposedByList"
            :key="index"
          >
            <v-list-item>
              <template v-slot:default="{ active }">
                <v-list-item-action>
                  <v-checkbox
                    :input-value="active"
                    v-model="filters.purposedBy"
                    :value="item"
                    @change="filterKey(item, 'purposedBy')"
                  />
                </v-list-item-action>
                <v-list-item-content>
                  <v-list-item-title>{{item}}</v-list-item-title>
                </v-list-item-content>
              </template>
            </v-list-item>
            <v-divider
              v-if="index < archiveViewModel.availableGrade.length - 1"
              :key="index"
            ></v-divider>
          </v-list>
        </v-menu>
      </v-col>
      <v-col lg="3">
        <p>Grade</p>
        <v-menu
          bottom
          :close-on-content-click="false"
          offset-y
        >
          <template v-slot:activator="{ on, attrs }">
            <v-btn
              v-bind="attrs"
              v-on="on"
              class="select-btn"
              outlined
            >
              <span style="color: black">
                Sélectionner
              </span>
              <v-icon style="color: black">
                {{chevronDown}}
              </v-icon>
            </v-btn>
          </template>
          <v-list
            v-for="(item, index) in archiveViewModel.availableGrade"
            :key="index"
          >
            <v-list-item>
              <template v-slot:default="{ active }">
                <v-list-item-action>
                  <v-checkbox
                    :input-value="active"
                    v-model="filters.grade"
                    :value="item"
                    @change="filterKey(item, 'grade')"
                  />
                </v-list-item-action>
                <v-list-item-content>
                  <v-list-item-title>{{item}}</v-list-item-title>
                </v-list-item-content>
              </template>
            </v-list-item>
            <v-divider
              v-if="index < archiveViewModel.availableGrade.length - 1"
              :key="index"
            ></v-divider>
          </v-list>
        </v-menu>
      </v-col>
      <v-col lg="3">
        <p>Contingent</p>
        <v-menu
          bottom
          :close-on-content-click="false"
          offset-y
        >
          <template v-slot:activator="{ on, attrs }">
            <v-btn
              v-bind="attrs"
              v-on="on"
              class="select-btn"
              outlined
            >
              <span style="color: black">
                Sélectionner
              </span>
              <v-icon style="color: black">
                {{chevronDown}}
              </v-icon>
            </v-btn>
          </template>
          <v-list
            v-for="(item, index) in archiveViewModel.availableContingent"
            :key="index"
          >
            <v-list-item>
              <template v-slot:default="{ active }">
                <v-list-item-action>

                  <v-checkbox
                    v-model="filters.contingent"
                    :input-value="active"
                    @change="filterKey(item, 'contingent')"
                    :value="item"
                  />
                </v-list-item-action>
                <v-list-item-content>
                  <v-list-item-title>Contingent {{item}}</v-list-item-title>
                </v-list-item-content>
              </template>
            </v-list-item>
            <v-divider
              v-if="index < archiveViewModel.availableContingent.length - 1"
              :key="index"
            ></v-divider>
          </v-list>
        </v-menu>
      </v-col>
      <v-col lg="3">
        <p>Promotion clôturée le</p>
        <v-menu
          bottom
          :close-on-content-click="false"
          offset-y
        >
          <template v-slot:activator="{ on, attrs }">
            <v-btn
              v-bind="attrs"
              v-on="on"
              class="select-btn"
              outlined
            >
              <span style="color: black">
                Sélectionner
              </span>
              <v-icon style="color: black">
                {{chevronDown}}
              </v-icon>
            </v-btn>
          </template>
          <v-list
            v-for="(item, index) in archiveViewModel.closedAtList"
            :key="index"
          >
            <v-list-item>
              <template v-slot:default="{ active }">
                <v-list-item-action>
                  <v-checkbox
                    :input-value="active"
                    v-model="filters.sessionClosedAt"
                    :value="item"
                    @change="filterKey(item, 'sessionClosedAt')"
                  />
                </v-list-item-action>
                <v-list-item-content>
                  <v-list-item-title>{{item}}</v-list-item-title>
                </v-list-item-content>
              </template>
            </v-list-item>
            <v-divider
              v-if="index < archiveViewModel.availableGrade.length - 1"
              :key="index"
            ></v-divider>
          </v-list>
        </v-menu>
      </v-col>
      <v-col lg="3">
        <p>Date de décret</p>
        <v-menu
            bottom
            :close-on-content-click="false"
            offset-y
        >
          <template v-slot:activator="{ on, attrs }">
            <v-btn
                v-bind="attrs"
                v-on="on"
                class="select-btn"
                outlined
            >
              <span style="color: black">
                Sélectionner
              </span>
              <v-icon style="color: black">
                {{chevronDown}}
              </v-icon>
            </v-btn>
          </template>
          <v-list
              v-for="(item, index) in archiveViewModel.decreeDateList"
              :key="index"
          >
            <v-list-item>
              <template v-slot:default="{ active }">
                <v-list-item-action>
                  <v-checkbox
                      :input-value="active"
                      v-model="filters.decreeDateList"
                      :value="item"
                      @change="filterKey(item, 'decreeDateList')"
                  />
                </v-list-item-action>
                <v-list-item-content>
                  <v-list-item-title>{{item}}</v-list-item-title>
                </v-list-item-content>
              </template>
            </v-list-item>
            <v-divider
                v-if="index < archiveViewModel.availableGrade.length - 1"
                :key="index"
            ></v-divider>
          </v-list>
        </v-menu>
      </v-col>
      <v-col lg="3">
            <p>Type de décoration</p>
            <v-menu
                    bottom
                    :close-on-content-click="false"
                    offset-y
            >
                <template v-slot:activator="{ on, attrs }">
                    <v-btn
                            v-bind="attrs"
                            v-on="on"
                            class="select-btn"
                            outlined
                    >
              <span style="color: black">
                Sélectionner
              </span>
                        <v-icon style="color: black">
                            {{chevronDown}}
                        </v-icon>
                    </v-btn>
                </template>
                <v-list
                        v-for="(item, index) in archiveViewModel.availableDecorationType"
                        :key="index"
                >
                    <v-list-item>
                        <template v-slot:default="{ active }">
                            <v-list-item-action>
                                <v-checkbox
                                        :input-value="active"
                                        v-model="filters.decorationType"
                                        :value="item"
                                        @change="filterKey(item, 'decorationType')"
                                />
                            </v-list-item-action>
                            <v-list-item-content>
                                <v-list-item-title>{{item}}</v-list-item-title>
                            </v-list-item-content>
                        </template>
                    </v-list-item>
                    <v-divider
                            v-if="index < archiveViewModel.availableGrade.length - 1"
                            :key="index"
                    ></v-divider>
                </v-list>
            </v-menu>
        </v-col>
      <v-col lg="3">
        <p>Avis secrétaire de Séance</p>
        <v-menu
            bottom
            :close-on-content-click="false"
            offset-y
        >
          <template v-slot:activator="{ on, attrs }">
            <v-btn
                v-bind="attrs"
                v-on="on"
                class="select-btn"
                outlined
            >
              <span style="color: black">
                Sélectionner
              </span>
              <v-icon style="color: black">
                {{chevronDown}}
              </v-icon>
            </v-btn>
          </template>
          <v-list
              v-for="(item, index) in archiveViewModel.availableSecretaryAdvices"
              :key="index"
          >
            <v-list-item>
              <template v-slot:default="{ active }">
                <v-list-item-action>
                  <v-checkbox
                      :input-value="active"
                      v-model="filters.secretaryAdvices"
                      :value="item"
                      @change="filterKey(item, 'secretaryAdvices')"
                  />
                </v-list-item-action>
                <v-list-item-content>
                  <v-list-item-title>{{item}}</v-list-item-title>
                </v-list-item-content>
              </template>
            </v-list-item>
            <v-divider
                v-if="index < archiveViewModel.availableGrade.length - 1"
                :key="index"
            ></v-divider>
          </v-list>
        </v-menu>
      </v-col>
    </v-row>
      <div class="mt-10" style="display: flex">
          <div class="mr-5" v-for="item in Object.values(filters).flat().map(elem => toLabelAndKey(elem))" v-bind:key="item.label">
              <v-chip
                      close
                      v-if="filters[item.key].includes(item.label)"
                      style="border-radius: 0; padding: 10px;padding: 20px;font-size: 15px;"
                      color="#E3E3FD"
                      @click:close="filters[item.key] = filters[item.key].filter(elem => elem !== item.label); filterKey(item.label, item.key)"
              >
                <span v-if="item.key === 'purposedBy'" style="color: #000091;">
                    Proposé par :
                </span>
                    <span v-if="item.key === 'sessionClosedAt'" style="color: #000091;">
                    Promotion clôturée le :
                </span>
                <span v-if="item.key === 'decreeDateList'" style="color: #000091;">
                    Décret publie le :
                </span>
                    <span v-if="item.key === 'grade'" style="color: #000091;">
                    Grade :
                </span>
                    <span v-if="item.key === 'decorationType'" style="color: #000091;">
                    Type de décoration :
                </span>
                    <span v-if="item.key === 'contingent'" style="color: #000091;">
                    Contingent
                </span>
                <span v-if="item.key === 'secretaryAdvices'" style="color: #000091;">
                    Avis secrétaire de séance :
                </span>
                    <span style="margin-left: 5px; color: #000091;font-weight: bold">
                    {{item.label}}
                </span>
              </v-chip>
          </div>
          <v-btn v-if="Object.values(filters).flat().length > 0"
                  text color="primary" @click="resetFilters"
          >
              <v-icon class="ml-2" color="primary">
                  {{close}}
              </v-icon>
              <span style="text-decoration: underline">
                  Réinitialiser
              </span>
          </v-btn>
      </div>
    <v-divider class="mt-10 mb-3"/>
    <div>
      <v-data-table
        :headers="headers"
        :items="toApplicants()"
        :items-per-page="10"
        calculate-widths
        class="elevation-0 mt-8"
        locale="fr-FR"
        item-key="id"
      >
        <template  v-slot:item.controls="props">
          <v-btn icon outlined color="primary" @click="onButtonClick(props.item.applicantId)" title="Consulter l'archive" aria-label="Aller à la page des détails de l'archive">
            <v-icon color="primary">
              {{eyeIcon}}
            </v-icon>
          </v-btn>
        </template>
        <template v-slot:item.action="props">
          <p class="action">
            <v-icon small style="vertical-align: middle; margin-bottom: 3px; color: #0063CB;">
              {{ info }}
            </v-icon>
            {{props.item.action}}
          </p>
        </template>
      </v-data-table>
    </div>
    <search-archive
      :open="userSearchPopupOpen"
      :on-close="onSearchArchiveClose"
      v-model="usersSearch"
      :archives="archives"
      :on-search-press="onSearchPress"
      :on-archive-selected="onArchiveSelect"
      :on-confirm-selection="onConfirmSelection"
    />
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import Stepper from "@/modules/onBoarding/components/Stepper.vue";
import DocumentImg from "@/assets/document.png";
import {FolderViewModel} from "@/modules/folders/viewModels/FolderViewModel";
import {Action, lazyInject} from "@pasta/box";
import {Grade} from "@/core/types/training/Grade";
import {ContingentType} from "@/core/types/training/ContingentType";
import {ArchiveViewModel, FolderFilters} from "@/modules/archives/viewModels/ArchiveViewModel";
import {Applicant} from "@/core/entities/Applicant";
import {mdiEyeCircleOutline, mdiInformation, mdiChevronDown, mdiClose} from "@mdi/js";
import TextField from "@/components/TextField.vue";
import {Watch} from "vue-property-decorator";
import Selector from "@/components/Selector.vue";
import dayjs from "dayjs";
import {DecorationType} from "@/modules/onBoarding/types/DecorationType";
import {HonoreIdentifier} from "@/core/HonoreIdentifier";
import {ApplicantRepository} from "@/core/repositories/ApplicantRepository";
import {FolderDetailViewModel} from "@/modules/folders/viewModels/FolderDetailViewModel";
import SearchArchive from "@/modules/onBoarding/components/SearchArchive.vue";
import {Archive} from "@/core/entities/Archive";
import {toDecorationType} from "@/core/valueObjects/toDecorationType";

@Component({
  components: {
    SearchArchive,
    Stepper,
    TextField,
    Selector
  }
})
export default class ArchiveScreen extends Vue {
  documentImg = DocumentImg;
  @lazyInject(FolderViewModel)
  declare folderViewModel: FolderViewModel;

  @lazyInject(ArchiveViewModel)
  declare archiveViewModel: ArchiveViewModel;

  @lazyInject(FolderDetailViewModel)
  declare folderDetailViewModel: FolderDetailViewModel;

  eyeIcon = mdiEyeCircleOutline;
  info = mdiInformation;

  chevronDown = mdiChevronDown;
  close = mdiClose;

  search = "";
  users: { text: string; value: Archive; disabled: boolean; divider: boolean; }[] = [];
  archives: Archive[] = [];

  usersSearch = "";

  lhOnmDecisions: string[] = ["Retrait cabinet", "Sélection cabinet", "Présentés à l'Élysée", "Retrait Élysée", "Chancellerie", "Retrait chancellerie", "Retrait présidence", "Décorés"]

  mmDecision: string[] = ["Décorés", "Non agrée", "Ajourner", "Non présenté"];



  @lazyInject(HonoreIdentifier.applicantRepository)
  declare applicantRepository: ApplicantRepository;

  userSearchPopupOpen = false;


  filters: FolderFilters = {
    contingent: [],
    grade: [],
    purposedBy: [],
    sessionClosedAt: [],
    decorationType: [],
    decreeDateList: [],
    secretaryAdvices: [],
  }

  headers = [
    {
      text: 'Nom du candidat',
      align: 'start',
      value: 'name',
      groupable: false,
      width: '15%'
    },
    { text: 'Proposé par', value: 'purposeBy', groupable: true, width: '10%'},
    { text: 'Grade', value: 'grade', groupable: true, sortable: false,  width: '10%'},
    { text: 'Contingent', value: 'contingent', sortable: true,  width: '10%'},
    { text: 'Date de décret', value: 'decreeDate', sortable: true,  width: '10%'},
    { text: 'Type de décoration', value: 'decorationType', sortable: true,  width: '10%'},
    { text: "", value: "controls", sortable: false, align: 'end', groupable: false, width: '10%' }
  ];

  capitalize(value: string) {
    return value.charAt(0).toUpperCase() + value.slice(1).toLowerCase();
  }

  onSearchArchiveClose() {
    this.userSearchPopupOpen = false;
  }

  async onSearchPress() {
    await this.searchUser(this.usersSearch);
  }

  openSearchPopup() {
    this.userSearchPopupOpen = true;
  }

  async searchUser(value: string) {
    const archives = await this.archiveViewModel.searchUser(value);
    this.archives = archives;
    this.users = archives.slice(0, 3).map(elem => {
      return {
        text: elem.birthName,
        value: {
          ...elem,
          distinction: elem.distinction != null ? {
            ...elem.distinction,
          } : null,
        },
        disabled: false,
        divider: false,
      }
    });
  }

  async onArchiveSelect(id: string) {
    return;
  }

  async onConfirmSelection() {
    this.userSearchPopupOpen = false;
  }

  @Watch("usersSearch")
  async listenOnUserSearch(value: string) {
    try {
      if (value.length >= 3) {
        await this.searchUser(value);
      }

    } catch(e) {
      console.debug(e);
    }
  }

  resetFilters() {
      let folderCopy: Applicant[] = this.archiveViewModel.foldersCopy;
      this.filters = {
          contingent: [],
          grade: [],
          purposedBy: [],
          sessionClosedAt: [],
          decorationType: [],
        decreeDateList: [],
        secretaryAdvices: [],
      }
      this.archiveViewModel.applyFolderFilter({
          filters: this.filters,
          folders: folderCopy,
      });
  }
  toApplicants(): {
    name: string;
    purposeBy?: string;
    grade?: Grade;
    contingent?: ContingentType;
    note?: string;
    id: string;
    editable: boolean;
  }[] {
    return this.archiveViewModel.allFolders.map(elem => {
      return {
        name: `${elem.personalInformation.birthName} ${elem.personalInformation.legalName ? `Ep. ${elem.personalInformation.legalName}` : ''} ${this.capitalize(elem.personalInformation.firstName)}`,
        purposeBy: elem.attachedOrganisation?.name,
        grade: elem.demand?.contingentInformation?.grade,
        contingent: elem.demand?.contingentType,
        id: elem.id,
        applicantId: elem.applicantId,
        editable: false,
        decreeDate: elem.session?.decreeDate ? dayjs(elem.session?.decreeDate).format('DD/MM/YYYY') : "",
        decorationType: toDecorationType(elem.decorationType),
        closedAt: dayjs(elem.session?.closedAt).format('DD/MM/YYYY')
      }
    })
  }

  toLabelAndKey(elem: string) {
    if (this.filters.purposedBy.includes(elem)) {
          return {
              label: elem,
              key: 'purposedBy'
          }
      }
      if (this.filters.sessionClosedAt.includes(elem)) {
          return {
              label: elem,
              key: 'sessionClosedAt'
          }
      }
    if (this.filters.decreeDateList.includes(elem)) {
      return {
        label: elem,
        key: 'decreeDateList'
      }
    }
      if (this.filters.grade.includes(elem as any)) {
          return {
              label: elem,
              key: 'grade'
          }
      }
      if (this.filters.decorationType.includes(elem)) {
          return {
              label: elem,
              key: 'decorationType'
          }
      }
      if (this.filters.contingent.includes(elem as any)) {
          return {
              label: elem,
              key: 'contingent'
          }
      }
    if (this.filters.secretaryAdvices.includes(elem as any)) {
      return {
        label: elem,
        key: 'secretaryAdvices'
      }
    }
  }



  async mounted() {
    const results = await this.applicantRepository.getArchives();
    const archives = results.archives;
    await this.archiveViewModel.initFolders(archives);
    await this.archiveViewModel.initFolderCopy(archives);
    await this.archiveViewModel.setHistory(archives);
  }

  @Watch("search")
  async listenOnChange(value: string) {
    await this.archiveViewModel.search({
      value,
      filters: this.filters,
    });
  }

  async onButtonClick(folderId: string) {
    await this.folderViewModel.selectFolder(folderId)
    window.open("/mes-dossiers/details", "_blank")
  }

  filterKey(item: string, key: string) {
    let folderCopy: Applicant[] = this.archiveViewModel.foldersCopy;
    // eslint-disable-next-line @typescript-eslint/ban-ts-comment
    //@ts-ignore
    const isIncluded = this.filters[key].find(elem => elem === item);
    if (key === 'decorationType') {
      const advices: string[][] = []
      if (this.filters.decorationType.length <= 0) {
        advices.push(this.archiveViewModel.availableSecretaryAdvicesCopy);
      }
      if (this.filters.decorationType.includes('Mérite maritime')) {
        advices.push(this.archiveViewModel.availableSecretaryAdvicesCopy.filter(item => this.mmDecision.includes(item)))
      }
      if (this.filters.decorationType.includes('Ordre national du mérite')) {
        advices.push(this.archiveViewModel.availableSecretaryAdvicesCopy.filter(item => this.lhOnmDecisions.includes(item)))
      }
      if (this.filters.decorationType.includes('Légion d\'honneur')) {
        advices.push(this.archiveViewModel.availableSecretaryAdvicesCopy.filter(item => this.lhOnmDecisions.includes(item)))
      }
      if (this.filters.decorationType.length === 1 && this.filters.decorationType[0] !== 'Mérite maritime' || this.filters.decorationType.length > 1) {
        advices.push(["Liste"])
      }
      const uniqueAdvices = Array.from(new Set(advices.flat()))
      this.filters.secretaryAdvices = this.filters.secretaryAdvices.filter(item => uniqueAdvices.includes(item))
      this.archiveViewModel.updateAvailableSecretaryAdvices(uniqueAdvices)
    }
    if (!isIncluded) {
      this.archiveViewModel.applyFolderFilter({
        filters: this.filters,
        folders: folderCopy,
      })
      return;
    }
    this.archiveViewModel.applyFolderFilter({
      filters: this.filters,
      folders: folderCopy,
    })
  }

}
</script>

<style lang="scss">
.archive-screen {
  text-align: left;
  padding: 0 8rem;
  .v-data-table-header {
    span {
      color: black;
      font-size: 14px;
    }
  }
  .theme--light.v-data-table > .v-data-table__wrapper > table > thead > tr:last-child > th {
    border-bottom: medium solid #3A3A3A;
  }
  .theme--light.v-data-table > .v-data-table__wrapper > table > tbody > tr:hover:not(.v-data-table__expanded__content):not(.v-data-table__empty-wrapper) {
    background: transparent;
  }
  .header-item {
    color: black;
    margin-bottom: 0;
    font-size: 14px;
  }
  .select-btn {
    width: 100%;
    height: 45px!important;
    display: flex;
    justify-content: space-between;
    padding: 0px 15px!important;
    border: none;
    border-bottom: 2px solid black;
    background: #EEEEEE;
    span {
      color: black
    }
  }
}
</style>

````

</details>


---

### 📄 `src/modules/folders/components/AddTags.vue` [4.072 octets]
<a id="src-modules-folders-components-AddTags-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-folders-components-AddTags-vue)

> **Chemin relatif** : `src/modules/folders/components/AddTags.vue`  
> **Taille** : 4.072 octets  
> **Lignes** : 160  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (160 lignes) - Cliquer pour déplier</summary>

```text
<template>
    <div>
  <div style="display: flex; justify-content: flex-start; align-items: center">
    <v-btn :disabled="folderDetailViewModel.selectedPresentation.tags.length >= 3" color="primary" outlined @click="openTagPopup()">
      Ajouter une note
    </v-btn>
      <div style="display: flex">
          <div class="ml-3 mt-3 mb-3" v-for="item in folderDetailViewModel.selectedPresentation.tags" v-bind:key="item.id">
              <div :class="item.color + ' priority'">
                  <span>{{item.text}}</span>
                  <v-btn
                          icon
                          class="ml-3"
                          @click="deleteTag(item.id)"
                          style="height: inherit;width: 20px;"
                  >
                      <v-icon >
                          {{closeIcon}}
                      </v-icon>
                  </v-btn>
              </div>
          </div>
      </div>
  </div>
  <alert
    :open="tagPopup"
    :on-close="onTagPopupClose"
    :with-confirmation="true"
    :on-confirm="onCreateTag"
  >
    <template v-slot:title>
      <h1 class="mb-3">Mes notes</h1>
      <p>Ajoutez votre note sur ce dossier<br/>*visible uniquement par votre entité</p>
    </template>
    <template v-slot:message>
      <div>
        <text-field
          label="Note (max 100 caractères)"
          :required="true"
          v-model="note"
          :default-value="note"
        />
      </div>
      <div class="mb-2">
        <p style="font-size: 16px" class="mb-0">Couleur</p>
        <p style="font-size: 13px;">Choisissez la couleur de votre note</p>
        <v-checkbox
          v-model="color"
          label="Vert"
          color="primary"
          value="priority-0"
          hide-details
        ></v-checkbox>
        <v-checkbox
          v-model="color"
          label="Orange"
          color="primary"
          value="priority-1"
          hide-details
        ></v-checkbox>
        <v-checkbox
          v-model="color"
          label="Rouge"
          color="primary"
          value="priority-2"
          hide-details
        ></v-checkbox>
      </div>

      <div class="mb-2">
        <p style="font-size: 16px" class="mb-3">Aperçu</p>
        <p :class="color + ' priority'" v-if="note !== ''">
          {{note}}
        </p>
      </div>
    </template>
  </alert>
    </div>
</template>

<script lang="ts">
import Component from "vue-class-component";
import Vue from "vue";
import Alert from "@/components/Alert.vue";
import Selector from "@/components/Selector.vue";
import TextField from "@/components/TextField.vue";
import {mdiArrowRight, mdiClose} from "@mdi/js";
import {lazyInject, Validation} from "@pasta/box";
import {OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {required} from "vuelidate/lib/validators";
import {Prop} from "vue-property-decorator";
import {FolderDetailViewModel} from "@/modules/folders/viewModels/FolderDetailViewModel";


@Component({
  components: {
    Alert,
    Selector,
    TextField
  }
})
export default class AddTags extends Vue {
  right = mdiArrowRight;

  @lazyInject(OnBoardingViewModel)
  declare onBoardingViewModel: OnBoardingViewModel;

  @lazyInject(FolderDetailViewModel)
  declare folderDetailViewModel: FolderDetailViewModel;


  @Validation({
    required: {
      errorMessage: "Veuillez sélectionner une entité",
      validator: required,
    }
  })
  entity = "";

  comment = "";

  tagPopup = false;

  color = "priority-0"

  note = ""

    closeIcon = mdiClose



    openTagPopup() {
    this.tagPopup = true;
  }

  onTagPopupClose() {
    this.tagPopup = false;
  }

  async onCreateTag() {
    if (this.note !== "") {
      await this.folderDetailViewModel.addTag({
        text: this.note,
        color: this.color,
      })
      this.tagPopup = false;
      this.note = ""
      this.color = "priority-0"
    }
  }

    async deleteTag(id: string) {
        await this.folderDetailViewModel.deleteTag(id)
    }

}
</script>

<style lang="scss"></style>

```

</details>


---

### 📄 `src/modules/folders/components/AttributionDialog.vue` [2.474 octets]
<a id="src-modules-folders-components-AttributionDialog-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-folders-components-AttributionDialog-vue)

> **Chemin relatif** : `src/modules/folders/components/AttributionDialog.vue`  
> **Taille** : 2.474 octets  
> **Lignes** : 105  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (105 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <alert
    :open="open"
    :on-close="onClose"
    :with-confirmation="true"
    :on-confirm="onValidate"
  >
    <template v-slot:title>
      <div style="display: flex; align-items: flex-start;">
        <v-icon x-large style="color: #161616;vertical-align: middle;">
          {{ right }}
        </v-icon>
        <h2 class="pb-5" style="font-size: 20px;line-height: 1.5">
          {{title}}
        </h2>
      </div>

    </template>
    <template v-slot:message>
      <selector
        label="Attribuer à"
        :items="onBoardingViewModel.entities.map(elem => elem.name)"
        placeholder="Sélectionner une option"
        v-model="entity"
        :error-messages="entityErrors"
      />
      <text-field
        label="Commentaire (facultatif)"
        :required="false"
        :default-value="comment"
        v-model="comment"
        field-type="text-area"
      />
    </template>
  </alert>
</template>

<script lang="ts">
import Component from "vue-class-component";
import Vue from "vue";
import Alert from "@/components/Alert.vue";
import Selector from "@/components/Selector.vue";
import TextField from "@/components/TextField.vue";
import {mdiArrowRight} from "@mdi/js";
import {lazyInject, Validation} from "@pasta/box";
import {OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {required} from "vuelidate/lib/validators";
import {Prop} from "vue-property-decorator";


@Component({
  components: {
    Alert,
    Selector,
    TextField
  }
})
export default class AttributionDialog extends Vue {
  right = mdiArrowRight;

  @lazyInject(OnBoardingViewModel)
  declare onBoardingViewModel: OnBoardingViewModel;

  @Prop({required: true})
  declare title: string;

  @Prop({required: true, default: false})
  declare open: boolean;


  @Prop({required: true})
  declare onClose: Function;

  @Prop({required: true})
  declare onConfirm: (entityId: string, comment?: string) => Promise<void>;

  @Validation({
    required: {
      errorMessage: "Veuillez sélectionner une entité",
      validator: required,
    }
  })
  entity = "";

  comment = "";


  async onValidate() {
    this.$v.$touch();
    const isError = this.$v.$invalid;
    if (!isError) {
      const entity = await this.onBoardingViewModel.selectEntityByName(this.entity);
      if (entity) {
        return this.onConfirm(entity.id, this.comment);
      }

    }
    return;
  }

}
</script>

<style lang="scss"></style>

```

</details>


---

### 📄 `src/modules/folders/components/FolderComments.vue` [8.541 octets]
<a id="src-modules-folders-components-FolderComments-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-folders-components-FolderComments-vue)

> **Chemin relatif** : `src/modules/folders/components/FolderComments.vue`  
> **Taille** : 8.541 octets  
> **Lignes** : 292  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (292 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <div class="folder-comments">
    <p class="mb-12">Ces messages sont visibles par tous les participants de ce dossier.</p>
    <div
      v-for="note in notes"
      v-bind:key="note.id"
      class="note-block"
    >
      <p style="color: #666666;">
        Le {{note.addedAt}}
      </p>
      <div style="display: flex; justify-content: space-between">
        <p :style="{'color': note.style.textColor, 'background-color': note.style.backgroundColor, 'padding': '5px 10px', 'border-radius': '5px', 'padding-bottom': '2px', 'font-weight': '500'}">
          <v-icon class="action-icon" :style="{'color': note.style.textColor, }" >{{note.style.icon}}</v-icon>{{note.action.toUpperCase()}}
        </p>
        <p class="destination">
          {{ note.from.name }} <v-icon small v-if="note.organisation.name != ''">{{arrowRight}}</v-icon> {{ note.organisation.name }}
        </p>
      </div>
      <p style="color: #161616;">
        COMMENTAIRE :
      </p>
      <p style="color: #3A3A3A;">
        {{note.comment}}
      </p>
      <div v-if="isThereInfoRequired(note)">
        <p style="color: #161616;">PIÈCE JOINTE :</p>
        <a class="link" :href="note.documentLink" target="_blank">
          {{note.documentName}}
        </a>
        <p><span style="color: #161616">Note :</span> {{note.infoRequired.comment}}</p>
      </div>
    </div>
  </div>
</template>

<script lang="ts">
import Component from "vue-class-component";
import Vue from "vue";
import {lazyInject} from "@pasta/box";
import dayjs from 'dayjs';
import {mdiAlert, mdiArrowRight, mdiCheckCircle, mdiCloseOctagon, mdiInformation, mdiLightningBolt,} from '@mdi/js';
import {AuthModule} from "@pasta/front-auth";
import {AuthRole} from "@/core/types/identity/AuthRole";
import {FolderDetailViewModel} from "@/modules/folders/viewModels/FolderDetailViewModel";
import {Watch} from "vue-property-decorator";
import {Comment} from "@/core/entities/FolderDetail";
import {DecorationType} from "@/modules/onBoarding/types/DecorationType";

export type NoteColor = {icon: string; textColor: string; backgroundColor: string}

interface ExtendedNote extends Comment {
  style: NoteColor;
  documentName?: string;
  documentLink?: string;
}

@Component
export default class FolderComments extends Vue {

  @lazyInject(FolderDetailViewModel)
  declare folderDetailViewModel: FolderDetailViewModel;

  @lazyInject(AuthModule)
  declare authModule: AuthModule;

  notes: ExtendedNote[] = [];

  arrowRight = mdiArrowRight;

  presentationId = "";


  handleAction(action?: string): NoteColor {
    if (!action) {
      return {
        backgroundColor: "#E8EDFF",
        textColor: '#0063CB',
        icon: mdiInformation
      };
    }
    switch (action.toLowerCase()) {
      case "demande de complément":
      case "à valider":
      case "soumettre au rapporteur":
      case "demande d\'avis":
        return {
          backgroundColor: "#E8EDFF",
          textColor: '#0063CB',
          icon: mdiInformation
        }
      case "non validé":
      case "avis défavorable":
      case "non agréé":
      case "non agréé(e)":
        return {
          backgroundColor: "#FFE9E9",
          textColor: '#CE0500',
          icon: mdiCloseOctagon
        }
      case "avis très favorable":
      case "avis favorable":
      case "admissible":
      case "décorés":
      case "validé":
        return {
          backgroundColor: "#B8FEC9",
          textColor: '#18753C',
          icon: mdiCheckCircle
        }
      case "en discussion":
        return {
          backgroundColor: "#FEECC2",
          textColor: '#716043',
          icon: mdiLightningBolt
        }
      case "avis réservé":
      case "ajourné":
      case "ajourné(e)":
        return {
          backgroundColor: "#FFE8E5",
          textColor: '#B34000',
          icon: mdiAlert
        }
      default:
          return {
            backgroundColor: "#E8EDFF",
            textColor: '#0063CB',
            icon: mdiInformation
          }
    }
  }

  isAuthorizedToSeeRapporterAdvice() {
    const currentUser = this.authModule.currentUser;
    const role = currentUser?.highestRoleLevel ?? 0;
    return role >= AuthRole.CHANCELLERY || role >= 1000;
  }

  @Watch('folderDetailViewModel.selectedPresentation.id')
  async onPresentationChange() {
    await this.init()
  }

 async mounted() {
    await this.init();
  }

  async init() {
    this.notes = [];
    if (!this.folderDetailViewModel.selectedPresentation.notes) {
      return;
    }
    const notes = this.folderDetailViewModel.selectedPresentation.notes.filter(elem => !this.shouldBeFiltered(elem.action as string));
    const finalNote = this.folderDetailViewModel.selectedPresentation.decision;
    const isSessionClosed = this.folderDetailViewModel.selectedPresentation.session?.decreeDate != null;
    if (finalNote && this.isAuthorizedToSeeRapporterAdvice() || finalNote && isSessionClosed) {
      if (finalNote.action === 'Décorés' || finalNote.action === 'Proposer') {
        this.notes.push({
          action: 'Décorés',
          comment: finalNote.comment,
          from: {
            name: 'Secrétaire de séance',
            userId: "",
            id: ""
          },
          organisation: {
            name: '',
            userId: "",
            id: ""
          },
          addedAt: dayjs(finalNote.addedAt).format("LL") as any,
          style: this.handleAction(finalNote.action),
          id: finalNote.id,
        })
      }
    }
    for (const elem of notes) {
      let documentName = "";
      let link = "";
      if (elem?.action === 'Décorés') {
        continue;
      }
      if (this.isThereInfoRequired(elem) && elem.infoRequired?.documentId) {
        const [, name] = elem.infoRequired.documentId.split('/');
        link = await this.folderDetailViewModel.getDocumentLink({
          documentName: name,
          persisted: false,
        });
        documentName = atob(name);
      }
      let action = elem.action?.toLowerCase();
      if (action === "submitted") {
        action = "À valider";
      }
      if (action === "information_required") {
        action = "demande de complément";
      }
      if (action && action.toLowerCase() === "soumettre au rapporteur") {
        action = "soumis au rapporteur";
      }
      const rapporterAdvice = [
        'admissible',
        'en discussion',
        'ajourné',
        'non agrée',
      ];
      if (rapporterAdvice.includes(action as string)) {
        if (this.isAuthorizedToSeeRapporterAdvice()) {
          this.notes.push({
            id: elem.id,
            addedAt: dayjs(elem.addedAt).format("LL") as any,
            action: action,
            comment: elem.comment,
            from: elem.from,
            organisation: elem.organisation,
            style: this.handleAction(action),
            infoRequired: elem.infoRequired,
            ...(this.isThereInfoRequired(elem) && {
              documentName: documentName,
              documentLink: link,
            })
          })

        }
        continue;
      }
      this.notes.push({
        id: elem.id,
        addedAt: dayjs(elem.addedAt).format("LL") as any,
        action: action,
        comment: elem.comment,
        from: elem.from,
        organisation: elem.organisation,
        style: this.handleAction(action),
        infoRequired: elem.infoRequired,
        ...(this.isThereInfoRequired(elem) && {
          documentName: documentName,
          documentLink: link,
        })
      })
    }
  }

  shouldBeFiltered(action: string) {
    const filteredAction = [
      'Admissible',
      'En discussion',
      'Ajourné',
      'Non agréé',
    ]
    const currentUser = this.authModule.currentUser;
    const role = currentUser?.highestRoleLevel ?? 0;
    return filteredAction.includes(action) && role <= AuthRole.DIRM;
  }

  isThereInfoRequired(note: Comment) {
    return note.infoRequired && (note.infoRequired.comment != null || note.infoRequired.documentId != null)
  }


}
</script>

<style lang="scss">
.folder-comments {
  text-align: left;
  .note-block {
    border: 1px solid #DDDDDD;
    max-width: 1000px;
    margin-top: 20px;
    margin-bottom: 20px;
    font-size: 14px;
    padding: 24px;
  }
  .destination {
    font-weight: 500;
    color: #161616;
  }
  .action-icon svg {
    width: 19px;
    margin-right: 5px;
    margin-bottom: 4px;
  }
  .link {
    color: #0063CB;
    text-decoration: underline;
    cursor: pointer;
  }
}
</style>

```

</details>


---

### 📄 `src/modules/folders/components/FolderDetailHeader.vue` [9.618 octets]
<a id="src-modules-folders-components-FolderDetailHeader-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-folders-components-FolderDetailHeader-vue)

> **Chemin relatif** : `src/modules/folders/components/FolderDetailHeader.vue`  
> **Taille** : 9.618 octets  
> **Lignes** : 332  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (332 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <div class="folder-detail">
    <div class="tools-actions-profil">
      <div class="col">
        <div class="row">
          <a style="border-bottom: 1px solid #000091" @click="goBack()" role="link" tabindex="0"
          ><v-icon color="primary">{{ mdiArrowLeftThin }}</v-icon
          ><span>Retour à la liste</span>
          </a>
        </div>
        <div class="row" style="margin-top: 24px; margin-bottom: 10px">
          <div class="icon">
            <v-icon color="primary" x-large>{{ User }}</v-icon>
          </div>
          <div class="col">
            <div class="row" style="align-items: baseline; margin-bottom: 0">
              <div>
                <h1>{{ getName() }}</h1>
              </div>
            </div>
          </div>
        </div>
        <div class="mb-3" style="display:flex; justify-content: center;align-items: center;">
          <div v-if="getAge()" style="text-align: left; display: flex; align-items: center;">
            <v-icon class="mr-2" style="vertical-align: middle;">{{mdiCalendarWeekBegin}}</v-icon>
            <p class="mr-5 mb-0">{{ getAge() }}</p>
          </div>
          <div style="text-align: left; display: flex; align-items: center;">
            <v-icon class="mr-2" style="vertical-align: middle;">{{mdiHomeVariant}}</v-icon>
            <p class="mb-0">{{folderDetailViewModel.folder.personalInformation.address.rawAddress}}</p>
          </div>
        </div>
      </div>
      <template>
        <v-tabs
            v-model="active_tab"
            background-color="transparent"
            slider-color="#000091"
            optional
            right
            active-class="active"
        >
          <v-tab v-for="tab of tabs" :key="tab.id" @click="onClick(tab.id)">
            <div style="display: flex; align-items: center">
              <v-icon small style="margin-right: 5px">{{ tab.icon }}</v-icon> {{ tab.name }}
            </div>
          </v-tab>
        </v-tabs>
      </template>
    </div>
    <div class="text-center" v-if="folderDetailViewModel.headerActions.length > 0">
      <v-menu offset-y left>
        <template v-slot:activator="{ on, attrs }">
          <v-btn
            color="secondary"
            class="header-action-left"
            v-bind="attrs"
            v-on="on"
          >
            Options <v-icon style="margin-right: 5px; margin-top: 5px; vertical-align: middle">{{ mdiChevronDown }}</v-icon>
          </v-btn>
        </template>
        <v-list>
          <v-list-item
            v-for="(item, index) in folderDetailViewModel.headerActions"
            :key="index"
            :class="!item.disabled ? 'option-active' : 'option-inactive'"
            @click='handleHeaderAction(item)'
          >
            <v-list-item-title>{{ item.title }}</v-list-item-title>
          </v-list-item>
        </v-list>
      </v-menu>
    </div>
    <alert
      :open="folderInfoPopup"
      :with-confirmation="true"
      :action="false"
      :on-close="onCloseFolderInfo"
      :on-confirm="onConfirmFolderInfo"
    >
      <template v-slot:title>
        <h2 class="pb-5">
          Modifier les informations de {{getName()}}
        </h2>
      </template>
      <template v-slot:message>
        <folder-information-update
          :applicant-id="folderDetailViewModel.folder.id"
          :onCloseBtnClick="onCloseFolderInfo"
          :on-confirm-btn-click="onConfirmFolderInfo"
        />
      </template>
    </alert>
  </div>
</template>

<script lang="ts">
import Component from "vue-class-component";
import Vue from "vue";
import {FolderViewModel} from "@/modules/folders/viewModels/FolderViewModel";
import dayjs from "dayjs";
import {
    mdiAccountCircle,
    mdiArrowLeftThin,
    mdiBookOpenPageVariantOutline,
    mdiEyeOutline,
  mdiChevronDown,
  mdiHomeVariant,
  mdiCalendarWeekBegin
} from "@mdi/js";
import {lazyInject, Validation} from "@pasta/box";
import {Prop} from "vue-property-decorator";
import {Civility} from "@/modules/onBoarding/types/Civility";
import {OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
// eslint-disable-next-line @typescript-eslint/ban-ts-comment
//@ts-ignore
import {AuthModule} from "@pasta/front-auth";
import Alert from "@/components/Alert.vue";

import TextField from "@/components/TextField.vue";
import Selector from "@/components/Selector.vue";
import {required} from "vuelidate/lib/validators";
import {FolderDetailViewModel} from "@/modules/folders/viewModels/FolderDetailViewModel";
import AddTags from "@/modules/folders/components/AddTags.vue";
import {OnBoardingPath} from "@/modules/onBoarding/navigation/OnBoardingPath";
import FolderInformationUpdate from "@/modules/folders/components/FolderInformationUpdate.vue";

@Component({
  components: {FolderInformationUpdate, Selector, Alert, TextField, AddTags },
})
export default class FolderDetailHeader extends Vue {
  @lazyInject(FolderViewModel)
  declare folderViewModel: FolderViewModel;

  @lazyInject(OnBoardingViewModel)
  declare onboardingViewModel: OnBoardingViewModel;

  @lazyInject(FolderDetailViewModel)
  declare folderDetailViewModel: FolderDetailViewModel;


  @lazyInject(AuthModule)
  declare authModule: AuthModule;


  @Validation({
    required: {
      errorMessage: "Veuillez sélectionner une option",
      validator: required,
    },
  })
  selectedAction = "";

  @Prop({ required: true, default: false })
  declare selectedTab: (id: number) => void;

  goBack() {
    this.$router.back();
    //window.location.href = "/mes-dossiers";
  }
  mdiArrowLeftThin = mdiArrowLeftThin;
  contingent: String = "";
  mdiHomeVariant = mdiHomeVariant;
  mdiCalendarWeekBegin = mdiCalendarWeekBegin;
  mdiChevronDown = mdiChevronDown

  User = mdiAccountCircle;

  active_tab = 0;
  tabs = [
    { id: 0, name: "Présentations", icon: mdiEyeOutline },
    { id: 1, name: "Historique", icon: mdiBookOpenPageVariantOutline }
  ];
  onClick(id: number) {
    return this.selectedTab(id);
  }

  folderInfoPopup = false;
  onCloseFolderInfo() {
    this.folderInfoPopup = false;
  }
  onConfirmFolderInfo() {
   this.folderInfoPopup = false;
   window.location.reload();
  }

  async handleHeaderAction(item: any) {
    if (item.disabled) {
      return;
    }
    if (item.id === 'representable') {
      await this.onboardingViewModel.getPresentation({
        presentationId: this.folderDetailViewModel.selectedPresentation.id,
        applicantId: this.folderDetailViewModel.folder.id,
      })
      return this.$router.push(OnBoardingPath.DECORATION);
    }
    if (item.id === 'updatable') {
      await this.onboardingViewModel.getPresentation({
        presentationId: this.folderDetailViewModel.selectedPresentation.id,
        applicantId: this.folderDetailViewModel.folder.id,
      })
      this.onboardingViewModel.setUpdateInfoOnly(true);
      this.folderInfoPopup = true;
      //return this.$router.push(OnBoardingPath.PERSONAL_INFORMATION);
    }
  }
  formatBirthDate(date: Date): string {
    return "Né le " + dayjs(date).format("DD/MM/YYYY");
  }
  calculateAge(date: Date): string {
    var today = new Date();
    var birthDate = new Date(date);
    var age = today.getFullYear() - birthDate.getFullYear();
    var m = today.getMonth() - birthDate.getMonth();
    if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
      age--;
    }
    return String(age) + "ans";
  }
  capitalize(value: string) {
    return value.charAt(0).toUpperCase() + value.slice(1).toLowerCase();
  }

  getName() {
    return `${
      this.folderDetailViewModel.folder.personalInformation.civility === Civility.MR ? "M." : "Mme"
    } ${this.folderDetailViewModel.folder.personalInformation.birthName.toUpperCase()} ${
      this.folderDetailViewModel.folder.personalInformation.legalName
        ? `Ep. ${this.folderDetailViewModel.folder.personalInformation.legalName}`
        : ""
    } ${this.capitalize(this.folderDetailViewModel.folder.personalInformation.firstName)}
    `;
  }

  getAge() {
    if (!this.folderDetailViewModel.folder.personalInformation.birthDate) {
      return null;
    }
    const birthDate = new Date(this.folderDetailViewModel.folder.personalInformation.birthDate)
    return `${this.formatBirthDate(
      birthDate
    )} (${this.calculateAge(birthDate)})`;
  }



}
</script>

<style lang="scss">

.option-active {
  cursor: pointer!important;
}
.option-inactive {
  cursor: initial;
  background: #E5E5E5;
  color: #929292!important;
}

.folder-detail {
  display: flex;
  justify-content: space-between;
  width: 100%;

  .header-action-left {
    font-size: 17px;
  }


  .name {
    color: #000000;
  }
  .userIco {
    width: 30px;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .infoIco {
    width: 15px;
    height: 15px;
    background-color: #e8edff;
    margin-right: 5px;
  }
  .tabIco {
    margin-right: 5px;
  }
  .contingent {
    display: flex;
    background-color: #e8edff;
    align-items: center;
    color: #0063cb;
    font-weight: 500;
    font-size: 14px;
    line-height: 24px;
    padding-left: 10px;
    padding-right: 10px;
  }

  .v-application p {
    padding-left: 5px;
    padding-right: 5px;
  }
  .v-tabs-slider-wrapper {
    top: 0px !important;
  }

  .v-tab {
    margin-left: 5px !important;
    margin-right: 5px !important;
    background-color: #e3e3fd;
    font-weight: 700;
  }
  .active {
    background-color: white;
  }
  .row {
    align-items: center;
  }
  .icon {
    margin-right: 20px;
  }
  .headerInfo {
    margin-right: 15px;
    display: flex;
  }
}
</style>

````

</details>


---

### 📄 `src/modules/folders/components/FolderInformationUpdate.vue` [15.029 octets]
<a id="src-modules-folders-components-FolderInformationUpdate-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-folders-components-FolderInformationUpdate-vue)

> **Chemin relatif** : `src/modules/folders/components/FolderInformationUpdate.vue`  
> **Taille** : 15.029 octets  
> **Lignes** : 513  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (513 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <div>
  <v-form class="civilRecord" ref="civilRecordForm">
    <v-container>
      <v-row>
        <v-col
          cols="12"
          sm="12"
          class="pt-0 pb-0"
        >
          <p id="input-93">Civilité :</p>
          <v-radio-group
            class="civilRecord__gender"
            row
            required
            id="input-93"
            aria-labelledby="input-93"
            v-model="civility"
            :error-messages="civilityErrors"
          >
            <v-radio label="Madame" :value="civilityValues[1]"></v-radio>
            <v-radio label="Monsieur" :value="civilityValues[0]"></v-radio>
          </v-radio-group>
        </v-col>
        <v-col
          cols="12"
          sm="6"
          class="pt-0 pb-0"
        >
          <text-field
            label="Nom de naissance"
            id="birthName"
            :required="true"
            :error-messages="birthNameErrors"
            v-model="birthName"
            :default-value="birthName"
            autoCompleteAttribute="birth-name"
          />
        </v-col>
        <v-col
          cols="12"
          sm="6"
          class="pt-0 pb-0"
        >
          <text-field
            label="Nom(s) d'usage"
            :required="true"
            :default-value="legalName"
            :error-messages="legalNameErrors"
            v-model="legalName"
            @input="legalName = legalName.toUpperCase()"
            autoCompleteAttribute="family-name"
          />
        </v-col>
        <v-col
          cols="12"
          sm="12"
          class="pt-0 pb-0"
        >
          <text-field
            label="Prénom(s)"
            :required="true"
            :mandatory="true"
            sub-label="Séparer les prénoms avec des virgules"
            :default-value="firstName"
            :error-messages="firstNameErrors"
            v-model="firstName"
            @input="firstName = firstName.toUpperCase()"
            autoCompleteAttribute="given-name"
          />
        </v-col>
        <v-col
          cols="12"
          sm="6"
          class="pt-0 pb-0"
        >
          <text-field
            label="Date de naissance (jj/mm/aaaa)"
            type="date"
            :mandatory="true"
            :required="true"
            :default-value="birthDate"
            :error-messages="birthDateErrors"
            v-model="birthDate"
            autoCompleteAttribute="bday"
          />
        </v-col>
        <v-col
          cols="12"
          sm="6"
          class="pt-0 pb-0"
        >
          <selector
            label="Nationalité"
            :items="personalInformationViewModel.countries.map(item => item.label.toUpperCase())"
            :mandatory="true"
            v-model="nationality"
            :error-messages="nationalityErrors"
            :default-value="nationality"
          />
        </v-col>
        <v-col
          cols="12"
          sm="6"
          class="pt-0 pb-0"
        >
          <selector
            label="Pays de naissance"
            :items="personalInformationViewModel.countries.map(item => item.label.toUpperCase())"
            :mandatory="true"
            v-model="birthCountry"
            :error-messages="birthCountryErrors"
            :default-value="birthCountry"
          />
        </v-col>
        <v-col
          cols="12"
          sm="6"
          class="pt-0 pb-0 textfield"
        >
          <label style="color: #161616;" for="birthCity">Ville de naissance<span style="color: red">*</span></label>
          <p></p>
          <v-combobox
            ref="birthCityCombobox"
            :required="true"
            id="birthCity"
            class="mt-3"
            :error-messages="birthCityErrors"
            v-model="birthCity"
            :items="cities"
            filled
            :search-input.sync="birthPlaceSearch"
            :loading="searchZipCodeLoading"
            no-filter
            :cache-items="false"
            append-icon=""
            :hide-no-data="false"
          />
        </v-col>
        <v-col
            cols="12"
            sm="12"
            class="pt-0 pb-0" 
            v-if="this.birthCountry ==='FRANCE'"
          >
            <selector
              label="Département de naissance"
              :items="personalInformationViewModel.departments.map(item => item.label.toUpperCase())"
              :mandatory="true"
              v-model="birthDepartment"
              :error-messages="birthDepartmentErrors"
              :default-value="birthDepartment"
            />
          </v-col>
        <v-col
          cols="12"
          sm="12"
          class="pt-0 pb-0"
        >
          <text-field
            label="Adresse"
            :required="true"
            :mandatory="true"
            :default-value="street"
            :error-messages="streetErrors"
            v-model="street"
            autoCompleteAttribute="street-address"
          />
        </v-col>
        <v-col
          cols="12"
          sm="6"
          class="pt-0 pb-0"
        >
          <text-field
            label="Code postal"
            :required="true"
            :default-value="zipCode"
            :mandatory="true"
            v-model="zipCode"
            autoCompleteAttribute="postal-code"
          />
        </v-col>
        <v-col
          cols="12"
          sm="6"
          class="pt-0 pb-0"
        >
          <text-field
            label="Ville"
            :required="true"
            :default-value="city"
            :mandatory="true"
            :error-messages="cityErrors"
            v-model="city"
            @input="city = city.toUpperCase()"
          />
        </v-col>
        <v-col
          cols="12"
          sm="12"
          class="pt-0 pb-0"
        >
          <selector
            label="Pays de résidence"
            :items="personalInformationViewModel.countries.map(item => item.label.toUpperCase())"
            v-model="residencyCountry"
            :default-value="residencyCountry"
            :error-messages="residencyCountryErrors"
          />
        </v-col>
      </v-row>
    </v-container>
  </v-form>
    <v-card-actions class="justify-end pb-5" >
      <v-btn
        :outlined="true"
        color="primary"
        @click="onCloseBtnClick"
      >
        Annuler
      </v-btn>
      <v-btn
        color="primary"
        class="ml-5"
        @click="submit"
      >
        Confirmer
      </v-btn>
    </v-card-actions>
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import TextField from "@/components/TextField.vue";
import Selector from "@/components/Selector.vue";
import {Civility} from "@/modules/onBoarding/types/Civility";
import {lazyInject, Validation} from "@pasta/box";
import {helpers, minLength, required, requiredIf} from "vuelidate/lib/validators";
import {DateFormat} from "@/core/valueObjects/DateFormat";
import {
  PersonalInformationViewModel
} from "@/modules/onBoarding/viewModels/personalInformation/PersonalInformationViewModel";
import {Prop, Watch} from "vue-property-decorator";
import dayjs from "dayjs";
import {Address} from "@/core/entities/Address";
import {DecorationType} from "@/modules/onBoarding/types/DecorationType";
import {HonoreIdentifier} from "@/core/HonoreIdentifier";
import {ApplicantRepository} from "@/core/repositories/ApplicantRepository";
import {FolderDetailViewModel} from "@/modules/folders/viewModels/FolderDetailViewModel";
import { debounce } from 'lodash';


@Component({
  components: {Selector, TextField}
})
export default class FolderDetailHeader extends Vue {

  @lazyInject(PersonalInformationViewModel)
  declare personalInformationViewModel: PersonalInformationViewModel;

  @lazyInject(HonoreIdentifier.applicantRepository)
  declare applicantRepository: ApplicantRepository;

  @lazyInject(FolderDetailViewModel)
  declare folderDetailViewModel: FolderDetailViewModel;


  civilityValues = Object.values(Civility);

  debouncedSearchCity = debounce(this.doSearchCity, 300);
  disableWatcher = false;

  async doSearchCity(value: string) {
    this.cities = await this.personalInformationViewModel.searchCity({
      byZipCode: !isNaN(+value),
      query: value,
    });
  }

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre civilité",
      validator: required,
    }
  })
  civility = Civility.MRS;

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre nom de naissance",
      validator: required,
    },
    minLength: {
      errorMessage: "Doit comporter au moins deux caractères",
      validator: minLength(2)
    }
  })
  birthName = "";

  @Validation({
    minLength: {
      errorMessage: "Doit comporter au moins deux caractères",
      validator: minLength(2)
    }
  })
  legalName = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre prénom",
      validator: required,
    },
    minLength: {
      errorMessage: "Doit comporter au moins deux caractères",
      validator: minLength(2)
    }
  })
  firstName = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre date de naissance",
      validator: required,
    },
    isValid: {
      errorMessage: "Veuillez renseigner une date de naissance valide",
      validator: helpers.withParams({
        type: 'birthDate'
      }, (val: string) => {
        return DateFormat.validate(val);
      }),
    }
  })
  birthDate = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre nationalité",
      validator: required,
    }
  })
  nationality = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre pays de naissance",
      validator: required,
    }
  })
  birthCountry = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre département de naissance",
      validator: requiredIf((val: any) => {
        return val.birthCountry === 'FRANCE'
      }),
    }
  })
  birthDepartment = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre lieu de naissance",
      validator: required,
    },
    minLength: {
      errorMessage: "Doit comporter au moins deux caractères",
      validator: minLength(2)
    }
  })
  birthCity = "";

  birthPlaceSearch = "";
  searchZipCodeLoading = false;
  cities: string[] = [];

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner une rue",
      validator: required,
    }
  })
  street: string = "";

  zipCode = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner une ville",
      validator: required,
    }
  })
  city = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre pays de résidence",
      validator: required,
    }
  })
  residencyCountry = "";


  @Prop({required: true})
  declare applicantId: string;

  @Prop({required: true})
  declare onCloseBtnClick: () => void;

  @Prop({required: true})
  declare onConfirmBtnClick: () => void;


  @Watch("birthPlaceSearch")
  async listenOnChangeZipCode(value: string) {
    if (this.disableWatcher) return;

    try {
      this.birthPlaceSearch = value ? value.toUpperCase() : "";
      if (this.birthCountry === 'FRANCE') {
        this.searchZipCodeLoading = true;
        
        this.debouncedSearchCity(value);

        this.birthDepartment = await this.personalInformationViewModel.searchDepartment({
          query: value,
        }); 
      }
    } catch(e) {
      console.debug(e);
    } finally {
      this.searchZipCodeLoading = false;
    }
  }

  async mounted() {
    // Désactive le watcher
    this.disableWatcher = true;

    focus();
    await this.personalInformationViewModel.fetchCountries();
    await this.personalInformationViewModel.fetchDepartments();
    const personalInformation = await this.personalInformationViewModel.getScreenState(this.folderDetailViewModel.selectedPresentation.decorationType);
    this.birthName = personalInformation.birthName;
    this.civility = personalInformation.civility;
    this.legalName = personalInformation.legalName;
    this.birthDate = dayjs(personalInformation.birthDate).format('YYYY-MM-DD');
    this.birthCity = personalInformation.birthCity;
    this.birthPlaceSearch = personalInformation.birthCity;
    this.birthDepartment = personalInformation.birthDepartment.toUpperCase();
    this.firstName = personalInformation.firstName;
    this.nationality = personalInformation.nationality.toUpperCase();
    this.residencyCountry = personalInformation.residencyCountry.toUpperCase();
    this.birthCountry = personalInformation.birthCountry.toUpperCase();
    this.city = personalInformation.rawAddress.city;
    this.street = personalInformation.rawAddress.street;
    this.zipCode = personalInformation.rawAddress.zipCode;
    
    // Réactive le watcher
    this.$nextTick(() => {
      this.disableWatcher = false;
    });
  }

  async submit() {
    let birthCityComboboxInput : HTMLInputElement = this.$refs.birthCityCombobox as HTMLInputElement;

    //blur + nextTick : On rend inactif le curseur du champ Ville de naissance pour que sa valeur de saisie soit bien prise en compte 
    birthCityComboboxInput.blur();
    this.$nextTick(() => {
      this.$v.$touch();
      const isInvalid = this.$v.$invalid;
      if (!isInvalid) {
        const address = Address.build({
          city: this.city,
          zipCode: this.zipCode,
          street: this.street,
          country: this.residencyCountry
        }).props;
        const nationalityCountryCode = this.personalInformationViewModel.countries.find(item => item.label.toUpperCase() === this.nationality);
        const residencyCountryCode = this.personalInformationViewModel.countries.find(item => item.label.toUpperCase() === this.residencyCountry);
        const birthCountryCode = this.personalInformationViewModel.countries.find(item => item.label.toUpperCase() === this.birthCountry);
        const birthDepartmentCode = this.personalInformationViewModel.departments.find(item => item.label.toUpperCase() === this.birthDepartment);

        this.applicantRepository.updatePersonalInformation(this.applicantId, {
          firstName: this.firstName.toUpperCase(),
          ...(this.legalName !== "" && {
            legalName: this.legalName.toUpperCase(),
          }),
          birthName: this.birthName.toUpperCase(),
          birthDate: this.birthDate,
          birthCity: this.birthCity,
          birthDepartment: this.birthCountry !== 'FRANCE' ? "" : birthDepartmentCode?.code as any,
          civility: this.civility,
          address: address,
          nationality: nationalityCountryCode?.code as any,
          residencyCountry: residencyCountryCode?.code as any,
          birthCountry: birthCountryCode?.code as any,
          decorationType: DecorationType.MERITE_MARITIME,
        })
        this.onConfirmBtnClick();
      }  
    });
    
  }

}
</script>

```

</details>


---

### 📄 `src/modules/folders/components/FolderResume.vue` [12.801 octets]
<a id="src-modules-folders-components-FolderResume-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-folders-components-FolderResume-vue)

> **Chemin relatif** : `src/modules/folders/components/FolderResume.vue`  
> **Taille** : 12.801 octets  
> **Lignes** : 360  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (360 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <div class="container folder-resume">
    <div class="row align-center">
      <div class="mt-3 mb-3">
        <v-btn :disabled="folderDetailViewModel.selectedFolder.tags.length >= 3" color="primary" outlined @click="openTagPopup()">
          Ajouter une note
        </v-btn>
      </div>
      <div class="ml-3 mt-3 mb-3" v-for="item in folderDetailViewModel.selectedFolder.tags" v-bind:key="item.id">
        <div :class="item.color + ' priority'">
          <span>{{item.text}}</span>
          <v-btn
            icon
            class="ml-3"
            @click="deleteTag(item.id)"
            style="height: inherit;width: 20px;"
          >
            <v-icon >
              {{closeIcon}}
            </v-icon>
          </v-btn>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="row">
        <div style="display: flex; align-items: center">
          <v-img :src="Fishing" class="fishingIco" alt="" />
          <div style="margin-top: 15px; margin-left: 10px">
            <p class="folderResumeTitle">{{ folderDetailViewModel.selectedFolder.demand.askedPosition }}</p>
          </div>
        </div>
      </div>
      <div class="folderContainer">
        <v-row>
          <v-col cols="10" class="br">
            <v-row no-gutters justify="space-between" align="start" class="mb-3">
              <v-col cols="6" class="br text-left">
                <div style="display: flex; margin-bottom: 32px">
                  <p class="folderContainerTitle">{{ "Quartier :".toUpperCase() }}&nbsp;</p>
                  <p v-if="quarter" class="folderContainerValue">{{ quarter }}</p>
                </div>
              </v-col>
              <v-col cols="6" class="br text-left" style="display: flex; margin-bottom: 32px">
                <p class="folderContainerTitle">{{ "Numéro de marin :".toUpperCase() }}&nbsp;</p>
                <p v-if="marineLicenseNumber" class="folderContainerValue">{{ marineLicenseNumber }}</p>
              </v-col>
              <v-col cols="6" class="br text-left" style="display: flex; margin-bottom: 32px">
                <p class="folderContainerTitle">{{ "Secteur :".toUpperCase() }}&nbsp;</p>
                <p v-if="activityArea" class="folderContainerValue">{{ activityArea }}</p>
              </v-col>
              <v-col cols="6" class="br text-left" style="display: flex; margin-bottom: 32px">
                <p class="folderContainerTitle">{{ "Brevet :".toUpperCase() }}&nbsp;</p>
                <p v-if="license" class="folderContainerValue">{{  license }}</p>
              </v-col>

              <v-col cols="6" class="br text-left" style="display: flex; margin-bottom: 32px">
                <p class="folderContainerTitle">{{ "Avis Dirm :".toUpperCase() }}&nbsp;</p>
                <p class="folderContainerValue">{{"-"}}</p>
              </v-col>

              <v-col cols="6" class="br text-left" style="display: flex; margin-bottom: 32px">
                <p class="folderContainerTitle">{{ "Total des services maritimes (en mois) :".toUpperCase() }}&nbsp;</p>
                <p v-if="navigationDuration" class="folderContainerValue">{{ navigationDuration }}</p>
              </v-col>
              <v-col cols="6" class="br" style="margin-bottom: 32px; text-align: left">
                <p class="folderContainerTitle">{{ "Décorations obtenues :".toUpperCase() }}&nbsp;</p>
                <p v-if="distinction.grade !== ''" class="folderContainerValue">{{distinction.name}} : {{distinction.grade}} {{distinction.decreeDate}}</p>
              </v-col>
              <v-col cols="6" class="br text-left" style="display: flex; margin-bottom: 32px">
                <p class="folderContainerTitle">{{ "Demeurant :".toUpperCase() }}&nbsp;</p>
                <p v-if="address" class="folderContainerValue">{{ address }}</p>
              </v-col>
              <v-col cols="6" class="br text-left" style="display: flex; margin-bottom: 32px;">
                <p class="folderContainerTitle">{{ "motif de la décoration :".toUpperCase() }}&nbsp;</p>
                <p v-if="decorationReason" class="folderContainerValue">{{ decorationReason }}</p>
              </v-col>
              <v-col cols="12" class="br text-left" v-if="folderDetailViewModel.selectedFolder.session && folderDetailViewModel.selectedFolder.session.decreeDate">
                <p class="folderContainerTitle">{{"dernières présentations au mérite maritime :".toUpperCase()}}</p>
                <v-data-table
                    :headers="headers"
                    :items="toPresentation()"
                    style="background: #F6F6F6;"
                    :disable-pagination="true"
                    :disable-filtering="true"
                    :footer-props="{
                        disableItemsPerPage: true,
                    }"
                    calculate-widths
                    class="elevation-0 mt-8"
                    locale="fr-FR"
                    item-key="id"
                >
                </v-data-table>
              </v-col>
            </v-row>
          </v-col>
        </v-row>
      </div>
    </div>
    <alert
      :open="tagPopup"
      :on-close="onTagPopupClose"
      :with-confirmation="true"
      :on-confirm="onCreateTag"
    >
      <template v-slot:title>
        <h1 class="mb-3">Mes notes</h1>
        <p>Ajoutez votre note sur ce dossier<br/>*visible uniquement par votre entité</p>
      </template>
      <template v-slot:message>
        <div>
          <text-field
            label="Note (max 100 caractères)"
            :required="true"
            v-model="note"
            :default-value="note"
            :error-messages="noteErrors"
          />
        </div>
        <div class="mb-2">
          <p style="font-size: 16px" class="mb-0">Couleur</p>
          <p style="font-size: 13px;">Choisissez la couleur de votre note</p>
          <v-checkbox
            v-model="color"
            label="Vert"
            color="primary"
            value="priority-0"
            hide-details
          ></v-checkbox>
          <v-checkbox
            v-model="color"
            label="Orange"
            color="primary"
            value="priority-1"
            hide-details
          ></v-checkbox>
          <v-checkbox
            v-model="color"
            label="Rouge"
            color="primary"
            value="priority-2"
            hide-details
          ></v-checkbox>
        </div>

        <div class="mb-2">
          <p style="font-size: 16px" class="mb-3">Aperçu</p>
          <p :class="color + ' priority'" v-if="note !== ''">
            {{note}}
          </p>
        </div>
      </template>
    </alert>
  </div>
</template>

<script lang="ts">
import Component from "vue-class-component";
import Fishing from "../../../assets/fishing.svg";
import Vue from "vue";
import {lazyInject, Validation} from "@pasta/box";
import {Address} from "@/core/entities/Address";
import {Grade} from "@/core/types/training/Grade";
import dayjs from "dayjs";
import Alert from "@/components/Alert.vue";
import Selector from "@/components/Selector.vue";
import TextField from "@/components/TextField.vue";
import { mdiClose } from "@mdi/js"
import {required} from "vuelidate/lib/validators";
import {FolderDetailViewModel} from "@/modules/folders/viewModels/FolderDetailViewModel";
import {FolderViewModel} from "@/modules/folders/viewModels/FolderViewModel";

@Component({
  components: {Selector, Alert, TextField}
})
export default class FolderResume extends Vue {
  @lazyInject(FolderViewModel)
  declare folderViewModel: FolderViewModel;

  @lazyInject(FolderDetailViewModel)
  declare folderDetailViewModel: FolderDetailViewModel

  tagPopup = false;

  closeIcon = mdiClose

  Fishing = Fishing;
  quarter: String = "";
  marineLicenseNumber: String = "";
  activityArea: String = "";
  navigationDuration: String = "0";
  address: String = "";
  license : String = "";
  distinction: {
    decreeDate: string;
    rankTakingDate: string;
    grade: Grade;
    name: string;
  } = {
    decreeDate: "",
    grade: "" as any,
    name: "",
    rankTakingDate: ""
  }
  grade: String = "";

  headers = [
    {
      text: "Titre",
      align: "start",
      sortable: false,
      value: "titleAsked",
    },
    { text: "Promotion", value: "promotionName", sortable: false },
    { text: "Avis", value: "advice", sortable: false },
  ];

  decorationReason = "";

  color = "priority-0"

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner une note",
      validator: required
    }
  })
  note = ""

  openTagPopup() {
    this.tagPopup = true;
  }

  onTagPopupClose() {
    this.tagPopup = false;
  }
  async onCreateTag() {
    this.$v.$touch();
    const isError = this.$v.$invalid;
    if (!isError) {
      // await this.folderViewModel.addTag({
      //   text: this.note,
      //   color: this.color,
      // })
      this.tagPopup = false;
      this.note = ""
      this.color = "priority-0"
    }
  }

  async deleteTag(id: string) {
   // await this.folderViewModel.deleteTag(id)
  }

  async mounted() {
    this.marineLicenseNumber = this.folderDetailViewModel.selectedFolder.training?.marineLicenseNumber ?? "-";
    this.quarter = this.folderDetailViewModel.selectedFolder.training?.quarter ?? "-";
    this.activityArea = this.folderDetailViewModel.selectedFolder.demand?.activityArea ?? "-";
    this.navigationDuration = String(this.folderDetailViewModel.selectedFolder.demand?.totalDuration) ?? "0";
    this.license = this.folderDetailViewModel.selectedFolder.training?.license ?? "-";
    this.address = Address.build(this.folderDetailViewModel.selectedFolder.personalInformation.address as any).props.rawValue
    this.grade = this.folderDetailViewModel.selectedFolder.training?.previousGrade ?? "-";
    if (this.folderDetailViewModel.selectedFolder.training?.distinction?.name) {
      const distinctionName = await this.folderViewModel.mapDistinctionName(this.folderDetailViewModel.selectedFolder.training.distinction?.name)
      this.distinction = {
        decreeDate: dayjs(this.folderDetailViewModel.selectedFolder.training.distinction?.decreeDate).format('DD/MM/YYYY'),
        rankTakingDate: dayjs(this.folderDetailViewModel.selectedFolder.training?.distinction?.rankTakingDate).format('DD/MM/YYYY'),
        grade: this.folderDetailViewModel.selectedFolder.training.previousGrade as Grade,
        name: distinctionName
      }
    }
    if (this.folderDetailViewModel.selectedFolder.demand?.contingentInformation?.reasonGradeProposal === "exceptional_fact") {
      this.decorationReason = this.folderDetailViewModel.selectedFolder.demand?.contingentInformation?.reasonForExceptionalFact ?? "Faits exceptionnel";
    }
    if (this.folderDetailViewModel.selectedFolder.demand?.contingentInformation?.reasonGradeProposal === "duration") {
      if (this.folderDetailViewModel.selectedFolder.demand.contingentInformation.grade === Grade.KNIGHT) {
        this.decorationReason = 'durée de service supérieure à 10 ans'
      } else {
        this.decorationReason = '5 ans ou plus  depuis l\'obtention du grade de chevalier (mérites nouveaux)'
      }
    }
  }



  toPresentation(): {
    titleAsked: string;
    promotionName: string;
    advice: string;
  }[] {
    return [
      {
        advice: this.folderDetailViewModel.selectedFolder.decision?.action as any,
        promotionName: this.folderDetailViewModel.selectedFolder.session?.name as any,
        titleAsked: this.folderDetailViewModel.selectedFolder.demand?.contingentInformation?.grade as any
      }
    ]
  }
}
</script>

<style lang="scss">

.folder-resume {
  margin-left: 0;

  .fishingIco {
    width: 20px;
    height: 20px;
  }
  .v-data-footer {
    display: none;
  }
  .folderContainer {
    margin-top: 32px;
  }
  .folderContainerValue {
    font-style: normal;
    font-weight: 400;
    font-size: 16px;
    line-height: 24px;
  }
  .folderResumeTitle {
    size: 20px;
    font-weight: 600;
    font-size: 20px;
    line-height: 28px;
    font-style: normal;
    color: #161616;
  }
  .folderContainerTitle {
    font-weight: 700;
    font-size: 14px;
    line-height: 24px;
    font-style: normal;
    color: #161616;
    background: linear-gradient(#E3E3FD 0%, #E3E3FD 100%) no-repeat;
    background-size: calc(70px) calc(60%);
    background-position: 3px bottom;
  }
  /*.theme--light.v-data-table {
    background-color: #f6f6f6;
  }*/
  .v-data-table-header {
    span {
      color: #161616;
      font-style: normal;
      font-weight: 700;
      font-size: 14px;
      line-height: 24px;
    }
  }
  .theme--light.v-data-table > .v-data-table__wrapper > table > thead > tr:last-child > th {
    border-bottom: medium solid#161616;
  }
}

</style>

```

</details>


---

### 📄 `src/modules/folders/components/LHONMPresentation.vue` [26.894 octets]
<a id="src-modules-folders-components-LHONMPresentation-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-folders-components-LHONMPresentation-vue)

> **Chemin relatif** : `src/modules/folders/components/LHONMPresentation.vue`  
> **Taille** : 26.894 octets  
> **Lignes** : 775  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (775 lignes) - Cliquer pour déplier</summary>

```text
<template>

  <div>
    <div style="display: flex; align-items: center; justify-content: space-between" class="mb-4">
      <div>
        <p class="title-pres">Synthèse du dossier</p>
      </div>
      <div style="display:flex; align-items: center; ">
        <div class="ml-4" v-if="folderDetailViewModel.selectedPresentation.isEditable && folderDetailViewModel.selectedPresentation.decorationType !== 'merite_maritime'">
          <p
            @click="editDecoration(folderDetailViewModel.selectedPresentation.id)"
            style="cursor: pointer; margin-bottom: 0; color: #000091; border-bottom: 2px solid #000091"
            role="link"
            tabindex="0"
          >
            <v-icon color="primary" style="margin-bottom: 10px">{{ penIcon }}</v-icon> Modifier la décoration
          </p>
        </div>
        <div class="ml-4" v-if="folderDetailViewModel.selectedPresentation.isEditable">
          <p
              @click="edit(folderDetailViewModel.selectedPresentation.id)"
              style="cursor: pointer; margin-bottom: 0; color: #000091; border-bottom: 2px solid #000091"
              role="link"
              tabindex="0"
          >
            <v-icon color="primary" style="margin-bottom: 10px">{{ penIcon }}</v-icon> Modifier le dossier
          </p>
        </div>
        <div class="ml-4">
          <p
              @click="saveAsWord(folderDetailViewModel.selectedPresentation.id)"
              style="cursor: pointer; margin-bottom: 0; color: #000091; border-bottom: 2px solid #000091"
              role="link"
              tabindex="0"
          >
            <v-icon color="primary" style="margin-bottom: 10px">{{ attachment }}</v-icon> Exporter au format word
          </p>
        </div>
      </div>
    </div>
    <div style="display: flex;">
      <div class="mr-10" style="display: flex;">
        <p class="folderContainerTitle">{{ "Proposé par :".toUpperCase() }}&nbsp;</p>
        <p class="folderContainerValue">{{ folderDetailViewModel.selectedPresentation.attachedOrganisation.name }}</p>
      </div>
      <div style="display: flex;">
        <p class="folderContainerTitle">{{ "Proposé le :".toUpperCase() }}&nbsp;</p>
        <p v-if="folderDetailViewModel.selectedPresentation.purposedAt" class="folderContainerValue ml-2">{{ folderDetailViewModel.selectedPresentation.purposedAt }}</p>
      </div>
    </div>

    <div style="display: flex;" v-if="folderDetailViewModel.selectedPresentation.decision != null && folderDetailViewModel.selectedPresentation.session.decreeDate != null">
      <div class="mr-10" style="display: flex;">
        <p class="folderContainerTitle">{{ "Statut :".toUpperCase() }}&nbsp;</p>
        <p class="folderContainerValue">{{ folderDetailViewModel.selectedPresentation.decision.action }}</p>
      </div>
      <div style="display: flex;">
        <p class="folderContainerTitle">{{ "Date de décret :".toUpperCase() }}&nbsp;</p>
        <p v-if="folderDetailViewModel.selectedPresentation.purposedAt" class="folderContainerValue ml-2">{{ dayjs(folderDetailViewModel.selectedPresentation.session.decreeDate).format('DD/MM/YYYY') }}</p>
      </div>
    </div>

    <div style="display: flex;" v-if="folderDetailViewModel.selectedPresentation.decision != null && folderDetailViewModel.selectedPresentation.session.decreeDate != null">
      <div class="mr-10" style="display: flex;">
        <p class="folderContainerTitle">{{ "Date de prise de rang :".toUpperCase() }}&nbsp;</p>
        <p class="folderContainerValue" v-if="folderDetailViewModel.selectedPresentation.decision.rankTakingDate != null">{{ dayjs(folderDetailViewModel.selectedPresentation.decision.rankTakingDate).format('DD/MM/YYYY') }}</p>
        <v-btn text color="primary" @click="openRankTakingDatePopup">
          {{ folderDetailViewModel.selectedPresentation.decision.rankTakingDate ? 'Modifier' : 'Ajouter' }} la date de prise rang
        </v-btn>
      </div>
    </div>

    <add-tags class="mb-4 mt-4"/>

    <p class="title-pres">Suivi de dossier</p>
    <v-row>
      <v-col cols="12" class="mb-4">
        <v-checkbox
            :input-value="folderDetailViewModel.selectedPresentation.completedAt != null"
            @change="onCompletionChange"
            label="DOSSIER COMPLET"
            class="completed"
        />
        <text-field
            label="Suivi de dossier (champs libre)"
            :required="true"
            :default-value="folderDetailViewModel.selectedPresentation.comment"
            type="textarea"
            v-model="folderDetailViewModel.selectedPresentation.comment"
            field-type="text-area"
        />
        <v-btn @click="saveComment" outlined color="primary">
          Sauvegarder
        </v-btn>
      </v-col>
    </v-row>
    <p class="title-pres">Activité</p>

    <div class="row ml-1 mt-5 mb-5">
      <div class="anchor">
        <v-img :src="Fishing" class="fishingIco" alt="" />
        <div>
          <p class="subtitle mb-1 ml-2">{{ folderDetailViewModel.selectedPresentation.activity.activityArea }}</p>
        </div>
      </div>
    </div>

    <v-row>
      <v-col cols="4" class="br">
        <v-row no-gutters justify="space-between" align="start" class="mb-3">
          <v-col cols="12" class="br text-left">
            <div style="display: flex;">
              <p class="folderContainerTitle">{{ "Statut :".toUpperCase() }}&nbsp;</p>
              <p v-if="folderDetailViewModel.selectedPresentation.activity.status" class="folderContainerValue ml-2">{{ folderDetailViewModel.selectedPresentation.activity.status }}</p>
            </div>
          </v-col>
          <v-col cols="12" class="br text-left">
            <div style="display: flex;">
              <p class="folderContainerTitle">{{ "Fonction exercée :".toUpperCase() }}&nbsp;</p>
              <p class="folderContainerValue">{{ folderDetailViewModel.selectedPresentation.activity.positionHeld }}</p>
            </div>
          </v-col>
          <v-col cols="12" class="br text-left">
            <div style="display: flex;">
              <p class="folderContainerTitle">{{ "Grade obtenu :".toUpperCase() }}&nbsp;</p>
              <p v-if="folderDetailViewModel.selectedPresentation.training.previousGrade" class="folderContainerValue">{{ folderDetailViewModel.selectedPresentation.training.previousGrade }}</p>
            </div>
          </v-col>
          <v-col cols="12" class="br text-left">
            <div style="display: flex;">
              <p class="folderContainerTitle">{{ "Date de prise de rang :".toUpperCase() }}&nbsp;</p>
              <p v-if="folderDetailViewModel.selectedPresentation.training.distinction.rankTakingDate" class="folderContainerValue">{{ dayjs(folderDetailViewModel.selectedPresentation.training.distinction.rankTakingDate).format('DD/MM/YYYY') }}</p>
            </div>
          </v-col>
        </v-row>
      </v-col>
      <v-col cols="4" class="br">
        <v-row no-gutters justify="space-between" align="start" class="mb-3">
          <v-col cols="12" class="br text-left">
            <div style="display: flex;">
              <p class="folderContainerTitle">{{ "Secteur d'activité :".toUpperCase() }}&nbsp;</p>
              <p class="folderContainerValue">{{ folderDetailViewModel.selectedPresentation.activity.activityArea }}</p>
            </div>
          </v-col>
          <v-col cols="12" class="br text-left">
            <div style="display: flex;">
              <p class="folderContainerTitle">{{ "Fonction exercée apparaissant sur le décret :".toUpperCase() }}&nbsp;</p>
              <p v-if="folderDetailViewModel.selectedPresentation.activity.positionHeldOnDecree" class="folderContainerValue ml-2">{{ folderDetailViewModel.selectedPresentation.activity.positionHeldOnDecree }}</p>
            </div>
          </v-col>
          <v-col cols="12" class="br text-left">
            <div style="display: flex;">
              <p class="folderContainerTitle">{{ "Décoration :".toUpperCase() }}&nbsp;</p>
              <p v-if="folderDetailViewModel.selectedPresentation.training.gradeDetailTitle" class="folderContainerValue">{{ folderDetailViewModel.selectedPresentation.training.gradeDetailTitle }}</p>
            </div>
          </v-col>
          <v-col cols="12" class="br text-left">
            <div style="display: flex;">
              <p class="folderContainerTitle">{{ "Date du décret :".toUpperCase() }}&nbsp;</p>
              <p v-if="folderDetailViewModel.selectedPresentation.training.distinction.decreeDate" class="folderContainerValue">{{ dayjs(folderDetailViewModel.selectedPresentation.training.distinction.decreeDate).format('DD/MM/YYYY') }}</p>
            </div>
          </v-col>
        </v-row>
      </v-col>
    </v-row>

    <p class="title-pres">Recommandants</p>
    <v-row>
      <v-col cols="6">
        <recommandant-form
            :recommandants="folderDetailViewModel.selectedPresentation.activity.recommandants"
            :on-add-recommandant="onAddRecommant"
            :on-update-recommandant="onUpdateRecommandant"
            :allow-create="false"
            :on-remove-recommandant="onRemoveRecommandant"
            :allow-delete="false"
        />
      </v-col>
    </v-row>

    <p class="title-pres">Grade demandé et annuités générales</p>
    <v-row>
      <v-col cols="4" class="br">
        <v-row no-gutters justify="space-between" align="start" class="mb-3">
          <v-col cols="12" class="br text-left">
            <div style="display: flex;">
              <p class="folderContainerTitle">{{ "Cabinet :".toUpperCase() }}&nbsp;</p>
              <p v-if="folderDetailViewModel.selectedPresentation.annuity.office" class="folderContainerValue ml-2">{{ folderDetailViewModel.selectedPresentation.annuity.office }}</p>
            </div>
          </v-col>
          <v-col cols="12" class="br text-left">
            <div style="display: flex;">
              <p class="folderContainerTitle">{{ "Date de début :".toUpperCase() }}&nbsp;</p>
              <p v-if="folderDetailViewModel.selectedPresentation.annuity.startDate" class="folderContainerValue">{{ dayjs(folderDetailViewModel.selectedPresentation.annuity.startDate).format('DD/MM/YYYY') }}</p>
            </div>
          </v-col>
        </v-row>
      </v-col>
      <v-col cols="4" class="br">
        <v-row no-gutters justify="space-between" align="start" class="mb-3">
          <v-col cols="12" class="br text-left">
            <div style="display: flex;">
              <p class="folderContainerTitle">{{ "Grade proposé :".toUpperCase() }}&nbsp;</p>
              <p class="folderContainerValue">{{ folderDetailViewModel.selectedPresentation.annuity.grade }}</p>
            </div>
          </v-col>
        </v-row>
      </v-col>
    </v-row>
    <v-row>
      <v-col cols="12" sm="12" class="mt-8 pt-0 pb-0">
        <h2 tabindex="-1">Total services effectués</h2>
      </v-col>
    </v-row>
    <div style="display: flex" class="mt-10">
      <div class="mr-5">
        <date-box
            :count="isNaN(dayjs().diff(folderDetailViewModel.selectedPresentation.annuity.startDate)) ? '0' : Math.floor(dayjs().diff(folderDetailViewModel.selectedPresentation.annuity.startDate) / (1000 * 60 * 60 * 24 * 365)).toString()"
            title="Années"
        />
      </div>
      <div class="mr-5">
        <date-box
            :count="isNaN(dayjs().diff(folderDetailViewModel.selectedPresentation.annuity.startDate)) ? '0' : Math.floor((dayjs().diff(folderDetailViewModel.selectedPresentation.annuity.startDate) % (1000 * 60 * 60 * 24 * 365)) / (1000 * 60 * 60 * 24 * 30.4375)).toString()"
            title="Mois"
        />
      </div>

      <div>
        <date-box
            :count="isNaN(dayjs().diff(folderDetailViewModel.selectedPresentation.annuity.startDate)) ? '0' : Math.floor((dayjs().diff(folderDetailViewModel.selectedPresentation.annuity.startDate) % (1000 * 60 * 60 * 24 * 365)) % (1000 * 60 * 60 * 24 * 30.4375) / (1000 * 60 * 60 * 24)).toString()"
            title="Jours"
        />
      </div>
    </div>

    <div class="mb-5 mt-10">
      <p class="title-pres">Mémoire</p>
      <p>
        {{folderDetailViewModel.selectedPresentation.annuity.reasonProposal}}
      </p>
    </div>

    <p class="title-pres">Documents déposés</p>
    <div style="display: flex; align-items: center;" v-if="!folderDetailViewModel.selectedPresentation.documents.length">
      <img
          :src="DocumentEmpty"
      />
      <p class="ml-5 mb-0">Aucun document déposé</p>
    </div>
    <div
        class="attachments mb-5"
        v-for="file in folderDetailViewModel.selectedPresentation.documents"
        v-bind:key="file.id"
    >
      <div v-if="file.type === 'birth_certificate'" style="display: flex;" class="mb-4">
        <p class="mr-4 mb-0 folderContainerTitle">{{"Acte de naissance :".toUpperCase()}}</p>
        <p class="mb-0">
          <a class="link" :href="file.rawLink" target="_blank">
            {{file.rawName}}
          </a>
        </p>
      </div>

      <div v-if="file.type === 'criminal_record'" style="display: flex;" class="mb-4">
        <p class="mr-4 mb-0 folderContainerTitle">{{"Casier judiciaire :".toUpperCase()}}</p>
        <p class="mb-0">
          <a class="link" :href="file.rawLink" target="_blank">
            {{file.rawName}}
          </a>
        </p>
      </div>

      <div v-if="file.type === 'resume'" style="display: flex;" class="mb-4">
        <p class="mr-4 mb-0 folderContainerTitle">CV :</p>
        <p class="mb-0">
          <a class="link" :href="file.rawLink" target="_blank">
            {{file.rawName}}
          </a>
        </p>
      </div>
      <div v-if="file.type === 'prefect_opinion'" style="display: flex;" class="mb-4">
        <p class="mr-4 mb-0 folderContainerTitle">{{"Avis préfet :".toUpperCase()}}</p>
        <p  class="mb-0">
          <a class="link" :href="file.rawLink" target="_blank">
            {{file.rawName}}
          </a>
        </p>

      </div>
      <div  v-if="file.type === 'other'">
        <p>Autres documents :</p>
        <p
            v-for="other in folderDetailViewModel.selectedPresentation.documents.filter(item => item.type === 'other')"
            v-bind:key="other.id"
        >
          <a class="link" :href="other.rawLink" target="_blank">
            {{other.name}}
          </a>
        </p>
      </div>
    </div>
    <div class="mb-5">
      <p class="title-pres">
        Commentaires et notes
      </p>
      <folder-comments/>
    </div>
    <alert
      :open="rankTakingDatePopupOpen"
      :on-close="onCloseRankTakingDatePopupOpen"
      :with-confirmation="true"
      :on-confirm="onConfirmRankTakingDatePopupOpen"
    >
      <template v-slot:title>
        <h1 class="mb-10">Date de prise de rang</h1>
      </template>
      <template v-slot:message>
        <text-field
          label="Date de naissance (jj/mm/aaaa)"
          type="date"
          :mandatory="true"
          :required="true"
          :default-value="rankTakingDate"
          v-model="rankTakingDate"
          autoCompleteAttribute="bday"
        />
      </template>
    </alert>
    <alert
      :open="editDecorationPopup"
      :on-close="onCloseEditDecorationOpen"
      :with-confirmation="true"
      :on-confirm="onEditDecorationOpen"
    >
      <template v-slot:title>
        <h1 class="mb-10">Modifier la décoration</h1>
      </template>
      <template v-slot:message>
        <v-radio-group
          role="radiogroup"
          aria-labelledby="decoration"
          class="decoration--choice"
          mandatory
          v-model="decoration"
        >
          <template v-slot:label>
            <span>Sélectionnez une décoration</span>
          </template>
          <v-radio aria-checked="null" id="decoration" label="Légion d'Honneur" value="legion_honneur"></v-radio>
          <v-radio aria-checked="null" id="decoration" label="Ordre national du mérite" value="ordre_national_du_merite"></v-radio>
        </v-radio-group>
        <selector
          label="Promotion"
          :items="sessionAvailableForMove.map(item => item.name)"
          :mandatory="true"
          v-model="selectedPromotion"
          :default-value="selectedPromotion"
        />
        <selector
          label="Cabinet"
          v-if="selectedPromotion != ''"
          :items="cabinetList"
          :mandatory="true"
          v-model="selectedOffice"
          :default-value="selectedOffice"
        />
      </template>
    </alert>
  </div>
</template>

<script lang="ts">
import Component from "vue-class-component";
import Vue from "vue";
import {lazyInject} from "@pasta/box";
import {FolderDetailViewModel} from "@/modules/folders/viewModels/FolderDetailViewModel";
import Fishing from "../../../assets/fishing.svg";
import FolderComments from "./FolderComments.vue";
import {OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {mdiAttachment, mdiPen} from "@mdi/js";
import {AuthModule} from "@pasta/front-auth";
import {HonoreIdentifier} from "@/core/HonoreIdentifier";
import {FileExporter} from "@/core/gateways/FileExporter";
import {FolderViewModel} from "@/modules/folders/viewModels/FolderViewModel";
import Selector from "@/components/Selector.vue";
import Alert from "@/components/Alert.vue";
import TextField from "@/components/TextField.vue";
import DocumentEmpty from "../../../assets/document-empty.png";
import AttributionDialog from "@/modules/folders/components/AttributionDialog.vue";
import {SessionViewModel} from "@/modules/sessions/viewModels/SessionViewModel";
import {HomeViewModel} from "@/modules/home/viewModels/HomeViewModel";
import dayjs from "dayjs";
import AddTags from "@/modules/folders/components/AddTags.vue";
import {OnBoardingPath} from "@/modules/onBoarding/navigation/OnBoardingPath";
import RecommandantForm from "@/modules/recommandants/components/RecommandantForm.vue";
import {Recommandant} from "@/core/entities/Recommandant";
import DateBox from "@/modules/onBoarding/components/DateBox.vue";
import {DecorationType} from "@/modules/onBoarding/types/DecorationType";
import {Session} from "@/core/entities/Session";
import {Watch} from "vue-property-decorator";


@Component({
  methods: {dayjs},
  components: {
    DateBox,
    RecommandantForm,
    AddTags,
    AttributionDialog,
    TextField,
    Alert, Selector,
    FolderComments,
  }
})
export default class LHONMPresentation extends Vue {
  @lazyInject(FolderDetailViewModel)
  declare folderDetailViewModel: FolderDetailViewModel;

  @lazyInject(OnBoardingViewModel)
  declare onboardingViewModel: OnBoardingViewModel;

  @lazyInject(FolderViewModel)
  declare folderViewModel: FolderViewModel;

  @lazyInject(AuthModule)
  declare authModule: AuthModule;

  @lazyInject(HonoreIdentifier.fileExporter)
  declare fileExporter: FileExporter;

  @lazyInject(SessionViewModel)
  declare sessionViewModel: SessionViewModel;

  @lazyInject(HomeViewModel)
  declare homeViewModel: HomeViewModel;

  Fishing = Fishing;
  DocumentEmpty = DocumentEmpty;
  penIcon = mdiPen;
  attachment = mdiAttachment;

  rankTakingDatePopupOpen = false;
  editDecorationPopup = false;

  selectedOffice = "";

  selectedPromotion = "";

  cabinetList: string[] = [];

  decoration: DecorationType = DecorationType.LEGION_HONNEUR;

  sessionAvailableForMove: Session[] = [];

  rankTakingDate = "";

  async onAddRecommant(recommandant: Recommandant) {
    return;
  }

  async onUpdateRecommandant(recommandant: Recommandant) {
    return;
  }

  async saveAsWord(id: string) {
    await this.fileExporter.saveLHONMWordFromDetailFolder(this.folderDetailViewModel.folder, id)
  }

  openRankTakingDatePopup() {
    this.rankTakingDatePopupOpen = true;
  }

  onCloseRankTakingDatePopupOpen() {
    this.rankTakingDatePopupOpen = false
  }
  async onConfirmRankTakingDatePopupOpen() {
    await this.folderDetailViewModel.addRankTakingDate(this.rankTakingDate);
    this.rankTakingDatePopupOpen = false;
  }


  async edit(presentationId: string) {
    this.onboardingViewModel.clearAll();
    const applicant = await this.folderDetailViewModel.getPresentation({
      presentationId,
      applicantId: this.folderDetailViewModel.folder.id,
    })
    await this.onboardingViewModel.enrich(applicant);
    this.onboardingViewModel.updateEditMode(true);
    const decorationType = await this.folderDetailViewModel.fromDecorationType(this.folderDetailViewModel.selectedPresentation.decorationType);
    this.onboardingViewModel.selectDecoration(decorationType);
    if (this.folderDetailViewModel.selectedPresentation.decorationType !== DecorationType.MERITE_MARITIME) {
      return this.$router.push(OnBoardingPath.ACTIVITY);
    }
    return this.$router.push(OnBoardingPath.TRAINING_INFORMATION);
  }

  async onRemoveRecommandant(id: string) {
    return;
  }

  onCloseEditDecorationOpen() {
    this.editDecorationPopup = false;
  }

  async onEditDecorationOpen() {
    const promotion = this.homeViewModel.sessions.find(elem => elem.name === this.selectedPromotion);
    if (!promotion) {
      return;
    }
    await this.folderDetailViewModel.movePresentationToAnotherDecoration({
      office: this.selectedOffice,
      decorationType: this.decoration,
      sessionId: promotion.id,
    })
    this.editDecorationPopup = false;
    window.location.reload();
  }

  async saveComment() {
    await this.folderDetailViewModel.commentPresentation(
        this.folderDetailViewModel.selectedPresentation.comment ?? "",
    )
  }

  @Watch('decoration')
  onDecorationChange(value: string) {
    this.sessionAvailableForMove = this.homeViewModel.sessionList.filter(elem => {
      return elem.decoration === value && elem.closedAt == null;
    })
    this.cabinetList = [];
  }

  @Watch('selectedPromotion')
  onSelectedPromotion(value: string) {
    const promotion = this.homeViewModel.sessions.find(elem => elem.name === value);
    this.selectedOffice = ""
    if (promotion && promotion.decoration !== DecorationType.MERITE_MARITIME) {
      this.cabinetList = promotion.quotas.map(elem => elem.cabinet);
    }
  }

  editDecoration(id: string) {
    const applicant = this.folderDetailViewModel.selectedPresentation;
    this.decoration = applicant.decorationType
    this.editDecorationPopup = true;
  }

  async onCompletionChange(value: boolean) {
    await this.folderDetailViewModel.completePresentation(value)
  }
}
</script>

<style lang="scss">
.presentation {
  text-align: left;
  display: flex;
  .completed {
    label {
      font-weight: 500;
      color: #212121;
    }
  }
  .title-pres {
    font-size: 32px!important;
  }
  .detail {
    width: 100%;
  }
  .subtitle {
    font-size: 24px!important;
    font-weight: 500;
  }
  .v-tab {
    flex-direction: column;
    justify-content: flex-start!important;
    align-items: flex-start;
    text-transform: initial;
    .decoration_enum {
      font-weight: bold;
      font-size: 16px;
    }
  }
  .anchor {
    display: flex;
    align-items: center;

  }
  .headerInfo {
    width: 170px;
    .contingent {
      display: flex;
      background-color: #e8edff;
      align-items: center;
      color: #0063cb;
      font-weight: bold;
      font-size: 14px;
      line-height: 24px;
      padding-left: 10px;
      padding-right: 10px;
      border-radius: 5px;
    }
  }
  .action-window {
    text-align: left;
    width: 400px;
    background-color: white;
    border-radius: 10px;
    padding: 24px;
    box-shadow: 0px 6px 18px #00001229;
    .reduce-icon {
      position: absolute;
      right: 15px;
      top: 10px;
      font-size: 22px;
      cursor: pointer;
    }

    h3 {
      font-weight: 500;
      color: #000000;
    }
    .light-grey {
      color: #666666;
    }
    .submit-btn {
      color: #0063CB;
      padding: 0;
      font-size: 14px;
      span {
        letter-spacing: 0;
      }
    }
  }
  .folderContainerTitle {
    font-weight: 500;
    font-size: 14px;
    line-height: 24px;
    font-style: normal;
    color: #161616;
  }
  .v-list-item {
    text-transform: initial!important;
  }
  .v-select__selection--comma {
    text-transform: initial!important;
  }
  .folder {
    position: relative;
    .attachment {
      padding: 1rem 7rem;
    }
    .folder-contents-container {
      padding: 0rem 7rem;
    }
    .resize-icon {
      position: absolute;
      top: 8rem;
      text-align: left;
      right: 5rem;
      background-color: white;
      border-radius: 10px;
      padding: 10px;
      box-shadow: 0px 6px 18px #00001229;
    }
    .header {
      padding-left: 7rem;
      padding-top: 2rem;
      display: flex;
      width: 100%;
      justify-content: space-between;
    }
    .resume {
      padding: 1rem 7rem;
    }
    .memory {
      padding: 1rem 7rem;
    }
    .information {
      color: #666666;
      font-weight: 400;
      font-size: 14px;
      margin-top: 5px!important;
    }

    .align-center {
      display: flex;
      align-items: center;
    }

    .file-input {
      margin-top: 14px;
      p {
        margin-left: 10px;
        margin-top: 0;
        font-size: 14px;
        font-weight: 400;
        margin-bottom: 0;
      }
      button {
        background-color: #EEEEEE!important;
        padding-left: 5px!important;
        padding-right: 5px!important;
        box-shadow: none;
        border-radius: 4px!important;
        span {
          font-size: 14px!important;
          letter-spacing: 0;
          font-weight: 400;
        }
      }
      .file-list {
        margin-bottom: 14px;
        div:nth-of-type(1) {
          flex: 0 0 auto!important;
        }
        p {
          margin-right: 10px;
          margin-left: 5px;
          margin-bottom: 3px;
        }
      }
      .remove-btn {
        background-color: transparent!important;
        padding-left: 0!important;
        padding-right: 0!important;
        svg {
          width: 18px;
          height: 18px;
        }
      }
      .border-red {
        border: 1px solid red
      }

      button {
        letter-spacing: 0px!important;
      }
    }
  }
  .rapporter-advice-ok {
    text-transform: uppercase !important;
    margin-bottom: 5px;
    background-color: #b8fec9;
    display: inherit;
    padding: 3px 10px;
    border-radius: 5px;
    color: #18753c;
    font-weight: 700;
  }
  .rapporter-advice-discussion {
    text-transform: uppercase !important;
    margin-bottom: 5px;
    background-color: #feecc2;
    display: inherit;
    padding: 3px 10px;
    border-radius: 5px;
    color: #716043;
    font-weight: 700;
  }
  .rapporter-advice-refused {
    text-transform: uppercase !important;
    margin-bottom: 5px;
    background-color: #ffe8e5;
    display: inherit;
    padding: 3px 10px;
    border-radius: 5px;
    color: #b34000;
    font-weight: 700;
  }
}
</style>

```

</details>


---

### 📄 `src/modules/folders/components/MMPresentation.vue` [34.414 octets]
<a id="src-modules-folders-components-MMPresentation-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-folders-components-MMPresentation-vue)

> **Chemin relatif** : `src/modules/folders/components/MMPresentation.vue`  
> **Taille** : 34.414 octets  
> **Lignes** : 928  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (928 lignes) - Cliquer pour déplier</summary>

````text
<template>

<div>
      <div style="display: flex; align-items: center; justify-content: space-between" class="mb-4">
        <div>
          <p class="title-pres">Synthèse du dossier</p>
        </div>
        <div style="display:flex; align-items: center; ">
          <div class="ml-4" v-if="folderDetailViewModel.selectedPresentation.isEditable">
            <p
                @click="edit(folderDetailViewModel.selectedPresentation.id)"
                style="cursor: pointer; margin-bottom: 0; color: #000091; border-bottom: 2px solid #000091"
                role="link"
                tabindex="0"
            >
              <v-icon color="primary" style="margin-bottom: 10px">{{ penIcon }}</v-icon> Modifier le dossier
            </p>
          </div>
          <div class="ml-4">
            <p
                @click="saveAsWord(folderDetailViewModel.selectedPresentation.id)"
                style="cursor: pointer; margin-bottom: 0; color: #000091; border-bottom: 2px solid #000091"
                role="link"
                tabindex="0"
            >
              <v-icon color="primary" style="margin-bottom: 10px">{{ attachment }}</v-icon> Exporter au format word
            </p>
          </div>
        </div>
      </div>

      <div style="display: flex;">
        <div class="mr-10" style="display: flex;">
          <p class="folderContainerTitle">{{ "Proposé par :".toUpperCase() }}&nbsp;</p>
          <p class="folderContainerValue">{{ folderDetailViewModel.selectedPresentation.attachedOrganisation.name }}</p>
        </div>
        <div style="display: flex;">
          <p class="folderContainerTitle">{{ "Proposé le :".toUpperCase() }}&nbsp;</p>
          <p v-if="folderDetailViewModel.selectedPresentation.purposedAt" class="folderContainerValue ml-2">{{ folderDetailViewModel.selectedPresentation.purposedAt }}</p>
        </div>
      </div>

  <div style="display: flex;" v-if="folderDetailViewModel.selectedPresentation.decision != null && folderDetailViewModel.selectedPresentation.session.decreeDate != null">
    <div class="mr-10" style="display: flex;">
      <p class="folderContainerTitle">{{ "Statut :".toUpperCase() }}&nbsp;</p>
      <p class="folderContainerValue">{{ folderDetailViewModel.selectedPresentation.decision.action }}</p>
    </div>
    <div style="display: flex;">
      <p class="folderContainerTitle">{{ "Date de décret :".toUpperCase() }}&nbsp;</p>
      <p v-if="folderDetailViewModel.selectedPresentation.purposedAt" class="folderContainerValue ml-2">{{ dayjs(folderDetailViewModel.selectedPresentation.session.decreeDate).format('DD/MM/YYYY') }}</p>
    </div>
  </div>

  <div style="display: flex;" v-if="folderDetailViewModel.selectedPresentation.decision != null && folderDetailViewModel.selectedPresentation.session.decreeDate != null">
    <div class="mr-10" style="display: flex;">
      <p class="folderContainerTitle">{{ "Date de prise de rang :".toUpperCase() }}&nbsp;</p>
      <p class="folderContainerValue" v-if="folderDetailViewModel.selectedPresentation.decision.rankTakingDate != null">{{ dayjs(folderDetailViewModel.selectedPresentation.decision.rankTakingDate).format('DD/MM/YYYY') }}</p>
      <v-btn text color="primary" @click="openRankTakingDatePopup">
        {{ folderDetailViewModel.selectedPresentation.decision.rankTakingDate ? 'Modifier' : 'Ajouter' }} la date de prise rang
      </v-btn>
    </div>
  </div>

  <v-row>
    <v-col cols="12" class="mb-4">
      <v-checkbox
          :input-value="folderDetailViewModel.selectedPresentation.completedAt != null"
          @change="onCompletionChange"
          label="DOSSIER COMPLET"
          class="completed"
      />
      <text-field
          label="Suivi de dossier (champs libre)"
          :required="true"
          :default-value="folderDetailViewModel.selectedPresentation.comment"
          type="textarea"
          v-model="folderDetailViewModel.selectedPresentation.comment"
          field-type="text-area"
      />
      <v-btn @click="saveComment" outlined color="primary">
        Sauvegarder
      </v-btn>
      <p v-if="saveOK">Sauvegardé avec succès</p>
    </v-col>
  </v-row>

      <div v-if="folderDetailViewModel.selectedPresentation.rapporterAdvice">
        <div class="text-left">
          <div style="display: flex; align-items: center;">
            <p class="folderContainerTitle mt-3 mr-4">AVIS : </p>
            <p v-if="folderDetailViewModel.selectedPresentation.rapporterAdvice.action.toLowerCase() === 'admissible'" class="rapporter-advice-ok mr-5">
              {{ folderDetailViewModel.selectedPresentation.rapporterAdvice.action }}
            </p>
            <p v-if="folderDetailViewModel.selectedPresentation.rapporterAdvice.action.toLowerCase() === 'en discussion'" class="rapporter-advice-discussion mr-5">
              {{ folderDetailViewModel.selectedPresentation.rapporterAdvice.action }}
            </p>
            <p
                v-if="
                      folderDetailViewModel.selectedPresentation.rapporterAdvice.action.toLowerCase() === 'ajourné' ||
                      folderDetailViewModel.selectedPresentation.rapporterAdvice.action.toLowerCase() === 'non agréé'
                    "
                class="rapporter-advice-refused mr-5"
            >
              {{ folderDetailViewModel.selectedPresentation.rapporterAdvice.action }}
            </p>

            <p
                @click="editRapporterAdvice = true"
                style="cursor: pointer; margin-bottom: 0; color: #000091; border-bottom: 2px solid #000091"
                role="link"
                tabindex="0"
            >
              <v-icon color="primary" style="margin-bottom: 5px">{{ penIcon }}</v-icon> Modifier mon avis
            </p>
          </div>
        </div>
      </div>
      <div v-if="!folderDetailViewModel.selectedPresentation.decision" class="mr-6 mt-6 mb-6" style="display: flex; align-items: flex-start">
        <div class="mr-6" v-if="folderDetailViewModel.selectedPresentation.canActOnFolder">
          <div class="action-window">
            <div>
              <h3>
                <v-icon color="primary" style="margin-right: 5px">
                  {{commentIcon}}
                </v-icon>C'est à vous !
              </h3>
              <p class="light-grey mt-1 mb-6">
                Vous êtes connecté(e) en tant que {{authModule.currentUser.groups[0].name}}
              </p>
            </div>
            <v-divider style="width: 40%;"/>
            <div class="mt-5">
              <selector
                  v-if="folderDetailViewModel.selectedPresentation.isInformationRequired === false"
                  label="Que souhaitez-vous faire ?"
                  :items="folderDetailViewModel.selectedPresentation.availableActions"
                  placeholder="Sélectionner une option"
                  v-model="selectedAction"
              />
              <div v-if="folderDetailViewModel.selectedPresentation.isInformationRequired === true">
                <p style="color: #161616;">
                  Ajouter un fichier
                </p>
                <p class="information">
                  Taille maximale : 5 Mo. Formats supportés : jpg, png, pdf. Plusieurs fichiers possibles.
                </p>
                <div class="file-input align-center">
                  <v-btn @click="onInputFileClick('additional_documents')">
                    Importer
                  </v-btn>
                  <p>{{fileName ? fileName : 'Aucun fichier séléctionné'}}</p>
                  <input accept="application/pdf, image/jpeg, image/jpg, image/png" @change="onInputFileChange" type="file" ref="additional_documents" hidden>
                </div>
                <div class="mt-5">
                  <text-field
                      label="Commentaire (facultatif)"
                      :required="false"
                      :default-value="additionalComment"
                      v-model="additionalComment"
                      field-type="text-area"
                  />
                </div>

              </div>
              <div style="display: flex; align-items: center; justify-content: space-between;">
                <v-btn text class="submit-btn">
                  <v-img alt="" :src="Info" class="infoIco mr-1" /> <span>Besoin d'aide</span>
                </v-btn>
                <v-btn color="primary" @click="validate">
                  {{ folderDetailViewModel.selectedPresentation.finalAdvice ? "Finaliser" : "Étape suivante" }}
                </v-btn>
              </div>
            </div>
          </div>
        </div>
        <add-tags />
      </div>

      <p class="title-pres">Parcours du candidat</p>

      <div class="row ml-1 mt-5 mb-5">
        <div class="anchor">
          <v-img :src="Fishing" class="fishingIco" alt="" />
          <div>
            <p class="subtitle mb-1 ml-2">{{ folderDetailViewModel.selectedPresentation.demand.askedPosition }}</p>
          </div>
        </div>
      </div>

      <v-row>
        <v-col cols="4" class="br">
          <v-row no-gutters justify="space-between" align="start" class="mb-3">
            <v-col cols="12" class="br text-left">
              <div style="display: flex;">
                <p class="folderContainerTitle">{{ "Quartier :".toUpperCase() }}&nbsp;</p>
                <p v-if="folderDetailViewModel.selectedPresentation.training.quarter" class="folderContainerValue ml-2">{{ folderDetailViewModel.selectedPresentation.training.quarter }}</p>
              </div>
            </v-col>
            <v-col cols="12" class="br text-left">
              <div style="display: flex;">
                <p class="folderContainerTitle">{{ "Numéro de marin :".toUpperCase() }}&nbsp;</p>
                <p class="folderContainerValue">{{ folderDetailViewModel.selectedPresentation.training.marineLicenseNumber }}</p>
              </div>
            </v-col>
            <v-col cols="12" class="br text-left">
              <div style="display: flex;">
                <p class="folderContainerTitle">{{ "Total des services maritimes :".toUpperCase() }}&nbsp;</p>
                <p class="folderContainerValue">{{ folderDetailViewModel.selectedPresentation.demand.totalDuration }} années</p>
              </div>
            </v-col>
            <v-col cols="12" class="br text-left">
              <div style="display: flex;">
                <p class="folderContainerTitle">{{ "Prise de rang :".toUpperCase() }}&nbsp;</p>
                <p v-if="folderDetailViewModel.selectedPresentation.training.distinction.rankTakingDate" class="folderContainerValue">{{ dayjs(folderDetailViewModel.selectedPresentation.training.distinction.rankTakingDate).format('DD/MM/YYYY') }}</p>
              </div>
            </v-col>
          </v-row>
        </v-col>
        <v-col cols="4" class="br">
          <v-row no-gutters justify="space-between" align="start" class="mb-3">
            <v-col cols="12" class="br text-left">
              <div style="display: flex;">
                <p class="folderContainerTitle">{{ "Brevet :".toUpperCase() }}&nbsp;</p>
                <p class="folderContainerValue">{{ folderDetailViewModel.selectedPresentation.training.license }}</p>
              </div>
            </v-col>
            <v-col cols="12" class="br text-left">
              <div style="display: flex;">
                <p class="folderContainerTitle">{{ "Secteur :".toUpperCase() }}&nbsp;</p>
                <p v-if="folderDetailViewModel.selectedPresentation.demand.activityArea" class="folderContainerValue ml-2">{{ folderDetailViewModel.selectedPresentation.demand.activityArea }}</p>
              </div>
            </v-col>
            <v-col cols="12" class="br text-left">
              <div style="display: flex;">
                <p class="folderContainerTitle">{{ "Distinction reçue :".toUpperCase() }}&nbsp;</p>
                <p v-if="folderDetailViewModel.selectedPresentation.training.distinction.name" class="folderContainerValue">{{ folderDetailViewModel.selectedPresentation.training.distinction.name }}</p>
              </div>
            </v-col>
          </v-row>
        </v-col>
      </v-row>

      <p class="title-pres">Grade demandé</p>

      <div class="headerInfo mb-6">
        <p class="contingent">
          <v-img alt="" :src="Info" class="infoIco mr-1" />{{ "Contingent ".toUpperCase() + folderDetailViewModel.selectedPresentation.demand.contingentType }}
        </p>
      </div>

      <v-row>
        <v-col cols="4" class="br">
          <v-row no-gutters justify="space-between" align="start" class="mb-3">
            <v-col cols="12" class="br text-left">
              <div style="display: flex;" >
                <p class="folderContainerTitle">{{ "Grade :".toUpperCase() }}&nbsp;</p>
                <p v-if="folderDetailViewModel.selectedPresentation.demand.contingentInformation" class="folderContainerValue ml-2">{{ folderDetailViewModel.selectedPresentation.demand.contingentInformation.grade }}</p>
              </div>
            </v-col>
            <v-col cols="12" class="br text-left">
              <div style="display: flex;">
                <p class="folderContainerTitle">{{ "Durée de navigation à titre civil :".toUpperCase() }}&nbsp;</p>
                <p v-if="folderDetailViewModel.selectedPresentation.demand.contingentInformation && folderDetailViewModel.selectedPresentation.demand.contingentInformation.duration" class="folderContainerValue ml-2">{{ folderDetailViewModel.selectedPresentation.demand.contingentInformation.duration.civilNavigationDurationInMonths }} mois</p>
              </div>
            </v-col>
            <v-col cols="12" class="br text-left">
              <div style="display: flex;">
                <p class="folderContainerTitle">{{ "Durée autre activité :".toUpperCase() }}&nbsp;</p>
                <p v-if="folderDetailViewModel.selectedPresentation.demand.contingentInformation && folderDetailViewModel.selectedPresentation.demand.contingentInformation.duration" class="folderContainerValue ml-2">{{ folderDetailViewModel.selectedPresentation.demand.contingentInformation.duration.otherActivityDuration }} mois</p>
              </div>
            </v-col>
            <v-col cols="12" class="br text-left">
              <div style="display: flex;">
                <p class="folderContainerTitle">{{ "Secteur d'activité :".toUpperCase() }}&nbsp;</p>
                <p class="folderContainerValue ml-2">{{ folderDetailViewModel.selectedPresentation.demand.activityArea }}</p>
              </div>
            </v-col>
          </v-row>
        </v-col>


        <v-col cols="6" class="br">
          <v-row no-gutters justify="space-between" align="start" class="mb-3">
            <v-col cols="12" class="br text-left">
              <div style="display: flex;">
                <p class="folderContainerTitle">{{ "Motif de la décoration :".toUpperCase() }}&nbsp;</p>
                <p v-if="folderDetailViewModel.selectedPresentation.demand.contingentInformation" class="folderContainerValue ml-2">{{ toReasonGradeProposalValue(folderDetailViewModel.selectedPresentation.demand.contingentInformation.grade, folderDetailViewModel.selectedPresentation.demand.contingentInformation.reasonGradeProposal) }}</p>
              </div>
            </v-col>

            <v-col cols="12" class="br text-left">
              <div style="display: flex;">
                <p class="folderContainerTitle">{{ "Durée de navigation à titre militaire :".toUpperCase() }}&nbsp;</p>
                <p v-if="folderDetailViewModel.selectedPresentation.demand.contingentInformation && folderDetailViewModel.selectedPresentation.demand.contingentInformation.duration" class="folderContainerValue ml-2">{{ folderDetailViewModel.selectedPresentation.demand.contingentInformation.duration.militaryNavigationDurationInMonth }} mois</p>
              </div>
            </v-col>

            <v-col cols="12" class="br text-left">
              <div style="display: flex;">
                <p class="folderContainerTitle">{{ "Fonction au titre de laquelle la décoration est demandée :".toUpperCase() }}&nbsp;</p>
                <p class="folderContainerValue ml-2">{{ folderDetailViewModel.selectedPresentation.demand.askedPosition }}</p>
              </div>
            </v-col>
          </v-row>
        </v-col>
      </v-row>


      <div class="mb-5">
        <p class="title-pres">Mémoire</p>
        <p>
          {{folderDetailViewModel.selectedPresentation.demand.reasonProposal}}
        </p>
      </div>

      <p class="title-pres">Documents déposés</p>
      <div style="display: flex; align-items: center;" v-if="!folderDetailViewModel.selectedPresentation.documents.length">
        <img
            :src="DocumentEmpty"
        />
        <p class="ml-5 mb-0">Aucun document déposé</p>
      </div>
      <div
          class="attachments mb-5"
          v-for="file in folderDetailViewModel.selectedPresentation.documents"
          v-bind:key="file.id"
      >

        <div v-if="file.type === 'criminal_record'" style="display: flex;" class="mb-4">
          <p class="mr-4 mb-0 folderContainerTitle">{{"Casier judiciaire :".toUpperCase()}}</p>
          <p class="mb-0">
            <a class="link" :href="file.rawLink" target="_blank">
              {{file.rawName}}
            </a>
          </p>
        </div>

        <div v-if="file.type === 'resume'" style="display: flex;" class="mb-4">
          <p class="mr-4 mb-0 folderContainerTitle">CV :</p>
          <p class="mb-0">
            <a class="link" :href="file.rawLink" target="_blank">
              {{file.rawName}}
            </a>
          </p>
        </div>
        <div v-if="file.type === 'prefect_opinion'" style="display: flex;" class="mb-4">
          <p class="mr-4 mb-0 folderContainerTitle">{{"Avis préfet :".toUpperCase()}}</p>
          <p  class="mb-0">
            <a class="link" :href="file.rawLink" target="_blank">
              {{file.rawName}}
            </a>
          </p>

        </div>
        <div  v-if="file.type === 'other'">
          <p>Autres documents :</p>
          <p
              v-for="other in folderDetailViewModel.selectedPresentation.documents.filter(item => item.type === 'other')"
              v-bind:key="other.id"
          >
            <a class="link" :href="other.rawLink" target="_blank">
              {{other.name}}
            </a>
          </p>
        </div>
      </div>
      <div class="mb-5">
        <p class="title-pres">
          Commentaires et notes
        </p>
        <folder-comments/>
      </div>
      <alert
          :open="editRapporterAdvice"
          :on-close="onEditRapporterAdviceClose"
          :with-confirmation="true"
          :on-confirm="onEditRapporterAdvice"
      >
        <template v-slot:title>
          <h1 class="mb-10">Modifier mon avis</h1>
        </template>
        <template v-slot:message>
          <selector
              v-if="folderDetailViewModel.selectedPresentation.rapporterAdvice"
              label="Votre nouvelle avis"
              :mandatory="true"
              :items="actions"
              placeholder="Sélectionner une option"
              v-model="selectedAction"
          />
        </template>
      </alert>

  <alert
    :open="rankTakingDatePopupOpen"
    :on-close="onCloseRankTakingDatePopupOpen"
    :with-confirmation="true"
    :on-confirm="onConfirmRankTakingDatePopupOpen"
  >
    <template v-slot:title>
      <h1 class="mb-10">Date de prise de rang</h1>
    </template>
    <template v-slot:message>
      <text-field
        label="Date de naissance (jj/mm/aaaa)"
        type="date"
        :mandatory="true"
        :required="true"
        :default-value="rankTakingDate"
        v-model="rankTakingDate"
        autoCompleteAttribute="bday"
      />
    </template>
  </alert>
      <attribution-dialog
          :title="`${selectedAction} pour le dossier ${buildName()} (${birthDateAndPlace()})`"
          :open="validating"
          :on-confirm="onConfirm"
          :onClose="() => validating = false"
      />
      <alert
          :open="actionPopup"
          :on-close="onCloseActionPopup"
          :on-confirm="onConfirmAction"
          :with-confirmation="true"
      >
        <template v-slot:title>
          <h2 class="pb-3">
            <v-icon large style="margin-bottom: 5px; color: #161616">
              {{ Info }}
            </v-icon>
            <span>{{onActionClick()}}</span>
          </h2>
        </template>
        <template v-slot:message>
          <text-field
              label="Commentaire (facultatif)"
              :required="false"
              :default-value="finalComment"
              v-model="finalComment"
              field-type="text-area"
          />
        </template>
      </alert>
</div>
</template>

<script lang="ts">
import Component from "vue-class-component";
import Vue from "vue";
import {lazyInject} from "@pasta/box";
import {FolderDetailViewModel} from "@/modules/folders/viewModels/FolderDetailViewModel";
import Info from "../../../assets/info.svg";
import Fishing from "../../../assets/fishing.svg";
import FolderComments from "./FolderComments.vue";
import {OnBoardingStepIndex, OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {mdiAttachment, mdiCommentAlert, mdiPen} from "@mdi/js";
import {NoteAction} from "@/core/types/applicants/NoteAction";
import {AuthModule} from "@pasta/front-auth";
import {HonoreIdentifier} from "@/core/HonoreIdentifier";
import {FileExporter} from "@/core/gateways/FileExporter";
import {FolderViewModel} from "@/modules/folders/viewModels/FolderViewModel";
import Selector from "@/components/Selector.vue";
import Alert from "@/components/Alert.vue";
import TextField from "@/components/TextField.vue";
import DocumentEmpty from "../../../assets/document-empty.png";
import AttributionDialog from "@/modules/folders/components/AttributionDialog.vue";
import {SessionViewModel} from "@/modules/sessions/viewModels/SessionViewModel";
import {HomeViewModel} from "@/modules/home/viewModels/HomeViewModel";
import {Civility} from "@/modules/onBoarding/types/Civility";
import dayjs from "dayjs";
import AddTags from "@/modules/folders/components/AddTags.vue";
import {Grade} from "@/core/types/training/Grade";
import {ReasonGradeProposal} from "@/core/types/training/ReasonGradeProposal";
import {knightReasonProposal} from "@/modules/onBoarding/resources/knightReasonProposal";
import {officerReasonProposal} from "@/modules/onBoarding/resources/officerReasonProposal";
import {commanderReasonProposal} from "@/modules/onBoarding/resources/commanderReasonProposal";
import {OnBoardingPath} from "@/modules/onBoarding/navigation/OnBoardingPath";


@Component({
  methods: {dayjs},
  components: {
    AddTags,
    AttributionDialog,
    TextField,
    Alert, Selector,
    FolderComments,
  }
})
export default class MMPresentation extends Vue {
  @lazyInject(FolderDetailViewModel)
  declare folderDetailViewModel: FolderDetailViewModel;

  @lazyInject(OnBoardingViewModel)
  declare onboardingViewModel: OnBoardingViewModel;

  @lazyInject(FolderViewModel)
  declare folderViewModel: FolderViewModel;

  @lazyInject(AuthModule)
  declare authModule: AuthModule;

  @lazyInject(HonoreIdentifier.fileExporter)
  declare fileExporter: FileExporter;

  @lazyInject(SessionViewModel)
  declare sessionViewModel: SessionViewModel;

  @lazyInject(HomeViewModel)
  declare homeViewModel: HomeViewModel;

  saveOK = false;

  Info = Info
  Fishing = Fishing;
  DocumentEmpty = DocumentEmpty;
  penIcon = mdiPen;
  attachment = mdiAttachment;

  rankTakingDate = "";

  actions = [
    "Admissible", //done
    "En discussion", //done
    "Ajourné", //done
    "Non agréé", //done
    "Demande de complément",
  ]

  editRapporterAdvice = false;

  selectedAction = "";

  commentIcon = mdiCommentAlert;

  rankTakingDatePopupOpen = false;

  fileName = "";
  additionalComment = "";
  actionPopup = false;
  finalComment = "";
  validating = false;
  onInputFileClick(ref: string) {
    const fileInputElement = this.$refs[ref];
    if (fileInputElement) {
      // eslint-disable-next-line @typescript-eslint/ban-ts-comment
      // @ts-ignore
      fileInputElement.click();
      return;
    }
  }

  async onInputFileChange(e: any) {
    const file = e.target.files[0];
    await this.folderViewModel.addDocument(file);
    this.fileName = file.name;
    return file;
  }

  openRankTakingDatePopup() {
    this.rankTakingDatePopupOpen = true;
  }

  onCloseRankTakingDatePopupOpen() {
    this.rankTakingDatePopupOpen = false
  }
  async onConfirmRankTakingDatePopupOpen() {
    await this.folderDetailViewModel.addRankTakingDate(this.rankTakingDate);
    this.rankTakingDatePopupOpen = false;
  }

  toReasonGradeProposalValue(grade?: Grade, reasonGradeProposal?: ReasonGradeProposal) {
    if (grade === Grade.KNIGHT) {
      if (reasonGradeProposal === ReasonGradeProposal.DURATION) {
        return knightReasonProposal.duration;
      }
      if (reasonGradeProposal === ReasonGradeProposal.EXCEPTIONAL_FACT) {
        return knightReasonProposal.exceptional_fact;
      }
    }
    if (grade === Grade.OFFICER) {
      if (reasonGradeProposal === ReasonGradeProposal.DURATION) {
        return officerReasonProposal.duration;
      }
      if (reasonGradeProposal === ReasonGradeProposal.EXCEPTIONAL_FACT) {
        return officerReasonProposal.exceptional_fact;
      }
      if (reasonGradeProposal === ReasonGradeProposal.EQUIVALENT_GRADE) {
        return officerReasonProposal.equivalent_grade;
      }
    }
    if (grade === Grade.COMMANDER) {
      if (reasonGradeProposal === ReasonGradeProposal.DURATION) {
        return commanderReasonProposal.duration;
      }
      if (reasonGradeProposal === ReasonGradeProposal.EXCEPTIONAL_FACT) {
        return commanderReasonProposal.exceptional_fact;
      }
      if (reasonGradeProposal === ReasonGradeProposal.EQUIVALENT_GRADE) {
        return commanderReasonProposal.equivalent_grade;
      }
    }
    return "";
  }

  async onCompletionChange(value: boolean) {
    await this.folderDetailViewModel.completePresentation(value);
  }
  async saveComment() {
    await this.folderDetailViewModel.commentPresentation(
        this.folderDetailViewModel.selectedPresentation.comment ?? "",
    )
    this.saveOK = true;
    setTimeout(() => {
      this.saveOK = false;
    }, 2000)
  }
  async onConfirm(entityId: string, comment?: string) {
    // here confirm and go back to suivi folder.
    const isInformationRequired = this.folderDetailViewModel.selectedPresentation?.isInformationRequired;
    await this.folderViewModel.addNote({
      entityId: entityId,
      action: isInformationRequired ? NoteAction.SUBMITTED : this.selectedAction,
      comment: comment,
      additionalComment: this.additionalComment,
      folderId: this.folderDetailViewModel.selectedPresentation?.id as any,
      applicantId: this.folderDetailViewModel.folder.id,
    })
    window.location.href = "/mes-dossiers";
  }
  onActionClick() {
    const item = this.selectedAction;
    if (item.toLowerCase() === "décorés") {
      return "Êtes-vous sûr de vouloir décorer ce(s) dossier(s) ?"
    }
    if (item.toLowerCase() === "non agrée") {
      return "Êtes-vous sûr de ne pas vouloir agréer ce(s) dossier(s) ?"
    }
    if (item.toLowerCase() === "ajourner") {
      return "Êtes-vous sûr de vouloir ajourner ce(s) dossier(s) ?";
    }
  }
  onCloseActionPopup() {
    this.actionPopup = false;
  }

  async onConfirmAction() {
    await this.sessionViewModel.addFinalNote({
      action: this.selectedAction,
      presentationIds: [this.folderDetailViewModel.selectedPresentation?.id as any],
      comment: this.finalComment,
    });
    await this.$router.push(`/promotions/${this.homeViewModel.currentSession.name}`);
  }
  async validate() {
    if (this.selectedAction == "" && !this.folderDetailViewModel.selectedPresentation.isInformationRequired) {
      return;
    }
    if (this.folderDetailViewModel.selectedPresentation?.finalAdvice) {
      this.actionPopup = true;
      return;
    }
    this.validating = true;
  }

  onEditRapporterAdviceClose() {
    this.editRapporterAdvice = false;
  }

  async onEditRapporterAdvice() {
    if (this.selectedAction !== '') {
      await this.folderViewModel.updateNote({
        action: this.selectedAction,
        noteId: this.folderDetailViewModel.selectedPresentation.rapporterAdvice?.id as any,
        presentationId: this.folderDetailViewModel.selectedPresentation?.id as any,
      });
      this.editRapporterAdvice = false;
    }
  }

  async saveAsWord(id: string) {
    await this.fileExporter.saveWordFromDetailFolder(this.folderDetailViewModel.folder, id)
  }

  async edit(presentationId: string) {
    this.onboardingViewModel.clearAll();
    const applicant = await this.folderDetailViewModel.getPresentation({
      presentationId,
      applicantId: this.folderDetailViewModel.folder.id,
    })
    await this.onboardingViewModel.enrich(applicant);
    const decorationType = await this.folderDetailViewModel.fromDecorationType(this.folderDetailViewModel.selectedPresentation.decorationType);
    this.onboardingViewModel.selectDecoration(decorationType);
    this.onboardingViewModel.updateEditMode(true);
    return this.$router.push(OnBoardingPath.TRAINING_INFORMATION);
  }

  buildName() {
    const state = this.folderDetailViewModel.folder.personalInformation;
    return `
      ${state.civility === Civility.MRS ? 'Mme' : 'M.'} ${state.legalName ? state.legalName.toUpperCase() : state.birthName.toUpperCase()} ${state.firstName.toUpperCase()}
    `
  }

  birthDateAndPlace() {
    const state = this.folderDetailViewModel.folder.personalInformation;
    return `
      Né${state.civility === Civility.MRS ? 'e' : ''} le ${dayjs(state.birthDate).format('DD/MM/YYYY')} ${state.birthCity ? `à ${state.birthCity}` : ""}
    `
  }
}
</script>

<style lang="scss">
.presentation {
  text-align: left;
  display: flex;
  .title-pres {
    font-size: 32px!important;
  }
  .detail {
    width: 100%;
  }
  .subtitle {
    font-size: 24px!important;
    font-weight: 500;
  }
  .v-tab {
    flex-direction: column;
    justify-content: flex-start!important;
    align-items: flex-start;
    text-transform: initial;
    .decoration_enum {
      font-weight: bold;
      font-size: 16px;
    }
  }
  .anchor {
    display: flex;
    align-items: center;

  }
  .headerInfo {
    width: 170px;
    .contingent {
      display: flex;
      background-color: #e8edff;
      align-items: center;
      color: #0063cb;
      font-weight: bold;
      font-size: 14px;
      line-height: 24px;
      padding-left: 10px;
      padding-right: 10px;
      border-radius: 5px;
    }
  }
  .action-window {
    text-align: left;
    width: 400px;
    background-color: white;
    border-radius: 10px;
    padding: 24px;
    box-shadow: 0px 6px 18px #00001229;
    .reduce-icon {
      position: absolute;
      right: 15px;
      top: 10px;
      font-size: 22px;
      cursor: pointer;
    }

    h3 {
      font-weight: 500;
      color: #000000;
    }
    .light-grey {
      color: #666666;
    }
    .submit-btn {
      color: #0063CB;
      padding: 0;
      font-size: 14px;
      span {
        letter-spacing: 0;
      }
    }
  }
  .folderContainerTitle {
    font-weight: 500;
    font-size: 14px;
    line-height: 24px;
    font-style: normal;
    color: #161616;
  }
  .v-list-item {
    text-transform: initial!important;
  }
  .v-select__selection--comma {
    text-transform: initial!important;
  }
  .folder {
    position: relative;
    .attachment {
      padding: 1rem 7rem;
    }
    .folder-contents-container {
      padding: 0rem 7rem;
    }
    .resize-icon {
      position: absolute;
      top: 8rem;
      text-align: left;
      right: 5rem;
      background-color: white;
      border-radius: 10px;
      padding: 10px;
      box-shadow: 0px 6px 18px #00001229;
    }
    .header {
      padding-left: 7rem;
      padding-top: 2rem;
      display: flex;
      width: 100%;
      justify-content: space-between;
    }
    .resume {
      padding: 1rem 7rem;
    }
    .memory {
      padding: 1rem 7rem;
    }
    .information {
      color: #666666;
      font-weight: 400;
      font-size: 14px;
      margin-top: 5px!important;
    }

    .align-center {
      display: flex;
      align-items: center;
    }

    .file-input {
      margin-top: 14px;
      p {
        margin-left: 10px;
        margin-top: 0;
        font-size: 14px;
        font-weight: 400;
        margin-bottom: 0;
      }
      button {
        background-color: #EEEEEE!important;
        padding-left: 5px!important;
        padding-right: 5px!important;
        box-shadow: none;
        border-radius: 4px!important;
        span {
          font-size: 14px!important;
          letter-spacing: 0;
          font-weight: 400;
        }
      }
      .file-list {
        margin-bottom: 14px;
        div:nth-of-type(1) {
          flex: 0 0 auto!important;
        }
        p {
          margin-right: 10px;
          margin-left: 5px;
          margin-bottom: 3px;
        }
      }
      .remove-btn {
        background-color: transparent!important;
        padding-left: 0!important;
        padding-right: 0!important;
        svg {
          width: 18px;
          height: 18px;
        }
      }
      .border-red {
        border: 1px solid red
      }

      button {
        letter-spacing: 0px!important;
      }
    }
  }
  .rapporter-advice-ok {
    text-transform: uppercase !important;
    margin-bottom: 5px;
    background-color: #b8fec9;
    display: inherit;
    padding: 3px 10px;
    border-radius: 5px;
    color: #18753c;
    font-weight: 700;
  }
  .rapporter-advice-discussion {
    text-transform: uppercase !important;
    margin-bottom: 5px;
    background-color: #feecc2;
    display: inherit;
    padding: 3px 10px;
    border-radius: 5px;
    color: #716043;
    font-weight: 700;
  }
  .rapporter-advice-refused {
    text-transform: uppercase !important;
    margin-bottom: 5px;
    background-color: #ffe8e5;
    display: inherit;
    padding: 3px 10px;
    border-radius: 5px;
    color: #b34000;
    font-weight: 700;
  }
}
</style>

````

</details>


---

### 📄 `src/modules/folders/components/MoveDialog.vue` [2.234 octets]
<a id="src-modules-folders-components-MoveDialog-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-folders-components-MoveDialog-vue)

> **Chemin relatif** : `src/modules/folders/components/MoveDialog.vue`  
> **Taille** : 2.234 octets  
> **Lignes** : 96  
> **Type** : text

```text
<template>
  <alert
    :open="open"
    :on-close="onClose"
    :with-confirmation="true"
    :on-confirm="onValidate"
  >
    <template v-slot:title>
      <div style="display: flex; align-items: flex-start;">
        <v-icon x-large style="color: #161616;vertical-align: middle;">
          {{ right }}
        </v-icon>
        <h2 class="pb-5" style="font-size: 20px;line-height: 1.5">
          {{title}}
        </h2>
      </div>

    </template>
    <template v-slot:message>
      <selector
        label="Rattaché à"
        :items="onBoardingViewModel.entities.map(elem => elem.name)"
        placeholder="Sélectionner une option"
        v-model="entity"
        :error-messages="entityErrors"
      />
    </template>
  </alert>
</template>

<script lang="ts">
import Component from "vue-class-component";
import Vue from "vue";
import Alert from "@/components/Alert.vue";
import Selector from "@/components/Selector.vue";
import TextField from "@/components/TextField.vue";
import {mdiArrowRight} from "@mdi/js";
import {lazyInject, Validation} from "@pasta/box";
import {OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {required} from "vuelidate/lib/validators";
import {Prop} from "vue-property-decorator";


@Component({
  components: {
    Alert,
    Selector,
    TextField
  }
})
export default class MoveDialog extends Vue {
  right = mdiArrowRight;

  @lazyInject(OnBoardingViewModel)
  declare onBoardingViewModel: OnBoardingViewModel;

  @Prop({required: true})
  declare title: string;

  @Prop({required: true, default: false})
  declare open: boolean;


  @Prop({required: true})
  declare onClose: Function;

  @Prop({required: true})
  declare onConfirm: (entityId: string) => Promise<void>;

  @Validation({
    required: {
      errorMessage: "Veuillez sélectionner une entité",
      validator: required,
    }
  })
  entity = "";


  async onValidate() {
    this.$v.$touch();
    const isError = this.$v.$invalid;
    if (!isError) {
      const entity = await this.onBoardingViewModel.selectEntityByName(this.entity);
      if (entity) {
        return this.onConfirm(entity.id);
      }

    }
    return;
  }

}
</script>

<style lang="scss"></style>

```


---

### 📄 `src/modules/folders/components/PresentationList.vue` [3.125 octets]
<a id="src-modules-folders-components-PresentationList-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-folders-components-PresentationList-vue)

> **Chemin relatif** : `src/modules/folders/components/PresentationList.vue`  
> **Taille** : 3.125 octets  
> **Lignes** : 113  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (113 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <div class="presentation-table">
    <v-col cols="12" class="br text-left">
      <p class="folderContainerTitle">{{"dernières présentations :".toUpperCase()}}</p>
      <v-data-table
          :headers="headers"
          :items="toPresentation()"
          style="background: #F6F6F6;"
          :disable-pagination="true"
          :disable-filtering="true"
          :footer-props="{
                        disableItemsPerPage: true,
                        disablePagination: true,
                    }"
          calculate-widths
          class="elevation-0 mt-8"
          locale="fr-FR"
          item-key="id"
      >
      </v-data-table>
    </v-col>
  </div>
</template>

<script lang="ts">
import Component from "vue-class-component";
import Vue from "vue";
import {lazyInject} from "@pasta/box";
import {FolderDetailViewModel} from "@/modules/folders/viewModels/FolderDetailViewModel";
import dayjs from "dayjs";
import {DecorationType} from "@/modules/onBoarding/types/DecorationType";

@Component
export default class PresentationsList extends Vue {
  @lazyInject(FolderDetailViewModel)
  declare folderDetailViewModel: FolderDetailViewModel;


  headers = [
    {
      text: "Décoration",
      align: "start",
      value: "decorationType",
      groupable: false,
      width: '15%'
    },
    {
      text: "Titre",
      align: "start",
      value: "grade",
      groupable: false,
      width: '15%'
    },
    { text: "Contingent", value: "contingentType", groupable: false, width: '15%' },
    { text: "Promotion", value: "sessionName", groupable: false, width: '15%' },
    { text: "Avis", value: "decision", groupable: false, sortable: false, width: '15%' },
    { text: "Date de Décret", value: "decreeDate", sortable: false, width: '15%' },
  ]

  toPresentation() {
    return this.folderDetailViewModel.folder.presentations.map(elem => {
      let grade = ""
      if (elem.decorationType === DecorationType.MERITE_MARITIME) {
        grade = elem.demand?.contingentInformation?.grade ?? ""
      } else {
        grade = elem?.annuity?.grade ?? ""
      }
      return {
        decorationType: elem.decorationType,
        grade,
        contingentType: elem.demand?.contingentType ?? "",
        sessionName: elem.session?.name ?? "",
        decision: elem?.session?.decreeDate ? elem?.decision?.action : "",
        decreeDate: elem?.session?.decreeDate ? dayjs(elem?.session?.decreeDate).format('DD/MM/YYYY') : ""
      }
    })
  }


}
</script>

<style lang="scss">
.presentation-table {
  text-align: left;
  .theme--light.v-data-table > .v-data-table__wrapper > table > thead > tr:last-child > th {
    border-bottom: 2px solid black!important;
  }
  .v-data-table {
    background: white!important;
  }
  .v-data-footer {
    display: none;
  }
  .v-data-table-header {
    span {
      color: #161616;
      font-style: normal;
      font-weight: 700;
      font-size: 14px;
      line-height: 24px;
    }
  }
  .folderContainerTitle {
    font-weight: 500;
    font-size: 14px;
    line-height: 24px;
    font-style: normal;
    color: #161616;
  }
}
</style>

```

</details>


---

### 📄 `src/modules/folders/components/PresentationsScreen.vue` [8.458 octets]
<a id="src-modules-folders-components-PresentationsScreen-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-folders-components-PresentationsScreen-vue)

> **Chemin relatif** : `src/modules/folders/components/PresentationsScreen.vue`  
> **Taille** : 8.458 octets  
> **Lignes** : 321  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (321 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <v-row class="presentation">
    <v-col cols="3">
      <v-tabs vertical>
        <v-tab @click="selectPresentation(presentation.id)" class="mb-10" v-for="presentation of folderDetailViewModel.folder.presentations" :key="presentation.id">
          <p class="mb-1 decoration_enum">
            {{presentation.decorationType}}
          </p>
          <p class="mt-0">
            Promotion {{presentation.session.name}}
          </p>
        </v-tab>
      </v-tabs>
    </v-col>
    <v-col cols="9" v-if="folderDetailViewModel.selectedPresentation" class="detail" >
      <m-m-presentation
        v-if="mapDecorationType(folderDetailViewModel.selectedPresentation.decorationType) === 'merite_maritime'"
      />
      <l-h-o-n-m-presentation
          v-if="mapDecorationType(folderDetailViewModel.selectedPresentation.decorationType) !== 'merite_maritime'"
      />
    </v-col>
  </v-row>
</template>

<script lang="ts">
import Component from "vue-class-component";
import Vue from "vue";
import {lazyInject} from "@pasta/box";
import {FolderDetailViewModel} from "@/modules/folders/viewModels/FolderDetailViewModel";
import FolderComments from "./FolderComments.vue";
import {OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {AuthModule} from "@pasta/front-auth";
import {HonoreIdentifier} from "@/core/HonoreIdentifier";
import {FileExporter} from "@/core/gateways/FileExporter";
import {FolderViewModel} from "@/modules/folders/viewModels/FolderViewModel";
import Selector from "@/components/Selector.vue";
import Alert from "@/components/Alert.vue";
import TextField from "@/components/TextField.vue";
import AttributionDialog from "@/modules/folders/components/AttributionDialog.vue";
import {SessionViewModel} from "@/modules/sessions/viewModels/SessionViewModel";
import {HomeViewModel} from "@/modules/home/viewModels/HomeViewModel";
import dayjs from "dayjs";
import AddTags from "@/modules/folders/components/AddTags.vue";
import MMPresentation from "@/modules/folders/components/MMPresentation.vue";
import LHONMPresentation from "@/modules/folders/components/LHONMPresentation.vue";
import {DecorationType} from "@/modules/onBoarding/types/DecorationType";


@Component({
  methods: {dayjs},
  components: {
    LHONMPresentation,
    MMPresentation,
    AddTags,
    AttributionDialog,
    TextField,
    Alert, Selector,
    FolderComments,
  }
})
export default class PresentationsScreen extends Vue {
  @lazyInject(FolderDetailViewModel)
  declare folderDetailViewModel: FolderDetailViewModel;

  @lazyInject(OnBoardingViewModel)
  declare onboardingViewModel: OnBoardingViewModel;

  @lazyInject(FolderViewModel)
  declare folderViewModel: FolderViewModel;

  @lazyInject(AuthModule)
  declare authModule: AuthModule;

  @lazyInject(HonoreIdentifier.fileExporter)
  declare fileExporter: FileExporter;

  @lazyInject(SessionViewModel)
  declare sessionViewModel: SessionViewModel;

  @lazyInject(HomeViewModel)
  declare homeViewModel: HomeViewModel;


  mapDecorationType(decorationType: string): DecorationType {
    switch (decorationType) {
      case "Mérite maritime":
        return DecorationType.MERITE_MARITIME;
      case "Ordre national du mérite":
        return DecorationType.ORDRE_NATIONAL_DU_MERITE;
      case "Légion d'honneur":
        return DecorationType.LEGION_HONNEUR;
      default:
        return DecorationType.MERITE_MARITIME
    }
  }

  async selectPresentation(id: string) {
    const selectedPresentation = this.folderDetailViewModel.folder.presentations.find(elem => elem.id === id);
    if (selectedPresentation) {
      this.folderDetailViewModel.selectPresentation(selectedPresentation);
    }
  }

}
</script>

<style lang="scss">
  .presentation {
    text-align: left;
    display: flex;
    .title-pres {
      font-size: 32px!important;
    }
    .detail {
      width: 100%;
    }
    .subtitle {
      font-size: 24px!important;
      font-weight: 500;
    }
    .v-tab {
      flex-direction: column;
      justify-content: flex-start!important;
      align-items: flex-start;
      text-transform: initial;
      .decoration_enum {
        font-weight: bold;
        font-size: 16px;
      }
    }
    .anchor {
      display: flex;
      align-items: center;

    }
    .headerInfo {
      width: 170px;
      .contingent {
        display: flex;
        background-color: #e8edff;
        align-items: center;
        color: #0063cb;
        font-weight: bold;
        font-size: 14px;
        line-height: 24px;
        padding-left: 10px;
        padding-right: 10px;
        border-radius: 5px;
      }
    }
    .action-window {
      text-align: left;
      width: 400px;
      background-color: white;
      border-radius: 10px;
      padding: 24px;
      box-shadow: 0px 6px 18px #00001229;
      .reduce-icon {
        position: absolute;
        right: 15px;
        top: 10px;
        font-size: 22px;
        cursor: pointer;
      }

      h3 {
        font-weight: 500;
        color: #000000;
      }
      .light-grey {
        color: #666666;
      }
      .submit-btn {
        color: #0063CB;
        padding: 0;
        font-size: 14px;
        span {
          letter-spacing: 0;
        }
      }
    }
    .folderContainerTitle {
      font-weight: 500;
      font-size: 14px;
      line-height: 24px;
      font-style: normal;
      color: #161616;
    }
    .v-list-item {
      text-transform: initial!important;
    }
    .v-select__selection--comma {
      text-transform: initial!important;
    }
    .folder {
      position: relative;
      .attachment {
        padding: 1rem 7rem;
      }
      .folder-contents-container {
        padding: 0rem 7rem;
      }
      .resize-icon {
        position: absolute;
        top: 8rem;
        text-align: left;
        right: 5rem;
        background-color: white;
        border-radius: 10px;
        padding: 10px;
        box-shadow: 0px 6px 18px #00001229;
      }
      .header {
        padding-left: 7rem;
        padding-top: 2rem;
        display: flex;
        width: 100%;
        justify-content: space-between;
      }
      .resume {
        padding: 1rem 7rem;
      }
      .memory {
        padding: 1rem 7rem;
      }
      .information {
        color: #666666;
        font-weight: 400;
        font-size: 14px;
        margin-top: 5px!important;
      }

      .align-center {
        display: flex;
        align-items: center;
      }

      .file-input {
        margin-top: 14px;
        p {
          margin-left: 10px;
          margin-top: 0;
          font-size: 14px;
          font-weight: 400;
          margin-bottom: 0;
        }
        button {
          background-color: #EEEEEE!important;
          padding-left: 5px!important;
          padding-right: 5px!important;
          box-shadow: none;
          border-radius: 4px!important;
          span {
            font-size: 14px!important;
            letter-spacing: 0;
            font-weight: 400;
          }
        }
        .file-list {
          margin-bottom: 14px;
          div:nth-of-type(1) {
            flex: 0 0 auto!important;
          }
          p {
            margin-right: 10px;
            margin-left: 5px;
            margin-bottom: 3px;
          }
        }
        .remove-btn {
          background-color: transparent!important;
          padding-left: 0!important;
          padding-right: 0!important;
          svg {
            width: 18px;
            height: 18px;
          }
        }
        .border-red {
          border: 1px solid red
        }

        button {
          letter-spacing: 0px!important;
        }
      }
    }
    .rapporter-advice-ok {
      text-transform: uppercase !important;
      margin-bottom: 5px;
      background-color: #b8fec9;
      display: inherit;
      padding: 3px 10px;
      border-radius: 5px;
      color: #18753c;
      font-weight: 700;
    }
    .rapporter-advice-discussion {
      text-transform: uppercase !important;
      margin-bottom: 5px;
      background-color: #feecc2;
      display: inherit;
      padding: 3px 10px;
      border-radius: 5px;
      color: #716043;
      font-weight: 700;
    }
    .rapporter-advice-refused {
      text-transform: uppercase !important;
      margin-bottom: 5px;
      background-color: #ffe8e5;
      display: inherit;
      padding: 3px 10px;
      border-radius: 5px;
      color: #b34000;
      font-weight: 700;
    }
  }
</style>

```

</details>


---

### 📄 `src/modules/folders/layout/FilesFollowUpLayout.vue` [289 octets]
<a id="src-modules-folders-layout-FilesFollowUpLayout-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-folders-layout-FilesFollowUpLayout-vue)

> **Chemin relatif** : `src/modules/folders/layout/FilesFollowUpLayout.vue`  
> **Taille** : 289 octets  
> **Lignes** : 17  
> **Type** : text

```text
<template>
  <router-view>
  </router-view>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";

@Component
export default class FilesFollowUpLayout extends Vue {}
</script>

<style lang="scss">
@import "../../../styles/variables";
</style>

```


---

### 📄 `src/modules/folders/screens/ApplicantsList.vue` [42.445 octets]
<a id="src-modules-folders-screens-ApplicantsList-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-folders-screens-ApplicantsList-vue)

> **Chemin relatif** : `src/modules/folders/screens/ApplicantsList.vue`  
> **Taille** : 42.445 octets  
> **Lignes** : 1272  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (1272 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <div class="main_folder">
    <div>
      <div v-if="isRapporter()">
        <div class="title mt-8">
          <img alt="" :src="dataVisualisation" />
          <h1 id="waiting_action">Synthèse de mes avis</h1>
        </div>

        <div class="quota">
          <v-row class="mt-5 mb-5">
            <v-col lg="3"
                   v-for="(item,i) in folderViewModel.quotas"
                   :key="i"
            >
              <div>
                <p class="bold">{{ item.title }}</p>
              </div>
              <div>
                <div
                  v-for="(grade,idx) in item.quotas"
                  :key="idx"
                  class="mt-5"
                >
                  <p>{{ grade.for }} :</p>
                  <div class="result">
                    <v-progress-linear :value="isNaN(Math.round(grade.received / grade.total)) || grade.received === 0 ? 0 : Math.round((grade.received / grade.total) * 100)"></v-progress-linear>
                    <p class="ml-5 mb-0">{{ grade.received }} / {{ grade.total }}</p>
                  </div>
                </div>
              </div>
            </v-col>
          </v-row>
        </div>
      </div>

      <v-row class="mt-3">
        <v-col lg="4">
          <text-field
            label="Recherche"
            :required="false"
            :default-value="search"
            v-model="search"
            field-type="text"
          />
        </v-col>
      </v-row>


      <div class="title">
        <img alt="" :src="notification" />
        <h1 id="waiting_action">Ces dossiers nécessitent votre attention</h1>
      </div>
      <v-data-table
        :headers="applicantWaitingHeaders"
        :items="applicantWaitingAction"
        :items-per-page="10"
        :show-select="canBulkEdit() && applicantWaitingAction.length > 0"
        v-model="selectedItems"
        item-key="id"
        aria-labelledby="waiting_action"
        calculate-widths
        class="elevation-0"
      >
        <template v-slot:item.tags="props">
          <div style="display: flex;align-items: center;flex-wrap: wrap;">
            <div :class="`${props.item.tags[0].id === item.id ? '' : 'ml-3'} mt-3 mb-3`" v-for="item in props.item.tags" v-bind:key="item.id">
              <p :class="item.color + ' priority'">
                {{item.text}}
              </p>
            </div>
          </div>
        </template>
        <template v-slot:header.contingent>
          <v-menu
              bottom
              :close-on-content-click="false"
              offset-y
          >
            <template v-slot:activator="{ on, attrs }">
              <p class="header-item"
                 v-bind="attrs"
                 v-on="on">
                Contingent
              </p>
            </template>
            <v-list
                v-for="(item, index) in availableContingentWaitingAction"
                :key="index"
            >
              <v-list-item>
                <template v-slot:default="{ active }">
                  <v-list-item-action>
                    <v-checkbox
                        :input-value="active"
                        @change="filterKeyWaitingActionTable($event, item, 'availableContingentWaitingAction')"
                    />
                  </v-list-item-action>
                  <v-list-item-content>
                    <v-list-item-title>Contingent {{item}}</v-list-item-title>
                  </v-list-item-content>
                </template>
              </v-list-item>
              <v-divider
                  v-if="index < availableContingentWaitingAction.length - 1"
                  :key="index"
              ></v-divider>
            </v-list>
          </v-menu>
        </template>
        <template v-slot:header.grade>
          <v-menu
              bottom
              :close-on-content-click="false"
              offset-y
          >
            <template v-slot:activator="{ on, attrs }">
              <p class="header-item"
                 v-bind="attrs"
                 v-on="on">
                Grade
              </p>
            </template>
            <v-list
                v-for="(item, index) in availableGradeWaitingAction"
                :key="index"
            >
              <v-list-item>
                <template v-slot:default="{ active }">
                  <v-list-item-action>
                    <v-checkbox
                        :input-value="active"
                        @change="filterKeyWaitingActionTable($event, item, 'availableGradeWaitingAction')"
                    />
                  </v-list-item-action>
                  <v-list-item-content>
                    <v-list-item-title>{{item}}</v-list-item-title>
                  </v-list-item-content>
                </template>
              </v-list-item>
              <v-divider
                  v-if="index < availableGradeWaitingAction.length - 1"
                  :key="index"
              ></v-divider>
            </v-list>
          </v-menu>
        </template>
        <template v-slot:item.controls="props">
          <v-btn icon outlined color="primary" @click="onButtonClick(props.item.applicantId)" title="Consulter le dossier" aria-label="Aller à la page des détails du dossier">
            <v-icon color="primary">
              {{ eyeIcon }}
            </v-icon>
            <span class="d-sr-only">Voir le dossier</span>
          </v-btn>
        </template>
        <template v-slot:header.controls v-if="selectedItems.length > 0">
          <v-menu
            bottom
            offset-y
          >
            <template v-slot:activator="{ on, attrs }">
              <v-btn v-bind="attrs"
                     v-on="on">
                Choisir action
              </v-btn>
            </template>
            <v-list
              v-for="(item, index) in actions"
              :key="index"
            >
              <v-list-item>
                <template>
                  <v-list-item-content style="cursor: pointer;" @click="onActionClick(item)">
                    <v-list-item-title>{{item}}</v-list-item-title>
                  </v-list-item-content>
                </template>
              </v-list-item>
              <v-divider
                v-if="index <= actions.length - 1"
                :key="index"
              ></v-divider>
            </v-list>
          </v-menu>
        </template>
        <template v-slot:item.action="props">
          <p class="action">
            <v-icon small style="vertical-align: middle; margin-bottom: 3px; color: #0063cb">
              {{ info }}
            </v-icon>
            {{ props.item.action }}
          </p>
        </template>
      </v-data-table>
    </div>

    <div>
      <div class="title">
        <img :src="documentImg" alt="" />
        <h1 id="all_folders">Tous les dossiers ({{ applicants.length }})</h1>
      </div>
      <v-data-table
        aria-labelledby="all_folders"
        :headers="headers"
        :items="applicants"
        :items-per-page="10"
        calculate-widths
        class="elevation-0 mt-8"
        locale="fr-FR"
      >
        <template v-slot:item.tags="props">
          <div style="display: flex;align-items: center;flex-wrap: wrap;">
            <div :class="`${props.item.tags[0].id === item.id ? '' : 'ml-3'} mt-3 mb-3`" v-for="item in props.item.tags" v-bind:key="item.id">
              <p :class="item.color + ' priority'">
                {{item.text}}
              </p>
            </div>
          </div>
        </template>
        <template v-slot:header.contingent>
          <v-menu
            bottom
            :close-on-content-click="false"
            offset-y
          >
            <template v-slot:activator="{ on, attrs }">
              <p class="header-item"
                 v-bind="attrs"
                 v-on="on">
                Contingent
              </p>
            </template>
            <v-list
              v-for="(item, index) in availableContingent"
              :key="index"
            >
              <v-list-item>
                <template v-slot:default="{ active }">
                  <v-list-item-action>
                    <v-checkbox
                      :input-value="active"
                      @change="filterKey($event, item, 'contingent')"
                    />
                  </v-list-item-action>
                  <v-list-item-content>
                    <v-list-item-title>Contingent {{item}}</v-list-item-title>
                  </v-list-item-content>
                </template>
              </v-list-item>
              <v-divider
                v-if="index < availableContingent.length - 1"
                :key="index"
              ></v-divider>
            </v-list>
          </v-menu>
        </template>
        <template v-slot:header.handleBy>
          <v-menu
            bottom
            :close-on-content-click="false"
            offset-y
          >
            <template v-slot:activator="{ on, attrs }">
              <p class="header-item"
                 v-bind="attrs"
                 v-on="on">
                En cours d'étude par
              </p>
            </template>
            <v-list
              v-for="(item, index) in availableHandleBy"
              :key="index"
            >
              <v-list-item>
                <template v-slot:default="{ active }">
                  <v-list-item-action>
                    <v-checkbox
                      :input-value="active"
                      @change="filterKey($event, item, 'availableHandleBy')"
                    />
                  </v-list-item-action>
                  <v-list-item-content>
                    <v-list-item-title>{{item}}</v-list-item-title>
                  </v-list-item-content>
                </template>
              </v-list-item>
              <v-divider
                v-if="index < availableHandleBy.length - 1"
                :key="index"
              ></v-divider>
            </v-list>
          </v-menu>
        </template>
        <template v-slot:header.grade>
          <v-menu
            bottom
            :close-on-content-click="false"
            offset-y
          >
            <template v-slot:activator="{ on, attrs }">
              <p class="header-item"
                 v-bind="attrs"
                 v-on="on">
                Grade
              </p>
            </template>
            <v-list
              v-for="(item, index) in availableGrade"
              :key="index"
            >
              <v-list-item>
                <template v-slot:default="{ active }">
                  <v-list-item-action>
                    <v-checkbox
                      :input-value="active"
                      @change="filterKey($event, item, 'grade')"
                    />
                  </v-list-item-action>
                  <v-list-item-content>
                    <v-list-item-title>{{item}}</v-list-item-title>
                  </v-list-item-content>
                </template>
              </v-list-item>
              <v-divider
                v-if="index < availableGrade.length - 1"
                :key="index"
              ></v-divider>
            </v-list>
          </v-menu>
        </template>


        <template v-slot:header.rapporterAdvice>
          <v-menu
            bottom
            :close-on-content-click="false"
            offset-y
          >
            <template v-slot:activator="{ on, attrs }">
              <p class="header-item"
                 v-bind="attrs"
                 v-on="on">
                Avis rapporteur
              </p>
            </template>
            <v-list
              v-for="(item, index) in availableRapporterAdvice"
              :key="index"
            >
              <v-list-item>
                <template v-slot:default="{ active }">
                  <v-list-item-action>
                    <v-checkbox
                      :input-value="active"
                      @change="filterKey($event, item, 'availableRapporterAdvice')"
                    />
                  </v-list-item-action>
                  <v-list-item-content>
                    <v-list-item-title>{{item}}</v-list-item-title>
                  </v-list-item-content>
                </template>
              </v-list-item>
              <v-divider
                v-if="index < availableRapporterAdvice.length - 1"
                :key="index"
              ></v-divider>
            </v-list>
          </v-menu>
        </template>
        <template v-slot:item.rapporterAdvice="props">
          <p v-if="props.item.rapporterAdvice.toLowerCase() === 'admissible'" class="rapporter-advice-ok">
            {{ props.item.rapporterAdvice }}
          </p>
          <p v-if="props.item.rapporterAdvice.toLowerCase() === 'en discussion'" class="rapporter-advice-discussion">
            {{ props.item.rapporterAdvice }}
          </p>
          <p v-if="props.item.rapporterAdvice.toLowerCase() === 'ajourné' || props.item.rapporterAdvice.toLowerCase() === 'non agréé'" class="rapporter-advice-refused">
            {{ props.item.rapporterAdvice }}
          </p>
        </template>

        <template v-slot:item.controls="props">
          <v-btn
            icon
            v-if="isAdmin()"
            style="margin-right: 10px"
            outlined
            color="primary"
            @click="onMoveBtnClick(props.item.id, props.item.applicantId, true)"
            title="Ré-assigner le dossier"
            aria-label="Ré-assigner le dossier"
          >
            <v-icon color="primary">
              {{ folderArrowUpDown }}
            </v-icon>
            <span class="d-sr-only">Ré-assigner le dossier</span>
          </v-btn>
          <v-btn
            icon
            v-if="isAdmin()"
            style="margin-right: 10px"
            outlined
            color="primary"
            @click="onMoveBtnClick(props.item.id, props.item.applicantId, false)"
            aria-label="Déplacer le dossier"
            title="Déplacer le dossier"
          >
            <v-icon color="primary">
              {{ folderMove }}
            </v-icon>
            <span class="d-sr-only">Déplacer le dossier</span>
          </v-btn>
          <v-btn icon v-if="isAdmin()" class="delete" outlined color="primary" @click="openDeleteDialog(props.item.id, props.item.applicantId)" title="Supprimer le dossier" aria-label="Supprimer le dossier">
            <v-icon style="color: #e1000f">
              {{ deleteIcon }}
            </v-icon>
            <span class="d-sr-only">Supprimer le dossier</span>
          </v-btn>
          <v-btn
            icon
            v-if="isAdmin() || props.item.editable"
            style="margin-right: 10px"
            outlined
            color="primary"
            @click="onEditBtnClick(props.item.id, props.item.applicantId)"
            title="Modifier le dossier"
            aria-label="Aller à la page de modification du dossier"
          >
            <v-icon color="primary">
              {{ penIcon }}
            </v-icon>
            <span class="d-sr-only">Modifier le dossier</span>
          </v-btn>
          <v-btn icon outlined color="primary" @click="onButtonClick(props.item.applicantId)" title="Consulter le dossier" aria-label="Aller à la page de détails du dossier">
            <v-icon color="primary">
              {{ eyeIcon }}
            </v-icon>
            <span class="d-sr-only">Voir le dossier</span>
          </v-btn>
        </template>
        <template v-slot:item.action="props">
          <p class="action">
            <v-icon small style="vertical-align: middle; margin-bottom: 3px; color: #0063CB;">
              {{ info }}
            </v-icon>
            {{props.item.action}}
          </p>
        </template>
      </v-data-table>
    </div>
    <alert :open="open" :with-confirmation="true" :on-close="onClose" :on-confirm="onDelete">
      <template v-slot:title>
        <h2 class="pb-3">
          <v-icon large style="margin-bottom: 5px; color: #161616">
            {{ infoIcon }}
          </v-icon>
          <span>Êtes-vous sûr de vouloir supprimer ce dossier ?</span>
        </h2>
      </template>
      <template v-slot:message>
        <p>Cette action est irréversible. Après cela, vous ne retrouverez plus votre dossier nul part !</p>
      </template>
    </alert>
    <alert
        :open="actionPopup"
        :on-close="onCloseActionPopup"
        :on-confirm="onConfirmAction"
        :with-confirmation="true"
    >
      <template v-slot:title>
        <h2 class="pb-3">
          <v-icon large style="margin-bottom: 5px; color: #161616">
            {{ infoIcon }}
          </v-icon>
          <span>Vous êtes sur le point de donner l'avis suivant : {{actionSelected}}</span>
        </h2>
      </template>
      <template v-slot:message>
        <selector
            label="Attribuer à"
            :items="onboardingViewModel.entities.map(elem => elem.name)"
            placeholder="Sélectionner une option"
            v-model="entity"
            :error-messages="entityErrors"
        />
        <text-field
            label="Commentaire (facultatif)"
            :required="false"
            :default-value="finalComment"
            v-model="finalComment"
            field-type="text-area"
        />
      </template>
    </alert>
    <move-dialog
      :title="reassign ? 'Ré-assigner le dossier pour une autre entité' : 'Modifier l\'entité déposante'"
      :open="moveDialogOpen"
      :on-close="onMoveDialogClosed"
      :on-confirm="moveFolderTo"
    />
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import DocumentImg from "@/assets/document.png";
import notification from "@/assets/notification.png";
import {lazyInject, Validation} from "@pasta/box";
import {FolderViewModel} from "@/modules/folders/viewModels/FolderViewModel";
import {Grade} from "@/core/types/training/Grade";
import {ContingentType} from "@/core/types/training/ContingentType";
import {AuthModule} from "@pasta/front-auth";
import {
  mdiEyeCircleOutline,
  mdiFolderArrowUpDown,
  mdiFolderMove,
  mdiInformation,
  mdiInformationOutline,
  mdiPen,
  mdiTrashCanOutline
} from "@mdi/js";
import {NoteAction} from "@/core/types/applicants/NoteAction";
import {HomeViewModel} from "@/modules/home/viewModels/HomeViewModel";
import Alert from "@/components/Alert.vue";
import {OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import MoveDialog from "@/modules/folders/components/MoveDialog.vue";
import {Applicant} from "@/core/entities/Applicant";
import TextField from "@/components/TextField.vue";
import DataVisualisation from "@/assets/data_visualization.png";
import {AuthRole} from "@/core/types/identity/AuthRole";
import dayjs from "dayjs";
import Selector from "@/components/Selector.vue";
import {required} from "vuelidate/lib/validators";
import {FolderDetailViewModel} from "@/modules/folders/viewModels/FolderDetailViewModel";
import {PresentationStatus} from "@/core/entities/Applicant";
import {Watch} from "vue-property-decorator";
import {OnBoardingPath} from "@/modules/onBoarding/navigation/OnBoardingPath";


@Component({
  components: {
    Selector,
    Alert,
    MoveDialog,
    TextField,
  },
})
export default class ApplicantsList extends Vue {
  @lazyInject(FolderViewModel)
  declare folderViewModel: FolderViewModel;

  @lazyInject(HomeViewModel)
  declare homeViewModel: HomeViewModel;

  @lazyInject(AuthModule)
  declare authModule: AuthModule;

  @lazyInject(OnBoardingViewModel)
  declare onboardingViewModel: OnBoardingViewModel;

  @lazyInject(FolderDetailViewModel)
  declare folderDetailViewModel: FolderDetailViewModel

  role = 0;

  selectedItems: {
    name: string;
    purposeBy?: string;
    handleBy?: string;
    grade?: Grade;
    contingent?: ContingentType;
    id: string;
    editable: boolean;
    rapporterAdvice: string;
    applicantId: string;
  }[] = []

  dataVisualisation = DataVisualisation;


  @Validation({
    required: {
      errorMessage: "Veuillez sélectionner une entité",
      validator: required,
    }
  })
  entity = "";

  open = false;
  selectedDeleteFolder = {
    id: "",
    applicantId: ""
  };
  infoIcon = mdiInformationOutline;
  folderArrowUpDown = mdiFolderArrowUpDown;
  deleteIcon = mdiTrashCanOutline;
  penIcon = mdiPen;
  documentImg = DocumentImg;
  notification = notification;
  info = mdiInformation;
  eyeIcon = mdiEyeCircleOutline;
  folderMove = mdiFolderMove;
  search = "";

  actions: string[] = []

  availableContingent: ContingentType[] = [];
  availableContingentWaitingAction: ContingentType[] = [];
  availableGrade: Grade[] = [];
  availableHandleBy: string[] = [];
  availableGradeWaitingAction: Grade[] = [];
  availableRapporterAdvice: string[] = [];

  moveDialogOpen = false;
  reassign = false;

  actionSelected = "";
  actionPopup = false;
  finalComment = "";

  filters = {
    contingent: [],
    grade: [],
    availableRapporterAdvice: [],
    availableGradeWaitingAction: [],
    availableHandleBy: [],
    availableContingentWaitingAction: []
  }

  headers = [
    {
      text: "Notes",
      align: "start",
      value: "tags",
      groupable: false,
      width: '15%'
    },
    {
      text: "Nom du candidat",
      align: "start",
      value: "name",
      groupable: true,
      width: '15%'
    },
    { text: "Proposé par", value: "purposeBy", groupable: false, width: '10%' },
    { text: "En cours d'étude par", value: "handleBy", groupable: false, width: '10%' },
    { text: "Grade", value: "grade", groupable: false, sortable: false, width: '10%' },
    { text: "Contingent", value: "contingent", sortable: false, width: '2%' },
    { text: "Avis rapporteur", value: "rapporterAdvice", sortable: false, width: '13%' },
    { text: "", value: "controls", align: "end", groupable: false, width: '30%' },
  ];

  applicantWaitingHeaders = [
    {
      text: "Notes",
      align: "start",
      value: "tags",
      groupable: false,
      width: '15%'
    },
    {
      text: "Nom du candidat",
      align: "start",
      sortable: true,
      value: "name",
      width: "30%"
    },
    { text: "Proposé par", value: "purposeBy", sortable: false, width: "20%" },
    { text: "Grade", value: "grade", groupable: false, sortable: false, width: '10%' },
    { text: "Contingent", value: "contingent", sortable: false, width: '5%' },
    { text: "Actions en attente", value: "action", sortable: false, width: "20%" },
    { text: "", value: "controls", sortable: false, align: "end", width: "15%" },
  ];

  applicants: {
    name: string;
    purposeBy?: string;
    handleBy?: string;
    grade?: Grade;
    contingent?: ContingentType;
    id: string;
    applicantId: string;
    editable: boolean;
    rapporterAdvice: string;
    updatedAt: string;
  }[] = [];

  applicantWaitingAction: {
    name: string;
    purposeBy?: string;
    handleBy?: string;
    action: string;
    contingent?: ContingentType;
    grade?: Grade;
    id: string;
    applicantId: string;
    editable: boolean;
  }[] = [];

  applicantWaitingActionCopy: {
    name: string;
    purposeBy?: string;
    handleBy?: string;
    action: string;
    contingent?: ContingentType;
    grade?: Grade;
    applicantId: string;
    id: string;
    editable: boolean;
  }[] = [];

  onClose() {
    this.open = false;
  }

  capitalize(value: string) {
    return value.charAt(0).toUpperCase() + value.slice(1).toLowerCase();
  }

  @Watch("search")
  async listenOnChange(value: string) {
    this.updateApplicantWaitingAction(value);
    this.updateApplicantList(value);
  }

  updateApplicantList(value: string) {
    const nameFilter = (elem: Applicant) => {
      const name = `${elem.personalInformation.birthName} ${elem.personalInformation.firstName}`.toLowerCase();
      return name.includes(value.toLowerCase());
    }
    const folderCopy = this.folderViewModel.folders;
    const newFolders = this.applyFolderFilter({
      filters: this.filters,
      folders: folderCopy,
    })

    const currentUser = this.authModule.currentUser;
    const role = currentUser?.highestRoleLevel ?? 0;
    const groupIds = currentUser?.groups?.map(item => item.id.toString()) ?? [];
    this.mapApplicant({
      groupIds,
      role,
      folders: newFolders.filter(elem => nameFilter(elem)),
    })
  }

  updateApplicantWaitingAction(value: string) {
    const applicantIds = this.applicantWaitingActionCopy.map(elem => elem.id)
    const nameFilter = (elem: Applicant) => {
      const name = `${elem.personalInformation.birthName} ${elem.personalInformation.firstName}`.toLowerCase();
      return name.includes(value.toLowerCase());
    }
    const folderCopy = this.folderViewModel.folders.filter(elem => applicantIds.includes(elem.id));
    const newFolders = this.applyFolderFilter({
      filters: this.filters,
      folders: folderCopy,
    })
    const currentUser = this.authModule.currentUser;
    const role = currentUser?.highestRoleLevel ?? 0;
    const action = role >= 2 ? "À VALIDER" : "DEMANDE DE COMPLÉMENTS"
    this.applicantWaitingAction = newFolders.filter(elem => nameFilter(elem)).map(elem => {
      return {
        name: `${elem.personalInformation.birthName} ${elem.personalInformation.legalName ? `Ep. ${elem.personalInformation.legalName}` : ''} ${this.capitalize(elem.personalInformation.firstName)}`,
        purposeBy: elem.attachedOrganisation?.name,
        action: action,
        handleBy: elem.notes[0].organisation.name,
        id: elem.id,
        tags: elem.tags,
        editable: true,
        grade: elem.demand?.contingentInformation?.grade,
        contingent: elem.demand?.contingentType,
        applicantId: elem.applicantId,
      };
    });
  }

  applyFolderFilter(payload: {
    folders: Applicant[];
    filters: {
      grade: string[];
      contingent: string[];
      availableRapporterAdvice: string[];
      availableGradeWaitingAction: string[];
      availableContingentWaitingAction: string[];
      availableHandleBy: string[]
    };
  }) {
    let folders = [];
    folders.push(payload.folders);
    folders = folders.flat() as Applicant[];
    const filters = payload.filters;
    if (filters.contingent.length > 0) {
      folders = folders.filter(elem => filters.contingent.includes(elem.demand?.contingentType as any));
    }
    if (filters.availableContingentWaitingAction.length > 0) {
      folders = folders.filter(elem => filters.availableContingentWaitingAction.includes(elem.demand?.contingentType as any));
    }
    if (filters.grade.length > 0) {
      folders = folders.filter(elem => filters.grade.includes(elem.demand?.contingentInformation?.grade as any));
    }
    if (filters.availableGradeWaitingAction.length > 0) {
      folders = folders.filter(elem => filters.availableGradeWaitingAction.includes(elem.demand?.contingentInformation?.grade as any));
    }
    if (filters.availableHandleBy.length > 0) {
      folders = folders.filter(elem => filters.availableHandleBy.includes(elem.notes[0].organisation.name));
    }
    if (filters.availableRapporterAdvice.length > 0) {
      const rapporterAdviceFilters = this.filters.availableRapporterAdvice.map((elem: string) => elem.toLowerCase());
      folders = folders.filter(elem => {
        const foundRapporterNote = elem.notes.filter(item => rapporterAdviceFilters.includes(item.action?.toLowerCase() as any))
        return foundRapporterNote.length > 0
      });
    }
    return folders;
  }

  canBulkEdit() {
    const currentUser = this.authModule.currentUser;
    return currentUser?.highestRoleLevel === AuthRole.RAPPORTER || currentUser?.highestRoleLevel === AuthRole.CHANCELLERY;
  }



  filterKeyWaitingActionTable(checked: any, item: any, key: string) {
    const applicantIds = this.applicantWaitingActionCopy.map(elem => elem.id)
    const folderCopy = this.folderViewModel.folders.filter(elem => applicantIds.includes(elem.id));
    const currentUser = this.authModule.currentUser;
    const role = currentUser?.highestRoleLevel ?? 0;
    const action = role >= 2 ? "À VALIDER" : "DEMANDE DE COMPLÉMENTS"
    if (!checked) {
      // eslint-disable-next-line @typescript-eslint/ban-ts-comment
      //@ts-ignore
      this.filters[key] = this.filters[key].filter(elem => elem != item);
      const newFolders = this.applyFolderFilter({
        filters: this.filters,
        folders: folderCopy,
      })
      this.applicantWaitingAction = newFolders.map(elem => {
        return {
          name: `${elem.personalInformation.birthName} ${elem.personalInformation.legalName ? `Ep. ${elem.personalInformation.legalName}` : ''} ${this.capitalize(elem.personalInformation.firstName)}`,
          purposeBy: elem.attachedOrganisation?.name,
          action: action,
          handleBy: elem.notes[0].organisation.name,
          id: elem.id,
          tags: elem.tags,
          editable: true,
          grade: elem.demand?.contingentInformation?.grade,
          contingent: elem.demand?.contingentType,
          applicantId: elem.applicantId,
        };
      });
      return;
    }
    // eslint-disable-next-line @typescript-eslint/ban-ts-comment
    //@ts-ignore
    this.filters[key].push(item);
    const newFolders = this.applyFolderFilter({
      filters: this.filters,
      folders: folderCopy,
    })
    this.applicantWaitingAction = newFolders.map(elem => {
      return {
        name: `${elem.personalInformation.birthName} ${elem.personalInformation.legalName ? `Ep. ${elem.personalInformation.legalName}` : ''} ${this.capitalize(elem.personalInformation.firstName)}`,
        purposeBy: elem.attachedOrganisation?.name,
        action: action,
        tags: elem.tags,
        handleBy: elem.notes[0].organisation.name,
        id: elem.id,
        editable: true,
        grade: elem.demand?.contingentInformation?.grade,
        contingent: elem.demand?.contingentType,
        applicantId: elem.applicantId,
      };
    });
  }
  filterKey(checked: any, item: any, key: string) {
    const folderCopy = this.folderViewModel.folders
    const currentUser = this.authModule.currentUser;
    const role = currentUser?.highestRoleLevel ?? 0;
    const groupIds = currentUser?.groups?.map(item => item.id.toString()) ?? [];

    if (!checked) {
      // eslint-disable-next-line @typescript-eslint/ban-ts-comment
      //@ts-ignore
      this.filters[key] = this.filters[key].filter(elem => elem != item);
      const newFolders = this.applyFolderFilter({
        filters: this.filters,
        folders: folderCopy,
      })
      this.mapApplicant({
        groupIds,
        role,
        folders: newFolders,
      })
      return;
    }
    // eslint-disable-next-line @typescript-eslint/ban-ts-comment
    //@ts-ignore
    this.filters[key].push(item);
    const newFolders = this.applyFolderFilter({
      filters: this.filters,
      folders: folderCopy,
    })
    this.mapApplicant({
      groupIds,
      role,
      folders: newFolders,
    })
  }

  mapApplicant(payload: {
    folders: Applicant[];
    role: number;
    groupIds: string[];
  }) {
    const { folders } = payload;
    const rapporterAdvices = [
      'admissible',
      'en discussion',
      'ajourné',
      'non agréé',
    ];
    this.applicants = folders.map(elem => {
      return {
        contingent: elem.demand?.contingentType,
        grade: elem.demand?.contingentInformation?.grade,
        updatedAt: dayjs(elem.creationDate).format('DD/MM/YYYY'),
        handleBy: elem.notes[0].organisation.name,
        name: `${elem.personalInformation.birthName} ${elem.personalInformation.legalName ? `Ep. ${elem.personalInformation.legalName}` : ''} ${this.capitalize(elem.personalInformation.firstName)}`,
        purposeBy: elem.attachedOrganisation?.name,
        id: elem.id,
        rapporterAdvice: elem.notes.find(item => rapporterAdvices.includes(item.action?.toLowerCase() || ""))?.action ?? "",
        tags: elem.tags,
        applicantId: elem.applicantId,
        editable: this.isEditable(elem),
      }
    })
  }

  isEditable(folder: Applicant) {
    const currentUser = this.authModule.currentUser;
    const role = currentUser?.highestRoleLevel ?? 0;
    const groupIds = currentUser?.groups?.map(item => item.id.toString()) ?? [];
    return folder.decision == null && this.isAdmin() || role >= 2 ? folder.decision == null && groupIds.includes(folder.notes[0].organisation.id) && folder.notes[0].action !== NoteAction.INFORMATION_REQUIRED : folder.decision == null && groupIds.includes(folder.notes[0].organisation.id) && folder.status === PresentationStatus.INFO_REQUIRED
  }

  async onActionClick(item: string) {
    this.actionSelected = item;
    this.actionPopup = true;
  }

  onCloseActionPopup() {
    this.actionPopup = false;
  }
  async onConfirmAction() {
    this.$v.$touch();
    const isError = this.$v.$invalid;
    if (!isError) {
      const entity = this.onboardingViewModel.entities.find(elem => elem.name.toLowerCase() === this.entity.toLowerCase());
      await this.folderViewModel.addBulkNote({
        folder: this.selectedItems.map(elem => {
          return {
            applicantId: elem.applicantId,
            id: elem.id,
          }
        }),
        action: this.actionSelected,
        comment: this.finalComment,
        entityId: entity?.id as string
      })
      await this.init();
      this.actionPopup = false;
    }
  }

  async init() {
    const folders = await this.folderViewModel.getFolders();
    await this.onboardingViewModel.fetchEntities();
    const currentUser = this.authModule.currentUser;
    const role = currentUser?.highestRoleLevel ?? 0;
    if (this.isRapporter()) {
      this.folderViewModel.initQuotasForRapporter();
      this.actions = [
        'Admissible',
        'En discussion',
        'Ajourné',
        'Non agréé',
        "Demande de complément",
      ]
    }
    if (this.isChancellery()) {
      this.actions = [
        'Soumettre au rapporteur', //done
        'Demande d\'avis',
        'Demande de complément',
        'Non présenté'
      ]
    }
    const groupIds = currentUser?.groups?.map(item => item.id.toString()) ?? [];
    this.mapApplicant({
      folders,
      role,
      groupIds,
    })
    this.headers = this.headers.filter(elem => {
      if (role >= 5) {
        return elem;
      }
      return elem.value != "rapporterAdvice"
    })
    if (role >= 2) {
      const rapporterAdvices = [
        'admissible',
        'en discussion',
        'ajourné',
        'non agréé',
      ];
      this.applicantWaitingAction = folders
        .filter(
          elem =>
            elem.notes.length > 0 &&
            groupIds.includes(elem.notes[0].organisation.id) &&
            elem.notes[0].action !== NoteAction.INFORMATION_REQUIRED &&
            elem.notes.find(item => rapporterAdvices.includes(item.action?.toLowerCase() || "")) == null
        )
        .map(elem => {
          return {
            name: `${elem.personalInformation.birthName} ${elem.personalInformation.legalName ? `Ep. ${elem.personalInformation.legalName}` : ''} ${this.capitalize(elem.personalInformation.firstName)}`,
            purposeBy: elem.attachedOrganisation?.name,
            action: "À VALIDER",
            tags: elem.tags,
            handleBy: elem.notes[0].organisation.name,
            id: elem.id,
            editable: true,
            grade: elem.demand?.contingentInformation?.grade,
            contingent: elem.demand?.contingentType,
            applicantId: elem.applicantId,
          };
        });
    }
    if (role < 2) {
      this.applicantWaitingAction = folders
        .filter(
          elem =>
            elem.status === PresentationStatus.INFO_REQUIRED &&
            elem.notes.length > 0 &&
            groupIds.includes(elem.notes[0].organisation.id) && elem.decision == null
        )
        .map(elem => {
          return {
            name: `${elem.personalInformation.birthName} ${elem.personalInformation.legalName ? `Ep. ${elem.personalInformation.legalName}` : ''} ${this.capitalize(elem.personalInformation.firstName)}`,
            purposeBy: elem.attachedOrganisation?.name,
            action: "DEMANDE DE COMPLÉMENTS",
            handleBy: elem.notes[0].organisation.name,
            id: elem.id,
            tags: elem.tags,
            editable: true,
            grade: elem.demand?.contingentInformation?.grade,
            contingent: elem.demand?.contingentType,
            applicantId: elem.applicantId,
          };
        });
    }
    this.availableContingent = Array.from(new Set(this.applicants.map(elem => elem.contingent))) as ContingentType[];
    this.availableContingentWaitingAction = Array.from(new Set(this.applicantWaitingAction.map(elem => elem.contingent))) as ContingentType[];
    this.availableGrade = Array.from(new Set(this.applicants.map(elem => elem.grade))) as Grade[];
    this.availableHandleBy = Array.from(new Set(this.applicants.map(elem => elem.handleBy as string)));
    this.availableGradeWaitingAction = Array.from(new Set(this.applicantWaitingAction.map(elem => elem.grade))) as Grade[];
    this.availableRapporterAdvice = Array.from(new Set(this.applicants.filter(elem => elem.rapporterAdvice != "").map(elem => elem.rapporterAdvice)))
    this.applicantWaitingActionCopy = this.applicantWaitingAction;
  }
  async mounted() {
    await this.init();
  }

  async onButtonClick(folderId: string) {
    await this.folderViewModel.selectFolder(folderId);
    window.open("/mes-dossiers/details", "_blank")
  }

  async onEditBtnClick(presentationId: string, applicantId: string) {
    this.onboardingViewModel.clearAll();
    const applicant = await this.folderDetailViewModel.getPresentation({
      applicantId: applicantId,
      presentationId: presentationId,
    })
    await this.onboardingViewModel.enrich(applicant);
    this.onboardingViewModel.updateEditMode(true);
    this.onboardingViewModel.selectDecoration(this.folderDetailViewModel.selectedPresentation.decorationType);
    return this.$router.push(OnBoardingPath.TRAINING_INFORMATION);
  }

  isAdmin() {
    const currentUser = this.authModule.currentUser;
    return currentUser?.highestRoleLevel && currentUser?.highestRoleLevel >= 1000;
  }

  isRapporter() {
    const currentUser = this.authModule.currentUser;
    return currentUser?.highestRoleLevel === AuthRole.RAPPORTER;
  }

  isChancellery() {
    const currentUser = this.authModule.currentUser;
    return currentUser?.highestRoleLevel === AuthRole.CHANCELLERY;
  }

  openDeleteDialog(folderId: string, applicantId: string) {
    this.open = true;
    this.selectedDeleteFolder = {
      id: folderId,
      applicantId: applicantId,
    };
  }

  onMoveBtnClick(folderId: string, applicantId: string, reassign: boolean) {
    this.moveDialogOpen = true;
    this.selectedDeleteFolder = {
      applicantId: applicantId,
      id: folderId,
    };
    this.reassign = reassign;
  }

  onMoveDialogClosed() {
    this.moveDialogOpen = false;
    return;
  }

  async moveFolderTo(entityId: string) {
    if (!this.reassign) {
      await this.homeViewModel.moveFolder({
        presentationId: this.selectedDeleteFolder.id,
        entityId,
      })
    } else {
      await this.folderViewModel.addNote({
        entityId: entityId,
        action: NoteAction.SUBMITTED,
        comment: "Ré-assignation faites par l'administrateur du site",
        additionalComment: "",
        folderId: this.selectedDeleteFolder.id,
        applicantId: this.selectedDeleteFolder.applicantId,
      })
    }

    this.moveDialogOpen = false;
    window.location.reload();
    return;
  }

  async onDelete() {
    await this.homeViewModel.deleteDraft({
      applicantId: this.selectedDeleteFolder.applicantId,
      presentationId: this.selectedDeleteFolder.id,
    });
    window.location.reload();
  }
}
</script>

<style lang="scss">
.main_folder {
  padding: 1rem 7rem;
  text-align: left;
  .action {
    text-transform: uppercase !important;
    margin-bottom: 5px;
    background-color: #e8edff;
    display: inherit;
    padding: 3px 10px;
    border-radius: 5px;
    color: #0063cb;
    font-weight: 700;
  }
  .rapporter-advice-ok {
    text-transform: uppercase !important;
    margin-bottom: 5px;
    background-color: #B8FEC9;
    display: inherit;
    padding: 3px 10px;
    border-radius: 5px;
    color: #18753C;
    font-weight: 700;
  }
  .rapporter-advice-discussion {
    text-transform: uppercase !important;
    margin-bottom: 5px;
    background-color: #FEECC2;
    display: inherit;
    padding: 3px 10px;
    border-radius: 5px;
    color: #716043;
    font-weight: 700;
  }
  .rapporter-advice-refused {
    text-transform: uppercase !important;
    margin-bottom: 5px;
    background-color: #FFE8E5;
    display: inherit;
    padding: 3px 10px;
    border-radius: 5px;
    color: #B34000;
    font-weight: 700;
  }
  .title {
    display: flex;
    align-items: center;
    margin-bottom: 35px;
    img {
      width: 80px;
      height: 80px;
      object-fit: contain;
    }
    h1 {
      margin-left: 35px;
      font-weight: 500;
      color: #000;
    }
  }
  .v-data-table-header {
    span {
      color: black;
      font-size: 14px;
    }
  }
  .theme--light.v-data-table > .v-data-table__wrapper > table > thead > tr:last-child > th {
    border-bottom: medium solid #3a3a3a;
  }
  .theme--light.v-data-table
    > .v-data-table__wrapper
    > table
    > tbody
    > tr:hover:not(.v-data-table__expanded__content):not(.v-data-table__empty-wrapper) {
    background: transparent;
  }
  .delete {
    border-color: #e1000f;
    margin-right: 10px;
    span {
      color: #e1000f;
    }
  }
  .header-item {
    color: black;
    margin-bottom: 0;
    font-size: 14px;
  }
  .quota {
    .bold {
      font-weight: 500;
    }
    .result {
      display: flex;
      align-items: center;
      .v-progress-linear {
        width: 100px;
        height: 20px!important;
        border-radius: 5px;
        .v-progress-linear__background {
          background-color: #F6F6F6!important;
          opacity: 1!important;
        }
        .v-progress-linear__determinate {
          background-color: #27A658!important;
        }
      }
    }
  }
}
</style>

````

</details>


---

### 📄 `src/modules/folders/screens/FolderDetail.vue` [6.066 octets]
<a id="src-modules-folders-screens-FolderDetail-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-folders-screens-FolderDetail-vue)

> **Chemin relatif** : `src/modules/folders/screens/FolderDetail.vue`  
> **Taille** : 6.066 octets  
> **Lignes** : 242  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (242 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <div class="folder">
    <div>
      <div class="header">
        <folder-detail-header :selected-tab="selectedTab" />
      </div>
      <div class="memory">
        <presentations-list v-if="id === 1" />
      </div>
      <div class="resume">
        <presentations-screen  v-if="id === 0" />
      </div>
    </div>
  </div>
</template>

<script lang="ts">
import Component from "vue-class-component";
import Vue from "vue";
import FolderDetailHeader from "../components/FolderDetailHeader.vue";
import FolderResume from "../components/FolderResume.vue";
import FolderComments from "../components/FolderComments.vue";
import PresentationsList from "../components/PresentationList.vue";
import {mdiCommentAlert, mdiEyePlusOutline, mdiEyeRemove, mdiInformation} from '@mdi/js';
import {lazyInject, Validation} from "@pasta/box";
import {AuthModule} from "@pasta/front-auth";
import {requiredIf} from "vuelidate/lib/validators";
import Selector from "@/components/Selector.vue";
import {Civility} from "@/modules/onBoarding/types/Civility";
import TextField from "@/components/TextField.vue";
import {FolderViewModel} from "@/modules/folders/viewModels/FolderViewModel";
import AttributionDialog from "@/modules/folders/components/AttributionDialog.vue";
import {OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {SessionViewModel} from "@/modules/sessions/viewModels/SessionViewModel";
import Alert from "@/components/Alert.vue";
import {HomeViewModel} from "@/modules/home/viewModels/HomeViewModel";
import {FolderDetailViewModel} from "@/modules/folders/viewModels/FolderDetailViewModel";
import PresentationsScreen from "../components/PresentationsScreen.vue";

@Component({
  components: {
    FolderDetailHeader,
    FolderResume,
    Alert,
    FolderComments,
    PresentationsList,
    PresentationsScreen,
    TextField,
    Selector,
    AttributionDialog,
  },
})
export default class FolderDetail extends Vue {
  id: number = 0;
  commentIcon = mdiCommentAlert;
  info = mdiInformation;
  hide = mdiEyeRemove
  see = mdiEyePlusOutline;

  @lazyInject(AuthModule)
  declare authModule: AuthModule;

  @lazyInject(FolderViewModel)
  declare folderViewModel: FolderViewModel;

  @lazyInject(FolderDetailViewModel)
  declare folderDetailViewModel: FolderDetailViewModel;

  @lazyInject(OnBoardingViewModel)
  declare onBoardingViewModel: OnBoardingViewModel;

  @lazyInject(SessionViewModel)
  declare sessionViewModel: SessionViewModel;

  @lazyInject(HomeViewModel)
  declare homeViewModel: HomeViewModel;

  @Validation({
    required: {
      errorMessage: "Veuillez sélectionner une option",
      validator: requiredIf((val: any) => {
        return !val.isInformationRequired();
      }),
    }
  })

  selectedTab(id: number) {
    this.id = id;
  }

  async mounted() {
    await this.onBoardingViewModel.fetchEntities();
    await this.folderDetailViewModel.fetchDetail(this.folderDetailViewModel.folder.id);
    document.title = this.buildName();

  }

  buildName() {
    const state = this.folderDetailViewModel.folder.personalInformation;
    return `
      ${state.civility === Civility.MRS ? 'Mme' : 'M.'} ${state.legalName ? state.legalName.toUpperCase() : state.birthName.toUpperCase()} ${state.firstName.toUpperCase()}
    `
  }


}
</script>

<style lang="scss">
  .v-list-item {
    text-transform: initial!important;
  }
  .v-select__selection--comma {
    text-transform: initial!important;
  }
  .folder {
    position: relative;
    .attachment {
      padding: 1rem 7rem;
    }
    .folder-contents-container {
      padding: 0rem 7rem;
    }
    .resize-icon {
      position: absolute;
      top: 8rem;
      text-align: left;
      right: 5rem;
      background-color: white;
      border-radius: 10px;
      padding: 10px;
      box-shadow: 0px 6px 18px #00001229;
    }
    .action-window {
      text-align: left;
      right: 5rem;
      width: 400px;
      background-color: white;
      border-radius: 10px;
      padding: 24px;
      box-shadow: 0px 6px 18px #00001229;
      .reduce-icon {
        position: absolute;
        right: 15px;
        top: 10px;
        font-size: 22px;
        cursor: pointer;
      }

      h3 {
        font-weight: 500;
        color: #000000;
      }
      .light-grey {
        color: #666666;
      }
      .submit-btn {
        color: #0063CB;
        padding: 0;
        font-size: 14px;
        span {
          letter-spacing: 0;
        }
      }
    }
    .header {
      padding: 2rem 7rem 0 7rem;
      display: flex;
      width: 100%;
      justify-content: space-between;
      background-color: #F6F6F6;
    }
    .resume {
      padding: 1rem 7rem;
    }
    .memory {
      padding: 1rem 7rem;
    }
    .information {
      color: #666666;
      font-weight: 400;
      font-size: 14px;
      margin-top: 5px!important;
    }

    .align-center {
      display: flex;
      align-items: center;
    }

    .file-input {
      margin-top: 14px;
      p {
        margin-left: 10px;
        margin-top: 0;
        font-size: 14px;
        font-weight: 400;
        margin-bottom: 0;
      }
      button {
        background-color: #EEEEEE!important;
        padding-left: 5px!important;
        padding-right: 5px!important;
        box-shadow: none;
        border-radius: 4px!important;
        span {
          font-size: 14px!important;
          letter-spacing: 0;
          font-weight: 400;
        }
      }
      .file-list {
        margin-bottom: 14px;
        div:nth-of-type(1) {
          flex: 0 0 auto!important;
        }
        p {
          margin-right: 10px;
          margin-left: 5px;
          margin-bottom: 3px;
        }
      }
      .remove-btn {
        background-color: transparent!important;
        padding-left: 0!important;
        padding-right: 0!important;
        svg {
          width: 18px;
          height: 18px;
        }
      }
      .border-red {
        border: 1px solid red
      }

      button {
        letter-spacing: 0px!important;
      }
    }
  }
</style>

````

</details>


---

### 📄 `src/modules/home/screens/Accessibility.vue` [9.045 octets]
<a id="src-modules-home-screens-Accessibility-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-home-screens-Accessibility-vue)

> **Chemin relatif** : `src/modules/home/screens/Accessibility.vue`  
> **Taille** : 9.045 octets  
> **Lignes** : 229  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (229 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <div class="container mention-legal">
    <h1>DÉCLARATION D’ACCESSIBILITÉ</h1>
    <p class="mt-5">
      Le Bureau des Cabinets s’engage à rendre son site Web accessible conformément à l’article 47 de la loi n° 2005-102
      du 11 février 2005. Cette déclaration d’accessibilité s’applique au site Web :
      <a href="https://honore.e2.rie.gouv.fr/" target="_blank">https://honore.e2.rie.gouv.fr/</a>
    </p>

    <h3 class="mt-5">ÉTAT DE CONFORMITÉ</h3>
    <p class="mt-5">
      Honoré est en conformité partielle avec le référentiel général d’amélioration de l’accessibilité. Les non-conformités
      sont énumérées ci-dessous.
    </p>

    <h3 class="mt-5">RÉSULTATS DES TESTS</h3>
    <p class="mt-5">
      L’audit de conformité au RGAA 4.1.2 réalisé par la société
      <a href="https://www.numerik-ea.fr/" target="_blank">Numerik-ea</a> révèle que :
    </p>
    <ul>
      <li>72.55% des critères RGAA 4.1.2 sont respectés.</li>
    </ul>
    <p>Dans le détail :</p>
    <ul>
      <li>Nombre de critères conformes : 40</li>
      <li>Nombre de critères non applicables : 56</li>
      <li>Nombre de critères non conformes : 10</li>
    </ul>

    <h3 class="mt-5">CONTENUS NON ACCESSIBLES</h3>
    <p class="mt-5">Les contenus listés ci-dessous ne sont pas accessibles pour les raisons suivantes :</p>
    <h4 class="mt-5">Non conformité</h4>

    <p class="mt-5">Liste des critères non conforme :</p>

    <ul>
      <li>
        5.4 Pour chaque tableau de données ayant un titre, le titre est-il correctement associé au tableau de données ?
      </li>
      <li>
        7.3 Chaque script est-il contrôlable par le clavier et par tout dispositif de pointage (hors cas particuliers) ?
      </li>
      <li>
        8.2 Pour chaque page web, le code source généré est-il valide selon le type de document spécifié (hors cas
        particuliers) ?
      </li>
      <li>9.2 Dans chaque page web, la structure du document est-elle cohérente (hors cas particuliers) ?</li>
      <li>
        10.1 Dans le site web, des feuilles de styles sont-elles utilisées pour contrôler la présentation de
        l’information ?
      </li>
      <li>
        10.4 Dans chaque page web, le texte reste-t-il lisible lorsque la taille des caractères est augmentée jusqu’à
        200%, au moins (hors cas particuliers) ?
      </li>
      <li>10.7 Dans chaque page web, pour chaque élément recevant le focus, la prise de focus est-elle visible ?</li>
      <li>
        10.11 Pour chaque page web, les contenus peuvent-ils être présentés sans perte d’information ou de
        fonctionnalité et sans avoir recours soit à un défilement vertical pour une fenêtre ayant une hauteur de 256 px,
        soit à un défilement horizontal pour une fenêtre ayant une largeur de 320 px (hors cas particuliers) ?
      </li>
      <li>11.6 Dans chaque formulaire, chaque regroupement de champs de même nature a-t-il une légende ?</li>
      <li>12.3 La page « plan du site » est-elle pertinente ?</li>
      <li>
        12.7 Dans chaque page web, un lien d’évitement ou d’accès rapide à la zone de contenu principal est-il présent
        (hors cas particuliers) ?
      </li>
      <li>
        13.9 Dans chaque page web, le contenu proposé est-il consultable quelle que soit l’orientation de l’écran
        (portrait ou paysage) (hors cas particuliers) ?
      </li>
    </ul>

    <h4 class="mt-5">Contenus non soumis à l’obligation d’accessibilité</h4>
    <ul class="mt-5">
      <li>Les fichiers disponibles dans des formats bureautiques publiés avant le 23 septembre 2018;</li>
      <li>
        Les contenus de tiers qui ne sont ni financés ni développés par l’organisme concerné et qui ne sont pas sous son
        contrôle;
      </li>
    </ul>

    <h3 class="mt-5">ÉTABLISSEMENT DE CETTE DÉCLARATION D’ACCESSIBILITÉ</h3>
    <p class="mt-5">Cette déclaration a été établie le 15 Septembre 2023.</p>
    <h4 class="mt-5">Technologies utilisées pour la réalisation du site web</h4>
    <ul class="mt-5">
      <li>HTML</li>
      <li>CSS</li>
      <li>Javascript</li>
    </ul>
    <h4 class="mt-5">Environnement de test</h4>
    <p class="mt-5">
      Les tests des pages web ont été effectués avec les combinaisons de navigateurs web et lecteurs d’écran suivants :
    </p>
    <ul>
      <li>NVDA, Firefox</li>
      <li>Jaws , Firefox</li>
      <li>Voiceover, Safari,</li>
    </ul>

    <h4 class="mt-5">Les outils suivants ont été utilisés lors de l’évaluation :</h4>
    <ul class="mt-5">
      <li>WCAG contrast checker</li>
      <li>HeadingsMap</li>
      <li>Web developer</li>
      <li>ARC Toolkit</li>
      <li>PAC (PDF Accessibility Checker)</li>
    </ul>

    <h4 class="mt-5">Pages du site ayant fait l’objet de la vérification de conformité</h4>
    <ul>
      <li>Accueil : <a href="https://honore.e2.rie.gouv.fr" target="_blank">https://honore.e2.rie.gouv.fr</a></li>
      <li>
        Déposer un dossier :
        <a href="https://honore.e2.rie.gouv.fr/depot-de-dossier" target="_blank"
          >https://honore.e2.rie.gouv.fr/depot-de-dossier</a
        >
      </li>
      <li>
        Etat civil :
        <a href="https://honore.e2.rie.gouv.fr/depot-de-dossier/informations" target="_blank"
          >https://honore.e2.rie.gouv.fr/depot-de-dossier/informations</a
        >
      </li>
      <li>
        Parcours du candidat :
        <a href="https://honore.e2.rie.gouv.fr/depot-de-dossier/parcours" target="_blank"
          >https://honore.e2.rie.gouv.fr/depot-de-dossier/parcours</a
        >
      </li>
      <li>
        Grade demandé :
        <a href="https://honore.e2.rie.gouv.fr/depot-de-dossier/demande" target="_blank"
          >https://honore.e2.rie.gouv.fr/depot-de-dossier/demande</a
        >
      </li>
      <li>
        Document :
        <a href="https://honore.e2.rie.gouv.fr/depot-de-dossier/documents" target="_blank"
          >https://honore.e2.rie.gouv.fr/depot-de-dossier/documents</a
        >
      </li>
      <li>
        Validation:
        <a href="https://honore.e2.rie.gouv.fr/depot-de-dossier/validation" target="_blank"
          >https://honore.e2.rie.gouv.fr/depot-de-dossier/validation</a
        >
      </li>
      <li>
        Succés:
        <a href="https://honore.e2.rie.gouv.fr/depot-de-dossier/success" target="_blank"
          >https://honore.e2.rie.gouv.fr/depot-de-dossier/success</a
        >
      </li>
      <li>
        Suivi des dossiers :
        <a href="https://honore.e2.rie.gouv.fr/mes-dossiers" target="_blank"
          >https://honore.e2.rie.gouv.fr/mes-dossiers</a
        >
      </li>
      <li>
        Détail d’un dossier:
        <a href="https://honore.e2.rie.gouv.fr/mes-dossiers/details" target="_blank"
          >https://honore.e2.rie.gouv.fr/mes-dossiers/details</a
        >
      </li>
      <li>
        Mentions légales:
        <a href="https://honore.e2.rie.gouv.fr/mention-legales" target="_blank"
          >https://honore.e2.rie.gouv.fr/mention-legales</a
        >
      </li>
    </ul>

    <h3 class="mt-5">RETOUR D’INFORMATION ET CONTACT</h3>
    <p class="mt-5">
      Si vous n’arrivez pas à accéder à un contenu ou à un service, vous pouvez contacter le responsable du site web
      pour être orienté vers une alternative accessible ou obtenir le contenu sous une autre forme.
    </p>
    <ul>
      <li>
        Envoyer un message à
        <a href="mailto:assistance-honore@developpement-durable.gouv.fr"
          >assistance-honore@developpement-durable.gouv.fr</a
        >
      </li>
    </ul>
    <h3 class="mt-5">VOIES DE RECOURS</h3>
    <p class="mt-5">Cette procédure est à utiliser dans le cas suivant.</p>
    <p class="mt-5">
      Vous avez signalé au responsable du site web un défaut d’accessibilité qui vous empêche d’accéder à un contenu ou
      à un des services et vous n’avez pas obtenu de réponse satisfaisante.
    </p>
    <ul>
      <li>
        Écrire un message au Défenseur des droits (<a href="https://formulaire.defenseurdesdroits.fr/" target="_blank"
          >https://formulaire.defenseurdesdroits.fr/</a
        >)
      </li>
      <li>
        Contacter le délégué du Défenseur des droits dans votre région (<a
          href="https://www.defenseurdesdroits.fr/saisir/delegues"
          target="_blank"
          >https://www.defenseurdesdroits.fr/saisir/delegues</a
        >)
      </li>
      <li>
        Envoyer un courrier par la poste (gratuit, ne pas mettre de timbre)
        <br />Défenseur des droits <br />Libre réponse 71120 <br />75342 Paris CEDEX 07
      </li>
    </ul>
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";

@Component
export default class Accessibility extends Vue {}
</script>
<style lang="scss">
.mention-legal {
  text-align: left;
  padding: 2rem 4rem;
}
</style>

```

</details>


---

### 📄 `src/modules/home/screens/Cookies.vue` [578 octets]
<a id="src-modules-home-screens-Cookies-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-home-screens-Cookies-vue)

> **Chemin relatif** : `src/modules/home/screens/Cookies.vue`  
> **Taille** : 578 octets  
> **Lignes** : 26  
> **Type** : text

```text
<template>
  <div class="container cookies">
    <h1>Gestion des cookies</h1>
    <iframe style="border: 0; height: 200px; width: 600px;"
            src="https://audience-sites.e2.rie.gouv.fr/index.php?module=CoreAdminHome&action=optOut&language=fr&backgroundColor=&fontColor=&fontSize=&fontFamily=">
    </iframe>
  </div>

</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";

@Component
export default class Cookies extends Vue {

}
</script>
<style lang="scss">
.cookies {
  text-align: left;
  padding: 2rem 4rem;
}
</style>

```


---

### 📄 `src/modules/home/screens/DraftList.vue` [14.191 octets]
<a id="src-modules-home-screens-DraftList-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-home-screens-DraftList-vue)

> **Chemin relatif** : `src/modules/home/screens/DraftList.vue`  
> **Taille** : 14.191 octets  
> **Lignes** : 487  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (487 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <div>
    <div class="home">
      <div style="align-self: flex-start; width: 100%; text-align: left;" class="mb-10">
        <v-row class="mt-3">
          <v-col lg="4">
            <text-field
              label="Recherche"
              :required="false"
              :default-value="search"
              v-model="search"
              field-type="text"
            />
          </v-col>
        </v-row>
        <h3 class="mb-5 mt-5" style="font-weight: 500; font-size: 1.3rem;">
          Filtres :
        </h3>
        <v-row>
          <v-col lg="3">
            <p>Type de décoration</p>
            <v-menu
              bottom
              :close-on-content-click="false"
              offset-y
            >
              <template v-slot:activator="{ on, attrs }">
                <v-btn
                  v-bind="attrs"
                  v-on="on"
                  class="select-btn"
                  outlined
                >
              <span>
                Sélectionner
              </span>
                  <v-icon color="black">
                    {{chevronDown}}
                  </v-icon>
                </v-btn>
              </template>
              <v-list>
                <v-list-item 
                  v-for="(item, index) in homeViewModel.availableDecorationType"
                  :key="index"
                >
                  <template v-slot:default="{ active }">
                    <v-list-item-action>
                      <v-checkbox
                        :input-value="active"
                        v-model="filters.decorationType"
                        :value="item"
                        @change="filterKey(item, 'decorationType')"
                      />
                    </v-list-item-action>
                    <v-list-item-content>
                      <v-list-item-title>{{item}}</v-list-item-title>
                    </v-list-item-content>
                  </template>
                </v-list-item>
              </v-list>
            </v-menu>
          </v-col>
          <v-col lg="3">
            <p>Progression</p>
            <v-menu
              bottom
              :close-on-content-click="false"
              offset-y
            >
              <template v-slot:activator="{ on, attrs }">
                <v-btn
                  v-bind="attrs"
                  v-on="on"
                  class="select-btn"
                  outlined
                >
              <span>
                Sélectionner
              </span>
                  <v-icon color="black">
                    {{chevronDown}}
                  </v-icon>
                </v-btn>
              </template>
              <v-list>
                <v-list-item 
                  v-for="(item, index) in homeViewModel.percentageOptions"
                  :key="index"
                >
                  <template v-slot:default="{ active }">
                    <v-list-item-action>
                      <v-checkbox
                        :input-value="active"
                        v-model="filters.progress"
                        :value="item"
                        @change="filterKey(item, 'progress')"
                      />
                    </v-list-item-action>
                    <v-list-item-content>
                      <v-list-item-title>{{item}}%</v-list-item-title>
                    </v-list-item-content>
                  </template>
                </v-list-item>
              </v-list>
            </v-menu>
          </v-col>
        </v-row>
        <h3 class="mt-5" style="font-weight: 500; font-size: 1.1rem;">
          Filtres actifs :
        </h3>
        <div class="mt-7" style="display: flex">
          <div class="mr-5" v-for="item in Object.values(filters).flat().map(elem => toLabelAndKey(elem))" v-bind:key="item.label">
            <v-chip
              close
              v-if="filters[item.key].includes(item.label)"
              style="border-radius: 0; padding: 10px;padding: 20px;font-size: 15px;"
              color="#E3E3FD"
              @click:close="filters[item.key] = filters[item.key].filter(elem => elem !== item.label); filterKey(item.label, item.key)"
            >
              <span class="active-type" v-if="item.key === 'decorationType'">
                    Type de décoration :
              </span>
              <span class="active-type" v-if="item.key === 'progress'">
                    Progression :
              </span>
              <span class="value-active-type">
                {{item.label}}<span v-if="item.key === 'progress'">%</span>
              </span>
              
              
            </v-chip>
          </div>
          <v-btn v-if="Object.values(filters).flat().length > 0"
                 text color="primary" @click="resetFilters"
          >
            <v-icon class="ml-2" color="primary">
              {{close}}
            </v-icon>
            <span style="text-decoration: underline">
                  Réinitialiser
              </span>
          </v-btn>
        </div>
      </div>

      <div class="all_drafts" style="width: 100%; margin-top: 24px">
        <v-data-table
          :headers="headers"
          :items="applicantsList"
          :items-per-page="10"
          calculate-widths
          class="elevation-0 mt-8"
          locale="fr-FR"
          item-key="id"
        >
          <template  v-slot:item.decorationType="props">
            <p style="display: inherit;" :class="'mb-0 decoration ' + props.item.rawDecorationType">{{props.item.decorationType}}</p>
          </template>
          <template  v-slot:item.controls="props">
            <v-btn icon outlined color="primary" @click="edit(props.item.id)">
              <v-icon color="primary">
                {{eyeIcon}}
              </v-icon>
            </v-btn>
            <v-btn icon class="delete" outlined color="primary" @click="onDelete(props.item.applicantId, props.item.id)" title="Supprimer le brouillon" aria-label="Supprimer le brouillon">
              <v-icon style="color: #e1000f">
                {{ deleteIcon }}
              </v-icon>
              <span class="d-sr-only">Supprimer le dossier</span>
            </v-btn>
          </template>
        </v-data-table>
      </div>
    </div>
    <alert
      :open="open"
      :with-confirmation="true"
      :on-close="onClose"
      :on-confirm="onConfirmDelete"
    >
      <template v-slot:title>
        <h2 class="pb-3">
          <v-icon large style="margin-bottom: 5px; color: #161616">
            {{infoIcon}}
          </v-icon>
          <span>Êtes-vous sûr de vouloir supprimer votre brouillon ?</span>
        </h2>
      </template>
      <template v-slot:message>
        <p>
          En faisant cela, votre brouillon sera définitivement supprimé.
        </p>
      </template>
    </alert>
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import {
  mdiArrowRight,
  mdiChevronDown,
  mdiClose,
  mdiEyeCircleOutline,
  mdiInformationOutline,
  mdiTrashCanOutline
} from "@mdi/js";
import {HomeViewModel, FolderFilters} from "@/modules/home/viewModels/HomeViewModel";
import {lazyInject} from "@pasta/box";
import Draft from "../../../components/Draft.vue";
import {OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {Applicant} from "@/core/entities/Applicant";
import TextField from "@/components/TextField.vue";
import {Watch} from "vue-property-decorator";
import dayjs from "dayjs";
import {DecorationType} from "@/modules/onBoarding/types/DecorationType";
import Alert from "@/components/Alert.vue";
import {toDecorationType} from "@/core/valueObjects/toDecorationType";
import { ApplicantListItem } from "@/core/types/applicants/ApplicantListItem";

@Component({
  components: {
    Alert,
    TextField,
    Draft
  },
})
export default class draftList extends Vue {
  mdiArrowRight = mdiArrowRight;
  chevronDown = mdiChevronDown;

  @lazyInject(HomeViewModel)
  declare homeViewModel: HomeViewModel;

  @lazyInject(OnBoardingViewModel)
  declare onboardingViewModel: OnBoardingViewModel;

  eyeIcon = mdiEyeCircleOutline;
  deleteIcon = mdiTrashCanOutline;
  infoIcon = mdiInformationOutline;
  close = mdiClose;


  search = "";

  filters: FolderFilters = {
    decorationType: [],
    progress: []
  }

  headers = [
    {
      text: 'Nom du candidat',
      align: 'start',
      value: 'name',
      sortable: true,
      width: '20%'
    },
    { text: 'Date de naissance', value: 'birthDate', sortable: true, width: '20%'},
    { text: 'Type de décoration', value: 'decorationType', sortable: true,  width: '20%'},
    { text: 'Date de dépôt', value: 'createdAt', sortable: true,  width: '15%'},
    { text: 'Progression', value: 'progress', sortable: true,  width: '10%'},
    { text: "", value: "controls", sortable: false, align: 'end', groupable: false, width: '15%' }

  ]

  open = false;


  onClose() {
    this.open = false;
  }

  selectedDraft: {id: string; applicantId: string} = {
    id: "",
    applicantId: "",
  };

  async mounted(): Promise<void> {
    await this.homeViewModel.getApplicants();
  }

  edit(applicantId: string) {
    const draft = this.homeViewModel.drafts.find(item => item.id === applicantId);
    if (draft) {
      this.onboardingViewModel.clearAll();
      this.onboardingViewModel.enrich(draft);
      this.onboardingViewModel.updateEditMode(false);
      this.onboardingViewModel.selectDecoration(draft.decorationType);
      return this.$router.push("/depot-de-dossier/informations");
    }
  }

  get applicantsList() : ApplicantListItem[] {
    return this.homeViewModel.drafts.map(elem => {
      return {
        id: elem.id,
        rawDecorationType: elem.decorationType,
        applicantId: elem.applicantId,
        name: `${elem.personalInformation.birthName} ${elem.personalInformation.legalName ? `Ep. ${elem.personalInformation.legalName}` : ''} ${this.capitalize(elem.personalInformation.firstName)}`,
        decorationType: toDecorationType(elem.decorationType),
        birthDate: elem.personalInformation.birthDate ? dayjs(elem.personalInformation.birthDate).format('DD/MM/YYYY') : "",
        createdAt: dayjs(elem.creationDate).format('DD/MM/YYYY'),
        progress: `${this.computeProgress(elem)}%`
      }
    })
  }

  computeProgress(elem: Applicant) {
    if (elem.onBoardingSteps) {
      return ((elem.onBoardingSteps.length / 4) * 100).toFixed(0);
    }
    return 0;
  }

  capitalize(value: string) {
    return value.charAt(0).toUpperCase() + value.slice(1).toLowerCase();
  }

  async onConfirmDelete() {
    await this.homeViewModel.deleteDraft({
      applicantId: this.selectedDraft.applicantId,
      presentationId: this.selectedDraft.id,
    });
    this.open = false;
  }

  async onDelete(applicantId: string, presentationId: string) {
    this.selectedDraft = {
      id: presentationId,
      applicantId,
    }
    this.open = true;
    return;
  }

  @Watch("search")
  async listenOnChange(value: string) {
    await this.homeViewModel.search({
      value,
      filters: this.filters,
    });
  }

  filterKey(item: string, key: string) {
    let folderCopy: Applicant[] = this.homeViewModel.draftsCopy;
    // eslint-disable-next-line @typescript-eslint/ban-ts-comment
    //@ts-ignore
    const isIncluded = this.filters[key].find(elem => elem === item);
    if (!isIncluded) {
      this.homeViewModel.applyFolderFilter({
        filters: this.filters,
        folders: folderCopy,
      })
      return;
    }
    this.homeViewModel.applyFolderFilter({
      filters: this.filters,
      folders: folderCopy,
    })
  }

  toLabelAndKey(elem: string) {
    if (this.filters.decorationType.includes(elem)) {
      return {
        label: elem,
        key: 'decorationType'
      }
    }
    if (this.filters.progress.includes(Number.parseInt(elem))) {
      return {
        label: elem,
        key: 'progress'
      }
    }
  }

  resetFilters() {
    let folderCopy: Applicant[] = this.homeViewModel.draftsCopy;
    this.filters = {
      decorationType: [],
      progress: [],
    }
    this.homeViewModel.applyFolderFilter({
      filters: this.filters,
      folders: folderCopy,
    });
  }

}
</script>

<style lang="scss">
.draft_header {
  display: inline-flex;
  width: 100% !important;
  margin-bottom: 34px;
  margin-top: 55px;
  .title {
    font-size: 28px !important;
    font-weight: 700 !important;
    color: #000000;
  }
  .darft_see_all {
    width: 240px;
    height: 40px;
    padding: 10px;
    margin-top: -5px !important;
    text-align: center !important;
    border: solid 1px #000091;
    margin-left: 700px;
    cursor: pointer;
  }
  .darft_text {
    color: #000091;
    margin-top: -5px;
    font-size: 16px !important;
    font-weight: 500;
    line-height: 24px;
  }
}

.home {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
  padding: 1rem 7rem;
  .header-item {
    color: black;
    margin-bottom: 0;
    font-size: 14px;
  }
  .v-data-table-header {
    span {
      color: black;
      font-size: 14px;
    }
  }
  .theme--light.v-data-table > .v-data-table__wrapper > table > thead > tr:last-child > th {
    border-bottom: medium solid #3A3A3A;
  }
  .theme--light.v-data-table > .v-data-table__wrapper > table > tbody > tr:hover:not(.v-data-table__expanded__content):not(.v-data-table__empty-wrapper) {
    background: transparent;
  }
  .decoration {
    font-size: 13px;
    border: 1px solid;
    padding: 4px 10px;
    border-radius: 50px;
  }
  .merite_maritime {
    color: #666666;
  }
  .legion_honneur {
    color: #CE0500;
  }
  .ordre_national_du_merite {
    color: #0063CB;
  }
  .select-btn {
    width: 100%;
    height: 45px!important;
    display: flex;
    justify-content: space-between;
    padding: 0px 15px!important;
    border: none;
    border-bottom: 2px solid black;
    background: #EEEEEE;
    span {
      color: black
    }
  }
  .active-type {
    color: #000091;
  }
  .value-active-type {
    margin-left: 5px; 
    color: #000091;
    font-weight: bold
  }
  
}
</style>

````

</details>


---

### 📄 `src/modules/home/screens/Home.vue` [6.783 octets]
<a id="src-modules-home-screens-Home-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-home-screens-Home-vue)

> **Chemin relatif** : `src/modules/home/screens/Home.vue`  
> **Taille** : 6.783 octets  
> **Lignes** : 259  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (259 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <div class="homescreen">
    <div class="banner">
      <p class="title mt-5 mb-5 ml-5">
        Les actualités Honoré !
      </p>
      <p class="release-notes ml-5" v-if="!isAdmin()">
        {{homeViewModel.lastNote}}
      </p>
      <div class="ml-5" v-if="isAdmin()">
        <p>
          Inscrivez les mises à jours et informations que vous souhaitez communiquer aux utilisateurs
        </p>
        <text-field
          label=""
          :required="true"
          field-type="text-area"
          v-model="releaseNote"
          :default-value="homeViewModel.lastNote"
        />
        <p class="success-msg" v-if="noteSaved">
          <v-icon color="#18753C">
            {{ check }}
          </v-icon>
          Votre message a bien été sauvegardé !
        </p>
        <v-btn @click="saveReleaseNote" color="primary" class="mb-5">
          Sauvegarder
        </v-btn>
      </div>
    </div>
    <div class="home">
      <div v-if="homeViewModel.folders.length === 0 && homeViewModel.drafts.length === 0" class="home__createRecord">
        <v-img alt="" :src="SearchingImg" :aspect-ratio="1"></v-img>
        <p>Vous n'avez pas encore créé de dossier</p>
        <v-btn  color="primary"  @click="clear">Proposer un candidat</v-btn>
      </div>
      <div v-if="homeViewModel.drafts.length > 0" class="draft">
        <div class="draft_header">
          <h2 class="title">Mes dossiers en cours</h2>
          <v-btn color="primary" outlined @click="goToDraftView">
            Voir tous les brouillons ({{ homeViewModel.drafts.length }})
          </v-btn>
        </div>
        <v-row>
          <v-col
            lg="4"
            xl="3"
            sm="2"
            md="3"
            class="pt-0"
            v-for="draft in homeViewModel.drafts.slice(0, 3)" v-bind:key="draft.id"
          >
            <draft
              :on-delete="() => onDelete(draft.applicantId, draft.id)"
              :draft="draft"
              :progress="true"
              :on-primary-btn-click="() => edit(draft.id)"
            />
          </v-col>
        </v-row>
      </div>
      <v-divider style="width: 100%; margin-top: 50px" v-if="homeViewModel.drafts.length > 0"/>
      <div v-if="homeViewModel.folders.length > 0" class="draft">
        <div class="draft_header">
          <h2 class="title">Mes dossiers déposés</h2>
          <v-btn color="primary" outlined @click="goToFolderView">
            Voir le suivi des dossiers
          </v-btn>
        </div>
        <v-row>
          <v-col
            lg="4"
            xl="3"
            sm="2"
            md="3"
            class="pt-0"
            v-for="folder in homeViewModel.folders.slice(0, 3)" v-bind:key="folder.id"
          >
            <draft
              :draft="folder"
              :progress="false"
              buttonLabel="Consulter"
              :on-primary-btn-click="() => onConsult(folder.applicantId)"
            />
          </v-col>
        </v-row>
      </div>
    </div>
  </div>
</template>



<script lang="ts">
import SearchingImg from "@/assets/searching.svg";
import Vue from "vue";
import Component from "vue-class-component";
import {lazyInject} from "@pasta/box";
import {HomeViewModel} from "../viewModels/HomeViewModel";
import Draft from "@/components/Draft.vue";
import {OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {FolderViewModel} from "@/modules/folders/viewModels/FolderViewModel";
import {AuthModule} from "@pasta/front-auth";
import TextField from "@/components/TextField.vue";
import { mdiCheckCircle } from "@mdi/js"
import {Watch} from "vue-property-decorator";

@Component({
  components: {
    Draft,
    TextField
  }
})
export default class Home extends Vue {
  SearchingImg = SearchingImg;

  @lazyInject(HomeViewModel)
  declare homeViewModel: HomeViewModel;

  @lazyInject(OnBoardingViewModel)
  declare onboardingViewModel: OnBoardingViewModel;

  @lazyInject(FolderViewModel)
  declare folderViewModel: FolderViewModel;

  @lazyInject(AuthModule)
  declare authModule: AuthModule;


  releaseNote = ""

  check = mdiCheckCircle

  noteSaved = false;

  clear() {
    this.onboardingViewModel.clearAll();
    return this.$router.push('/archive/recherche');
  }

  @Watch('releaseNote')
  onChangeValue(value: string) {
    this.homeViewModel.setNote(value);
  }

  async mounted(): Promise<void> {
    await this.homeViewModel.getApplicants()
    const note = await this.homeViewModel.getLastReleaseNote();
    await this.homeViewModel.getSessionList();
    if (note) {
      this.releaseNote = note;
    }
  }

  async saveReleaseNote() {
    await this.homeViewModel.saveReleaseNote(this.releaseNote)
    this.noteSaved = true;
  }

  async onDelete(applicantId: string, presentationId: string) {
    await this.homeViewModel.deleteDraft({
      applicantId, presentationId
    });
    return;
  }

  goToDraftView() {
    return this.$router.push("/drafts");
  }

  async onConsult(applicantId: string) {
    await this.folderViewModel.selectFolder(applicantId);
    window.open("/mes-dossiers/details", "_blank")
  }

  goToFolderView() {
    return this.$router.push("/mes-dossiers");
  }

  edit(applicantId: string) {
    const draft = this.homeViewModel.drafts.find(item => item.id === applicantId);
    if (draft) {
      this.onboardingViewModel.clearAll();
      this.onboardingViewModel.enrich(draft);
      this.onboardingViewModel.updateEditMode(false);
      this.onboardingViewModel.selectDecoration(draft.decorationType);
      return this.$router.push("/depot-de-dossier/informations");
    }
  }

  isAdmin() {
    const currentUser = this.authModule.currentUser;
    return currentUser?.highestRoleLevel && currentUser?.highestRoleLevel >= 1000;
  }
}
</script>


<style lang="scss">
.banner {
  background: #F5F5FE;
  padding: 1rem 8rem;
  text-align: left;
  .title {
    font-size: 3rem!important;
  }
  .release-notes {
    margin-top: 2rem;
    margin-bottom: 2rem;
    font-size: 1.3rem;
    white-space : pre-line;
  }
  .success-msg {
    color: #18753C;
  }
}
.draft_header {
  display: flex;
  width: 100% !important;
  margin-bottom: 34px;
  margin-top: 55px;
  justify-content: space-between;
  align-items: center;
  .title {
    font-size: 28px !important;
    font-weight: 700 !important;
    color: #000000;
  }
  .darft_text {
    color: #000091;
    margin-top: -5px;
    font-size: 16px !important;
    font-weight: 500;
    line-height: 24px;
  }
}

.home {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
  padding: 1rem 8rem;
}

.draft {
  width: 100%;
}

.darft_text {
  color: #000091;
  margin-top: -5px;
  font-size: 16px !important;
  font-weight: 500;
  line-height: 24px;
}
</style>

```

</details>


---

### 📄 `src/modules/home/screens/LegalMentions.vue` [799 octets]
<a id="src-modules-home-screens-LegalMentions-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-home-screens-LegalMentions-vue)

> **Chemin relatif** : `src/modules/home/screens/LegalMentions.vue`  
> **Taille** : 799 octets  
> **Lignes** : 38  
> **Type** : text

```text
<template>
  <div class="container mention-legal">
    <h1>Mentions légales</h1>
    <h2 class="mt-5">Informations générales</h2>
    <div class="mt-6">
      <p>
        Intrapreneure : Anne-Lise Gaillot-Bechara (Bureau des Cabinets)
      </p>
      <p>
        Chef de produit : Timothée Pizzuti (Direction du Numérique)
      </p>
      <p>
        UX Design : Camille Cohignac et Mélanie Wright (Ipsoon)
      </p>
      <p>
        Développement : Chalom Ellezam et Mazen Dkhil (Octo/Malt)
      </p>
    </div>
  </div>

</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";

@Component
export default class LegalMentions extends Vue {

}
</script>
<style lang="scss">
.mention-legal {
  text-align: left;
  padding: 2rem 4rem;
}
</style>

```


---

### 📄 `src/modules/home/screens/Privacy.vue` [1.061 octets]
<a id="src-modules-home-screens-Privacy-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-home-screens-Privacy-vue)

> **Chemin relatif** : `src/modules/home/screens/Privacy.vue`  
> **Taille** : 1.061 octets  
> **Lignes** : 33  
> **Type** : text

```text
<template>
  <div class="container privacy">
    <h1>Hébergement</h1>
    <h2 class="mt-5">La Direction du Numérique</h2>
    <h3 class="mt-3">Données à caractère personnel</h3>
    <div class="mt-6">
      <p>
        En application des articles 22 et 23 de la loi n° 78-17 du 6 janvier 1978 modifiée relative à l'informatique, aux fichiers et aux libertés, l'application fait l'objet d'une déclaration auprès de la Commission Nationale de l'Informatique et des Libertés (CNIL).
      </p>
      <p>
        En application des articles 38, 39 et 40 de cette même loi, vous disposez, gratuitement, d'un droit d'accès, de rectification et d'opposition, aux données qui vous concernent. Si vous souhaitez exercer ce droit, reportez-vous à notre rubrique contact.
      </p>
    </div>
  </div>

</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";

@Component
export default class Privacy extends Vue {

}
</script>
<style lang="scss">
.privacy {
  text-align: left;
  padding: 2rem 4rem;
}
</style>

```


---

### 📄 `src/modules/onBoarding/components/DateBox.vue` [960 octets]
<a id="src-modules-onBoarding-components-DateBox-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-components-DateBox-vue)

> **Chemin relatif** : `src/modules/onBoarding/components/DateBox.vue`  
> **Taille** : 960 octets  
> **Lignes** : 49  
> **Type** : text

```text
<template>
  <div class="datebox">
    <p class="mb-0 title-datebox">{{ title }}</p>
    <p class="count">{{count}}</p>
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import { mdiInformation, mdiClose } from '@mdi/js';
import {Prop} from "vue-property-decorator";
@Component
export default class DateBox extends Vue {

  @Prop({required: true})
  declare count: string;

  @Prop({required: true})
  declare title: string;

}
</script>

<style lang="scss">
.datebox {
  background: #F5F5FE;
  width: 250px;
  text-align: center;
  display: flex;
  justify-content: center;
  flex-direction: column;
  align-items: center;
  height: 180px;
  box-shadow: 0px 2px 6px 0px #00001229;
  .title-datebox {
    font-weight: 400!important;
    font-size: 20px!important;
  }
  .count {
    font-size: 5rem;
    margin-bottom: 0;
    line-height: 1.1;
    color: #000091;
    font-weight: 500;
  }
}
</style>

```


---

### 📄 `src/modules/onBoarding/components/DraggableFile.vue` [2.661 octets]
<a id="src-modules-onBoarding-components-DraggableFile-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-components-DraggableFile-vue)

> **Chemin relatif** : `src/modules/onBoarding/components/DraggableFile.vue`  
> **Taille** : 2.661 octets  
> **Lignes** : 103  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (103 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <div
      @drop="onDrop($event)"
      class="dropzone pt-5 pb-5"
      @dragover.prevent
      ref="dropzone"
      @dragenter.prevent
  >
    <div v-if="progress === 0">
      <img alt="" :src="documentImg" style="margin-left: 5px;" />
      <div class="dropzone-message">
        Taille maximale : 10 Mo. Formats supportés : jpg, png, pdf.
      </div>
      <v-btn class="mt-3" @click="onInputFileClick(inputRef)">
        Importer
      </v-btn>
    </div>
    <div v-if="progress > 0 || progress === 100" style="display: flex; width: 80%; margin: 0 auto; justify-content: center; align-items: center; flex-direction: column; height: 162px">
      <div class="mb-2" style="align-self: flex-start;display: flex; justify-content: space-between; width: 100%;align-items: center;">
        <p>Progression</p>
        <p>{{ Math.round(progress) }} %</p>
      </div>
      <v-progress-linear background-color="#F0F2F5" color="#1269ED" rounded height="15" :value="progress"></v-progress-linear>
    </div>
    <input
        accept="application/pdf, image/jpeg, image/jpg, image/png"
        @change="onUploadFile"
        type="file"
        :ref="inputRef"
        hidden
    />
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import documentDownload from "../../../assets/documentDownload.png"
import {Prop} from "vue-property-decorator";
@Component
export default class DraggableFile extends Vue {

  documentImg = documentDownload

  @Prop({required: true})
  declare inputRef: string;

  @Prop({required: false})
  declare progress: number


  @Prop({required: true})
  declare onFileChange: (file: File) => Promise<void>

  acceptedFile = ["application/pdf", "image/jpeg", "image/jpg", "image/png"]

  dropping = false;

  onDrop(event: any) {
    event.preventDefault();
    const file = event.dataTransfer.files[0];
    if (file && this.acceptedFile.includes(file.type)) {
      return this.onFileChange(file)
    }
  }

  onUploadFile(event: any) {
    event.preventDefault();
    const file = event.target.files[0]
    if (file) {
      return this.onFileChange(file)
    }
  }

  onInputFileClick(ref: string) {
    const fileInputElement = this.$refs[ref];
    if (fileInputElement) {
      // eslint-disable-next-line @typescript-eslint/ban-ts-comment
      // @ts-ignore
      fileInputElement.click();
      return;
    }
  }

}
</script>

<style lang="scss">
.dropping {
  background-color: #20209f;
  color: #fff;
  transition: 500ms all ease-in-out;
}
.dropzone {
  text-align: center;
  border: 2px dashed #dddddd!important;
  img {
    width: 70px;
  }
}

</style>

```

</details>


---

### 📄 `src/modules/onBoarding/components/help/activityArea/ActivityAreaHelpDialog.vue` [1.955 octets]
<a id="src-modules-onBoarding-components-help-activityArea-ActivityAreaHelpDialog-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-components-help-activityArea-ActivityAreaHelpDialog-vue)

> **Chemin relatif** : `src/modules/onBoarding/components/help/activityArea/ActivityAreaHelpDialog.vue`  
> **Taille** : 1.955 octets  
> **Lignes** : 89  
> **Type** : text

```text
<template>
  <alert
    :open="open"
    :with-confirmation="false"
    :on-close="onClose"
  >
    <template v-slot:title>
      <h2 class="pb-3">
        <v-icon large style="margin-bottom: 5px; color: #161616">
          {{arrowRight}}
        </v-icon>
        <span>Comment choisir le secteur d'activité ?</span>
      </h2>
    </template>
    <template v-slot:message>
      <administrative-help-content v-if="contingentType === 'C'"/>
      <civil-help-content v-if="contingentType === 'A'" />
    </template>

  </alert>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import Alert from "@/components/Alert.vue";
import { mdiArrowRight } from "@mdi/js";
import {Prop} from "vue-property-decorator";
import AdministrativeHelpContent from "@/modules/onBoarding/components/help/activityArea/AdministrativeHelpContent.vue";
import CivilHelpContent from "@/modules/onBoarding/components/help/activityArea/CivilHelpContent.vue";

@Component({
  components: {
    Alert,
    AdministrativeHelpContent,
    CivilHelpContent
  }
})
export default class ActivityAreaHelpDialog extends Vue {
  arrowRight = mdiArrowRight;

  @Prop({required: false, default: false})
  declare open: boolean;

  @Prop({required: false, default: false})
  declare onClose: Function;

  @Prop({required: true})
  declare contingentType: string;
}
</script>

<style lang="scss">
.box {
  border: 1px solid #0063CB;
  display: flex;
  position: relative;
  .box-icon-container {
    padding-left: 5px;
    padding-right: 5px;
    span {
      margin-top: 14px;
      color: white;
    }
    background: #0063CB;
  }
  .text-container {
    padding: 14px;
    h4 {
      font-size: 20px;
      font-weight: 500;
      color: #161616;
    }
    p {
      margin-top: 10px;
    }
  }
  .close-btn {
    position: absolute;
    right: 10px;
    top: 5px;
    cursor: pointer;
    span {
      color: #000091;
    }
  }
}
</style>

```


---

### 📄 `src/modules/onBoarding/components/help/activityArea/AdministrativeHelpContent.vue` [7.188 octets]
<a id="src-modules-onBoarding-components-help-activityArea-AdministrativeHelpContent-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-components-help-activityArea-AdministrativeHelpContent-vue)

> **Chemin relatif** : `src/modules/onBoarding/components/help/activityArea/AdministrativeHelpContent.vue`  
> **Taille** : 7.188 octets  
> **Lignes** : 173  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (173 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <div>
    <p>
      Personnes qui se sont distinguées pour le développement et le rayonnement des activités maritimes
    </p>

    <div class="activity_section">
      <p>
        <span class="underline">
          Administration - Service de santé
        </span>
      </p>
      <p>
        (?) Personnel non navigant (douaniers, pompiers, policiers...), personnel des administrations, des préfectures, des ambassades et consulats, personnels des ports, des phares et balises, de la météorologie, des services départementaux d'incendie et de secours (SDIS), syndic des gens de mer, ... Médecin, pharmacien et autre profession de santé, personnel des services d’hygiène alimentaire
      </p>
    </div>

    <div class="activity_section">
      <p>
        <span class="underline">
          Armement (commerce - pêche) - Pilotage
        </span>
      </p>
      <p>
        (?) Cadre et employé des sociétés d’armement, Toute personne concourant à l’organisation ou au fonctionnement des services de pilotage
      </p>
    </div>

    <div class="activity_section">
      <p>
        <span class="underline">
          Associations maritimes - Elus - Organisations professionnelles et syndicales
        </span>
      </p>
      <p>
        (?) Membre d’associations à but non lucratif (ex : Société nationale de sauvetage en mer, Fédération du Mérite maritime, Association des pensionnés de la marine marchande, Fédération des anciens marins et des marins anciens combattants, Surfrider...), du service social maritime, d'une chambre arbitrale maritime, … Élus excepté les membres des assemblées parlementaires qui ne peuvent être nommés ou promus pendant la durée de leur mandat (art. 17 du décret no 63-1196 du 3 décembre 1963, ordre national du Mérite, applicable aux ordres ministériels). Membre de comités de pêches, de comité interprofessionnels de la conchyliculture, d’organisations de producteurs, de coopératives maritimes, de prud’homies de pêche, de groupements, d’organisations syndicales et syndicats professionnels, personnel des chambres de commerce et d’industrie (Fédération des industries nautiques, Institut français de la mer, Cluster maritime français...)
      </p>
    </div>

    <div class="activity_section">
      <p>
        <span class="underline">
          Construction navale
        </span>
      </p>
      <p>
        (?) Personnel des ateliers et entreprises de construction de navires et bâtiments de navigation (ex : chantiers de l’Atlantique, Beneteau...) ; Personnel concourant à la réalisation des bâtiments de mer (architectes navals, charpentiers de marine...)
      </p>
    </div>

    <div class="activity_section">
      <p>
        <span class="underline">
          Cultures marines – Commercialisation des produits de la mer
        </span>
      </p>
      <p>
        (?) Conchyliculteur, aquaculteur, ostréiculteur, mytiliculteur et toute personne participant au marché, à la transformation ou à la vente des produits de la mer (mareyeur, conserveur, surgélateur, saleur, saurisseur...)
      </p>
    </div>

    <div class="activity_section">
      <p>
        <span class="underline">
          Environnement - Recherche - Enseignement supérieur - Éducation maritime
        </span>
      </p>
      <p>
        (?) Personnel scientifique contribuant à la recherche océanographique, géologique, biologique, et toute personne concourant à la protection du littoral ; recherche scientifique marine ;
        Toute personne contribuant au secteur de l'économie de la mer, au droit maritime,
        Directeur, professeur de l’enseignement maritime, professeur, personnel des écoles (École nationale supérieure maritime et ses centres, lycée professionnel maritime, lycée d’enseignement maritime et aquacole, lycée de la mer et du littoral, lycée des métiers de la mer...), formateur professionnel, examinateur de permis plaisance
      </p>
    </div>

    <div class="activity_section">
      <p>
        <span class="underline">
          Patrimoine culturel maritime – Communication
        </span>
      </p>
      <p>
        (?) Conservateur de musées, écrivain, journaliste, historien maritime, conférencier et toute personne concourant au développement du patrimoine culturel maritime
      </p>
    </div>

    <div class="activity_section">
      <p>
        <span class="underline">
         Plaisance – Sport – Tourisme
        </span>
      </p>
      <p>
        (?) Membre de yacht club, de club ou de société nautique, organisateur de salon ou de manifestation nautique, membre de sociétés de tourisme ou de sport nautique
      </p>
    </div>

    <div class="activity_section">
      <p>
        <span class="underline">
         Sécurité et sûreté maritimes - Spécialités portuaires
        </span>
      </p>
      <p>
        (?) Toute personne concourant à la sécurité des navires et de la navigation ainsi qu’à la sûreté maritime notamment : officier, inspecteur de la navigation, inspecteur mécanicien, technicien expert du service de sécurité de la navigation maritime, contrôleur branche technique des centres de sécurité, agents du bureau Véritas, des sociétés de classification, ingénieurs civils... Personnel de direction et d’encadrement des services portuaires, officier de port, agent portuaire, agent maritime, consignataire …
      </p>
    </div>

    <div class="activity_section">
      <p>
        <span class="underline">
         Services maritimes
        </span>
      </p>
      <p>
        (?) Personnel des compagnies d’assurance, personnel des banques, courtier, expert près les tribunaux, expert privé (ex : bureau Véritas...), avocat maritimiste, …,  Personnel de l’industrie pétrolière et gazière maritime, des entreprises spécialisées dans les exploitations techniques, … Personnel concourant à la conception de logiciel et d’outils informatiques maritimes, personnel d’entreprises intervenant dans la conception et la pose de câble sous-marin ; Personnel des entreprises d’exploitation des énergies marines et des entreprises de conception, de fabrication, d’installation et de maintenance pour les énergies marines renouvelables…
      </p>
    </div>

  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import Alert from "@/components/Alert.vue";

@Component({
  components: {
    Alert
  }
})
export default class AdministrativeHelpContent extends Vue {

}
</script>

<style lang="scss">
.box {
  border: 1px solid #0063CB;
  display: flex;
  position: relative;
  .box-icon-container {
    padding-left: 5px;
    padding-right: 5px;
    span {
      margin-top: 14px;
      color: white;
    }
    background: #0063CB;
  }
  .text-container {
    padding: 14px;
    h4 {
      font-size: 20px;
      font-weight: 500;
      color: #161616;
    }
    p {
      margin-top: 10px;
    }
  }
  .close-btn {
    position: absolute;
    right: 10px;
    top: 5px;
    cursor: pointer;
    span {
      color: #000091;
    }
  }
}
</style>

```

</details>


---

### 📄 `src/modules/onBoarding/components/help/activityArea/CivilHelpContent.vue` [3.358 octets]
<a id="src-modules-onBoarding-components-help-activityArea-CivilHelpContent-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-components-help-activityArea-CivilHelpContent-vue)

> **Chemin relatif** : `src/modules/onBoarding/components/help/activityArea/CivilHelpContent.vue`  
> **Taille** : 3.358 octets  
> **Lignes** : 107  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (107 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <div>
    <p>Un candidat est présenté au titre de ce contingent s'il peut se prévaloir de 6 ans de navigation au minimum, et si la navigation a été son activité dominante.</p>

    <div class="activity_section">
      <p><span class="underline">Administration</span></p>
      <p>
        (?) Fonctionnaire des affaires maritimes embarqué (administrateur des affaires maritimes, officier du corps technique et administratif des affaires maritimes, contrôleur), des douanes embarqué, de la sécurité civile embarqué, de la police aux frontières embarqué
      </p>
    </div>

    <div class="activity_section">
      <p>
        <span class="underline">
          Anciens Navigants
        </span>
      </p>
      <p>
        (?) Toute personne exerçant une autre fonction dans le domaine maritime, après une activité dominante de navigation (exemple : un ancien chef mécanicien -37 ans mer- devenu responsable d'une association maritime)
      </p>
    </div>

    <div class="activity_section">
      <p>
        <span class="underline">
          Armement (commerce - pêche) – Services – Pilotage – Plaisance
        </span>
      </p>
      <p>
        (?) Personnel embarqué des sociétés d’armement, Capitaine, Officier (second capitaine, chef mécanicien, capitaine de pêche, patron de pêche, …), Tout membre d’équipage (maître d’équipage, matelot, agent du service général, cuisinier...), Capitaine de remorqueur, Pilote et membre d’équipage de bateau pilote, Patron plaisance (voile), capitaine de navire à utilisation collective, marin plaisancier professionnel
      </p>
    </div>

    <div class="activity_section">
      <p>
        <span class="underline">
          Associations maritimes - Organisations professionnelles et syndicales
        </span>
      </p>
      <p>
        (?) Membre d’associations à but non lucratif, (ex : société nationale de sauvetage en mer, fédération du Mérite maritime, association des pensionnés de la marine marchande, fédération des anciens marins et des marins anciens combattants, …) ; Membre de comités des pêches, comités interprofessionnels de la conchyliculture, d'organisations de producteurs, de coopératives maritimes, de prud’homies de pêche, de groupements, organisations syndicales et syndicats professionnels, …
      </p>
    </div>

    <div class="activity_section">
      <p>
        <span class="underline">
          Sports nautiques
        </span>
      </p>
    </div>

  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import Alert from "@/components/Alert.vue";

@Component({
  components: {
    Alert
  }
})
export default class CivilHelpContent extends Vue {

}
</script>

<style lang="scss">
.box {
  border: 1px solid #0063CB;
  display: flex;
  position: relative;
  .box-icon-container {
    padding-left: 5px;
    padding-right: 5px;
    span {
      margin-top: 14px;
      color: white;
    }
    background: #0063CB;
  }
  .text-container {
    padding: 14px;
    h4 {
      font-size: 20px;
      font-weight: 500;
      color: #161616;
    }
    p {
      margin-top: 10px;
    }
  }
  .close-btn {
    position: absolute;
    right: 10px;
    top: 5px;
    cursor: pointer;
    span {
      color: #000091;
    }
  }
}
</style>

```

</details>


---

### 📄 `src/modules/onBoarding/components/help/ContingentTypeDialog.vue` [3.500 octets]
<a id="src-modules-onBoarding-components-help-ContingentTypeDialog-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-components-help-ContingentTypeDialog-vue)

> **Chemin relatif** : `src/modules/onBoarding/components/help/ContingentTypeDialog.vue`  
> **Taille** : 3.500 octets  
> **Lignes** : 101  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (101 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <alert
    :open="open"
    :with-confirmation="false"
    :on-close="onClose"
  >
    <template v-slot:title>
      <h2 class="pb-3">
        <v-icon large style="margin-bottom: 5px; color: #161616">
          {{arrowRight}}
        </v-icon>
        <span>Comment choisir le contingent ?</span>
      </h2>
    </template>
    <template v-slot:message>
      <p>
          <span class="bolder">
            Contingent A :
          </span>
        personnel navigant de la marine marchande, des administrations civiles de l'Etatet des équipages des canots de sauvetage de toute société agréée par l'Etat, les personnes s'étant distinguées dans le domaine des sports nautiques
      </p>
      <p>
        <span class="bolder">Contingent B :</span> personnel militaire du ministère de la défense
      </p>
      <p>
          <span class="bolder">
            Contingent C :
          </span>
        personnes qui se sont distinguées pour le développement et le rayonnement des activités maritimes, notamment dans le domaine de la marine marchande, de la pêche, des cultures marines, de l'administration maritime, des services de santé, des industries (construction navale, énergies maritimes renouvelables, activitésportuaires) et des services liées à la mer, des associations maritimes (élus etorganisations professionnelles et syndicales), de la protection de l'environnement littoral et marin, de la recherche océanographique et maritime, de l'enseignement maritime, de la surveillance et de la sécurité maritime, de l'ingénierie et du conseil maritime, du courtage, de la plaisance, du tourisme maritime, de la préservation et de la valorisation du patrimoine culturel maritime, enfin dans le domaine de la diplomatie maritime.
      </p>
      <p>
          <span class="bolder">
            Contingent E :
          </span>
        étrangers qui se sont signalés par leurs activités ou leurs mérites dans le domaine maritime, notamment ceux qui soutiennent l’action diplomatique de la France dans les instances de coopération maritime internationale. Les étrangers qui résident en France sont soumis aux mêmes conditions que les citoyens français. Ceux qui ne résident pas en France sont dispensés des conditions d’ancienneté et peuventêtre nommés directement dans un grade supérieur à celui de chevalier.
      </p>
    </template>

  </alert>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import Alert from "@/components/Alert.vue";
import { mdiArrowRight } from "@mdi/js";
import {Prop} from "vue-property-decorator";

@Component({
  components: {
    Alert
  }
})
export default class ContingentTypeHelpDialog extends Vue {
  arrowRight = mdiArrowRight;

  @Prop({required: false, default: false})
  declare open: boolean;

  @Prop({required: false, default: false})
  declare onClose: Function;
}
</script>

<style lang="scss">
.box {
  border: 1px solid #0063CB;
  display: flex;
  position: relative;
  .box-icon-container {
    padding-left: 5px;
    padding-right: 5px;
    span {
      margin-top: 14px;
      color: white;
    }
    background: #0063CB;
  }
  .text-container {
    padding: 14px;
    h4 {
      font-size: 20px;
      font-weight: 500;
      color: #161616;
    }
    p {
      margin-top: 10px;
    }
  }
  .close-btn {
    position: absolute;
    right: 10px;
    top: 5px;
    cursor: pointer;
    span {
      color: #000091;
    }
  }
}
</style>

```

</details>


---

### 📄 `src/modules/onBoarding/components/help/GradeHelpDialog.vue` [2.187 octets]
<a id="src-modules-onBoarding-components-help-GradeHelpDialog-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-components-help-GradeHelpDialog-vue)

> **Chemin relatif** : `src/modules/onBoarding/components/help/GradeHelpDialog.vue`  
> **Taille** : 2.187 octets  
> **Lignes** : 103  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (103 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <alert
    :open="open"
    :with-confirmation="false"
    :on-close="onClose"
  >
    <template v-slot:title>
      <h2 class="pb-3">
        <v-icon large style="margin-bottom: 5px; color: #161616">
          {{arrowRight}}
        </v-icon>
        <span>Comment choisir le grade ?</span>
      </h2>
    </template>
    <template v-slot:message>
      <p>
        <span class="bolder">
            Pour être nommé chevalier,
          </span>
        il faut justifier de dix ans au moins de services ou d’activités maritimes
      </p>
      <p>
        <span class="bolder">
          Pour être promu officier,
        </span>
        il faut justifier de cinq ans au moins dans le grade de chevalier
      </p>
      <p>
        <span class="bolder">
          Pour être promu commandeur,
        </span>
        il faut justifier de cinq ans au moins dans le grade d’officier.
      </p>
      <p>
        <span class="bolder">
          Une promotion doit récompenser des mérites nouveaux ou des services exceptionnels.
        </span>
      </p>
    </template>

  </alert>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import Alert from "@/components/Alert.vue";
import { mdiArrowRight } from "@mdi/js";
import {Prop} from "vue-property-decorator";

@Component({
  components: {
    Alert
  }
})
export default class GradeHelpDialog extends Vue {
  arrowRight = mdiArrowRight;

  @Prop({required: false, default: false})
  declare open: boolean;

  @Prop({required: false, default: false})
  declare onClose: Function;
}
</script>

<style lang="scss">
.box {
  border: 1px solid #0063CB;
  display: flex;
  position: relative;
  .box-icon-container {
    padding-left: 5px;
    padding-right: 5px;
    span {
      margin-top: 14px;
      color: white;
    }
    background: #0063CB;
  }
  .text-container {
    padding: 14px;
    h4 {
      font-size: 20px;
      font-weight: 500;
      color: #161616;
    }
    p {
      margin-top: 10px;
    }
  }
  .close-btn {
    position: absolute;
    right: 10px;
    top: 5px;
    cursor: pointer;
    span {
      color: #000091;
    }
  }
}
</style>

```

</details>


---

### 📄 `src/modules/onBoarding/components/LHOnmValidation.vue` [15.601 octets]
<a id="src-modules-onBoarding-components-LHOnmValidation-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-components-LHOnmValidation-vue)

> **Chemin relatif** : `src/modules/onBoarding/components/LHOnmValidation.vue`  
> **Taille** : 15.601 octets  
> **Lignes** : 456  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (456 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <div class="lhonmvalidation">

    <div>
      <div style="display: flex; align-items: center;">
        <img :src="profil" />
        <h3 class="validation-title ml-3">
          Etat civil du candidat
        </h3>
      </div>

      <v-row class="mt-5 mb-3">
        <v-col lg="12" sm="12">
          <p>
            <span class="denomination">Nom :</span> {{ buildName() }}
          </p>
        </v-col>
        <v-col lg="12" sm="12">
          <p>
            <span class="denomination">{{personalInformationViewModel.state.civility === 'MRS' ? "Née" : "Né"}} le :</span> {{ birthDateAndPlace() }}
          </p>
        </v-col>
        <v-col lg="12" sm="12">
          <p>
            <span class="denomination">Domicilié{{personalInformationViewModel.state.civility === 'MRS' ? "e" : ""}}} au :</span> {{address()}}
          </p>
        </v-col>
      </v-row>
    </div>

    <div class="activity-validation">
      <div style="display: flex; align-items: center;">
        <img :src="activity" />
        <h3 class="validation-title ml-3">
          Activité
        </h3>
      </div>

      <v-row class="mt-5 mb-3">
        <v-col lg="6" sm="6">
          <p>
            <span class="denomination">Statut :</span>
            {{activityViewModel.state.status}}
          </p>
        </v-col>
        <v-col lg="6" sm="6">
          <p>
            <span class="denomination">Secteur d'activité :</span>
            {{activityViewModel.state.activityArea}}
          </p>
        </v-col>
        <v-col lg="6" sm="6" >
          <p>
            <span class="denomination">Fonction exercée :</span>
            {{activityViewModel.state.positionHeld}}
          </p>
        </v-col>
        <v-col lg="12" sm="12">
          <p>
            <span class="denomination">Fonction exercée Apparaissant sur le décret :</span>
            {{activityViewModel.state.positionHeldOnDecree}}
          </p>
        </v-col>
        <v-col lg="6" sm="6">
          <p>
            <span v-if="trainingInformationViewModel.trainingInformationState" class="denomination">Grade obtenu :</span>
            {{trainingInformationViewModel.trainingInformationState.previousGrade}}
          </p>
        </v-col>
        <v-col lg="6" sm="6">
          <p>
            <span v-if="trainingInformationViewModel.trainingInformationState" class="denomination">Décoration :</span>
            {{getDistinctionDetail().name}}
          </p>
        </v-col>
        <v-col lg="6" sm="6">
          <p>
            <span class="denomination">Date de prise de rang :</span>
            {{getDistinctionDetail().rankTakingDate}}
          </p>
        </v-col>
        <v-col lg="6" sm="6">
          <p>
            <span class="denomination">Date de décret :</span>
            {{getDistinctionDetail().decreeDate}}
          </p>
        </v-col>
      </v-row>

      <div v-if="activityViewModel.recommandants.length > 0" class="mt-3 mb-8" style="display: flex; align-items: center;">
        <img :src="parent" />
        <p class="ml-3 denomination">
          Recommandant
        </p>
      </div>
      <v-row
        v-for="item of activityViewModel.recommandants"
        v-bind:key="item.id"
        class="mb-3"
      >
        <v-col
          cols="6"
          sm="6"
          class="pt-0 pb-0">
          <p><span style="font-weight: 600">Recommandant :</span> <span>{{item.firstname}} {{item.lastname.toUpperCase()}}</span></p>
        </v-col>
        <v-col
          cols="4"
          sm="4"
          class="pt-0 pb-0">
          <p>Organisme: {{item.companyName}}</p>
        </v-col>
      </v-row>
    </div>

    <div>
      <div style="display: flex; align-items: center;">
        <img :src="medal" style="width: 35px" />
        <h3 class="validation-title ml-3">
          Grade demandé et annuités générales
        </h3>
      </div>
      <v-row class="mt-5 mb-3">
        <v-col lg="6" sm="6">
          <p>
            <span class="denomination">Promotion :</span>
            {{getPromotionName()}}
          </p>
        </v-col>
        <v-col lg="6" sm="6">
          <p>
            <span class="denomination">Cabinet :</span>
            {{annuityViewModel.state.office}}
          </p>
        </v-col>
        <v-col lg="6" sm="6">
          <p>
            <span class="denomination">Grade proposé :</span>
            {{annuityViewModel.state.grade}}
          </p>
        </v-col>
        <v-col lg="6" sm="6">
          <p>
            <span class="denomination">Date de début :</span>
            {{dayjs(annuityViewModel.state.startDate).format('DD/MM/YYYY')}}
          </p>
        </v-col>
        <v-col v-if="annuityViewModel.state.previousGrade" lg="6" sm="6">
          <p>
            <span class="denomination">Grade précédent :</span>
            {{annuityViewModel.state.previousGrade}}
          </p>
        </v-col>
        <v-col v-if="annuityViewModel.state.rankTakingDate" lg="6" sm="6">
          <p>
            <span class="denomination">Date de prise de rang :</span>
            {{dayjs(annuityViewModel.state.rankTakingDate).format('DD/MM/YYYY')}}
          </p>
        </v-col>
      </v-row>

      <div class="mt-10" style="display: flex; align-items: center;">
        <img :src="stats" />
        <p class="ml-3 denomination">Total services effectués</p>
      </div>
      <div style="display: flex" class="mt-10">
        <div class="mr-5">
          <date-box
              :count="isNaN(dayjs().diff(annuityViewModel.state.startDate)) ? '0' : Math.floor(dayjs().diff(annuityViewModel.state.startDate) / (1000 * 60 * 60 * 24 * 365)).toString()"
              title="Années"
          />
        </div>
        <div class="mr-5">
          <date-box
              :count="isNaN(dayjs().diff(annuityViewModel.state.startDate)) ? '0' : Math.floor((dayjs().diff(annuityViewModel.state.startDate) % (1000 * 60 * 60 * 24 * 365)) / (1000 * 60 * 60 * 24 * 30.4375)).toString()"
              title="Mois"
          />
        </div>

        <div>
          <date-box
              :count="isNaN(dayjs().diff(annuityViewModel.state.startDate)) ? '0' : Math.floor((dayjs().diff(annuityViewModel.state.startDate) % (1000 * 60 * 60 * 24 * 365)) % (1000 * 60 * 60 * 24 * 30.4375) / (1000 * 60 * 60 * 24)).toString()"
              title="Jours"
          />
        </div>
      </div>
    </div>

    <div class="mt-10 mb-3">
      <div style="display: flex; align-items: center;">
        <img :src="documents" />
        <h3 class="validation-title ml-3">
          Documents déposés
        </h3>
      </div>
      <div class="mt-5 mb-5">
        <p class="mb-5">
          <span class="denomination">Casier judiciaire :</span>
          <a :href="documentViewModel.state.criminalRecordFileName.link" download target="_blank">
            {{ documentViewModel.state.criminalRecordFileName.name }}
          </a>
        </p>

        <p class="mb-5">
          <span class="denomination">Acte de naissance :</span>
          <a v-if="documentViewModel.state.birthCertificate.name !== ''" :href="documentViewModel.state.birthCertificate.link" download target="_blank">
            {{ documentViewModel.state.birthCertificate.name }}
          </a>
        </p>

        <p class="mb-5" >
          <span class="denomination">CV :</span>
          <a v-if="documentViewModel.state.resumeFileName.name !== ''" :href="documentViewModel.state.resumeFileName.link" download target="_blank">
            {{ this.documentViewModel.state.resumeFileName.name }}
          </a>
        </p>

        <p class="mb-5" >
          <span class="denomination">Avis préfet :</span>
          <a v-if="this.documentViewModel.state.prefectFileName.name !== ''" :href="documentViewModel.state.prefectFileName.link" download target="_blank">
            {{ documentViewModel.state.prefectFileName.name }}
          </a>
        </p>

        <p class="denomination" v-if="documentViewModel.state.otherFiles.length > 0">Autres documents :</p>
        <p v-for="file in documentViewModel.state.otherFiles" v-bind:key="file.id">
          <a :href="file.link" download target="_blank">
            {{ file.name }}
          </a>
        </p>
      </div>
    </div>

    <v-row class="pt-10 justify-space-between">
      <div class="pl-3">
        <v-btn outlined color="primary" @click="goBack">
          <v-icon small style="margin-top: 3px"> {{ chevronLeft }} </v-icon>Retour
        </v-btn>
      </div>
      <div style="display: flex; align-items: center">
        <div style="display: flex;align-items: center;">
          <div class="pr-3">
            <v-btn v-if="onBoardingViewModel.editMode === false" outlined color="primary" @click="returnToDraft">
              <v-icon small style="margin-top: 3px; margin-right: 5px"> {{ contentSave }} </v-icon>Garder en brouillon
            </v-btn>
          </div>
          <div class="pr-3">
            <v-btn v-if="onBoardingViewModel.editMode === false" color="primary" @click="goNext">
              Envoyer ...&nbsp;<v-img alt="" :aspect-ratio="1" :src="arrowSend" />
            </v-btn>

            <v-btn v-if="onBoardingViewModel.editMode === true" color="primary" @click="goNext">
              Valider la modification&nbsp; <v-img alt="" style="margin-left: 5px" :aspect-ratio="1" :src="arrowSend" />
            </v-btn>
          </div>
        </div>
      </div>
    </v-row>
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import {Civility} from "@/modules/onBoarding/types/Civility";
import {lazyInject} from "@pasta/box";
import {
  PersonalInformationViewModel
} from "@/modules/onBoarding/viewModels/personalInformation/PersonalInformationViewModel";
import dayjs from "dayjs";
import {ActivityViewModel} from "@/modules/onBoarding/viewModels/activity/ActivityViewModel";
import {AnnuityViewModel} from "@/modules/onBoarding/viewModels/annuity/AnnuityViewModel";
import DateBox from "@/modules/onBoarding/components/DateBox.vue";
import {DocumentType} from "@/core/types/documents/DocumentType";
import {DocumentViewModel} from "@/modules/onBoarding/viewModels/documents/DocumentViewModel";
import {OnBoardingStepIndex, OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {mdiChevronLeft, mdiContentSaveOutline} from "@mdi/js";
import arrowSend from "../../../assets/arrow_send.svg";
import activity from "../../../assets/activity.png";
import profil from "../../../assets/profil.png";
import medal from "../../../assets/medal.png";
import stats from "../../../assets/pie-chart-2.png";
import documents from "../../../assets/file-add.png";
import parent from "../../../assets/parent.png";


import {OnBoardingPath} from "@/modules/onBoarding/navigation/OnBoardingPath";
import {TrainingInformationViewModel} from "@/modules/onBoarding/viewModels/training/TrainingInformationViewModel";
import {HomeViewModel} from "@/modules/home/viewModels/HomeViewModel";
import {AuthModule} from "@pasta/front-auth";

@Component({
  computed: {
    dayjs() {
      return dayjs
    }
  },
  components: {DateBox}
})
export default class LHOnmValidation extends Vue {

  @lazyInject(PersonalInformationViewModel)
  declare personalInformationViewModel: PersonalInformationViewModel

  @lazyInject(ActivityViewModel)
  declare activityViewModel: ActivityViewModel;

  @lazyInject(OnBoardingViewModel)
  declare onBoardingViewModel: OnBoardingViewModel;

  @lazyInject(AnnuityViewModel)
  declare annuityViewModel: AnnuityViewModel;

  @lazyInject(TrainingInformationViewModel)
  declare trainingInformationViewModel: TrainingInformationViewModel;

  @lazyInject(DocumentViewModel)
  declare documentViewModel: DocumentViewModel;

  @lazyInject(HomeViewModel)
  declare homeViewModel: HomeViewModel;

  @lazyInject(AuthModule)
  declare authModule: AuthModule;


  arrowSend = arrowSend;
  activity = activity;
  profil = profil;
  medal = medal;
  stats = stats;
  parent = parent;
  documents = documents;
  chevronLeft = mdiChevronLeft;
  contentSave = mdiContentSaveOutline;

  buildName() {
    const state = this.personalInformationViewModel.state;
    return `
     ${state.civility === "MR" ? "M" : "Mme"} ${state.firstName} ${state.birthName} ${state.legalName ? `Ep. ${state.legalName}` : ''}
    `;
  }

  birthDateAndPlace() {
    const state = this.personalInformationViewModel.state;
    if (!state.birthDate) {
      return ""
    }
    return `
      ${dayjs(state.birthDate).format("LL")} à ${
        state.birthCity.toUpperCase()
    }
    `;
  }
  goBack() {
    this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.DOCUMENTS);
    this.$router.push(OnBoardingPath.DOCUMENTS);
  }
  async goNext() {
    if (this.onBoardingViewModel.editMode) {
      await this.$router.push('/mes-dossiers/details');
      return;
    }
    await this.personalInformationViewModel.submitPresentation();
    const user = this.authModule.currentUser;
    const entityId = user?.groups ? user.groups[0].id : null;
    if (entityId) {
      await this.onBoardingViewModel.addNote({
        entityId: entityId.toString(),
        action: "liste",
        comment: "",
        folderId: this.personalInformationViewModel.presentationId,
        applicantId: this.personalInformationViewModel.applicantId,
      })
    }

    this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.SUCCESS);
    return this.$router.push(OnBoardingPath.SUCCESS);
  }

  returnToDraft() {
    this.onBoardingViewModel.clearAll();
    return this.$router.push("/");
  }

  getPromotionName() {
    const promotion = this.homeViewModel.sessions.find(elem => elem.id === this.annuityViewModel.state.sessionId)
    if (promotion) {
      return promotion.name
    }
    return ""
  }

  address() {
    const state = this.personalInformationViewModel.state;
    return `
      ${state.rawAddress.rawValue}
    `;
  }

  getDistinctionDetail() {
    if (this.trainingInformationViewModel.trainingInformationState.distinction) {
      return {
        name: this.trainingInformationViewModel.trainingInformationState.distinction.name,
        decreeDate: dayjs(this.trainingInformationViewModel.trainingInformationState.distinction.decretDate).format(
            "DD/MM/YYYY"
        ),
        rankTakingDate:
            this.trainingInformationViewModel.trainingInformationState.distinction.rankTakingDate == ""
                ? null
                : dayjs(this.trainingInformationViewModel.trainingInformationState.distinction.rankTakingDate).format(
                    "DD/MM/YYYY"
                ),
      };
    }
    return {
      name: "",
      decreeDate: "",
      rankTakingDate: "",
    };
  }

  async mounted() {
    await this.documentViewModel.getDocumentLink(DocumentType.CRIMINAL_RECORD);
    await this.documentViewModel.getDocumentLink(DocumentType.RESUME);
    await this.documentViewModel.getDocumentLink(DocumentType.PREFECT_OPINION);
    await this.documentViewModel.getDocumentLink(DocumentType.BIRTH_CERTIFICATE)
    for (const file of this.documentViewModel.state.otherFiles) {
      await this.documentViewModel.getDocumentLink(DocumentType.OTHER);
    }
  }
}
</script>

<style lang="scss">
.lhonmvalidation {
  .validation-title {
    font-size: 30px;
    font-weight: 500;
  }
  .validation-subtitle {
    font-size: 20px;
    font-weight: 500;
    text-transform: uppercase;
  }
  .denomination {
    font-weight: 700;
    text-transform: uppercase;
  }
  p {
    margin-bottom: 0;
    font-size: 15px;
  }
}
</style>

````

</details>


---

### 📄 `src/modules/onBoarding/components/MMValidation.vue` [20.304 octets]
<a id="src-modules-onBoarding-components-MMValidation-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-components-MMValidation-vue)

> **Chemin relatif** : `src/modules/onBoarding/components/MMValidation.vue`  
> **Taille** : 20.304 octets  
> **Lignes** : 501  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (501 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <div>
    <v-form class="civilRecord" ref="civilRecordForm" style="position: relative;">
      <v-container id="print-folder">
        <v-row>
          <v-col cols="12" sm="12" class="pt-0 pl-0">
            <h2>Synthèse du dossier</h2>
          </v-col>
          <v-col cols="12" sm="12" class="pt-1 pl-0">
            <div>
              <p class="subtitleValidation pb-2">Etat civil du candidat :</p>
              {{ this.buildName() }}
              <p class="content">
                {{ this.birthDateAndPlace() }}
              </p>
              <p class="content">
                {{ this.address() }}
              </p>
              <v-divider class="mb-10 mt-10" />
            </div>
            <div v-if="this.trainingInformationViewModel.trainingInformationState.quarter != null">
              <p class="subtitleValidation pt-2 pb-2">Parcours du candidat :</p>
              <span class="nameType">Quartier :</span>
              {{ this.trainingInformationViewModel.trainingInformationState.quarter }}
              <p class="content" v-if="this.trainingInformationViewModel.trainingInformationState.certificate != null">
                <span class="nameType">Brevet :</span>
                {{ this.trainingInformationViewModel.trainingInformationState.certificate }}
              </p>
              <p
                  class="content"
                  v-if="this.trainingInformationViewModel.trainingInformationState.quarterLicenseNumber != null"
              >
                <span class="nameType">Numéro de marin :</span>
                {{ this.trainingInformationViewModel.trainingInformationState.quarterLicenseNumber }}
              </p>
              <div v-if="this.trainingInformationViewModel.trainingInformationState.alreadyDecorated">
                <p class="content">
                  <span class="nameType">Distinction reçue :</span> {{ getDistinctionDetail().name }}
                </p>
                <p class="content">
                  <span class="nameType">Date de décret :</span> {{ getDistinctionDetail().decreeDate }}
                </p>
                <p class="content" v-if="getDistinctionDetail().rankTakingDate != null">
                  <span class="nameType">Prise de rang le </span> {{ getDistinctionDetail().rankTakingDate }}
                </p>
              </div>
              <v-divider class="mb-10 mt-10" />
            </div>
            <div>
              <p class="subtitleValidation pt-2 pb-2">Grade demandé :</p>
              <span class="nameType">Contingent :</span> {{ this.demandInformationViewModel.state.contingentType }}
              <p>
                <span class="nameType">Grade :</span> {{ this.demandInformationViewModel.state.grade }}
              </p>

              <p>
                <span class="nameType">Motif de la décoration :</span> {{ reasonGradeProposal }} {{ reasonGradeProposal === "dérogation application de l'article 11" ? `- ${demandInformationViewModel.state.reasonForExceptionalFact}` : ''}}
              </p>

              <div
                  v-if="
                  this.demandInformationViewModel.state.contingentType === 'A' &&
                  this.demandInformationViewModel.state.reasonGradeProposal === 'duration'
                "
              >
                <p>
                  <span class="nameType">Durée de navigation à titre civil :</span>
                  {{ civilContingentWithDuration().civilDuration }}
                </p>
                <p>
                  <span class="nameType">Durée de navigation à titre militaire :</span>
                  {{ civilContingentWithDuration().militaryDuration }}
                </p>
                <p>
                  <span class="nameType">Durée autre activité :</span> {{ civilContingentWithDuration().otherDuration }}
                </p>
              </div>
              <div
                  v-if="
                  ['B', 'C', 'E'].includes(this.demandInformationViewModel.state.contingentType) &&
                  this.demandInformationViewModel.state.reasonGradeProposal === 'duration'
                "
              >
                <p>
                  <span class="nameType">Durée des activités dans le domaine maritime :</span>
                  {{ this.demandInformationViewModel.state.maritimeActivityDuration }}
                </p>
              </div>
              <p v-if="['A', 'C', 'B', 'E'].includes(this.demandInformationViewModel.state.contingentType)">
                <span class="nameType">Fonction au titre de laquelle la décoration est demandée :</span>
                {{ this.demandInformationViewModel.state.askedPosition }}
              </p>
              <p v-if="this.isContingentWithGrade()">
                <span class="nameType">Secteur d'activité :</span>
                {{ this.demandInformationViewModel.state.activityArea }}
              </p>
              <v-divider class="mb-10 mt-10" />
            </div>
            <div>
              <p class="subtitleValidation pt-2 pb-2">Documents déposés :</p>

              <p>Casier judiciaire :</p>
              <p>
                <a :href="this.documentViewModel.state.criminalRecordFileName.link" download target="_blank">
                  {{ this.documentViewModel.state.criminalRecordFileName.name }}
                </a>
              </p>

              <p>CV :</p>
              <p v-if="this.documentViewModel.state.resumeFileName.name !== ''">
                <a :href="this.documentViewModel.state.resumeFileName.link" download target="_blank">
                  {{ this.documentViewModel.state.resumeFileName.name }}
                </a>
              </p>
              <p>Avis préfet :</p>
              <p v-if="this.documentViewModel.state.prefectFileName.name !== ''">
                <a :href="this.documentViewModel.state.prefectFileName.link" download target="_blank">
                  {{ this.documentViewModel.state.prefectFileName.name }}
                </a>
              </p>
              <p v-if="this.documentViewModel.state.otherFiles.length > 0">Autres documents :</p>
              <p v-for="file in this.documentViewModel.state.otherFiles" v-bind:key="file.id">
                <a :href="file.link" download target="_blank">
                  {{ file.name }}
                </a>
              </p>
            </div>
          </v-col>
        </v-row>

      </v-container>
      <v-row class="pt-10 justify-space-between">
        <div class="pl-3">
          <v-btn outlined color="primary" @click="goBack">
            <v-icon small style="margin-top: 3px"> {{ chevronLeft }} </v-icon>Retour
          </v-btn>
        </div>
        <div style="display: flex; align-items: center">
          <div style="display: flex;align-items: center;">
            <div class="pr-3">
              <v-btn v-if="onBoardingViewModel.editMode === false" outlined color="primary" @click="returnToDraft">
                <v-icon small style="margin-top: 3px; margin-right: 5px"> {{ contentSave }} </v-icon>Garder en brouillon
              </v-btn>
            </div>
            <div class="pr-3">
              <v-btn v-if="onBoardingViewModel.editMode === false" color="primary" @click="goNext">
                Envoyer ...&nbsp;<v-img alt="" :aspect-ratio="1" :src="arrowSend" />
              </v-btn>

              <v-btn v-if="onBoardingViewModel.editMode === true" color="primary" @click="goNext">
                Valider la modification&nbsp; <v-img alt="" style="margin-left: 5px" :aspect-ratio="1" :src="arrowSend" />
              </v-btn>
            </div>
          </div>
        </div>
      </v-row>
      <div class="pr-3" style="position: absolute; top: 5px; right: 0">
        <v-btn outlined color="primary" @click="print">
          <v-icon small style="margin-top: 3px; margin-right: 10px"> {{ printer }} </v-icon>Imprimer
        </v-btn>
        <v-btn outlined color="primary" @click="saveAsWord">
          <v-icon small style="margin-top: 3px; margin-right: 10px"> {{ attachment }} </v-icon>Exporter au format word
        </v-btn>
      </div>
    </v-form>

    <alert :open="validating" :on-close="onClose" :with-confirmation="true" :on-confirm="onConfirm">
      <template v-slot:title>
        <div style="display: flex; align-items: flex-start">
          <v-icon x-large style="color: #161616; vertical-align: middle">
            {{ right }}
          </v-icon>
          <h2 class="pb-5" style="font-size: 20px; line-height: 1.5">
            Envoyer le dossier pour {{ buildName() }} ({{ birthDateAndPlace() }})
          </h2>
        </div>
      </template>
      <template v-slot:message>
        <selector
            label="Pour la promotion"
            :items="homeViewModel.mmSessions.map(elem => elem.name)"
            placeholder="Sélectionner une option"
            v-model="session"
            :error-messages="sessionErrors"
        />
        <selector
            label="Attribuer à"
            :items="onBoardingViewModel.entities.map(elem => elem.name)"
            placeholder="Sélectionner une option"
            v-model="entity"
            :error-messages="entityErrors"
        />
        <text-field
            label="Commentaire (facultatif)"
            :required="false"
            :default-value="comment"
            v-model="comment"
            field-type="text-area"
        />
      </template>
    </alert>
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import Stepper from "@/modules/onBoarding/components/Stepper.vue";
import { lazyInject, Validation } from "@pasta/box";
import { PersonalInformationViewModel } from "@/modules/onBoarding/viewModels/personalInformation/PersonalInformationViewModel";
import { Civility } from "@/modules/onBoarding/types/Civility";
import { TrainingInformationViewModel } from "@/modules/onBoarding/viewModels/training/TrainingInformationViewModel";
import { ContingentType } from "@/core/types/training/ContingentType";
import {mdiChevronLeft, mdiContentSaveOutline, mdiArrowRight, mdiPrinterOutline, mdiAttachment} from "@mdi/js";
import arrowSend from "../../../assets/arrow_send.svg";
import { OnBoardingStepIndex, OnBoardingViewModel } from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import { OnBoardingPath } from "@/modules/onBoarding/navigation/OnBoardingPath";
import dayjs from "dayjs";
import { DocumentViewModel } from "@/modules/onBoarding/viewModels/documents/DocumentViewModel";
import { DocumentType } from "@/core/types/documents/DocumentType";
import { DemandInformationViewModel } from "@/modules/onBoarding/viewModels/demand/DemandInformationViewModel";
import { ReasonGradeProposal } from "@/core/types/training/ReasonGradeProposal";
import Alert from "@/components/Alert.vue";
import Selector from "@/components/Selector.vue";
import TextField from "@/components/TextField.vue";
import { required } from "vuelidate/lib/validators";
import {HonoreIdentifier} from "@/core/HonoreIdentifier";
import {FileExporter} from "@/core/gateways/FileExporter";
import {AuthModule} from "@pasta/front-auth";
import {HomeViewModel} from "@/modules/home/viewModels/HomeViewModel";

@Component({
  components: {
    Stepper,
    Selector,
    Alert,
    TextField,
  },
})
export default class MMValidation extends Vue {
  arrowSend = arrowSend;
  chevronLeft = mdiChevronLeft;
  contentSave = mdiContentSaveOutline;
  right = mdiArrowRight;
  printer = mdiPrinterOutline;
  attachment = mdiAttachment;

  @lazyInject(HomeViewModel)
  declare homeViewModel: HomeViewModel;

  @lazyInject(PersonalInformationViewModel)
  declare personalInformationViewModel: PersonalInformationViewModel;

  @lazyInject(TrainingInformationViewModel)
  declare trainingInformationViewModel: TrainingInformationViewModel;

  @lazyInject(OnBoardingViewModel)
  declare onBoardingViewModel: OnBoardingViewModel;

  @lazyInject(AuthModule)
  declare authModule: AuthModule;

  @lazyInject(DocumentViewModel)
  declare documentViewModel: DocumentViewModel;

  @lazyInject(HonoreIdentifier.fileExporter)
  declare fileExporter: FileExporter;

  @lazyInject(DemandInformationViewModel)
  declare demandInformationViewModel: DemandInformationViewModel;

  reasonGradeProposal = "";

  validating = false;

  comment = "";

  @Validation({
    required: {
      errorMessage: "Veuillez sélectionner une entité",
      validator: required,
    },
  })
  entity = "";

  @Validation({
    required: {
      errorMessage: "Veuillez sélectionner une promotion",
      validator: required,
    },
  })
  session = "";

  get decreeDate() {
    return dayjs(this.trainingInformationViewModel.trainingInformationState.distinction?.decretDate).format(
        "DD/MM/YYYY"
    );
  }

  get rankTakingDate() {
    return dayjs(this.trainingInformationViewModel.trainingInformationState.distinction?.rankTakingDate).format(
        "DD/MM/YYYY"
    );
  }

  goBack() {
    this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.DOCUMENTS);
    return this.$router.back();
  }

  async goNext() {
    if (this.onBoardingViewModel.editMode) {
      this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.SUCCESS);
      return this.$router.push(OnBoardingPath.SUCCESS);
    }
    await this.onBoardingViewModel.fetchEntities();
    this.validating = true;
  }

  async onClose() {
    this.validating = false;
  }

  async onConfirm() {
    this.$v.$touch();
    const isError = this.$v.$invalid;
    if (!isError) {
      const entity = await this.onBoardingViewModel.selectEntityByName(this.entity);
      const session = this.homeViewModel.sessions
          .filter(item => item.decoration === this.personalInformationViewModel.state.decorationType)
          .find(item => item.name == this.session)
      if (entity && session) {
        await this.personalInformationViewModel.sendApplication({
          comment: this.comment,
          entityId: entity.id,
          sessionId: session.id,
        });
        this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.SUCCESS);
        await this.$router.push(OnBoardingPath.SUCCESS);
        return
      }
    }
    return;
  }

  buildName() {
    const state = this.personalInformationViewModel.state;
    return `
      ${state.civility === "MR" ? "M" : "Mme"} ${state.firstName} ${state.birthName} ${state.legalName ? `Ep. ${state.legalName}` : ''}
    `;
  }

  isContingentWithGrade() {
    return [ContingentType.CIVIL, ContingentType.ADMINISTRATIVE].includes(
        this.demandInformationViewModel.state.contingentType
    );
  }

  civilContingentWithDuration() {
    if (this.demandInformationViewModel.state.contingentType === ContingentType.CIVIL) {
      if (this.demandInformationViewModel.state.reasonGradeProposal === ReasonGradeProposal.DURATION) {
        return {
          civilDuration: this.demandInformationViewModel.state.civilNavigationDurationInMonths,
          militaryDuration: this.demandInformationViewModel.state.militaryNavigationDurationInMonth,
          otherDuration: this.demandInformationViewModel.state.otherActivityDuration,
        };
      }
    }
    return {
      civilDuration: "0",
      militaryDuration: "0",
      otherDuration: "0",
    };
  }

  returnToDraft() {
    this.onBoardingViewModel.clearAll();
    return this.$router.push("/");
  }

  birthDateAndPlace() {
    const state = this.personalInformationViewModel.state;
    if (!state.birthDate) {
      return ""
    }
    return `
      Né${state.civility === Civility.MRS ? "e" : ""} le ${dayjs(state.birthDate).format("DD/MM/YYYY")} à ${
        state.birthCity.toUpperCase()
    }
    `;
  }

  getDistinctionDetail() {
    if (this.trainingInformationViewModel.trainingInformationState.distinction) {
      return {
        name: this.trainingInformationViewModel.trainingInformationState.distinction.name,
        decreeDate: dayjs(this.trainingInformationViewModel.trainingInformationState.distinction.decretDate).format(
            "DD/MM/YYYY"
        ),
        rankTakingDate:
            this.trainingInformationViewModel.trainingInformationState.distinction.rankTakingDate == ""
                ? null
                : dayjs(this.trainingInformationViewModel.trainingInformationState.distinction.rankTakingDate).format(
                    "DD/MM/YYYY"
                ),
      };
    }
    return {
      name: "",
      decreeDate: "",
      rankTakingDate: "",
    };
  }

  address() {
    const state = this.personalInformationViewModel.state;
    return `
      Domicilié${state.civility === Civility.MRS ? "e" : ""} au ${state.rawAddress.rawValue}
    `;
  }

  print() {
    // eslint-disable-next-line @typescript-eslint/ban-ts-comment
    //@ts-ignore
    this.$htmlToPaper('print-folder');
  }

  capitalize(value: string) {
    return value.charAt(0).toUpperCase() + value.slice(1).toLowerCase();
  }

  async saveAsWord() {
    const reasonGradeProposal = await this.demandInformationViewModel.toReasonGradeProposalValue();
    await this.fileExporter.exportAsFile({
      personalInformation: {
        address: this.personalInformationViewModel.state.rawAddress.rawValue,
        birthCity: this.personalInformationViewModel.state.birthCity,
        birthDate: new Date(this.personalInformationViewModel.state.birthDate),
        name: this.buildName().trim(),
        nationality: this.personalInformationViewModel.state.nationality,
      },
      demand: {
        activityArea: this.demandInformationViewModel.state.activityArea as string,
        askedPosition: this.demandInformationViewModel.state.askedPosition as string,
        contingentType: this.demandInformationViewModel.state.contingentType,
        duration: {
          civilNavigationDurationInMonths: this.demandInformationViewModel.state.civilNavigationDurationInMonths,
          maritimeActivityDuration: this.demandInformationViewModel.state.maritimeActivityDuration,
          militaryNavigationDurationInMonth: this.demandInformationViewModel.state.militaryNavigationDurationInMonth,
          otherActivityDuration: this.demandInformationViewModel.state.otherActivityDuration,
        },
        grade: this.demandInformationViewModel.state.grade,
        reasonGradeProposal: reasonGradeProposal === "dérogation application de l'article 11" ? `${reasonGradeProposal} - ${this.demandInformationViewModel.state.reasonForExceptionalFact}` : reasonGradeProposal,
        reasonProposal: this.demandInformationViewModel.state.reasonProposal,
      },
      entity: {
        // eslint-disable-next-line @typescript-eslint/ban-ts-comment
        //@ts-ignore
        name: this.authModule.currentUser?.groups[0].name,
      },
      training: {
        distinction: this.trainingInformationViewModel.trainingInformationState.distinction ? {
          name: this.trainingInformationViewModel.trainingInformationState.distinction?.name as string,
          decreeDate: new Date(this.trainingInformationViewModel.trainingInformationState.distinction?.decretDate as string),
          rankTakingDate: new Date(this.trainingInformationViewModel.trainingInformationState.distinction?.rankTakingDate as string),
        } : null as any,
        quarter: this.trainingInformationViewModel.trainingInformationState.quarter,
        marineLicenseNumber: this.trainingInformationViewModel.trainingInformationState.quarterLicenseNumber,
      }
    })
  }
  async mounted() {
    await this.homeViewModel.getMMSession();
    await this.onBoardingViewModel.fetchEntities();
    await this.documentViewModel.getDocumentLink(DocumentType.CRIMINAL_RECORD);
    await this.documentViewModel.getDocumentLink(DocumentType.RESUME);
    await this.documentViewModel.getDocumentLink(DocumentType.PREFECT_OPINION);
    for (const file of this.documentViewModel.state.otherFiles) {
      await this.documentViewModel.getDocumentLink(DocumentType.OTHER);
    }
    this.reasonGradeProposal = await this.demandInformationViewModel.toReasonGradeProposalValue();
  }
}
</script>

<style lang="scss">
.subtitleValidation {
  font-size: 18px !important;
  font-weight: 700 !important;
  color: #161616;
  margin-bottom: 0;
}
.content {
  color: #666666;
}

.nameType {
  color: #161616;
}
</style>

````

</details>


---

### 📄 `src/modules/onBoarding/components/SaveConfirmation.vue` [1.618 octets]
<a id="src-modules-onBoarding-components-SaveConfirmation-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-components-SaveConfirmation-vue)

> **Chemin relatif** : `src/modules/onBoarding/components/SaveConfirmation.vue`  
> **Taille** : 1.618 octets  
> **Lignes** : 74  
> **Type** : text

```text
<template>
  <div class="box" v-if="!hidden">
    <div class="box-icon-container">
      <v-icon large>
        {{ informationBoxIcon }}
      </v-icon>
    </div>
    <div class="text-container">
      <h4>Sauvegardé !</h4>
      <p>Vos informations ont bien été sauvegardées vous pouvez revenir compléter votre dossier à tout moment depuis votre espace "Mes Brouillons".</p>
    </div>
    <div class="close-btn" @click="onClose">
      <v-icon small>
        {{ closeIcon }}
      </v-icon>
    </div>
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import { mdiInformation, mdiClose } from '@mdi/js';
import {Prop} from "vue-property-decorator";
@Component
export default class SaveConfirmation extends Vue {
  informationBoxIcon = mdiInformation;
  closeIcon = mdiClose;

  @Prop({required: true})
  declare hidden: boolean;

  @Prop({required: true})
  declare onClose: () => Promise<void> | void;
}
</script>

<style lang="scss">
  .box {
    border: 1px solid #0063CB;
    display: flex;
    position: relative;
    .box-icon-container {
      padding-left: 5px;
      padding-right: 5px;
      span {
        margin-top: 14px;
        color: white;
      }
      background: #0063CB;
    }
    .text-container {
      padding: 14px;
      h4 {
        font-size: 20px;
        font-weight: 500;
        color: #161616;
      }
      p {
        margin-top: 10px;
      }
    }
    .close-btn {
      position: absolute;
      right: 10px;
      top: 5px;
      cursor: pointer;
      span {
        color: #000091;
      }
    }
  }
</style>

```


---

### 📄 `src/modules/onBoarding/components/SearchArchive.vue` [3.714 octets]
<a id="src-modules-onBoarding-components-SearchArchive-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-components-SearchArchive-vue)

> **Chemin relatif** : `src/modules/onBoarding/components/SearchArchive.vue`  
> **Taille** : 3.714 octets  
> **Lignes** : 154  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (154 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <alert
    :open="open"
    :with-confirmation="true"
    :on-close="onClose"
    :on-confirm="onConfirmSelection"
  >
    <template v-slot:title>
      <h2 class="pb-10">
        Profils correspondants
      </h2>
    </template>
    <template v-slot:message>
      <div class="deco-search-archive">
        <p class="subtitle">Affiner votre recherche :</p>
        <v-text-field
          @input="$emit('input', $event)"
          :append-outer-icon="search"
          filled
          type="text"
          @click:append-outer="onSearchPress"
        />
      </div>
      <div class="deco-archive-container">
        <div
          class="deco-archive"
          :class="selectedArchiveId === archive.id ? 'selected' : ''"
          v-for="archive in archives.slice((page * limit) - limit, page * limit)"
          v-bind:key="archive.id"
          @click="onArchiveSelect(archive.id)"
        >
          <p style="font-weight: 500">{{archive.birthName}} {{archive.firstName}}</p>
          <p>Né{{archive.civility === "MR" ? "" : "e"}} le {{archive.displayBirthDate}}</p>
          <p>Cabinet : {{archive.office ? archive.office : "inconnue"}}</p>
          <p v-if="archive.distinction">Décoration : {{archive.distinction.name}}</p>
          <p v-if="archive.distinction">Date de décret : {{archive.distinction.decreeDate ? dayjs(archive.distinction.decreeDate).format('DD/MM/YYYY') : ''}}</p>
        </div>
      </div>
      <v-pagination
        :length="Math.round(archives.length / limit)"
        :disabled="false"
        :page="page"
        class="mt-5"
        :value="page"
        v-model="page"
        :total-visible="8"
      ></v-pagination>
    </template>

  </alert>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import Alert from "@/components/Alert.vue";
import {Prop, Watch} from "vue-property-decorator";
import { mdiMagnify } from '@mdi/js'
import {Archive} from "@/core/entities/Archive";
import dayjs from "dayjs";

@Component({
  methods: {dayjs},
  components: {
    Alert
  }
})
export default class SearchArchive extends Vue {
  @Prop({required: false, default: false})
  declare open: boolean;

  @Prop({required: true})
  declare onClose: Function;

  search = mdiMagnify;

  @Prop({required: true})
  declare archives: Archive[];

  @Prop({required: true})
  declare onSearchPress: Function;

  @Prop({required: true})
  declare onArchiveSelected: (id: string) => void;

  @Prop({required: true})
  declare onConfirmSelection: Function;

  page = 1;

  limit = 8;

  selectedArchiveId = "";

  onArchiveSelect(archiveId: string) {
    this.selectedArchiveId = archiveId;
    return this.onArchiveSelected(archiveId);
  }

}
</script>

<style lang="scss">
.deco-search-archive {
  display: flex;
  align-items: center;
  .subtitle {
    margin-right: 10px;
    margin-bottom: 30px;
  }
  .v-input__append-outer {
    width: 40px;
    margin: 0!important;
    background: #20209f;
    border-top-right-radius: 4px;
    height: 41px;
    display: flex;
    justify-content: center;
    flex-direction: column;
    align-items: center;
    svg {
      fill: white;
    }
  }
}

.deco-archive-container {
  display: flex;
  flex-wrap: wrap;
  .deco-archive {
    width: 330px;
    padding-left: 10px;
    padding-top: 15px;
    height: 230px;
    margin-right: 10px;
    margin-top: 15px;
    margin-left: 10px;
    border: 1px solid #DDDDDD;
    border-bottom: 5px solid #20209f;
    transition: 300ms ease all;
  }
  .deco-archive:hover {
    box-shadow: 0px 5px 10px 0px #c1c1c1;
    cursor: pointer;
    transition: 300ms ease all;
  }
}

.selected {
  box-shadow: 0px 5px 10px 0px #212121;
}

</style>

```

</details>


---

### 📄 `src/modules/onBoarding/components/Stepper.vue` [2.427 octets]
<a id="src-modules-onBoarding-components-Stepper-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-components-Stepper-vue)

> **Chemin relatif** : `src/modules/onBoarding/components/Stepper.vue`  
> **Taille** : 2.427 octets  
> **Lignes** : 130  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (130 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <div class="stepper-display">
    <v-stepper
      v-model="activeStep"
      vertical
      elevation="0"
    >
      <div
        v-for="step of steps"
        v-bind:key="step.index"
      >
          <v-stepper-step
            :step="step.index"
            @click="onSelectStep(step.index)"
            style="cursor: pointer;"
          >
            <button :aria-current="step.index"><p>{{step.title}}</p></button>
          </v-stepper-step>
        <div v-if="step.index < steps.length" class="separator"></div>
      </div>
    </v-stepper>
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import {Prop} from "vue-property-decorator";

export interface Step {
  index: number;
  title: string;
  location: string;
}

@Component({
  components: {
  },
})
export default class Stepper extends Vue {
  @Prop({required: true})
  declare activeStep: number;

  @Prop({required: false, default: () => console.log('step clicked')})
  declare onSelectStep: (step: number) => void;

  @Prop({required: true})
  declare steps: Step[];

  data(): object {
    return {
      current: this.activeStep,
    }
  }
}
</script>

<style lang="scss">
.fileDeposit {
  .record-content {
    display: flex;
    align-items: stretch;
    padding: 1rem 20% !important;
  }

  .v-stepper {
    background: transparent !important;
  }
  $stepper-content-padding: 24px;
}
.v-stepper__step__step {
  background: #E3E3FD!important;
  color: rgba(0, 0, 0, 0.65)!important;
  width: 40px!important;
  height: 40px!important;
}

.primary {
  color: #fff!important;
}

.v-application--is-ltr .v-stepper--vertical .v-stepper__content {
  margin-left: 44px!important;
}

.v-application--is-ltr .v-stepper--vertical .v-stepper__content {
  padding-top: 40px!important;
}

.v-stepper--vertical .v-stepper__step {
  padding: 0px 24px!important;
}

.v-stepper__step--complete p {
  color: #20209f;
  font-weight: 500;
}
.v-stepper__step--active p {
  color: #20209f;
  font-weight: 500;
}

.theme--light.v-stepper .v-stepper__label {
  color: rgba(0, 0, 0, 0.65)!important;
}

.separator {
  padding-top: 40px;
  border-left: 1px solid rgba(0, 0, 0, 0.12);
  margin-left: 44px;
  width: 3px;
}

.v-stepper span {
  font-size: 14px;
}

.v-stepper__step--active span {
  font-weight: 700;
}
.v-stepper p {
  margin-bottom: 0;
  margin-left: 15px;
  width:max-content
}



</style>

```

</details>


---

### 📄 `src/modules/onBoarding/layout/OnBoardingLayout.vue` [5.362 octets]
<a id="src-modules-onBoarding-layout-OnBoardingLayout-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-layout-OnBoardingLayout-vue)

> **Chemin relatif** : `src/modules/onBoarding/layout/OnBoardingLayout.vue`  
> **Taille** : 5.362 octets  
> **Lignes** : 156  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (156 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <div class="file-deposit decoration-container">
    <stepper
      v-if="onBoardingViewModel.activeStep !== 0"
      :active-step="onBoardingViewModel.activeStep"
      :on-select-step="(step) => onSelectStep(step)"
      :steps="this.onBoardingViewModel.steps"
    />
    <div class="view-container">
      <router-view>
      </router-view>
    </div>
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import Stepper from "@/modules/onBoarding/components/Stepper.vue";
import {lazyInject} from "@pasta/box";
import {OnBoardingStepIndex, OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {OnBoardingPath} from "@/modules/onBoarding/navigation/OnBoardingPath";
import {
  PersonalInformationViewModel
} from "@/modules/onBoarding/viewModels/personalInformation/PersonalInformationViewModel";
import {TrainingInformationViewModel} from "@/modules/onBoarding/viewModels/training/TrainingInformationViewModel";
import {DocumentViewModel} from "@/modules/onBoarding/viewModels/documents/DocumentViewModel";
import {DemandInformationViewModel} from "@/modules/onBoarding/viewModels/demand/DemandInformationViewModel";
import {AnnuityViewModel} from "@/modules/onBoarding/viewModels/annuity/AnnuityViewModel";
import {ActivityViewModel} from "@/modules/onBoarding/viewModels/activity/ActivityViewModel";
import {DecorationType} from "@/modules/onBoarding/types/DecorationType";

@Component({
  components: {
    Stepper
  }
})
export default class OnBoardingLayout extends Vue {
  @lazyInject(OnBoardingViewModel)
  declare onBoardingViewModel: OnBoardingViewModel;

  @lazyInject(PersonalInformationViewModel)
  declare personalInformationViewModel: PersonalInformationViewModel;

  @lazyInject(TrainingInformationViewModel)
  declare trainingInformationViewModel: TrainingInformationViewModel;

  @lazyInject(DocumentViewModel)
  declare documentViewModel: DocumentViewModel;

  @lazyInject(DemandInformationViewModel)
  declare demandInformationViewModel: DemandInformationViewModel;

  @lazyInject(AnnuityViewModel)
  declare annuityViewModel: AnnuityViewModel;

  @lazyInject(ActivityViewModel)
  declare activityViewModel: ActivityViewModel;


  onSelectStep(index: number) {
    const step = this.onBoardingViewModel.steps.find(item => item.index === index);
    if (index === this.onBoardingViewModel.activeStep) {
      return;
    }
    if (step && this.isCompleted(index)) {
      this.onBoardingViewModel.updateOnBoardingStep(index);
      this.$router.push(step.location);
    }
  }

  private isCompleted(index: number): boolean {
    const documentCompleted = this.documentViewModel.completed;
    const trainingInformationCompleted = this.trainingInformationViewModel.completed;
    const demandInformationViewModel = this.demandInformationViewModel.completed;
    const activityCompleted = this.activityViewModel.completed;
    const annuityCompleted = this.annuityViewModel.completed;
    if (this.onBoardingViewModel.selectedDecoration === DecorationType.MERITE_MARITIME) {
      if (index === OnBoardingStepIndex.TRAINING_INFORMATION) {
        return trainingInformationCompleted;
      }
      if (index === OnBoardingStepIndex.DEMAND) {
        return demandInformationViewModel;
      }
      if (index === OnBoardingStepIndex.DOCUMENTS) {
        return documentCompleted;
      }
      if (index === OnBoardingStepIndex.VALIDATION) {
        return trainingInformationCompleted && documentCompleted && demandInformationViewModel;
      }
    }
    if (this.onBoardingViewModel.selectedDecoration !== DecorationType.MERITE_MARITIME) {
      if (index === OnBoardingStepIndex.ACTIVITY) {
        return activityCompleted;
      }
      if (index === OnBoardingStepIndex.ANNUITY) {
        return annuityCompleted;
      }
      if (index === OnBoardingStepIndex.DOCUMENTS) {
        return documentCompleted;
      }
      if (index === OnBoardingStepIndex.VALIDATION) {
        return activityCompleted && annuityCompleted && documentCompleted;
      }
    }

    return false;
  }

  mounted() {
    switch (this.$route.path) {
      case OnBoardingPath.TRAINING_INFORMATION:
        this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.TRAINING_INFORMATION);
        break;
      case OnBoardingPath.ACTIVITY:
        this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.ACTIVITY);
        break;
      case OnBoardingPath.DOCUMENTS:
        this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.DOCUMENTS);
        break;
      case OnBoardingPath.DEMAND:
      case OnBoardingPath.ANNUITY:
        this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.DEMAND);
        break;
      case OnBoardingPath.VALIDATION:
        this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.VALIDATION);
        break;
      default:
        this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.DEFAULT);
    }
  }
}
</script>

<style lang="scss">
.decoration-container {
  display: flex;
  justify-content: flex-start;
  align-items: flex-start;
}
.file-deposit {
  margin: 2rem 8rem;
}
.view-container {
  margin: 0 20%;
  text-align: left;
}

@media screen and (max-width: 1280px) {
  .view-container {
    margin: 0 auto!important;
    width: 600px;
  }
}
</style>

```

</details>


---

### 📄 `src/modules/onBoarding/screens/DecorationChoice.vue` [3.408 octets]
<a id="src-modules-onBoarding-screens-DecorationChoice-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-screens-DecorationChoice-vue)

> **Chemin relatif** : `src/modules/onBoarding/screens/DecorationChoice.vue`  
> **Taille** : 3.408 octets  
> **Lignes** : 111  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (111 lignes) - Cliquer pour déplier</summary>

```text
<template>
    <div class="decoration">
      <h1 class="decoration--title" tabindex="-1">Type de décoration</h1>

      <v-radio-group
          role="radiogroup"
          aria-labelledby="decoration"
          class="decoration--choice"
          mandatory
          v-model="decoration"
      >
        <template v-slot:label>
          <span>Sélectionnez une décoration</span>
        </template>
        <v-radio aria-checked="null" id="decoration" label="Mérite Maritime" value="merite_maritime"></v-radio>
        <v-radio :disabled="!isAdmin()" aria-checked="null" id="decoration" label="Légion d'Honneur" value="legion_honneur"></v-radio>
        <v-radio :disabled="!isAdmin()" aria-checked="null" id="decoration" label="Ordre national du mérite" value="ordre_national_du_merite"></v-radio>
      </v-radio-group>

      <div class="decoration--navigation">
        <v-btn outlined color="primary" @click="goBack">
          {{onBoardingViewModel.fromPresentation ? "Retour" : "Retour à l'accueil"}}
        </v-btn>
        <v-btn color="primary" @click="navigate()"> Suivant </v-btn>
      </div>
    </div>
</template>

<script lang="ts">
import {lazyInject, StrictNullable} from "@pasta/box";
import Vue from "vue";
import Component from "vue-class-component";
import Stepper from "@/modules/onBoarding/components/Stepper.vue";
import {OnBoardingStepIndex, OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {OnBoardingPath} from "@/modules/onBoarding/navigation/OnBoardingPath";
import {DecorationType} from "@/modules/onBoarding/types/DecorationType";
import {AuthModule} from "@pasta/front-auth";
import {AuthRole} from "@/core/types/identity/AuthRole";

@Component({
  components: {
    Stepper,
  }
})
export default class DecorationChoice extends Vue {
  decoration: StrictNullable<string> = null;

  @lazyInject(OnBoardingViewModel)
  declare onBoardingViewModel: OnBoardingViewModel;

  @lazyInject(AuthModule)
  declare authModule: AuthModule;

  mounted() {
    this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.DEFAULT);
    if (this.onBoardingViewModel.selectedDecoration) {
      this.decoration = this.onBoardingViewModel.selectedDecoration
    }
  }

  goBack() {
    this.$router.back();
  }

  async navigate() {
    if (this.decoration === DecorationType.MERITE_MARITIME) {
      this.onBoardingViewModel.selectDecoration(DecorationType.MERITE_MARITIME)
    }
    if (this.decoration === DecorationType.LEGION_HONNEUR) {
      this.onBoardingViewModel.selectDecoration(DecorationType.LEGION_HONNEUR)
    }
    if (this.decoration === DecorationType.ORDRE_NATIONAL_DU_MERITE) {
      this.onBoardingViewModel.selectDecoration(DecorationType.ORDRE_NATIONAL_DU_MERITE)
    }
    return this.$router.push(OnBoardingPath.PERSONAL_INFORMATION);
  }

  isAdmin() {
    const currentUser = this.authModule.currentUser;
    return currentUser?.highestRoleLevel && currentUser?.highestRoleLevel >= AuthRole.CHANCELLERY;
  }
}
</script>

<style lang="scss">
.decoration {
  display: flex;
  flex-direction: column;
  &--title {
    align-self: flex-start;
  }

  &--choice {
    display: flex;
    flex-direction: column;

    .v-input--radio-group__input {
      gap: 1rem;
    }
  }

  &--navigation {
    display: flex;
    flex-direction: row;
    gap: 5%;
    align-self: flex-start;
    margin-top: 1rem;
  }
}
</style>

```

</details>


---

### 📄 `src/modules/onBoarding/screens/DocumentInformation.vue` [17.324 octets]
<a id="src-modules-onBoarding-screens-DocumentInformation-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-screens-DocumentInformation-vue)

> **Chemin relatif** : `src/modules/onBoarding/screens/DocumentInformation.vue`  
> **Taille** : 17.324 octets  
> **Lignes** : 523  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (523 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <div>
    <v-form class="civilRecord" ref="civilRecordForm">
      <v-container>
        <v-row>
          <v-col cols="12" sm="12" class="pt-0 pl-0">
            <h3>
              {{ personalInformationViewModel.state.civility === "MR" ? "M" : "Mme" }}
              {{ personalInformationViewModel.state.firstName }} {{ personalInformationViewModel.state.birthName }}
              {{
                personalInformationViewModel.state.legalName
                  ? `Ep. ${personalInformationViewModel.state.legalName}`
                  : ""
              }}
            </h3>
            <h2 tabindex="-1">Autres pièces jointes et annexes</h2>
          </v-col>
          <v-col cols="12" sm="12" class="pt-1 pl-0">
            <p class="subtitle">
              Extrait de casier judiciaire (B2) de moins de 3 mois
              <a target="_blank" href="https://www.cjnb2.justice.gouv.fr"> B2.gouv.fr</a>
            </p>
            <p class="information">Taille maximale : 10 Mo. Formats supportés : jpg, png, pdf.</p>
            <div class="mt-5">
              <draggable-file
                :on-file-change="onCriminalRecordFileChange"
                :progress="documentViewModel.progressCriminalRecord"
                input-ref="criminal_record"
              />
            </div>

            <div class="file-input align-center">
              <div class="align-center">
                <v-img
                  alt=""
                  v-if="documentViewModel.state.criminalRecordFileName.name !== ''"
                  :aspect-ratio="1"
                  :src="success"
                  style="margin-left: 5px"
                />
                <p>
                  {{
                    documentViewModel.state.criminalRecordFileName.name
                      ? documentViewModel.state.criminalRecordFileName.name
                      : "Aucun fichier séléctionné"
                  }}
                </p>
                <v-btn
                  class="ml-3"
                  style="background-color: white !important"
                  text
                  v-if="documentViewModel.state.criminalRecordFileName.name !== ''"
                  color="primary"
                  @click="removeFile(documentViewModel.state.criminalRecordFileName.id, 'criminal_record')"
                >
                  <v-icon aria-describedby="Supprimer" class="remove-btn">
                    {{ deleteIcon }}
                  </v-icon>
                  <span>Supprimer</span>
                </v-btn>
              </div>
            </div>
            <div class="align-start" style="margin-top: 24px; background: #ffe8e5; padding: 10px">
              <v-icon style="margin-right: 10px; color: #b34000">
                {{ infosBox }}
              </v-icon>
              <p style="margin-top: 0; color: #b34000; font-weight: bold">
                Veillez à ne pas conserver l’extrait de casier judiciaire (B2) sur votre ordinateur une fois déposé dans
                Honoré.
              </p>
            </div>
          </v-col>
          <v-col cols="12" sm="12" class="pt-1 pl-0" v-if="onBoardingViewModel.selectedDecoration !== 'merite_maritime'">
            <p class="subtitle">Acte de naissance</p>
            <p class="information">Taille maximale : 10 Mo. Formats supportés : jpg, png, pdf.</p>
            <div class="mt-5">
              <draggable-file
                :on-file-change="onBirthCertificateFileChange"
                input-ref="birth_certificate"
                :progress="documentViewModel.progressBirthCertificate"
              />
            </div>
            <div class="file-input align-center">
              <div class="align-center">
                <v-img alt="" v-if="documentViewModel.state.birthCertificate.name" :aspect-ratio="1" :src="success" style="margin-left: 5px" />
                <p>{{ documentViewModel.state.birthCertificate.name ? documentViewModel.state.birthCertificate.name : "Aucun fichier séléctionné" }}</p>
                <v-btn
                  class="ml-3"
                  style="background-color: white !important"
                  text
                  v-if="documentViewModel.state.birthCertificate.name !== ''"
                  color="primary"
                  @click="removeFile(documentViewModel.state.birthCertificate.id, 'birth_certificate')"
                >
                  <v-icon aria-describedby="Supprimer" class="remove-btn">
                    {{ deleteIcon }}
                  </v-icon>
                  <span>Supprimer</span>
                </v-btn>
              </div>
            </div>
          </v-col>
          <v-col cols="12" sm="12" class="pt-1 pl-0">
            <p class="subtitle">Avis préfet (facultatif)</p>
            <p class="information">Taille maximale : 10 Mo. Formats supportés : jpg, png, pdf.</p>
            <div class="mt-5">
              <draggable-file
                :on-file-change="onPrefectFileChange"
                input-ref="prefect_opinion"
                :progress="documentViewModel.progressPrefectOpinion"
              />
            </div>
            <div class="file-input align-center">
              <div class="align-center">
                <v-img alt="" v-if="prefectFileName" :aspect-ratio="1" :src="success" style="margin-left: 5px" />
                <p>{{ prefectFileName ? prefectFileName : "Aucun fichier séléctionné" }}</p>
                <v-btn
                  class="ml-3"
                  style="background-color: white !important"
                  text
                  v-if="prefectFileName !== ''"
                  color="primary"
                  @click="removeFile(documentViewModel.state.prefectFileName.id, 'prefect_opinion')"
                >
                  <v-icon aria-describedby="Supprimer" class="remove-btn">
                    {{ deleteIcon }}
                  </v-icon>
                  <span>Supprimer</span>
                </v-btn>
              </div>
            </div>
          </v-col>

          <v-col cols="12" sm="12" class="pt-1 pl-0">
            <p class="subtitle">CV (facultatif)</p>
            <p class="information">
              Taille maximale : 10 Mo. Formats supportés : jpg, png, pdf. Plusieurs fichiers possibles.
            </p>
            <div class="mt-5">
              <draggable-file
                :on-file-change="onResumeFileChange"
                :progress="documentViewModel.progressResume"
                input-ref="resume"
              />
            </div>
            <div class="file-input align-center">
              <div class="align-center">
                <v-img alt="" v-if="resumeFileName" :aspect-ratio="1" :src="success" style="margin-left: 5px" />
                <p>{{ resumeFileName ? resumeFileName : "Aucun fichier séléctionné" }}</p>
                <v-btn
                  class="ml-3"
                  style="background-color: white !important"
                  text
                  v-if="resumeFileName !== ''"
                  color="primary"
                  @click="removeFile(documentViewModel.state.resumeFileName.id, 'resume')"
                >
                  <v-icon aria-describedby="Supprimer" class="remove-btn">
                    {{ deleteIcon }}
                  </v-icon>
                  <span>Supprimer</span>
                </v-btn>
              </div>
            </div>
          </v-col>
          <v-col cols="12" sm="12" class="pt-1 pl-0 pb-10">
            <p class="subtitle">Notice / Mémoire / Autres documents (facultatif)</p>
            <p class="information">
              Taille maximale : 10 Mo. Formats supportés : jpg, png, pdf. Plusieurs fichiers possibles.
            </p>
            <div class="mt-5">
              <draggable-file
                :on-file-change="onOtherFileAdded"
                :progress="documentViewModel.progressOtherFile"
                input-ref="other"
              />
            </div>
            <div class="file-input">
              <div v-bind:key="otherFile.id" v-for="otherFile in otherFileList" class="file-list">
                <div class="align-center">
                  <v-img alt="" :aspect-ratio="1" :src="success" />
                  <p>{{ otherFile.name }}</p>
                  <v-btn
                    class="ml-3"
                    style="background-color: white !important"
                    text
                    color="primary"
                    @click="removeFile(otherFile.id, 'other')"
                  >
                    <v-icon aria-describedby="Supprimer" class="remove-btn">
                      {{ deleteIcon }}
                    </v-icon>
                    <span>Supprimer</span>
                  </v-btn>
                </div>
              </div>
            </div>
          </v-col>
        </v-row>
      </v-container>
      <v-row class="pt-3 justify-space-between">
        <div class="pl-3">
          <v-btn outlined color="primary" @click="goBack">
            <v-icon small style="margin-top: 3px"> {{ chevronLeft }} </v-icon>Retour
          </v-btn>
        </div>
        <div class="pr-3">
          <v-btn color="primary" @click="goNext">
            Sauvegarder et relire&nbsp; <v-img alt="" style="margin-left: 5px" :aspect-ratio="1" />
            <v-icon small style="margin-top: 3px; margin-right: 5px">
              {{ contentSave }}
            </v-icon>
          </v-btn>
        </div>
      </v-row>
    </v-form>

    <alert
      :open="isCriminalRecordMissing"
      :on-close="() => isCriminalRecordMissing = false"
      :with-confirmation="false"
    >
      <template v-slot:title>
        <h3 style="color: #212121">
           Il semble que le casier judiciaire soit manquant
        </h3>
      </template>
    </alert>
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import Stepper from "@/modules/onBoarding/components/Stepper.vue";
import {OnBoardingPath} from "@/modules/onBoarding/navigation/OnBoardingPath";
import {mdiChevronLeft, mdiClose, mdiContentSaveOutline, mdiInformation, mdiOpenInNew} from "@mdi/js";
import {OnBoardingStepIndex, OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {lazyInject} from "@pasta/box";
import success from "../../../assets/success.svg";
import {DocumentViewModel} from "@/modules/onBoarding/viewModels/documents/DocumentViewModel";
import {DocumentType} from "@/core/types/documents/DocumentType";
import {
  PersonalInformationViewModel
} from "@/modules/onBoarding/viewModels/personalInformation/PersonalInformationViewModel";
import DraggableFile from "@/modules/onBoarding/components/DraggableFile.vue";
import {DecorationType} from "@/modules/onBoarding/types/DecorationType";
import Alert from "@/components/Alert.vue";

@Component({
  components: {
    Alert,
    Stepper,
    DraggableFile,
  },
})
export default class DocumentInformation extends Vue {
  chevronLeft = mdiChevronLeft;
  openInNew = mdiOpenInNew;
  success = success;
  contentSave = mdiContentSaveOutline;
  deleteIcon = mdiClose;
  isCriminalRecordMissing = false;
  isResumeMissing = false;
  isPrefectFileMissing = false;
  infosBox = mdiInformation;

  @lazyInject(OnBoardingViewModel)
  declare onBoardingViewModel: OnBoardingViewModel;

  @lazyInject(DocumentViewModel)
  declare documentViewModel: DocumentViewModel;

  @lazyInject(PersonalInformationViewModel)
  declare personalInformationViewModel: PersonalInformationViewModel;

  criminalRecordFileName = "";
  resumeFileName = "";
  prefectFileName = "";
  birthCertificateFileName = "";
  otherFileList: { name: string; id: string }[] = [];

  goBack() {
    if (this.onBoardingViewModel.selectedDecoration === DecorationType.MERITE_MARITIME) {
      this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.DEMAND);
      return this.$router.push(OnBoardingPath.DEMAND)
    }
    this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.ANNUITY)
    return this.$router.push(OnBoardingPath.ANNUITY)
  }

  isError() {
    let isError = false;
    if (this.onBoardingViewModel.selectedDecoration === DecorationType.MERITE_MARITIME) {
      if (!this.criminalRecordFileName) {
        isError = true;
        this.isCriminalRecordMissing = true;
      } else {
        this.isCriminalRecordMissing = false;
      }
    }
    return isError;
  }

  goNext() {
    const isError = this.isError();
    if (isError) {
      return;
    }
    this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.VALIDATION);
    this.documentViewModel.complete();
    return this.$router.push(OnBoardingPath.VALIDATION);
  }

  onInputFileClick(ref: string) {
    const fileInputElement = this.$refs[ref];
    if (fileInputElement) {
      // eslint-disable-next-line @typescript-eslint/ban-ts-comment
      // @ts-ignore
      fileInputElement.click();
      return;
    }
  }

  async onBirthCertificateFileChange(file: File) {
    await this.documentViewModel.setBirthCertificate(file);
    this.birthCertificateFileName = file.name;
  }

  async onCriminalRecordFileChange(file: File) {
    await this.documentViewModel.setCriminalRecord(file);
    this.criminalRecordFileName = file.name;
  }

  async onResumeFileChange(file: File) {
    await this.documentViewModel.setResume(file);
    this.resumeFileName = file.name;
  }

  async onPrefectFileChange(file: File) {
    await this.documentViewModel.setPrefectOpinion(file);
    this.prefectFileName = file.name;
  }

  async removeFile(id: string, documentType: string) {
    await this.documentViewModel.removeFile({
      id,
      type: documentType,
    });
    if (documentType === DocumentType.OTHER) {
      this.otherFileList = this.otherFileList.filter(item => item.id !== id);
      return;
    }
    if (documentType === DocumentType.RESUME) {
      this.resumeFileName = "";
    }
    if (documentType == DocumentType.PREFECT_OPINION) {
      this.prefectFileName = "";
    }
    if (documentType === DocumentType.CRIMINAL_RECORD) {
      this.criminalRecordFileName = "";
    }
    if (documentType === DocumentType.BIRTH_CERTIFICATE) {
      this.birthCertificateFileName = "";
    }
  }

  async onOtherFileAdded(file: File) {
    const isFileExist = this.otherFileList.find(item => item.name === file.name);
    if (isFileExist) {
      console.log("[ALERT ====] file already exist");
      return;
    }
    const doc = await this.documentViewModel.addOtherFiles({
      file,
      id: file.name,
    });
    this.otherFileList = [
      ...this.otherFileList,
      {
        name: file.name,
        id: doc.id,
      },
    ];
  }

  async mounted() {
    focus();
    const infos = await this.documentViewModel.fetchDocumentInfos();
    if (infos.criminalRecordFileName) {
      this.criminalRecordFileName = infos.criminalRecordFileName.name;
    }
    if (infos.resumeFileName) {
      this.resumeFileName = infos.resumeFileName.name;
    }
    if (infos.otherFiles) {
      this.otherFileList = infos.otherFiles;
    }
    if (infos.prefectFileName) {
      this.prefectFileName = infos.prefectFileName.name;
    }
    this.documentViewModel.setProgressForBirthCertificate(0);
    this.documentViewModel.setProgressForCriminalRecord(0);
    this.documentViewModel.setProgressForPrefectOpinion(0);
    this.documentViewModel.setProgressForOtherFile(0);
    this.documentViewModel.setProgressForResume(0);
  }
}
</script>

<style lang="scss">
.decoration {
  display: flex;
  flex-direction: column;

  &--title {
    align-self: flex-start;
  }

  &--choice {
    display: flex;
    flex-direction: column;

    .v-input--radio-group__input {
      gap: 1rem;
    }
  }

  &--navigation {
    display: flex;
    flex-direction: row;
    gap: 5%;
    align-self: flex-start;
    margin-top: 1rem;
  }
}
.subtitle {
  font-size: 16px;
  font-weight: 400;
  margin-bottom: 0;
}

.link {
  font-weight: 500;
  font-size: 14px;
  margin-top: 0 !important;
  a {
    text-decoration: none;
    color: #3a3a3a !important;
    span {
      color: inherit;
    }
  }
}
.information {
  color: #666666;
  font-weight: 400;
  font-size: 14px;
  margin-top: 5px !important;
}

.align-center {
  display: flex;
  align-items: center;
}
.align-start {
  display: flex;
  align-items: start;
}

.file-input {
  margin-top: 14px;
  p {
    margin-left: 10px;
    margin-top: 0;
    font-size: 14px;
    font-weight: 400;
  }
  button {
    background-color: #eeeeee !important;
    padding-left: 5px !important;
    padding-right: 5px !important;
    box-shadow: none;
    border-radius: 4px !important;
    span {
      font-size: 14px !important;
      letter-spacing: 0;
      font-weight: 400;
    }
  }
  .file-list {
    margin-bottom: 14px;
    div:nth-of-type(1) {
      flex: 0 0 auto !important;
    }
    p {
      margin-right: 10px;
      margin-left: 5px;
      margin-bottom: 3px;
    }
  }
  .remove-btn {
    background-color: transparent !important;
    padding-left: 0 !important;
    padding-right: 0 !important;
    svg {
      width: 18px;
      height: 18px;
    }
  }
  .border-red {
    border: 1px solid red;
  }

  button {
    letter-spacing: 0px !important;
  }
}
.dropzone .dz-preview {
  display: none !important;
}
</style>

````

</details>


---

### 📄 `src/modules/onBoarding/screens/lhOnm/ActivityScreen.vue` [20.217 octets]
<a id="src-modules-onBoarding-screens-lhOnm-ActivityScreen-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-screens-lhOnm-ActivityScreen-vue)

> **Chemin relatif** : `src/modules/onBoarding/screens/lhOnm/ActivityScreen.vue`  
> **Taille** : 20.217 octets  
> **Lignes** : 671  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (671 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <div class="activity-screen">
    <div class="mt-4 mb-4">
      <save-confirmation :hidden="activityViewModel.hideBox" :on-close="onClose" />
    </div>
    <h1 class="decoration--title" tabindex="-1">Activité</h1>

    <v-row class="mt-4">
      <v-col cols="12" sm="12" class="pt-0 pb-0">
        <selector
          label="Statut"
          :items="statusList"
          :mandatory="false"
          v-model="status"
          :default-value="status"
        />
      </v-col>
      <v-col cols="12" sm="12" class="pt-0 pb-0">
        <text-field
          label="Secteur d’activité"
          :required="true"
          :mandatory="false"
          :default-value="activityArea"
          v-model="activityArea"
        />
      </v-col>
      <v-col cols="12" sm="12" class="pt-0 pb-0">
        <text-field
          label="Fonction exercée"
          :required="true"
          :mandatory="false"
          :default-value="positionHeld"
          v-model="positionHeld"
        />
      </v-col>
      <v-col cols="12" sm="12" class="pt-0 pb-0">
        <text-field
          label="Fonction exercée apparaissant sur le décret"
          :required="true"
          :mandatory="false"
          :default-value="positionHeldOnDecree"
          v-model="positionHeldOnDecree"
        />
      </v-col>
      <v-col cols="12" sm="12" class="pt-0 pb-0">
        <text-field
          label="Adresse professionnelle"
          :required="true"
          :mandatory="false"
          :default-value="street"
          v-model="street"
        />
      </v-col>

      <v-col cols="6" sm="6" class="pt-0 pb-0 textfield">
        <text-field
          label="Code postal"
          :required="true"
          :mandatory="false"
          :default-value="zipCode"
          v-model="zipCode"
        />
      </v-col>
      <v-col cols="12" sm="6" class="pt-0 pb-0 textfield">
        <text-field
          label="Ville"
          :required="true"
          :mandatory="false"
          :default-value="city"
          v-model="city"
        />
      </v-col>

      <v-col cols="12" sm="6" class="pt-0 pb-0">
        <selector
          label="Pays"
          :items="countries"
          :mandatory="false"
          :default-value="country"
          v-model="country"
        />
      </v-col>

      <v-col cols="12" sm="12" class="pt-0 pb-0">
        <v-row>
          <v-col cols="12" sm="6" class="pt-0 pb-0">
            <text-field
              label="Mail"
              :required="true"
              :mandatory="false"
              v-model="email"
              :default-value="email"
            />
          </v-col>
          <v-col cols="12" sm="6" class="pt-0 pb-0">
            <text-field
              label="Téléphone/portable"
              :required="true"
              :mandatory="false"
              v-model="phone"
              :default-value="phone"
            />
          </v-col>
        </v-row>
      </v-col>
    </v-row>

    <v-row>
      <v-col
        cols="12"
        sm="12"
        class="pt-0 pb-0"
      >
        <p id="input-94">Le candidat est-il déjà décoré ?</p>
        <v-radio-group
          class="civilRecord__gender"
          row
          role="radiogroup"
          aria-labelledby="input-94"
          required
          v-model="isAlreadyDecorated"
        >
          <v-radio label="Oui" value="yes"></v-radio>
          <v-radio label="Non" value="no"></v-radio>
        </v-radio-group>
      </v-col>
      <v-col
        cols="12"
        sm="12"
        class="pt-0 pb-0"
      >
        <selector
          label="Grade obtenu"
          :mandatory="true"
          :items="[...Object.values(gradeList), 'N/A']"
          v-model="previousGrade"
          :default-value="previousGrade"
          :error-messages="previousGradeErrors"
          placeholder="Veuillez sélectionner le grade précédemment obtenu"
          v-if="isAlreadyDecorated === 'yes'"
        />
      </v-col>
      <v-col
        cols="12"
        sm="12"
        class="pt-0 pb-0"
      >
        <selector
          label="Précisez"
          :mandatory="true"
          :items="trainingActivities"
          v-model="trainingActivity"
          :default-value="trainingActivity"
          :error-messages="trainingActivityErrors"
          placeholder="Veuillez sélectionner le grade précédemment obtenu"
          v-if="isAlreadyDecorated === 'yes'"
        />
      </v-col>
      <v-col v-if="trainingActivity === 'Autre'" cols="12" sm="12" class="pt-0 pb-0">
        <text-field
            label="Précisez"
            :required="true"
            :mandatory="true"
            :default-value="trainingActivityOther"
            v-model="trainingActivityOther"
            :error-messages="trainingActivityOtherErrors"
        />
      </v-col>
      <v-col
        cols="12"
        sm="6"
        class="pt-0 pb-0"
      >
        <text-field
          label="Date de prise de rang"
          :required="false"
          :mandatory="true"
          :default-value="rankTakingDate"
          v-model="rankTakingDate"
          type="date"
          :error-messages="rankTakingDateErrors"
          v-if="isAlreadyDecorated === 'yes'"
        />
      </v-col>
      <v-col
        cols="12"
        sm="6"
        class="pt-0 pb-0"
      >
        <text-field
          label="Date du décret"
          :required="false"
          :default-value="decreeDate"
          :mandatory="true"
          v-model="decreeDate"
          :error-messages="decreeDateErrors"
          type="date"
          v-if="isAlreadyDecorated === 'yes'"
        />
      </v-col>
    </v-row>
    <div style="display: flex; align-items: center;">
      <img :src="parent" class="mr-2"/>
      <h3 style="font-size: 18px; font-weight: 500" class="mt-5 mb-5">Recommandant</h3>
    </div>

    <v-row>
      <v-col
        cols="12"
        sm="12"
        class="pt-0 pb-0"
      >
        <p id="input-94">Le candidat est-il déjà recommandé ?</p>
        <v-radio-group
          class="civilRecord__gender"
          row
          role="radiogroup"
          aria-labelledby="input-94"
          required
          v-model="isAlreadyRecommended"
        >
          <v-radio label="Oui" value="yes"></v-radio>
          <v-radio label="Non" value="no"></v-radio>
        </v-radio-group>
      </v-col>

      <v-col
        cols="12"
        sm="12"
        class="pt-0 pb-0"
        v-if="isAlreadyRecommended === 'yes'"
      >
        <p>Affiner votre recherche :</p>
        <div class="mt-3" style="display: flex;">
          <v-combobox
            id="birthName"
            :required="true"
            v-model="recommandantSearch"
            filled
            :search-input.sync="recommandantSearchFts"
            :cache-items="false"
            append-icon=""
            autocomplete="family-name"
          />
          <div class="magnify">
            <v-icon large style="margin-top: 3px"> {{ mdiMagnify }} </v-icon>
          </div>
        </div>
        <v-row justify="space-between" class="mt-1"  v-if="activityViewModel.recommandantSearch.length > 0">
          <v-col
            :class="`archive-items mb-5`"
            :style="`cursor: pointer;`"
            lg="5"
            v-for="item of activityViewModel.recommandantSearch.slice((page * limit) - limit, page * limit)"
            v-bind:key="item.id"
            @click="addRecommandand(item.id)"
            >
            <p style="font-weight: 500; margin-bottom: 5px;margin-top: 10px;">
              {{item.firstname}} {{item.lastname}}
            </p>
          </v-col>
        </v-row>
        <v-pagination
          v-if="activityViewModel.recommandantSearch.length > 0"
          :length="Math.ceil(activityViewModel.recommandantSearch.length / limit)"
          :disabled="false"
          :page="page"
          class="mt-5"
          :value="page"
          v-model="page"
          :total-visible="limit"
        ></v-pagination>
        <div  style="margin: 0 auto; text-align: center;" v-if="activityViewModel.recommandantSearch.length <= 0 && recommandantSearchFts && recommandantSearchFts.length > 3">
          <p style="text-align: left;" class="mb-10" tabindex="-1">
            Aucun recommandant ne correspond à votre recherche... ajoutez-en un
          </p>
        </div>
      </v-col>
      <v-col
        cols="12"
        sm="12"
        class="pb-0"
        v-if="isAlreadyRecommended === 'yes'"
      >
        <recommandant-form
          :recommandants="activityViewModel.recommandants"
          :on-add-recommandant="onAddRecommandant"
          :on-update-recommandant="onUpdateRecommandant"
          :allow-create="true"
          :on-remove-recommandant="onRemoveRecommandant"
          :allow-delete="true"
        />
      </v-col>
    </v-row>

    <v-row class="pt-3 justify-space-between">
      <div class="pl-3">
        <v-btn outlined color="primary" @click="goBack">
          <v-icon small style="margin-top: 3px"> {{ chevronLeft }} </v-icon>Retour
        </v-btn>
      </div>
      <div class="pr-3">
        <v-btn color="primary" @click="navigate()">
          Enregistrer et poursuivre&nbsp; <v-img alt="" style="margin-left: 5px" :aspect-ratio="1" />
          <v-icon small style="margin-top: 3px; margin-right: 5px">
            {{ contentSave }}
          </v-icon>
        </v-btn>
      </div>
    </v-row>

    <alert
      :open="confirmRecommandantSelection"
      :on-close="onConfirmRecommandantSelectionClose"
      :on-confirm="onConfirmRecommandantSelection"
      :with-confirmation="true"
      v-if="activityViewModel.selectedRecommandantInSearch"
    >
      <template v-slot:title>
        <h2 class="pb-3">
          Êtes-vous sûr de vouloir ajouter {{activityViewModel.selectedRecommandantInSearch.firstname}} {{activityViewModel.selectedRecommandantInSearch.lastname.toUpperCase()}} comme recommandant ?
        </h2>
      </template>
      <template v-slot:message>
      </template>
    </alert>
  </div>
</template>

<script lang="ts">
import { lazyInject, Validation } from "@pasta/box";
import Vue from "vue";
import Component from "vue-class-component";
import Stepper from "@/modules/onBoarding/components/Stepper.vue";
import {OnBoardingStepIndex, OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import SaveConfirmation from "@/modules/onBoarding/components/SaveConfirmation.vue";
import { ActivityViewModel } from "@/modules/onBoarding/viewModels/activity/ActivityViewModel";
import TextField from "@/components/TextField.vue";
import Selector from "@/components/Selector.vue";
import {helpers, requiredIf} from "vuelidate/lib/validators";
import {
  PersonalInformationViewModel
} from "@/modules/onBoarding/viewModels/personalInformation/PersonalInformationViewModel";
import {DateFormat} from "@/core/valueObjects/DateFormat";
import {TrainingInformationViewModel} from "@/modules/onBoarding/viewModels/training/TrainingInformationViewModel";
import {OnBoardingPath} from "@/modules/onBoarding/navigation/OnBoardingPath";
import {mdiChevronLeft, mdiContentSaveOutline, mdiMagnify,} from "@mdi/js";
import Alert from "@/components/Alert.vue";
import {Watch} from "vue-property-decorator";
import parent from "../../../../assets/parent.png";
import {Recommandant} from "@/core/entities/Recommandant";
import RecommandantForm from "@/modules/recommandants/components/RecommandantForm.vue";


@Component({
  components: {
    RecommandantForm,
    Alert,
    Stepper,
    SaveConfirmation,
    TextField,
    Selector,
  },
})
export default class ActivityScreen extends Vue {

  chevronLeft = mdiChevronLeft;
  contentSave = mdiContentSaveOutline;
  mdiMagnify = mdiMagnify;
  parent = parent;

  page = 1;

  limit = 4;


  @lazyInject(OnBoardingViewModel)
  declare onBoardingViewModel: OnBoardingViewModel;

  @lazyInject(ActivityViewModel)
  declare activityViewModel: ActivityViewModel;

  @lazyInject(TrainingInformationViewModel)
  declare trainingInformationViewModel: TrainingInformationViewModel;

  @lazyInject(PersonalInformationViewModel)
  declare personalInformationViewModel: PersonalInformationViewModel;

  statusList = ["Fonctionnaire", "Non fonctionnaire"];

  countries: string[] = [];

  gradeList = {
    KNIGHT : 'Chevalier',
    OFFICER : 'Officier',
    COMMANDER : 'Commandeur',
    GRAND_OFFICER: 'Grand Officier',
    GRAND_CROSS: 'Grand Croix'
  }

  trainingActivities = [
    "Arts et Lettres",
    "Jeunesse et des Sports",
    "Légion d’Honneur",
    "Médaille d’Honneur de l’Aéronautique",
    "Médaille d’Honneur des Chemins de Fer",
    "Médaille d’Honneur des Marins du Commerce et de la Pêche",
    "Médaille d’Honneur des Transports Routiers",
    "Médaille d’Honneur des Travaux Publics",
    "Médaille de l’Aéronautique",
    "Médaille du Tourisme",
    "Médaille Militaire",
    "Mérite Agricole",
    "Mérite Maritime",
    "ONM",
    "Ordre de la SNCF",
    "Ordre National du Mérite",
    "Palmes Académiques",
    "Autre",
  ]

  status = "Fonctionnaire"

  positionHeld = ""

  activityArea = ""

  positionHeldOnDecree = ""

  street = ""

  zipCode = ""

  city = ""

  country = "FRANCE"

  email = ""

  phone = ""

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner un grade obtenu",
      validator: requiredIf((val) => {
        return val.isAlreadyDecorated === 'yes';
      }),
    }
  })
  previousGrade: string | undefined = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner une valeur",
      validator: requiredIf((val) => {
        return val.isAlreadyDecorated === 'yes';
      }),
    }
  })
  trainingActivity = ""


  @Validation({
    required: {
      errorMessage: "Veuillez renseigner une valeur",
      validator: requiredIf((val) => {
        return val.isAlreadyDecorated === 'yes' && val.trainingActivity === 'Autre';
      }),
    }
  })
  trainingActivityOther = ""

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner une date valide",
      validator: requiredIf((val) => {
        return val.isAlreadyDecorated === 'yes';
      }),
    },
    isValid: {
      errorMessage: 'Veuillez renseigner une date valide',
      validator: helpers.withParams({
        type: 'decreeDate'
      }, (val: string) => {
        return DateFormat.validate(val);
      })
    }
  })
  decreeDate: string | undefined = ""


  @Validation({
    isValid: {
      errorMessage: 'Veuillez renseigner une date valide',
      validator: helpers.withParams({
        type: 'rankTakingDate'
      }, (val: string) => {
        return DateFormat.validate(val);
      })
    }
  })
  rankTakingDate: string | undefined = "";


  isAlreadyDecorated = "no";

  isAlreadyRecommended = "no";


  recommandantSearch = ""

  recommandantSearchFts = "";

  confirmRecommandantSelection = false;

  onConfirmRecommandantSelectionClose() {
    this.confirmRecommandantSelection = false;
  }


  onConfirmRecommandantSelection() {
    this.activityViewModel.addSearchRecommandant();
    this.confirmRecommandantSelection = false;
  }

  @Watch("recommandantSearchFts")
  async listenOnUserSearch(value: string) {
    if (value && value.length > 3) {
      await this.activityViewModel.searchRecommandant(value);
    }
  }


  async onAddRecommandant(recommandant: Recommandant) {
    this.activityViewModel.addRecommandant(recommandant)
  }

  async onUpdateRecommandant(recommandant: Recommandant) {
    this.activityViewModel.setUpdateRecommandant(recommandant)
  }

  async onRemoveRecommandant(id: string) {
    this.activityViewModel.removeRecommandant(id);
  }

  addRecommandand(id: string) {
    this.activityViewModel.onSelectRecommandantInSearch(id);
    this.confirmRecommandantSelection = true;
  }


  mounted() {
    const countriesLabel = this.personalInformationViewModel.countries.map(item => item.label.toUpperCase());
    const training = this.trainingInformationViewModel.trainingInformationState;
    this.countries = countriesLabel;
    this.activityViewModel.setRecommandantSearch([])
    this.isAlreadyRecommended = this.activityViewModel.recommandants.length > 0 ? 'yes' : 'no';
    if (this.activityViewModel.state) {
      const activity = this.activityViewModel.state;
      const countryCode = this.personalInformationViewModel.countries.find(item => item.code.toUpperCase() === activity.address.country);
      this.country = countryCode?.label.toUpperCase() as any;
      this.status= activity.status;
      this.positionHeld = activity.positionHeld;
      this.activityArea = activity.activityArea;
      this.positionHeldOnDecree = activity.positionHeldOnDecree;
      this.street = activity.address.street;
      this.zipCode = activity.address.zipCode;
      this.city = activity.address.city;
      this.email = activity.email;
      this.phone = activity.phone;
    }
    if (training?.distinction) {
      this.isAlreadyDecorated = "yes";
      this.decreeDate = training.distinction.decretDate;
      this.rankTakingDate = training.distinction.rankTakingDate;
      if (!training.previousGrade) {
        this.previousGrade = "N/A";
      } else {
        this.previousGrade = training.previousGrade;
      }
      if (training.gradeDetailTitle) {
        const isFromList = this.trainingActivities.find(elem => elem === training.gradeDetailTitle);
        if (!isFromList) {
          this.trainingActivity = 'Autre'
          this.trainingActivityOther = training.gradeDetailTitle
        } else {
          this.trainingActivity = training.gradeDetailTitle;
        }
      }
    }
  }

  goBack() {
    this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.DEFAULT)
    this.$router.push(OnBoardingPath.PERSONAL_INFORMATION);
  }

  onClose() {
    this.activityViewModel.setHiddenBox();
  }

  async navigate() {
    this.$v.$touch();
    const isError = this.$v.$invalid
    if (!isError) {
        if (this.isAlreadyRecommended === 'no') {
          this.activityViewModel.resetRecommandant();
        }
        const countryCode = this.personalInformationViewModel.countries.find(item => item.label.toUpperCase() === this.country);
        await this.activityViewModel.submit({
          id: this.personalInformationViewModel.presentationId,
          applicantId: this.personalInformationViewModel.applicantId,
          address: {
            city: this.city || "",
            country: countryCode?.code as any || "",
            street: this.street || "",
            zipCode: this.zipCode || "",
          },
          activityArea: this.activityArea || "",
          email: this.email || "",
          phone: this.phone || "",
          positionHeld: this.positionHeld || "",
          positionHeldOnDecree: this.positionHeldOnDecree || "",
          status: this.status || "",
          recommandants: this.activityViewModel.recommandants || "",
      })
      await this.trainingInformationViewModel.submit({
        quarter: "",
        quarterLicenseNumber: "",
        certificate: "",
        gradeDetailTitle: this.trainingActivity === 'Autre' ? this.trainingActivityOther : this.trainingActivity,
        alreadyDecorated: this.isAlreadyDecorated === "yes",
        ...(this.isAlreadyDecorated === "yes" && {
          distinction: {
            name: this.trainingActivity === 'Autre' ? this.trainingActivityOther : this.trainingActivity,
            decretDate: this.decreeDate,
            rankTakingDate: this.rankTakingDate,
          },
          previousGrade: this.previousGrade,
        })
      })
      this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.ANNUITY);
      this.activityViewModel.complete();
      return this.$router.push(OnBoardingPath.ANNUITY);
    }
  }
}
</script>

<style lang="scss">
.activity-screen {
  display: flex;
  flex-direction: column;
  .magnify {
    margin-bottom: 30px;
    background: #000091;
    border-top-right-radius: 4px;
    padding-left: 5px;
    padding-right: 5px;
    border-bottom: 3px solid #000091;
    span {
      color: white;
    }
  }
  .archive-items {
    border: 1px solid #EEEEEE;
    border-bottom: 4px solid #000091;
  }
}
</style>

````

</details>


---

### 📄 `src/modules/onBoarding/screens/lhOnm/Annuity.vue` [10.477 octets]
<a id="src-modules-onBoarding-screens-lhOnm-Annuity-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-screens-lhOnm-Annuity-vue)

> **Chemin relatif** : `src/modules/onBoarding/screens/lhOnm/Annuity.vue`  
> **Taille** : 10.477 octets  
> **Lignes** : 345  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (345 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <div class="annuity">
    <v-form class="civilRecord">
        <v-row>
          <v-col
            cols="12"
            sm="12"
            class="pt-0"
          >
            <h3>{{personalInformationViewModel.state.civility === "MR" ? "M" : "Mme"}} {{personalInformationViewModel.state.firstName}} {{personalInformationViewModel.state.birthName}} {{personalInformationViewModel.state.legalName ? `Ep. ${personalInformationViewModel.state.legalName}` : ''}}</h3>
          </v-col>
          <v-col cols="12" sm="12" class="mt-4 pt-0 pb-0">
            <h2 tabindex="-1">Grade proposé</h2>
          </v-col>

          <v-col cols="12" sm="12" class="pt-0 pb-0">
            <selector
              label="Promotion"
              :items="promotionList"
              :mandatory="true"
              v-model="promotion"
              :default-value="promotion"
              :error-messages="promotionErrors"
            />
          </v-col>

          <v-col cols="6" sm="6" class="pt-0 pb-0">
            <selector
              label="Grade proposé"
              :items="Object.values(gradeList)"
              :mandatory="true"
              v-model="grade"
              :default-value="grade"

            >
              <template v-slot:sublabel>
                <p class="info-box">
                  <span @click="openHelpDialog('grade')" class="underline">En savoir plus</span>
                </p>
              </template>
            </selector>
          </v-col>
          <v-col cols="6" sm="6" class="pt-0 pb-0">
            <selector
              label="Cabinet"
              v-if="promotion != ''"
              :items="cabinetList"
              :mandatory="true"
              v-model="office"
              :default-value="office"
              :error-messages="officeErrors"
            >
              <template v-slot:sublabel>
                <p class="info-box">
                  <span @click="openHelpDialog('office')" class="underline">En savoir plus</span>
                </p>
              </template>
            </selector>
          </v-col>

          <v-col cols="12" sm="12" class="pt-0 pb-0">
            <h2 tabindex="-1">Annuités générales</h2>
          </v-col>

          <v-col
            cols="12"
            sm="12"
            class="pt-0 pb-0"
          >
            <text-field
              label="Date de début"
              :required="false"
              :mandatory="true"
              :default-value="startDate"
              v-model="startDate"
              type="date"
            />
          </v-col>

        </v-row>
    </v-form>

    <v-row>
      <v-col cols="12" sm="12" class="mt-8 pt-0 pb-0">
        <h2 tabindex="-1">Total services effectués</h2>
      </v-col>
    </v-row>
    <div style="display: flex" class="mt-10">
      <div class="mr-5">
        <date-box
          :count="isNaN(dayjs().diff(startDate)) ? '0' : Math.floor(dayjs().diff(startDate) / (1000 * 60 * 60 * 24 * 365)).toString()"
          title="Années"
        />
      </div>
      <div class="mr-5">
        <date-box
          :count="isNaN(dayjs().diff(startDate)) ? '0' : Math.floor((dayjs().diff(startDate) % (1000 * 60 * 60 * 24 * 365)) / (1000 * 60 * 60 * 24 * 30.4375)).toString()"
          title="Mois"
        />
      </div>

      <div>
        <date-box
          :count="isNaN(dayjs().diff(startDate)) ? '0' : Math.floor((dayjs().diff(startDate) % (1000 * 60 * 60 * 24 * 365)) % (1000 * 60 * 60 * 24 * 30.4375) / (1000 * 60 * 60 * 24)).toString()"
          title="Jours"
        />
      </div>
    </div>

    <v-row class="mt-10">
      <v-col
        cols="12"
        sm="12"
        class="pt-0 pb-0"
      >
        <text-field
          label="Synthèse du motif de proposition"
          :required="false"
          :default-value="reasonProposal"
          :mandatory="true"
          v-model="reasonProposal"
          field-type="text-area"
          sub-label="Le mémoire sera à déposer avec les documents à l'étape suivante"
        />
      </v-col>
    </v-row>

    <v-row class="mt-10 pt-3 justify-space-between">
      <div class="pl-3">
        <v-btn outlined color="primary" @click="goBack">
          <v-icon small style="margin-top: 3px"> {{ chevronLeft }} </v-icon>Retour
        </v-btn>
      </div>
      <div class="pr-3">
        <v-btn color="primary" @click="navigate()">
          Enregistrer et poursuivre&nbsp; <v-img alt="" style="margin-left: 5px" :aspect-ratio="1" />
          <v-icon small style="margin-top: 3px; margin-right: 5px">
            {{ contentSave }}
          </v-icon>
        </v-btn>
      </div>
    </v-row>

    <alert
      :open="helpDialogOpen"
      :on-close="onHelpDialogClose"
    >

      <template v-slot:title>
        <h2 class="pb-3">
          {{helpDialogTitle}}
        </h2>
      </template>
      <template v-slot:message>
        <p>
          {{helpDialogMessage}}
        </p>
      </template>

    </alert>
  </div>
</template>

<script lang="ts">
import {lazyInject, Validation} from "@pasta/box";
import Vue from "vue";
import Component from "vue-class-component";
import Stepper from "@/modules/onBoarding/components/Stepper.vue";
import {
  PersonalInformationViewModel
} from "@/modules/onBoarding/viewModels/personalInformation/PersonalInformationViewModel";
import {mdiChevronLeft, mdiContentSaveOutline} from "@mdi/js";
import Selector from "@/components/Selector.vue";
import TextField from "@/components/TextField.vue";
import DateBox from "@/modules/onBoarding/components/DateBox.vue";
import dayjs from "dayjs";
import Alert from "@/components/Alert.vue";
import {AnnuityViewModel} from "@/modules/onBoarding/viewModels/annuity/AnnuityViewModel";
import {Grade} from "@/core/types/training/Grade";
import {OnBoardingStepIndex, OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {OnBoardingPath} from "@/modules/onBoarding/navigation/OnBoardingPath";
import {required, requiredIf} from "vuelidate/lib/validators";
import {TrainingInformationViewModel} from "@/modules/onBoarding/viewModels/training/TrainingInformationViewModel";
import {HomeViewModel} from "@/modules/home/viewModels/HomeViewModel";
import {Watch} from "vue-property-decorator";
import {DecorationType} from "@/modules/onBoarding/types/DecorationType";

@Component({
  methods: {dayjs},
  components: {
    Alert,
    DateBox,
    TextField,
    Selector,
    Stepper,
  }
})
export default class Annuity extends Vue {

  @lazyInject(PersonalInformationViewModel)
  declare personalInformationViewModel: PersonalInformationViewModel;

  chevronLeft = mdiChevronLeft;
  contentSave = mdiContentSaveOutline;

  @lazyInject(AnnuityViewModel)
  declare annuityViewModel: AnnuityViewModel;

  @lazyInject(OnBoardingViewModel)
  declare onBoardingViewModel: OnBoardingViewModel;

  @lazyInject(TrainingInformationViewModel)
  declare trainingInformationViewModel: TrainingInformationViewModel;

  @lazyInject(HomeViewModel)
  declare homeViewModel: HomeViewModel;

  helpDialogOpen = false
  helpDialogTitle = ""
  helpDialogMessage = ""

  gradeList = {
    KNIGHT : 'Chevalier',
    OFFICER : 'Officier',
    COMMANDER : 'Commandeur',
    GRAND_OFFICER: 'Grand Officier',
    GRAND_CROSS: 'Grand Croix'
  }

  grade = "";

  @Validation({
        required: {
            errorMessage: "Veuillez renseigner un cabinet",
            validator: required,
        }
  })
  office = ""

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner une promotion",
      validator: required,
    }
  })
  promotion = "";


  cabinetList: string[] = []
  promotionList: string[] = [];

  startDate = ""

  reasonProposal = ""

  goBack() {
    this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.ACTIVITY)
    return this.$router.push(OnBoardingPath.ACTIVITY);
  }

  openHelpDialog(type: string) {
    if (type === "office") {
     this.helpDialogTitle = "Cabinet"
     this.helpDialogMessage = "a completer"
    }
    if (type === "grade") {
      this.helpDialogTitle = "Grade"
      this.helpDialogMessage = "a completer"
    }
    this.helpDialogOpen = true;
  }

  @Watch('promotion')
  onPromotionChange(value: string) {
    const promotion = this.homeViewModel.sessions.find(elem => elem.name === value);
    this.cabinetList = [];
    this.office = ""
    if (promotion && promotion.decoration !== DecorationType.MERITE_MARITIME) {
      this.cabinetList = promotion.quotas.map(elem => elem.cabinet);
      const state = this.annuityViewModel.state;
      if (state) {
        this.office = state.office;
      }
    }
  }

  onHelpDialogClose() {
    this.helpDialogOpen = false
  }


  mounted() {
      const state = this.annuityViewModel.state;
      this.promotionList = this.homeViewModel.sessions.filter(item => item.decoration === this.onBoardingViewModel.selectedDecoration && item.closedAt == null).map(elem => elem.name)
      if (state) {
          if (state.startDate) {
              this.startDate = dayjs(state.startDate).format('YYYY-MM-DD')
          }
          if (state.sessionId) {
            const promotion = this.homeViewModel.sessions.find(elem => elem.id === state.sessionId);
            if (promotion) {
              this.promotion = promotion.name;
            }
          }
          this.grade = state.grade;
          this.reasonProposal = state.reasonProposal;
          this.office = state.office;
      }
  }

    async navigate() {
        this.$v.$touch();
        const isError = this.$v.$invalid;
        if (!isError) {
          const selectedPromotion = this.homeViewModel.sessions.find(elem => elem.name === this.promotion);
          if (selectedPromotion) {
            await this.annuityViewModel.submit({
              ...(this.startDate !== "" && {
                startDate: new Date(this.startDate)
              }),
              reasonProposal: this.reasonProposal,
              grade: this.grade as Grade,
              office: this.office,
              id: this.personalInformationViewModel.presentationId,
              sessionId: selectedPromotion.id,
            })
          }

            this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.DOCUMENTS);
            this.annuityViewModel.complete();
            return this.$router.push(OnBoardingPath.DOCUMENTS);
        }

  }

}
</script>

<style lang="scss">
.annuity {
  display: flex;
  flex-direction: column;
}
</style>

````

</details>


---

### 📄 `src/modules/onBoarding/screens/meriteMaritime/DemandInformation.vue` [23.965 octets]
<a id="src-modules-onBoarding-screens-meriteMaritime-DemandInformation-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-screens-meriteMaritime-DemandInformation-vue)

> **Chemin relatif** : `src/modules/onBoarding/screens/meriteMaritime/DemandInformation.vue`  
> **Taille** : 23.965 octets  
> **Lignes** : 723  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (723 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <div>
    <v-form class="civilRecord">
      <v-container>
        <v-row>
          <v-col
            cols="12"
            sm="12"
            class="pt-0"
          >
            <h3>{{personalInformationViewModel.state.civility === "MR" ? "M" : "Mme"}} {{personalInformationViewModel.state.firstName}} {{personalInformationViewModel.state.birthName}} {{personalInformationViewModel.state.legalName ? `Ep. ${personalInformationViewModel.state.legalName}` : ''}}</h3>
            <h2 tabindex="-1">Grade demandé</h2>
          </v-col>
          <v-col
            cols="12"
            sm="12"
            class="pt-0"
          >
            <selector
              label="Contingent"
              :items="contingentList"
              v-model="contingentType"
              :mandatory="true"
              :default-value="contingentType"
              :error-messages="contingentTypeErrors"
              placeholder="Veuillez sélectionner une option"
            >
              <template v-slot:sublabel>
                <p class="info-box">
                  <v-icon small style="vertical-align: bottom;">
                    {{infoOutline}}
                  </v-icon>
                  <span @click="openHelpDialog('contingent_type')" class="underline">En savoir plus</span>
                </p>
              </template>
            </selector>
          </v-col>
        </v-row>
        <v-row v-if="['A', 'C', 'B', 'E'].includes(contingentType)">
          <v-col
            cols="12"
            sm="12"
            class="pt-0 pb-0"
          >
            <selector
              label="Grade proposé"
              :items="Object.values(gradeList)"
              v-model="grade"
              :mandatory="true"
              :default-value="grade"
              :error-messages="gradeErrors"
              placeholder="Veuillez sélectionner un grade"
            >
              <template v-slot:sublabel>
                <p class="info-box">
                  <v-icon small style="vertical-align: bottom;">
                    {{infoOutline}}
                  </v-icon>
                  <span @click="openHelpDialog('grade')" class="underline">En savoir plus</span>
                </p>
              </template>
            </selector>
          </v-col>
          <v-col
            cols="12"
            sm="12"
            class="pt-0 pb-0"
            v-if="Object.values(gradeList).includes(grade)"
          >
            <selector
              label="Motif de la décoration"
              :items="reasonGradeProposals"
              v-model="reasonGradeProposalValue"
              :mandatory="true"
              :default-value="reasonGradeProposalValue"
              :error-messages="reasonGradeProposalValueErrors"
              placeholder="Veuillez sélectionner un motif"
            />
          </v-col>

          <v-col
            cols="12"
            sm="12"
            class="pt-0 pb-0"
            v-if="reasonGradeProposal === 'exceptional_fact' && grade === 'Chevalier'"
          >
            <selector
              label="Préciser"
              :items="exceptionalFactList"
              v-model="selectedExceptionalFact"
              :mandatory="true"
              :default-value="selectedExceptionalFact"
              :error-messages="selectedExceptionalFactErrors"
              placeholder="Veuillez sélectionner un motif"
            />
          </v-col>

          <v-col
            cols="12"
            sm="12"
            class="pt-0 pb-0"
            v-if="reasonGradeProposal === 'exceptional_fact' && grade !== 'Chevalier'"
          >
            <selector
              label="Préciser"
              :items="exceptionalFactList"
              v-model="selectedExceptionalFact"
              :default-value="selectedExceptionalFact"
              :mandatory="true"
              :error-messages="selectedExceptionalFactErrors"
              placeholder="Veuillez sélectionner un motif"
            />
          </v-col>

          <v-col
            v-if="reasonGradeProposal === 'duration' && contingentType === 'A'"
            cols="12"
            sm="12"
            class="pt-0 pb-0"
          >
            <p class="sublabel">
              Durée de navigation à titre civil
            </p>
          </v-col>
          <v-col
            v-if="reasonGradeProposal === 'duration' && contingentType === 'A'"
            cols="6"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="En années"
              :required="false"
              :mandatory="true"
              :default-value="civilNavigationDurationInYears"
              v-model="civilNavigationDurationInYears"
              type="number"
            />
          </v-col>
          <v-col
            v-if="reasonGradeProposal === 'duration' && contingentType === 'A'"
            cols="6"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="En mois"
              :required="false"
              :mandatory="true"
              :default-value="civilNavigationDurationInMonths"
              v-model="civilNavigationDurationInMonths"
              type="number"
            />
          </v-col>

          <v-col
            v-if="reasonGradeProposal === 'duration' && contingentType === 'A'"
            cols="12"
            sm="12"
            class="pt-0 pb-0"
          >
            <p class="sublabel">
              Durée de navigation à titre militaire
            </p>
          </v-col>

          <v-col
            v-if="reasonGradeProposal === 'duration' && contingentType === 'A'"
            cols="6"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="En années"
              :required="false"
              :mandatory="true"
              :default-value="militaryNavigationDurationYears"
              v-model="militaryNavigationDurationYears"
              type="number"
            />
          </v-col>
          <v-col
            v-if="reasonGradeProposal === 'duration' && contingentType === 'A'"
            cols="6"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="En mois"
              :mandatory="true"
              :required="false"
              :default-value="militaryNavigationDurationInMonth"
              v-model="militaryNavigationDurationInMonth"
              type="number"
            />
          </v-col>


          <v-col
            v-if="reasonGradeProposal === 'duration' && contingentType === 'A'"
            cols="12"
            sm="12"
            class="pt-0 pb-0"
          >
            <p class="sublabel">
              Durée autre activité
            </p>
          </v-col>

          <v-col
            v-if="reasonGradeProposal === 'duration' && contingentType === 'A'"
            cols="6"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="En années"
              :required="false"
              :mandatory="true"
              :default-value="otherActivityInYears"
              v-model="otherActivityInYears"
              type="number"
            />
          </v-col>
          <v-col
            v-if="reasonGradeProposal === 'duration' && contingentType === 'A'"
            cols="6"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="En mois"
              :required="false"
              :mandatory="true"
              :default-value="otherActivityDuration"
              v-model="otherActivityDuration"
              type="number"
            />
          </v-col>

          <v-col
            v-if="reasonGradeProposal === 'duration' && ['C', 'B', 'E'].includes(contingentType)"
            cols="12"
            sm="12"
            class="pt-0 pb-0"
          >
            <p class="sublabel">
              Durée des activités dans le domaine maritime
            </p>
          </v-col>

          <v-col
            v-if="reasonGradeProposal === 'duration' && ['C', 'B', 'E'].includes(contingentType)"
            cols="6"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="En années"
              :required="false"
              :mandatory="true"
              :default-value="maritimeActivityInYears"
              v-model="maritimeActivityInYears"
              type="number"
            />
          </v-col>

          <v-col
            v-if="reasonGradeProposal === 'duration' && ['C', 'B', 'E'].includes(contingentType)"
            cols="6"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="En mois"
              :required="false"
              :mandatory="true"
              :default-value="maritimeActivityDuration"
              v-model="maritimeActivityDuration"
              type="number"
            />
          </v-col>


        </v-row>

        <v-row>
          <v-col
            v-if="['A', 'C', 'B', 'E'].includes(contingentType)"
            cols="12"
            sm="12"
            class="pt-0 pb-0"
          >
            <text-field
              label="Fonction au titre de laquelle la décoration est demandée"
              :required="false"
              :default-value="askedPosition"
              v-model="askedPosition"
              :mandatory="true"
              sub-label="En minuscule et sans sigle (doit être écrit en toutes lettres)"
              :error-messages="askedPositionErrors"
              :maxLength="200"
            />
          </v-col>
          <v-col
            cols="12"
            sm="12"
            class="pt-0 pb-0"
            v-if="['A', 'C'].includes(contingentType)"
          >
            <selector
              label="Secteur d'activité"
              :items="activityAreaList"
              :mandatory="true"
              v-model="activityArea"
              :default-value="activityArea"
              :error-messages="activityAreaErrors"
              placeholder="Veuillez sélectionner un secteur d'activité"
            >
              <template v-slot:sublabel>
                <p class="info-box">
                  <v-icon small style="vertical-align: bottom;">
                    {{infoOutline}}
                  </v-icon>
                  <span @click="openHelpDialog('activity_area')" class="underline">En savoir plus</span>
                </p>
              </template>
            </selector>
          </v-col>
          <v-col
            cols="12"
            sm="12"
            class="pt-0 pb-0"
          >
            <text-field
              label="Motif de la proposition (Mémoire)"
              :required="false"
              :default-value="reasonProposal"
              :mandatory="true"
              v-model="reasonProposal"
              :error-messages="reasonProposalErrors"
              field-type="text-area"
            />
          </v-col>
        </v-row>
        <v-row class="pt-3 justify-space-between">
          <div class="pl-3">
            <v-btn outlined color="primary" @click="goBack">
              <v-icon small style="margin-top: 3px">
                {{ chevronLeft }}
              </v-icon>Retour
            </v-btn>
          </div>
          <div class="pr-3">
            <v-btn color="primary" @click="submit">
              Enregistrer et poursuivre <v-icon small style="margin-top: 3px">
              {{ chevronRight }}
            </v-icon>
            </v-btn>
          </div>
        </v-row>
      </v-container>
    </v-form>
    <contingent-type-help-dialog
      :open="openContingentTypeHelpDialog"
      :on-close="onClose"
    />
    <grade-help-dialog
      :open="openGradeTypeHelpDialog"
      :on-close="onClose"
    />
    <activity-area-help-dialog
      :open="openActivityAreaHelpDialog"
      :on-close="onClose"
      :contingent-type="contingentType"
    />
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import SaveConfirmation from "@/modules/onBoarding/components/SaveConfirmation.vue";
import TextField from "@/components/TextField.vue";
import Selector from "@/components/Selector.vue";
import {ContingentType} from "@/core/types/training/ContingentType";
import {lazyInject, Validation} from "@pasta/box";
import {required, requiredIf} from "vuelidate/lib/validators";
import {OnBoardingStepIndex, OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {OnBoardingPath} from "@/modules/onBoarding/navigation/OnBoardingPath";
import {mdiArrowRight, mdiChevronLeft, mdiChevronRight, mdiInformationOutline} from '@mdi/js';
import Alert from "@/components/Alert.vue";
import {DemandInformationViewModel} from "@/modules/onBoarding/viewModels/demand/DemandInformationViewModel";
import ContingentTypeHelpDialog from "@/modules/onBoarding/components/help/ContingentTypeDialog.vue";
import GradeHelpDialog from "@/modules/onBoarding/components/help/GradeHelpDialog.vue";
import {Watch} from "vue-property-decorator";
import {Grade} from "@/core/types/training/Grade";
import {knightReasonProposal} from "@/modules/onBoarding/resources/knightReasonProposal";
import {officerReasonProposal} from "@/modules/onBoarding/resources/officerReasonProposal";
import {commanderReasonProposal} from "@/modules/onBoarding/resources/commanderReasonProposal";
import {ReasonGradeProposal} from "@/core/types/training/ReasonGradeProposal";
import {civilActivityArea} from "@/modules/onBoarding/resources/civilActivityArea";
import {administrativeActivityArea} from "@/modules/onBoarding/resources/administrativeActivityArea";
import ActivityAreaHelpDialog from "@/modules/onBoarding/components/help/activityArea/ActivityAreaHelpDialog.vue";
import {
  PersonalInformationViewModel
} from "@/modules/onBoarding/viewModels/personalInformation/PersonalInformationViewModel";
import { knightDerogationList } from "../../resources/knightDerogationList";
import {officerAndCommanderDerogation} from "@/modules/onBoarding/resources/officerAndCommanderDerogation";

@Component({
  components: {
    SaveConfirmation,
    TextField,
    Selector,
    Alert,
    ContingentTypeHelpDialog,
    GradeHelpDialog,
    ActivityAreaHelpDialog
  }
})
export default class DemandInformation extends Vue {

  @lazyInject(OnBoardingViewModel)
  declare onBoardingViewModel: OnBoardingViewModel;

  @lazyInject(DemandInformationViewModel)
  declare demandInformationViewModel: DemandInformationViewModel;

  @lazyInject(PersonalInformationViewModel)
  declare personalInformationViewModel: PersonalInformationViewModel;


  contingentList: ContingentType[] = Object.values(ContingentType);

  chevronLeft = mdiChevronLeft;
  chevronRight = mdiChevronRight;
  infoOutline = mdiInformationOutline;
  arrowRight = mdiArrowRight;
  activityAreaList: string[] = [];

  reasonGradeProposals: string[] = [];

  openContingentTypeHelpDialog = false;

  exceptionalFactList: string[] = [];



  civilNavigationDurationInMonths = "0";
  civilNavigationDurationInYears = "0";

  militaryNavigationDurationInMonth = "0";
  militaryNavigationDurationYears = "0";

  otherActivityDuration = "0";
  otherActivityInYears = "0";

  maritimeActivityDuration = "0";
  maritimeActivityInYears = "0";



  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre contingent",
      validator: required,
    }
  })
  contingentType = "";


  @Validation({
    required: {
      errorMessage: "Veuillez renseigner un motif de proposition",
      validator: required
    }
  })
  reasonProposal = "";


  reasonGradeProposal = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre grade",
      validator: requiredIf((val: any) => {
        return [
          ContingentType.CIVIL,
          ContingentType.ADMINISTRATIVE
        ].includes(val.contingentType);
      }),
    }
  })
  grade = "";

  //
  @Validation({
    required: {
      errorMessage: "Veuillez préciser le motif de la dérogation",
      validator: requiredIf((val: any) => {
        return val.reasonGradeProposal === 'exceptional_fact' && val.grade === 'Chevalier'
      }),
    }
  })
  selectedExceptionalFact = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre grade",
      validator: requiredIf((val: any) => {
        return [
          ContingentType.CIVIL,
          ContingentType.ADMINISTRATIVE,
        ].includes(val.contingentType);
      }),
    }
  })
  reasonGradeProposalValue = "";


  @Validation({
    required: {
      errorMessage: "Veuillez renseigner une fonction demandée",
      validator: requiredIf((val: any) => {
        return [
          ContingentType.CIVIL,
          ContingentType.ADMINISTRATIVE,
          ContingentType.DEFENSE
        ].includes(val.contingentType);
      }),
    }
  })
  askedPosition = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner une fonction demandée",
      validator: requiredIf((val: any) => {
        return [
          ContingentType.CIVIL,
          ContingentType.ADMINISTRATIVE,
        ].includes(val.contingentType);
      }),
    }
  })
  activityArea = "";

  gradeList = {
    KNIGHT : 'Chevalier',
    OFFICER : 'Officier',
    COMMANDER : 'Commandeur'
  }

  openGradeTypeHelpDialog = false;
  openActivityAreaHelpDialog = false;

  openHelpDialog(type: string) {
    if (type === "contingent_type") {
      this.openContingentTypeHelpDialog = true;
    }
    if (type === "grade") {
      this.openGradeTypeHelpDialog = true;
    }
    if (type === "activity_area") {
      this.openActivityAreaHelpDialog = true;
    }
  }

  onClose() {
    this.openContingentTypeHelpDialog = false;
    this.openGradeTypeHelpDialog = false;
    this.openActivityAreaHelpDialog = false;
  }

  async submit() {
    this.$v.$touch();
    const isError = this.$v.$invalid;
    if (!isError) {
      await this.demandInformationViewModel.submit({
        reasonProposal: this.reasonProposal,
        grade: this.grade as any,
        reasonGradeProposal: this.reasonGradeProposal as any,
        askedPosition: this.askedPosition,
        activityArea: this.activityArea,
        civilNavigationDurationInMonths: (+this.civilNavigationDurationInMonths + Math.ceil(+this.civilNavigationDurationInYears * 12)).toString(),
        militaryNavigationDurationInMonth: (+this.militaryNavigationDurationInMonth + Math.ceil(+this.militaryNavigationDurationYears * 12)).toString(),
        otherActivityDuration: (+this.otherActivityDuration + Math.ceil(+this.otherActivityInYears * 12)).toString(),
        contingentType: this.contingentType as any,
        maritimeActivityDuration: (+this.maritimeActivityDuration + Math.ceil(+this.maritimeActivityInYears * 12)).toString(),
        reasonForExceptionalFact: this.selectedExceptionalFact,
      })
      this.demandInformationViewModel.complete();
      this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.DOCUMENTS);
      return this.$router.push(OnBoardingPath.DOCUMENTS);
    }
  }

  async mounted() {
    focus();
    const state = this.demandInformationViewModel.state;
    if (state) {
      this.reasonProposal = state.reasonProposal;
      this.maritimeActivityDuration = (+state.maritimeActivityDuration % 12).toString();;
      this.maritimeActivityInYears = Math.floor(+state.maritimeActivityDuration / 12).toString();

      this.contingentType = state.contingentType || "";
      this.otherActivityDuration = isNaN(+state.otherActivityDuration) ? "0" : (+state.otherActivityDuration % 12).toString();
      this.otherActivityInYears = isNaN(+state.otherActivityDuration) ? "0" : Math.floor(+state.otherActivityDuration / 12).toString();
      this.militaryNavigationDurationInMonth = isNaN(+state.militaryNavigationDurationInMonth) ? "0" : (+state.militaryNavigationDurationInMonth % 12).toString();
      this.militaryNavigationDurationYears = isNaN(+state.militaryNavigationDurationInMonth) ? "0" : Math.floor(+state.militaryNavigationDurationInMonth / 12).toString()
      this.civilNavigationDurationInMonths = isNaN(+state.civilNavigationDurationInMonths) ? "0" : (+state.civilNavigationDurationInMonths % 12).toString();
      this.civilNavigationDurationInYears = isNaN(+state.civilNavigationDurationInMonths) ? "0" : Math.floor(+state.civilNavigationDurationInMonths / 12).toString()

      this.askedPosition = state.askedPosition || "";
      this.activityArea = state.activityArea || "";

      this.grade = state.grade;
      this.reasonGradeProposal = state.reasonGradeProposal;
      this.reasonGradeProposalValue = await this.demandInformationViewModel.toReasonGradeProposalValue();
      this.reasonGradeProposals = await this.demandInformationViewModel.getReasonProposalList();
      this.selectedExceptionalFact = state.reasonForExceptionalFact;
    }
  }

  goBack() {
    this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.TRAINING_INFORMATION);
    return this.$router.back();
  }

  @Watch('contingentType')
  onContingentTypeChange(value: string) {
    switch(value) {
      case ContingentType.CIVIL:
        this.activityAreaList = civilActivityArea;
        break;
      case ContingentType.ADMINISTRATIVE:
        this.activityAreaList = administrativeActivityArea;
        break;
      default:
        this.activityAreaList = [];
    }
  }

  @Watch('grade')
  onGradeChange(value: string) {
    if (value === Grade.KNIGHT) {
      this.reasonGradeProposals = Object.values(knightReasonProposal);
      this.reasonGradeProposal = "";
      this.reasonGradeProposalValue = "";
      this.selectedExceptionalFact = "";
    }
    if (value === Grade.OFFICER) {
      const officerReasonProposals = Object.values(officerReasonProposal)
      this.reasonGradeProposals = officerReasonProposals.filter(elem => elem != officerReasonProposals[1])
      this.reasonGradeProposal = "";
      this.reasonGradeProposalValue = "";
      this.selectedExceptionalFact = "";
    }
    if (value === Grade.COMMANDER) {
      const commanderReasonsProposals = Object.values(commanderReasonProposal)
      this.reasonGradeProposals = commanderReasonsProposals.filter(elem => elem != commanderReasonsProposals[1]);
      this.reasonGradeProposal = "";
      this.reasonGradeProposalValue = "";
      this.selectedExceptionalFact = "";
    }
  }

  @Watch('reasonGradeProposalValue')
  onReasonGradeProposal(value: string) {
    const durations = [
      knightReasonProposal.duration,
      officerReasonProposal.duration,
      commanderReasonProposal.duration
    ]
    const equivalentGrade = [
      officerReasonProposal.equivalent_grade,
      commanderReasonProposal.equivalent_grade,
    ]
    const exceptionalFact = [
      knightReasonProposal.exceptional_fact,
      officerReasonProposal.exceptional_fact,
      commanderReasonProposal.exceptional_fact,
    ]

    if (durations.includes(value)) {
      this.reasonGradeProposal = ReasonGradeProposal.DURATION;
      this.selectedExceptionalFact = "";
    }
    if (equivalentGrade.includes(value)) {
      this.reasonGradeProposal = ReasonGradeProposal.EQUIVALENT_GRADE;
      this.selectedExceptionalFact = "";
    }
    if (exceptionalFact.includes(value)) {
      this.reasonGradeProposal = ReasonGradeProposal.EXCEPTIONAL_FACT;
      if (this.grade === 'Chevalier') {
        this.exceptionalFactList = Object.values(knightDerogationList);
      } else {
        this.exceptionalFactList = Object.values(officerAndCommanderDerogation);
      }
    }
  }

}
</script>
<style lang="scss">
@import "../../../../styles/variables";

.info-box {
  margin-top: 0px!important;
  font-size: 12px;
  color: #666666!important;
}

.underline {
  text-decoration: underline;
  cursor: pointer;
}
.bolder {
  font-weight: 700;
}
</style>

````

</details>


---

### 📄 `src/modules/onBoarding/screens/meriteMaritime/TrainingInformation.vue` [11.670 octets]
<a id="src-modules-onBoarding-screens-meriteMaritime-TrainingInformation-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-screens-meriteMaritime-TrainingInformation-vue)

> **Chemin relatif** : `src/modules/onBoarding/screens/meriteMaritime/TrainingInformation.vue`  
> **Taille** : 11.670 octets  
> **Lignes** : 395  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (395 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <v-form class="civilRecord" v-if="!loading">
    <v-container>
      <v-row>
        <v-col
          cols="12"
          sm="12"
          class="pt-0"
        >
          <save-confirmation
            :on-close="onClose"
            :hidden="hidden"
          />
        </v-col>
        <v-col
          cols="12"
          sm="12"
          class="pt-0"
        >
          <h3>{{personalInformationViewModel.state.civility === "MR" ? "M" : "Mme"}} {{personalInformationViewModel.state.firstName}} {{personalInformationViewModel.state.birthName}} {{personalInformationViewModel.state.legalName ? `Ep. ${personalInformationViewModel.state.legalName}` : ''}}</h3>
          <h2 tabindex="-1">Parcours du candidat</h2>
        </v-col>
        <v-col
          cols="12"
          sm="6"
          class="pt-0 pb-0 textfield"
        >
          <label style="color: #161616;" for="quarter">Quartier (facultatif)</label>
          <v-combobox
            class="mt-3"
            id="quarter"
            v-model="quarter"
            :items="cities"
            filled
            :default-value="quarter"
            append-icon=""
          />
        </v-col>
        <v-col
          cols="12"
          sm="6"
          class="pt-0 pb-0"
        >
          <selector
            label="Brevet (facultatif)"
            :items="certificateList"
            :default-value="certificate"
            v-model="certificate"
            placeholder="Sélectionnez une option"
          />
        </v-col>
        <v-col
          cols="12"
          sm="6"
          class="pt-5 pb-0"
          v-if="certificate === certificateList[certificateList.length - 1]"
        >
          <text-field
            label="Précisez"
            :required="false"
            :default-value="otherCertificate"
            v-model="otherCertificate"
            :error-messages="otherCertificateErrors"
          />
        </v-col>
        <v-col
          cols="12"
          sm="6"
          class="pt-0 pb-0"
        >
          <text-field
            label="Numéro de marin (facultatif)"
            :required="false"
            :default-value="quarterLicenseNumber"
            v-model="quarterLicenseNumber"
          />
        </v-col>
      </v-row>
      <v-row>
        <v-col
          cols="12"
          sm="12"
          class="pt-0 pb-0"
        >
          <p id="input-94">Le candidat est-il déjà décoré ?</p>
          <v-radio-group
            class="civilRecord__gender"
            row
            role="radiogroup"
            aria-labelledby="input-94"
            required
            v-model="isAlreadyDecorated"
          >
            <v-radio label="Oui" value="yes"></v-radio>
            <v-radio label="Non" value="no"></v-radio>
          </v-radio-group>
        </v-col>
        <v-col
          cols="12"
          sm="12"
          class="pt-0 pb-0"
        >
          <selector
            label="Grade obtenu"
            :mandatory="true"
            :items="[...Object.values(gradeList), 'N/A']"
            v-model="previousGrade"
            :default-value="previousGrade"
            :error-messages="previousGradeErrors"
            placeholder="Veuillez sélectionner le grade précédemment obtenu"
            v-if="isAlreadyDecorated === 'yes'"
          />
        </v-col>
        <v-col
          cols="12"
          sm="4"
          class="pt-0 pb-0"
        >
          <selector
            label="Précisez"
            :mandatory="true"
            :items="['Ordre national du mérite', 'Légion d\'honneur', 'Mérite Maritime', 'Médaille d\'honneur']"
            v-model="distinctionName"
            :default-value="distinctionName"
            placeholder="Veuillez sélectionner une option"
            :error-messages="distinctionNameErrors"
            v-if="isAlreadyDecorated === 'yes'"
          />
        </v-col>
        <v-col
          cols="12"
          sm="4"
          class="pt-0 pb-0"
        >
          <text-field
            label="Date du décret"
            :required="false"
            :default-value="decreeDate"
            :mandatory="true"
            v-model="decreeDate"
            :error-messages="decreeDateErrors"
            type="date"
            v-if="isAlreadyDecorated === 'yes'"
          />
        </v-col>
        <v-col
          cols="12"
          sm="4"
          class="pt-0 pb-0"
        >
          <text-field
            label="Date de prise de rang"
            :required="false"
            :mandatory="true"
            :default-value="rankTakingDate"
            v-model="rankTakingDate"
            type="date"
            :error-messages="rankTakingDateErrors"
            v-if="isAlreadyDecorated === 'yes'"
          />
          
        </v-col>
      </v-row>
      <v-row class="pt-3 justify-space-between">
        <div class="pl-3">
          <v-btn outlined color="primary" @click="goBack">
            <v-icon small style="margin-top: 3px">
              {{ chevronLeft }}
            </v-icon>Retour
          </v-btn>
        </div>
        <div class="pr-3">
          <v-btn color="primary" @click="submit">
            Enregistrer et poursuivre <v-icon small style="margin-top: 3px">
            {{ chevronRight }}
          </v-icon>
          </v-btn>
        </div>
      </v-row>
    </v-container>
  </v-form>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import SaveConfirmation from "@/modules/onBoarding/components/SaveConfirmation.vue";
import {lazyInject, Validation} from "@pasta/box";
import {TrainingInformationViewModel} from "@/modules/onBoarding/viewModels/training/TrainingInformationViewModel";
import Selector from "@/components/Selector.vue";
import TextField from "@/components/TextField.vue";
import {mdiChevronLeft, mdiChevronRight} from '@mdi/js';
import {certificateList} from "@/modules/onBoarding/resources/certificateList";
import {requiredIf, helpers } from "vuelidate/lib/validators";
import {OnBoardingPath} from "@/modules/onBoarding/navigation/OnBoardingPath";
import {OnBoardingStepIndex, OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {MarineLicenseNumber} from "@/core/valueObjects/MarineLicenseNumber";
import {DateFormat} from "@/core/valueObjects/DateFormat";
import {Watch} from "vue-property-decorator";
import {cities} from "@/modules/onBoarding/resources/cities";
import {
  PersonalInformationViewModel
} from "@/modules/onBoarding/viewModels/personalInformation/PersonalInformationViewModel";

@Component({
  components: {
    SaveConfirmation,
    TextField,
    Selector,
  }
})
export default class TrainingInformation extends Vue {

  chevronLeft = mdiChevronLeft;
  chevronRight = mdiChevronRight;

  gradeList = {
    KNIGHT : 'Chevalier',
    OFFICER : 'Officier',
    COMMANDER : 'Commandeur'
  }

  @lazyInject(OnBoardingViewModel)
  declare onBoardingViewModel: OnBoardingViewModel;

  @lazyInject(TrainingInformationViewModel)
  declare trainingInformationViewModel: TrainingInformationViewModel;

  @lazyInject(PersonalInformationViewModel)
  declare personalInformationViewModel: PersonalInformationViewModel;

  certificateList: string[] = certificateList;

  quarter = "";

  certificate = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre brevet",
      validator: requiredIf((val) => {
        return val.certificate != null && val.certificate === certificateList[certificateList.length - 1];
      }),
    }
  })
  otherCertificate = "";

  loading = false;

  cities: string[] = cities.map(elem => elem.city);
  citySearch = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner une distinction",
      validator: requiredIf((val) => {
        return val.isAlreadyDecorated === 'yes';
      }),
    }
  })
  distinctionName: string | undefined = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner un grade obtenu",
      validator: requiredIf((val) => {
        return val.isAlreadyDecorated === 'yes';
      }),
    }
  })
  previousGrade: string | undefined = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner une date valide",
      validator: requiredIf((val) => {
        return val.isAlreadyDecorated === 'yes';
      }),
    },
    isValid: {
      errorMessage: 'Veuillez renseigner une date valide',
      validator: helpers.withParams({
        type: 'decreeDate'
      }, (val: string) => {
        return DateFormat.validate(val);
      })
    }
  })
  decreeDate: string | undefined = ""


  @Validation({
    isValid: {
      errorMessage: 'Veuillez renseigner une date valide',
      validator: helpers.withParams({
        type: 'rankTakingDate'
      }, (val: string) => {
        return DateFormat.validate(val);
      })
    }
  })
  rankTakingDate: string | undefined = "";


  isAlreadyDecorated = "no";

  quarterLicenseNumber = "";

  get hidden() {
    return this.trainingInformationViewModel.saveBoxHidden;
  }


  onClose() {
    this.trainingInformationViewModel.hideSaveBox();
  }

  goBack() {
    return this.$router.back();
  }

  @Watch('quarterLicenseNumber')
  onQuarterLicenseNumberChange(value: string) {
    if (value != null) {
      const numbers = value.match(/\d/g);
      const character = value.at(value.length - 1);
      if (numbers && numbers.length === 8) {
        if (value.length === 9 && character && /^[a-z]/i.test(character)) {
          this.quarterLicenseNumber = `${numbers?.join("")}-${character}`
        }
      }
    }
  }

  async submit() {
    this.$v.$touch();
    const isError = this.$v.$invalid
    if (!isError) {
      await this.trainingInformationViewModel.submit({
        quarter: this.quarter,
        quarterLicenseNumber: this.quarterLicenseNumber,
        certificate: this.certificate === certificateList[certificateList.length - 1] ? this.otherCertificate : this.certificate,
        alreadyDecorated: this.isAlreadyDecorated === "yes",
        ...(this.isAlreadyDecorated === "yes" && {
          distinction: {
            decretDate: this.decreeDate,
            name: this.distinctionName,
            rankTakingDate: this.rankTakingDate,
          },
          previousGrade: this.previousGrade,
        })
      })
      this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.DEMAND);
      return this.$router.push(OnBoardingPath.DEMAND);
    }
  }

  async mounted() {
    focus();
    const result = await this.trainingInformationViewModel.fetchTrainingInformation();
    if (result) {
      if (result.distinction) {
        this.isAlreadyDecorated = "yes";
        this.distinctionName = result.distinction.name;
        this.decreeDate = result.distinction.decretDate;
        this.rankTakingDate = result.distinction.rankTakingDate;
        if (!result.previousGrade) {
          this.previousGrade = "N/A";
        } else {
          this.previousGrade = result.previousGrade;
        }
      }
      this.quarterLicenseNumber = result.quarterLicenseNumber;
      if (result.certificate != null) {
        const isCertificateInList = certificateList.includes(result.certificate);
        if (isCertificateInList) {
          this.certificate = result.certificate;
        }
        if (result.certificate != "" && !isCertificateInList) {
          this.certificate = certificateList[certificateList.length - 1]
          this.otherCertificate = result.certificate;
        }
      }
      this.quarter = result.quarter;
    }

    this.loading = false;
  }
}
</script>

<style lang="scss">
@import "../../../../styles/variables";
</style>

````

</details>


---

### 📄 `src/modules/onBoarding/screens/PathValidated.vue` [3.970 octets]
<a id="src-modules-onBoarding-screens-PathValidated-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-screens-PathValidated-vue)

> **Chemin relatif** : `src/modules/onBoarding/screens/PathValidated.vue`  
> **Taille** : 3.970 octets  
> **Lignes** : 125  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (125 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <div class="align-center-column">
    <img
      v-if="onboardingViewModel.editMode === false"
      style="margin-top: 46px; margin-bottom: 36px;"
      alt=""
      :src="logoSuccess"
    />
    <img
      v-if="onboardingViewModel.editMode === true"
      style="margin-top: 46px; margin-bottom: 36px;"
      alt=""
      :src="logoUpdate"
    />

    <h3 v-if="onboardingViewModel.editMode === false">
      Votre dossier a bien été enregistré !
    </h3>
    <h3 v-if="onboardingViewModel.editMode === true">
      Votre modification a bien été enregistrée !
    </h3>
    <p v-if="onboardingViewModel.editMode === false && onboardingViewModel.selectedDecoration == 'merite_maritime'" style="margin-bottom: 10px;color: #666666;font-size: 18px">
      Il a bien été transmis à <span class="folderContainerTitle">{{onboardingViewModel.selectedEntity.name}}</span> pour <span class="folderContainerTitle">validation</span>
    </p>
    <p style="color: #666666;font-size: 18px">
      Vous le trouverez dans votre espace
      <u v-if="onboardingViewModel.selectedDecoration == 'merite_maritime'" role="link" tabindex="0" class="sub-link" @click="goToFolderView">de suivi de dossiers.</u>
      <u v-if="onboardingViewModel.selectedDecoration !== 'merite_maritime'" role="link" tabindex="0" class="sub-link" @click="goToFolderView">promotion.</u>

    </p>

    <div style="display: flex; align-items: center; justify-content: center;margin-top: 24px;">
      <v-btn outlined color="primary" @click="goBackHome()" style="margin-right: 24px">
        <v-img alt="" style="margin-right: 5px;" :aspect-ratio="1" :src="homeIcon" />
        Retour à l’accueil
      </v-btn>
      <v-btn color="primary" @click="createNewFolder()">
        Créer un nouveau dossier
      </v-btn>
    </div>
    <div class="mt-8">
      <p class="mb-0">
        Aidez-nous à améliorer cette démarche !
      </p>
      <p class="mt-0">
        Donnez-nous votre avis, cela ne prend que 2 minutes.
      </p>
      <div class="mt-5">
        <a target="_blank" href="https://jedonnemonavis.numerique.gouv.fr/Demarches/3741?&view-mode=formulaire-avis&nd_source=button&key=6015066eb9da53069d33cb25b5a10b37"> <img src="https://jedonnemonavis.numerique.gouv.fr/static/bouton-bleu.svg" alt="Je donne mon avis" /> </a>
      </div>
    </div>
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import homeIcon from '../../../assets/home_icon.svg';
import mailSent from '../../../assets/mail_sent.png';
import logoUpdate from '../../../assets/modif_folder.png';
import {lazyInject} from "@pasta/box";
import {OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {OnBoardingPath} from "@/modules/onBoarding/navigation/OnBoardingPath";

@Component({
  components: {
  }
})
export default class PathValidated extends Vue {
  logoSuccess = mailSent;
  logoUpdate = logoUpdate;
  homeIcon = homeIcon;

  @lazyInject(OnBoardingViewModel)
  declare onboardingViewModel: OnBoardingViewModel;

  createNewFolder() {
    this.clear();
    return this.$router.push(OnBoardingPath.SEARCH_ARCHIVE)
  }

  clear() {
    this.onboardingViewModel.clearAll();
  }

  goBackHome() {
    this.clear();
    return this.$router.push('/')
  }

  goToFolderView() {
    return this.$router.push('/mes-dossiers')
  }
}
</script>

<style lang="scss">
.align-center-column {
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  h3 {
    line-height: 2;
    font-size: 24px;
    font-weight: 700;
  }
  button {
    letter-spacing: 0px!important;
  }
  .folderContainerTitle {
    font-size: 18px;
    font-style: normal;
    color: #666666;
    background: linear-gradient(#B8FEC9 0%, #B8FEC9 100%) no-repeat;
    background-size: calc(100px) calc(60%);
    background-position: 3px bottom;
  }
  .sub-link {
    cursor: pointer;
  }
}
</style>

```

</details>


---

### 📄 `src/modules/onBoarding/screens/PersonalInformation.vue` [26.343 octets]
<a id="src-modules-onBoarding-screens-PersonalInformation-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-screens-PersonalInformation-vue)

> **Chemin relatif** : `src/modules/onBoarding/screens/PersonalInformation.vue`  
> **Taille** : 26.343 octets  
> **Lignes** : 875  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (875 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <div>
    <v-form class="civilRecord" ref="civilRecordForm">
      <v-container>
        <v-row>
          <v-col
            cols="12"
            sm="12"
            class="pt-0"
          >
            <h2 tabindex="-1">Etat civil du candidat</h2>
          </v-col>
          <v-col
            cols="12"
            sm="12"
            class="pt-0 pb-0"
          >
            <p id="input-93">Civilité :</p>
            <v-radio-group
              class="civilRecord__gender"
              row
              required
              id="input-93"
              aria-labelledby="input-93"
              v-model="civility"
              :error-messages="civilityErrors"
            >
              <v-radio label="Madame" :value="civilityValues[1]"></v-radio>
              <v-radio label="Monsieur" :value="civilityValues[0]"></v-radio>
            </v-radio-group>
          </v-col>
          <v-col
            cols="12"
            sm="6"
            class="pt-0 pb-0 textfield"
          >
            <label style="color: #161616;" for="birthName">Nom de naissance<span style="color: red">*</span></label>
            <v-combobox
              id="birthName"
              :required="true"
              class="mt-3"
              :disabled="onBoardingViewModel.fromPresentation"
              :error-messages="birthNameErrors"
              v-model="birthName"
              :items="users"
              filled
              :search-input.sync="usersSearch"
              :cache-items="false"
              append-icon=""
              autocomplete="family-name"
            >
              <template v-slot:item="{item}" >
                <div style="width: 100%" @click="openUserCompletionPopup(item.value)">
                  <p style="font-weight: 500; margin-bottom: 5px;margin-top: 10px;">
                    {{item.value.birthName}} {{item.value.firstName}}
                  </p>
                  <p>
                    Né{{item.value.civility === "MR" ? "" : "e"}} le {{item.value.displayBirthDate}}
                  </p>
                  <v-divider style="width: 100%" v-if="users[users.findIndex(usr => usr.value.id === item.value.id)] !== users[users.length - 1]"/>
                </div>
              </template>
              <template v-slot:append-item v-if="archives.length > 3">
                <div style="background-color: #F5F5FE;padding: 20px; cursor:pointer;" @click="openSearchPopup">
                  <p style="margin-bottom: 0; color: #000091;text-align: center; text-decoration: underline;">
                    Voir les {{archives.length - 3}} autres profils
                  </p>
                </div>
              </template>
            </v-combobox>
          </v-col>
          <v-col
            cols="12"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="Nom(s) d'usage"
              :required="true"
              :default-value="legalName"
              :error-messages="legalNameErrors"
              v-model="legalName"
              @input="legalName = legalName.toUpperCase()"
              autoCompleteAttribute="family-name"
            />
          </v-col>
          <v-col
            cols="12"
            sm="12"
            class="pt-0 pb-0"
          >
            <text-field
              label="Prénom(s)"
              :required="true"
              :mandatory="true"
              sub-label="Séparer les prénoms avec des virgules"
              :default-value="firstName"
              :error-messages="firstNameErrors"
              v-model="firstName"
              @input="firstName = firstName.toUpperCase()"
              autoCompleteAttribute="given-name"
            />
          </v-col>
          <v-col
            cols="12"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="Date de naissance (jj/mm/aaaa)"
              type="date"
              :mandatory="true"
              :required="true"
              :default-value="birthDate"
              :error-messages="birthDateErrors"
              v-model="birthDate"
              autoCompleteAttribute="bday"
            />
          </v-col>
          <v-col
            cols="12"
            sm="6"
            class="pt-0 pb-0"
          >
            <selector
              label="Nationalité"
              :items="nationalities"
              :mandatory="true"
              v-model="nationality"
              :error-messages="nationalityErrors"
              :default-value="nationality"
            />
          </v-col>
          <v-col
            cols="12"
            sm="6"
            class="pt-0 pb-0"
          >
            <selector
              label="Pays de naissance"
              :items="nationalities"
              :mandatory="true"
              v-model="birthCountry"
              :error-messages="birthCountryErrors"
              :default-value="birthCountry"
            />
          </v-col>
          <v-col
            cols="12"
            sm="6"
            class="pt-0 pb-0 textfield"
          >
            <label style="color: #161616;" for="birthCity">Ville de naissance<span style="color: red">*</span></label>
            <p></p>
            <v-combobox
              required
              id="birthCity"
              class="mt-3"
              :error-messages="birthCityErrors"
              v-model="birthCity"
              :items="cities"
              filled
              :search-input.sync="birthPlaceSearch"
              :loading="searchZipCodeLoading"
              no-filter
              :cache-items="false"
              append-icon=""
            />
          </v-col>
          <v-col
            cols="12"
            sm="12"
            class="pt-0 pb-0"
            v-if="this.birthCountry ==='FRANCE'"
          >
            <selector
              label="Département de naissance"
              :items="departments"
              :mandatory="true"
              v-model="birthDepartment"
              :error-messages="birthDepartmentErrors"
              :default-value="birthDepartment"
            />
          </v-col>
          <v-col
            cols="12"
            sm="12"
            class="pt-0 pb-0"
          >
            <label style="color: #161616;" for="address">Adresse</label>
            <p></p>
            <v-combobox
                id="address"
                class="mt-3"
                v-model="street"
                :items="places"
                filled
                :search-input.sync="addressSearch"
                :loading="addressSearchLoading"
                no-filter
                :cache-items="false"
                :error-messages="streetErrors"
                append-icon=""
                autoCompleteAttribute="street-address"
            />
          </v-col>
          <v-col
            cols="12"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="Code postal"
              :required="true"
              :default-value="zipCode"
              :mandatory="true"
              v-model="zipCode"
              :error-messages="zipCodeErrors"
              autoCompleteAttribute="postal-code"
            />
          </v-col>
          <v-col
            cols="12"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="Ville"
              :required="true"
              :default-value="city"
              :mandatory="true"
              :error-messages="cityErrors"
              v-model="city"
              @input="city = city.toUpperCase()"
            />
          </v-col>
          <v-col
            cols="12"
            sm="12"
            class="pt-0 pb-0"
          >
            <selector
              label="Pays de résidence"
              :items="countries"
              v-model="residencyCountry"
              :error-messages="residencyCountryErrors"
              :default-value="residencyCountry"
            />
          </v-col>
        </v-row>
        <v-row class="pt-3 justify-space-between">
          <div class="pl-3">
            <v-btn @click="goBack" outlined color="primary">
              <v-icon small style="margin-top: 3px">
                {{ chevronLeft }}
              </v-icon>Retour
            </v-btn>
          </div>
          <div class="pr-3">
            <v-btn color="primary" @click="submit">
              Enregistrer et poursuivre <v-icon small style="margin-top: 3px">
              {{ chevronRight }}
            </v-icon>
            </v-btn>
          </div>
        </v-row>

      </v-container>
    </v-form>
    <alert
      :open="open"
      :with-confirmation="withConfirmation"
      :on-close="onClose"
      :on-confirm="onConfirm"
    >
      <template v-slot:title>
        <h2 class="pb-5">{{ dialogTitle }}</h2>
      </template>
      <template v-slot:message>
        <p>
          {{dialogMessage}}
        </p>
      </template>
    </alert>
    <alert
      v-if="userSelected != null"
      :open="userCompletionPopupOpen"
      :on-close="() => userCompletionPopupOpen = false"
      :with-confirmation="true"
      :on-confirm="onConfirmArchive"
    >
      <template v-slot:title>
        <h2 class="pb-5">
          {{userSelected.birthName}} {{userSelected.firstName}}
        </h2>
      </template>
      <template v-slot:message>
        <p>
          <span style="font-weight: 500;">Née le:</span> {{userSelected.displayBirthDate}}
        </p>
        <p>
          <span style="font-weight: 500;">Lieu de naissance:</span> {{userSelected.birthCity}}
        </p>
        <p>
          <span style="font-weight: 500;">Décoration déjà obtenue:</span> {{userSelected.distinction != null ? userSelected.distinction.name : "Aucune"}}
        </p>
        <p>
          <span style="font-weight: 500;">Date de la dernière décoration:</span> {{userSelected.distinction != null ? userSelected.distinction.displayDecreeDate : "Aucune"}}
        </p>
        <p>
          <span style="font-weight: 500;">Lieu de résidence:</span> {{userSelected.address}}
        </p>
        <p style="font-weight: bold">
          NB : L'adresse indiquée est susceptible de changer lors de la confirmation en raison du remplissage automatique. De plus, certaines adresses situées dans les territoires d'outre-mer peuvent ne pas être prises en charge.
          Si tel est le cas, veuillez saisir manuellement l'adresse correcte.
        </p>
      </template>
    </alert>
    <search-archive
      :open="userSearchPopupOpen"
      :on-close="onSearchArchiveClose"
      v-model="usersSearch"
      :archives="archives"
      :on-search-press="onSearchPress"
      :on-archive-selected="onArchiveSelect"
      :on-confirm-selection="onConfirmSelection"
    />
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import TextField from "@/components/TextField.vue";
import Selector from "@/components/Selector.vue";
import {lazyInject, Validation} from "@pasta/box";
import {
  ErrorDialogState,
  PersonalInformationViewModel
} from "@/modules/onBoarding/viewModels/personalInformation/PersonalInformationViewModel";
import {Civility} from "@/modules/onBoarding/types/Civility";
import {helpers, minLength, required, requiredIf} from "vuelidate/lib/validators";
import {mdiChevronLeft, mdiChevronRight} from '@mdi/js';
import {OnBoardingPath} from "@/modules/onBoarding/navigation/OnBoardingPath";
import {Watch} from "vue-property-decorator";
import Alert from "@/components/Alert.vue";
import {DomainError} from "@/core/types/coreTypes/DomainError";
import {OnBoardingStepIndex, OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {DateFormat} from "@/core/valueObjects/DateFormat";
import {Address, AddressProperties} from "@/core/entities/Address";
import dayjs from "dayjs";
import {Archive} from "@/core/entities/Archive";
import {TrainingInformationViewModel} from "@/modules/onBoarding/viewModels/training/TrainingInformationViewModel";
import SearchArchive from "@/modules/onBoarding/components/SearchArchive.vue";
import {PresentationStatus} from "@/core/entities/Applicant";
import {DecorationType} from "@/modules/onBoarding/types/DecorationType";
import { debounce } from 'lodash';

@Component({
  components: {
    Alert,
    TextField,
    Selector,
    SearchArchive
  }
})
export default class PersonalInformation extends Vue {

  civilityValues = Object.values(Civility);
  countries: string[] = [];
  nationalities: string[] = [];
  departments: string[] = [];
  chevronLeft = mdiChevronLeft;
  chevronRight = mdiChevronRight;
  search = "";
  birthPlaceSearch = "";
  searchAddressLoading = false;
  declare decorationType: DecorationType
  searchZipCodeLoading = false;
  open = false;
  dialogMessage = "";
  withConfirmation = false;
  dialogTitle = "";
  cities: string[] = [];
  users: { text: string; value: Archive; disabled: boolean; divider: boolean; }[] = [];
  usersSearch = "";
  userSearchPopupOpen = false;
  userCompletionPopupOpen = false;
  userSelected: Archive | null = null;
  archives: Archive[] = [];

  places: {text: string; value: AddressProperties}[] = [];
  addressSearch = ""
  addressSearchLoading = false;

  debouncedSearchCity = debounce(this.doSearchCity, 300);
  disableWatcher = false;

  async doSearchCity(value: string) {
    this.cities = await this.personalInformationViewModel.searchCity({
      byZipCode: !isNaN(+value),
      query: value,
    });
  }

  onSearchArchiveClose() {
    this.userSearchPopupOpen = false;
  }

  async onSearchPress() {
    await this.searchUser(this.usersSearch);
  }

  async onArchiveSelect(id: string) {
    const archive = this.archives.find(item => item.id === id);
    if (archive) {
      this.userSelected = archive;
    }
  }

  async onConfirmSelection() {
    if (!this.userSelected) {
      return;
    }
    this.userSearchPopupOpen = false;
    this.userCompletionPopupOpen = true;
  }


  @lazyInject(PersonalInformationViewModel)
  declare personalInformationViewModel: PersonalInformationViewModel;

  @lazyInject(OnBoardingViewModel)
  declare onBoardingViewModel: OnBoardingViewModel;

  @lazyInject(TrainingInformationViewModel)
  declare trainingInformationViewModel: TrainingInformationViewModel;

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre nom de naissance",
      validator: required,
    },
    minLength: {
      errorMessage: "Doit comporter au moins deux caractères",
      validator: minLength(2)
    }
  })
  birthName = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre prénom",
      validator: required,
    },
    minLength: {
      errorMessage: "Doit comporter au moins deux caractères",
      validator: minLength(2)
    }
  })
  firstName = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre civilité",
      validator: required,
    }
  })
  civility = Civility.MRS;

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre date de naissance",
      validator: requiredIf((val: any) => {
        return val.decorationType === DecorationType.MERITE_MARITIME
      }),
    },
  })
  birthDate = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre lieu de naissance",
      validator: requiredIf((val: any) => {
        return val.decorationType === DecorationType.MERITE_MARITIME
      }),
    },
    minLength: {
      errorMessage: "Doit comporter au moins deux caractères",
      validator: minLength(2)
    },
  })
  birthCity = "";

  @Validation({
    minLength: {
      errorMessage: "Doit comporter au moins deux caractères",
      validator: minLength(2)
    },
  })
  legalName = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre nationalité",
      validator: requiredIf((val: any) => {
        return val.decorationType === DecorationType.MERITE_MARITIME
      }),
    }
  })
  nationality = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre pays de résidence",
      validator: requiredIf((val: any) => {
        return val.decorationType === DecorationType.MERITE_MARITIME
      }),
    }
  })
  residencyCountry = "";


  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre pays de naissance",
      validator: requiredIf((val: any) => {
        return val.decorationType === DecorationType.MERITE_MARITIME
      }),
    }
  })
  birthCountry = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner votre département de naissance",
      validator: requiredIf((val: any) => {
        return val.birthCountry === 'FRANCE'
      }),
    }
  })
  birthDepartment = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner une rue",
      validator: requiredIf((val: any) => {
        return val.decorationType === DecorationType.MERITE_MARITIME
      }),
    }
  })
  street: string = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner un code postal",
      validator: requiredIf((val: any) => {
        return val.decorationType === DecorationType.MERITE_MARITIME
      }),
    }
  })
  zipCode = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner une ville",
      validator: requiredIf((val: any) => {
        return val.decorationType === DecorationType.MERITE_MARITIME
      }),
    }
  })
  city = "";


  @Watch('street')
  onSelectedAddressChange(payload: {text: string; value: AddressProperties}) {
    if (!payload?.value) {
      return;
    }
    this.street = payload.value.street;
    this.zipCode = payload.value.zipCode;
    this.city = payload.value.city;
  }

  @Watch("addressSearch")
  async listenOnChangeAddress(value: string) {
    try {
      this.addressSearchLoading = true;
      this.addressSearch = value;
      const places = await this.personalInformationViewModel.searchPlaces(value);
      this.places = places.map(elem => {
        return {
          text: elem.props.rawValue,
          value: elem.props,
        }
      });
    } catch(e) {
      console.debug(e);
    } finally {
      this.addressSearchLoading = false;
    }
  }

  async mounted() {
    //Désactive le watcher
    this.disableWatcher = true;

    focus();
    const personalInformation = await this.personalInformationViewModel.getScreenState(this.onBoardingViewModel.selectedDecoration);
    this.decorationType = this.onBoardingViewModel.selectedDecoration;
    const countriesLabel = this.personalInformationViewModel.countries.map(item => item.label.toUpperCase());
    const departmentsLabel = this.personalInformationViewModel.departments.map(item => item.label.toUpperCase());
    this.nationalities = countriesLabel;
    this.countries = countriesLabel;
    this.departments = departmentsLabel;
    this.birthName = personalInformation.birthName;
    this.civility = personalInformation.civility;
    this.legalName = personalInformation.legalName;
    this.birthDate = personalInformation.birthDate ? dayjs(personalInformation.birthDate).format('YYYY-MM-DD') : "";
    this.birthCity = personalInformation.birthCity;
    this.birthPlaceSearch = personalInformation.birthCity;
    this.birthDepartment = personalInformation.birthDepartment.toUpperCase();
    this.firstName = personalInformation.firstName;
    this.nationality = personalInformation.nationality.toUpperCase();
    this.residencyCountry = personalInformation.residencyCountry.toUpperCase();
    this.birthCountry = personalInformation.birthCountry.toUpperCase();
    this.city = personalInformation.rawAddress.city;
    this.street = personalInformation.rawAddress.street;
    this.zipCode = personalInformation.rawAddress.zipCode;

    // Réactive le watcher
    this.$nextTick(() => {
      this.disableWatcher = false;
    });
  }

  onClose() {
    this.open = false;
  }

  @Watch("birthPlaceSearch")
  async listenOnChangeZipCode(value: string) {
    if (this.disableWatcher) return;

    try {
      this.birthPlaceSearch = value ? value.toUpperCase() : "";
      if (this.birthCountry === 'FRANCE') {
        this.searchZipCodeLoading = true;
        
        this.debouncedSearchCity(value);

        this.birthDepartment = await this.personalInformationViewModel.searchDepartment({
          query: value,
        }); 
      }
    } catch(e) {
      console.debug(e);
    } finally {
      this.searchZipCodeLoading = false;
    }
  }

  async searchUser(value: string) {
    const archives = await this.personalInformationViewModel.searchUser(value);
    this.archives = archives;
    this.users = archives.slice(0, 3).map(elem => {
      return {
        text: elem.birthName,
        value: {
          ...elem,
          distinction: elem.distinction != null ? {
            ...elem.distinction,
          } : null,
        },
        disabled: false,
        divider: false,
      }
    });
  }

  @Watch("usersSearch")
  async listenOnUserSearch(value: string) {
    try {
      this.birthName = value ? value.toUpperCase() : "";
      this.searchZipCodeLoading = true;
      if (value.length >= 3) {
        await this.searchUser(value);
      }

    } catch(e) {
      console.debug(e);
    } finally {
      this.searchZipCodeLoading = false;
    }
  }

  openSearchPopup() {
    this.userSearchPopupOpen = true;
  }

  openUserCompletionPopup(archive: Archive) {
    this.userCompletionPopupOpen = true;
    this.userSelected = archive;
  }

  async searchAddress(value: string): Promise<Address[]> {
    try {
      const places = await this.personalInformationViewModel.searchPlaces(value);
      return places
    } catch(e) {
      return []
    }
  }

  async onConfirmArchive() {
    const archive: Archive = this.userSelected as Archive;
    let address = undefined;
    const places = await this.searchAddress(archive.address);
    if (places.length > 0) {
      address = places[0];
      this.onSelectedAddressChange({
        text: address.props.rawValue,
        value: address.props
      })
    } else {
      this.street = "";
      this.zipCode = "";
      this.city = "";
    }
    this.personalInformationViewModel.enrichWithArchive({
      ...archive,
      residencyAddress: address,
    });
    this.trainingInformationViewModel.enrichWithArchive(archive);
    const countries = await this.personalInformationViewModel.fetchCountries();
    this.userCompletionPopupOpen = false;
    this.birthName = archive.birthName;
    this.civility = archive.civility;
    if (archive.birthName !== archive.legalName) {
      this.legalName = archive.legalName;
    }
    if (archive.birthDate) {
      this.birthDate = dayjs(archive.birthDate).format('YYYY-MM-DD');
    }
    this.birthCity = archive.birthCity;
    this.firstName = archive.firstName;
    this.nationality = countries.find(elem => elem.code === archive.nationality)?.label.toUpperCase() ?? "France";
    this.residencyCountry = countries.find(elem => elem.code === archive.residencyCountry)?.label.toUpperCase() ?? "France";
    this.birthCountry = countries.find(elem => elem.code === archive.birthCountry)?.label.toUpperCase() ?? "France";
    this.userSelected = null;
    return;
  }



  goBack() {
    this.$router.push(OnBoardingPath.DECORATION)
  }

  showErrorDialog(error: ErrorDialogState) {
    this.open = true;
    this.dialogMessage = error.message;
    this.withConfirmation = error.withConfirmation;
    this.dialogTitle = error.title;
  }

  async onConfirm() {
    await this.createApplicant(true);
    return this.onClose();
  }

  async goToTrainingForm() {
    if (this.onBoardingViewModel.fromPresentation) {
      await this.onBoardingViewModel.initPresentation({
        decorationType: this.onBoardingViewModel.selectedDecoration,
      })
    }
    if (this.onBoardingViewModel.selectedDecoration === DecorationType.MERITE_MARITIME) {
      this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.TRAINING_INFORMATION);
      return this.$router.push(OnBoardingPath.TRAINING_INFORMATION);
    } else {
      this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.ACTIVITY);
      return this.$router.push(OnBoardingPath.ACTIVITY);
    }

  }


  async submit() {
    this.$v.$touch();
    const isValid = this.$v.$invalid;
    if (!isValid) {
      try {
        await this.createApplicant();
      } catch(e) {
        if (e instanceof DomainError) {
          this.showErrorDialog(this.personalInformationViewModel.error);
          throw e;
        }
        throw e;
      }
    }
  }

  async createApplicant(force?: boolean) {
    const address = Address.build({
      city: this.city,
      zipCode: this.zipCode,
      street: this.street,
      country: this.residencyCountry
    }).props;
    this.personalInformationViewModel.setAddresses([address]);
    await this.personalInformationViewModel.submit({
      birthCity: this.birthCity,
      birthDate: this.birthDate,
      nationality: this.nationality,
      decorationType: this.onBoardingViewModel.selectedDecoration,
      firstName: this.firstName,
      birthName: this.birthName,
      legalName: this.legalName,
      civility: this.civility,
      residencyCountry: this.residencyCountry,
      rawAddress: address,
      forceCreate: force,
      birthCountry: this.birthCountry,
      birthDepartment: this.birthDepartment,
      status: PresentationStatus.DRAFT,
    });
    if (this.onBoardingViewModel.infoUpdateOnly) {
      return this.$router.back();
    }
    return this.goToTrainingForm();
  }

}
</script>

<style lang="scss">
.civilRecord {
  width: 620px;
  p {
    margin-top: 10px;
    margin-bottom: 0;
  }
}

.v-text-field--filled > .v-input__control > .v-input__slot, .v-text-field--full-width > .v-input__control > .v-input__slot, .v-text-field--outlined > .v-input__control > .v-input__slot {
  min-height: 40px;
}

.v-input__icon {
  height: 10px;
}

.v-list-item {
  text-transform: capitalize;
}

.v-select__selection--comma {
  text-transform: capitalize;
}

.sub_button {
  font-size: 14px;
  letter-spacing: 0!important;
  color: #20209f;
  text-decoration: underline;
}

.v-list {
  padding-bottom: 0;
  padding-top: 0;
}
</style>

```

</details>


---

### 📄 `src/modules/onBoarding/screens/SearchHonoreArchive.vue` [5.660 octets]
<a id="src-modules-onBoarding-screens-SearchHonoreArchive-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-screens-SearchHonoreArchive-vue)

> **Chemin relatif** : `src/modules/onBoarding/screens/SearchHonoreArchive.vue`  
> **Taille** : 5.660 octets  
> **Lignes** : 200  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (200 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <div class="search-honore-archive">
    <h2 style="font-weight: 500; margin: 0 auto" class="decoration--title" tabindex="-1">
      Rechercher un candidat dans Honoré
    </h2>
    <div class="mt-3" style="margin: 0 auto; display: flex;align-items: center; width: 50%;">
      <v-combobox
        id="birthName"
        :required="true"
        v-model="archiveName"
        filled
        :search-input.sync="usersSearch"
        :cache-items="false"
        append-icon=""
        autocomplete="family-name"
      />
      <div class="magnify">
        <v-icon large style="margin-top: 3px"> {{ mdiMagnify }} </v-icon>
      </div>
    </div>


    <v-row justify="center" class="mt-10">
      <v-col
        :class="`archive-items ml-3 mr-5 mb-10 ${item.value.onGoingPresentation ? ' disabled' : ''}`"
        :style="`cursor: ${item.value.onGoingPresentation ? 'initial' : 'pointer'};`"
        lg="5"
        v-for="item of onBoardingViewModel.honoreArchives.slice((page * limit) - limit, page * limit)"
        v-bind:key="item.value.presentationId"
        @click="confirmRepresentation(item.value)">
        <p style="font-weight: 500; margin-bottom: 5px;margin-top: 10px;">
          {{item.value.firstName}} {{item.value.birthName}} <span v-if="item.value.onGoingPresentation">
          {{item.value.reason}}
        </span>
        </p>
        <p>
          Né{{item.value.civility === "MR" ? "" : "e"}} le {{dayjs(item.value.birthDate).format('DD/MM/YYYY')}}
        </p>

      </v-col>
    </v-row>
    <v-pagination
      v-if="onBoardingViewModel.honoreArchives.length > 0"
      :length="Math.round(onBoardingViewModel.honoreArchives.length / limit)"
      :disabled="false"
      :page="page"
      class="mt-5"
      :value="page"
      v-model="page"
      :total-visible="limit"
    ></v-pagination>
  <div  style="margin: 0 auto; text-align: center;" v-if="onBoardingViewModel.honoreArchives.length <= 0 && usersSearch && usersSearch.length > 3">
    <h2 style="font-weight: 500"  class="decoration--title mt-10 mb-5" tabindex="-1">
      Aucun candidat ne correspond à votre recherche...
    </h2>

  </div>

    <div style="margin: 0 auto; text-align: center;background: #F6F6F6; border: 1px solid #E5E5E5; padding: 24px;" class="mt-10">
      <h2 style="font-weight: 500"  class="decoration--title mb-5" tabindex="-1">
        Vous ne trouvez pas le candidat que vous recherchez ?
      </h2>

      <p style="font-weight: 400;font-size: 20px" class="mb-5">
        Déposer un nouveau dossier
      </p>

      <v-btn color="primary" style="margin-bottom: 0;text-align: center;font-weight: 500" @click="onCreateNewFolder">
        Créer
      </v-btn>
    </div>

  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import {lazyInject} from "@pasta/box";
import {OnBoardingStepIndex, OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {OnBoardingPath} from "@/modules/onBoarding/navigation/OnBoardingPath";
import {Watch} from "vue-property-decorator";
import {Archive} from "@/core/entities/Archive";
import {HomeViewModel} from "@/modules/home/viewModels/HomeViewModel";
import {HonoreArchive} from "@/core/entities/HonoreArchive";
import dayjs from "dayjs";
import { mdiMagnify } from '@mdi/js';
import {RecommandantViewModel} from "@/modules/recommandants/viewmodels/RecommandantViewModel";


@Component({
  methods: {dayjs}
})
export default class SearchHonoreArchive extends Vue {

  @lazyInject(OnBoardingViewModel)
  declare onBoardingViewModel: OnBoardingViewModel;

  @lazyInject(HomeViewModel)
  declare homeViewModel: HomeViewModel;

  @lazyInject(RecommandantViewModel)
  declare recommandantViewModel: RecommandantViewModel;

  mdiMagnify = mdiMagnify;

  mounted() {
    this.onBoardingViewModel.clearAll();
    this.onBoardingViewModel.updateOnBoardingStep(OnBoardingStepIndex.DEFAULT);
  }

  usersSearch = "";

  archiveName = "";

  archives: Archive[] = [];

  page = 1;

  limit = 6;

  @Watch("usersSearch")
  async listenOnUserSearch(value: string) {
    if (value && value.length > 3) {
      await this.onBoardingViewModel.searchHonoreArchive(value);
    }
  }

  async onCreateNewFolder() {
    this.recommandantViewModel.setPrefillSelectedRecommandantOnFileDeposit(true);
    this.homeViewModel.clear();
    this.onBoardingViewModel.setUpdateInfoOnly(false);
    return this.$router.push(OnBoardingPath.DECORATION)
  }

  async confirmRepresentation(archive: HonoreArchive) {
    if (!archive.onGoingPresentation) {
      await this.onBoardingViewModel.getPresentation({
        presentationId: archive.presentationId,
        applicantId: archive.applicantId,
      })
      return this.$router.push(OnBoardingPath.DECORATION);
    }
  }
}
</script>

<style lang="scss">
.view-container {
  margin: 0 auto!important;
  width: 800px;
}
.search-honore-archive {
  display: flex;
  flex-direction: column;
  &--title {
    align-self: flex-start;
  }

  .disabled {
    background: #fafafa;
    opacity: 0.5;
  }

  .archive-items {
    border: 1px solid #EEEEEE;
    border-bottom: 4px solid #000091;
  }

  .magnify {
    margin-bottom: 30px;
    background: #000091;
    border-top-right-radius: 4px;
    padding-left: 5px;
    padding-right: 5px;
    border-bottom: 3px solid #000091;
    span {
      color: white;
    }
  }

  &--choice {
    display: flex;
    flex-direction: column;

    .v-input--radio-group__input {
      gap: 1rem;
    }
  }

  &--navigation {
    display: flex;
    flex-direction: row;
    gap: 5%;
    align-self: flex-start;
    margin-top: 1rem;
  }
}
</style>

````

</details>


---

### 📄 `src/modules/onBoarding/screens/ValidationScreen.vue` [1.278 octets]
<a id="src-modules-onBoarding-screens-ValidationScreen-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-onBoarding-screens-ValidationScreen-vue)

> **Chemin relatif** : `src/modules/onBoarding/screens/ValidationScreen.vue`  
> **Taille** : 1.278 octets  
> **Lignes** : 54  
> **Type** : text

```text
<template>
  <div>
    <div v-if="onBoardingViewModel.selectedDecoration == 'merite_maritime'">
      <m-m-validation/>
    </div>
    <div v-if="onBoardingViewModel.selectedDecoration !== 'merite_maritime'">
      <l-h-onm-validation/>
    </div>
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import Stepper from "@/modules/onBoarding/components/Stepper.vue";
import {lazyInject} from "@pasta/box";
import {OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {AuthModule} from "@pasta/front-auth";
import MMValidation from "@/modules/onBoarding/components/MMValidation.vue";
import LHOnmValidation from "@/modules/onBoarding/components/LHOnmValidation.vue";

@Component({
  components: {
    LHOnmValidation,
    MMValidation,
    Stepper,
  },
})
export default class ValidationScreen extends Vue {
  @lazyInject(OnBoardingViewModel)
  declare onBoardingViewModel: OnBoardingViewModel;

  @lazyInject(AuthModule)
  declare authModule: AuthModule;

}
</script>

<style lang="scss">
.subtitleValidation {
  font-size: 18px !important;
  font-weight: 700 !important;
  color: #161616;
  margin-bottom: 0;
}
.content {
  color: #666666;
}

.nameType {
  color: #161616;
}
</style>

```


---

### 📄 `src/modules/recommandants/components/RecommandantForm.vue` [4.781 octets]
<a id="src-modules-recommandants-components-RecommandantForm-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-recommandants-components-RecommandantForm-vue)

> **Chemin relatif** : `src/modules/recommandants/components/RecommandantForm.vue`  
> **Taille** : 4.781 octets  
> **Lignes** : 152  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (152 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <div class="recommandant-form">
    <v-row
      v-for="item of recommandants"
      v-bind:key="item.id"
      class="mt-4 mb-1"
    >
      <v-col
        cols="6"
        sm="6"
        class="pt-0 pb-0">
        <p><span style="font-weight: 600">Recommandant :</span> <span>{{item.firstname}} {{item.lastname.toUpperCase()}}</span></p>
      </v-col>
      <v-col
        cols="4"
        sm="4"
        class="pt-0 pb-0">
        <p>Organisme: {{item.companyName}}</p>
      </v-col>
      <v-col
        cols="2"
        sm="2"
        class="pt-0 pb-0"
        style="text-align: right"
      >
        <v-btn icon class="delete" x-small color="primary" @click="updateRecommandant(item.id)" title="Modifier le dossier" aria-label="Aller à la page de modification de dossier">
          <v-icon>
            {{ penIcon }}
          </v-icon>
          <span class="d-sr-only">Modifier le dossier</span>
        </v-btn>
        <v-btn v-if="allowDelete" icon class="delete" x-small color="primary" @click="detachRecommandant(item.id)" title="Supprimer le dossie!r" aria-label="Supprimer !le dossier">
          <v-icon style="color: #e1000f">
            {{ deleteIcon }}
          </v-icon>
          <span class="d-sr-only">Supprimer le dossier!</span>
        </v-btn>
      </v-col>
    </v-row>
    <p v-if="allowCreate" @click="openRecommandantForm" style="text-decoration: underline;color: #000091;cursor: pointer;">+ Ajouter un recommandant</p>
    <recommandant-management-form
        :on-recommandant-create="createRecommandant"
        :on-recommandant-update="createRecommandant"
    />
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import Alert from "@/components/Alert.vue";
import TextField from "@/components/TextField.vue";
import Selector from "@/components/Selector.vue";
import {PoliticalSide, Recommandant} from "@/core/entities/Recommandant";
import {lazyInject} from "@pasta/box";
import {mdiPen, mdiTrashCanOutline} from "@mdi/js";
import parent from "../../../assets/parent.png";
import RecommandantManagementForm from "@/modules/recommandants/components/RecommandantManagementForm.vue";
import {RecommandantViewModel} from "@/modules/recommandants/viewmodels/RecommandantViewModel";
import {Prop} from "vue-property-decorator";

@Component({
  components: {RecommandantManagementForm, Selector, TextField, Alert}
})
export default class RecommandantForm extends Vue {

  deleteIcon = mdiTrashCanOutline;
  penIcon = mdiPen;
  parent = parent;

  @Prop({default: [], required: true})
  declare recommandants: Recommandant[]

  @Prop({default: true, required: true})
  declare allowCreate: boolean;

  @Prop({default: true, required: true})
  declare allowDelete: boolean;

  @Prop({default: [], required: true})
  declare onAddRecommandant: (recommandant: Recommandant) => Promise<void>;

  @Prop({default: [], required: true})
  declare onUpdateRecommandant: (recommandant: Recommandant) => Promise<void>;

  @Prop({default: [], required: true})
  declare onRemoveRecommandant: (id: string) => Promise<void>;


  @lazyInject(RecommandantViewModel)
  declare recommandantViewModel: RecommandantViewModel;

  async createRecommandant(recommandant: Recommandant) {
    if (this.recommandantViewModel.selectedRecommandant.id !== "") {
      await this.recommandantViewModel.updateRecommandant(
          recommandant
      );
      await this.onUpdateRecommandant(recommandant)
    } else {
      const recommandantId = await this.recommandantViewModel.createRecommandant(recommandant);
      await this.onAddRecommandant({
        ...recommandant,
        id: recommandantId,
      })
    }
    this.recommandantViewModel.setRecommandantFormOpen(false);
  }

  detachRecommandant(id: string) {
    this.onRemoveRecommandant(id)
  }

  updateRecommandant(id: string) {
    const recommandant = this.recommandants.find(elem => elem.id === id);
    if (recommandant) {
      this.recommandantViewModel.setSelectedRecommandant(recommandant);
      this.recommandantViewModel.onSetEditMode(true);
      this.recommandantViewModel.setRecommandantFormOpen(true);
    }
  }

  openRecommandantForm() {
    this.recommandantViewModel.onSetEditMode(false);
    this.recommandantViewModel.setSelectedRecommandant({
      id: "",
      appealForm: "",
      greeting: "",
      note: "",
      politicalSide: PoliticalSide.MAJORITY,
      email: "",
      politicalParty: "",
      phone: "",
      county: "",
      city: "",
      zipCode: "",
      street: "",
      companyName: "",
      firstname: "",
      lastname: "",
      region: "",
    });
    this.recommandantViewModel.setRecommandantFormOpen(true);
  }
}
</script>

<style lang="scss">
.recommandant-form {

}
</style>

```

</details>


---

### 📄 `src/modules/recommandants/components/RecommandantManagementForm.vue` [9.791 octets]
<a id="src-modules-recommandants-components-RecommandantManagementForm-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-recommandants-components-RecommandantManagementForm-vue)

> **Chemin relatif** : `src/modules/recommandants/components/RecommandantManagementForm.vue`  
> **Taille** : 9.791 octets  
> **Lignes** : 323  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (323 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <div class="recommandant-form">
    <alert
      :open="recommandantViewModel.recommandantFormOpen"
      :on-close="onFormClose"
      :on-confirm="createRecommandant"
      :with-confirmation="true"
    >
      <template v-slot:title>
        <div style="display: flex; align-items: center;">
          <img :src="parent" class="mr-2"/>
          <h2>
            Ajouter un recommandant
          </h2>
        </div>
      </template>
      <template v-slot:message>
        <v-row class="mt-4">
          <v-col
            cols="12"
            sm="12"
            class="pt-0 pb-0"
          >
            <text-field
              label="Organisme"
              :required="true"
              :mandatory="false"
              :default-value="recommandantViewModel.selectedRecommandant.companyName"
              v-model="recommandantViewModel.selectedRecommandant.companyName"
            />
          </v-col>
          <v-col
            cols="6"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="Nom"
              :required="true"
              :default-value="recommandantViewModel.selectedRecommandant.lastname"
              :mandatory="false"
              v-model="recommandantViewModel.selectedRecommandant.lastname"
            />
          </v-col>
          <v-col
            cols="6"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="Prénom"
              :required="true"
              :mandatory="false"
              :default-value="recommandantViewModel.selectedRecommandant.firstname"
              v-model="recommandantViewModel.selectedRecommandant.firstname"
            />
          </v-col>
          <v-col
            cols="12"
            sm="12"
            class="pt-0 pb-0"
          >
            <label style="color: #161616;" for="address">Adresse</label>
            <p></p>
            <v-combobox
                id="address"
                class="mt-3"
                v-model="selectedAddress"
                :items="places"
                filled
                :search-input.sync="addressSearch"
                :loading="addressSearchLoading"
                no-filter
                :cache-items="false"
                append-icon=""
            />
          </v-col>
          <v-col
            cols="6"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="Code postal"
              :required="true"
              :default-value="recommandantViewModel.selectedRecommandant.zipCode"
              :mandatory="false"
              v-model="recommandantViewModel.selectedRecommandant.zipCode"
            />
          </v-col>
          <v-col
            cols="6"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="Commune"
              :required="true"
              :mandatory="false"
              :default-value="recommandantViewModel.selectedRecommandant.city"
              v-model="recommandantViewModel.selectedRecommandant.city"
            />
          </v-col>
          <v-col
            cols="6"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="Département"
              :required="true"
              :default-value="recommandantViewModel.selectedRecommandant.county"
              :mandatory="false"
              v-model="recommandantViewModel.selectedRecommandant.county"
            />
          </v-col>
          <v-col
            cols="6"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="Région"
              :required="true"
              :mandatory="false"
              :default-value="recommandantViewModel.selectedRecommandant.region"
              v-model="recommandantViewModel.selectedRecommandant.region"
            />
          </v-col>
          <v-col
            cols="6"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="Mail"
              :required="true"
              :default-value="recommandantViewModel.selectedRecommandant.email"
              :mandatory="false"
              v-model="recommandantViewModel.selectedRecommandant.email"
            />
          </v-col>
          <v-col
            cols="6"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="Téléphone/portable"
              :required="true"
              :mandatory="false"
              :default-value="recommandantViewModel.selectedRecommandant.phone"
              v-model="recommandantViewModel.selectedRecommandant.phone"
            />
          </v-col>
          <v-col
            cols="12"
            sm="12"
            class="pt-0 pb-0"
          >
              <text-field
                      label="Parti politique"
                      :required="true"
                      :mandatory="false"
                      v-model="recommandantViewModel.selectedRecommandant.politicalParty"
                      :default-value="recommandantViewModel.selectedRecommandant.politicalParty"
              />
          </v-col>
          <v-col
            cols="12"
            sm="12"
            class="pt-0 pb-0"
          >
            <text-field
              label="Commentaires"
              :required="false"
              :mandatory="true"
              field-type="text-area"
              v-model="recommandantViewModel.selectedRecommandant.note"
              :default-value="recommandantViewModel.selectedRecommandant.note"
            />
          </v-col>
        </v-row>


      </template>

    </alert>
    <alert
      :open="recommandantViewModel.openDuplicateAlert"
      :on-confirm="onConfirmDuplicateAlert"
      :on-close="onDuplicateAlertClose"
      :with-confirmation="true"
    >
      <template v-slot:title>
        <div style="display: flex; align-items: center;">
          <img :src="parent" class="mr-2"/>
          <h2>
            Doublon trouvé
          </h2>
        </div>
      </template>
      <template v-slot:message>
        <p class="mt-4">En confirmant, vous créerez un potentiel doublon.</p>
      </template>
    </alert>
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import Alert from "@/components/Alert.vue";
import TextField from "@/components/TextField.vue";
import Selector from "@/components/Selector.vue";
import {Address, AddressProperties} from "@/core/entities/Address";
import {PoliticalSide, Recommandant} from "@/core/entities/Recommandant";
import {lazyInject, Validation} from "@pasta/box";
import {required} from "vuelidate/lib/validators";
import {ActivityViewModel} from "@/modules/onBoarding/viewModels/activity/ActivityViewModel";
import {Prop, Watch} from "vue-property-decorator";
import {mdiPen, mdiTrashCanOutline} from "@mdi/js";
import parent from "../../../assets/parent.png";
import {RecommandantViewModel} from "@/modules/recommandants/viewmodels/RecommandantViewModel";

@Component({
  components: {Selector, TextField, Alert}
})
export default class RecommandantManagementForm extends Vue {

  deleteIcon = mdiTrashCanOutline;
  penIcon = mdiPen;
  parent = parent;

  @lazyInject(RecommandantViewModel)
  declare recommandantViewModel: RecommandantViewModel;


  @Prop({required: true})
  declare onRecommandantCreate: (recommandant: Omit<Recommandant, 'id'>) => Promise<void>;

  @Prop({required: true})
  declare onRecommandantUpdate: (recommandant: Recommandant) => Promise<void>;


  addressSearch = ""

  addressSearchLoading = false;

  selectedAddress = "";

  places: {text: string; value: AddressProperties}[] = [];

  async createRecommandant() {
    if (this.recommandantViewModel.editMode) {
      return this.onRecommandantUpdate(this.recommandantViewModel.selectedRecommandant)
    }
    const isDuplicate = await this.recommandantViewModel.isDuplicate(this.recommandantViewModel.selectedRecommandant);
    if (isDuplicate) {
      return;
    }
    return this.onRecommandantCreate(this.recommandantViewModel.selectedRecommandant);
  }
  onDuplicateAlertClose() {
    this.recommandantViewModel.setOpenDuplicateAlert(false);
  }

  async onConfirmDuplicateAlert() {
    this.recommandantViewModel.setOpenDuplicateAlert(false);
    return this.onRecommandantCreate(this.recommandantViewModel.selectedRecommandant);
  }

  mounted() {
    this.selectedAddress = this.recommandantViewModel.selectedRecommandant.street;
  }

  @Watch('selectedAddress')
  onSelectedAddressChange(payload: {text: string; value: AddressProperties}) {
    if (!payload?.value) {
      return;
    }
    this.selectedAddress = payload.value.street;
    this.recommandantViewModel.setSelectedRecommandant({
      ...this.recommandantViewModel.selectedRecommandant,
      street: payload.value.street,
      city: payload.value.city,
      zipCode: payload.value.zipCode,
      county: payload.value.county || "",
      region: payload.value.region || "",
    })
  }

  @Watch("addressSearch")
  async listenOnChangeZipCode(value: string) {
    try {
      this.addressSearchLoading = true;
      this.addressSearch = value;
      const places = await this.recommandantViewModel.searchPlaces(value);
      this.places = places.map(elem => {
        return {
          text: elem.props.rawValue,
          value: elem.props,
        }
      });
    } catch(e) {
      console.debug(e);
    } finally {
      this.addressSearchLoading = false;
    }
  }

  onFormClose() {
    this.recommandantViewModel.toggleRecommandantForm(false)
  }
}
</script>

<style lang="scss">
.recommandant-form {

}
</style>

```

</details>


---

### 📄 `src/modules/recommandants/components/RecommandantResume.vue` [1.891 octets]
<a id="src-modules-recommandants-components-RecommandantResume-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-recommandants-components-RecommandantResume-vue)

> **Chemin relatif** : `src/modules/recommandants/components/RecommandantResume.vue`  
> **Taille** : 1.891 octets  
> **Lignes** : 80  
> **Type** : text

````text
<template>
  <div class="recommandant-resume">
    <h3>Synthèse du dossier</h3>
    <div class="mt-5">
      <p>
        <span>CRÉE LE :</span>
        21/02/2023
      </p>
      <p>
        <span>ADRESSE :</span>
        {{getAddress()}}
      </p>

      <v-row>
        <v-col lg="6">
          <p>
            <span>TÉLÉPHONE :</span>
            {{recommandantViewModel.selectedRecommandant.phone}}
          </p>
        </v-col>
        <v-col lg="6">
          <p>
            <span>MAIL :</span>
            {{recommandantViewModel.selectedRecommandant.email}}
          </p>
        </v-col>
      </v-row>
      <p>
        <span>PARTI POLITIQUE :</span>
        {{recommandantViewModel.selectedRecommandant.politicalParty}}
      </p>
    </div>
    <h3 class="mt-5">Note</h3>
    <p class="mt-4">{{recommandantViewModel.selectedRecommandant.note}}</p>
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import {lazyInject} from "@pasta/box";
import {RecommandantViewModel} from "@/modules/recommandants/viewmodels/RecommandantViewModel";

@Component
export default class RecommandantResume extends Vue {


  @lazyInject(RecommandantViewModel)
  declare recommandantViewModel: RecommandantViewModel;

  getAddress() {
    if (!this.recommandantViewModel.selectedRecommandant.street) {
      return "";
    }
    return `
        ${this.recommandantViewModel.selectedRecommandant.street}, ${this.recommandantViewModel.selectedRecommandant.zipCode} ${this.recommandantViewModel.selectedRecommandant.city}, ${this.recommandantViewModel.selectedRecommandant.county}
    `
  }

}
</script>

<style lang="scss">
.recommandant-resume {
  max-width: 1200px;
  h3 {
    font-size: 2rem;
    font-weight: 500;
    color: black
  }
  p {
    font-weight: 500;
    color: #666666
  }
  span {
    color: #3A3A3A;
  }
}
</style>

````


---

### 📄 `src/modules/recommandants/components/Recommandations.vue` [5.234 octets]
<a id="src-modules-recommandants-components-Recommandations-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-recommandants-components-Recommandations-vue)

> **Chemin relatif** : `src/modules/recommandants/components/Recommandations.vue`  
> **Taille** : 5.234 octets  
> **Lignes** : 194  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (194 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <div class="recommandation">
    <h3>Candidats recommandés :</h3>
    <v-data-table
      :headers="headers"
      :items="recommandantList"
      :items-per-page="10"
      :item-class="getRowClass"
      class="elevation-0 mt-8"
      item-key="id"
    >
      <template v-slot:item.controls="props">
        <v-btn
          icon
          outlined
          color="primary"
          @click="onClickEditRank(props.item)"
          title="Modifier le rang"
          aria-label="Modifier le rang"
        >
          <v-icon color="primary">
            {{ rankIcon }}
          </v-icon>
          <span class="d-sr-only">Modifier le rang</span>
        </v-btn>
      </template>
      <template v-slot:footer.prepend>
        <div class="text-body-2 text-muted d-flex align-center">
          <v-icon small>{{ infoIcon }}</v-icon>
          Les lignes grisées correspondent aux candidats décorés.
        </div>
      </template>
    </v-data-table>
    <alert :open="dialogState.dialog" :on-close="onClose" with-confirmation :on-confirm="onConfirm">
      <template v-slot:message>
        <h2>Ajouter ou modifier le rang</h2>
        <text-field required label="Rang" v-model="dialogState.rank" :default-value="dialogState.rank" />
      </template>
    </alert>
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import { lazyInject } from "@pasta/box";
import { RecommandantViewModel } from "@/modules/recommandants/viewmodels/RecommandantViewModel";
import { DecorationType } from "@/modules/onBoarding/types/DecorationType";
import { mdiChevronTripleUp, mdiInformation } from "@mdi/js";
import { StringUtils } from "@/core/valueObjects/StringUtils";
import { RecommandantListItem } from "@/core/types/recommandants/RecommandantListItem";

import dayjs from "dayjs";
import Alert from "@/components/Alert.vue";
import TextField from "@/components/TextField.vue";
import {toDecorationType} from "@/core/valueObjects/toDecorationType";

@Component({
  components: { TextField, Alert },
})
export default class Recommandations extends Vue {
  @lazyInject(RecommandantViewModel)
  declare recommandantViewModel: RecommandantViewModel;

  dialogState = {
    dialog: false,
    rank: "",
    presentationId: "",
  };

  rankIcon = mdiChevronTripleUp;
  infoIcon = mdiInformation;

  headers = [
    {
      text: "Nom du candidat",
      value: "name",
    },
    {
      text: "Cabinet",
      value: "office",
    },
    {
      text: "Grade",
      value: "grade",
    },
    {
      text: "Promotion",
      value: "promotion",
    },
    {
      text: "Décoration",
      value: "decoration",
    },
    {
      text: "Avis",
      value: "decision",
    },
    {
      text: "Date de décrêt",
      value: "decreeDate",
    },
    {
      text: "Rang",
      value: "rank",
    },
    { text: "", value: "controls", sortable: false },
  ];

  async mounted() {
    // Retrieving recommandant's recommandations
    await this.recommandantViewModel.getRecommandations(this.recommandantViewModel.selectedRecommandant.id);
  }

  onClickEditRank(payload: RecommandantListItem) {
    this.dialogState.presentationId = payload.id;
    this.dialogState.rank = payload.rank || "";
    this.dialogState.dialog = true;
  }

  onClose() {
    this.dialogState.dialog = false;
    this.dialogState.presentationId = "";
    this.dialogState.rank = "";
  }

  async onConfirm() {
    // Save recommandant new rank
    await this.recommandantViewModel.rankRecommandation({
      presentationId: this.dialogState.presentationId,
      rank: this.dialogState.rank,
    });
    // Closing recommand rank dialog
    this.onClose();
  }

  get recommandantList(): RecommandantListItem[] {
    return this.recommandantViewModel.recommandations.map(item => ({
      id: item.presentationId,
      name: `${item.lastName} ${item.legalName ? `Ep. ${item.legalName}` : ""} ${StringUtils.capitalize(
        item.firstName
      )}`,
      grade: item.grade,
      promotion: item.sessionName,
      rank: item.rank,
      decoration: toDecorationType(item.decorationType),
      decision: item.sessionClosedAt != null ? item.action : null,
      office: item.office,
      decreeDate: item.sessionDecreeDate ? dayjs(item.sessionDecreeDate).format("DD-MM-YYYY") : null,
    }));
  }

  getRowClass(item: RecommandantListItem) {
    return item.decision ? "gray-out" : "";
  }
}
</script>

<style lang="scss" scoped>
.recommandation {
  h3 {
    font-size: 17px;
    font-weight: 500;
    color: black;
    text-transform: uppercase;
  }
  ::v-deep .v-data-table-header {
    span {
      color: black;
      font-size: 14px;
    }
  }
  ::v-deep .theme--light.v-data-table > .v-data-table__wrapper > table > thead > tr:last-child > th {
    border-bottom: medium solid #3a3a3a;
  }
  ::v-deep
    .theme--light.v-data-table
    > .v-data-table__wrapper
    > table
    > tbody
    > tr:hover:not(.v-data-table__expanded__content):not(.v-data-table__empty-wrapper) {
    background: transparent;
  }
  ::v-deep .header-item {
    color: black;
    margin-bottom: 0;
    font-size: 14px;
  }
  ::v-deep .gray-out {
    background-color: #e0e0e0 !important;
  }
}
</style>

````

</details>


---

### 📄 `src/modules/recommandants/screens/RecommandantDetail.vue` [6.106 octets]
<a id="src-modules-recommandants-screens-RecommandantDetail-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-recommandants-screens-RecommandantDetail-vue)

> **Chemin relatif** : `src/modules/recommandants/screens/RecommandantDetail.vue`  
> **Taille** : 6.106 octets  
> **Lignes** : 204  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (204 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <div class="recommandants-details">
    <div class="header">
      <div class="tools-actions-profil">
        <div style="display: flex;">
          <div class="col">
            <div class="row">
              <a style="border-bottom: 1px solid #000091" @click="goBack()" role="link" tabindex="0"
              ><v-icon color="primary">{{ mdiArrowLeftThin }}</v-icon
              ><span>Retour à la liste</span>
              </a>
            </div>
            <div style="margin-top: 24px; margin-bottom: 10px; display: flex; align-items: center;">
              <div class="icon">
                <v-icon color="primary" x-large>{{ User }}</v-icon>
              </div>
              <div class="ml-2">
                <h1>{{recommandantViewModel.selectedRecommandant.lastname}} {{recommandantViewModel.selectedRecommandant.firstname}}</h1>
                <p>Organisme : {{recommandantViewModel.selectedRecommandant.companyName}}</p>
              </div>
            </div>
          </div>
          <div>
            <v-menu offset-y left>
              <template v-slot:activator="{ on, attrs }">
                <v-btn
                    color="secondary"
                    class="header-action-left"
                    v-bind="attrs"
                    v-on="on"
                >
                  Options <v-icon style="margin-right: 5px; margin-top: 5px; vertical-align: middle">{{ mdiChevronDown }}</v-icon>
                </v-btn>
              </template>
              <v-list>
                <v-list-item
                    v-for="(item, index) in headerActions"
                    :key="index"
                    @click='handleHeaderAction(item)'
                >
                  <v-list-item-title>{{ item.title }}</v-list-item-title>
                </v-list-item>
              </v-list>
            </v-menu>
          </div>
        </div>


        <template>
          <v-tabs
              v-model="active_tab"
              background-color="transparent"
              slider-color="#000091"
              optional
              right
              active-class="active"
          >
            <v-tab v-for="tab of tabs" :key="tab.id" @click="onTabNavigate(tab.id)">
              <div style="display: flex; align-items: center">
                <v-icon small style="margin-right: 5px">{{ tab.icon }}</v-icon> {{ tab.name }}
              </div>
            </v-tab>
          </v-tabs>
        </template>
      </div>
    </div>
    <div class="content mt-10">
      <div v-if="active_tab === 0">
        <recommandant-resume />
      </div>

      <div v-if="active_tab === 1">
        <recommandations />
      </div>

    </div>
    <recommandant-management-form
        :on-recommandant-create="createRecommandant"
        :on-recommandant-update="updateRecommandant"
    />
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import TextField from "@/components/TextField.vue";
import {lazyInject} from "@pasta/box";
import {RecommandantViewModel} from "@/modules/recommandants/viewmodels/RecommandantViewModel";
import RecommandantManagementForm from "@/modules/recommandants/components/RecommandantManagementForm.vue";
import {
  mdiAccountCircle,
  mdiArrowLeftThin,
  mdiBookOpenPageVariantOutline,
  mdiEyeOutline,
  mdiChevronDown
} from "@mdi/js";
import RecommandantResume from "@/modules/recommandants/components/RecommandantResume.vue";
import Recommandations from "@/modules/recommandants/components/Recommandations.vue";
import {Recommandant} from "@/core/entities/Recommandant";
import {ActivityViewModel} from "@/modules/onBoarding/viewModels/activity/ActivityViewModel";
import {OnBoardingPath} from "@/modules/onBoarding/navigation/OnBoardingPath";

@Component({
  components: {Recommandations, RecommandantResume, RecommandantManagementForm, TextField}
})
export default class RecommandantDetail extends Vue {

  mdiArrowLeftThin = mdiArrowLeftThin;
  User = mdiAccountCircle;
  mdiChevronDown = mdiChevronDown

  @lazyInject(RecommandantViewModel)
  declare recommandantViewModel: RecommandantViewModel;


  @lazyInject(ActivityViewModel)
  declare activityViewModel: ActivityViewModel;

  active_tab = 0;
  tabs = [
    { id: 0, name: "Synthèse", icon: mdiEyeOutline },
    { id: 1, name: "Recommandations", icon: mdiBookOpenPageVariantOutline }
  ];


  onTabNavigate(id: number) {
    this.active_tab = id;
  }

  headerActions = [
    {
      id: 0,
      title: 'Proposer un candidat'
    },
    {
      id: 1,
      title: 'Modifier ses informations'
    }
  ]

  handleHeaderAction(item: {id: number; title: string}) {
    if (item.id === 0) {
      this.recommandantViewModel.setPrefillSelectedRecommandantOnFileDeposit(true);
      this.activityViewModel.resetRecommandant();
      this.activityViewModel.addRecommandant(
          this.recommandantViewModel.selectedRecommandant
      )
      this.$router.push('/archive/recherche')
      return;
    }
    if (item.id === 1) {
      this.recommandantViewModel.setEditMode(true);
      this.recommandantViewModel.setRecommandantFormOpen(true);
      return;
    }
  }

  goBack() {
    this.$router.back();
  }


  createRecommandant() {
    console.log('not implemented here');
  }
  async updateRecommandant(recommandant: Recommandant) {
    await this.recommandantViewModel.updateRecommandant(recommandant);
    this.recommandantViewModel.setEditMode(false);
    this.recommandantViewModel.setRecommandantFormOpen(false);
    this.recommandantViewModel.setSelectedRecommandant(recommandant);
  }

}
</script>

<style lang="scss">
.recommandants-details {
  text-align: left;
  .header {
    padding: 1rem 8rem 0rem 8rem;
    background: #F6F6F6;
    .v-tabs-slider-wrapper {
      top: 0px !important;
    }
    .v-tab {
      margin-left: 5px !important;
      margin-right: 5px !important;
      background-color: #e3e3fd;
      font-weight: 700;
    }
    .active {
      background-color: white;
    }
    .row {
      align-items: center;
    }
  }
  .content {
    padding: 0 8rem;
  }
}
</style>

```

</details>


---

### 📄 `src/modules/recommandants/screens/RecommandantsListScreen.vue` [7.280 octets]
<a id="src-modules-recommandants-screens-RecommandantsListScreen-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-recommandants-screens-RecommandantsListScreen-vue)

> **Chemin relatif** : `src/modules/recommandants/screens/RecommandantsListScreen.vue`  
> **Taille** : 7.280 octets  
> **Lignes** : 262  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (262 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <div class="recommandants">
    <div style="display: flex; justify-content: space-between; align-items: center;">
      <div class="flex align-center mt-7">
        <img alt="" :src="documentImg" />
        <h1 class="pl-5">
          Tous les recommandants ({{recommandantViewModel.recommandantCopy.length}})
        </h1>
      </div>
      <div>
        <v-btn outlined color="primary" @click="onCreateNewRecommandant">
          Ajouter un recommandant
        </v-btn>
      </div>
    </div>
    <v-row class="mt-3">
      <v-col lg="4">
        <text-field
            label="Recherche"
            :required="false"
            :default-value="search"
            v-model="search"
            field-type="text"
        />
      </v-col>
    </v-row>
    <div>
      <v-data-table
          :headers="headers"
          :items="toRecommandantListItem()"
          :items-per-page="10"
          calculate-widths
          class="elevation-0 mt-8"
          locale="fr-FR"
          item-key="id"
      >
        <template v-slot:item.controls="props">
          <v-btn
            icon
            outlined
            style="color:red;"
            @click="onDelete(props.item.id)"
            title="Supprimer le recommandant"
            aria-label="Supprimer le recommandant"
          >
            <v-icon style="color: red">
              {{ deleteIcon }}
            </v-icon>
            <span class="d-sr-only">Supprimer</span>
          </v-btn>
          <v-btn
              icon
              outlined
              color="primary"
              @click="onUpdate(props.item.id)"
              title="Modifier le recommandant"
              aria-label="Modifier le recommandant"
          >
            <v-icon color="primary">
              {{ penIcon }}
            </v-icon>
            <span class="d-sr-only">Modifier le recommandant</span>
          </v-btn>
          <v-btn icon outlined color="primary" @click="goToDetail(props.item.id)" title="Consulter le recommandant" aria-label="Aller à la page des détails du recommandant">
            <v-icon color="primary">
              {{eyeIcon}}
            </v-icon>
          </v-btn>
        </template>
      </v-data-table>
    </div>
    <recommandant-management-form
        :on-recommandant-create="onRecommandantCreate"
        :on-recommandant-update="onRecommandantUpdate"
    />
    <alert
      :with-confirmation="true"
      :on-confirm="onDeleteRecommandant"
      :on-close="onCloseDeleteRecommandant"
      :open="deleteRecommandantAlert"
    >
      <template v-slot:title>
        <h3>Êtes-vous sûr de vouloir réaliser cette action ?</h3>
      </template>
    </alert>
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import DocumentImg from "@/assets/document.png";
import {mdiEyeCircleOutline, mdiInformation, mdiPen, mdiDelete} from "@mdi/js";
import TextField from "@/components/TextField.vue";
import {lazyInject} from "@pasta/box";
import {RecommandantViewModel} from "@/modules/recommandants/viewmodels/RecommandantViewModel";
import {Watch} from "vue-property-decorator";
import RecommandantManagementForm from "@/modules/recommandants/components/RecommandantManagementForm.vue";
import {PoliticalSide, Recommandant} from "@/core/entities/Recommandant";
import Alert from "@/components/Alert.vue";

@Component({
  components: {Alert, RecommandantManagementForm, TextField}
})
export default class RecommandantsListScreen extends Vue {

  documentImg = DocumentImg;
  eyeIcon = mdiEyeCircleOutline;
  info = mdiInformation;
  penIcon = mdiPen;
  deleteIcon = mdiDelete


  @lazyInject(RecommandantViewModel)
  declare recommandantViewModel: RecommandantViewModel;

  headers = [
    {
      text: 'Nom',
      align: 'start',
      value: 'name',
      groupable: false,
      width: '45%'
    },
    {
      text: 'Organisme',
      align: 'start',
      value: 'company',
      groupable: false,
      width: '45%'
    },
    { text: "", value: "controls", sortable: false, align: 'end', groupable: false, width: '10%' }
  ];

  search = "";

  deleteRecommandantAlert = false
  deleteRecommandantId = "";


  async onDeleteRecommandant() {
    await this.recommandantViewModel.deleteRecommandant(this.deleteRecommandantId);
    this.deleteRecommandantAlert = false;
    this.deleteRecommandantId = "";
  }

  onCloseDeleteRecommandant() {
    this.deleteRecommandantAlert = false;
  }


  async onUpdate(id: string) {
    this.recommandantViewModel.onSetEditMode(true);
    this.recommandantViewModel.toggleRecommandantForm(true);
    this.recommandantViewModel.onSelectedRecommandant(id);
  }

  async onRecommandantCreate(recommandant: Omit<Recommandant, "id">) {
    await this.recommandantViewModel.createRecommandant(recommandant);
    this.recommandantViewModel.toggleRecommandantForm(false);
  }

  async onDelete(id: string) {
    this.deleteRecommandantId = id;
    this.deleteRecommandantAlert = true;
    return;
  }

  async onCreateNewRecommandant() {
    this.recommandantViewModel.onSetEditMode(false);
    this.recommandantViewModel.setSelectedRecommandant({
      companyName: "",
      firstname: "",
      lastname: "",
      city: "",
      id: "",
      zipCode: "",
      politicalSide: PoliticalSide.MAJORITY,
      phone: "",
      region: "",
      county: "",
      street: "",
      email: "",
      note: "",
      politicalParty: "",
      appealForm: "",
      greeting: "",
    })
    this.recommandantViewModel.setRecommandantFormOpen(true);
  }


  async onRecommandantUpdate(recommandant: Recommandant) {
    await this.recommandantViewModel.updateRecommandant(recommandant);
    this.recommandantViewModel.toggleRecommandantForm(false);
    this.recommandantViewModel.onSetEditMode(false);
  }

  async mounted() {
    await this.recommandantViewModel.getAllRecommandant();
  }

  goToDetail(id: string) {
      this.recommandantViewModel.onSelectedRecommandant(id);
      window.open('/recommandants/details', '_blank');
  }

  toRecommandantListItem() {
    return this.recommandantViewModel.recommandants.map(elem => {
      return {
        id: elem.id,
        name: `${elem.firstname} ${elem.lastname.toUpperCase()}`,
        company: elem.companyName,
      }
    })
  }

  @Watch("search")
  async listenOnChange(value: string) {
    await this.recommandantViewModel.search(value);
  }

}
</script>

<style lang="scss">
.recommandants {
  text-align: left;
  padding: 0 8rem;
  .v-data-table-header {
    span {
      color: black;
      font-size: 14px;
    }
  }
  .theme--light.v-data-table > .v-data-table__wrapper > table > thead > tr:last-child > th {
    border-bottom: medium solid #3A3A3A;
  }
  .theme--light.v-data-table > .v-data-table__wrapper > table > tbody > tr:hover:not(.v-data-table__expanded__content):not(.v-data-table__empty-wrapper) {
    background: transparent;
  }
  .header-item {
    color: black;
    margin-bottom: 0;
    font-size: 14px;
  }
  .select-btn {
    width: 100%;
    height: 45px!important;
    display: flex;
    justify-content: space-between;
    padding: 0px 15px!important;
    border: none;
    border-bottom: 2px solid black;
    background: #EEEEEE;
    span {
      color: black
    }
  }
}
</style>

````

</details>


---

### 📄 `src/modules/sessions/components/LHONMPromotion.vue` [33.140 octets]
<a id="src-modules-sessions-components-LHONMPromotion-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-sessions-components-LHONMPromotion-vue)

> **Chemin relatif** : `src/modules/sessions/components/LHONMPromotion.vue`  
> **Taille** : 33.140 octets  
> **Lignes** : 972  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (972 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <div class="session-screen container-fluid">
    <div class="justify-space-between align-center">
      <div>
        <h1>
          {{ homeViewModel.currentSession.name }}
        </h1>
        <h2 style="font-weight: 500; font-size: 1.2rem" class="mb-2">
          Décoration: {{toDecorationType(homeViewModel.currentSession.decoration)}}
        </h2>
        <div class="flex">
          <span v-if="homeViewModel.currentSession.closedAt != null" style="font-size: 16px"
          >{{
              "Clôturée le " + require("dayjs")(new Date(homeViewModel.currentSession.closedAt)).format("DD/MM/YYYY")
            }}
            &#8226;</span
          >
          <span>
            Décret publié le :
            {{
              !homeViewModel.currentSession.decreeDate
                  ? ""
                  : require("dayjs")(new Date(homeViewModel.currentSession.decreeDate)).format("DD/MM/YYYY")
            }}
          </span>
          <span
              v-if="!homeViewModel.currentSession.decreeDate"
              @click="openPublicationPopup()"
              style="cursor: pointer; margin-bottom: 0; color: #000091; border-bottom: 2px solid #000091"
              role="link"
              tabindex="0"
          >
            <v-icon color="primary" small style="margin-bottom: 10px">{{ penIcon }}</v-icon> Ajouter
          </span>
        </div>
      </div>
      <div>
        <v-btn outlined color="primary" class="mr-3" @click="reinitDialogOpen = true" v-if="isAdmin()">
          Réinitialiser clôture et décret
        </v-btn>
        <v-btn outlined color="primary" class="mr-3" :disabled="!sessionViewModel.deletable" @click="deleteDialogOpen = true" v-if="isAdmin()">
          Supprimer
        </v-btn>
        <v-btn
            :disabled="homeViewModel.currentSession.closedAt != null"
            color="primary close-session"
            class="mr-3"
            @click="onClosureClick"
        >
          Clôturer
        </v-btn>
        <v-btn
            :disabled="homeViewModel.currentSession.closedAt != null"
            outlined
            color="primary"
            class="mr-3"
            @click="sessionDialogOpen = true"
        >
          Modifier
        </v-btn>
        <update-session-dialog :open="sessionDialogOpen" :on-close="onSessionDialogClose" />
      </div>
    </div>
    <div class="pt-1 pl-0 pb-10 mt-10">
      <p class="subtitle">Verser des pièces (lettre de conformité, morasse, lettre de contingent...)</p>
      <p class="information">
        Taille maximale : 10 Mo. Formats supportés : jpg, png, pdf. Plusieurs fichiers possibles.
      </p>
      <div class="mt-5">
        <draggable-file
          :on-file-change="onSessionDocumentAdded"
          :progress="sessionViewModel.progressPromotionFile"
          input-ref="other"
        />
      </div>
      <div class="file-input">
        <div v-bind:key="otherFile.id" v-for="otherFile in sessionViewModel.promotionFiles" class="file-list">
          <div class="align-center">
            <v-img alt="" :aspect-ratio="1" :src="success" />
            <p @click="onViewDocument(otherFile.key)" style="text-decoration: underline; cursor:pointer;">{{ otherFile.name }}</p>
            <v-btn
              class="ml-3"
              style="background-color: white !important"
              text
              color="primary"
              @click="removeFile(otherFile.id)"
            >
              <v-icon aria-describedby="Supprimer" class="remove-btn">
                {{ deleteIcon }}
              </v-icon>
              <span>Supprimer</span>
            </v-btn>
          </div>
        </div>
      </div>
    </div>


    <div class="title mt-8">
      <img alt="" :src="dataVisualisation" />
      <h2 class="ml-8">Synthèse</h2>
    </div>

    <div class="lh-quota">
      <v-tabs class="mt-5 mb-5">
        <v-tab
          active-class="gouv-design-system"
          v-for="(cabinet, index) in getLHONMQuotas()"
          class="tab-inactive"
          v-bind:key="index"
          @click="onCabinetChange(cabinet.cabinet)"
        >
          {{cabinet.cabinet}}
        </v-tab>
      </v-tabs>
      <p class="mt-10" style="font-weight: 500; font-size: 1.2rem">Décorations et grades</p>
      <v-row style="max-width: 1200px">
        <v-col cols="3" v-for="(grade, idx) in sessionViewModel.LHONMQuotas.grades" :key="idx" class="mt-5">
          <p>{{grade.grade}} :</p>
          <div class="result">
            <v-progress-linear
                :value="
                    isNaN(Math.round(grade.quantity / grade.received)) || grade.received === 0
                      ? 0
                      : Math.round((grade.received / grade.quantity) * 100)
                  "
            ></v-progress-linear>
            <p class="ml-5 mb-0">{{ grade.received }} / {{ grade.quantity }}</p>
          </div>
        </v-col>
      </v-row>

        <v-divider class="mt-5 mb-5" style="width: 170px" />
        <p class="bold">Parité :</p>
        <div class="result">
            <v-progress-linear
                    :value="
                  isNaN(Math.round(sessionViewModel.LHONMQuotas.totalFolders / sessionViewModel.LHONMQuotas.numberOfWomens)) || sessionViewModel.LHONMQuotas.numberOfWomens === 0
                    ? 0
                    : Math.round((sessionViewModel.LHONMQuotas.numberOfWomens / sessionViewModel.LHONMQuotas.totalFolders) * 100)
                "
            ></v-progress-linear>
            <p class="ml-5 mb-0" v-if="sessionViewModel.LHONMQuotas.totalFolders > 0">{{ sessionViewModel.LHONMQuotas.numberOfWomens }} / {{ sessionViewModel.LHONMQuotas.totalFolders }}</p>
            <p class="ml-5 mb-0" v-if="sessionViewModel.LHONMQuotas.totalFolders === 0">0</p>
        </div>

    </div>

    <div class="title mt-8">
      <img alt="" :src="documentImg" />
      <h2 class="ml-8">Dossiers de la promotion</h2>
    </div>
    <v-row class="mt-3">
      <v-col lg="4">
        <text-field label="Recherche" :required="false" :default-value="search" v-model="search" field-type="text" />
      </v-col>
    </v-row>

    <div style="display: flex; align-items: center;">
      <v-tabs class="mt-5 mb-5">
        <v-tab active-class="gouv-design-system" class="tab-inactive" @click="filterFolder('all')">
          Liste
          <span class="ml-2" style="margin-bottom: 5px">({{ countFolder("") }})</span>
        </v-tab>
        <v-tab active-class="gouv-design-system" class="tab-inactive" @click="filterFolder('Sélection cabinet')">
          Sélection cabinet
          <span class="ml-2" style="margin-bottom: 5px">({{ countFolder("sélection cabinet") }})</span>
        </v-tab>
        <v-tab active-class="gouv-design-system" class="tab-inactive" @click="filterFolder('Retrait')">
          RETRAIT
          <span class="ml-2" style="margin-bottom: 5px">({{ countFolder("retrait") }})</span>
        </v-tab>
        <v-tab active-class="gouv-design-system" class="tab-inactive" @click="filterFolder('Présentés à l\'Élysée')">
          PRÉSENTÉS À L'ÉLYSÉE
          <span class="ml-2" style="margin-bottom: 5px">({{ countFolder("présentés à l'élysée") }})</span>
        </v-tab>
        <v-tab active-class="gouv-design-system" class="tab-inactive" @click="filterFolder('Chancellerie')">
          CHANCELLERIE
          <span class="ml-2" style="margin-bottom: 5px">({{ countFolder("chancellerie") }})</span>
        </v-tab>
        <v-tab active-class="gouv-design-system" class="tab-inactive" @click="filterFolder('Décorés')">
          DÉCORÉS
          <span class="ml-2" style="margin-bottom: 5px">({{ countFolder("décorés") }})</span>
        </v-tab>
      </v-tabs>
      <vue-json-to-csv
        :json-data="sessionViewModel.liste"
        :separator-excel="true"
        :csv-title="'liste'"
        v-if="view === 'all'"
        class="mr-3"
      >
        <v-btn color="primary" outlined>
          Exporter
        </v-btn>
      </vue-json-to-csv>

      <v-menu offset-y v-if="view === 'Chancellerie'">
        <template v-slot:activator="{ on, attrs }">
          <v-btn
            id="menu-activator"
            color="primary"
            class="nav-link custom-nav-link"
            outlined
            dark
            v-bind="attrs"
            v-on="on"
          >
            Exporter <v-icon color="primary" class="ml-1">{{ chevronDown }}</v-icon>
          </v-btn>
        </template>
        <v-list>
          <v-list-item>
            <v-list-item-title
              @click="exportXml"
              style="cursor: pointer"
            >
              Exporter XML
            </v-list-item-title>
          </v-list-item>
          <v-list-item>
            <v-list-item-title
              @click="exportLettrePresidence"
              style="cursor: pointer"
            >
              Exporter Lettre présidence
            </v-list-item-title>
          </v-list-item>
        </v-list>
      </v-menu>

      <vue-json-to-csv
        :json-data="sessionViewModel.decore"
        :separator-excel="true"
        :csv-title="'decore'"
        v-if="view === 'Décorés'"
        class="mr-3"
      >
        <v-btn color="primary" outlined @click="exportDecore">
          Exporter
        </v-btn>
      </vue-json-to-csv>
      <vue-json-to-csv
        :json-data="sessionViewModel.tableauElysee"
        :separator-excel="true"
        :csv-title="'presente_elysee'"
        v-if="view === 'Présentés à l\'Élysée'"
        class="mr-3"
      >
        <v-btn outlined color="primary" @click="exportTableauElysee">
          Exporter
        </v-btn>
      </vue-json-to-csv>
    </div>
    <v-data-table
        :headers="headers"
        :items="sessionViewModel.folders"
        :items-per-page="10"
        calculate-widths
        class="elevation-0 mt-8"
        locale="fr-FR"
        :show-select="homeViewModel.currentSession.closedAt == null || view === 'all'"
        v-model="selectedItems"
        item-key="id"
    >
      <template v-slot:header.grade>
        <v-menu bottom :close-on-content-click="false" offset-y>
          <template v-slot:activator="{ on, attrs }">
            <p class="header-item" v-bind="attrs" v-on="on">Grade</p>
          </template>
          <v-list v-for="(item, index) in sessionViewModel.availableGrade" :key="index">
            <v-list-item>
              <template v-slot:default="{ active }">
                <v-list-item-action>
                  <v-checkbox :input-value="active" @change="filterKey($event, item, 'grade')" />
                </v-list-item-action>
                <v-list-item-content>
                  <v-list-item-title>{{ item }}</v-list-item-title>
                </v-list-item-content>
              </template>
            </v-list-item>
            <v-divider v-if="index < sessionViewModel.availableGrade.length - 1" :key="index"></v-divider>
          </v-list>
        </v-menu>
      </template>
      <template v-slot:item.tags="props">
        <div style="display: flex;align-items: center;flex-wrap: wrap;">
          <div :class="`${props.item.tags[0].id === item.id ? '' : 'ml-3'} mt-3 mb-3`" v-for="item in props.item.tags" v-bind:key="item.id">
            <p :class="item.color + ' priority'">
              {{item.text}}
            </p>
          </div>
        </div>
      </template>
      <template v-slot:header.controls v-if="selectedItems.length > 0">
        <v-menu bottom offset-y>
          <template v-slot:activator="{ on, attrs }">
            <v-btn v-bind="attrs" v-on="on"> Choisir action </v-btn>
          </template>
          <v-list v-for="(item, index) in sessionViewModel.actions" :key="index">
            <v-list-item>
              <template>
                <v-list-item-content style="cursor: pointer" @click="onActionClick(item)">
                  <v-list-item-title>{{ item }}</v-list-item-title>
                </v-list-item-content>
              </template>
            </v-list-item>
            <v-list-item v-if="index === sessionViewModel.actions.length - 1 && view !== 'all'">
              <template>
                <v-list-item-content style="cursor: pointer" @click="onActionClick('reset')">
                  <v-list-item-title>Liste</v-list-item-title>
                </v-list-item-content>
              </template>
            </v-list-item>
            <v-divider v-if="index <= sessionViewModel.actions.length - 1" :key="index"></v-divider>
          </v-list>
        </v-menu>
      </template>

      <template v-slot:item.controls="props">
        <v-btn icon outlined color="primary" @click="onButtonClick(props.item.id)" title="Consulter le dossier" aria-label="Aller à la page des détails du dossier">
          <v-icon color="primary">
            {{ eyeIcon }}
          </v-icon>
        </v-btn>
      </template>
      <template v-slot:item.action="props">
        <p class="action">
          <v-icon small style="vertical-align: middle; margin-bottom: 3px; color: #0063cb">
            {{ info }}
          </v-icon>
          {{ props.item.action }}
        </p>
      </template>
    </v-data-table>
    <alert :open="actionPopup" :on-close="onCloseActionPopup" :on-confirm="onConfirmAction" :with-confirmation="true">
      <template v-slot:title>
        <h2 class="pb-3">
          <v-icon large style="margin-bottom: 5px; color: #161616">
            {{ infoIcon }}
          </v-icon>
          <span>{{ alertTitle }}</span>
        </h2>
      </template>
      <template v-slot:message>
        <text-field
            v-if="actionSelected !== 'reset'"
            label="Commentaire (facultatif)"
            :required="false"
            :default-value="finalComment"
            v-model="finalComment"
            field-type="text-area"
        />
      </template>
    </alert>

    <alert :open="duplicatePresentationPopup" :on-close="onCloseduplicatePresentationPopupPopup" :on-confirm="onConfirmDuplicatePresentationPopup" :with-confirmation="true">
      <template v-slot:title>
        <h2 class="pb-3">
          <v-icon large style="margin-bottom: 5px; color: #161616">
            {{ infoIcon }}
          </v-icon>
          <span>{{ alertTitle }}</span>
        </h2>
        <p>Cette opération peut prendre quelques minutes et n'est pas immédiate.</p>
      </template>
      <template v-slot:message>
        <selector
          label="Promotion"
          :items="sessionViewModel.sessionAvailableForMove.map(item => item.name)"
          :mandatory="true"
          v-model="selectedPromotion"
          :default-value="selectedPromotion"
        />
        <selector
          label="Cabinet"
          v-if="selectedPromotion != ''"
          :items="cabinetList"
          :mandatory="true"
          v-model="selectedOffice"
          :default-value="selectedOffice"
        />
      </template>
    </alert>

    <alert
        :open="deleteDialogOpen"
        :on-close="onDeleteDialogClose"
        :on-confirm="onConfirmDeleteSession"
        :with-confirmation="true"
    >
      <template v-slot:title>
        <h2>Etes-vous sûr de vouloir supprimer cette promotion ?</h2>
      </template>
    </alert>
    <alert
      :open="reinitDialogOpen"
      :on-close="onReinitDialogClose"
      :on-confirm="onReinitDeleteSession"
      :with-confirmation="true"
    >
      <template v-slot:title>
        <h2>Êtes-vous sûr de vouloir réinitialiser la date de clôture et de décret ?</h2>
      </template>
      <template>
        <p>Cette opération permettra l’ajout de nouveaux candidats pour cette promotion.</p>
      </template>
    </alert>
    <alert
        :open="closeSessionPopup"
        :on-close="onCloseSessionActionPopup"
        :on-confirm="onConfirmCloseSession"
        :with-confirmation="true"
    >
      <template v-slot:title>
        <h2>Etes-vous sûr de vouloir clôturer cette promotion ?</h2>
      </template>
      <template v-slot:message>
        <p class="pt-5">Vous ne pourrez plus modifier cette promotion.</p>
        <p>Les avis du conseil de l’ordre seront rendus publics.</p>
        <p>Les avis des rapporteurs restent confidentiels.</p>
        <p>Les dossiers seront accessibles à toutes les personnes ayant accès à Honoré depuis l’espace archive</p>
      </template>
    </alert>
    <alert
        :open="publicationPopup"
        :on-close="onPublicationPopupClosed"
        :on-confirm="onPublicationPopupConfirm"
        :with-confirmation="true"
    >
      <template v-slot:title>
        <h2>Ajouter la date de publication du décret</h2>
      </template>
      <template v-slot:message>
        <div class="mt-4">
          <text-field
              label="Date de publication du décret"
              type="date"
              :mandatory="true"
              :required="true"
              :default-value="publishDate"
              v-model="publishDate"
          />
        </div>
      </template>
    </alert>

    <alert
      :open="promotionCodePopup"
      :on-close="onPromotionCodePopupClosed"
      :on-confirm="onPromotionCodePopupConfirm"
      :with-confirmation="true"
    >
      <template v-slot:title>
        <h2>Sélectionner le code Promotion</h2>
      </template>
      <template v-slot:message>
        <div class="mt-5">
          <p>
            les codes suivants sont à utiliser en fonction de la promotion et de la date de sa publication : JA = pour les promotions ONLH du 1er janvier<br/>
            PA = pour les (anciennes) promotions ONLH de Pâques<br/>
            MA = pour les promotions ONM du 15 mai<br/>
            JU = pour les promotions ONLH du 14 juillet<br/>
            NO = pour les promotions ONM du 15 novembre
          </p>
        </div>
        <div class="mt-4">
          <selector
            label="Code promotion"
            :items="promotionCodeList"
            :mandatory="false"
            v-model="promotionCodeValue"
            :default-value="promotionCodeValue"
          />
        </div>
      </template>
    </alert>
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import {lazyInject} from "@pasta/box";
import {FolderFilters, SessionViewModel} from "@/modules/sessions/viewModels/SessionViewModel";
import DocumentImg from "@/assets/document.png";
import DataVisualisation from "@/assets/data_visualization.png";
import {mdiArrowRight, mdiChevronDown, mdiClose, mdiDelete, mdiEyeCircleOutline, mdiInformation, mdiPen} from "@mdi/js";
import {FolderViewModel} from "@/modules/folders/viewModels/FolderViewModel";
import {HomeViewModel} from "@/modules/home/viewModels/HomeViewModel";
import {AuthModule} from "@pasta/front-auth";
import {OnBoardingViewModel} from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import {Applicant, PresentationStatus} from "@/core/entities/Applicant";
import Alert from "@/components/Alert.vue";
// eslint-disable-next-line @typescript-eslint/ban-ts-comment
//@ts-ignore
import VueJsonToCsv from "vue-json-to-csv";
import dayjs from "dayjs";
import TextField from "@/components/TextField.vue";
import {Watch} from "vue-property-decorator";
import UpdateSessionDialog from "@/modules/sessions/components/UpdateSessionDialog.vue";
import {FolderDetailViewModel} from "@/modules/folders/viewModels/FolderDetailViewModel";
import {DecorationType} from "@/modules/onBoarding/types/DecorationType";
import {CabinetQuota} from "@/core/entities/Session";
import Selector from "@/components/Selector.vue";
import DraggableFile from "@/modules/onBoarding/components/DraggableFile.vue";
import success from "../../../assets/success.svg";
import {toDecorationType} from "../../../core/valueObjects/toDecorationType";


@Component({
  methods: {toDecorationType},
  components: {
    DraggableFile,
    Selector,
    VueJsonToCsv,
    Alert,
    TextField,
    UpdateSessionDialog,
  },
})
export default class MMPromotion extends Vue {
  @lazyInject(SessionViewModel)
  declare sessionViewModel: SessionViewModel;

  @lazyInject(FolderViewModel)
  declare folderViewModel: FolderViewModel;

  @lazyInject(HomeViewModel)
  declare homeViewModel: HomeViewModel;

  @lazyInject(AuthModule)
  declare authModule: AuthModule;

  @lazyInject(OnBoardingViewModel)
  declare onboardingViewModel: OnBoardingViewModel;

  @lazyInject(FolderDetailViewModel)
  declare folderDetailViewModel: FolderDetailViewModel;

  documentImg = DocumentImg;
  deleteIcon = mdiClose;
  dataVisualisation = DataVisualisation;
  success = success;
  eyeIcon = mdiEyeCircleOutline;
  info = mdiInformation;
  infoIcon = mdiArrowRight;
  penIcon = mdiPen;
  chevronDown = mdiChevronDown;

  promotionCodePopup = false;


  duplicatePresentationPopup = false;

  finalComment = "";

  actions = ["Retrait cabinet", "Sélection cabinet", "Présentés à l'Élysée", "Retrait Élysée", "Chancellerie", "Retrait chancellerie", "Retrait présidence", "Décorés"];

  closeBtnActive = true;

  view = "all";

  closureAvailable = true;

  alertTitle = "";

  actionPopup = false;

  closeSessionPopup = false;

  actionSelected = "";

  selectedOffice = "";

  selectedPromotion = "";

  cabinetList: string[] = [];

  selectedItems: { id: string }[] = [];

  sessionDialogOpen = false;
  deleteDialogOpen = false;
  publicationPopup = false;
  reinitDialogOpen = false;


  publishDate = "";

  filters: FolderFilters = {
    contingent: [],
    grade: [],
    rapporterAdvice: [],
    search: "",
  };

  search = "";


  promotionCodeValue = "";
  promotionCodeList = ["JA", "PA", "MA", "JU", "NO"]

  headers = [
    {
      text: "notes",
      align: "start",
      value: "tags",
      groupable: false,
      width: "20%",
    },
    {
      text: "Status dossier",
      align: "start",
      value: "folderStatus",
      groupable: false,
      width: "10%",
    },
    {
      text: "Nom du candidat",
      align: "start",
      value: "name",
      groupable: false,
      width: "20%",
    },
    { text: "Grade", value: "grade", groupable: false, sortable: false, width: "10%" },
    { text: "Cabinet", value: "office", sortable: false, width: "10%" },
    { text: "Décision", value: "lastNote", sortable: false, width: "10%" },
    { text: "", value: "controls", sortable: false, align: "end", groupable: false, width: "20%" },
  ];
  isAdmin() {
    const currentUser = this.authModule.currentUser;
    return currentUser?.highestRoleLevel && currentUser?.highestRoleLevel >= 1000;
  }

  async exportXml() {
    this.promotionCodePopup = true;
  }

  async onSessionDocumentAdded(file: File) {
    await this.sessionViewModel.addPromotionFile({
      file,
      id: file.name,
    });
  }

  async removeFile(id: string) {
    await this.sessionViewModel.deleteDocumentFile(id);
  }

  async onViewDocument(key: string) {
    const result = await this.sessionViewModel.onViewDocument(key);
    window.open(result, '_blank');
  }


  @Watch('selectedPromotion')
  onSelectedPromotionChange(value: string) {
    const promotion = this.homeViewModel.sessions.find(elem => elem.name === value);
    this.cabinetList = [];
    this.selectedOffice = ""
    if (promotion && promotion.decoration !== DecorationType.MERITE_MARITIME) {
      this.cabinetList = promotion.quotas.map(elem => elem.cabinet);
    }
  }

  async exportLettrePresidence() {
    await this.sessionViewModel.exportLettrePresidence();
  }

  async exportDecore() {
    await this.sessionViewModel.exportDecore();
  }

  async exportTableauElysee() {
    await this.sessionViewModel.exportTableauElysee();
  }


  onPromotionCodePopupClosed() {
    this.promotionCodePopup = false;
  }


  async onPromotionCodePopupConfirm() {
    await this.sessionViewModel.exportXml(this.promotionCodeValue);
    this.promotionCodePopup = false;
  }

  onReinitDialogClose() {
    this.reinitDialogOpen = false
  }

  async onReinitDeleteSession() {
    await this.sessionViewModel.resetSession();
    window.location.reload()
  }

  onCabinetChange(cabinet: string) {
    this.sessionViewModel.setSelectedCabinet(cabinet);
    const selectedFolders = this.sessionViewModel.sessionFolders.filter(elem => {
      if (elem.session.decoration !== DecorationType.MERITE_MARITIME) {
        return elem?.annuity?.office === cabinet;
      }
      return false;
    })
    this.sessionViewModel.setLHONMAvailableGrade(selectedFolders);
    this.sessionViewModel.initQuotasWithParity(selectedFolders);
    this.sessionViewModel.onChangeView({
      view: 'all',
      folders: selectedFolders,
    });
  }


  onCloseduplicatePresentationPopupPopup() {
    this.duplicatePresentationPopup = false;
  }

  async onConfirmDuplicatePresentationPopup() {
    await this.sessionViewModel.onDuplicatePresentation({
      presentationIds: this.selectedItems.map(item => item.id),
      office: this.selectedOffice,
      sessionName: this.selectedPromotion,
    })
    this.duplicatePresentationPopup = false;
  }



  getLHONMQuotas(): CabinetQuota[] {
    if (this.homeViewModel.currentSession.decoration !== DecorationType.MERITE_MARITIME) {
      return this.homeViewModel.currentSession.quotas
    }
    return []
  }

  onClosureClick() {
    this.closureAvailable = this.sessionViewModel.folders.length <= 0;
    this.closeSessionPopup = true;
  }

  onCloseSessionActionPopup() {
    this.closeSessionPopup = false;
    return;
  }

  async onConfirmDeleteSession() {
    await this.sessionViewModel.deleteSession();
    this.deleteDialogOpen = false;
    const updatedSessionList = this.homeViewModel.sessionList.filter(elem => {
      return elem.id !== this.homeViewModel.currentSession.id;
    })
    const updatedSessions = this.homeViewModel.sessions.filter(elem => {
      return elem.id !== this.homeViewModel.currentSession.id;
    })
    this.homeViewModel.setSessionList(updatedSessionList);
    this.homeViewModel.setSessions(updatedSessions)
    window.location.href = "/"
  }
  async onConfirmCloseSession() {
    await this.homeViewModel.closeSession();
    const filteredDate = (elem: Applicant) =>
        dayjs(new Date(elem.purposedAt)).isBetween(
            new Date(this.homeViewModel.currentSession.startedAt),
            new Date(this.homeViewModel.currentSession.endedAt)
        );
    const filteredFolder = this.folderViewModel.folders.filter(
        elem => elem.status != PresentationStatus.DRAFT && elem.notes.length > 0 && filteredDate(elem)
    );
    const updatedFolders = filteredFolder.map(elem => {
      return {
        ...elem,
        ...(elem.session && {
          session: {
            ...elem.session,
            closedAt: new Date(),
          },
        }),
      };
    });
    this.folderViewModel.setFolders(updatedFolders);
    this.closeSessionPopup = false;
    return;
  }

  @Watch("search")
  async listenOnChange(value: string) {
    this.filters = {
      ...this.filters,
      search: value,
    };
    const folderIds = this.sessionViewModel.sessionFolders.filter(elem => {
      if (elem.session.decoration !== DecorationType.MERITE_MARITIME) {
        return elem?.annuity?.office === this.sessionViewModel.selectedCabinet;
      }
      return false;
    }).map(item => item.id)
    const folderCopy: Applicant[] = this.sessionViewModel.sessionFolders.filter(item => folderIds.includes(item.id));
    const folders = await this.sessionViewModel.applyFolderFilter({
      folders: folderCopy,
      filters: this.filters,
    });
    this.sessionViewModel.onChangeView({
      view: this.sessionViewModel.view,
      folders: folders,
    });
  }

  countFolder(advice: string): number {
    if (advice === "retrait") {
      const retraits = ["retrait cabinet", "retrait élysée", "retrait chancellerie", "retrait présidence"]
      return this.sessionViewModel.sessionFolders.filter(elem => elem.decision != null && retraits.includes(elem.decision?.action?.toLowerCase() as any) && elem.annuity?.office === this.sessionViewModel.selectedCabinet).length
    }
    if (advice === "") {
      return this.sessionViewModel.sessionFolders.filter(elem => elem.decision == null && elem.annuity?.office === this.sessionViewModel.selectedCabinet).length
    }
    return this.sessionViewModel.sessionFolders.filter(elem => elem.decision != null && elem.decision?.action?.toLowerCase() === advice && elem.annuity?.office === this.sessionViewModel.selectedCabinet).length
  }

  async mounted() {
    const folders = await this.sessionViewModel.getSessionFolder();
    await this.sessionViewModel.handleActionList();
    await this.sessionViewModel.getListeData(folders);
    if (this.homeViewModel.currentSession.decreeDate) {
      this.publishDate = dayjs(this.homeViewModel.currentSession.decreeDate).format("YYYY-MM-DD");
    }
    this.closeBtnActive = false;
  }

  @Watch("view")
  async onChangeView(value: string) {
    const folderIds = this.sessionViewModel.sessionFolders.filter(elem => {
      if (elem.session.decoration !== DecorationType.MERITE_MARITIME) {
        return elem?.annuity?.office === this.sessionViewModel.selectedCabinet;
      }
      return false;
    }).map(item => item.id)
    const folderCopy: Applicant[] = this.sessionViewModel.sessionFolders.filter(item => folderIds.includes(item.id));

    const folders = await this.sessionViewModel.applyFolderFilter({
      filters: this.filters,
      folders: folderCopy,
    });
    this.sessionViewModel.onChangeView({
      view: value,
      folders,
    });
  }

  onSessionDialogClose() {
    this.sessionDialogOpen = false;
    window.location.reload();
  }

  onDeleteDialogClose() {
    this.deleteDialogOpen = false;
  }

  openPublicationPopup() {
    this.publicationPopup = true;
  }

  onPublicationPopupClosed() {
    this.publicationPopup = false;
  }
  async onPublicationPopupConfirm() {
    const decreeDate = new Date(this.publishDate);
    await this.sessionViewModel.publishSession(decreeDate);
    await this.sessionViewModel.handleActionList();
    this.publicationPopup = false;
  }

  onCloseActionPopup() {
    this.actionPopup = false;
  }

  async onActionClick(item: string) {
    if (item === 'Dupliquer') {
      this.alertTitle = `Vers quelle promotion souhaitez-vous dupliquer ces présentations`;
      this.duplicatePresentationPopup = true;
      return;
    }
    this.actionSelected = item;
    this.alertTitle = `Êtes-vous sûr de vouloir déplacés ce(s) dossier(s) pour ${item} ?`;
    this.actionPopup = true;
  }



  async onConfirmAction() {
    const user = this.authModule.currentUser;
    const entityId = user?.groups ? user.groups[0].id : null;
    if (entityId) {
      if (this.actionSelected !== 'reset') {
        const selectedItemIds = this.selectedItems.map(elem => elem.id)
        const folders = this.sessionViewModel.sessionFolders.filter(item => selectedItemIds.includes(item.id));

        for (const item of folders) {
          await this.folderViewModel.addNote({
            entityId: entityId.toString(),
            action: this.actionSelected,
            comment: this.finalComment,
            folderId: item.id,
            applicantId: item.applicantId,
          })
        }
      }

      await this.sessionViewModel.addFinalNote({
        action: this.actionSelected,
        presentationIds: this.selectedItems.map(elem => elem.id),
        comment: this.finalComment,
      });
      this.actionPopup = false;
      this.selectedItems = [];
      this.finalComment = "";
    }
  }

  filterFolder(action: string) {
    this.view = action;
  }

  async filterKey(checked: any, item: any, key: string) {
    const folderIds = this.sessionViewModel.sessionFolders.filter(elem => {
      if (elem.session.decoration !== DecorationType.MERITE_MARITIME) {
        return elem?.annuity?.office === this.sessionViewModel.selectedCabinet;
      }
      return false;
    }).map(item => item.id)
    const folderCopy: Applicant[] = this.sessionViewModel.sessionFolders.filter(item => folderIds.includes(item.id));
    if (!checked) {
      // eslint-disable-next-line @typescript-eslint/ban-ts-comment
      //@ts-ignore
      this.filters[key] = this.filters[key].filter(elem => elem != item);
      const folders = await this.sessionViewModel.applyFolderFilter({
        filters: this.filters,
        folders: folderCopy,
      });
      this.sessionViewModel.onChangeView({
        view: this.sessionViewModel.view,
        folders,
      });
      return;
    }
    // eslint-disable-next-line @typescript-eslint/ban-ts-comment
    //@ts-ignore
    this.filters[key].push(item);
    const folders = await this.sessionViewModel.applyFolderFilter({
      filters: this.filters,
      folders: folderCopy,
    });
    this.sessionViewModel.onChangeView({
      view: this.sessionViewModel.view,
      folders,
    });
  }

  async onButtonClick(folderId: string) {
    const folder = this.sessionViewModel.sessionFolders.find(elem => elem.id === folderId);
    if (folder) {
      await this.folderViewModel.selectFolder(folder.applicantId);
      window.open("/mes-dossiers/details", "_blank")
    }
  }
}
</script>

<style lang="scss">

</style>

````

</details>


---

### 📄 `src/modules/sessions/components/MMPromotion.vue` [26.784 octets]
<a id="src-modules-sessions-components-MMPromotion-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-sessions-components-MMPromotion-vue)

> **Chemin relatif** : `src/modules/sessions/components/MMPromotion.vue`  
> **Taille** : 26.784 octets  
> **Lignes** : 778  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (778 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <div class="session-screen container-fluid">
    <div class="justify-space-between align-center">
      <div>
        <h1>
          {{ homeViewModel.currentSession.name }}
        </h1>
        <h2 style="font-weight: 500; font-size: 1.2rem" class="mb-2">
          Décoration: Mérite Maritime
        </h2>
        <div class="flex">
          <span v-if="homeViewModel.currentSession.closedAt != null" style="font-size: 16px"
          >{{
              "Clôturée le " + require("dayjs")(new Date(homeViewModel.currentSession.closedAt)).format("DD/MM/YYYY")
            }}
            &#8226;</span
          >
          <span>
            Décret publié le :
            {{
              !homeViewModel.currentSession.decreeDate
                  ? ""
                  : require("dayjs")(new Date(homeViewModel.currentSession.decreeDate)).format("DD/MM/YYYY")
            }}
          </span>
          <span
              v-if="!homeViewModel.currentSession.decreeDate"
              @click="openPublicationPopup()"
              style="cursor: pointer; margin-bottom: 0; color: #000091; border-bottom: 2px solid #000091"
              role="link"
              tabindex="0"
          >
            <v-icon color="primary" small style="margin-bottom: 10px">{{ penIcon }}</v-icon> Ajouter
          </span>
        </div>

        <h4 class="mt-2">
          Date limite de dépôt des dossiers :
          {{ require("dayjs")(new Date(homeViewModel.currentSession.endedAt)).format("DD/MM/YYYY") }}
        </h4>
      </div>
      <div>
        <v-btn outlined color="primary" class="mr-3" @click="reinitDialogOpen = true" v-if="isAdmin()">
          Réinitialiser clôture et décret
        </v-btn>
        <v-btn outlined color="primary" class="mr-3" :disabled="!sessionViewModel.deletable" @click="deleteDialogOpen = true" v-if="isAdmin()">
          Supprimer
        </v-btn>
        <v-btn
            :disabled="
            homeViewModel.currentSession.closedAt != null ||
            sessionViewModel.sessionFolders.filter(elem => elem.decision == null).length > 0
          "
            color="primary close-session"
            class="mr-3"
            @click="onClosureClick"
        >
          Clôturer
        </v-btn>
        <v-btn
            :disabled="homeViewModel.currentSession.closedAt != null"
            outlined
            color="primary"
            class="mr-3"
            @click="sessionDialogOpen = true"
        >
          Modifier
        </v-btn>
        <update-session-dialog :open="sessionDialogOpen" :on-close="onSessionDialogClose" />
        <v-menu offset-y>
          <template v-slot:activator="{ on, attrs }">
            <v-btn
                id="menu-activator"
                color="primary"
                class="nav-link custom-nav-link"
                outlined
                dark
                v-bind="attrs"
                v-on="on"
            >
              Exporter <v-icon color="primary" class="ml-1">{{ chevronDown }}</v-icon>
            </v-btn>
          </template>
          <v-list>
            <v-list-item v-for="item in exportList" :key="item.id">
              <v-list-item-title
                  v-if="item.id !== 'export'"
                  @click="onExportItemClick(item.id)"
                  style="cursor: pointer"
              >{{ item.title }}</v-list-item-title
              >
              <vue-json-to-csv
                  :json-data="folderViewModel.csvExports"
                  :csv-title="'export'"
                  v-if="item.id === 'export'"
              >
                <v-list-item-title @click="downloadExport" style="cursor: pointer">{{ item.title }}</v-list-item-title>
              </vue-json-to-csv>
            </v-list-item>
          </v-list>
        </v-menu>
      </div>
    </div>

    <div class="title mt-8">
      <img alt="" :src="dataVisualisation" />
      <h2 class="ml-8">Synthèse</h2>
    </div>

    <div class="quota">
      <h3 class="bold">Décorations par contingents et grades :</h3>
      <v-row class="mt-5">
        <v-col lg="3" v-for="(item, i) in sessionViewModel.quotasWithParity" :key="i">
          <div>
            <p class="bold">Contingent {{ item.contingent }}</p>
          </div>
          <div>
            <div v-for="(grade, idx) in item.grades" :key="idx" class="mt-5">
              <p>{{ grade.grade }} :</p>
              <div class="result">
                <v-progress-linear
                    :value="
                    isNaN(Math.round(grade.quantity / grade.received)) || grade.received === 0
                      ? 0
                      : Math.round((grade.received / grade.quantity) * 100)
                  "
                ></v-progress-linear>
                <p class="ml-5 mb-0">{{ grade.received }} / {{ grade.quantity }}</p>
              </div>
            </div>
            <v-divider class="mt-5 mb-5" style="width: 170px" />
            <p class="bold">Parité :</p>
            <div class="result">
              <v-progress-linear
                  :value="
                  isNaN(Math.round(item.totalFolders / item.numberOfWomens)) || item.numberOfWomens === 0
                    ? 0
                    : Math.round((item.numberOfWomens / item.totalFolders) * 100)
                "
              ></v-progress-linear>
              <p class="ml-5 mb-0" v-if="item.totalFolders > 0">{{ item.numberOfWomens }} / {{ item.totalFolders }}</p>
              <p class="ml-5 mb-0" v-if="item.totalFolders === 0">0</p>
            </div>
          </div>
        </v-col>
      </v-row>
    </div>

    <div class="title mt-8">
      <img alt="" :src="documentImg" />
      <h2 class="ml-8">Dossiers de la promotion</h2>
    </div>
    <v-row class="mt-3">
      <v-col lg="4">
        <text-field label="Recherche" :required="false" :default-value="search" v-model="search" field-type="text" />
      </v-col>
    </v-row>

    <v-tabs class="mt-5 mb-5">
      <v-tab active-class="gouv-design-system" class="tab-inactive" @click="filterFolder('all')">
        Dossiers présentés
        <span v-if="presentedFolders" class="ml-2" style="margin-bottom: 5px">({{ presentedFolders }})</span>
      </v-tab>
      <v-tab active-class="gouv-design-system" class="tab-inactive" @click="filterFolder('décorés')">
        Dossiers Décorés
        <span v-if="purposedFolders" class="ml-2" style="margin-bottom: 5px">({{ purposedFolders }})</span>
      </v-tab>
      <v-tab active-class="gouv-design-system" class="tab-inactive" @click="filterFolder('non agrée')">
        Dossiers non agréés
        <span v-if="nonAgreedFolders" class="ml-2" style="margin-bottom: 5px">({{ nonAgreedFolders }})</span>
      </v-tab>
      <v-tab active-class="gouv-design-system" class="tab-inactive" @click="filterFolder('ajourner')">
        Dossiers ajournés
        <span v-if="refusedFolders" class="ml-2" style="margin-bottom: 5px">({{ refusedFolders }})</span>
      </v-tab>
      <v-tab active-class="gouv-design-system" class="tab-inactive" @click="filterFolder('non présenté')">
        Dossiers non présentés
        <span v-if="nonPresentedFolders" class="ml-2" style="margin-bottom: 5px">({{ nonPresentedFolders }})</span>
      </v-tab>
    </v-tabs>
    <v-data-table
        :headers="headers"
        :items="sessionViewModel.folders"
        :items-per-page="10"
        calculate-widths
        class="elevation-0 mt-8"
        locale="fr-FR"
        :show-select="homeViewModel.currentSession.closedAt == null"
        v-model="selectedItems"
        item-key="id"
    >
      <template v-slot:header.contingent>
        <v-menu bottom :close-on-content-click="false" offset-y>
          <template v-slot:activator="{ on, attrs }">
            <p class="header-item" v-bind="attrs" v-on="on">Contingent</p>
          </template>
          <v-list v-for="(item, index) in sessionViewModel.availableContingent" :key="index">
            <v-list-item>
              <template v-slot:default="{ active }">
                <v-list-item-action>
                  <v-checkbox :input-value="active" @change="filterKey($event, item, 'contingent')" />
                </v-list-item-action>
                <v-list-item-content>
                  <v-list-item-title>Contingent {{ item }}</v-list-item-title>
                </v-list-item-content>
              </template>
            </v-list-item>
            <v-divider v-if="index < sessionViewModel.availableContingent.length - 1" :key="index"></v-divider>
          </v-list>
        </v-menu>
      </template>
      <template v-slot:header.grade>
        <v-menu bottom :close-on-content-click="false" offset-y>
          <template v-slot:activator="{ on, attrs }">
            <p class="header-item" v-bind="attrs" v-on="on">Grade</p>
          </template>
          <v-list v-for="(item, index) in sessionViewModel.availableGrade" :key="index">
            <v-list-item>
              <template v-slot:default="{ active }">
                <v-list-item-action>
                  <v-checkbox :input-value="active" @change="filterKey($event, item, 'grade')" />
                </v-list-item-action>
                <v-list-item-content>
                  <v-list-item-title>{{ item }}</v-list-item-title>
                </v-list-item-content>
              </template>
            </v-list-item>
            <v-divider v-if="index < sessionViewModel.availableGrade.length - 1" :key="index"></v-divider>
          </v-list>
        </v-menu>
      </template>
      <template v-slot:header.note>
        <v-menu bottom :close-on-content-click="false" offset-y>
          <template v-slot:activator="{ on, attrs }">
            <p class="header-item" v-bind="attrs" v-on="on">Avis rapporteur</p>
          </template>
          <v-list v-for="(item, index) in sessionViewModel.rapporterAdvice" :key="index">
            <v-list-item>
              <template v-slot:default="{ active }">
                <v-list-item-action>
                  <v-checkbox :input-value="active" @change="filterKey($event, item, 'rapporterAdvice')" />
                </v-list-item-action>
                <v-list-item-content>
                  <v-list-item-title>{{ item }}</v-list-item-title>
                </v-list-item-content>
              </template>
            </v-list-item>
            <v-divider v-if="index < sessionViewModel.rapporterAdvice.length - 1" :key="index"></v-divider>
          </v-list>
        </v-menu>
      </template>
      <template v-slot:header.controls v-if="selectedItems.length > 0">
        <v-menu bottom offset-y>
          <template v-slot:activator="{ on, attrs }">
            <v-btn v-bind="attrs" v-on="on"> Choisir action </v-btn>
          </template>
          <v-list v-for="(item, index) in actions" :key="index">
            <v-list-item>
              <template>
                <v-list-item-content style="cursor: pointer" @click="onActionClick(item)">
                  <v-list-item-title>{{ item }}</v-list-item-title>
                </v-list-item-content>
              </template>
            </v-list-item>
            <v-list-item v-if="index === actions.length - 1 && view !== 'all'">
              <template>
                <v-list-item-content style="cursor: pointer" @click="onActionClick('reset')">
                  <v-list-item-title>Réinitialiser</v-list-item-title>
                </v-list-item-content>
              </template>
            </v-list-item>
            <v-divider v-if="index <= actions.length - 1" :key="index"></v-divider>
          </v-list>
        </v-menu>
      </template>

      <template v-slot:item.controls="props">
        <v-btn icon outlined color="primary" @click="onButtonClick(props.item.id)" title="Consulter la promotion" aria-label="Aller à la page des détails de la promotion">
          <v-icon color="primary">
            {{ eyeIcon }}
          </v-icon>
        </v-btn>
      </template>
      <template v-slot:item.action="props">
        <p class="action">
          <v-icon small style="vertical-align: middle; margin-bottom: 3px; color: #0063cb">
            {{ info }}
          </v-icon>
          {{ props.item.action }}
        </p>
      </template>
    </v-data-table>
    <alert :open="actionPopup" :on-close="onCloseActionPopup" :on-confirm="onConfirmAction" :with-confirmation="true">
      <template v-slot:title>
        <h2 class="pb-3">
          <v-icon large style="margin-bottom: 5px; color: #161616">
            {{ infoIcon }}
          </v-icon>
          <span>{{ alertTitle }}</span>
        </h2>
      </template>
      <template v-slot:message>
        <text-field
            v-if="actionSelected !== 'reset'"
            label="Commentaire (facultatif)"
            :required="false"
            :default-value="finalComment"
            v-model="finalComment"
            field-type="text-area"
        />
      </template>
    </alert>
    <alert
        :open="deleteDialogOpen"
        :on-close="onDeleteDialogClose"
        :on-confirm="onConfirmDeleteSession"
        :with-confirmation="true"
    >
      <template v-slot:title>
        <h2>Etes-vous sûr de vouloir supprimer cette promotion ?</h2>
      </template>
    </alert>
    <alert
      :open="reinitDialogOpen"
      :on-close="onReinitDialogClose"
      :on-confirm="onReinitDeleteSession"
      :with-confirmation="true"
    >
      <template v-slot:title>
        <h2>Etes-vous sûr de vouloir réinitialiser la date de clôture et de décrêt ?</h2>
      </template>
      <template>
        <p>Cette opération permettra l'ajout de nouveau candidat pour cette promotion.</p>
      </template>
    </alert>
    <alert
        :open="closeSessionPopup"
        :on-close="onCloseSessionActionPopup"
        :on-confirm="onConfirmCloseSession"
        :with-confirmation="true"
    >
      <template v-slot:title>
        <h2>Etes-vous sûr de vouloir clôturer cette promotion ?</h2>
      </template>
      <template v-slot:message>
        <p class="pt-5">Vous ne pourrez plus modifier cette promotion.</p>
        <p>Les avis du conseil de l’ordre seront rendus publics.</p>
        <p>Les avis des rapporteurs restent confidentiels.</p>
        <p>Les dossiers seront accessibles à toutes les personnes ayant accès à Honoré depuis l’espace archive</p>
      </template>
    </alert>
    <alert
        :open="publicationPopup"
        :on-close="onPublicationPopupClosed"
        :on-confirm="onPublicationPopupConfirm"
        :with-confirmation="true"
    >
      <template v-slot:title>
        <h2>Ajouter la date de publication du décret</h2>
      </template>
      <template v-slot:message>
        <div class="mt-4">
          <text-field
              label="Date de publication du décret"
              type="date"
              :mandatory="true"
              :required="true"
              :default-value="publishDate"
              v-model="publishDate"
          />
        </div>
      </template>
    </alert>
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import { lazyInject } from "@pasta/box";
import { FolderFilters, SessionViewModel } from "@/modules/sessions/viewModels/SessionViewModel";
import DocumentImg from "@/assets/document.png";
import DataVisualisation from "@/assets/data_visualization.png";
import { mdiArrowRight, mdiChevronDown, mdiEyeCircleOutline, mdiInformation, mdiPen } from "@mdi/js";
import { FolderViewModel } from "@/modules/folders/viewModels/FolderViewModel";
import { HomeViewModel } from "@/modules/home/viewModels/HomeViewModel";
import { AuthModule } from "@pasta/front-auth";
import { OnBoardingViewModel } from "@/modules/onBoarding/viewModels/OnBoardingViewModel";
import { Applicant } from "@/core/entities/Applicant";
import Alert from "@/components/Alert.vue";
// eslint-disable-next-line @typescript-eslint/ban-ts-comment
//@ts-ignore
import VueJsonToCsv from "vue-json-to-csv";
import dayjs from "dayjs";
import TextField from "@/components/TextField.vue";
import { Watch } from "vue-property-decorator";
import UpdateSessionDialog from "@/modules/sessions/components/UpdateSessionDialog.vue";
import { FolderDetailViewModel } from "@/modules/folders/viewModels/FolderDetailViewModel";
import { PresentationStatus } from "@/core/entities/Applicant";

@Component({
  components: {
    VueJsonToCsv,
    Alert,
    TextField,
    UpdateSessionDialog,
  },
})
export default class MMPromotion extends Vue {
  @lazyInject(SessionViewModel)
  declare sessionViewModel: SessionViewModel;

  @lazyInject(FolderViewModel)
  declare folderViewModel: FolderViewModel;

  @lazyInject(HomeViewModel)
  declare homeViewModel: HomeViewModel;

  @lazyInject(AuthModule)
  declare authModule: AuthModule;

  @lazyInject(OnBoardingViewModel)
  declare onboardingViewModel: OnBoardingViewModel;

  @lazyInject(FolderDetailViewModel)
  declare folderDetailViewModel: FolderDetailViewModel;

  documentImg = DocumentImg;
  dataVisualisation = DataVisualisation;
  eyeIcon = mdiEyeCircleOutline;
  info = mdiInformation;
  infoIcon = mdiArrowRight;
  penIcon = mdiPen;
  chevronDown = mdiChevronDown;

  finalComment = "";

  purposedFolders = 0;
  presentedFolders = 0;
  nonAgreedFolders = 0;
  refusedFolders = 0;
  nonPresentedFolders = 0;

  exportList = [
    {
      id: "stickers",
      title: "Etiquettes",
    },
    {
      id: "degrees",
      title: "Diplômes",
    },
    {
      id: "arrete",
      title: "Arrêté",
    },
    {
      id: "export",
      title: "Export Excel",
    },
  ];

  closeBtnActive = true;

  view = "all";

  closureAvailable = true;

  alertTitle = "";

  actionPopup = false;

  closeSessionPopup = false;

  actions = ["Décorés", "Non agrée", "Ajourner", "Non présenté"];
  actionSelected = "";

  selectedItems: { id: string }[] = [];

  sessionDialogOpen = false;
  deleteDialogOpen = false;
  reinitDialogOpen = false;
  publicationPopup = false;

  publishDate = "";

  filters: FolderFilters = {
    contingent: [],
    grade: [],
    rapporterAdvice: [],
    search: "",
  };

  search = "";

  headers = [
    {
      text: "Status dossier",
      align: "start",
      value: "folderStatus",
      groupable: false,
      width: "10%",
    },
    {
      text: "Nom du candidat",
      align: "start",
      value: "name",
      groupable: false,
      width: "20%",
    },
    { text: "Proposé par", value: "purposeBy", groupable: false, width: "20%" },
    { text: "Avis rapporteur", value: "note", groupable: false, sortable: false, width: "20%" },
    { text: "Grade", value: "grade", groupable: false, sortable: false, width: "10%" },
    { text: "Contingent", value: "contingent", sortable: false, width: "10%" },
    { text: "", value: "controls", sortable: false, align: "end", groupable: false, width: "10%" },
  ];
  isAdmin() {
    const currentUser = this.authModule.currentUser;
    return currentUser?.highestRoleLevel && currentUser?.highestRoleLevel >= 1000;
  }
  async onExportItemClick(id: string) {
    switch (id) {
      case "stickers":
        await this.sessionViewModel.exportStickers();
        break;
      case "degrees":
        await this.sessionViewModel.exportDegree();
        break;
      case "arrete":
        await this.sessionViewModel.exportDecree();
        break;
      default:
        return;
    }
  }

  onClosureClick() {
    this.closureAvailable = this.sessionViewModel.folders.length <= 0;
    this.closeSessionPopup = true;
  }

  onCloseSessionActionPopup() {
    this.closeSessionPopup = false;
    return;
  }

  async onConfirmDeleteSession() {
    await this.sessionViewModel.deleteSession();
    this.deleteDialogOpen = false;
    const updatedSessionList = this.homeViewModel.sessionList.filter(elem => {
      return elem.id !== this.homeViewModel.currentSession.id;
    })
    const updatedSessions = this.homeViewModel.sessions.filter(elem => {
      return elem.id !== this.homeViewModel.currentSession.id;
    })
    this.homeViewModel.setSessionList(updatedSessionList);
    this.homeViewModel.setSessions(updatedSessions)
    window.location.href = "/"
  }

  onReinitDialogClose() {
    this.reinitDialogOpen = false
  }

  async onReinitDeleteSession() {
    await this.sessionViewModel.resetSession();
    window.location.reload()
  }


  async onConfirmCloseSession() {
    await this.homeViewModel.closeSession();
    const filteredDate = (elem: Applicant) =>
        dayjs(new Date(elem.purposedAt)).isBetween(
            new Date(this.homeViewModel.currentSession.startedAt),
            new Date(this.homeViewModel.currentSession.endedAt)
        );
    const filteredFolder = this.folderViewModel.folders.filter(
        elem => elem.status != PresentationStatus.DRAFT && elem.notes.length > 0 && filteredDate(elem)
    );
    const updatedFolders = filteredFolder.map(elem => {
      return {
        ...elem,
        ...(elem.session && {
          session: {
            ...elem.session,
            closedAt: new Date(),
          },
        }),
      };
    });
    this.folderViewModel.setFolders(updatedFolders);
    this.closeSessionPopup = false;
    return;
  }

  @Watch("search")
  async listenOnChange(value: string) {
    this.filters = {
      ...this.filters,
      search: value,
    };
    const folders = await this.sessionViewModel.applyFolderFilter({
      folders: this.sessionViewModel.sessionFolders,
      filters: this.filters,
    });
    this.sessionViewModel.onChangeView({
      view: this.sessionViewModel.view,
      folders,
    });
    this.getCountFolders(folders);
  }

  getCountFolders(folders: Applicant[]) {
    this.purposedFolders = this.countFilteredFolders(folders, elem => {
      return elem.decision != null && elem.decision.action?.toLowerCase() === "décorés";
    });
    this.presentedFolders = this.countFilteredFolders(folders, elem => {
      return elem.decision == null;
    });
    this.refusedFolders = this.countFilteredFolders(folders, elem => {
      return elem.decision != null && elem.decision.action?.toLowerCase() === "ajourner";
    });
    this.nonAgreedFolders = this.countFilteredFolders(folders, elem => {
      return elem.decision != null && elem.decision.action?.toLowerCase() === "non agrée";
    });
    this.nonPresentedFolders = this.countFilteredFolders(folders, elem => {
      return elem.decision != null && elem.decision.action?.toLowerCase() === "non présenté";
    });
  }

  countFilteredFolders(folders: Applicant[], filter: (item: Applicant) => boolean) {
    return folders.filter(filter).length;
  }

  async mounted() {
    await this.sessionViewModel.getSessionFolder();
    if (this.homeViewModel.currentSession.decreeDate) {
      this.publishDate = dayjs(this.homeViewModel.currentSession.decreeDate).format("YYYY-MM-DD");
    }
    this.closeBtnActive = false;
  }

  @Watch("view")
  async onChangeView(value: string) {
    const folders = await this.sessionViewModel.applyFolderFilter({
      filters: this.filters,
      folders: this.sessionViewModel.sessionFolders,
    });
    this.sessionViewModel.onChangeView({
      view: value,
      folders,
    });
  }

  async downloadExport() {
    const folders = await this.sessionViewModel.applyFolderFilter({
      folders: this.sessionViewModel.sessionFolders,
      filters: this.filters,
    });
    this.folderViewModel.prepareDataForCsv({
      folders: folders,
      promotion: this.homeViewModel.currentSession.name,
    });
  }

  async isSessionDeletable() {
    await this.sessionViewModel.isSessionDeletable();
  }
  onSessionDialogClose() {
    this.sessionDialogOpen = false;
  }

  onDeleteDialogClose() {
    this.deleteDialogOpen = false;
  }

  openPublicationPopup() {
    this.publicationPopup = true;
  }

  onPublicationPopupClosed() {
    this.publicationPopup = false;
  }
  async onPublicationPopupConfirm() {
    const decreeDate = new Date(this.publishDate);
    await this.sessionViewModel.publishSession(decreeDate);
    this.publicationPopup = false;
  }

  onCloseActionPopup() {
    this.actionPopup = false;
  }

  async onActionClick(item: string) {
    this.actionSelected = item;
    if (item.toLowerCase() === "décorés") {
      this.alertTitle = "Êtes-vous sûr de vouloir décorer ce(s) dossier(s) ?";
    }
    if (item.toLowerCase() === "non agrée") {
      this.alertTitle = "Êtes-vous sûr de ne pas vouloir agréer ce(s) dossier(s) ?";
    }
    if (item.toLowerCase() === "ajourner") {
      this.alertTitle = "Êtes-vous sûr de vouloir ajourner ce(s) dossier(s) ?";
    }
    if (item.toLowerCase() === "reset") {
      this.alertTitle = "Êtes-vous sûr de vouloir réinitialiser ce(s) dossier ?";
    }
    if (item.toLowerCase() === "non présenté") {
      this.alertTitle = "Êtes-vous sûr de ne pas vouloir présenter ce(s) dossier ?";
    }
    this.actionPopup = true;
  }

  async onConfirmAction() {
    const user = this.authModule.currentUser;
    const entityId = user?.groups ? user.groups[0].id : null;
    if (entityId) {
      await this.sessionViewModel.addFinalNote({
        action: this.actionSelected,
        presentationIds: this.selectedItems.map(elem => elem.id),
        comment: this.finalComment,
      });
      this.actionPopup = false;
      this.selectedItems = [];
      this.finalComment = "";
    }
  }

  filterFolder(action: string) {
    this.view = action;
  }

  async filterKey(checked: any, item: any, key: string) {
    const folderCopy: Applicant[] = this.sessionViewModel.sessionFolders;
    if (!checked) {
      // eslint-disable-next-line @typescript-eslint/ban-ts-comment
      //@ts-ignore
      this.filters[key] = this.filters[key].filter(elem => elem != item);
      const folders = await this.sessionViewModel.applyFolderFilter({
        filters: this.filters,
        folders: folderCopy,
      });
      this.sessionViewModel.onChangeView({
        view: this.sessionViewModel.view,
        folders,
      });
      this.getCountFolders(folders);
      return;
    }
    // eslint-disable-next-line @typescript-eslint/ban-ts-comment
    //@ts-ignore
    this.filters[key].push(item);
    const folders = await this.sessionViewModel.applyFolderFilter({
      filters: this.filters,
      folders: folderCopy,
    });
    this.sessionViewModel.onChangeView({
      view: this.sessionViewModel.view,
      folders,
    });
    this.getCountFolders(folders);
  }

  async onButtonClick(folderId: string) {
    const folder = this.sessionViewModel.sessionFolders.find(elem => elem.id === folderId);
    if (folder) {
      await this.folderViewModel.selectFolder(folder.applicantId);
      window.open("/mes-dossiers/details", "_blank")
    }
  }
}
</script>

<style lang="scss">

</style>

```

</details>


---

### 📄 `src/modules/sessions/components/SessionDialog.vue` [11.828 octets]
<a id="src-modules-sessions-components-SessionDialog-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-sessions-components-SessionDialog-vue)

> **Chemin relatif** : `src/modules/sessions/components/SessionDialog.vue`  
> **Taille** : 11.828 octets  
> **Lignes** : 405  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (405 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <alert
    :open="open"
    :on-close="onSessionClose"
    :with-confirmation="true"
    :on-confirm="onConfirm"
  >
    <template v-slot:title>
      <div style="display: flex; align-items: flex-start;">
        <v-icon x-large style="color: #161616;vertical-align: middle;">
          {{ right }}
        </v-icon>
        <h2 class="pb-5" style="font-size: 20px;line-height: 1.5" v-if="currentIndex === 0">
          Choix de la décoration
        </h2>
        <h2 class="pb-5" style="font-size: 20px;line-height: 1.5" v-if="currentIndex === 1">
          Ajouter une promotion
        </h2>
        <h2 class="pb-5" style="font-size: 20px;line-height: 1.5" v-if="currentIndex === 2">
          Paramétrer le nombre de croix de la promotion
        </h2>
      </div>
    </template>

    <template v-slot:message>
      <div v-if="currentIndex === 0">
        <p>
          Choisissez pour quelle type de décoration
        </p>
        <v-radio-group
            role="radiogroup"
            aria-labelledby="decoration"
            class="decoration--choice"
            mandatory
            v-model="decoration"
        >
          <template v-slot:label>
            <span>Sélectionnez une décoration</span>
          </template>
          <v-radio aria-checked="null" id="decoration" label="Mérite Maritime" value="merite_maritime"></v-radio>
          <v-radio :disabled="!isChancellerie()" aria-checked="null" id="decoration" label="Légion d'Honneur" value="legion_honneur"></v-radio>
          <v-radio :disabled="!isChancellerie()" aria-checked="null" id="decoration" label="Ordre national du mérite" value="ordre_national_du_merite"></v-radio>
        </v-radio-group>
      </div>
      <div v-if="currentIndex === 1">
        <v-row class="mt-1">
          <v-col
            cols="12"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="Nom de la promotion"
              :required="false"
              :default-value="sessionName"
              v-model="sessionName"
              :error-messages="sessionNameErrors"
            />
          </v-col>
          <v-col
            cols="12"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              v-if="decoration === 'merite_maritime'"
              label="Date limite de dépôt des dossiers"
              type="date"
              :required="true"
              :default-value="endedAt"
              :error-messages="endedAtErrors"
              v-model="endedAt"
            />
            <span v-if="dateMsgNotValid !== ''" class="mt-0 text-red" style="margin: 0;">{{ dateMsgNotValid }}</span>
          </v-col>
        </v-row>
        <div v-if="decoration !== 'merite_maritime'">
          <p class="mt-5 mb-2">
            Choisissez les cabinets que vous souhaitez ajouter à la promotion
          </p>
          <p style="font-size: 13px; color:#666666">
            Sélectionnez le(s) cabinet(s)
          </p>
          <div v-for="item in homeViewModel.cabinets" v-bind:key="item.id">
            <v-checkbox
                class="mt-0"
                v-model="selectedCabinets"
                :label="item.name"
                :value="item.id"
            />
          </div>
          <p v-if="selectCabinetError" style="color: red;">Veuillez sélectionner un cabinet</p>
        </div>
      </div>
      <div v-if="currentIndex === 2">
        <v-row v-if="decoration === 'merite_maritime'">
          <v-col
            v-for="(item,i) in quotas"
            :key="i"
            cols="4"
          >
            <p class="title">{{ item.title }}</p>
            <v-row>
              <v-col
                cols="12"
                v-for="(grade, i) in item.grades"
                :key="i"
              >
                <text-field
                  :label="grade.name"
                  :required="false"
                  :default-value="grade.value"
                  v-model="grade.value"
                  type="number"
                />
              </v-col>
            </v-row>
          </v-col>
        </v-row>
        <div
            v-if="decoration !== 'merite_maritime'"
            class="mt-5"
        >
          <div
              v-for="(elem) in cabinetQuotas"
              :key="elem.id"
          >
            <p style="font-weight: 500;margin-bottom: 0;">{{elem.cabinet}}</p>
            <div style="display: flex; align-items: center;">
              <div
                  class="pt-0 pb-0 mr-1 ml-1"

                  v-for="(item, idx) in elem.grades"
                  :key="idx"
              >
                <text-field
                    :label="item.grade"
                    :required="false"
                    :default-value="item.quantity"
                    v-model="item.quantity"
                    type="number"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
    </template>
  </alert>
</template>

<script lang="ts">
import Component from "vue-class-component";
import Vue from "vue";
import Alert from "@/components/Alert.vue";
import {mdiArrowRight} from "@mdi/js";
import {Prop} from "vue-property-decorator";
import {lazyInject, Validation} from "@pasta/box";
import {required} from "vuelidate/lib/validators";
import TextField from "@/components/TextField.vue";
import {HomeViewModel} from "@/modules/home/viewModels/HomeViewModel";
import {ContingentType} from "@/core/types/training/ContingentType";
import {Grade} from "@/core/types/training/Grade";
import dayjs from "dayjs";
import {DecorationType} from "@/modules/onBoarding/types/DecorationType";
import {AuthModule} from "@pasta/front-auth";
import {AuthRole} from "@/core/types/identity/AuthRole";


@Component({
  components: {
    Alert,
    TextField
  }
})
export default class SessionDialog extends Vue {
  right = mdiArrowRight;

  @Prop({required: true, default: false})
  declare open: boolean;

  @Prop({required: true})
  declare onClose: Function;

  currentIndex = 0;

  @lazyInject(HomeViewModel)
  declare homeViewModel: HomeViewModel;

  @lazyInject(AuthModule)
  declare authModule: AuthModule;


  selectCabinetError = false;

  @Validation({
    required: {
      errorMessage: "Veuillez remplir le nom de la promotion",
      validator: required,
    }
  })
  sessionName = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner une fin de promotion",
      validator: required,
    }
  })
  endedAt = "";

  dateMsgNotValid = "";


  quotas = [
    {
      id: 1,
      title: 'Contingent A',
      contingent: ContingentType.CIVIL,
      grades: [{
        name: Grade.COMMANDER,
        value: "0"
      }, {
        name: Grade.OFFICER,
        value: "0"
      }, {
        name: Grade.KNIGHT,
        value: "0"
      }]
    },
    {
      id: 2,
      title: 'Contingent B',
      contingent: ContingentType.DEFENSE,
      grades: [{
        name: Grade.COMMANDER,
        value: "0"
      }, {
        name: Grade.OFFICER,
        value: "0"
      }, {
        name: Grade.KNIGHT,
        value: "0"
      }]
    },
    {
      id: 3,
      contingent: ContingentType.ADMINISTRATIVE,
      title: 'Contingent C',
      grades: [{
        name: Grade.COMMANDER,
        value: "0"
      }, {
        name: Grade.OFFICER,
        value: "0"
      }, {
        name: Grade.KNIGHT,
        value: "0"
      }]
    }
  ]

  decoration = DecorationType.ORDRE_NATIONAL_DU_MERITE;

  selectedCabinets: string[] = []

  cabinetQuotas: any[] = []

  onSessionClose() {
    this.endedAt = "";
    this.sessionName = "";
    this.quotas = this.quotas.map(elem => {
      return {
        ...elem,
        grades: elem.grades.map(item => {
          return {
            ...item,
            value: "0"
          }
        })
      }
    });
    this.decoration = DecorationType.MERITE_MARITIME;
    this.selectedCabinets = [];
    this.cabinetQuotas = [];
    this.currentIndex = 0;
    return this.onClose();
  }

  async onConfirm() {
    if (this.currentIndex === 0) {
      this.currentIndex = 1;
      return;
    }
    if (this.currentIndex === 1) {
      if (this.decoration !== DecorationType.MERITE_MARITIME) {
        this.cabinetQuotas = this.selectedCabinets.map(elem => {
          const cabinet = this.homeViewModel.cabinets.find(item => item.id === elem);
          if (cabinet) {
            return cabinet.name;
          }
          return elem;
        }).map((elem, index) => {
          return {
            id: index,
            cabinet: elem,
            grades: Object.values(Grade).map(elem => {
              return {
                quantity: "0",
                grade: elem
              }
            })
          }
        })
      }
      if (this.decoration !== DecorationType.MERITE_MARITIME) {
        this.endedAt = new Date().toISOString();
      }
      this.$v.$touch();
    }
    const isValid = this.$v.$invalid;
    if (!isValid) {
      if (this.currentIndex === 1) {
        const sessions = this.homeViewModel.sessions.filter(item => item.decoration === this.decoration);
        if (sessions.length > 0 && this.decoration === DecorationType.MERITE_MARITIME) {
          const lastSession = sessions.sort((a, b) => +new Date(b.endedAt) - +new Date(a.endedAt))[0];
          if (dayjs(new Date(lastSession.endedAt)).isAfter(this.endedAt)) {
            this.dateMsgNotValid = `La dernière promotion s'est terminée le ${dayjs(new Date(lastSession.endedAt)).format('DD/MM/YYYY')}. Merci de choisir une date ultérieure à celle-ci.`
            return;
          }
        }
        if (this.decoration !== DecorationType.MERITE_MARITIME && this.selectedCabinets.length <= 0) {
          this.selectCabinetError = true;
          return;
        }
        this.selectCabinetError = false;
        this.dateMsgNotValid = "";
        this.currentIndex = 2;
        console.log('oaze')
        return;
      }
      const sessions = this.homeViewModel.sessions;
      let startedAt: Date = new Date("2022-10-01");
      if (sessions.length > 0) {
        const sortedSession = sessions.sort((a, b) => +new Date(b.endedAt) - +new Date(a.endedAt));
        startedAt = dayjs(new Date(sortedSession[0].endedAt)).add(1, 'day').toDate();
      }
      if (this.decoration === DecorationType.MERITE_MARITIME) {
        await this.homeViewModel.saveSession({
          id: "",
          endedAt: new Date(this.endedAt),
          startedAt: startedAt,
          name: this.sessionName,
          quotas: this.quotas.map(elem => {
            return {
              contingent: elem.contingent,
              grades: elem.grades.map(item => {
                return {
                  quantity: +item.value,
                  grade: item.name,
                }
              })
            }
          }),
          closedAt: null,
          decoration: this.decoration,
        })
        return this.onSessionClose();
      }
      await this.homeViewModel.saveSession({
        id: "",
        endedAt: new Date(this.endedAt),
        startedAt: startedAt,
        name: this.sessionName,
        quotas: this.cabinetQuotas.map(elem => {
          return {
            cabinet: elem.cabinet,
            grades: elem.grades.map((item: any) => {
              return {
                quantity: +item.quantity,
                grade: item.grade,
              }
            })
          }
        }),
        closedAt: null,
        decoration: this.decoration,
      })
      return this.onSessionClose();
    }
  }

  isChancellerie() {
    const currentUser = this.authModule.currentUser;
    return currentUser?.highestRoleLevel && currentUser?.highestRoleLevel >= AuthRole.CHANCELLERY;
  }

}
</script>
<style>
.text-red {
  color: red;
}
</style>

````

</details>


---

### 📄 `src/modules/sessions/components/UpdateSessionDialog.vue` [6.539 octets]
<a id="src-modules-sessions-components-UpdateSessionDialog-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-sessions-components-UpdateSessionDialog-vue)

> **Chemin relatif** : `src/modules/sessions/components/UpdateSessionDialog.vue`  
> **Taille** : 6.539 octets  
> **Lignes** : 231  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (231 lignes) - Cliquer pour déplier</summary>

```text
<template>
  <alert
    :open="open"
    :on-close="onSessionClose"
    :with-confirmation="true"
    :on-confirm="onConfirm"
  >
    <template v-slot:title>
      <div style="display: flex; align-items: flex-start;">
        <v-icon x-large style="color: #161616;vertical-align: middle;">
          {{ right }}
        </v-icon>
        <h2 v-if="currentIndex === 1" class="pb-5" style="font-size: 20px;line-height: 1.5">
          Modifier la promotion
        </h2>
        <h2 class="pb-5" style="font-size: 20px;line-height: 1.5" v-if="currentIndex === 2">
          Paramétrer le nombre de croix de la promotion
        </h2>
      </div>

    </template>

    <template v-slot:message>
      <div v-if="currentIndex === 1">
        <v-row class="mt-1">
          <v-col
            cols="12"
            sm="6"
            class="pt-0 pb-0"
          >
            <text-field
              label="Nom de la promotion"
              :required="false"
              :default-value="homeViewModel.currentSession.name"
              v-model="sessionName"
              :error-messages="sessionNameErrors"
            />
          </v-col>
          <v-col
            cols="12"
            sm="6"
            class="pt-0 pb-0"
            v-if="homeViewModel.currentSession.decoration === 'merite_maritime'"
          >
            <text-field
              label="Date limite de dépôt des dossiers"
              type="date"
              :required="true"
              :default-value="toDefaultDate()"
              :error-messages="endedAtErrors"
              v-model="endedAt"
            />
            <span v-if="dateMsgNotValid !== ''" class="mt-0 text-red" style="margin: 0;">{{ dateMsgNotValid }}</span>
          </v-col>
        </v-row>
      </div>
      <div v-if="homeViewModel.currentSession.decoration !== 'merite_maritime'">
        <div
          class="mt-5"
        >
          <div
            v-for="(elem) in cabinetQuotas"
            :key="elem.id"
          >
            <p style="font-weight: 500;margin-bottom: 0;">{{elem.cabinet}}</p>
            <div style="display: flex; align-items: center;">
              <div
                class="pt-0 pb-0 mr-1 ml-1"

                v-for="(item, idx) in elem.grades"
                :key="idx"
              >
                <text-field
                  :label="item.grade"
                  :required="false"
                  :default-value="item.quantity"
                  v-model="item.quantity"
                  type="number"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
    </template>
  </alert>
</template>

<script lang="ts">
import Component from "vue-class-component";
import Vue from "vue";
import Alert from "@/components/Alert.vue";
import {mdiArrowRight} from "@mdi/js";
import {Prop} from "vue-property-decorator";
import {lazyInject, Validation} from "@pasta/box";
import {required} from "vuelidate/lib/validators";
import TextField from "@/components/TextField.vue";
import {HomeViewModel} from "@/modules/home/viewModels/HomeViewModel";
import {ContingentType} from "@/core/types/training/ContingentType";
import {Grade} from "@/core/types/training/Grade";
import dayjs from "dayjs";
import {SessionViewModel} from "@/modules/sessions/viewModels/SessionViewModel";
import {DecorationType} from "@/modules/onBoarding/types/DecorationType";


@Component({
  components: {
    Alert,
    TextField
  }
})
export default class UpdateSessionDialog extends Vue {
  right = mdiArrowRight;

  @Prop({required: true, default: false})
  declare open: boolean;

  @Prop({required: true})
  declare onClose: Function;

  currentIndex = 1;

  cabinetQuotas: any[] = []


  @lazyInject(HomeViewModel)
  declare homeViewModel: HomeViewModel;

  @lazyInject(SessionViewModel)
  declare sessionViewModel: SessionViewModel;

  @Validation({
    required: {
      errorMessage: "Veuillez remplir le nom de la promotion",
      validator: required,
    }
  })
  sessionName = "";

  @Validation({
    required: {
      errorMessage: "Veuillez renseigner une fin de promotion",
      validator: required,
    }
  })
  endedAt = "";

  dateMsgNotValid = "";

  mounted() {
    this.cabinetQuotas = this.homeViewModel.currentSession.quotas.map(elem => {
      return {
        ...elem,
        grades: elem.grades.map(item => {
          return {
            ...item,
            quantity: item.quantity.toString()
          }
        })
      }
    })
  }

  toDefaultDate() {
    return dayjs(this.homeViewModel.currentSession.endedAt).format('YYYY-MM-DD');
  }

  onSessionClose() {
    this.currentIndex = 1;
    return this.onClose();
  }

  async onConfirm() {
    if (this.currentIndex === 1) {
      if (this.sessionName === "" && this.homeViewModel.currentSession.name) {
        this.sessionName = this.homeViewModel.currentSession.name
      }
      if (this.endedAt === "" && this.homeViewModel.currentSession.endedAt) {
        this.endedAt = dayjs(this.homeViewModel.currentSession.endedAt).format('YYYY-MM-DD')
      }
      this.$v.$touch();
    }
    const isValid = this.$v.$invalid;
    if (!isValid) {
      if (this.homeViewModel.currentSession.decoration === DecorationType.MERITE_MARITIME) {
        console.log('merite')
        await this.sessionViewModel.updateSession({
          id: this.homeViewModel.currentSession.id,
          endedAt: new Date(this.endedAt),
          startedAt: new Date(this.homeViewModel.currentSession.startedAt),
          name: this.sessionName,
          quotas: this.homeViewModel.currentSession.quotas.map(elem => {
            return {
              contingent: elem.contingent,
              grades: elem.grades.map(item => {
                return {
                  quantity: item.quantity,
                  grade: item.grade,
                }
              })
            }
          }),
          closedAt: null,
          decoration: this.homeViewModel.currentSession.decoration,
        })
        return this.onSessionClose();
      }


      await this.sessionViewModel.updateSession({
        id: this.homeViewModel.currentSession.id,
        endedAt: new Date(this.endedAt),
        startedAt: new Date(this.homeViewModel.currentSession.startedAt),
        name: this.sessionName,
        quotas: this.cabinetQuotas,
        closedAt: null,
        decoration: this.homeViewModel.currentSession.decoration,
      })

      return this.onSessionClose();
    }
  }

}
</script>
<style>
.text-red {
  color: red;
}
</style>

```

</details>


---

### 📄 `src/modules/sessions/screens/SessionList.vue` [10.696 octets]
<a id="src-modules-sessions-screens-SessionList-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-sessions-screens-SessionList-vue)

> **Chemin relatif** : `src/modules/sessions/screens/SessionList.vue`  
> **Taille** : 10.696 octets  
> **Lignes** : 375  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (375 lignes) - Cliquer pour déplier</summary>

````text
<template>
  <div class="recommandants">
    <div style="display: flex; justify-content: space-between; align-items: center;" class="mt-7">
      <div class="flex align-center">
        <img alt="" :src="documentImg" />
        <h1 class="pl-5">
          Promotions
        </h1>
      </div>
      <div style="display: flex;align-items: center;">
        <vue-json-to-csv
          :json-data="sessionViewModel.exportAIRS"
          :separator-excel="true"
          csv-title="airs"
          ref="global"
          class="mr-3"
          style="display: none;"
        >
        </vue-json-to-csv>
        <v-btn v-if="isAdmin()" outlined color="primary" class="mr-3" @click="downloadExport()">
          <v-icon color="primary">
            {{mdiDownload}}
          </v-icon>
          Export AIRS
        </v-btn>

        <v-btn v-if="isChancellerie()" outlined @click="openCabinetPopup" color="primary" class="mr-3">
            Créer cabinet
          </v-btn>
        <v-btn outlined color="primary" @click="onCreateNewSession">
          Ajouter une promotion
        </v-btn>
      </div>
    </div>
    <div style="display: flex; justify-content: center;" class="mt-10 mb-10">
      <div class="mr-5">
        <date-box
          :count="getStats().totalPresentation"
          title="Total de présentation"
        />
      </div>
      <div class="mr-5">
        <date-box
          :count="getStats().totalDecisionTaken"
          title="Présentation traitées"
        />
      </div>
      <div>
        <date-box
          :count="getStats().totalDecisionNotDone"
          title="Présentation non traitées"
        />
      </div>
    </div>
    <div>
      <v-data-table
        :headers="headers"
        :items="toSessionListItem()"
        :items-per-page="10"
        calculate-widths
        class="elevation-0 mt-8"
        locale="fr-FR"
        item-key="id"
      >
        <template v-slot:item.controls="props">
          <v-btn icon outlined color="primary" @click="goToDetail(props.item.id)" title="Consulter la promotion" aria-label="Aller à la page des détails de la promotion">
            <v-icon color="primary">
              {{eyeIcon}}
            </v-icon>
          </v-btn>
        </template>
      </v-data-table>
    </div>
    <session-dialog
      :open="sessionDialogOpen"
      :on-close="onSessionDialogClose"
    />
    <alert
      :open="loadingExport"
      :on-close="closePopup"
      :action="false"
    >
      <template v-slot:title>
        <p>Veuillez patienter ...</p>
      </template>
    </alert>
    <alert
      :open="cabinetPopupOpen"
      :on-close="closeCabinetPopup"
      :with-confirmation="true"
      :on-confirm="createCabinet"
    >
      <template v-slot:title>
        <h2 class="pb-5">
          Créer cabinet
        </h2>
      </template>
      <template v-slot:message>
        <text-field
          label="Nom de cabinet"
          :mandatory="true"
          :required="true"
          :default-value="cabinet"
          v-model="cabinet"
        />
        <p>Liste des cabinets</p>
        <div>
          <div class="cabinet-item" v-for="cabinet in homeViewModel.cabinets" v-bind:key="cabinet.id">
            <p style="margin-bottom: 0;" class="mr-4">{{cabinet.name}}</p>
            <v-btn icon style="border: none; cursor: pointer;" v-if="isChancellerie()" class="delete" outlined color="primary" @click="deleteCabinet(cabinet.id)" title="Supprimer le cabinet" aria-label="Supprimer le cabinet">
              <v-icon style="color: #e1000f">
                {{ deleteIcon }}
              </v-icon>
            </v-btn>
          </div>
        </div>
      </template>
    </alert>
  </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import DocumentImg from "@/assets/document.png";
import {mdiEyeCircleOutline, mdiInformation, mdiDownload, mdiTrashCanOutline} from "@mdi/js";
import TextField from "@/components/TextField.vue";
import RecommandantManagementForm from "@/modules/recommandants/components/RecommandantManagementForm.vue";
import Alert from "@/components/Alert.vue";
import SessionDialog from "@/modules/sessions/components/SessionDialog.vue";
import {lazyInject} from "@pasta/box";
import {HomeViewModel} from "@/modules/home/viewModels/HomeViewModel";
import dayjs from "dayjs";
import {toDecorationType} from "@/core/valueObjects/toDecorationType";
import {SessionViewModel} from "@/modules/sessions/viewModels/SessionViewModel";
import {AuthModule} from "@pasta/front-auth";
import DateBox from "@/modules/onBoarding/components/DateBox.vue";
// eslint-disable-next-line @typescript-eslint/ban-ts-comment
//@ts-ignore
import VueJsonToCsv from "vue-json-to-csv";
import {AuthRole} from "@/core/types/identity/AuthRole";


@Component({
  components: {DateBox, SessionDialog, Alert, RecommandantManagementForm, TextField, VueJsonToCsv}
})
export default class SessionList extends Vue {

  documentImg = DocumentImg;
  eyeIcon = mdiEyeCircleOutline;
  mdiDownload = mdiDownload
  info = mdiInformation;
  sessionDialogOpen = false;

  @lazyInject(HomeViewModel)
  declare homeViewModel: HomeViewModel;


  @lazyInject(SessionViewModel)
  declare sessionViewModel: SessionViewModel;

  @lazyInject(AuthModule)
  declare authModule: AuthModule;

  cabinetPopupOpen = false;
  cabinet = "";
  deleteIcon = mdiTrashCanOutline;

  loadingExport = false;


  headers = [
    {
      text: 'Nom',
      align: 'start',
      value: 'name',
      groupable: false,
      width: '15%'
    },
    {
      text: 'Décoration',
      align: 'start',
      value: 'decorationType',
      groupable: false,
      width: '15%'
    },
    {
      text: 'Date de clôture',
      align: 'start',
      value: 'closedAt',
      groupable: false,
      width: '15%'
    },
    {
      text: 'Date de décrêt',
      align: 'start',
      value: 'decreeDate',
      groupable: false,
      width: '15%'
    },
    {
      text: 'Nbre présentations',
      align: 'start',
      value: 'totalPresentation',
      groupable: false,
      width: '10%'
    },
    {
      text: 'Présentation traitées',
      align: 'start',
      value: 'decisionTaken',
      groupable: false,
      width: '10%'
    },
    {
      text: 'Présentation non traitées',
      align: 'start',
      value: 'decisionNotDone',
      groupable: false,
      width: '10%'
    },
    { text: "", value: "controls", sortable: false, align: 'end', groupable: false, width: '10%' }
  ];

  search = "";

  async onCreateNewSession() {
    this.sessionDialogOpen = true;
  }

  onSessionDialogClose() {
    this.sessionDialogOpen = false;
  }


  closePopup() {
    this.loadingExport = false;
  }

  getStats() {
    // eslint-disable-next-line @typescript-eslint/ban-ts-comment
    //@ts-ignore
    const totalPresentation = this.homeViewModel.sessions.reduce((a, b) => a + b.totalPresentation, 0) ?? 0;
    // eslint-disable-next-line @typescript-eslint/ban-ts-comment
    //@ts-ignore
    const totalDecisionTaken = this.homeViewModel.sessions.reduce((a, b) => a + b.decisionTaken, 0) ?? 0;
    // eslint-disable-next-line @typescript-eslint/ban-ts-comment
    //@ts-ignore
    const totalDecisionNotDone = this.homeViewModel.sessions.reduce((a, b) => a + b.decisionNotDone, 0) ?? 0;
    return {
      totalPresentation: totalPresentation.toString(),
      totalDecisionTaken: totalDecisionTaken.toString(),
      totalDecisionNotDone: totalDecisionNotDone.toString(),
    }
  }

  async downloadExport() {
    this.loadingExport = true;
    await this.sessionViewModel.exportForAIRS()
    this.$nextTick(() => {
      const csvExport: any = this.$refs["global"];
      if (csvExport) {
        csvExport.handleClick();
      }
    });
    this.loadingExport = false;
  }


  async goToDetail(id: string) {
    const session = this.homeViewModel.sessions.find(item => item.id === id);
    if (session) {
      const path = `/promotions/${session.name.toLowerCase().replaceAll("/", "-").split(" ").join("-")}`;
      if (this.homeViewModel.currentSession && this.homeViewModel.currentSession.name === session.name && window.location.pathname === path) {
        return;
      }
      await this.homeViewModel.initCurrentSession(session);
      this.sessionViewModel.setSelectedCabinet("");
      await this.sessionViewModel.getSessionFolder();
      window.location.href = path
      return;
    }
    console.error("no session found")
  }

  toSessionListItem() {
    return this.homeViewModel.sessions.map(elem => {
      return {
        id: elem.id,
        name: elem.name,
        decorationType: toDecorationType(elem.decoration),
        closedAt: elem.closedAt ? dayjs(elem.closedAt).format("DD/MM/YYYY") : null,
        decreeDate: elem.decreeDate ? dayjs(elem.decreeDate).format("DD/MM/YYYY") : null,
        totalPresentation: elem.totalPresentation,
        decisionTaken: elem.decisionTaken,
        decisionNotDone: elem.decisionNotDone,
      }
    });
  }

  openCabinetPopup() {
    this.cabinetPopupOpen = true;
  }

  isChancellerie() {
    const currentUser = this.authModule.currentUser;
    return currentUser?.highestRoleLevel && currentUser?.highestRoleLevel >= AuthRole.CHANCELLERY;
  }

  isAdmin() {
    const currentUser = this.authModule.currentUser;
    return currentUser?.highestRoleLevel && currentUser?.highestRoleLevel >= 1000;
  }

  closeCabinetPopup() {
    this.cabinetPopupOpen = false;
  }

  async createCabinet() {
    if (this.cabinet.trim() === "") {
      return;
    }
    await this.homeViewModel.createCabinet(this.cabinet);
    this.cabinet = "";
    this.cabinetPopupOpen = false;
    return;
  }

  async deleteCabinet(id: string) {
    await this.homeViewModel.deleteCabinet(id);
  }

}
</script>

<style lang="scss">
.recommandants {
  text-align: left;
  padding: 0 8rem;
  .v-data-table-header {
    span {
      color: black;
      font-size: 14px;
    }
  }
  .theme--light.v-data-table > .v-data-table__wrapper > table > thead > tr:last-child > th {
    border-bottom: medium solid #3A3A3A;
  }
  .v-data-footer__select {
    opacity: 1!important;
  }
  .theme--light.v-data-table > .v-data-table__wrapper > table > tbody > tr:hover:not(.v-data-table__expanded__content):not(.v-data-table__empty-wrapper) {
    background: transparent;
  }
  .header-item {
    color: black;
    margin-bottom: 0;
    font-size: 14px;
  }
  .select-btn {
    width: 100%;
    height: 45px!important;
    display: flex;
    justify-content: space-between;
    padding: 0px 15px!important;
    border: none;
    border-bottom: 2px solid black;
    background: #EEEEEE;
    span {
      color: black
    }
  }
}
</style>

````

</details>


---

### 📄 `src/modules/sessions/screens/SessionScreen.vue` [3.102 octets]
<a id="src-modules-sessions-screens-SessionScreen-vue"></a> [↩ Retour à l'arborescence](#tree-src-modules-sessions-screens-SessionScreen-vue)

> **Chemin relatif** : `src/modules/sessions/screens/SessionScreen.vue`  
> **Taille** : 3.102 octets  
> **Lignes** : 145  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (145 lignes) - Cliquer pour déplier</summary>

```text
<template>
 <div>
   <div>
     <m-m-promotion v-if="homeViewModel.currentSession.decoration === 'merite_maritime'"/>
   </div>
   <div>
     <l-h-o-n-m-promotion v-if="homeViewModel.currentSession.decoration !== 'merite_maritime'"/>
   </div>
 </div>
</template>

<script lang="ts">
import Vue from "vue";
import Component from "vue-class-component";
import MMPromotion from "@/modules/sessions/components/MMPromotion.vue";
import {lazyInject} from "@pasta/box";
import {HomeViewModel} from "@/modules/home/viewModels/HomeViewModel";
import LHONMPromotion from "@/modules/sessions/components/LHONMPromotion.vue";

@Component({
  components: {
    LHONMPromotion,
    MMPromotion,
  },
})
export default class SessionScreen extends Vue {
  @lazyInject(HomeViewModel)
  declare homeViewModel: HomeViewModel;



}
</script>

<style lang="scss">
.session-screen {
  text-align: left;
  padding: 0 8rem;
  .lh-quota {
    margin-top: 24px;
    .bold {
      font-weight: 500;
    }
    .result {
      display: flex;
      align-items: center;
      .v-progress-linear {
        width: 100px;
        height: 20px !important;
        border-radius: 5px;
        .v-progress-linear__background {
          background-color: #f6f6f6 !important;
          opacity: 1 !important;
        }
        .v-progress-linear__determinate {
          background-color: #27a658 !important;
        }
      }
    }
  }
  .quota {
    margin-top: 24px;
    border: 1px solid #dddddd;
    padding: 24px;
    .bold {
      font-weight: 500;
    }
    .result {
      display: flex;
      align-items: center;
      .v-progress-linear {
        width: 100px;
        height: 20px !important;
        border-radius: 5px;
        .v-progress-linear__background {
          background-color: #f6f6f6 !important;
          opacity: 1 !important;
        }
        .v-progress-linear__determinate {
          background-color: #27a658 !important;
        }
      }
    }
  }
  h1 {
    font-weight: 500;
    color: #000000;
    font-size: 40px;
  }
  h4 {
    font-weight: 500;
  }
  .title {
    display: flex;
    align-items: center;
    h2 {
      font-weight: 500;
      font-size: 30px;
      color: #000000;
    }
  }
  .v-data-table-header {
    span {
      color: black;
      font-size: 14px;
    }
  }
  .theme--light.v-data-table > .v-data-table__wrapper > table > thead > tr:last-child > th {
    border-bottom: medium solid #3a3a3a;
  }
  .theme--light.v-data-table
  > .v-data-table__wrapper
  > table
  > tbody
  > tr:hover:not(.v-data-table__expanded__content):not(.v-data-table__empty-wrapper) {
    background: transparent;
  }
  .delete {
    border-color: #e1000f;
    margin-right: 10px;
    span {
      color: #e1000f;
    }
  }
  .gouv-design-system {
    border-left: 1px solid #dddddd;
    border-right: 1px solid #dddddd;
    background-color: #fff !important;
  }
  .v-tabs-slider-wrapper {
    top: 0;
  }
  .tab-inactive {
    background-color: #e3e3fd;
    margin-left: 10px;
    margin-right: 10px;
  }
  .header-item {
    color: black;
    margin-bottom: 0;
    font-size: 14px;
  }
}
</style>

```

</details>


---

### 📄 `src/styles/base.scss` [8.588 octets]
<a id="src-styles-base-scss"></a> [↩ Retour à l'arborescence](#tree-src-styles-base-scss)

> **Chemin relatif** : `src/styles/base.scss`  
> **Taille** : 8.588 octets  
> **Lignes** : 346  
> **Type** : scss

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (346 lignes) - Cliquer pour déplier</summary>

```scss
@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-ExtraBold.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-ExtraBold.woff') format('woff');
  font-weight: bold;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-Bold.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-Bold.woff') format('woff');
  font-weight: bold;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-ExtraBoldItalic.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-ExtraBoldItalic.woff') format('woff');
  font-weight: bold;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-ExtraBoldItalic.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-ExtraBoldItalic.woff') format('woff');
  font-weight: bold;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-BoldItalic.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-BoldItalic.woff') format('woff');
  font-weight: bold;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-Bold.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-Bold.woff') format('woff');
  font-weight: bold;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-BoldItalic.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-BoldItalic.woff') format('woff');
  font-weight: bold;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-Medium.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-Medium.woff') format('woff');
  font-weight: 500;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-MediumItalic.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-MediumItalic.woff') format('woff');
  font-weight: 500;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-LightItalic.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-LightItalic.woff') format('woff');
  font-weight: 300;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-LightItalic.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-LightItalic.woff') format('woff');
  font-weight: 300;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-ExtraBold.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-ExtraBold.woff') format('woff');
  font-weight: bold;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-MediumItalic.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-MediumItalic.woff') format('woff');
  font-weight: 500;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-Medium.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-Medium.woff') format('woff');
  font-weight: 500;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-Regular.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-Regular.woff') format('woff');
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-ThinItalic.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-ThinItalic.woff') format('woff');
  font-weight: 100;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-Thin.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-Thin.woff') format('woff');
  font-weight: 100;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-RegularItalic.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-RegularItalic.woff') format('woff');
  font-weight: normal;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-RegularItalic.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-RegularItalic.woff') format('woff');
  font-weight: normal;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-Light.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-Light.woff') format('woff');
  font-weight: 300;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-ThinItalic.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-ThinItalic.woff') format('woff');
  font-weight: 100;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-Regular.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-Regular.woff') format('woff');
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-Light.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-Light.woff') format('woff');
  font-weight: 300;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Marianne';
  src: url('../assets/fonts/marianne/Marianne-Thin.woff2') format('woff2'),
  url('../assets/fonts/marianne/Marianne-Thin.woff') format('woff');
  font-weight: 100;
  font-style: normal;
  font-display: swap;
}

h1, h2, h3, h4, h5, h6, p, span, div {
  font-family: 'Marianne', sans-serif;
}

body {
  background: #f5f5f5;
}

#app {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-align: center;
  color: #2c3e50;
}

.v-menu__content {
  text-align: left;
}

.main-color {
  background-color: #1f2532 !important; //important added to override vuetify's .theme--light.v-sheet
}

.align-end {
  display: flex;
  justify-content: flex-end;
}

.background {
  padding: 0!important;
  background-color: #fff;
}

.up:hover {
  position: relative;
  top: -torem(1px);
}

.header-table-column-left {
  display: flex;
}

.header-table-column-right {
  display: flex;
  justify-content: flex-end;
}

.v-application .v-alert.warning {
  color: black;

  .v-icon {
    color: black;
  }
}

.absolute {
  position: absolute;
}

.card-title {
  .v-chip__content {
    font-size: torem(18px);
    user-select: none;
  }
}

main {
  height: fit-content!important;
  background-color: #fff!important;
}

.theme--light.v-tabs > .v-tabs-bar .v-tab:not(.v-tab--active), .theme--light.v-tabs > .v-tabs-bar .v-tab:not(.v-tab--active) > .v-icon, .theme--light.v-tabs > .v-tabs-bar .v-tab:not(.v-tab--active) > .v-btn, .theme--light.v-tabs > .v-tabs-bar .v-tab--disabled {
  color: #161616!important;
}

button, a {
  text-transform: initial!important;
  font-family: 'Marianne', sans-serif!important;
  border-radius: 0!important;
  letter-spacing: 1px!important;
}

.v-btn:not(.v-btn--outlined).secondary {
  color: black!important;
}

.v-btn:not(.v-btn--round).v-size--default {
  padding: 4px 8px!important;
}

.theme--light.v-btn:focus::before {
  opacity: 0.5!important;
}

.theme--light.v-tabs .v-tab:focus::before {
  opacity: 0.5!important;
}

.theme--light.v-radio--is-disabled label {
  color: rgba(0, 0, 0, 0.6)!important;
}

.theme--light.v-data-table .v-data-table__empty-wrapper {
  color: rgba(0, 0, 0, 1)!important;
}

.priority {
  background: #B8FEC9;
  display: inline;
  color: #18753C!important;
  font-weight: 500;
  border-radius: 30px;
  padding: 5px 10px;
}

.priority-0 {
  background: #B8FEC9;
  color: #18753C!important;
}

.priority-1 {
  background: #FEECC2;
  color: #735F39!important;
}

.priority-2 {
  background: #FFE8E5;
  color: #B34000!important;
}

```

</details>


---

### 📄 `src/styles/functions.scss` [60 octets]
<a id="src-styles-functions-scss"></a> [↩ Retour à l'arborescence](#tree-src-styles-functions-scss)

> **Chemin relatif** : `src/styles/functions.scss`  
> **Taille** : 60 octets  
> **Lignes** : 4  
> **Type** : scss

```scss
@function torem($size) {
  @return ($size / 16px) * 1rem;
}

```


---

### 📄 `src/styles/variables.module.scss` [1.813 octets]
<a id="src-styles-variables-module-scss"></a> [↩ Retour à l'arborescence](#tree-src-styles-variables-module-scss)

> **Chemin relatif** : `src/styles/variables.module.scss`  
> **Taille** : 1.813 octets  
> **Lignes** : 53  
> **Type** : scss

```scss
@import "./functions.scss";
@import "./variables.scss";

:export {
  // background
  backgroundDefaultLightColor: $light-background-default;
  backgroundAltGreyLightColor: $light-background-alt-grey;
  backgroundAltBlueLightColor: $light-background-alt-blue;
  backgroundContrastGreyLightColor: $light-background-contrast-grey;
  backgroundContrastBlueLightColor: $light-background-contrast-blue;

  backgroundDefaultDarkColor: $dark-background-default;
  backgroundAltGreyDarkColor: $dark-background-alt-grey;
  backgroundAltBlueDarkColor: $dark-background-alt-blue;
  backgroundContrastGreyDarkColor: $dark-background-contrast-grey;
  backgroundContrastBlueDarkColor: $dark-background-contrast-blue;

  // primary
  primaryDefaultColor: $primary-default;
  primaryHighContrastColor: $primary-high-contrast-blue;
  primaryLowContrastColor: $primary-low-contrast-blue;

  // state
  stateDisabledLightColor: $light-disabled;
  stateDisabledDarkColor: $dark-disabled;

  stateSuccessLightColor: $light-success;
  stateSuccessDarkColor: $dark-success;
  stateSuccessContrastColor: $success-contrast;

  stateErrorLightColor: $light-error;
  stateErrorDarkColor: $dark-error;
  stateErrorContrastColor: $error-contrast;

  stateWarningLightColor: $light-warning;
  stateWarningDarkColor: $dark-warning;
  stateWarningContrastColor: $warning-contrast;

  stateInfoLightColor: $light-info;
  stateInfoDarkColor: $dark-info;

  // text
  textGreyLightColor: $light-text-grey;
  textGreyContrastLightColor: $light-text-contrast-grey;
  textBlueLightColor: $light-text-blue;
  textBlueContrastLightColor: $light-text-contrast-blue;

  textGreyDarkColor: $dark-text-grey;
  textGreyContrastDarkColor: $dark-text-contrast-grey;
  textBlueDarkColor: $dark-text-blue;
  textBlueContrastDarkColor: $dark-text-contrast-blue;
}

```


---

### 📄 `src/styles/variables.scss` [2.422 octets]
<a id="src-styles-variables-scss"></a> [↩ Retour à l'arborescence](#tree-src-styles-variables-scss)

> **Chemin relatif** : `src/styles/variables.scss`  
> **Taille** : 2.422 octets  
> **Lignes** : 95  
> **Type** : scss

```scss
@import "./functions.scss";

// background
$light-background-default: #ffffff;
$light-background-alt-grey: #f6f6f6;
$light-background-alt-blue: #f5f5fe;
$light-background-contrast-grey: #eeeeee;
$light-background-contrast-blue: #e8edff;

$dark-background-default: #161616;
$dark-background-alt-grey: #1e1e1e;
$dark-background-alt-blue: #1b1b35;
$dark-background-contrast-grey: #242424;
$dark-background-contrast-blue: #272747;

// primary
$primary-default: #20209f;
$primary-high-contrast-blue: #000091;
$primary-low-contrast-blue: #6a6af4;

// Blue France light theme

$blue-france-main-525: #6a6af4;
$blue-france-main-525_hover: #9898f8;
$blue-france-main-525_active: #aeaef9;
$blue-france-sun-113: #000091;
$blue-france-sun-113_hover: #1212ff;
$blue-france-sun-113_active: #2323ff;
$blue-france-975: #f5f5fe;
$blue-france-975_hover: #dcdcfc;
$blue-france-975_active: #cbcbfa;
$blue-france-950: #ececfe;
$blue-france-950_hover: #cecefc;
$blue-france-950_active: #bbbbfc;
$blue-france-925: #e3e3fd;
$blue-france-925_hover: #c1c1fb;
$blue-france-925_active: #adadf9;
$blue-france-850: #cacafb;
$blue-france-850_hover: #a1a1f8;
$blue-france-850_active: #8b8bf6;

// Blue France dark theme

$blue-france-main-525: #6a6af4;
$blue-france-main-525_hover: #9898f8;
$blue-france-main-525_active: #aeaef9;
$blue-france-625: #8585f6;
$blue-france-625_hover: #b1b1f9;
$blue-france-625_active: #c6c6fb;
$blue-france-200: #313178;
$blue-france-200_hover: #5757ad;
$blue-france-200_active: #6c6cbb;
$blue-france-125: #272747;
$blue-france-125_hover: #4a4a7d;
$blue-france-125_active: #5e5e90;
$blue-france-100: #21213f;
$blue-france-100_hover: #424275;
$blue-france-100_active: #56568c;
$blue-france-75: #1b1b35;
$blue-france-75_hover: #3a3a68;
$blue-france-75_active: #4d4d83;

// state
$light-disabled: #e5e5e5;
$dark-disabled: #2a2a2a;

$light-success: #18753c;
$dark-success: #27a658;
$success-contrast: #19271d;

$light-error: #ce0500;
$dark-error: #ff5655;
$error-contrast: #391c1c;

$light-warning: #b34000;
$dark-warning: #fc5d00;
$warning-contrast: #361e19;

$light-info: #0063cb;
$dark-info: #518fff;

// text
$light-text-grey: #161616;
$light-text-contrast-grey: #ffffff;
$light-text-blue: #000091;
$light-text-contrast-blue: #f5f5fe;

$dark-text-grey: #ffffff;
$dark-text-contrast-grey: #161616;
$dark-text-blue: #f5f5fe;
$dark-text-contrast-blue: #000091;

$tab-font-size: torem(12px);
$card-title-font-size: torem(16px);

```


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

`````

</details>


---

### 📄 `si/hubrh.wiki.md` [13.167 octets]
<a id="si-hubrh-wiki-md"></a> [↩ Retour à l'arborescence](#tree-si-hubrh-wiki-md)

> **Chemin relatif** : `si/hubrh.wiki.md`  
> **Taille** : 13.167 octets  
> **Lignes** : 430  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (430 lignes) - Cliquer pour déplier</summary>

`````markdown
﻿# Projet : hubrh.wiki

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\hubrh.wiki`

**Fichiers** : 3 fichiers non-binaires

## 📁 Arborescence des fichiers

├── **Base-de-connaissances/**
│   └── <a id="tree-Base-de-connaissances-Page-de-Maintenance-md"></a>[Page-de-Maintenance.md](#Base-de-connaissances-Page-de-Maintenance-md) *(1.099 octets)*
├── <a id="tree-Documentation-de-déploiement-md"></a>[Documentation-de-déploiement.md](#Documentation-de-déploiement-md) *(6.619 octets)*
└── <a id="tree-Home-md"></a>[Home.md](#Home-md) *(180 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `Base-de-connaissances/Page-de-Maintenance.md` [1.099 octets]
<a id="Base-de-connaissances-Page-de-Maintenance-md"></a> [↩ Retour à l'arborescence](#tree-Base-de-connaissances-Page-de-Maintenance-md)

> **Chemin relatif** : `Base-de-connaissances/Page-de-Maintenance.md`  
> **Taille** : 1.099 octets  
> **Lignes** : 58  
> **Type** : markdown

````markdown
1. **Activation de la page de Maintenance :**

```
sudo mv /var/www/html/maintenance.html /var/www/html/under_maintenance.html

```

_Activation des accès restreint :_

Dé-commenter les lignes du fichier présent sous  "/etc/nginx/sites-enabled"

```
 #auth_basic "Accès restreint pendant la maintenance de HubRH";
 #auth_basic_user_file /etc/nginx/.htpasswd;
```

Et commenter les lignes :

```
 if (-f /var/www/html/under_maintenance.html){
     return 503;
     }
```

_Pour la prise en compte faire :_

```
sudo service nginx restart
```

2. **Désactivation de la page de maintenance :** 

```
sudo mv /var/www/html/under_maintenance.html /var/www/html/maintenance.html
```

_Désactivation des accès restreint :_

Commenter les lignes du fichier présent sous  "/etc/nginx/sites-enabled"

```
 auth_basic "Accès restreint pendant la maintenance de HubRH";
 auth_basic_user_file /etc/nginx/.htpasswd;
```

Et dé-commenter les lignes :

```
 #if (-f /var/www/html/under_maintenance.html){
 #    return 503;
 #    }
```

_Pour la prise en compte faire :_

```
sudo service nginx restart
```
````


---

### 📄 `Documentation-de-déploiement.md` [6.619 octets]
<a id="Documentation-de-déploiement-md"></a> [↩ Retour à l'arborescence](#tree-Documentation-de-déploiement-md)

> **Chemin relatif** : `Documentation-de-déploiement.md`  
> **Taille** : 6.619 octets  
> **Lignes** : 164  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (164 lignes) - Cliquer pour déplier</summary>

````markdown
Sur la plateforme de recette Next, HUBRH est installé sous /var/www/hubrh. Pour reproduire un environnement similaire, cette documentation partira du principe qu'HUBRH devra être également positionné sous /var/www/hubrh en pre-production et en production.

La documentation part également du principe que les machines et systèmes d'exploitations de pre-production et production sont similaires à la plateforme Next, et qu'elles ont accès à Internet.

Si un proxy est nécessaire pour que Docker accède à Internet, il convient de suivre la procédure suivante:
https://movidius.github.io/ncsdk/docker_proxy.html

.

## **1) Récupération des sources**

Cette section nécessite Git, voir: https://docs.gitlab.com/ee/topics/git/how_to_install_git/

Il suffit de cloner ce répertoire pour récupérer les sources de l'application HUBRH

```
cd /var/www
git clone https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/produits/rh/hubrh.git
```

.

## **2) Récupération des données**

Cette section part du principe que la BDD postgres de l'application HUBRH de pre-production / production est nommée "redmine_hubrh". Pour effectuer une sauvegarde des données, et par la suite intégrer ces données sur la nouvelle version de HUBRH, il faut effectuer un export de la base de données.

`pg_dump --inserts --on-conflict-do-nothing redmine_hubrh`

Le fichier obtenu sert à la fois de backup et de moyen de transférer les données sur la nouvelle application. Ce dump sera à l'avenir référé par le nom "soclerh.sql". C'est le nom qui est indiqué dans le script d'importation de données. Renommez le "soclerh.sql" et gardez le à disposition pour la suite du déploiement.

.

## **3) Installation de Redmine**

Cette section nécessite Docker, voir: https://docs.docker.com/engine/install/debian/

Les dépendances et l'application Redmine vierge doivent être automatiquement installées par Docker avec la simple commande:

```
cd /var/www/hubrh
cp ./.env-example ./.env
docker compose up -d
```

Pour valider cette étape, il est possible d'afficher le portail de connexion de Redmine (vierge) en accédant via un navigateur à l'URL de la plateforme. Par exemple, pour la plateforme Next, https://hub.next.rh.e2.rie.gouv.fr/

.

## **4) Intégration des données**

Copiez le dump "soclerh.sql" sous "/var/www/hubrh/data/postgres/dump/soclerh.sql".

Pendant que Docker est up (docker compose up -d), il suffit d'exécuter le script d'importation de données.

```
cd /var/www/hubrh
./db_restore.sh
```

_/!\\ Ce script peut importer partiellement les données et parfois renvoyer des erreurs. Cela peut être dû à un ordre des commandes d'insertions qui peut être incorrect. Pour résoudre les problèmes, lorsque le nombre d'erreurs d'importation est supérieur à 0, réexécuter le script jusqu'à ce que le nombre d'erreur stagne._

Ce script s'occupe également des dernières configurations des modules, sessions et dépendances propres à HUBRH.\

Il est également nécessaire d'executer sur l'environnement docker les deux commande suivantes pour intégrer une évolution des portefeuilles:
```
rails generate migration AddPriorityToWallets priority:integer
rails db:migrate
```

Une fois ces étapes terminées, HUBRH devrait être accessible et opérationnel.

.

## 5) Commandes utiles

Il est possible de forcer la reconstructiondu conteneur hubrh à tout moment avec la commande:
<span dir="">`docker compose up --build`</span>

Il est possible à tout moment d'accéder au contenu du Docker pour consulter les sources Redmine (lorsque le docker est up avec l'option -d) avec la commande suivante:
<span dir="">`docker exec -it hubrh /bin/bash`</span>

**Voici quelques commandes utiles pouvant être executées à l'interieur de ce conteneur:**

Vérification du bon déroulement de l'installation des gemmes et dépendances redmine:
<span dir="">`bundle install`</span>

Vérification du lancement du serveur:
<span dir="">`bundle exec puma`</span>

.

## 6) Résolution de problèmes

Correction de l'erreur "#<Errno::EACCES: Permission denied @ rb_sysopen - /usr/src/redmine/certs/hubrh-rec.p12>":
```
docker compose up -d
docker exec -it -u root hubrh-app /bin/bash
chown redmine:redmine -R certs
chmod 777 -R certs
```

Correction de l'erreur "The container name "/xxx_hubrh" is already in use by container "xxx". You have to remove (or rename) that container to be able to reuse that name.":
```
docker rm "/xxx_hubrh"
```

L'utilitaire syslog-ng peut être utile pour débuguer les différents processus au sein du conteneur:
```
apt-get install syslog-ng
service syslog-ng start
```

Il est possible d'afficher les conteneurs actifs avec la commande:
```
docker ps -a
```

En cas d'espace de stockage manquant, il est possible de forcer docker à libérer de l'espace grâce à la commande:
```
docker system prune -a
```

En cas d'erreur lors de la lecture du ContainerConfig, il peut être utile de simplement démonter entièrement le volume avant de le relancer:
```
docker-compose down --volumes --remove-orphans
docker-compose up --build -d
```

.

## 7) Cron & Logs

Les cronjobs executés par HUBRH se situent dans le dossier git cronjobs.
Comme indiqué dans le crontab "cronjob/update_matricules", le cronjob updateMatriculesAxes.sh est executé tous les jours à minuit.

À noter que le crontab update_matricule doit disposer des droits 0600 pour que cron l'execute correctement. Ces droits sont correctement configurés sur git et sont automatiquement copiés par Docker dans le conteneur.

Il est néanmoins nécessaire de lancer cron dans le conteneur. Pour se faire, après avoir lancé le conteneur, il faut executer (toujours sous /var/www/hubrh):
```
docker exec -it -u root hubrh /bin/bash
cron -f &
exit
```

Quelques informations complémentaires:

- Pour éxecuter ce job manuellement (Next): https://hub.next.rh.e2.rie.gouv.fr/cron/matricules?token=token_complique_pour_cron_pour_acceder_a_la_route
- Pour accéder aux logs de ce job (Next): https://hub.next.rh.e2.rie.gouv.fr/cron/logs

.

## 8) WS & LDAP

Redmine a besoin des accès aux serveurs LDAP et RenoiRH dont les URL respectives sont:
- ldap.m2.e2.rie.gouv.fr:389
- https://zone-echange.rec.rh.e2.rie.gouv.fr/

Le WS est configuré via la page administration de l'application HUBRH.

Le LDAP est configuré en variable d'environnement dans le fichier .env:
```
LDAP_HOST=ldap.m2.e2.rie.gouv.fr
LDAP_PORT=389
```
````

</details>


---

### 📄 `Home.md` [180 octets]
<a id="Home-md"></a> [↩ Retour à l'arborescence](#tree-Home-md)

> **Chemin relatif** : `Home.md`  
> **Taille** : 180 octets  
> **Lignes** : 3  
> **Type** : markdown

```markdown
* Descriptif :
    * Suivi des demandes de gestion transmises par les services employeurs au service gestion de la DRH
    * https://wikisi.e2.rie.gouv.fr/wikisi/application/353/
```


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

`````

</details>


---

### 📄 `si/litij-back.md` [158.456 octets]
<a id="si-litij-back-md"></a> [↩ Retour à l'arborescence](#tree-si-litij-back-md)

> **Chemin relatif** : `si/litij-back.md`  
> **Taille** : 158.456 octets  
> **Lignes** : 4576  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (4576 lignes) - Cliquer pour déplier</summary>

`````markdown
﻿# Projet : litij-back

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\litij-back`

**Fichiers** : 35 fichiers non-binaires

## 📁 Arborescence des fichiers

├── **container/**
│   ├── <a id="tree-container-docker-compose-yml"></a>[docker-compose.yml](#container-docker-compose-yml) *(421 octets)*
│   └── <a id="tree-container-init-sql"></a>[init.sql](#container-init-sql) *(133 octets)*
├── **docs/**
│   ├── **ADR/**
│   │   ├── <a id="tree-docs-ADR-000-empty-template-md"></a>[000-empty-template.md](#docs-ADR-000-empty-template-md) *(417 octets)*
│   │   ├── <a id="tree-docs-ADR-0001-ajout-gestionnaire-principal-dossier-md"></a>[0001-ajout-gestionnaire-principal-dossier.md](#docs-ADR-0001-ajout-gestionnaire-principal-dossier-md) *(3.217 octets)*
│   │   ├── <a id="tree-docs-ADR-002-juridiction-obligation-lors-de-l-ajout-modification-d-une-instance-md"></a>[002-juridiction-obligation-lors-de-l-ajout-modification-d-une-instance.md](#docs-ADR-002-juridiction-obligation-lors-de-l-ajout-modification-d-une-instance-md) *(2.335 octets)*
│   │   └── <a id="tree-docs-ADR-004-penal-procedure-step-jsonb-migration-plan-md"></a>[004-penal-procedure-step-jsonb-migration-plan.md](#docs-ADR-004-penal-procedure-step-jsonb-migration-plan-md) *(2.340 octets)*
│   ├── **specifications/**
│   │   └── **etapes-procedure-penales/**
│   │       ├── <a id="tree-docs-specifications-etapes-procedure-penales-ordonnances-md"></a>[ordonnances.md](#docs-specifications-etapes-procedure-penales-ordonnances-md) *(5.396 octets)*
│   │       └── <a id="tree-docs-specifications-etapes-procedure-penales-releve-astreinte-md"></a>[releve-astreinte.md](#docs-specifications-etapes-procedure-penales-releve-astreinte-md) *(5.472 octets)*
│   ├── <a id="tree-docs-architecture-md"></a>[architecture.md](#docs-architecture-md) *(157 octets)*
│   └── <a id="tree-docs-typeorm_migrations_steps-md"></a>[typeorm_migrations_steps.md](#docs-typeorm_migrations_steps-md) *(2.122 octets)*
├── **migration/**
│   ├── <a id="tree-migration-create-migration-db-sql"></a>[create-migration-db.sql](#migration-create-migration-db-sql) *(174 octets)*
│   └── <a id="tree-migration-migrate-sql"></a>[migrate.sql](#migration-migrate-sql) *(462 octets)*
├── **src/**
│   ├── **__tests__/**
│   │   ├── **administrative-case/**
│   │   │   └── **__snapshots__/**
│   │   │       └── <a id="tree-src-__tests__-administrative-case-__snapshots__-administrative-case-e2e-spec-ts-snap"></a>[administrative-case.e2e.spec.ts.snap](#src-__tests__-administrative-case-__snapshots__-administrative-case-e2e-spec-ts-snap) *(11.490 octets)*
│   │   ├── **administrative-instance/**
│   │   │   └── **__snapshots__/**
│   │   │       └── <a id="tree-src-__tests__-administrative-instance-__snapshots__-administrative-instance-e2e-spec-ts-snap"></a>[administrative-instance.e2e.spec.ts.snap](#src-__tests__-administrative-instance-__snapshots__-administrative-instance-e2e-spec-ts-snap) *(23.472 octets)*
│   │   └── **party/**
│   │       └── **__snapshots__/**
│   │           └── <a id="tree-src-__tests__-party-__snapshots__-party-e2e-spec-ts-snap"></a>[party.e2e.spec.ts.snap](#src-__tests__-party-__snapshots__-party-e2e-spec-ts-snap) *(349 octets)*
│   └── **affaire/**
│       ├── **administratif/**
│       │   └── **commons/**
│       │       └── **commands/**
│       │           ├── <a id="tree-src-affaire-administratif-commons-commands-fix-stakes-old-cli-disabled"></a>[fix-stakes.old-cli.disabled](#src-affaire-administratif-commons-commands-fix-stakes-old-cli-disabled) *(2.162 octets)*
│       │           ├── <a id="tree-src-affaire-administratif-commons-commands-migrate-appealType-from-instance-to-case-cli-disabled"></a>[migrate-appealType-from-instance-to-case.cli.disabled](#src-affaire-administratif-commons-commands-migrate-appealType-from-instance-to-case-cli-disabled) *(3.199 octets)*
│       │           ├── <a id="tree-src-affaire-administratif-commons-commands-migrate-case-fields-old-cli-disabled"></a>[migrate-case-fields.old-cli.disabled](#src-affaire-administratif-commons-commands-migrate-case-fields-old-cli-disabled) *(3.027 octets)*
│       │           ├── <a id="tree-src-affaire-administratif-commons-commands-migrate-financial-stakes-cli-disabled"></a>[migrate-financial-stakes.cli.disabled](#src-affaire-administratif-commons-commands-migrate-financial-stakes-cli-disabled) *(6.930 octets)*
│       │           ├── <a id="tree-src-affaire-administratif-commons-commands-migrate-instance-series-to-case-level-cli-disabled"></a>[migrate-instance-series-to-case-level.cli.disabled](#src-affaire-administratif-commons-commands-migrate-instance-series-to-case-level-cli-disabled) *(3.392 octets)*
│       │           ├── <a id="tree-src-affaire-administratif-commons-commands-migrate-party-cli-ts-disabled"></a>[migrate-party.cli.ts.disabled](#src-affaire-administratif-commons-commands-migrate-party-cli-ts-disabled) *(1.772 octets)*
│       │           ├── <a id="tree-src-affaire-administratif-commons-commands-migrate-procedureNature-from-instance-to-case-cli-disabled"></a>[migrate-procedureNature-from-instance-to-case.cli.disabled](#src-affaire-administratif-commons-commands-migrate-procedureNature-from-instance-to-case-cli-disabled) *(3.248 octets)*
│       │           └── <a id="tree-src-affaire-administratif-commons-commands-move-linked-instances-to-cases-level-cli-disabled"></a>[move-linked-instances-to-cases-level.cli.disabled](#src-affaire-administratif-commons-commands-move-linked-instances-to-cases-level-cli-disabled) *(3.407 octets)*
│       └── **penal/**
│           └── **procedure-step/**
│               └── <a id="tree-src-affaire-penal-procedure-step-legacy-penal-procedure-step-service-ts-backup"></a>[legacy-penal-procedure-step.service.ts.backup](#src-affaire-penal-procedure-step-legacy-penal-procedure-step-service-ts-backup) *(15.341 octets)*
├── <a id="tree--dockerignore"></a>[.dockerignore](#-dockerignore) *(13 octets)*
├── <a id="tree--editorconfig"></a>[.editorconfig](#-editorconfig) *(172 octets)*
├── <a id="tree--env-test"></a>[.env.test](#-env-test) *(988 octets)*
├── <a id="tree--eslintignore"></a>[.eslintignore](#-eslintignore) *(29 octets)*
├── <a id="tree--gitignore"></a>[.gitignore](#-gitignore) *(530 octets)*
├── <a id="tree--gitlab-ci-yml"></a>[.gitlab-ci.yml](#-gitlab-ci-yml) *(129 octets)*
├── <a id="tree--npmrc"></a>[.npmrc](#-npmrc) *(128 octets)*
├── <a id="tree-CHANGELOG-md"></a>[CHANGELOG.md](#CHANGELOG-md) *(22.428 octets)*
├── <a id="tree-CONTRIBUTING-md"></a>[CONTRIBUTING.md](#CONTRIBUTING-md) *(812 octets)*
├── <a id="tree-Dockerfile"></a>[Dockerfile](#Dockerfile) *(252 octets)*
└── <a id="tree-README-md"></a>[README.md](#README-md) *(3.019 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `.dockerignore` [13 octets]
<a id="-dockerignore"></a> [↩ Retour à l'arborescence](#tree--dockerignore)

> **Chemin relatif** : `.dockerignore`  
> **Taille** : 13 octets  
> **Lignes** : 2  
> **Type** : text

```text
node_modules

```


---

### 📄 `.editorconfig` [172 octets]
<a id="-editorconfig"></a> [↩ Retour à l'arborescence](#tree--editorconfig)

> **Chemin relatif** : `.editorconfig`  
> **Taille** : 172 octets  
> **Lignes** : 13  
> **Type** : text

```text
root = true

[*]
indent_style = space
indent_size = 2
end_of_line = lf
charset = utf-8
trim_trailing_whitespace = true
insert_final_newline = true

[*.yml]
indent_size = 2

```


---

### 📄 `.env.test` [988 octets]
<a id="-env-test"></a> [↩ Retour à l'arborescence](#tree--env-test)

> **Chemin relatif** : `.env.test`  
> **Taille** : 988 octets  
> **Lignes** : 23  
> **Type** : text

```text
STORAGE_HOST=localhost
STORAGE_PORT=9000
STORAGE_BUCKET=local-test
STORAGE_ACCESS_KEY=ACCESS_KEY
STORAGE_SECRET_KEY=SECRET_KEY
STORAGE_USE_SSL=false
STORAGE_NO_CREATE_BUCKET=false
PASTA_DISABLE_CONF_VALIDATION=true
PASTA_AUTH_STRATEGY=local
TYPEORM_ENTITIES=node_modules/@pasta/**/*.entity.js||dist/**/*.entity{.ts,.js}
JWT_ENABLE_REFRESH="true"
JWT_ACCESS_TOKEN_TIMEOUT="600m"
JWT_SECRET="dummy-secret"

TYPEORM_HOST=localhost
TYPEORM_CONNECTION=postgres
TYPEORM_USERNAME=postgresTest
TYPEORM_PASSWORD=litij_pwd_test
TYPEORM_DATABASE=test
TYPEORM_PORT=5432
STORAGE_ACCEPTED_MIME_TYPES="image/jpeg,image/png,application/pdf,application/vnd.oasis.opendocument.text,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.oasis.opendocument.spreadsheet,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,video/x-msvideo,video/mp4,application/rtf,message/rfc822"
BAN_API_BASE_URL=http://api.ban.test

```


---

### 📄 `.eslintignore` [29 octets]
<a id="-eslintignore"></a> [↩ Retour à l'arborescence](#tree--eslintignore)

> **Chemin relatif** : `.eslintignore`  
> **Taille** : 29 octets  
> **Lignes** : 4  
> **Type** : text

```text
.eslintrc.js
dist
migrations

```


---

### 📄 `.gitignore` [530 octets]
<a id="-gitignore"></a> [↩ Retour à l'arborescence](#tree--gitignore)

> **Chemin relatif** : `.gitignore`  
> **Taille** : 530 octets  
> **Lignes** : 54  
> **Type** : text

```text
# compiled output
/dist
/node_modules

# Logs
logs
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*
lerna-debug.log*

# OS
.DS_Store

# Tests
/coverage
/.nyc_output

# IDEs and editors
/.idea
.project
.classpath
.c9/
*.launch
.settings/
*.sublime-workspace
.vscode

# IDE - VSCode
.vscode/*
!.vscode/tasks.json
!.vscode/launch.json
!.vscode/extensions.json

# TypeORM
/ormconfig.json

ANSIBLE_VAULT_PASSWORD

# other
auth.sh
.env
data.ms
/documentation

# Sentry Config File
.sentryclirc

.github
.specify
AGENTS.md
.opencode

```


---

### 📄 `.gitlab-ci.yml` [129 octets]
<a id="-gitlab-ci-yml"></a> [↩ Retour à l'arborescence](#tree--gitlab-ci-yml)

> **Chemin relatif** : `.gitlab-ci.yml`  
> **Taille** : 129 octets  
> **Lignes** : 7  
> **Type** : yaml

```yaml
include:
  - project: "snum/pnm3/public/pasta/pasta-ci"
    file: "applications/back.yml"

variables:
  USE_NEW_REGISTRY: "true"

```


---

### 📄 `.npmrc` [128 octets]
<a id="-npmrc"></a> [↩ Retour à l'arborescence](#tree--npmrc)

> **Chemin relatif** : `.npmrc`  
> **Taille** : 128 octets  
> **Lignes** : 2  
> **Type** : text

```text
@pnm3:registry=https://europe-west9-npm.pkg.dev/dpnm3-lab/pnm3/
@pasta:registry=https://europe-west9-npm.pkg.dev/dpnm3-lab/pnm3/
```


---

### 📄 `CHANGELOG.md` [22.428 octets]
<a id="CHANGELOG-md"></a> [↩ Retour à l'arborescence](#tree-CHANGELOG-md)

> **Chemin relatif** : `CHANGELOG.md`  
> **Taille** : 22.428 octets  
> **Lignes** : 734  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (734 lignes) - Cliquer pour déplier</summary>

````markdown
# Changelog

## Version 0.30.6 (2025-10-10)

### [Administratif]

- Implémentation du feature flag pour les fonctionnalités administratives.
- Ajout du badge administratif dans l’en-tête de la page de détails d’une affaire administrative.

### [Pénal]

- Ajout des filtres « Créé il y a » et « Révisé il y a » sur le tableau de suivi.
- Meilleure gestion des champs de sélection vides (sans données disponibles).
- Dans l’en-tête de la page d’une affaire pénale :
  - Ajout du badge de la dernière étape de procédure.
  - Affichage des informations suivantes :
    - Dernière révision le
    - litijId
    - Gestionnaire
    - Service du gestionnaire

### [Correctifs]

- Correction de l’affichage de l’historique des instances passées.
- Correction de l’affichage des badges d’étapes de procédure pour les affaires liées.

### Commandes de déploiement

1. Exécuter les scripts suivants pour rendre la base cohérente

```sh
   npm run migration:execute
```

2. Initialiser le feature flag pour le module administratif

```sh
   npx pasta init-administrative-feature-flag
```

## Version 0.30.4 (2025-10-06)

### [Pénal]

- Ajout de l'étape de procédure « Recouvrement d’astreinte »
- Ajout de l'étape de procédure « Ordonnance »
- Affichage du badge des étapes de procédure avec le type d’ordonnance sur le dashboard pénal : si le type est renseigné, il est affiché ; sinon, seul « Ordonnance » est affiché.
- Rendre les champs dueDate et comment optionnels dans la sauvegarde de pièce jointe (PenalSavedAttachmentSchema)
- Harmonisation des champs montants dans l'étape de recouvrement d'astreinte
- Mise à jour de l'enum involvement status pour inclure de nouvelles valeurs (migration)
- Ajout du filtrage par litigantId dans la récupération des étapes de procédure pénale
- Le type d'Ordonnance est maintenant optionnel dans l'étape Ordonnance

### [Correctifs]

- [Administratif] Renommage et mise à jour de la récupération des étapes de procédure pour inclure les motions
- [Administratif] Gestion de l'étape de procédure sans étape et optimisation
- [Pénal] Suppression des jointures deprecated_parties dans le service administrative-instance

### Commandes de déploiement

1. Exécuter les scripts suivants pour rendre la base cohérente

```sh
   npm run migration:execute
```

## Version 0.30.3 (2025-09-17)

### [Correctifs]

- Fix de l'ordre de tri des résultats sur le tableau de suivi administratif (tri par date de création décroissante,
  anciennement trié par id)

## Version 0.30.2 (2025-09-12)

### [Correctifs]

- Fix sur la recherche des gestionnaires principaux dans le tableau de suivi

## Version 0.30.1 (2025-09-09)

### [Technique]

- Suppression des colonnes `deprecated` dans la base de données

### [Correctifs]

- Fix sur les dossiers liés (après le refacto N+1)

### Commandes de déploiement

1. Exécuter les scripts suivants pour rendre la base cohérente

```sh
   npm run migration:execute
```

## Version 0.30.0 (2025-09-03)

### [Administratif]

- Ajout de la nature « Recours administratif » et des degrés pour le QPC.

### [Authentification]

- Ajout d’un bouton « Rafraîchir la page » sur la page « Vous n’êtes pas authentifié ».

### [Pénal]

#### Modale «création et de mise à jour des mis en cause et plaignants »

- Tous les champs sont désormais optionnels, sauf **rôle**, **type** et **adresse**.
- Pour une personne morale : ajout des champs **structure juridique** et **statut juridique**.
- Pour une personne physique : ajout du champ **structure juridique**.
- Lors d’un changement de type de personne (Moral/Physique), les informations déjà renseignées (ex. « Représenté par »
  et rôle) sont désormais conservées.

### Technique

- Optimisation des requêtes lors de l’appel qui récupère l’instance en cours ou la dernière.
- Optimization des requêtes pour fixer les problèmes n+1

## Version 0.29.0 (2025-08-08)

### [Pénal]

#### Onglet « Étape de procédure »

- Étape « PV d’infraction » – Section « Infractions »
  - Ajout de la possibilité d’ajouter une ou plusieurs infractions
  - Ajout d’un bouton permettant de supprimer les infractions supplémentaires
  - Ajout d’un lien vers la liste des infractions
- Étape « PV d’infraction » – Section « Communes »
  - Ajout d’un bouton permettant de supprimer les communes supplémentaires

#### Onglet « Général »

- Ajout d’un tableau des infractions dans la section « Infraction »
- Section « Résumé »
  - Ajout d’informations supplémentaires : date du 1er PV d’infraction, commune(s) concernée(s), parcelle(s), zone(s),
    enjeux, instance en cours
  - Ajout d’une mention explicative au-dessus du tableau des infractions

#### Onglet « Étape de procédure »

- Étape « PV d’infraction » – Section « Communes »
  - Ajout d’un formatage automatique à la création des parcelles pour les afficher au bon format (ex : az432 devient AZ 432)
  - Suppression du champ « Arrondissement »
- Nouvelle section « Enjeux »
  - Possibilité d’ajouter un ou plusieurs enjeux
  - Possibilité de supprimer un enjeu

### [Correctifs]

- Correction de la page de login : Ajout d’une page « Utilisateur non authentifié » afin d’éviter l’affichage d’un
  tableau de suivi vide lorsque l’utilisateur est déconnecté

### [Administratif]

#### Fonctionnalité « Consigne »

- Onglet « Étape de procédure »
  - Nouvelle étape de procédure : « Demande d'accord pour médiation »
  - Possibilité d’ajouter des consignes et de les marquer comme traitées
  - Mise à jour de la liste des étapes de procédure avec une indication pour celles contenant des consignes à traiter
- Tableau de suivi
  - Ajout d’un filtre : « Inclure uniquement les affaires avec des consignes à traiter »
  - Le greffe peut désormais ajouter un onglet personnalisé affichant les dossiers contenant des procédures avec
    consignes en attente

### Commandes de déploiement

1. Exécuter les scripts suivants pour rendre la base cohérente

```sh
   npm run migration:execute
```

2. Executer les commandes suivantes pour synchromiser la base de données:

```sh
   npx pasta update-instances-with-outdated-states
  npx pasta disable-typo-tolerance-on-instance-number
  npx pasta delete-admin-cases-without-instance
  npx pasta sync-last-instance-flags
```

3. ffectuer une reindexation de l'indexation pour la recherche :

```sh
   npx pasta reindex-all
```

## Version 0.28.8 (2025-07-21)

### MAJ Technique

- Mise à jour du package node de sentry dans le backend

### [Pénal]

### Ajouts

- Add d'une page quand l'utilisateur n'est pas/plus authentifié
- Ajout des infractions dans le formulaire de PV d'infraction

## Version 0.28.7 (2025-07-17)

### MAJ Technique

- Mise à jour du package node dans le Dockerfile

## Version 0.28.6 (2025-07-17)

### [Pénal]

### Ajouts

#### Onglet Général

- Correction de la gestion des erreurs sur les champs **Statut** et **Civilité** dans la popup d’ajout d’un mis en cause
  ou plaignant.
- Correction du champ **Adresse** : saisie possible sans passer par l’autocomplétion.

#### Tableau de Suivi

- Affichage de la **référence service** ou du **litijId** (si la référence est vide) sous le nom de l’affaire.
- Affichage du **service** à côté du nom du gestionnaire.

#### Étapes de Procédure

- Ajout de nouvelles étapes :
  - **Demande d’avis pour audience**
  - **Demande d’avis interservice**
  - **Observation pour audience**
  - **Courrier**
  - **Projet de réponse**
  - **PV d’infraction** :
    - Section **Information**
    - Section **Communes** :
      - Ajout d’une ou plusieurs communes avec autocomplétion via l’API BAN
      - Gestion partielle des **parcelles** :
        - Ajout et suppression de parcelles
        - Recherche de parcelles existantes (en attente)

#### Global

- Les placeholders dans les champs de sélection sont désormais grisés pour améliorer l'expérience utilisateur.

### Administratif & Pénal

#### Tableaux de Suivi et Suivi de la Procédure

- Ajout du **nombre total de résultats**

### Correctif Technique

- Utilisation du **proxy client Pasta** pour appeler l’API de la BAN.
- Correctifs concernant la page de login et la redirection vers le tableau de suivi.

### Commandes de déploiement

1. Exécuter les scripts suivants pour rendre la base cohérente

```sh
   npm run migration:execute
```

2. Effectuer une reindexation de l'indexation pour la recherche :

```sh
   npx pasta reindex-all
```

---

## Version 0.28.5 (2025-06-24)

### [Pénal]

### Ajouts

#### Tableau de suivi pénal

- Ajout des infos dans les colonnes « Dernière étape » et « Échéance ».
- Ajout des filtres sur les champs « Étape de procédure » et « Échéance »

#### Onglet étape de procédure

- Dans la modale d'ajout d'une pièce jointe, ajout de l’onglet « Pièce existante » : permet d’ajouter une pièce jointe
  existante à une étape de procédure. Il s’agit des PJs qui ne sont pas encore liées à des étapes.
- Ajout d'une modale permettant de supprimer une ou plusieurs étapes de procédure.
- Ajout d'une modale permettant de modifier une étape de procédure.
- Prise en charge de nouvelles étapes de procédure (création et modification) :
  - Prochain rapport à demander
  - Classement sans suite
  - Mise en demeure
  - Ultime mise en demeure avant démolition
  - Alternative aux poursuites

### Technique

- Changement de la gestion de la pagination, des filtres et de la recherche sur :
  - la page tableau de suivi pénal
  - l'onglet suivi de la procédure
  - l'onglet pièces jointes.
- Amélioration des performances sur les requêtes pour le tableau de suivi pénal (ISO tableau de suivi administratif)

### Correctifs

- Suppression du bandeau « Je donne mon avis » dans le header et de la barre de recherche général qui était jusque-là
  inactive.

### [Administratif]

### Corrections

- Suppression du bandeau « Je donne mon avis » dans le header et de la barre de recherche général qui était jusque-là
  inactive.

#### Onglet général

- Amélioration UI du menu latéral (en cohérence avec le pénal)
- Changement de l’icône de l’affaire pour être en accord avec les nouvelles maquettes
- Correction UI du titre de l’affaire pour être en accord avec les nouvelles maquettes

### Commandes de déploiement

1. Exécuter les scripts suivants pour rendre la base cohérente

```sh
   npm run migration:execute
```

2. Effectuer une reindexation de l'indexation pour la recherche :

```sh
   npx pasta reindex-all
```

---

## Version 0.28.4 (2025-05-28)

### [Administratif]

### Ajouts

- Ajout d'un loader sur le tableau de suivi des affaires administratives

```sh
   npm run migration:execute
   npx pasta init-feature-flag
   npx pasta populate-is-last-instance
```

2. Effectuer une reindexation de l'indexation pour la recherche :

```sh
   npx pasta reindex-all
```

## Version 0.28.3 (2025-05-27)

### Correctifs

- Désactivation de la tolérance typographique sur les numéros d'instance
- Optimisations des requêtes pour améliorer les performances sur le tableau de suivi des affaires administratives
- Correctifs globaux suites aux optimisations
- Correctifs d'affichage sur les modales d'ajout de pièces jointes

### Ajouts

- Possibilité d'ajouter des PJ aux étapes de procédure dans les affaires pénales

## Version 0.28.1 (2025-05-15)

### Technique

- Création d'un script pour initialiser un feature flag inactif pour le pénal

### Commandes de déploiement

1. Exécuter les scripts suivants pour rendre la base cohérente

```sh
   npm run migration:execute
   npx pasta init-feature-flag
```

2. Effectuer une reindexation de l'indexation pour la recherche :

```sh
   npx pasta reindex-all
```

## Version 0.28.0 (2025-05-15)

### [Administratif]

#### Ajouts

- Ajout de deux étapes de procédures en écritures.
- Redirection vers l’onglet général après suppression d’une instance.
- Suppression de la dernière instance avec suppression des pièces jointes sur le bucket.
- Modification des noms pour les nouvelles étapes de procédure.
- Alignement des pictogrammes dans les paramètres.

#### Corrections

- Rafraîchissement de la liste des pièces jointes après une suppression.
- Affichage de la dernière instance dans les affaires liées.
- Correction des liens entre les affaires liées.
- Ajout de la valeur `'Non défini'` dans les énumérations du champ concerné.
- Les champs `amount`, `decisionDate` et `interestReceived` sont désormais facultatifs dans le front et en base de
  données.
- Formatage des valeurs numériques dans les enjeux (ex: `192586.25` → `192 586,25`).

### [Pénal]

#### Ajouts

- Autocomplétion des codes postaux et communes dans le champ Adresse.
- Ajout d’un sélecteur pour la civilité.
- Ajout d’un bandeau informatif sur la modale de mise à jour des plaignants.
- Ajout de l’onglet pièces jointes :
  - Ajout et suppression de pièces jointes.
  - Ajout de tags.
  - Affichage des pièces jointes dans un tableau.
- Ajout de la pagination, de la recherche et du filtre par tag dans l’onglet pièces jointes.
- Ajout de la modale de mise à jour d’une ou plusieurs pièces jointes.
- Ajout d’une action groupée (bulk action) pour les pièces jointes.
- Ajout d’une modale de téléchargement de pièces jointes.
- Création du tableau de suivi des étapes de procédure.
- Ajout du filtre par étape de procédure dans l’onglet suivi.
- Création d’un endpoint API pour la création d’une étape de type "Connaissance d’une infraction".

#### Corrections

- Correctifs UI sur l’onglet pièces jointes (prise de focus, lien actif, etc.).

### Commandes de déploiement

1. Exécuter les scripts suivants pour rendre la base cohérente

```sh
   npm run migration:execute
   npx pasta init-feature-flag
```

---

## Version 0.27.1 (2025-04-09)

### Affaire Pénale

#### Nouvelles fonctionnalités

- [FEAT] : Permettre la mise à jour des plaignants et des mis en cause
- [FEAT] : Permettre la visualisation et la mise à jour des parquets
- [FEAT] : Ajout de la suppression des mis en cause et plaignants (unitaire ou multiple)
- [FEAT] : Ajout du champ "autre identifiant" et suppression du champ "numéro sagace"
- [FEAT] : Nouvel endpoint de configuration d'application pour le frontend
- [FEAT] : L'avocat et le nom d'usage sont facultatifs lors de la création d'un mis en cause ou plaignant

### Affaire administrative

#### Nouvelles fonctionnalités

- [FIX] : Affichage de l'historique des instances quand l'étape est nulle

#### Améliorations techniques

- [TECH] : Amélioration de la couverture de tests des parties prenantes
- [TECH] : Refactorisation du service des parties prenantes pour une meilleure qualité de code

## Version 0.27.0 (2025-03-27)

### Affaire Pénal

#### Nouvelles fonctionnalités

- [FEAT] : Ajout du dashboard relatif aux affaires pénales
- [FEAT] : Ajout des plaignants et des mis en cause à une affaire pénale
- [FEAT] : Ajout des parquets
- [FEAT] : Ajout des filtres "Affaires sensibles", "Affaires observées", "Communes"
- [FEAT] : Modal et tableau des gestionnaires et gestion des accès sur l'affaire
- [FEAT] : Ajout de la recherche par référence service, par ville, par numéro de dossier et nom du dossier
- [FEAT] : Ajout de l'autocomplétion par commune sur tous les formulaires

### Affaire Administratif

#### Corrections et améliorations

- [FEAT] : Rendre les intérêts et date de décision facultatifs
- [FIX] : Correction de typo sur dashboard administratif
- [FIX] : Suppression des affaires administratives et leurs instances associées

### Commandes de déploiement

1. Exécuter les scripts suivants pour rendre la base cohérente

```sh
   npm run migration:execute
   npx delete-admin-cases-without-instance
```

2. Effectuer une reindexation de l'indexation pour la recherche :

```sh
   npx pasta reindex-all
```

## Version 0.26.5 (2025-02-20)

### Corrections de bugs

- Ajout de la librairie @pasta/proxy pour gérer les appels Superset

## Version 0.26.4 (2025-02-19)

### Corrections de bugs

- Amélioration de la gestion des erreurs dans le service de dataviz

## Version 0.26.3 (2025-02-17)

### Corrections de bugs

- Fix du chargement des secrets Superset dans le front

## Version 0.26.2 (2025-02-13)

### Nouvelles fonctionnalités

- Intégration de tableau de bord de data visualisation via Superset

## Version 0.26.1 (2025-02-05)

### Corrections de bugs

- Fix du filtre par date de révision "révisé il y a -24h"

## Version 0.26.0 (2025-01-29)

### Nouvelles fonctionnalités

- Filtre "Cibler les affaires révisés par d'autres que moi"
- Ajout d'un bouton pour charger une PJ depuis l'onglet "pièces"
- Transfert des champs "Type de recours" et des "Nature de la procedure" de l'instance vers l'affaire
- Désactivation de la synchronisation automatique des migrations TypeORM (en cours de finalisation, tests prévus sur les
  envs)
- Mise à jour automatique des dates sauvegardées (filtre dates)
- Ajout de la colonne dernière mise à jour
- Tri des instances et leurs étapes de procédure par date de création
- Mise à jour du pictogramme Étape en "calendar-event"
- Mise à jour des filtres : "Révisé il y a" et "Créé il y a"
- Bloquer la modale d'ajout d'une PJ quand le renommage du champ n'est pas correct
- Bascule automatique de tous les anciens gestionnaires principaux en tant que consultant.e.s permanent.e.s sur les
  nouvelles instances

### Corrections de bugs

- Rafraichissement des étapes de procédures lorsqu'une PJ est ajoutée

### Commandes de déploiement

1. Désactiver la synchronisation TypeORM automatique, dans `app/templates/back/back-configmap.yml`:

```sh
   TYPEORM_SYNCHRONIZE: "false"
```

2. Exécuter les migrations:

```sh
  npx typeorm migration:run --dataSource=dist/database/data-source.js
```

3. Exécuter les scripts de reprises de données sur les natures de procédures et les types de recours:

```sh
  npx pasta migrate-procedure-nature
  npx pasta migrate-appeal-type
```

## Version 0.25.2 (2025-01-23)

### Nouvelles fonctionnalités

- Suppression du tri par date d'échéance sur la liste des affaires

## Version 0.25.1 (2025-01-09)

### Nouvelles fonctionnalités

- Les anciens gestionnaires principaux deviennent automatiquement consultants permanents sur les nouvelles instances du
  dossier
- Ajout d'un bouton statistique permettant l'accès à Superset.
- Trie de la liste des dossiers en fonction de la date d'échéance
- Ajout des filtres par période : Crée il y a / Révisé il y a
- Suppression de l'étape "Aucune" dans les étapes de procédure, le champ "Etape" devient obligatoire

### Corrections de bugs

- Normaliser les caractères spéciaux lors de l'ajout des PJ
- Indexation manuelle des instances et des affaires
- Correction d'un problème qui causait la perte du numéro de page lors du retour au dashboard via le bouton "Précédent"
- Correction de concernant la possibilité d'ajouter des tags à une pièce jointe lors d'une étape de procédure.

## Version 0.25.0 (2024-11-06)

### Nouvelles fonctionnalités

- Script de migration `update-instances-with-outdated-states` pour fermer toutes les instances d'une affaire sauf la
  derniere
- Script de migration `sync-instances-with-cases-title` pour faire une copie de tous les titres des affaires vers
  l'instance (sans changer la source)
- Ajout d'un listener pour automatiquement fermer toutes les instances d'une affaire en cas d'ajout d'une nouvelle

- Nouvelles interfaces graphiques:
  - Tableau de suivi qui liste maintentant les affaires et plus les instances
  - Tableau custom de l'historique des instances passées avec les collapses pour les étapes de procédures
  - Ajout du champ Télérecours (Create-Read-Update)
  - Déplacement du champ Reférence service dans la partie "Suivi de la procedure"
  - Uniformisation des mots "Dossier/contentieux" → "Affaire"

### Corrections de bugs

- Correction du bug sur le numéro de la page qui disparaissait quand il y avait des filtres
- Correction du bug qui n'excluait pas les affaires serielles

### Commandes de déploiement

1. Effectuer une migration suivantes pour rendre la base cohérente

```sh
   npx pasta update-instances-with-outdated-states
   npx pasta sync-instances-with-cases-title
```

2. Effectuer une reindexation de l'indexation pour la recherche:

```sh
   npx pasta reindex-all
```

## Version 0.24.4 (2024-11-13)

### Nouvelles fonctionnalités

- Migration des séries vers les affaires

### Corrections de bugs

### Commandes de déploiement

1. Effectuer une migration des séries anciennement liées aux instances vers les affaires:

```sh
   npx pasta migrate-instance-series-to-case
```

2. Effectuer une reindexation de l'indexation pour la recherche:

```sh
   npx pasta reindex-all
```

## Version 0.24.2 (2024-11-06)

### Nouvelles fonctionnalités

### Corrections de bugs

- Patch sur le calcul du total des provisions

### Commandes de déploiement

1. Effectuer une reindexation de l'indexation pour la recherche:

```sh
   npx pasta reindex-all
```

2. Effectuer une migration suivantes pour rendre la base cohérente

```sh
   npx pasta migrate-linked-instances-to-cases
```

## Version 0.24.1 (2024-10-28)

### Nouvelles fonctionnalités

### Corrections de bugs

- Fix la recherche avec une maj de pasta-back-search
- Fix sur le filtre concernant la date d'échéance en filtrant par dates non-nulles

### Commandes de déploiement

1. Effectuer une migration de données des enjeux financiers en base:

```sh
   npx pasta migrate-financial-stakes
```

2. Effectuer une reindexation de l'indexation pour la recherche:

```sh
   npx pasta reindex-all
```

## Version 0.24.0 (2024-10-21)

### Nouvelles fonctionnalités

- Liaison des pièces jointes non plus à l'instance mais à l'affaire et l'instance
- Liaison des enjeux financiers non plus à l'instance mais à l'affaire
- Migration de l'état de l'affaire et l'instance

### Corrections de bugs

### Commandes de déploiement

1. Effectuer une migration de données des enjeux financiers en base:

```sh
   npx pasta migrate-financial-stakes
   npx pasta reindex-all
```

````

</details>


---

### 📄 `container/docker-compose.yml` [421 octets]
<a id="container-docker-compose-yml"></a> [↩ Retour à l'arborescence](#tree-container-docker-compose-yml)

> **Chemin relatif** : `container/docker-compose.yml`  
> **Taille** : 421 octets  
> **Lignes** : 24  
> **Type** : yaml

```yaml
version: '3.8'

services:
  db:
    image: postgres:latest
    environment:
      POSTGRES_DB: litij
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: litij_pwd
    volumes:
      - ./init-db.sql:/docker-entrypoint-initdb.d/init-db.sql
    ports:
      - "5432:5432"

  search:
    image: getmeili/meilisearch:latest
    ports:
      - "7700:7700"
    volumes:
      - meili_data:/meili_data

volumes:
  meili_data:

```


---

### 📄 `container/init.sql` [133 octets]
<a id="container-init-sql"></a> [↩ Retour à l'arborescence](#tree-container-init-sql)

> **Chemin relatif** : `container/init.sql`  
> **Taille** : 133 octets  
> **Lignes** : 4  
> **Type** : sql

```sql
CREATE DATABASE litij;
CREATE USER postgres WITH ENCRYPTED PASSWORD 'litij_pwd';
GRANT ALL PRIVILEGES ON DATABASE litij TO postgres;

```


---

### 📄 `CONTRIBUTING.md` [812 octets]
<a id="CONTRIBUTING-md"></a> [↩ Retour à l'arborescence](#tree-CONTRIBUTING-md)

> **Chemin relatif** : `CONTRIBUTING.md`  
> **Taille** : 812 octets  
> **Lignes** : 32  
> **Type** : markdown

````markdown
Welcome to LITIJ Backend ⚖️

## Table of Contents

- [Gitflow](#gitflow)
- [Code standards](#code-standards)

---

## Gitflow

Litij Backend [Gitlab repository](https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/gti/litij/litij-back/)

### 🌱 Creating a branch

From the `main` branch, you can pull a branch with a short, descriptive name, without any prefix.

### 📌 Creating a commit

When creating a commit, you can use a [gitmoji](https://gitmoji.dev/) to type your commit.

### 📤 Creating a Merge Request

Write a descriptive title and a description if needed. Check "Delete source branch" and "Squash commits" (if multiple commits) before merging.
Update the documentation (README.md or this very CONTRIBUTING.md file) if it is relevant.

---

## Code standards

_To be completed_

````


---

### 📄 `Dockerfile` [252 octets]
<a id="Dockerfile"></a> [↩ Retour à l'arborescence](#tree-Dockerfile)

> **Chemin relatif** : `Dockerfile`  
> **Taille** : 252 octets  
> **Lignes** : 17  
> **Type** : dockerfile

```dockerfile
FROM node:20

WORKDIR /opt/app/

RUN apt-get update && apt-get install -y vim && apt-get clean;

COPY .npmrc .
COPY package-lock.json .
COPY package.json .
COPY .pastarc.json .

RUN npm ci --production

COPY dist/ ./dist/

CMD ["node", "dist/main.js"]

```


---

### 📄 `docs/ADR/000-empty-template.md` [417 octets]
<a id="docs-ADR-000-empty-template-md"></a> [↩ Retour à l'arborescence](#tree-docs-ADR-000-empty-template-md)

> **Chemin relatif** : `docs/ADR/000-empty-template.md`  
> **Taille** : 417 octets  
> **Lignes** : 34  
> **Type** : markdown

```markdown
### ADR : <Titre>

#### 0. Status
✅ Validé | ❌ Rejeté | ❓Proposé

#### 1.🎯 Présentation

**Date**:

**Participants**
- Équipe LITIJ:
- Équipe Pasta:

#### 2. 🌐 Contexte


#### 3. 💡 Décision

#### 4. 🔍 Justification

##### Problèmes et Stratégies de Contournement:


#### 5. ⚖️ Conséquences
- **Bénéfices**:

- **Inconvénients**:

#### 6. 🏷️ Alternatives Considérées
-
-

---

```


---

### 📄 `docs/ADR/0001-ajout-gestionnaire-principal-dossier.md` [3.217 octets]
<a id="docs-ADR-0001-ajout-gestionnaire-principal-dossier-md"></a> [↩ Retour à l'arborescence](#tree-docs-ADR-0001-ajout-gestionnaire-principal-dossier-md)

> **Chemin relatif** : `docs/ADR/0001-ajout-gestionnaire-principal-dossier.md`  
> **Taille** : 3.217 octets  
> **Lignes** : 55  
> **Type** : markdown

````markdown
### ADR : Ajout du gestionnaire principal au dossier

#### 0. Status
✅ Validé

#### 1.🎯 Présentation
Cette ADR documente notre approche pour surmonter la limitation du framework tout en maintenant l'intégrité et la fonctionnalité de notre application.

**Date**: 23 Juillet 2024

**Participants**
- Équipe LITIJ: Claire, Valentino, Florian
- Équipe Pasta: Romain

#### 2. 🌐 Contexte
Lors de la création d'un dossier dans notre système, un.e gestionnaire principal.e (chef.fe de service) est automatiquement affecté.e par défaut.
Ce gestionnaire principal est représenté par une entité `User`. Le système utilise le framework `@pasta` pour la gestion des relations de données.

**Challenge**:
⚠️ Le framework `@pasta` ne supporte pas les relations directes avec la table `User` gérée par `@pasta/back-auth` (many-to-one dans notre cas), et ne permet pas d'étendre la classe pour lui rajouter des comportements customs.
Cela complique l'association directe du gestionnaire principal à un dossier.


#### 3. 💡 Décision
Nous avons décidé de stocker l'identifiant du gestionnaire principal (`mainHandlerId`) dans la table `AdministrativeCase` sous forme d'un entier (`Int`), plutôt que d'utiliser une relation many-to-one directe avec la table `User`.
ℹ️ L'équipe Pasta est consciente du problème et a déjà commencé à y réfléchir. Cette solution est donc temporaire.

#### 4. 🔍 Justification
Cette approche a été choisie en raison de la limitation technique du framework `@pasta` concernant les relations many-to-one avec la table `User`.

##### Problèmes et Stratégies de Contournement:

1. **Perte de la contrainte d'intégrité référentielle**:
  - **Problème**: Le stockage de l'ID sous forme d'int ne permet pas de garantir l'existence d'un utilisateur correspondant.
  - **Stratégie**: Effectuer une vérification via une contrainte de validation (le `validator` `LitijUserIdConstraint`) lors de la mise à jour du gestionnaire principal du dossier pour s'assurer que l'ID stocké correspond à un utilisateur existant.

2. **Limitation d'interaction avec le front-end**:
  - **Problème**: Le front-end ne peut pas accéder directement à l'objet `User` du gestionnaire principal, car la relation n'est pas explicitement définie.
  - **Stratégie**: Utiliser une méthode calculée `getMainHandler` pour récupérer manuellement l'utilisateur correspondant à l'ID stocké et fournir cette information au front-end.

#### 5. ⚖️ Conséquences
- **Bénéfices**:
  - Permet d'intégrer le chef de service comme gestionnaire principal sans changer de framework ou de refactoriser massivement l'application.

- **Inconvénients**:
  - Besoin d'efforts supplémentaires pour maintenir l'intégrité des données manuellement.
  - Complexité accrue dans le traitement des données entre le front-end et le back-end.
  - Risques potentiels de bugs en cas de changement ou d'oubli des vérifications manuelles.

#### 6. 🏷️ Alternatives Considérées
- **Changer de framework**: 🚫 Trop coûteux et impraticable à court terme.
- **Refactorisation majeure**: 🚫 Nécessiterait des modifications importantes et disruptives du système actuel.

---

````


---

### 📄 `docs/ADR/002-juridiction-obligation-lors-de-l-ajout-modification-d-une-instance.md` [2.335 octets]
<a id="docs-ADR-002-juridiction-obligation-lors-de-l-ajout-modification-d-une-instance-md"></a> [↩ Retour à l'arborescence](#tree-docs-ADR-002-juridiction-obligation-lors-de-l-ajout-modification-d-une-instance-md)

> **Chemin relatif** : `docs/ADR/002-juridiction-obligation-lors-de-l-ajout-modification-d-une-instance.md`  
> **Taille** : 2.335 octets  
> **Lignes** : 47  
> **Type** : markdown

````markdown
### ADR : Champ "jurisdiction" obligatoire dans le DTO, nullable en base de données

#### 0. Status
   ❓ Proposé
#### 1.🎯 Présentation
Cette ADR documente notre approche pour rendre obligatoire l'information sur la
juridiction lors de la creéation et la modification d'une affaire et d'une instance.

**Date**: 19 août 2024

**Participants**
- Équipe de développement: Claire, Florian

#### 2. 🌐 Contexte
Lors de la création et la modification d'une `administrative_instance`, l'entité reliée a un champ "jurisdiction" actuellement facultatif dans le
DTO et nullable en base de données. Nous sommes en phase de test and learn, avec des règles métier évolutives. Nous
souhaitons rendre le champ "jurisdiction" obligatoire qu'au niveau applicatif.

#### 3. 💡 Décision
Rendre le champ "jurisdiction" obligatoire dans le DTO tout en le gardant nullable dans la base de données.

#### 4. 🔍 Justification
Cette approche offre un équilibre entre la flexibilité nécessaire pour notre phase de test and learn et le besoin
d'imposer des règles métier au niveau applicatif.

##### Problèmes et Stratégies de Contournement:
- Incohérence potentielle entre l'application et la base de données : Implémenter des vérifications supplémentaires
lors de la récupération des données.
- Risque d'insertions invalides en base : Mettre en place des triggers ou des contraintes au niveau de la base de données pour les insertions directes.

#### 5. ⚖️ Conséquences
**Bénéfices:**
 - Flexibilité pour des changements futurs sans modification de la structure de la base de données.
 Validation renforcée au niveau applicatif.
- Compatibilité maintenue avec les données existantes.

**Inconvénients:**
- Complexité accrue dans la gestion des cas où "jurisdiction" est null en base.
- Risque d'erreurs lors d'insertions directes en base de données.
- Potentielle baisse de performance due aux vérifications supplémentaires.
- Possible confusion pour les futurs développeurs.

#### 6. 🏷️ Alternatives Considérées
- Rendre le champ non nullable en base: 🚫 Nécessiterait une migration potentiellement coûteuse et risquée.
- Système de versioning avec vues: 🚫 Plus complexe à mettre en place initialement, mais pourrait être reconsidéré si
les besoins de flexibilité augmentent.

````


---

### 📄 `docs/ADR/004-penal-procedure-step-jsonb-migration-plan.md` [2.340 octets]
<a id="docs-ADR-004-penal-procedure-step-jsonb-migration-plan-md"></a> [↩ Retour à l'arborescence](#tree-docs-ADR-004-penal-procedure-step-jsonb-migration-plan-md)

> **Chemin relatif** : `docs/ADR/004-penal-procedure-step-jsonb-migration-plan.md`  
> **Taille** : 2.340 octets  
> **Lignes** : 57  
> **Type** : markdown

````markdown
# PenalProcedureStep JSONB Migration Plan (No Suffix, Legacy Prefix)

## Naming Strategy

- **Legacy (renamed from current):**
  - Table: `litij_legacy_penal_procedure_step`
  - Entity: `LegacyPenalProcedureStepEntity`
  - Service: `LegacyPenalProcedureStepServiceTs`
- **New (uses original names):**
  - Table: `litij_penal_procedure_step`
  - Entity: `PenalProcedureStepEntity`
  - Service: `PenalProcedureStepService`

## Migration Steps

### 1. Preparation & Infrastructure

- Create new entity `PenalProcedureStepEntity` (table: `litij_penal_procedure_step`)
- Columns: id, creationDate, modificationDate, stage, dueDate, notificationDate, comment, penalCaseId, isLatestStep, stageData (jsonb), requestingServiceId, managingDepartmentPersonId
- Relations: penalCase, attachments, litigants, requestingService, managingDepartmentPerson, offenseReportMunicipalities, offenseReportInfractions, offenseReportStakes
- JSONB structure per stage (see detailed types in plan)

### 2. Rename Legacy

- Rename current entity/service/table to `LegacyPenalProcedureStepEntity`, `LegacyPenalProcedureStepServiceTs`, `litij_legacy_penal_procedure_step`
- Keep all child entities for reference

### 3. New Service & Utilities

- Create `PenalProcedureStepService` (new logic, JSONB serialization)
- Create `stage-data.types.ts` for JSONB types
- Create `stage-data-serializer.ts` for mapping
- Create `penal-procedure-step-entity.factory.ts` for entity creation

### 4. Migrations

- Migration 1: Rename legacy table
- Migration 2: Create new table `litij_penal_procedure_step`
- Migration 3: Migrate data from legacy to new (per stage, mapping columns to JSONB)
- Migration 4: Update foreign keys and join tables (attachments, litigants, etc.)

### 5. Module & Controller

- Update module to register new entity/service and legacy for transition
- Controller and DTOs remain unchanged

### 6. Testing & Rollout

- All tests must pass (no test changes)
- Monitor performance and correctness
- Rollback: revert code and FKs to legacy if needed
- Cleanup: drop legacy table and code after validation period

---

This plan ensures a clean migration to a JSONB-based architecture for penal procedure steps, using the original table/entity names for the new implementation and a `Legacy` prefix for the old. All API contracts and tests remain unchanged.

````


---

### 📄 `docs/architecture.md` [157 octets]
<a id="docs-architecture-md"></a> [↩ Retour à l'arborescence](#tree-docs-architecture-md)

> **Chemin relatif** : `docs/architecture.md`  
> **Taille** : 157 octets  
> **Lignes** : 5  
> **Type** : markdown

```markdown
# Database architecture

The following image desbribes the database structure and the relations between tables of LITIJ
![Database structure](diagramme.png)

```


---

### 📄 `docs/specifications/etapes-procedure-penales/ordonnances.md` [5.396 octets]
<a id="docs-specifications-etapes-procedure-penales-ordonnances-md"></a> [↩ Retour à l'arborescence](#tree-docs-specifications-etapes-procedure-penales-ordonnances-md)

> **Chemin relatif** : `docs/specifications/etapes-procedure-penales/ordonnances.md`  
> **Taille** : 5.396 octets  
> **Lignes** : 83  
> **Type** : markdown

````markdown
# Documentation Formulaire Ordonnance

## 1. Introduction

Ce document décrit le formulaire d'enregistrement des informations relatives à une "Ordonnance".

L'ordonnance n'est pas un acte qui statue sur le fond de l'affaire, mais plutôt un document procédural apportant des modifications formelles ou des précisions à l'application d'une décision existante (jugement ou arrêt).

Lien vers le Figma [ici](https://www.figma.com/design/zVKitAKEYMC7u3GUlxtuSP/02_Litij_Work_in_progress?node-id=12085-5816&t=4NbCYWkTmadjExiS-4).

## 2. Champs du Formulaire

| Champ                                           | Type           | Obligatoire  | Description                                                                                                        |
| ----------------------------------------------- | -------------- | ------------ | ------------------------------------------------------------------------------------------------------------------ |
| **Étape**                                       | Menu déroulant | Non          | Sélection de l'étape de la procédure (valeur par défaut : "Ordonnance").                                           |
| **Décision reçue**                              | Case à cocher  | Non          | Indique si une décision a été reçue en lien avec cette ordonnance.                                                 |
| **Notifié le**                                  | Date           | Non          | Date de notification de l'ordonnance (format jj/mm/aaaa).                                                          |
| **Décision du**                                 | Date           | Conditionnel | Date de la décision associée à l'ordonnance (format jj/mm/aaaa).Affichage conditionnel si Décision reçue est coché |
| **Échéance**                                    | Date           | Non          | Date d'échéance liée à l'ordonnance (format jj/mm/aaaa).                                                           |
| **Audience concernée**                          | Menu déroulant | Non          | Audience concernée par l'ordonnance (liste pré-remplie).                                                           |
| **Juridiction**                                 | Menu déroulant | Non          | Juridiction compétente (liste pré-remplie).                                                                        |
| **Nature de la procédure**                      | Menu déroulant | Non          | Nature de la procédure (liste pré-remplie).                                                                        |
| **Désistement / Irrecevabilité / Prescription** | Case à cocher  | Non          | Indique si l'ordonnance concerne un désistement, une irrecevabilité ou une prescription.                           |
| **Condamnation solidaire**                      | Case à cocher  | Non          | Tous les mis en cause paient la même somme d’astreinte.                                                            |
| **Publication / Affichage**                     | Case à cocher  | Non          | Indique si l’ordonnance prévoit une publication ou un affichage.                                                   |
| **Type d'Ordonnance**                           | Menu déroulant | Oui          | Type spécifique de l'ordonnance (liste pré-remplie).                                                               |
| **Commentaire**                                 | Zone de texte  | Conditionnel | Commentaires sur l'ordonnance (affichage conditionnel, voir section 3).                                            |
| **Nouveau montant de l'astreinte**              | Zone de texte  | Conditionnel | Nouveau montant de l'astreinte (affichage conditionnel si relèvement/abaissement d'astreinte, voir section 3).     |

## 3. Règles de Gestion et Affichage Conditionnel

### 3.1 Champs Obligatoires

Les champs marqués d'un astérisque (\*) sont obligatoires pour la sauvegarde du formulaire.

### 3.2 Affichage Conditionnel du Champ "Commentaire"

Le champ "Commentaire" est affiché ou masqué en fonction de la valeur sélectionnée dans le menu déroulant "Type d'Ordonnance". Voici un schéma illustrant ces règles :

```mermaid
graph TD
    A[Type d'Ordonnance] --> B{Ordonnance en rectification erreurs matérielles};
    A --> C{Ordonnance d'irrecevabilité / désistement};
    A --> D{Ordonnance d'expulsion};
    A --> E{Ordonnance de relèvement/abaissement d'astreinte};
    A --> F{Autre};

    B -- Oui --> G[Afficher Champ 'Commentaire'];
    C -- Oui --> G;
    D -- Oui --> G;
    E -- Oui --> H[Afficher Champ 'Commentaire' + Champ 'Nouveau montant de l'astreinte'];
    F -- Oui --> G;

    style G fill:#f9f,stroke:#333,stroke-width:2px
    style H fill:#f9f,stroke:#333,stroke-width:2px
```

### 3.3 Détails des listes déroulantes

- Juridiction :

  - Tribunal correctionnel,
  - Chambre des appels correctionnels,
  - Tribunal civil,
  - Tribunal judiciaire,
  - Cour d'appel,
  - Cour de cassation

- Nature de la procédure :

  - Contradictoire,
  - Défaut,
  - Contradictoire à signifier,
  - Non contradictoire,
  - Par défaut

- Type d'ordonnance :
  - Ordonnance de rectification erreurs matérielles,
  - Ordonnance d'irrecevabilité / désistement,
  - Ordonnance d'expulsion,
  - Ordonnance de relèvement/abaissement d'astreinte,
  - Autre

````


---

### 📄 `docs/specifications/etapes-procedure-penales/releve-astreinte.md` [5.472 octets]
<a id="docs-specifications-etapes-procedure-penales-releve-astreinte-md"></a> [↩ Retour à l'arborescence](#tree-docs-specifications-etapes-procedure-penales-releve-astreinte-md)

> **Chemin relatif** : `docs/specifications/etapes-procedure-penales/releve-astreinte.md`  
> **Taille** : 5.472 octets  
> **Lignes** : 58  
> **Type** : markdown

````markdown
# Document d'Analyse - Formulaire de Recouvrement d'Astreintes Judiciaires

**Objectif:** Définir les règles de gestion et les fonctionnalités du formulaire de recouvrement d'astreintes
judiciaires basé sur la maquette
Figma [lien](https://www.figma.com/design/zVKitAKEYMC7u3GUlxtuSP/02_Litij_Work_in_progress?node-id=11116-21185&t=gqUgswdHeikMdNNj-4).

## 1. Contexte Général

Ce document décrit le fonctionnement du formulaire de recouvrement d'astreintes judiciaires (Liquidation).

## 2. Champs du Formulaire & Règles de Saisie

| Champ                                  | Type                       | Obligatoire | Description                                                                                                             | Remarques                                                                                                       |
| :------------------------------------- | :------------------------- | :---------- | :---------------------------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------- |
| **Étape**                              | Menu déroulant             | Oui         | Sélection de l'étape de la procédure (valeur par défaut : "Recouvrement d'astreinte").                                  |
| **Notifié le**                         | Date                       | Non         | Date de notification du recouvrement (format jj/mm/aaaa).                                                               |
| **Échéance**                           | Date                       | Oui         | Permet au gestionnaire d'être informé d'un prochain recouvrement à faire (s'il n'y a pas eu remise en état entre temps) |                                                                                                                 |
| **Mis en cause**                       | Liste                      | Oui         | Sélection du ou des mis-e(s) en cause impliquées dans le recouvrement.                                                  | Une selection multiple est autorisée                                                                            |
| **Période à recouvrir**                | Intervalle (ou deux dates) | Oui         | Sélection d'une période spécifique pour le calcul du montant à recouvrer (entre date début et date fin).                | Si possible permettre une sélection de deux dates (début et fin)                                                |
| **Nombre de jours**                    | Numérique                  | Non         | Nombre de jours dans la "Période à recouvrir".                                                                          | Calculé automatiquement par le système à partir de la période sélectionnée, incluant week-ends et jours fériés. |
| **Montant journalier de l'astreinte**  | Numérique                  | Oui         | Champ libre pour l'instant                                                                                              | Pré-remplie selon l’info de l’étape Jugement/Arrêt ou Ordonnance de relèvement/abaissement d’astreinte.         |
| **Montant de l'astreinte à recouvrir** | Numérique                  | Oui         | Montant total à recouvrer pour la période sélectionnée.                                                                 | Calculé automatiquement : Nombre de jours x Montant journalier de l'astreinte. Pré-rempli, modifiable.          |
| **Commentaire**                        | Texte long                 | Non         | Notes additionnelles sur l'étape de recouvrement.                                                                       |                                                                                                                 |

## 3. Logique de Calcul Automatique

### 3.1. Nombre de Jours

- **Formule:** `Date Fin - Date Début`
- **Inclusion des week-ends et jours fériés:** Le calcul prend en compte les week-ends et les jours fériés pour une
  estimation précise du nombre de jours à recouvrer.

### 3.2. Montant de l'Astreinte à Recouvrir

- **Formule:** `Nombre de Jours x Montant journalier de l'astreinte`
- **Pré-remplissage:** Pré-remplie selon l’info de l’étape Jugement/Arrêt ou Ordonnance de relèvement/abaissement d’astreinte.
  Il doit rester modifiable manuellement (pour le cas d’une astreinte non-solidaire, le gestionnaire doit pouvoir avoir la main sur ce champ).

## 4. Bandeau d'Information

Le bandeau affiche (Non pris en compte pour le moment):

- **Dernier Montant Exigé:** Montant restant à recouvrer basé sur la somme des étapes de recouvrement précédentes dans
  l'affaire.
- **Objectif:** Fournir une vue rapide du solde global et faciliter le suivi du recouvrement.

## 5. Schéma Fonctionnel (Diagramme de Flux)

![img.png](schema-calcul-astreintes.png)

## 6. Règles Métiers Clés

- **Astreinte en cours:** L'astreinte demeure due tant qu'elle n'a pas été intégralement remboursée.
- **Gestion des remboursements partiels:** Chaque remboursement partiel doit être enregistré comme une nouvelle étape de
  recouvrement pour suivre l'évolution du solde restant dû.
- **Cas multiples:** Le formulaire est conçu pour gérer les cas où plusieurs personnes sont impliquées dans le
  recouvrement d'une même astreinte.

````


---

### 📄 `docs/typeorm_migrations_steps.md` [2.122 octets]
<a id="docs-typeorm_migrations_steps-md"></a> [↩ Retour à l'arborescence](#tree-docs-typeorm_migrations_steps-md)

> **Chemin relatif** : `docs/typeorm_migrations_steps.md`  
> **Taille** : 2.122 octets  
> **Lignes** : 92  
> **Type** : markdown

````markdown
# Guide des migrations TypeORM

Ce guide explique comment créer, générer et exécuter des migrations avec TypeORM dans ce projet.

---

## 1. Créer une migration initiale

Utilisez l’une des commandes suivantes pour créer une migration vide :

```bash
npx typeorm migration:create src/database/migrations/<nom_migration_initiale>
```
ou
```bash
npm run migration:create --name=<nom_migration_initiale>
```

---

## 2. Générer une migration après modification du schéma

### 2.1. Mettre à jour l’entité concernée

Modifiez ou créez le fichier d’entité correspondant, par exemple :

```
src/entities/sagace-number.entity.ts
```

### 2.2. Vérifier le fichier data-source

Assurez-vous que le fichier `src/database/data-source.ts` existe et est correctement configuré.

### 2.3. Compiler le projet

Générez les fichiers compilés nécessaires à TypeORM :

```bash
npm run build
```

### 2.4. Générer la migration

Créez une migration basée sur les changements détectés dans les entités :

```bash
npx typeorm -d dist/database/data-source.js migration:generate src/database/migrations/<nom_migration>
```

### 2.5. Vérifier les migrations connues de TypeORM

Affichez la liste des migrations connues :

```bash
npx typeorm migration:show --dataSource=dist/database/data-source.js
```

Si votre migration n’apparaît pas, relancez la compilation :

```bash
npm run build:dev
```

---

## 3. Exécuter toutes les migrations en attente

Appliquez toutes les migrations non exécutées :

```bash
npx typeorm migration:run --dataSource=dist/database/data-source.js
```
ou
```bash
npm run migration:execute
```

---

## Conseils

- **Convention de nommage** : Utilisez des noms explicites pour vos migrations, par exemple `add-user-table`.
- **Vérification** : Relisez toujours le contenu généré des migrations avant de les exécuter en production.
- **Rollback** : Pour annuler la dernière migration, utilisez :
  ```bash
  npx typeorm migration:revert --dataSource=dist/database/data-source.js
  ```
- **Documentation officielle** : [TypeORM Migrations](https://typeorm.io/migrations)

---

````


---

### 📄 `migration/create-migration-db.sql` [174 octets]
<a id="migration-create-migration-db-sql"></a> [↩ Retour à l'arborescence](#tree-migration-create-migration-db-sql)

> **Chemin relatif** : `migration/create-migration-db.sql`  
> **Taille** : 174 octets  
> **Lignes** : 4  
> **Type** : sql

```sql
DROP DATABASE IF EXISTS migration;
CREATE DATABASE migration WITH TEMPLATE litij OWNER "claire.heude";
-- TODO : Récupérer le username depuis les variables d'environnement

```


---

### 📄 `migration/migrate.sql` [462 octets]
<a id="migration-migrate-sql"></a> [↩ Retour à l'arborescence](#tree-migration-migrate-sql)

> **Chemin relatif** : `migration/migrate.sql`  
> **Taille** : 462 octets  
> **Lignes** : 11  
> **Type** : sql

```sql
\c migration;

INSERT INTO "public"."litij_administrative_instance" (title)
SELECT cxa_affaire FROM ctxadministratif WHERE cxa_affaire IS NOT NULL;

-- Pour avoir des fichiers, all_documents (doc_id) -> cxa_elementjoint (cxaej_docjoint, cxaej_cxa_id) -> ctxadministratif (cxa_id)

COPY (SELECT doc_file FROM all_documents WHERE doc_id = 1704963188191) TO '/Users/claire.heude/litij/litij-back/migration/files/1704963188191.hex';

-- DROP TABLE ctx_administratif

```


---

### 📄 `README.md` [3.019 octets]
<a id="README-md"></a> [↩ Retour à l'arborescence](#tree-README-md)

> **Chemin relatif** : `README.md`  
> **Taille** : 3.019 octets  
> **Lignes** : 120  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (120 lignes) - Cliquer pour déplier</summary>

````markdown
# LITIJ Backend

Welcome to LITIJ Backend ⚖️

## 📥 Installing the project

Required :

- [Meilisearch](https://www.meilisearch.com/docs/learn/getting_started/installation)
- [PostgreSQL](https://www.postgresql.org/download/)

### 🗃️ Configuring local database

After installing postgres, use the following command:

```shell
psql postgres
```

Once you're inside postgres shell, chose a username and a password, and type the following commands using them:

```shell
CREATE DATABASE litij;
CREATE USER <username> WITH ENCRYPTED PASSWORD '<password>';
GRANT ALL PRIVILEGES ON DATABASE litij TO <username>;
```

### 🔨 Configuring .env

Once you cloned the project from the [Gitlab repository](https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/gti/litij/litij-back), get in touch with the team to get the required environment variables and store them in an `.env` file at the root of the project. Put the database username you chose in `TYPEORM_USERNAME` and the database password in `TYPEORM_PASSWORD`.

### 📊 Initialize the database

To initialize the database, type:

```shell
npx pasta init-auth-module
```

This will create a user with superadmin rights. By default, to log in with this account, you need to use `admin@example.com` as username and `test` as password.

Finally, you can install the packages of litij-back:

```shell
cd litij-back
npm i
```

---

## 🚀 Running the project

First make sure Meilisearch is running, then :

```shell
cd litij-back
npm run dev
```

---

## 👮 Configuring rights and permissions

To configure rights and permissions, log in as a superuser and go to `localhost:8080/admin-permissions` and create the following permissions:

- Module: "litij"; Name: "Create administrativeInstance"; Action: "create"; Subject: "AdministrativeInstance"
- Module: "litij"; Name: "Update administrativeInstance"; Action: "update"; Subject: "AdministrativeInstance"
- Module: "litij"; Name: "Delete administrativeInstance"; Action: "delete"; Subject: "AdministrativeInstance"

Add these permissions to the superadmin profile.

---

## 🧪 Testing the project

```shell
npm run test
```

... or in watch mode :

```shell
npm run test:watch
```

---

## 🌎 Deploying the app

To deploy on the dev environment, just merge something into main; a pipeline will deploy it automatically.

To deploy in production, use the following command:

```shell
npm version <patch | minor | major>
```

Use `patch`, `minor` or `major` depending on what number of `x.y.z` you want to update.

Then, push your version and the tags:

```shell
git push
git push --tags
```

After the version is deployed (try to keep the same version number for front-end and back-end), contact the Pasta team to deploy the latest tag you created.

## 🔍 Going further

You can know more about database architecture [here](docs/architecture.md)

You can know more about the API by running

```shell
npm run docs
```

Then, go to `localhost:8080` with your browser to see the API documentation

````

</details>


---

### 📄 `src/__tests__/administrative-case/__snapshots__/administrative-case.e2e.spec.ts.snap` [11.490 octets]
<a id="src-__tests__-administrative-case-__snapshots__-administrative-case-e2e-spec-ts-snap"></a> [↩ Retour à l'arborescence](#tree-src-__tests__-administrative-case-__snapshots__-administrative-case-e2e-spec-ts-snap)

> **Chemin relatif** : `src/__tests__/administrative-case/__snapshots__/administrative-case.e2e.spec.ts.snap`  
> **Taille** : 11.490 octets  
> **Lignes** : 412  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (412 lignes) - Cliquer pour déplier</summary>

````text
// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`Administrative case | E2E  Getting one Administrative Case Creating a new Administrative Case along with an instance Should return the administrative case with its newly created instance as lastInstance 1`] = `
{
  "appealType": null,
  "associatedCases": {},
  "creationDate": 2023-09-13T12:00:00.000Z,
  "description": null,
  "domain": null,
  "id": 1,
  "instanceCount": 1,
  "lastInstance": {
    "city": null,
    "creationDate": 2023-09-13T12:00:00.000Z,
    "degree": null,
    "domain": null,
    "handlers": {
      "0": {
        "civility": 0,
        "creationDate": 2023-09-13T12:00:00.000Z,
        "firstName": "Admin",
        "groups": {
          "0": {
            "creationDate": 2023-09-13T12:00:00.000Z,
            "id": 3,
            "longName": "PRG",
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "name": "PRG",
            "type": "unit",
          },
        },
        "id": 3,
        "lastName": "Delegue",
        "login": "adminDelegueDuPRG@example.com",
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "roles": {
          "0": {
            "autoUID": null,
            "creationDate": 2023-09-13T12:00:00.000Z,
            "id": 2,
            "isDefault": false,
            "level": 2,
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "module": null,
            "name": "Administrateur Delegue",
          },
        },
        "wasMainHandlerInPastInstance": false,
      },
    },
    "id": 1,
    "instanceLevel": null,
    "instanceNumber": null,
    "jurisdiction": "CEDH",
    "litijId": "TO_BE_DEFINED",
    "location": null,
    "mainHandler": {
      "civility": 0,
      "creationDate": 2023-09-13T12:00:00.000Z,
      "firstName": "Admin",
      "groups": {
        "0": {
          "creationDate": 2023-09-13T12:00:00.000Z,
          "id": 3,
          "longName": "PRG",
          "modificationDate": 2023-09-13T12:00:00.000Z,
          "name": "PRG",
          "type": "unit",
        },
      },
      "id": 3,
      "lastName": "Delegue",
      "login": "adminDelegueDuPRG@example.com",
      "modificationDate": 2023-09-13T12:00:00.000Z,
      "roles": {
        "0": {
          "autoUID": null,
          "creationDate": 2023-09-13T12:00:00.000Z,
          "id": 2,
          "isDefault": false,
          "level": 2,
          "modificationDate": 2023-09-13T12:00:00.000Z,
          "module": null,
          "name": "Administrateur Delegue",
        },
      },
    },
    "mainHandlerId": 3,
    "modificationDate": 2023-09-13T12:00:00.000Z,
    "procedureSteps": {},
    "sagaceNumber": null,
    "service": {
      "creationDate": 2023-09-13T12:00:00.000Z,
      "id": 3,
      "longName": "PRG",
      "modificationDate": 2023-09-13T12:00:00.000Z,
      "name": "PRG",
      "type": "unit",
    },
    "serviceReference": null,
    "state": "ongoing",
    "subDomain": null,
    "territorialUnit": null,
  },
  "litijId": "LIT1",
  "location": null,
  "modificationDate": 2023-09-13T12:00:00.000Z,
  "parties": {},
  "procedureNature": null,
  "sensitiveCase": null,
  "serie": null,
  "subDomain": null,
  "teleRecoursNumber": null,
  "territorialUnit": null,
  "title": "A title",
}
`;

exports[`Administrative case | E2E  Getting one Administrative Case Creating a new Administrative Case along with an instance When adding a new instance to the case (Changing juridiction) The last instance property should move the previous instances mainHandlers as permanent consultant in the current instance (newly created) 1`] = `
[
  {
    "civility": 0,
    "creationDate": 2023-09-13T12:00:00.000Z,
    "firstName": "Admin",
    "groups": {
      "0": {
        "creationDate": 2023-09-13T12:00:00.000Z,
        "id": 5,
        "longName": "AJAG",
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "name": "AJAG",
        "type": "unit",
      },
    },
    "id": 7,
    "lastName": "Delegue",
    "login": "adminDelegueDuAJAG@example.com",
    "modificationDate": 2023-09-13T12:00:00.000Z,
    "roles": {
      "0": {
        "autoUID": null,
        "creationDate": 2023-09-13T12:00:00.000Z,
        "id": 2,
        "isDefault": false,
        "level": 2,
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "module": null,
        "name": "Administrateur Delegue",
      },
    },
    "wasMainHandlerInPastInstance": false,
  },
  {
    "civility": 0,
    "creationDate": 2023-09-13T12:00:00.000Z,
    "firstName": "Admin",
    "groups": {
      "0": {
        "creationDate": 2023-09-13T12:00:00.000Z,
        "id": 4,
        "longName": "AJEUH",
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "name": "AJEUH",
        "type": "unit",
      },
    },
    "id": 4,
    "lastName": "Delegue",
    "login": "adminDelegueDuAJEUH@example.com",
    "modificationDate": 2023-09-13T12:00:00.000Z,
    "roles": {
      "0": {
        "autoUID": null,
        "creationDate": 2023-09-13T12:00:00.000Z,
        "id": 2,
        "isDefault": false,
        "level": 2,
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "module": null,
        "name": "Administrateur Delegue",
      },
    },
    "wasMainHandlerInPastInstance": true,
  },
  {
    "civility": 0,
    "creationDate": 2023-09-13T12:00:00.000Z,
    "firstName": "Admin",
    "groups": {
      "0": {
        "creationDate": 2023-09-13T12:00:00.000Z,
        "id": 3,
        "longName": "PRG",
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "name": "PRG",
        "type": "unit",
      },
    },
    "id": 3,
    "lastName": "Delegue",
    "login": "adminDelegueDuPRG@example.com",
    "modificationDate": 2023-09-13T12:00:00.000Z,
    "roles": {
      "0": {
        "autoUID": null,
        "creationDate": 2023-09-13T12:00:00.000Z,
        "id": 2,
        "isDefault": false,
        "level": 2,
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "module": null,
        "name": "Administrateur Delegue",
      },
    },
    "wasMainHandlerInPastInstance": true,
  },
]
`;

exports[`Administrative case | E2E  Getting one Administrative Case Creating a new Administrative Case along with an instance should return the administrative case with its linkedCase if they were filled in 1`] = `
{
  "0": {
    "appealType": null,
    "creationDate": 2023-09-13T12:00:00.000Z,
    "description": null,
    "domain": null,
    "id": 2,
    "lastInstance": {
      "administrative_case": {
        "appealType": null,
        "creationDate": 2023-09-13T12:00:00.000Z,
        "description": null,
        "domain": null,
        "id": 2,
        "litijId": "LIT2",
        "location": null,
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "procedureNature": null,
        "sensitiveCase": null,
        "serie": null,
        "subDomain": null,
        "teleRecoursNumber": null,
        "territorialUnit": null,
        "title": "A title",
      },
      "city": null,
      "creationDate": 2023-09-13T12:00:00.000Z,
      "degree": null,
      "domain": null,
      "handlers": {
        "0": {
          "civility": 0,
          "creationDate": 2023-09-13T12:00:00.000Z,
          "firstName": "Admin",
          "id": 3,
          "lastName": "Delegue",
          "login": "adminDelegueDuPRG@example.com",
          "modificationDate": 2023-09-13T12:00:00.000Z,
        },
      },
      "id": 2,
      "instanceLevel": null,
      "instanceNumber": null,
      "jurisdiction": "CEDH",
      "litijId": "TO_BE_DEFINED",
      "location": null,
      "mainHandlerId": 3,
      "modificationDate": 2023-09-13T12:00:00.000Z,
      "procedureSteps": {},
      "sagaceNumber": null,
      "service": {
        "creationDate": 2023-09-13T12:00:00.000Z,
        "id": 3,
        "longName": "PRG",
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "name": "PRG",
        "type": "unit",
      },
      "serviceReference": null,
      "state": "ongoing",
      "subDomain": null,
      "territorialUnit": null,
    },
    "litijId": "LIT2",
    "location": null,
    "modificationDate": 2023-09-13T12:00:00.000Z,
    "procedureNature": null,
    "sensitiveCase": null,
    "subDomain": null,
    "teleRecoursNumber": null,
    "territorialUnit": null,
    "title": "A title",
  },
}
`;

exports[`Administrative case | E2E  Getting one Administrative Case When the the administrative case title is updated should update the administrative case 1`] = `
{
  "appealType": null,
  "associatedCases": {},
  "creationDate": 2023-09-13T12:00:00.000Z,
  "description": null,
  "domain": null,
  "id": 3,
  "instanceCount": 1,
  "lastInstance": {
    "city": null,
    "creationDate": 2023-09-13T12:00:00.000Z,
    "degree": null,
    "domain": null,
    "handlers": {
      "0": {
        "civility": 0,
        "creationDate": 2023-09-13T12:00:00.000Z,
        "firstName": "Admin",
        "groups": {
          "0": {
            "creationDate": 2023-09-13T12:00:00.000Z,
            "id": 3,
            "longName": "PRG",
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "name": "PRG",
            "type": "unit",
          },
        },
        "id": 3,
        "lastName": "Delegue",
        "login": "adminDelegueDuPRG@example.com",
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "roles": {
          "0": {
            "autoUID": null,
            "creationDate": 2023-09-13T12:00:00.000Z,
            "id": 2,
            "isDefault": false,
            "level": 2,
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "module": null,
            "name": "Administrateur Delegue",
          },
        },
        "wasMainHandlerInPastInstance": false,
      },
    },
    "id": 5,
    "instanceLevel": null,
    "instanceNumber": null,
    "jurisdiction": "CEDH",
    "litijId": "TO_BE_DEFINED",
    "location": null,
    "mainHandler": {
      "civility": 0,
      "creationDate": 2023-09-13T12:00:00.000Z,
      "firstName": "Admin",
      "groups": {
        "0": {
          "creationDate": 2023-09-13T12:00:00.000Z,
          "id": 3,
          "longName": "PRG",
          "modificationDate": 2023-09-13T12:00:00.000Z,
          "name": "PRG",
          "type": "unit",
        },
      },
      "id": 3,
      "lastName": "Delegue",
      "login": "adminDelegueDuPRG@example.com",
      "modificationDate": 2023-09-13T12:00:00.000Z,
      "roles": {
        "0": {
          "autoUID": null,
          "creationDate": 2023-09-13T12:00:00.000Z,
          "id": 2,
          "isDefault": false,
          "level": 2,
          "modificationDate": 2023-09-13T12:00:00.000Z,
          "module": null,
          "name": "Administrateur Delegue",
        },
      },
    },
    "mainHandlerId": 3,
    "modificationDate": 2023-09-13T12:00:00.000Z,
    "procedureSteps": {},
    "sagaceNumber": null,
    "service": {
      "creationDate": 2023-09-13T12:00:00.000Z,
      "id": 3,
      "longName": "PRG",
      "modificationDate": 2023-09-13T12:00:00.000Z,
      "name": "PRG",
      "type": "unit",
    },
    "serviceReference": null,
    "state": "ongoing",
    "subDomain": null,
    "territorialUnit": null,
  },
  "litijId": "LIT3",
  "location": null,
  "modificationDate": 2023-09-13T12:00:00.000Z,
  "parties": {},
  "procedureNature": null,
  "sensitiveCase": null,
  "serie": null,
  "subDomain": null,
  "teleRecoursNumber": "TR-#1",
  "territorialUnit": null,
  "title": "an updated title",
}
`;

````

</details>


---

### 📄 `src/__tests__/administrative-instance/__snapshots__/administrative-instance.e2e.spec.ts.snap` [23.472 octets]
<a id="src-__tests__-administrative-instance-__snapshots__-administrative-instance-e2e-spec-ts-snap"></a> [↩ Retour à l'arborescence](#tree-src-__tests__-administrative-instance-__snapshots__-administrative-instance-e2e-spec-ts-snap)

> **Chemin relatif** : `src/__tests__/administrative-instance/__snapshots__/administrative-instance.e2e.spec.ts.snap`  
> **Taille** : 23.472 octets  
> **Lignes** : 785  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (785 lignes) - Cliquer pour déplier</summary>

````text
// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`Administrative instance | E2E  Instance Listing Should list all Administrative Instances and taking account additional query params 1`] = `
{
  "data": {
    "0": {
      "administrative_case": {
        "appealType": null,
        "creationDate": 2023-09-13T12:00:00.000Z,
        "description": null,
        "domain": null,
        "id": 1,
        "litijId": "LIT1",
        "location": null,
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "procedureNature": null,
        "sensitiveCase": null,
        "subDomain": null,
        "teleRecoursNumber": null,
        "territorialUnit": null,
        "title": "A title",
      },
      "administrative_case_title": "A title",
      "city": null,
      "creationDate": 2023-09-13T12:00:00.000Z,
      "degree": null,
      "domain": null,
      "handlers": {
        "0": {
          "civility": 0,
          "creationDate": 2023-09-13T12:00:00.000Z,
          "firstName": "Admin",
          "id": 3,
          "lastName": "Delegue",
          "login": "adminDelegueDuPRG@example.com",
          "modificationDate": 2023-09-13T12:00:00.000Z,
          "password": "$2b$10$2STu.z1FYacVJRxPZmWXJeY24ZzacZkqXd5qMhX4wQf.1GCl3pKma",
          "refreshToken": null,
        },
        "1": {
          "civility": 0,
          "creationDate": 2023-09-13T12:00:00.000Z,
          "firstName": "Admin",
          "id": 4,
          "lastName": "Delegue",
          "login": "adminDelegueDuAJEUH@example.com",
          "modificationDate": 2023-09-13T12:00:00.000Z,
          "password": "$2b$10$2STu.z1FYacVJRxPZmWXJeY24ZzacZkqXd5qMhX4wQf.1GCl3pKma",
          "refreshToken": null,
        },
      },
      "hasOngoingInstruction": false,
      "id": 2,
      "instanceLevel": null,
      "instanceNumber": null,
      "isLastInstance": true,
      "jurisdiction": "CEDH",
      "litijId": "TO_BE_DEFINED",
      "location": null,
      "mainHandler": {
        "civility": 0,
        "creationDate": 2023-09-13T12:00:00.000Z,
        "firstName": "Admin",
        "groups": {
          "0": {
            "creationDate": 2023-09-13T12:00:00.000Z,
            "id": 3,
            "longName": "PRG",
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "name": "PRG",
            "type": "unit",
          },
        },
        "id": 3,
        "lastName": "Delegue",
        "login": "adminDelegueDuPRG@example.com",
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "roles": {
          "0": {
            "autoUID": null,
            "creationDate": 2023-09-13T12:00:00.000Z,
            "id": 2,
            "isDefault": false,
            "level": 2,
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "module": null,
            "name": "Administrateur Delegue",
          },
        },
      },
      "mainHandlerId": 3,
      "modificationDate": 2023-09-13T12:00:00.000Z,
      "procedureSteps": {},
      "sagaceNumber": null,
      "service": {
        "creationDate": 2023-09-13T12:00:00.000Z,
        "id": 3,
        "longName": "PRG",
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "name": "PRG",
        "type": "unit",
        "users": {
          "0": {
            "civility": 0,
            "creationDate": 2023-09-13T12:00:00.000Z,
            "firstName": "Admin",
            "id": 3,
            "lastName": "Delegue",
            "login": "adminDelegueDuPRG@example.com",
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "password": "$2b$10$2STu.z1FYacVJRxPZmWXJeY24ZzacZkqXd5qMhX4wQf.1GCl3pKma",
            "refreshToken": null,
            "roles": {
              "0": {
                "id": 2,
                "level": 2,
              },
            },
          },
        },
      },
      "serviceReference": null,
      "state": "ongoing",
      "subDomain": null,
      "territorialUnit": null,
      "title": null,
    },
    "1": {
      "administrative_case": {
        "appealType": null,
        "creationDate": 2023-09-13T12:00:00.000Z,
        "description": null,
        "domain": null,
        "id": 1,
        "litijId": "LIT1",
        "location": null,
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "procedureNature": null,
        "sensitiveCase": null,
        "subDomain": null,
        "teleRecoursNumber": null,
        "territorialUnit": null,
        "title": "A title",
      },
      "administrative_case_title": "A title",
      "city": null,
      "creationDate": 2023-09-13T12:00:00.000Z,
      "degree": null,
      "domain": null,
      "handlers": {
        "0": {
          "civility": 0,
          "creationDate": 2023-09-13T12:00:00.000Z,
          "firstName": "Admin",
          "id": 4,
          "lastName": "Delegue",
          "login": "adminDelegueDuAJEUH@example.com",
          "modificationDate": 2023-09-13T12:00:00.000Z,
          "password": "$2b$10$2STu.z1FYacVJRxPZmWXJeY24ZzacZkqXd5qMhX4wQf.1GCl3pKma",
          "refreshToken": null,
        },
      },
      "hasOngoingInstruction": false,
      "id": 1,
      "instanceLevel": null,
      "instanceNumber": null,
      "isLastInstance": false,
      "jurisdiction": "CEDH",
      "litijId": "TO_BE_DEFINED",
      "location": null,
      "mainHandler": {
        "civility": 0,
        "creationDate": 2023-09-13T12:00:00.000Z,
        "firstName": "Admin",
        "groups": {
          "0": {
            "creationDate": 2023-09-13T12:00:00.000Z,
            "id": 4,
            "longName": "AJEUH",
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "name": "AJEUH",
            "type": "unit",
          },
        },
        "id": 4,
        "lastName": "Delegue",
        "login": "adminDelegueDuAJEUH@example.com",
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "roles": {
          "0": {
            "autoUID": null,
            "creationDate": 2023-09-13T12:00:00.000Z,
            "id": 2,
            "isDefault": false,
            "level": 2,
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "module": null,
            "name": "Administrateur Delegue",
          },
        },
      },
      "mainHandlerId": 4,
      "modificationDate": 2023-09-13T12:00:00.000Z,
      "procedureSteps": {},
      "sagaceNumber": null,
      "service": {
        "creationDate": 2023-09-13T12:00:00.000Z,
        "id": 4,
        "longName": "AJEUH",
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "name": "AJEUH",
        "type": "unit",
        "users": {
          "0": {
            "civility": 0,
            "creationDate": 2023-09-13T12:00:00.000Z,
            "firstName": "Gestionnaire",
            "id": 2,
            "lastName": "Gestionnaire",
            "login": "gestionnaireDuAJEUH@example.com",
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "password": "$2b$10$2STu.z1FYacVJRxPZmWXJeY24ZzacZkqXd5qMhX4wQf.1GCl3pKma",
            "refreshToken": null,
            "roles": {
              "0": {
                "id": 3,
                "level": 1,
              },
            },
          },
          "1": {
            "civility": 0,
            "creationDate": 2023-09-13T12:00:00.000Z,
            "firstName": "Admin",
            "id": 4,
            "lastName": "Delegue",
            "login": "adminDelegueDuAJEUH@example.com",
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "password": "$2b$10$2STu.z1FYacVJRxPZmWXJeY24ZzacZkqXd5qMhX4wQf.1GCl3pKma",
            "refreshToken": null,
            "roles": {
              "0": {
                "id": 2,
                "level": 2,
              },
            },
          },
          "2": {
            "civility": 0,
            "creationDate": 2023-09-13T12:00:00.000Z,
            "firstName": "Consultant",
            "id": 5,
            "lastName": "Tester",
            "login": "consultantDuAJEUH@example.com",
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "password": "$2b$10$2STu.z1FYacVJRxPZmWXJeY24ZzacZkqXd5qMhX4wQf.1GCl3pKma",
            "refreshToken": null,
            "roles": {
              "0": {
                "id": 4,
                "level": 0,
              },
            },
          },
        },
      },
      "serviceReference": null,
      "state": "closed",
      "subDomain": null,
      "territorialUnit": null,
      "title": null,
    },
  },
  "isLastPage": true,
  "limit": 20,
  "offset": 0,
  "page": 1,
  "total": 2,
}
`;

exports[`Administrative instance | E2E  Instance Listing Should list all Administrative Instances without any query params 1`] = `
{
  "data": {
    "0": {
      "administrative_case": {
        "appealType": null,
        "creationDate": 2023-09-13T12:00:00.000Z,
        "description": null,
        "domain": null,
        "id": 1,
        "litijId": "LIT1",
        "location": null,
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "procedureNature": null,
        "sensitiveCase": null,
        "serie": null,
        "subDomain": null,
        "teleRecoursNumber": null,
        "territorialUnit": null,
        "title": "A title",
      },
      "administrative_case_title": "A title",
      "city": null,
      "creationDate": 2023-09-13T12:00:00.000Z,
      "degree": null,
      "domain": null,
      "handlers": {
        "0": {
          "civility": 0,
          "creationDate": 2023-09-13T12:00:00.000Z,
          "firstName": "Admin",
          "id": 3,
          "lastName": "Delegue",
          "login": "adminDelegueDuPRG@example.com",
          "modificationDate": 2023-09-13T12:00:00.000Z,
          "password": "$2b$10$2STu.z1FYacVJRxPZmWXJeY24ZzacZkqXd5qMhX4wQf.1GCl3pKma",
          "refreshToken": null,
        },
        "1": {
          "civility": 0,
          "creationDate": 2023-09-13T12:00:00.000Z,
          "firstName": "Admin",
          "id": 4,
          "lastName": "Delegue",
          "login": "adminDelegueDuAJEUH@example.com",
          "modificationDate": 2023-09-13T12:00:00.000Z,
          "password": "$2b$10$2STu.z1FYacVJRxPZmWXJeY24ZzacZkqXd5qMhX4wQf.1GCl3pKma",
          "refreshToken": null,
        },
      },
      "hasOngoingInstruction": false,
      "id": 2,
      "instanceLevel": null,
      "instanceNumber": null,
      "isLastInstance": true,
      "jurisdiction": "CEDH",
      "litijId": "TO_BE_DEFINED",
      "location": null,
      "mainHandlerId": 3,
      "modificationDate": 2023-09-13T12:00:00.000Z,
      "procedureSteps": {},
      "sagaceNumber": null,
      "service": {
        "creationDate": 2023-09-13T12:00:00.000Z,
        "id": 3,
        "longName": "PRG",
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "name": "PRG",
        "type": "unit",
        "users": {
          "0": {
            "civility": 0,
            "creationDate": 2023-09-13T12:00:00.000Z,
            "firstName": "Admin",
            "id": 3,
            "lastName": "Delegue",
            "login": "adminDelegueDuPRG@example.com",
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "password": "$2b$10$2STu.z1FYacVJRxPZmWXJeY24ZzacZkqXd5qMhX4wQf.1GCl3pKma",
            "refreshToken": null,
            "roles": {
              "0": {
                "autoUID": null,
                "creationDate": 2023-09-13T12:00:00.000Z,
                "id": 2,
                "isDefault": false,
                "level": 2,
                "modificationDate": 2023-09-13T12:00:00.000Z,
                "module": null,
                "name": "Administrateur Delegue",
              },
            },
          },
        },
      },
      "serviceReference": null,
      "state": "ongoing",
      "subDomain": null,
      "territorialUnit": null,
      "title": null,
    },
    "1": {
      "administrative_case": {
        "appealType": null,
        "creationDate": 2023-09-13T12:00:00.000Z,
        "description": null,
        "domain": null,
        "id": 1,
        "litijId": "LIT1",
        "location": null,
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "procedureNature": null,
        "sensitiveCase": null,
        "serie": null,
        "subDomain": null,
        "teleRecoursNumber": null,
        "territorialUnit": null,
        "title": "A title",
      },
      "administrative_case_title": "A title",
      "city": null,
      "creationDate": 2023-09-13T12:00:00.000Z,
      "degree": null,
      "domain": null,
      "handlers": {
        "0": {
          "civility": 0,
          "creationDate": 2023-09-13T12:00:00.000Z,
          "firstName": "Admin",
          "id": 4,
          "lastName": "Delegue",
          "login": "adminDelegueDuAJEUH@example.com",
          "modificationDate": 2023-09-13T12:00:00.000Z,
          "password": "$2b$10$2STu.z1FYacVJRxPZmWXJeY24ZzacZkqXd5qMhX4wQf.1GCl3pKma",
          "refreshToken": null,
        },
      },
      "hasOngoingInstruction": false,
      "id": 1,
      "instanceLevel": null,
      "instanceNumber": null,
      "isLastInstance": false,
      "jurisdiction": "CEDH",
      "litijId": "TO_BE_DEFINED",
      "location": null,
      "mainHandlerId": 4,
      "modificationDate": 2023-09-13T12:00:00.000Z,
      "procedureSteps": {},
      "sagaceNumber": null,
      "service": {
        "creationDate": 2023-09-13T12:00:00.000Z,
        "id": 4,
        "longName": "AJEUH",
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "name": "AJEUH",
        "type": "unit",
        "users": {
          "0": {
            "civility": 0,
            "creationDate": 2023-09-13T12:00:00.000Z,
            "firstName": "Gestionnaire",
            "id": 2,
            "lastName": "Gestionnaire",
            "login": "gestionnaireDuAJEUH@example.com",
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "password": "$2b$10$2STu.z1FYacVJRxPZmWXJeY24ZzacZkqXd5qMhX4wQf.1GCl3pKma",
            "refreshToken": null,
            "roles": {
              "0": {
                "autoUID": null,
                "creationDate": 2023-09-13T12:00:00.000Z,
                "id": 3,
                "isDefault": false,
                "level": 1,
                "modificationDate": 2023-09-13T12:00:00.000Z,
                "module": null,
                "name": "Gestionnaire",
              },
            },
          },
          "1": {
            "civility": 0,
            "creationDate": 2023-09-13T12:00:00.000Z,
            "firstName": "Admin",
            "id": 4,
            "lastName": "Delegue",
            "login": "adminDelegueDuAJEUH@example.com",
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "password": "$2b$10$2STu.z1FYacVJRxPZmWXJeY24ZzacZkqXd5qMhX4wQf.1GCl3pKma",
            "refreshToken": null,
            "roles": {
              "0": {
                "autoUID": null,
                "creationDate": 2023-09-13T12:00:00.000Z,
                "id": 2,
                "isDefault": false,
                "level": 2,
                "modificationDate": 2023-09-13T12:00:00.000Z,
                "module": null,
                "name": "Administrateur Delegue",
              },
            },
          },
          "2": {
            "civility": 0,
            "creationDate": 2023-09-13T12:00:00.000Z,
            "firstName": "Consultant",
            "id": 5,
            "lastName": "Tester",
            "login": "consultantDuAJEUH@example.com",
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "password": "$2b$10$2STu.z1FYacVJRxPZmWXJeY24ZzacZkqXd5qMhX4wQf.1GCl3pKma",
            "refreshToken": null,
            "roles": {
              "0": {
                "autoUID": null,
                "creationDate": 2023-09-13T12:00:00.000Z,
                "id": 4,
                "isDefault": false,
                "level": 0,
                "modificationDate": 2023-09-13T12:00:00.000Z,
                "module": null,
                "name": "consultant",
              },
            },
          },
        },
      },
      "serviceReference": null,
      "state": "closed",
      "subDomain": null,
      "territorialUnit": null,
      "title": null,
    },
  },
  "isLastPage": true,
  "limit": 100,
  "offset": 0,
  "page": 1,
  "total": 2,
}
`;

exports[`Administrative instance | E2E  Instance creation Should create a new ongoing Administrative Instance and close the previous ongoing instance 1`] = `
{
  "administrative_case": {
    "appealType": null,
    "creationDate": 2023-09-13T12:00:00.000Z,
    "description": null,
    "domain": null,
    "id": 1,
    "litijId": "LIT1",
    "location": null,
    "modificationDate": 2023-09-13T12:00:00.000Z,
    "procedureNature": null,
    "sensitiveCase": null,
    "serie": null,
    "subDomain": null,
    "teleRecoursNumber": null,
    "territorialUnit": null,
    "title": "A title",
  },
  "city": null,
  "creationDate": 2023-09-13T12:00:00.000Z,
  "degree": null,
  "domain": null,
  "handlers": {
    "0": {
      "civility": 0,
      "creationDate": 2023-09-13T12:00:00.000Z,
      "firstName": "Admin",
      "id": 4,
      "lastName": "Delegue",
      "login": "adminDelegueDuAJEUH@example.com",
      "modificationDate": 2023-09-13T12:00:00.000Z,
    },
  },
  "id": 1,
  "instanceLevel": null,
  "instanceNumber": null,
  "jurisdiction": "CEDH",
  "litijId": "TO_BE_DEFINED",
  "location": null,
  "mainHandlerId": 4,
  "modificationDate": 2023-09-13T12:00:00.000Z,
  "procedureSteps": {},
  "sagaceNumber": null,
  "service": {
    "creationDate": 2023-09-13T12:00:00.000Z,
    "id": 4,
    "longName": "AJEUH",
    "modificationDate": 2023-09-13T12:00:00.000Z,
    "name": "AJEUH",
    "type": "unit",
    "users": {
      "0": {
        "civility": 0,
        "creationDate": 2023-09-13T12:00:00.000Z,
        "firstName": "Gestionnaire",
        "id": 2,
        "lastName": "Gestionnaire",
        "login": "gestionnaireDuAJEUH@example.com",
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "roles": {
          "0": {
            "autoUID": null,
            "creationDate": 2023-09-13T12:00:00.000Z,
            "id": 3,
            "isDefault": false,
            "level": 1,
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "module": null,
            "name": "Gestionnaire",
          },
        },
      },
      "1": {
        "civility": 0,
        "creationDate": 2023-09-13T12:00:00.000Z,
        "firstName": "Admin",
        "id": 4,
        "lastName": "Delegue",
        "login": "adminDelegueDuAJEUH@example.com",
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "roles": {
          "0": {
            "autoUID": null,
            "creationDate": 2023-09-13T12:00:00.000Z,
            "id": 2,
            "isDefault": false,
            "level": 2,
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "module": null,
            "name": "Administrateur Delegue",
          },
        },
      },
      "2": {
        "civility": 0,
        "creationDate": 2023-09-13T12:00:00.000Z,
        "firstName": "Consultant",
        "id": 5,
        "lastName": "Tester",
        "login": "consultantDuAJEUH@example.com",
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "roles": {
          "0": {
            "autoUID": null,
            "creationDate": 2023-09-13T12:00:00.000Z,
            "id": 4,
            "isDefault": false,
            "level": 0,
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "module": null,
            "name": "consultant",
          },
        },
      },
    },
  },
  "serviceReference": null,
  "state": "ongoing",
  "subDomain": null,
  "territorialUnit": null,
}
`;

exports[`Administrative instance | E2E  Instance update Should update an instance 1`] = `
{
  "administrative_case": {
    "appealType": null,
    "creationDate": 2023-09-13T12:00:00.000Z,
    "description": null,
    "domain": null,
    "id": 1,
    "litijId": "LIT1",
    "location": null,
    "modificationDate": 2023-09-13T12:00:00.000Z,
    "procedureNature": null,
    "sensitiveCase": null,
    "serie": null,
    "subDomain": null,
    "teleRecoursNumber": null,
    "territorialUnit": null,
    "title": "A title",
  },
  "administrative_case_title": "A title",
  "city": null,
  "creationDate": 2023-09-13T12:00:00.000Z,
  "degree": null,
  "domain": null,
  "handlers": {
    "0": {
      "civility": 0,
      "creationDate": 2023-09-13T12:00:00.000Z,
      "firstName": "Admin",
      "id": 4,
      "lastName": "Delegue",
      "login": "adminDelegueDuAJEUH@example.com",
      "modificationDate": 2023-09-13T12:00:00.000Z,
    },
    "1": {
      "civility": 0,
      "creationDate": 2023-09-13T12:00:00.000Z,
      "firstName": "Admin",
      "id": 3,
      "lastName": "Delegue",
      "login": "adminDelegueDuPRG@example.com",
      "modificationDate": 2023-09-13T12:00:00.000Z,
    },
  },
  "hasOngoingInstruction": false,
  "id": 3,
  "instanceLevel": null,
  "instanceNumber": "1234",
  "isLastInstance": true,
  "jurisdiction": "CEDH",
  "litijId": "TO_BE_DEFINED",
  "location": null,
  "mainHandlerId": 4,
  "modificationDate": 2023-09-13T12:00:00.000Z,
  "procedureSteps": {},
  "sagaceNumber": null,
  "service": {
    "creationDate": 2023-09-13T12:00:00.000Z,
    "id": 4,
    "longName": "AJEUH",
    "modificationDate": 2023-09-13T12:00:00.000Z,
    "name": "AJEUH",
    "type": "unit",
    "users": {
      "0": {
        "civility": 0,
        "creationDate": 2023-09-13T12:00:00.000Z,
        "firstName": "Gestionnaire",
        "id": 2,
        "lastName": "Gestionnaire",
        "login": "gestionnaireDuAJEUH@example.com",
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "roles": {
          "0": {
            "autoUID": null,
            "creationDate": 2023-09-13T12:00:00.000Z,
            "id": 3,
            "isDefault": false,
            "level": 1,
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "module": null,
            "name": "Gestionnaire",
          },
        },
      },
      "1": {
        "civility": 0,
        "creationDate": 2023-09-13T12:00:00.000Z,
        "firstName": "Admin",
        "id": 4,
        "lastName": "Delegue",
        "login": "adminDelegueDuAJEUH@example.com",
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "roles": {
          "0": {
            "autoUID": null,
            "creationDate": 2023-09-13T12:00:00.000Z,
            "id": 2,
            "isDefault": false,
            "level": 2,
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "module": null,
            "name": "Administrateur Delegue",
          },
        },
      },
      "2": {
        "civility": 0,
        "creationDate": 2023-09-13T12:00:00.000Z,
        "firstName": "Consultant",
        "id": 5,
        "lastName": "Tester",
        "login": "consultantDuAJEUH@example.com",
        "modificationDate": 2023-09-13T12:00:00.000Z,
        "roles": {
          "0": {
            "autoUID": null,
            "creationDate": 2023-09-13T12:00:00.000Z,
            "id": 4,
            "isDefault": false,
            "level": 0,
            "modificationDate": 2023-09-13T12:00:00.000Z,
            "module": null,
            "name": "consultant",
          },
        },
      },
    },
  },
  "serviceReference": null,
  "state": "ongoing",
  "subDomain": null,
  "territorialUnit": null,
  "title": null,
}
`;

````

</details>


---

### 📄 `src/__tests__/party/__snapshots__/party.e2e.spec.ts.snap` [349 octets]
<a id="src-__tests__-party-__snapshots__-party-e2e-spec-ts-snap"></a> [↩ Retour à l'arborescence](#tree-src-__tests__-party-__snapshots__-party-e2e-spec-ts-snap)

> **Chemin relatif** : `src/__tests__/party/__snapshots__/party.e2e.spec.ts.snap`  
> **Taille** : 349 octets  
> **Lignes** : 15  
> **Type** : text

````text
// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`Party | E2E  Party creation Should create a new party 1`] = `
{
  "creationDate": 2023-09-13T12:00:00.000Z,
  "id": 1,
  "lawyer": "Jane Dupont",
  "modificationDate": 2023-09-13T12:00:00.000Z,
  "name": "John Doe",
  "position": "defendant",
  "profile": "individual",
  "type": "adverse",
}
`;

````


---

### 📄 `src/affaire/administratif/commons/commands/fix-stakes.old-cli.disabled` [2.162 octets]
<a id="src-affaire-administratif-commons-commands-fix-stakes-old-cli-disabled"></a> [↩ Retour à l'arborescence](#tree-src-affaire-administratif-commons-commands-fix-stakes-old-cli-disabled)

> **Chemin relatif** : `src/affaire/administratif/commons/commands/fix-stakes.old-cli.disabled`  
> **Taille** : 2.162 octets  
> **Lignes** : 52  
> **Type** : text

```text
import { AbstractNestCommand, Command } from "@pasta/cli";
import { Argv } from "yargs";

import { StakesDetailService } from "@/affaire/administratif/enjeux-financiers/details-des-enjeux/use-cases/stakes-detail.service";
import { AdministrativeInstanceService } from "@/affaire/administratif/instance/use-cases/administrative-instance.service";

@Command
export class FixStakesCli extends AbstractNestCommand {
  name: string = "fix-stakes";
  description: string = "Fix the existing stakes to euro cents";
  arguments(yargs: Argv<{}>): Argv<{}> {
    return yargs;
  }
  async main(): Promise<void> {
    const CENTS_MULTIPLIER = 100;

    const stakesDetails = await this.stakesDetailService.repo.find({});
    const updatedStakesDetails = stakesDetails.map(stakesDetail => ({
      ...stakesDetail,
      amount: stakesDetail.amount * CENTS_MULTIPLIER,
      interestReceived: stakesDetail.interestReceived * CENTS_MULTIPLIER,
      compensation: stakesDetail.compensation * CENTS_MULTIPLIER,
    }));
    await this.stakesDetailService.repo.save(updatedStakesDetails);

    const administrativeInstances = await this.administrativeInstanceService.getMany({});
    const updatedAdministrativeInstances = administrativeInstances.data.map(administrativeInstance => ({
      ...administrativeInstance,
      provisionalExecution: administrativeInstance.deprecated_provisionalExecution
        ? administrativeInstance.deprecated_provisionalExecution * CENTS_MULTIPLIER
        : null,
      sentenceAmount: administrativeInstance.deprecated_sentenceAmount
        ? administrativeInstance.deprecated_sentenceAmount * CENTS_MULTIPLIER
        : null,
      stakesDemand: administrativeInstance.deprecated_stakesDemand
        ? administrativeInstance.deprecated_stakesDemand * CENTS_MULTIPLIER
        : null,
    }));
    await this.administrativeInstanceService.repo.save(updatedAdministrativeInstances);

    return;
  }

  get stakesDetailService(): StakesDetailService {
    return this.nest.get(StakesDetailService);
  }

  get administrativeInstanceService(): AdministrativeInstanceService {
    return this.nest.get(AdministrativeInstanceService);
  }
}

```


---

### 📄 `src/affaire/administratif/commons/commands/migrate-appealType-from-instance-to-case.cli.disabled` [3.199 octets]
<a id="src-affaire-administratif-commons-commands-migrate-appealType-from-instance-to-case-cli-disabled"></a> [↩ Retour à l'arborescence](#tree-src-affaire-administratif-commons-commands-migrate-appealType-from-instance-to-case-cli-disabled)

> **Chemin relatif** : `src/affaire/administratif/commons/commands/migrate-appealType-from-instance-to-case.cli.disabled`  
> **Taille** : 3.199 octets  
> **Lignes** : 89  
> **Type** : text

````text
import { AbstractNestCommand, Command } from "@pasta/cli";
import { IsNull, Not } from "typeorm";
import { Argv } from "yargs";

import { AdministrativeCaseService } from "@/affaire/administratif/commons/services/administrative-case.service";
import { AdministrativeInstance } from "@/affaire/administratif/instance/domain/administrative-instance.entity";
import { InstanceState } from "@/affaire/administratif/instance/domain/administrative-instance.type";
import { AdministrativeInstanceService } from "@/affaire/administratif/instance/use-cases/administrative-instance.service";

@Command
export class MigrateAppealTypeFromInstanceToCaseCli extends AbstractNestCommand {
  name: string = "migrate-appeal-type";
  description: string = "Pasta command migrate appeal types from administrativeInstance to administrativeCase";
  arguments(yargs: Argv<{}>): Argv<{}> {
    return yargs;
  }
  async main(): Promise<void> {
    const foundInstancesWithAppealTypes = await this.retrieveInstancesWithTheirAppealType();
    const { errorMessages } = await this.updateAdministrativeCases(foundInstancesWithAppealTypes);
    if (errorMessages.length > 0) {
      console.error("😐 Some errors occurred : ");
      errorMessages.forEach(message => console.error(message));
    } else {
      console.info("All done 👌");
    }
  }
  private async retrieveInstancesWithTheirAppealType(): Promise<AdministrativeInstance[]> {
    return this.administrativeInstanceService.repo.find({
      select: {
        id: true,
        administrative_case: {
          id: true,
        },
        deprecated_appealType: true,
      },
      where: {
        administrative_case: {
          id: Not(IsNull()),
        },
        deprecated_appealType: Not(IsNull()),
        state: InstanceState.ONGOING,
      },
      relations: ["administrative_case"],
    });
  }

  private async updateAdministrativeCases(
    administrativeInstances: AdministrativeInstance[]
  ): Promise<{ errorMessages: string[] }> {
    const errorMessages = [];
    if (!administrativeInstances.length) {
      return {
        errorMessages: [`☎️ No instance with appealType found to move`],
      };
    }

    for (const administrativeInstance of administrativeInstances) {
      console.info(
        `From ${administrativeInstance.id}, moving data to ${administrativeInstance.administrative_case.id} ... ⏳`
      );
      try {
        await this.administrativeCaseService.repo.update(
          {
            id: administrativeInstance.administrative_case.id,
          },
          {
            appealType: administrativeInstance.deprecated_appealType,
          }
        );
      } catch (error) {
        errorMessages.push(
          `☎️ A problem occurred when linking cases at instance ${administrativeInstance.id} and ${administrativeInstance.administrative_case.id} : ${error.message}`
        );
      }
    }
    return {
      errorMessages,
    };
  }

  get administrativeInstanceService(): AdministrativeInstanceService {
    return this.nest.get(AdministrativeInstanceService);
  }

  get administrativeCaseService(): AdministrativeCaseService {
    return this.nest.get(AdministrativeCaseService);
  }
}

````


---

### 📄 `src/affaire/administratif/commons/commands/migrate-case-fields.old-cli.disabled` [3.027 octets]
<a id="src-affaire-administratif-commons-commands-migrate-case-fields-old-cli-disabled"></a> [↩ Retour à l'arborescence](#tree-src-affaire-administratif-commons-commands-migrate-case-fields-old-cli-disabled)

> **Chemin relatif** : `src/affaire/administratif/commons/commands/migrate-case-fields.old-cli.disabled`  
> **Taille** : 3.027 octets  
> **Lignes** : 66  
> **Type** : text

````text
import { getRepositoryToken } from "@nestjs/typeorm";
import { AbstractNestCommand, Command } from "@pasta/cli";
import { Repository } from "typeorm";
import { Argv } from "yargs";

import { AdministrativeCase } from "@/affaire/administratif/commons/entities/administrative-case.entity";
import { AdministrativeInstance } from "@/affaire/administratif/instance/domain/administrative-instance.entity";

@Command
export class MigrateCaseFieldsCli extends AbstractNestCommand {
  name: string = "migrate-case-fields";
  description: string =
    "Migrate description, sensitiveCase, location, territorialUnit, domain, subDomain, stakesDemand, stakesComment, provisionalExecution, sentenceAmount, sentenceDate from instance to legal case";
  arguments(yargs: Argv<{}>): Argv<{}> {
    return yargs;
  }

  async main(): Promise<void> {
    try {
      const administrativeInstances = await this.administrativeInstanceRepo.find({
        relations: { administrative_case: true },
      });

      for (const [index, administrativeInstance] of administrativeInstances.entries()) {
        try {
          console.info(
            `Copying/pasting description, sensitiveCase, location, territorialUnit, domain, subDomain, stakesDemand, stakesComment, provisionalExecution, sentenceAmount, sentenceDate from instance ${
              index + 1
            } / ${administrativeInstances.length}... ⏳`
          );

          const administrativeCase = await this.administrativeCaseRepo.findOne({
            where: { id: administrativeInstance.administrative_case.id },
          });
          await this.administrativeCaseRepo.update(administrativeCase.id, {
            description: administrativeInstances["deprecated_description"] ?? null,
            sensitiveCase: administrativeInstance.deprecated_sensitiveCase,
            location: administrativeInstance.location,
            territorialUnit: administrativeInstance.territorialUnit,
            domain: administrativeInstance.domain,
            subDomain: administrativeInstance.subDomain,
            deprecated_stakesDemand: administrativeInstance.deprecated_stakesDemand,
            deprecated_stakesComment: administrativeInstance.deprecated_stakesComment,
            deprecated_provisionalExecution: administrativeInstance.deprecated_provisionalExecution,
            deprecated_sentenceAmount: administrativeInstance.deprecated_sentenceAmount,
            deprecated_sentenceDate: administrativeInstance.deprecated_sentenceDate,
          });
        } catch (error) {
          console.error(`A problem occurred at instance ${administrativeInstance.id}`, error);
        }
      }
    } catch (error) {
      console.error(error);
    }
    console.info("All done 👌");
  }

  get administrativeInstanceRepo(): Repository<AdministrativeInstance> {
    return this.nest.get(getRepositoryToken(AdministrativeInstance));
  }

  get administrativeCaseRepo(): Repository<AdministrativeCase> {
    return this.nest.get(getRepositoryToken(AdministrativeCase));
  }
}

````


---

### 📄 `src/affaire/administratif/commons/commands/migrate-financial-stakes.cli.disabled` [6.930 octets]
<a id="src-affaire-administratif-commons-commands-migrate-financial-stakes-cli-disabled"></a> [↩ Retour à l'arborescence](#tree-src-affaire-administratif-commons-commands-migrate-financial-stakes-cli-disabled)

> **Chemin relatif** : `src/affaire/administratif/commons/commands/migrate-financial-stakes.cli.disabled`  
> **Taille** : 6.930 octets  
> **Lignes** : 172  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (172 lignes) - Cliquer pour déplier</summary>

````text
import { getRepositoryToken } from "@nestjs/typeorm";
import { AbstractNestCommand, Command } from "@pasta/cli";
import { Repository } from "typeorm";
import { Argv } from "yargs";

import { AdministrativeCase } from "@/affaire/administratif/commons/entities/administrative-case.entity";
import { StakesDetail } from "@/affaire/administratif/enjeux-financiers/details-des-enjeux/domain/stakes-detail.entity";
import { Provision } from "@/affaire/administratif/enjeux-financiers/provision/domain/provision.entity";
import { FinancialStakes } from "@/affaire/administratif/enjeux-financiers/root/domain/financial-stakes.entity";
import { AdministrativeInstance } from "@/affaire/administratif/instance/domain/administrative-instance.entity";

@Command
export class MigrateFinancialStakesCli extends AbstractNestCommand {
  name: string = "migrate-financial-stakes";
  description: string = "Migrate financial stakes from instance to legal case";
  arguments(yargs: Argv<{}>): Argv<{}> {
    return yargs;
  }

  async main(): Promise<void> {
    const errorMessages: string[] = [];

    try {
      await this.processProvisions(errorMessages);
      await this.processStakesDetails(errorMessages);
      await this.processStakesSummary(errorMessages);
    } catch (error) {
      console.error(error);
    }

    if (errorMessages.length > 0) {
      console.error("😐 Some errors occurred : ");
      errorMessages.forEach(message => console.error(message));
    } else {
      console.info("All done 👌");
    }
  }

  async processProvisions(errorMessages: string[]): Promise<void> {
    const provisions = await this.provisionRepo.find({
      relations: { administrativeInstance: true },
    });

    for (const [index, provision] of provisions.entries()) {
      console.info(`Adding provision ${index + 1}  / ${provisions.length} in case financial stakes... ⏳`);
      try {
        if (!provision.administrativeInstance?.id) {
          throw new Error(
            `No administrative Instance found for provision ${provision.id} (administrativeInstanceId:null)`
          );
        }
        await this.updateFinancialStakesForEntity(provision, this.provisionRepo);
      } catch (error) {
        errorMessages.push(`☎️ A problem occurred at provision ${provision.id} : ${error.message}`);
      }
    }
  }

  async processStakesDetails(errorMessages: string[]): Promise<void> {
    const stakesDetails = await this.stakesDetailsRepo.find({
      relations: { administrativeInstance: true },
    });
    for (const [index, stakesDetail] of stakesDetails.entries()) {
      console.info(`Adding stakesDetail ${index + 1}  / ${stakesDetails.length} in case financial stakes... ⏳`);
      try {
        if (!stakesDetail.administrativeInstance?.id) {
          throw new Error(
            `No administrative Instance found for provision ${stakesDetail.id} (administrativeInstanceId:null)`
          );
        }
        await this.updateFinancialStakesForEntity(stakesDetail, this.stakesDetailsRepo);
      } catch (error) {
        errorMessages.push(`☎️ A problem occurred at stakesDetail ${stakesDetail.id}, ${error.message}`);
      }
    }
  }

  async processStakesSummary(errorMessages: string[]): Promise<void> {
    const administrativeCases = await this.administrativeCaseRepo.find({
      relations: { financialStakes: true },
    });

    for (const [index, administrativeCase] of administrativeCases.entries()) {
      console.info(
        `Transferring stakes summary to financial stakes for case ${index + 1} / ${administrativeCases.length} ... ⏳`
      );
      try {
        await this.transferDataFromCaseToStakes(administrativeCase, errorMessages);
      } catch (error) {
        errorMessages.push(
          `☎️ A problem occurred in summary transfer at case ${administrativeCase.id}: ${error.message}`
        );
      }
    }
  }

  async updateFinancialStakesForEntity(
    entity: StakesDetail | Provision,
    entityRepo: Repository<StakesDetail | Provision>
  ): Promise<void> {
    const administrativeInstance = await this.administrativeInstanceRepo.findOne({
      where: { id: entity.administrativeInstance.id },
      relations: { administrative_case: true },
    });

    const administrativeCase = await this.administrativeCaseRepo.findOne({
      where: { id: administrativeInstance.administrative_case.id },
      relations: { financialStakes: true },
    });

    const financialStakes = await this.findOrCreateFinancialStakesForCase(administrativeCase);
    await entityRepo.update(entity.id, {
      financialStakes: financialStakes,
    });
  }

  async findOrCreateFinancialStakesForCase(administrativeCase: AdministrativeCase): Promise<FinancialStakes> {
    if (!administrativeCase.financialStakes?.id) {
      return this.financialStakesRepo.save(
        FinancialStakes.fromPlain({
          ...new FinancialStakes(),
          administrativeCaseId: administrativeCase.id,
        })
      );
    }
    return administrativeCase.financialStakes;
  }

  hasSummary(administrativeCase: AdministrativeCase): boolean {
    return (
      administrativeCase.deprecated_stakesDemand !== null ||
      administrativeCase.deprecated_provisionalExecution !== null ||
      administrativeCase.deprecated_stakesComment !== null ||
      administrativeCase.deprecated_sentenceAmount !== null ||
      administrativeCase.deprecated_sentenceDate !== null
    );
  }

  async transferDataFromCaseToStakes(administrativeCase: AdministrativeCase, errorMessages: string[]): Promise<void> {
    try {
      if (this.hasSummary(administrativeCase)) {
        const caseFinancialStakes = await this.findOrCreateFinancialStakesForCase(administrativeCase);
        await this.financialStakesRepo.update(caseFinancialStakes.id, {
          demand: administrativeCase.deprecated_stakesDemand,
          provisionalExecution: administrativeCase.deprecated_provisionalExecution,
          comments: administrativeCase.deprecated_stakesComment,
          sentenceAmount: administrativeCase.deprecated_sentenceAmount,
          sentenceDate: administrativeCase.deprecated_sentenceDate,
        });
      }
    } catch (error) {
      errorMessages.push(`☎️ A problem occurred at case ${administrativeCase.id}: ${error.message}`);
    }
  }

  get provisionRepo(): Repository<Provision> {
    return this.nest.get(getRepositoryToken(Provision));
  }
  get stakesDetailsRepo(): Repository<StakesDetail> {
    return this.nest.get(getRepositoryToken(StakesDetail));
  }
  get administrativeCaseRepo(): Repository<AdministrativeCase> {
    return this.nest.get(getRepositoryToken(AdministrativeCase));
  }
  get administrativeInstanceRepo(): Repository<AdministrativeInstance> {
    return this.nest.get(getRepositoryToken(AdministrativeInstance));
  }
  get financialStakesRepo(): Repository<FinancialStakes> {
    return this.nest.get(getRepositoryToken(FinancialStakes));
  }
}

````

</details>


---

### 📄 `src/affaire/administratif/commons/commands/migrate-instance-series-to-case-level.cli.disabled` [3.392 octets]
<a id="src-affaire-administratif-commons-commands-migrate-instance-series-to-case-level-cli-disabled"></a> [↩ Retour à l'arborescence](#tree-src-affaire-administratif-commons-commands-migrate-instance-series-to-case-level-cli-disabled)

> **Chemin relatif** : `src/affaire/administratif/commons/commands/migrate-instance-series-to-case-level.cli.disabled`  
> **Taille** : 3.392 octets  
> **Lignes** : 104  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (104 lignes) - Cliquer pour déplier</summary>

````text
import { getRepositoryToken } from "@nestjs/typeorm";
import { AbstractNestCommand, Command } from "@pasta/cli";
import { IsNull, Not, Repository } from "typeorm";
import { Argv } from "yargs";

import { SerieService } from "@/affaire/administratif/commons/services/serie.service";
import { AdministrativeInstance } from "@/affaire/administratif/instance/domain/administrative-instance.entity";

type InstancesCaseIdWithItsSerieId = {
  serieName: string;
  serieId: number;
  administrativeCaseId: number;
};

type InstancesCaseIdGroupedBySerieId = {
  serieId: number;
  serieName: string;
  administrativeCasesIds: number[];
};

@Command
export class MigrateInstanceSeriesToCaseLevelCli extends AbstractNestCommand {
  name: string = "migrate-instance-series-to-case";
  description: string = "Migrate instance series to case level";
  arguments(yargs: Argv<{}>): Argv<{}> {
    return yargs;
  }
  async main(): Promise<void> {
    try {
      const instancesWithTheirsSeries = await this.retrieveAllLinkedInstancesCasesIdsWithTheirSeries();
      console.info(`💡 found ${instancesWithTheirsSeries.length} instances with their series to migrate`);

      const groupedInstancesBySeriesIds = this._groupBySerieId(instancesWithTheirsSeries);

      for (const { serieId, administrativeCasesIds, serieName } of groupedInstancesBySeriesIds) {
        console.info(`💡 Currently linking administrativeCasesIds: ${administrativeCasesIds} to serieId: ${serieId}`);
        await this.serieService.executeUpdateASerie(serieId, { name: serieName, administrativeCasesIds });
      }

      console.info("All done 👌");
    } catch (error) {
      console.error("🛑 Some errors occurred : ", error);
    }
    return;
  }

  private async retrieveAllLinkedInstancesCasesIdsWithTheirSeries(): Promise<InstancesCaseIdWithItsSerieId[]> {
    return this.administrativeInstanceRepo
      .find({
        select: {
          administrative_case: {
            id: true,
          },
          deprecated_serie: {
            id: true,
          },
        },
        where: {
          administrative_case: {
            id: Not(IsNull()),
          },
          deprecated_serie: {
            id: Not(IsNull()),
          },
        },
        relations: ["administrative_case", "serie"],
      })
      .then(instances =>
        instances.map(({ deprecated_serie, administrative_case: administrativeCase }) => ({
          serieId: deprecated_serie.id,
          administrativeCaseId: administrativeCase.id,
          serieName: deprecated_serie.name,
        }))
      );
  }
  _groupBySerieId(input: InstancesCaseIdWithItsSerieId[]): InstancesCaseIdGroupedBySerieId[] {
    const groupedData = input.reduce(
      (acc, curr) => {
        if (!acc[curr.serieId]) {
          acc[curr.serieId] = {
            serieId: curr.serieId,
            serieName: curr.serieName,
            administrativeCasesIds: [],
          };
        }

        acc[curr.serieId].administrativeCasesIds.push(curr.administrativeCaseId);

        return acc;
      },
      {} as Record<number, InstancesCaseIdGroupedBySerieId>
    );

    return Object.values(groupedData);
  }
  get serieService(): SerieService {
    return this.nest.get(SerieService);
  }

  get administrativeInstanceRepo(): Repository<AdministrativeInstance> {
    return this.nest.get(getRepositoryToken(AdministrativeInstance));
  }
}

````

</details>


---

### 📄 `src/affaire/administratif/commons/commands/migrate-party.cli.ts.disabled` [1.772 octets]
<a id="src-affaire-administratif-commons-commands-migrate-party-cli-ts-disabled"></a> [↩ Retour à l'arborescence](#tree-src-affaire-administratif-commons-commands-migrate-party-cli-ts-disabled)

> **Chemin relatif** : `src/affaire/administratif/commons/commands/migrate-party.cli.ts.disabled`  
> **Taille** : 1.772 octets  
> **Lignes** : 53  
> **Type** : text

````text
import { getRepositoryToken } from "@nestjs/typeorm";
import { AbstractNestCommand, Command } from "@pasta/cli";
import { Repository } from "typeorm";
import { Argv } from "yargs";

import { Party } from "@/affaire/administratif/commons/entities/party.entity";
import { AdministrativeInstance } from "@/affaire/administratif/instance/domain/administrative-instance.entity";

@Command
export class MigratePartyCli extends AbstractNestCommand {
  name: string = "migrate-party";
  description: string = "Migrate parties from instance to legal case";
  arguments(yargs: Argv<{}>): Argv<{}> {
    return yargs;
  }

  async main(): Promise<void> {
    try {
      const parties = await this.partyRepo.find({
        relations: { administrativeInstance: true, administrativeCase: true },
      });

      for (const [index, party] of parties.entries()) {
        try {
          console.info(`Adding case in party ${index + 1} / ${parties.length}... ⏳`);

          const administrativeInstance = await this.administrativeInstanceRepo.findOne({
            where: { id: party.administrativeInstance.id },
            relations: { administrative_case: true },
          });

          await this.partyRepo.update(party.id, {
            administrativeCase: administrativeInstance.administrative_case,
          });
        } catch (error) {
          console.error(`A problem occurred at party ${party.id}`, error);
        }
      }
    } catch (error) {
      console.error(error);
    }
    console.info("All done 👌");
  }

  get administrativeInstanceRepo(): Repository<AdministrativeInstance> {
    return this.nest.get(getRepositoryToken(AdministrativeInstance));
  }

  get partyRepo(): Repository<Party> {
    return this.nest.get(getRepositoryToken(Party));
  }
}

````


---

### 📄 `src/affaire/administratif/commons/commands/migrate-procedureNature-from-instance-to-case.cli.disabled` [3.248 octets]
<a id="src-affaire-administratif-commons-commands-migrate-procedureNature-from-instance-to-case-cli-disabled"></a> [↩ Retour à l'arborescence](#tree-src-affaire-administratif-commons-commands-migrate-procedureNature-from-instance-to-case-cli-disabled)

> **Chemin relatif** : `src/affaire/administratif/commons/commands/migrate-procedureNature-from-instance-to-case.cli.disabled`  
> **Taille** : 3.248 octets  
> **Lignes** : 89  
> **Type** : text

````text
import { AbstractNestCommand, Command } from "@pasta/cli";
import { IsNull, Not } from "typeorm";
import { Argv } from "yargs";

import { AdministrativeCaseService } from "@/affaire/administratif/commons/services/administrative-case.service";
import { AdministrativeInstance } from "@/affaire/administratif/instance/domain/administrative-instance.entity";
import { InstanceState } from "@/affaire/administratif/instance/domain/administrative-instance.type";
import { AdministrativeInstanceService } from "@/affaire/administratif/instance/use-cases/administrative-instance.service";

@Command
export class MigrateProcedureNatureFromInstanceToCaseCli extends AbstractNestCommand {
  name: string = "migrate-procedure-nature";
  description: string = "Pasta command migrate procedure nature from administrativeInstance to administrativeCase";
  arguments(yargs: Argv<{}>): Argv<{}> {
    return yargs;
  }
  async main(): Promise<void> {
    const foundInstancesWithAppealTypes = await this.retrieveInstancesWithTheirProcedureNature();
    const { errorMessages } = await this.updateAdministrativeCases(foundInstancesWithAppealTypes);
    if (errorMessages.length > 0) {
      console.error("😐 Some errors occurred : ");
      errorMessages.forEach(message => console.error(message));
    } else {
      console.info("All done 👌");
    }
  }
  private async retrieveInstancesWithTheirProcedureNature(): Promise<AdministrativeInstance[]> {
    return this.administrativeInstanceService.repo.find({
      select: {
        id: true,
        administrative_case: {
          id: true,
        },
        deprecated_procedureNature: true,
      },
      where: {
        administrative_case: {
          id: Not(IsNull()),
        },
        deprecated_procedureNature: Not(IsNull()),
        state: InstanceState.ONGOING,
      },
      relations: ["administrative_case"],
    });
  }

  private async updateAdministrativeCases(
    administrativeInstances: AdministrativeInstance[]
  ): Promise<{ errorMessages: string[] }> {
    const errorMessages = [];
    if (!administrativeInstances.length) {
      return {
        errorMessages: [`☎️ No instance with procedureNature found to move`],
      };
    }

    for (const administrativeInstance of administrativeInstances) {
      console.info(
        `From ${administrativeInstance.id}, moving data to ${administrativeInstance.administrative_case.id} ... ⏳`
      );
      try {
        await this.administrativeCaseService.repo.update(
          {
            id: administrativeInstance.administrative_case.id,
          },
          {
            procedureNature: administrativeInstance.deprecated_procedureNature,
          }
        );
      } catch (error) {
        errorMessages.push(
          `☎️ A problem occurred when linking cases at instance ${administrativeInstance.id} and ${administrativeInstance.administrative_case.id} : ${error.message}`
        );
      }
    }
    return {
      errorMessages,
    };
  }

  get administrativeInstanceService(): AdministrativeInstanceService {
    return this.nest.get(AdministrativeInstanceService);
  }

  get administrativeCaseService(): AdministrativeCaseService {
    return this.nest.get(AdministrativeCaseService);
  }
}

````


---

### 📄 `src/affaire/administratif/commons/commands/move-linked-instances-to-cases-level.cli.disabled` [3.407 octets]
<a id="src-affaire-administratif-commons-commands-move-linked-instances-to-cases-level-cli-disabled"></a> [↩ Retour à l'arborescence](#tree-src-affaire-administratif-commons-commands-move-linked-instances-to-cases-level-cli-disabled)

> **Chemin relatif** : `src/affaire/administratif/commons/commands/move-linked-instances-to-cases-level.cli.disabled`  
> **Taille** : 3.407 octets  
> **Lignes** : 96  
> **Type** : text

````text
import { getRepositoryToken } from "@nestjs/typeorm";
import { AbstractNestCommand, Command } from "@pasta/cli";
import { IsNull, Not, Repository } from "typeorm";
import { Argv } from "yargs";

import { AdministrativeCaseService } from "@/affaire/administratif/commons/services/administrative-case.service";
import { AdministrativeInstance } from "@/affaire/administratif/instance/domain/administrative-instance.entity";

@Command
export class MigrateLinkedInstancesToCasesCli extends AbstractNestCommand {
  name: string = "migrate-linked-instances-to-cases";
  description: string = "Pasta command migrate linked instances to cases";
  arguments(yargs: Argv<{}>): Argv<{}> {
    return yargs;
  }

  async main(): Promise<void> {
    const { errorMessages } = await this.retrieveAllLinkedInstancesWithTheirCases().then(
      (foundInstances: AdministrativeInstance[]) => this.linkTheirCases(foundInstances)
    );
    if (errorMessages.length > 0) {
      console.error("😐 Some errors occurred : ");
      errorMessages.forEach(message => console.error(message));
    } else {
      console.info("All done 👌");
    }
  }

  get administrativeCaseService(): AdministrativeCaseService {
    return this.nest.get(AdministrativeCaseService);
  }

  get administrativeInstanceRepo(): Repository<AdministrativeInstance> {
    return this.nest.get(getRepositoryToken(AdministrativeInstance));
  }

  private async retrieveAllLinkedInstancesWithTheirCases(): Promise<AdministrativeInstance[]> {
    return this.administrativeInstanceRepo.find({
      select: {
        id: true,
        administrative_case: {
          id: true,
        },
        deprecated_linkedCases: {
          id: true,
          administrative_case: {
            id: true,
          },
        },
      },
      where: {
        administrative_case: {
          id: Not(IsNull()),
        },
        deprecated_linkedCases: {
          id: Not(IsNull()),
        },
      },
      relations: ["administrative_case", "linkedCases", "linkedCases.administrative_case"],
    });
  }
  private async linkTheirCases(
    administrativeInstances: AdministrativeInstance[]
  ): Promise<{ errorMessages: string[] }> {
    const errorMessages = [];
    if (!administrativeInstances.length) {
      return {
        errorMessages: [`☎️ No instance found with linked cases`],
      };
    }

    for (const administrativeInstance of administrativeInstances) {
      const linkedInstanceAdministrativeCasesIds = administrativeInstance.deprecated_linkedCases.map(
        c => c.administrative_case.id
      );
      console.info(`found linkedInstances ${administrativeInstance.deprecated_linkedCases.map(c => c.id)}  ... ⏳`);
      console.info(
        `From ${administrativeInstance.id}, linking ${administrativeInstance.administrative_case.id} and ${linkedInstanceAdministrativeCasesIds} ... ⏳`
      );
      try {
        await this.administrativeCaseService.linkAdministrativeCases(
          administrativeInstance.administrative_case.id,
          administrativeInstance.deprecated_linkedCases.map(c => c.administrative_case.id)
        );
      } catch (error) {
        errorMessages.push(
          `☎️ A problem occurred when linking cases at instance ${administrativeInstance.id} and ${linkedInstanceAdministrativeCasesIds} : ${error.message}`
        );
      }
    }
    return {
      errorMessages,
    };
  }
}

````


---

### 📄 `src/affaire/penal/procedure-step/legacy-penal-procedure-step.service.ts.backup` [15.341 octets]
<a id="src-affaire-penal-procedure-step-legacy-penal-procedure-step-service-ts-backup"></a> [↩ Retour à l'arborescence](#tree-src-affaire-penal-procedure-step-legacy-penal-procedure-step-service-ts-backup)

> **Chemin relatif** : `src/affaire/penal/procedure-step/legacy-penal-procedure-step.service.ts.backup`  
> **Taille** : 15.341 octets  
> **Lignes** : 427  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (427 lignes) - Cliquer pour déplier</summary>

````text
import { BadRequestException, Injectable, NotFoundException } from "@nestjs/common";
import { InjectRepository } from "@nestjs/typeorm";
import { DeepPartial, EntityManager, In, Repository } from "typeorm";
import { PenalCaseEntity } from "../root/entities/penal-case.entity";
import { PenalCaseService } from "../root/penal-case.service";
import { PaginatedResult } from "../root/types/paginated-result.interface";
import { PenalProcedureStepDtoByStage } from "./dto/create-penal-procedure-step.dto";
import { UpdatePenalProcedureStepDto } from "./dto/update-penal-procedure-step.dto";
import { PenalProcedureStepEntity } from "./entities/penal-procedure-step.entity";

import { CreateOrExistingPenalAttachmentItemDto } from "@/affaire/penal/attachment/create-penal-attachment.dto";
import { PenalAttachmentService } from "@/affaire/penal/attachment/penal-attachment.service";
import { PenalStage } from "@/affaire/penal/constants/penal-stages";
import { PenalLitigantEntity } from "@/affaire/penal/litigant/entities/penal-litigant.entity";
import { ProcedureStepQueryDto } from "@/affaire/penal/procedure-step/dto/procedure-step-query.dto";
import { hasLitigants } from "@/affaire/penal/procedure-step/dto/with-litigants.interface";
import { OffenseReportPenalProcedureStepEntity } from "@/affaire/penal/procedure-step/entities/offense-report-penal-procedure-step.entity";
import { PenalProcedureStepEntityFactory } from "@/affaire/penal/procedure-step/factory/penal-procedure-step-entity.factory";
import { OffenseReportPenalProcedureStepService } from "@/affaire/penal/procedure-step/services/offense-report-penal-procedure-step.service";
import { paginate } from "@/affaire/shared/pagination.util";
import { parseSortQuery } from "@/affaire/shared/parse-sort-query.util";

type SortOrder = "ASC" | "DESC";
type OrderMap = Record<string, SortOrder>;

@Injectable()
export class LegacyPenalProcedureStepService {
  constructor(
    @InjectRepository(PenalProcedureStepEntity) public repo: Repository<PenalProcedureStepEntity>,
    @InjectRepository(PenalLitigantEntity) private readonly penalLitigantRepo: Repository<PenalLitigantEntity>,
    private penalCaseService: PenalCaseService,
    private penalAttachmentService: PenalAttachmentService,
    private offenseReportService: OffenseReportPenalProcedureStepService
  ) {}

  async create(
    penalCaseId: number,
    createDto: PenalProcedureStepDtoByStage<PenalStage>
  ): Promise<PenalProcedureStepEntity> {
    const penalCase = await this.getPenalCase(penalCaseId);
    const relatedEntities = this.offenseReportService.validateRequiredLinkedEntities(createDto);
    const { attachments, ...dtoProps } = createDto;

    return this.repo.manager.transaction(async transactionalEntityManager => {
      const currentLatestStep = await this.findCurrentLatestStep(penalCaseId, transactionalEntityManager);
      const procedureStep = await this.prepareProcedureStep(dtoProps, penalCase);

      await this.handleLitigants(
        dtoProps as PenalProcedureStepDtoByStage<PenalStage>,
        procedureStep,
        transactionalEntityManager
      );

      const savedProcedureStep = await transactionalEntityManager.save(PenalProcedureStepEntity, procedureStep);

      await this.offenseReportService.handleRelatedEntities(
        createDto,
        savedProcedureStep,
        relatedEntities,
        transactionalEntityManager
      );

      await this.updatePreviousLatestStep(currentLatestStep, transactionalEntityManager);

      const attachmentResult = await this.handleAttachments(
        attachments,
        penalCaseId,
        savedProcedureStep,
        transactionalEntityManager
      );

      return this.reloadWithRelations(attachmentResult.id, transactionalEntityManager);
    });
  }

  async update(
    penalCaseId: number,
    id: number,
    updateDto: UpdatePenalProcedureStepDto
  ): Promise<PenalProcedureStepEntity> {
    await this.getPenalCase(penalCaseId);
    const relatedEntities = this.offenseReportService.validateRequiredLinkedEntities(updateDto);

    const procedureStep = await this.findOne(penalCaseId, id);
    this.validateProcedureStep(procedureStep, id, penalCaseId, updateDto.stage);

    const { attachments, ...dtoProps } = updateDto;

    return this.repo.manager.transaction(async transactionalEntityManager => {
      const updatedProcedureStep = await this.prepareUpdatedProcedureStep(procedureStep, dtoProps);

      await this.handleLitigants(
        updateDto as PenalProcedureStepDtoByStage<PenalStage>,
        updatedProcedureStep,
        transactionalEntityManager
      );

      await this.offenseReportService.handleRelatedEntities(
        updateDto,
        updatedProcedureStep,
        relatedEntities,
        transactionalEntityManager
      );

      const savedProcedureStep = await transactionalEntityManager.save(PenalProcedureStepEntity, updatedProcedureStep);

      if (attachments) {
        await this.handleAttachments(attachments, penalCaseId, savedProcedureStep, transactionalEntityManager);
      }

      return this.reloadWithRelations(savedProcedureStep.id, transactionalEntityManager);
    });
  }

  async deleteMultipleSteps(penalCaseId: number, stepIds: number[]): Promise<void> {
    await this.getPenalCase(penalCaseId);

    await this.repo.manager.transaction(async entityManager => {
      const stepsToDelete = await entityManager.find(PenalProcedureStepEntity, {
        where: {
          id: In(stepIds),
          penalCase: { id: penalCaseId },
        },
      });

      if (stepsToDelete.length > 0) {
        await entityManager.remove(stepsToDelete);
      }
    });

    await this.updateLatestStepAfterDeletion(penalCaseId);
  }

  async findOne(penalCaseId: number, id: number): Promise<PenalProcedureStepEntity | null> {
    return this.repo.findOne({
      where: { id, penalCase: { id: penalCaseId } },
      relations: [
        "attachments",
        "litigants",
        "penalCase",
        "offenseReportMunicipalities",
        "offenseReportMunicipalities.plots",
        "offenseReportInfractions",
      ],
    });
  }

  async getPaginatedProcedureSteps(
    penalCaseId: number,
    procedureStepQueryDto: ProcedureStepQueryDto = { page: 1, limit: 10 }
  ): Promise<PaginatedResult<PenalProcedureStepEntity>> {
    const { page, limit, stage, litigantId } = procedureStepQueryDto;
    const offset = (page - 1) * limit;
    const sortParam = procedureStepQueryDto.sort;
    let orderBy: OrderMap | undefined = undefined;

    if (sortParam) {
      const [column, order] = parseSortQuery(sortParam);
      const entityColumns = this.repo.metadata.columns.map(col => col.propertyName);
      if (!entityColumns.includes(column)) {
        throw new BadRequestException(`Invalid sort column: ${column}`);
      }
      orderBy = { [column]: order };
    }

    if (litigantId) {
      await this.assertLitigantExistsAndBelongsToPenalCase(penalCaseId, litigantId);
    }

    const whereClause = this.buildWhereClause(penalCaseId, stage, litigantId);
    const [procedureSteps, total] = await this.fetchProcedureStepsWithCount(whereClause, offset, limit, orderBy);

    const totalPages = Math.ceil(total / limit);
    this.validatePageExists(page, totalPages);

    const paginationInfo = paginate(page, limit, total);
    const finalProcedureSteps = this.applyPaginationLimits(procedureSteps, paginationInfo.hasNextPage);

    return {
      data: finalProcedureSteps,
      total,
      page,
      limit,
      offset: paginationInfo.offset,
      isLastPage: paginationInfo.isLastPage,
      totalPages,
    };
  }

  private buildWhereClause(penalCaseId: number, stage?: PenalStage, litigantId?: number): object {
    const whereClause: Record<string, unknown> = {
      penalCase: { id: penalCaseId },
    };

    if (stage) {
      whereClause.stage = stage;
    }

    if (litigantId) {
      whereClause.litigants = { id: litigantId };
    }

    return whereClause;
  }

  private async fetchProcedureStepsWithCount(
    whereClause: object,
    offset: number,
    limit: number,
    orderBy?: OrderMap
  ): Promise<[PenalProcedureStepEntity[], number]> {
    const defaultOrder: OrderMap = { id: "DESC" };
    const orderOption = orderBy && Object.keys(orderBy).length > 0 ? orderBy : defaultOrder;

    return this.repo.findAndCount({
      where: whereClause,
      relations: [
        "attachments",
        "litigants",
        "requestingService",
        "managingDepartmentPerson",
        "offenseReportMunicipalities",
        "offenseReportMunicipalities.plots",
        "offenseReportInfractions",
        "attachments.tags",
      ],
      skip: offset,
      take: limit + 1,
      order: orderOption,
    });
  }

  private validatePageExists(page: number, totalPages: number): void {
    if (page > totalPages && page !== 1 && totalPages !== 0) {
      throw new NotFoundException(`Page ${page} does not exist. Total pages: ${totalPages}`);
    }
  }

  private applyPaginationLimits(
    procedureSteps: PenalProcedureStepEntity[],
    hasNextPage: boolean
  ): PenalProcedureStepEntity[] {
    const steps = hasNextPage && procedureSteps.length > 0 ? procedureSteps.slice(0, -1) : procedureSteps;

    return this.sortRelatedEntities(steps);
  }

  private sortRelatedEntities(
    procedureSteps: (PenalProcedureStepEntity | OffenseReportPenalProcedureStepEntity)[]
  ): (PenalProcedureStepEntity | OffenseReportPenalProcedureStepEntity)[] {
    return procedureSteps.map(step => {
      if (step instanceof OffenseReportPenalProcedureStepEntity) {
        if (step.offenseReportInfractions) {
          step.offenseReportInfractions.sort((a, b) => a.id - b.id);
        }
        if (step.offenseReportMunicipalities) {
          step.offenseReportMunicipalities.sort((a, b) => a.id - b.id);
        }
        if (step.offenseReportStakes) {
          step.offenseReportStakes.sort((a, b) => a.id - b.id);
        }
      }
      return step;
    });
  }

  private async findCurrentLatestStep(
    penalCaseId: number,
    entityManager: EntityManager
  ): Promise<PenalProcedureStepEntity | null> {
    return entityManager.findOne(PenalProcedureStepEntity, {
      where: { penalCase: { id: penalCaseId }, isLatestStep: true },
    });
  }

  private async updateLatestStepAfterDeletion(penalCaseId: number): Promise<void> {
    const latestStep = await this.repo.findOne({
      where: { penalCase: { id: penalCaseId } },
      order: { id: "DESC" },
    });

    if (latestStep) {
      latestStep.isLatestStep = true;
      await this.repo.save(latestStep);
    }
  }

  private async getPenalCase(penalCaseId: number): Promise<PenalCaseEntity> {
    const penalCase = await this.penalCaseService.penalCaseRepository.findOne({ where: { id: penalCaseId } });
    if (!penalCase) {
      throw new NotFoundException(`Dossier pénal avec ID ${penalCaseId} non trouvé`);
    }
    return penalCase;
  }

  private validateProcedureStep(
    procedureStep: PenalProcedureStepEntity | null,
    id: number,
    penalCaseId: number,
    newStage: PenalStage
  ): void {
    if (!procedureStep) {
      throw new NotFoundException(`Étape de procédure avec ID ${id} non trouvée pour le dossier pénal ${penalCaseId}`);
    }

    if (procedureStep.stage !== newStage) {
      throw new BadRequestException(
        `L'étape de procédure ne peut pas être modifiée de ${procedureStep.stage} à ${newStage}`
      );
    }
  }

  private async prepareProcedureStep(
    dtoProps: Partial<PenalProcedureStepDtoByStage<PenalStage>>,
    penalCase: PenalCaseEntity
  ): Promise<PenalProcedureStepEntity> {
    const entityData = PenalProcedureStepEntityFactory.createDeepPartial(dtoProps.stage!, {
      ...dtoProps,
      penalCase,
      isLatestStep: true,
    });

    this.assignRelationReferences(entityData, dtoProps);
    return this.repo.create(entityData);
  }

  private async prepareUpdatedProcedureStep(
    procedureStep: PenalProcedureStepEntity,
    dtoProps: Partial<PenalProcedureStepDtoByStage<PenalStage>>
  ): Promise<PenalProcedureStepEntity> {
    const updatedData = PenalProcedureStepEntityFactory.createDeepPartial(dtoProps.stage!, dtoProps);
    this.assignRelationReferences(updatedData, dtoProps);
    return this.repo.merge(procedureStep, updatedData);
  }

  private async handleLitigants(
    dto: PenalProcedureStepDtoByStage<PenalStage>,
    procedureStep: PenalProcedureStepEntity,
    entityManager: EntityManager
  ): Promise<void> {
    if (!hasLitigants(dto)) {
      return;
    }

    const litigantIds = dto.litigants;
    if (Array.isArray(litigantIds) && litigantIds.length === 0) {
      (procedureStep as unknown as Record<string, unknown>).litigants = [];
      return;
    }

    const litigantEntities = await entityManager.find(PenalLitigantEntity, {
      where: { id: In(litigantIds) },
    });

    if (litigantEntities.length > 0) {
      (procedureStep as unknown as Record<string, unknown>).litigants = litigantEntities;
    }
  }

  private async handleAttachments(
    attachments: CreateOrExistingPenalAttachmentItemDto[],
    penalCaseId: number,
    savedProcedureStep: PenalProcedureStepEntity,
    entityManager: EntityManager
  ): Promise<PenalProcedureStepEntity> {
    if (!attachments || attachments.length === 0) {
      return savedProcedureStep;
    }

    try {
      savedProcedureStep.attachments = await this.penalAttachmentService.createForProcedureStep(
        penalCaseId,
        attachments,
        entityManager,
        savedProcedureStep.id
      );
      return entityManager.save(PenalProcedureStepEntity, savedProcedureStep);
    } catch (error) {
      throw error instanceof NotFoundException ? error : new Error(`Failed to create attachments: ${error.message}`);
    }
  }

  private async updatePreviousLatestStep(
    currentLatestStep: PenalProcedureStepEntity | null,
    entityManager: EntityManager
  ): Promise<void> {
    if (currentLatestStep) {
      await entityManager.save(PenalProcedureStepEntity, {
        ...currentLatestStep,
        isLatestStep: false,
      });
    }
  }

  private async assertLitigantExistsAndBelongsToPenalCase(penalCaseId: number, litigantId: number): Promise<void> {
    const litigantExists = await this.penalLitigantRepo.exists({
      where: { id: litigantId, penalCase: { id: penalCaseId } },
    });

    if (!litigantExists) {
      throw new NotFoundException(`Litigant with id ${litigantId} does not belong to penal case ${penalCaseId}`);
    }
  }

  private async reloadWithRelations(stepId: number, entityManager: EntityManager): Promise<PenalProcedureStepEntity> {
    return entityManager.findOne(PenalProcedureStepEntity, {
      where: { id: stepId },
      relations: [
        "attachments",
        "litigants",
        "penalCase",
        "offenseReportMunicipalities",
        "offenseReportMunicipalities.plots",
        "offenseReportInfractions",
      ],
    });
  }
  private assignRelationReferences(
    procedureStepData: DeepPartial<PenalProcedureStepEntity>,
    dtoProps: Partial<PenalProcedureStepDtoByStage<PenalStage>>
  ): void {
    if ("managingDepartmentPersonId" in dtoProps && dtoProps.managingDepartmentPersonId) {
      procedureStepData["managingDepartmentPerson"] = { id: dtoProps.managingDepartmentPersonId as unknown as number };
    }
  }
}

````

</details>


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

`````

</details>


---

### 📄 `si/meridienne.wiki.md` [202.076 octets]
<a id="si-meridienne-wiki-md"></a> [↩ Retour à l'arborescence](#tree-si-meridienne-wiki-md)

> **Chemin relatif** : `si/meridienne.wiki.md`  
> **Taille** : 202.076 octets  
> **Lignes** : 6069  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (6069 lignes) - Cliquer pour déplier</summary>

`````markdown
﻿# Projet : meridienne.wiki

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\meridienne.wiki`

**Fichiers** : 59 fichiers non-binaires

## 📁 Arborescence des fichiers

├── **Notes-d'installation/**
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-5-2-md"></a>[Note-d'installation-v1.5.2.md](#Notes-d'installation-Note-d'installation-v1-5-2-md) *(2.304 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-5-3-md"></a>[Note-d'installation-v1.5.3.md](#Notes-d'installation-Note-d'installation-v1-5-3-md) *(2.390 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-5-4-md"></a>[Note-d'installation-v1.5.4.md](#Notes-d'installation-Note-d'installation-v1-5-4-md) *(2.291 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-5-5-md"></a>[Note-d'installation-v1.5.5.md](#Notes-d'installation-Note-d'installation-v1-5-5-md) *(2.670 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-5-6-md"></a>[Note-d'installation-v1.5.6.md](#Notes-d'installation-Note-d'installation-v1-5-6-md) *(2.547 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-0-md"></a>[Note-d'installation-v1.6.0.md](#Notes-d'installation-Note-d'installation-v1-6-0-md) *(2.307 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-1-md"></a>[Note-d'installation-v1.6.1.md](#Notes-d'installation-Note-d'installation-v1-6-1-md) *(2.325 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-10-md"></a>[Note-d'installation-v1.6.10.md](#Notes-d'installation-Note-d'installation-v1-6-10-md) *(2.440 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-11-md"></a>[Note-d'installation-v1.6.11.md](#Notes-d'installation-Note-d'installation-v1-6-11-md) *(2.145 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-12-md"></a>[Note-d'installation-v1.6.12.md](#Notes-d'installation-Note-d'installation-v1-6-12-md) *(2.131 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-13-md"></a>[Note-d'installation-v1.6.13.md](#Notes-d'installation-Note-d'installation-v1-6-13-md) *(2.080 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-14-md"></a>[Note-d'installation-v1.6.14.md](#Notes-d'installation-Note-d'installation-v1-6-14-md) *(1.999 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-15-md"></a>[Note-d'installation-v1.6.15.md](#Notes-d'installation-Note-d'installation-v1-6-15-md) *(2.252 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-16-md"></a>[Note-d'installation-v1.6.16.md](#Notes-d'installation-Note-d'installation-v1-6-16-md) *(2.183 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-17-md"></a>[Note-d'installation-v1.6.17.md](#Notes-d'installation-Note-d'installation-v1-6-17-md) *(2.044 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-18-md"></a>[Note-d'installation-v1.6.18.md](#Notes-d'installation-Note-d'installation-v1-6-18-md) *(2.069 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-19-md"></a>[Note-d'installation-v1.6.19.md](#Notes-d'installation-Note-d'installation-v1-6-19-md) *(2.200 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-2-md"></a>[Note-d'installation-v1.6.2.md](#Notes-d'installation-Note-d'installation-v1-6-2-md) *(2.513 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-20-md"></a>[Note-d'installation-v1.6.20.md](#Notes-d'installation-Note-d'installation-v1-6-20-md) *(2.190 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-21-md"></a>[Note-d'installation-v1.6.21.md](#Notes-d'installation-Note-d'installation-v1-6-21-md) *(2.059 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-22-md"></a>[Note-d'installation-v1.6.22.md](#Notes-d'installation-Note-d'installation-v1-6-22-md) *(2.432 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-23-md"></a>[Note-d'installation-v1.6.23.md](#Notes-d'installation-Note-d'installation-v1-6-23-md) *(2.119 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-24-md"></a>[Note-d'installation-v1.6.24.md](#Notes-d'installation-Note-d'installation-v1-6-24-md) *(2.146 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-25-md"></a>[Note-d'installation-v1.6.25.md](#Notes-d'installation-Note-d'installation-v1-6-25-md) *(2.210 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-26-md"></a>[Note-d'installation-v1.6.26.md](#Notes-d'installation-Note-d'installation-v1-6-26-md) *(2.114 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-27-md"></a>[Note-d'installation-v1.6.27.md](#Notes-d'installation-Note-d'installation-v1-6-27-md) *(2.143 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-28-md"></a>[Note-d'installation-v1.6.28.md](#Notes-d'installation-Note-d'installation-v1-6-28-md) *(2.210 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-29-md"></a>[Note-d'installation-v1.6.29.md](#Notes-d'installation-Note-d'installation-v1-6-29-md) *(2.144 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-3-md"></a>[Note-d'installation-v1.6.3.md](#Notes-d'installation-Note-d'installation-v1-6-3-md) *(2.088 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-30-md"></a>[Note-d'installation-v1.6.30.md](#Notes-d'installation-Note-d'installation-v1-6-30-md) *(2.167 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-31-md"></a>[Note-d'installation-v1.6.31.md](#Notes-d'installation-Note-d'installation-v1-6-31-md) *(2.161 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-32-md"></a>[Note-d'installation-v1.6.32.md](#Notes-d'installation-Note-d'installation-v1-6-32-md) *(2.140 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-33-md"></a>[Note-d'installation-v1.6.33.md](#Notes-d'installation-Note-d'installation-v1-6-33-md) *(2.129 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-34-md"></a>[Note-d'installation-v1.6.34.md](#Notes-d'installation-Note-d'installation-v1-6-34-md) *(2.872 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-35-md"></a>[Note-d'installation-v1.6.35.md](#Notes-d'installation-Note-d'installation-v1-6-35-md) *(2.699 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-36-md"></a>[Note-d'installation-v1.6.36.md](#Notes-d'installation-Note-d'installation-v1-6-36-md) *(2.324 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-37-md"></a>[Note-d'installation-v1.6.37.md](#Notes-d'installation-Note-d'installation-v1-6-37-md) *(2.087 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-38-md"></a>[Note-d'installation-v1.6.38.md](#Notes-d'installation-Note-d'installation-v1-6-38-md) *(2.013 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-39-md"></a>[Note-d'installation-v1.6.39.md](#Notes-d'installation-Note-d'installation-v1-6-39-md) *(2.186 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-4-md"></a>[Note-d'installation-v1.6.4.md](#Notes-d'installation-Note-d'installation-v1-6-4-md) *(1.997 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-40-md"></a>[Note-d'installation-v1.6.40.md](#Notes-d'installation-Note-d'installation-v1-6-40-md) *(2.223 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-42-md"></a>[Note-d'installation-v1.6.42.md](#Notes-d'installation-Note-d'installation-v1-6-42-md) *(2.134 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-43-md"></a>[Note-d'installation-v1.6.43.md](#Notes-d'installation-Note-d'installation-v1-6-43-md) *(1.965 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-44-md"></a>[Note-d'installation-v1.6.44.md](#Notes-d'installation-Note-d'installation-v1-6-44-md) *(2.522 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-45-md"></a>[Note-d'installation-v1.6.45.md](#Notes-d'installation-Note-d'installation-v1-6-45-md) *(2.060 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-5-md"></a>[Note-d'installation-v1.6.5.md](#Notes-d'installation-Note-d'installation-v1-6-5-md) *(1.989 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-6-md"></a>[Note-d'installation-v1.6.6.md](#Notes-d'installation-Note-d'installation-v1-6-6-md) *(2.873 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-7-md"></a>[Note-d'installation-v1.6.7.md](#Notes-d'installation-Note-d'installation-v1-6-7-md) *(2.148 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-8-md"></a>[Note-d'installation-v1.6.8.md](#Notes-d'installation-Note-d'installation-v1-6-8-md) *(2.168 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v1-6-9-md"></a>[Note-d'installation-v1.6.9.md](#Notes-d'installation-Note-d'installation-v1-6-9-md) *(2.129 octets)*
│   ├── <a id="tree-Notes-d'installation-Note-d'installation-v2-0-0-(PHP8-3)-md"></a>[Note-d'installation-v2.0.0-(PHP8.3).md](#Notes-d'installation-Note-d'installation-v2-0-0-(PHP8-3)-md) *(1.833 octets)*
│   ├── <a id="tree-Notes-d'installation-Notes-d'installation-v1-6-41-md"></a>[Notes-d'installation-v1.6.41.md](#Notes-d'installation-Notes-d'installation-v1-6-41-md) *(2.028 octets)*
│   └── <a id="tree-Notes-d'installation-Template-Note-d'installation-vX-Y-Z-md"></a>[Template-Note-d'installation-vX.Y.Z.md](#Notes-d'installation-Template-Note-d'installation-vX-Y-Z-md) *(3.106 octets)*
├── **Opérations-techniques/**
│   ├── <a id="tree-Opérations-techniques-Backup-base-de-données-md"></a>[Backup-base-de-données.md](#Opérations-techniques-Backup-base-de-données-md) *(516 octets)*
│   └── <a id="tree-Opérations-techniques-Backup-données-applicatives-md"></a>[Backup-données-applicatives.md](#Opérations-techniques-Backup-données-applicatives-md) *(577 octets)*
├── <a id="tree-Généralités-sur-le-déploiement-d'une-livraison-MERIDIENNE-md"></a>[Généralités-sur-le-déploiement-d'une-livraison-MERIDIENNE.md](#Généralités-sur-le-déploiement-d'une-livraison-MERIDIENNE-md) *(12.050 octets)*
├── <a id="tree-Home-md"></a>[Home.md](#Home-md) *(15.480 octets)*
├── <a id="tree-Manuel-d'installation-Méridienne-(PHP8-3)-MI-v1-0-0-md"></a>[Manuel-d'installation-Méridienne-(PHP8.3)-MI-v1.0.0.md](#Manuel-d'installation-Méridienne-(PHP8-3)-MI-v1-0-0-md) *(3.852 octets)*
└── <a id="tree-Meridienne-Fiche-Applicative-md"></a>[Meridienne-Fiche-Applicative.md](#Meridienne-Fiche-Applicative-md) *(6.777 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `Généralités-sur-le-déploiement-d'une-livraison-MERIDIENNE.md` [12.050 octets]
<a id="Généralités-sur-le-déploiement-d'une-livraison-MERIDIENNE-md"></a> [↩ Retour à l'arborescence](#tree-Généralités-sur-le-déploiement-d'une-livraison-MERIDIENNE-md)

> **Chemin relatif** : `Généralités-sur-le-déploiement-d'une-livraison-MERIDIENNE.md`  
> **Taille** : 12.050 octets  
> **Lignes** : 214  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (214 lignes) - Cliquer pour déplier</summary>

````markdown
# Environnements :

L'application MERIDIENNE est présente sur deux environnements : PRE-PRODUCTION et PRODUCTION. Nous ne pouvons pas nous connecter en ssh sur les serveurs de ces environnements.

Nous avons :

* un accès direct par SFTP au serveur de PRE-PRODUCTION uniquement. Le serveur de PRODUCTION n'est PAS accessible par SFTP. Les serveurs sont hébergés chez un prestataire externe : ATE.
* accès aux BDD des deux environnements (PRE-PRODUCTION et PRODUCTION) avec phpMyAdmin.

## Tableau récapitulatif des environnements MERIDIENNE

| Environnement | URL Application | URL BDD |
|---------------|-----------------|---------|
| PRE-PRODUCTION PHP 5.6| http://meridienne.preprod.e2.rie.gouv.fr/ | Voir [Passbolt](https://passbolt.pnm3.e2.rie.gouv.fr) du GTI |
| PRODUCTION PHP 5.6| https://www.meridienne.developpement-durable.gouv.fr/ | Voir [Passbolt](https://passbolt.pnm3.e2.rie.gouv.fr) du GTI |
| PRE-PRODUCTION PHP 8.3| http://meridienne-ng-preprod.ate.e2.rie.gouv.fr/ | Voir [Passbolt](https://passbolt.pnm3.e2.rie.gouv.fr) du GTI |
| PRODUCTION PHP 8.3| www.meridienne-ng.developpement-durable.gouv.fr/ | Voir [Passbolt](https://passbolt.pnm3.e2.rie.gouv.fr) du GTI |

Les logins sont à récupérer sur le [Passbolt](https://passbolt.pnm3.e2.rie.gouv.fr) du GTI.

# Principes d'installation et de mise à jour

## Partie Applicative

<details>
<summary>Cliquer pour afficher</summary>
Les fichiers de la partie applicative sont d'abord déployés en Pré-Production à l'aide d'un outil tel que WinSCP ou FileZilla. Le déploiement en Production se fait par synchonisation à partir de la Pré-Production.Nous utilisons essentiellement deux types de synchronisation :

* <ins>Synchronisation globale</ins> : SYNCFULL

Cette action permet de lancer une synchronisation complète de tous les fichiers et répertoires de l'application à l'exception d'une liste prédéfinie d'exclusions définie dans un fichier nommé "config".Pour effectuer la synchronisation, il faut déposer dans le répertoire "ACTIONS" un fichier nommé "SYNCFULL". Son contenu n'a pas d'importance.ATTENTION : le nom du fichier (SYNCFULL) doit obligatoirement être écrit en majuscules.Un robot vérifie la présence de ce fichier toutes les 5 minutes. Une fois détecté, le mécanisme de synchronisation est enclenché. Le fichier "SYNCFULL" est renommé en "SYNCFULL.done" préfixé par la date et l'heure et contenant le résultat de la synchronisation.

* <ins>Synchronisation de fichiers spécifiques</ins> : SYNCSPECIFIC

Cette action permet de synchroniser uniquement des fichiers ou des répertoires choisis.Cette action ignore la liste d'exclusion "SYNCFULL_EXCLUDE_LIST".Pour effectuer la synchronisation, il faut déposer dans le répertoire "ACTIONS" un fichier appelé "SYNCSPECIFIC" en y indiquant un nom de fichier ou répertoire par ligne avec des "/" entre le nom des répertoires. L'emplacement des fichiers et répertoires à synchroniser est défini à partir de la racine du répertoire "htdocs".ATTENTION : le nom du fichier (SYNCSPECIFIC) doit obligatoirement être écrit en majuscules.
</details>

## Partie Base de données

Les BDD de Pré-Production et de Production sont mises à jour par exécution de requêtes SQL à partir de phpMyAdmin. Les éléments permettant de se connecter aux bases (URL et logins) sont à récupérer sur le [Passbolt](https://passbolt.pnm3.e2.rie.gouv.fr) du GTI.

:warning: Dans les fichiers sql fournis dans les livraisons, il faut **adapter les adresses IP qui apparaissent à l'environnement à modifier**

Avant de mettre à jour les BDD, il est fortement recommandé de les sauvegarder.

# Notes d'installation :

Chaque livraison s'accompagne d'une note d'installation, disponible dans le wiki MERIDIENNE. Les notes d'installation indiquent où récupérer la livraison, les fichiers/répertoires à déployer ainsi que les éventuels scripts SQL à exécuter. Chaque note d'installation est identifiée par le numéro de version de la livraison dont elle dépend.

ex. : [Note d'installation de la version v1.6.10](https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/produits/rh/meridienne/-/wikis/Notes-d'installation/Note-d'installation-v1.6.10)

# Récupérer la livraison :

La livraison est disponible  dans GitLab au niveau de **"Code/Tags/x.y.z-LIVREE"** ou "Repository/Tags/x.y.z-LIVREE" ("vx.y.z" étant le numéro de version de la livraison) du projet de l'application. Pour télécharger la livraison, cliquer sur le bouton de téléchargement/download situé à droite sur la ligne de la livraison désirée.

# Déploiement en Pré-Production

### Demande d'installation

Habituellement la demande d'installation est faite dans GitLab.

### Préparation

<details>
<summary>Une fois la demande reçue, il faut :</summary>

* Prendre connaissance de la note d'installation liée à l'installation
* Décompresser la livraison sur un poste local

</details>

### Déploiement partie applicative en Pré-Production

<details>
<summary>Pour déployer la partie applicative, il faut :</summary>

* Se connecter au serveur de Pré-Production avec un outil de transfert de fichiers (ex. : WinSCP) (Les logins sont à récupérer sur le [Passbolt](https://passbolt.pnm3.e2.rie.gouv.fr) du GTI.)
* Vérifier que l'application fonctionne
* Sauvegarder en local au moins les répertoires et fichiers qui vont être modifiés (voir détails dans la note d’installation propre à la version à installer) ou bien le répertoire "/web" en entier (opération longue : au moins 30 mn)
* Déployer les fichiers indiqués dans la note d'installation
* Vérifier que l'application fonctionne
* Si aucune requête SQL ne doit être exécutée, mettre à jour la version dans la fiche applicative et prévenir le demandeur que l'installation est terminée. Sinon, passer à la partie "Déploiement partie BDD en Pré-Production".

</details>

:warning: : Les **droits des répertoires et des fichiers contenus dans "web/document"** doivent être en 0777 (rwxrwxrwx). (Information fournie par Cédric Chapé dans les tickets Redmine #21422 et Redmine #21435)

### Déploiement partie BDD en Pré-Production

La note d'installation indique si des requêtes SQL doivent être passées, ainsi qu'un moyen de vérifier que leur exécution donne le résultat attendu.

<details>
<summary>Pour exécuter des requêtes SQL, il faut :</summary>

* Se connecter avec phphMyAdmin à la base de données de Pré-Production (Les éléments permettant de se connecter aux bases, URL et logins, sont à récupérer sur le [Passbolt](https://passbolt.pnm3.e2.rie.gouv.fr) du GTI.)
* **Sauvegarder la structure** de la base de données à l'aide d'une exportation personnalisée

<details>
<summary>(Afficher options d'export)</summary>

![Export_BDD_18](uploads/2184858652d00ddbd807dcacdab54872/Export_BDD_18.JPG)

![Export_BDD_24](uploads/4b1cf1346dfe0ba8a58360c4db4d425d/Export_BDD_24.JPG)

</details>


* **Sauvegarder les données** de la base de données à l'aide d'une exportation personnalisée

<details>
<summary>(Afficher options d'export)</summary>

![Export_BDD_29](uploads/11252fc7698eca84d37b9af60a871acc/Export_BDD_29.JPG)

![Export_BDD_35](uploads/29009e53688f6d2f8dbfe7a1085ce6c9/Export_BDD_35.JPG)

</details>


* Ouvrir le fichier sql et si une adresse IP apparaît, :warning: **adapter cette adresse IP à l'environnement de Pré-Production**
* Dans phpMyAdmin, **Importer le fichier sql** dans l'onglet "Importer" **ou** bien **Copier puis coller le code des requêtes** fournies dans la livraison dans l'onglet "SQL" au niveau du grand cadre blanc
* Cliquer sur le bouton "Exécuter"
* Quitter phpMyAdmin
* Vérifier que l'application fonctionne
* Mettre à jour la version dans la fiche applicative
* Prévenir le demandeur que l'installation est terminée.

</details>

# Déploiement en Production

### Demande d'installation

Habituellement la demande d'installation est faite dans GitLab.

### Préparation

<details>
<summary>Une fois la demande reçue, il faut :</summary>

* Prendre connaissance de la note d'installation liée à l'installation
* Déterminer quel type de synchronisation doit être faite :
  * <ins>Synchronisation globale</ins> : SYNCFULL

    La synchronisation SYNCFULL est la plus couramment utilisée. Elle permet de synchroniser tous les fichiers et répertoires à l'exception de ceux définis dans le fichier "config". Au 18/07/2022, voici la liste d'exclusion :
    * classes/Mvc/integration/Dao.class.php
    * public/index.php
    * config
    * Modeles
    * document
  * <ins>Synchronisation de fichiers spécifiques</ins> : SYNCSPECIFIC

    La synchronisation SYNCSPECIFIC est utilisée pour synchroniser uniquement des fichiers et répertoires spécifiques. Pour effectuer une telle synchronisation, il faut préparer un fichier nommé "SYNCSPECIFIC" qui contiendra un nom de fichier ou répertoire par ligne avec des "/" entre le nom des répertoires. Par exemple, pour synchroniser uniquement le répertoire "/web/Modeles", le fichier "SYNCSPECIFIC" doit contenir une seule ligne indiquant :`Modeles` . Pour synchroniser le fichier "/web/Modeles/ReleveNotesJury2.odt", le fichier "SYNCSPECIFIC" doit contenir une seule ligne indiquant : Modeles/ReleveNotesJury2.odt.

</details>

### Déploiement partie applicative en Production

<details>
<summary>Pour déployer la partie applicative, il faut :</summary>

* Se connecter au serveur de Pré-Production avec un outil de transfert de fichiers (ex. : WinSCP) (Les logins sont à récupérer sur le [Passbolt](https://passbolt.pnm3.e2.rie.gouv.fr) du GTI.)
* Vérifier que l'application fonctionne
* Selon le type de synchronisation désirée, déposer dans le répertoire "/ACTIONS" un fichier nommé "SYNCFULL" ou le fichier "SYNCSPECIFIC" préalablement préparé.
* Vérifier que l'application fonctionne
* Si aucune requête SQL ne doit être exécutée, mettre à jour la version dans la fiche applicative

  et prévenir le demandeur que l'installation est terminée. Sinon, passer à la partie "Déploiement partie BDD en Pré-Production".

</details>

### Déploiement partie BDD en Production

La note d'installation indique si des requêtes SQL doivent être passées, ainsi qu'un moyen de vérifier que leur exécution donne le résultat attendu.

<details>
<summary>Pour exécuter des requêtes SQL, il faut :</summary>

* Se connecter avec phphMyAdmin à la base de données de Production (Les éléments permettant de se connecter aux bases, URL et logins, sont à récupérer sur le [Passbolt](https://passbolt.pnm3.e2.rie.gouv.fr) du GTI.)
* **Sauvegarder la structure** de la base de données à l'aide d'une exportation personnalisée

<details>
<summary>(Afficher options d'export)</summary>

![Export_BDD_18](uploads/2184858652d00ddbd807dcacdab54872/Export_BDD_18.JPG)

![Export_BDD_24](uploads/4b1cf1346dfe0ba8a58360c4db4d425d/Export_BDD_24.JPG)

</details>


* **Sauvegarder les données** de la base de données à l'aide d'une exportation personnalisée

<details>
<summary>(Afficher options d'export)</summary>

![Export_BDD_29](uploads/11252fc7698eca84d37b9af60a871acc/Export_BDD_29.JPG)

![Export_BDD_35](uploads/29009e53688f6d2f8dbfe7a1085ce6c9/Export_BDD_35.JPG)

</details>


* Ouvrir le fichier sql et si une adresse IP apparaît, :warning: **adapter cette adresse IP à l'environnement de Production**
* Dans phpMyAdmin, **Importer le fichier sql** dans l'onglet "Importer" **ou** bien **Copier puis coller le code des requêtes** fournies dans la livraison dans l'onglet "SQL" au niveau du grand cadre blanc
* Cliquer sur le bouton "Exécuter"
* Quitter phpMyAdmin
* Vérifier que l'application fonctionne
* Mettre à jour la version dans la fiche applicative
* Prévenir le demandeur que l'installation est terminée.

</details>


````

</details>


---

### 📄 `Home.md` [15.480 octets]
<a id="Home-md"></a> [↩ Retour à l'arborescence](#tree-Home-md)

> **Chemin relatif** : `Home.md`  
> **Taille** : 15.480 octets  
> **Lignes** : 277  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (277 lignes) - Cliquer pour déplier</summary>

```markdown
<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><b><span style='font-size:24.0pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
mso-font-kerning:18.0pt;mso-fareast-language:FR'><span class=msoIns><ins>Fiche
technique</ins></span><o:p></o:p></span></b></p>

<table class=MsoNormalTable border=0 cellpadding=0 style='mso-cellspacing:1.5pt;
 mso-yfti-tbllook:1184'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td style='background:lightgrey;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><b><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";color:black;mso-fareast-language:
  FR'>Base de connaissance</span></b><span style='font-size:12.0pt;font-family:
  "Times New Roman",serif;mso-fareast-font-family:"Times New Roman";color:black;
  mso-fareast-language:FR'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'><a
  href="https://sirh.projets.developpement-durable.gouv.fr/issues/18157">https://sirh.projets.developpement-durable.gouv.fr/issues/18157</a><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<div class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
text-align:center;line-height:normal'><span style='font-size:12.0pt;font-family:
"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";mso-fareast-language:
FR'>

<hr size=2 width="100%" align=center>

</span></div>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><a name=Périmètre-MCO></a><b><span
style='font-size:24.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-font-kerning:18.0pt;mso-fareast-language:FR'>Périmètre
MCO<o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Activités
reprises par la MCO ATOS : <o:p></o:p></span></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l2 level1 lfo1;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Déploiements<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l2 level1 lfo1;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Gestion des incidents<o:p></o:p></span></li>
</ul>

<div class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
text-align:center;line-height:normal'><span style='font-size:12.0pt;font-family:
"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";mso-fareast-language:
FR'>

<hr size=2 width="100%" align=center>

</span></div>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><a name=Documentation></a><b><span
style='font-size:24.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-font-kerning:18.0pt;mso-fareast-language:FR'>Documentation<o:p></o:p></span></b></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l3 level1 lfo2;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>La documentation est disponible
     dans <b>&quot;K:\K-SNUM\14_PNM\PNM6\13 - Transfert_Méridienne_ATL4&quot;</b><o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l3 level1 lfo2;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Le lien WikiSI est le suivant : 
     <a href="https://wikisi.e2.rie.gouv.fr/wikisi/application/552/"> 
     https://wikisi.e2.rie.gouv.fr/wikisi/application/552/</a><o:p></o:p></span></li>
</ul>

<div class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
text-align:center;line-height:normal'><span style='font-size:12.0pt;font-family:
"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";mso-fareast-language:
FR'>

<hr size=2 width="100%" align=center>

</span></div>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><a name=Accès-Identifiants-Application></a><b><span
style='font-size:24.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-font-kerning:18.0pt;mso-fareast-language:FR'>Accès :
Identifiants, Application...<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><a name=Identifiants-et-mots-de-passe></a><b><span
style='font-size:18.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Identifiants et mots de passe<o:p></o:p></span></b></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l5 level1 lfo3;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Des identifiants et mots de
     passe sont disponibles dans le <span class=SpellE><b>Keepass</b></span><b>
     Coffre de l'exploitation</b> (Atos).<o:p></o:p></span></li>
</ul>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><a name=Accès-application></a><b><span
style='font-size:18.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Accès application<o:p></o:p></span></b></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l7 level1 lfo4;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'><a
     href="https://sirh.projets.developpement-durable.gouv.fr/issues/18157#Liens">Accès
     à l'application</a><o:p></o:p></span></li>
</ul>

<div class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
text-align:center;line-height:normal'><span style='font-size:12.0pt;font-family:
"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";mso-fareast-language:
FR'>

<hr size=2 width="100%" align=center>

</span></div>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><a name=Gestion-des-incidents></a><b><span
style='font-size:24.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-font-kerning:18.0pt;mso-fareast-language:FR'>Gestion des
incidents<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><a name=Criticité></a><b><span
style='font-size:18.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Criticité<o:p></o:p></span></b></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l4 level1 lfo5;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'><a
     href="https://sirh.projets.developpement-durable.gouv.fr/issues/18157#Criticit%C3%A9">Criticité</a><o:p></o:p></span></li>
</ul>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><a
name=Qui-prévenir-et-comment-en-cas-dincident></a><b><span style='font-size:
18.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
mso-fareast-language:FR'>Qui prévenir et comment en cas d'incident<o:p></o:p></span></b></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l6 level1 lfo6;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Si <b><span class=msoIns><ins>incident
     fonctionnel</ins></span></b> : <o:p></o:p></span></li>
 <ul type=circle>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;line-height:normal;mso-list:l6 level2 lfo6;tab-stops:list 72.0pt'><span
      style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
      "Times New Roman";mso-fareast-language:FR'>Solliciter la <b>société CGI
      dans <span class=SpellE>Redmine</span> SIRH</b><o:p></o:p></span></li>
 </ul>
</ul>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l1 level1 lfo7;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Si <b><span class=msoIns><ins>incident
     technique</ins></span></b> (Exemples : Erreur 404, erreur 501, erreur de
     communication...) : <o:p></o:p></span></li>
 <ul type=circle>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;line-height:normal;mso-list:l1 level2 lfo7;tab-stops:list 72.0pt'><span
      style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
      "Times New Roman";mso-fareast-language:FR'>Solliciter le <b>Centre
      Serveur dans <span class=SpellE>Redmine</span> Portail Hébergement</b><o:p></o:p></span></li>
 </ul>
</ul>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><a
name=Emplacement-des-fichiers-de-logs></a><b><span style='font-size:18.0pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
mso-fareast-language:FR'>Emplacement des fichiers de logs<o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Les fichiers
de logs se trouvent sur le <b>FTP MERIDIENNE</b> : <o:p></o:p></span></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l0 level1 lfo8;tab-stops:list 36.0pt'><b><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Pré-Production</span></b><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'> : dans le <b>répertoire
     &quot;/logs-<span class=SpellE>preprod</span>&quot;</b>.<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l0 level1 lfo8;tab-stops:list 36.0pt'><b><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Production</span></b><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'> : dans le <b>répertoire
     &quot;/logs-<span class=SpellE>prod</span>&quot;</b>.<o:p></o:p></span></li>
</ul>

<div class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
text-align:center;line-height:normal'><span style='font-size:12.0pt;font-family:
"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";mso-fareast-language:
FR'>

<hr size=2 width="100%" align=center>

</span></div>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><a
name=Fiche-dexploitation-Erreurs-connues></a><b><span style='font-size:24.0pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
mso-font-kerning:18.0pt;mso-fareast-language:FR'>Fiche d'exploitation / Erreurs
connues<o:p></o:p></span></b></p>

<table class=MsoNormalTable border=0 cellpadding=0 style='mso-cellspacing:1.5pt;
 mso-yfti-tbllook:1184'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='background:lightgrey;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><b><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";color:black;mso-fareast-language:
  FR'>Description</span></b><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";color:black;mso-fareast-language:
  FR'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Lien<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;mso-yfti-lastrow:yes'>
  <td style='padding:.75pt .75pt .75pt .75pt'></td>
  <td style='padding:.75pt .75pt .75pt .75pt'></td>
 </tr>
</table>

<div class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
text-align:center;line-height:normal'><span style='font-size:12.0pt;font-family:
"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";mso-fareast-language:
FR'>

<hr size=2 width="100%" align=center>

</span></div>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><a name=Déploiement></a><b><span
style='font-size:24.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-font-kerning:18.0pt;mso-fareast-language:FR'><a
href="https://sirh.projets.developpement-durable.gouv.fr/projects/psism/wiki/D%C3%A9ploiement">Déploiement</a><o:p></o:p></span></b></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

```

</details>


---

### 📄 `Manuel-d'installation-Méridienne-(PHP8.3)-MI-v1.0.0.md` [3.852 octets]
<a id="Manuel-d'installation-Méridienne-(PHP8-3)-MI-v1-0-0-md"></a> [↩ Retour à l'arborescence](#tree-Manuel-d'installation-Méridienne-(PHP8-3)-MI-v1-0-0-md)

> **Chemin relatif** : `Manuel-d'installation-Méridienne-(PHP8.3)-MI-v1.0.0.md`  
> **Taille** : 3.852 octets  
> **Lignes** : 106  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (106 lignes) - Cliquer pour déplier</summary>

````markdown
# Introduction:

## Changelog:

- 05/03/2025 : création du nouveau MI - processus à vérifier

## Prérequis:

- Environnement Linux Apache / PHP8.3 / Mysql5.7.xx
- Serveur CAS d'authentification
- Fichier de configuration "config.php" spécifique à l'environnement (voir Note d'installation V2.0.0)

## Conventions:

`<#ENV>` nom de l’environnement.

> Exemple : RECETTE pour l’environnement de recette.

`X.Y.Z` version applicative à déployer.

> Exemple : 1.2.3 pour la v1.2.3.

## Entrants:

Le code source de l'application est disponible depuis Gitlab sous le tag de version X.Y.Z-LIVREE. La livraison comprend :

- un répertoire **web** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL à exécuté
- un fichier **version.php** comportant les informations de version de l'application

## Vérification des sources applicatives:

Vérification du fichier **version.php** :

Sinon, remonter une alerte \[CEDRIC CHAPE\]

## Actions préliminaires

1. Faire un [backup de la base de données](Op%C3%A9rations-techniques/Backup-base-de-donn%C3%A9es).
2. Faire un [backup des sources applicatives](Op%C3%A9rations-techniques/Backup-donn%C3%A9es-applicatives)

# Déploiement applicatif:

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

1/ Copier les répertoires et fichiers suivants:

- cert
- web
- version.php

2/ Récupération des données métier:

le dossier **web/document** contient les différents fichiers générés par l'application méridienne. \*\* Penser à récupérer les données de l'anciennes release pour les copier dans la nouvelle installation.

3/ Correction des droits sur les fichiers:

**IMPORTANT** : Pour des raisons de sécurité, les fichiers et dossiers **\*.PHP** doivent pourvoir être exécutés par **apache** mais ne doivent pas pouvoir être modifiés sans droit supplémentaire.

Exemple de configuration serveur:

Création d'un utilisateur **mte** présent dans le groupe **www-data**

`sudo chown -R mte:mte chemin_vers_meridienne`\
`sudo chmod -R 755 chemin_vers_meridienne`

Ajouter les droits d'écriture aux dossiers suivants en changeant d'utilisateur:

`sudo chown -R www-data chemin_vers_meridienne/web/document`\
`sudo chown -R www-data chemin_vers_meridienne/web/log`

## Modification à apporter sur les sources

Aucune action particulière n'est prévue dans cette étape.

## Configuration

1/ Installer le fichier de configuration de l'environnement

(un fichier de configuration nommé **config.php** est créé pour chaque environnement. le fichier de configuration est créé à partir du fichier **config.exemple.php** présent sur le GitLab.)

2/ récupérer le certificat d'identification du serveur CAS et le déposer dans le dossier "cert" de l'application. 

**Note**: le chemin complet vers le certification CAS est paramétrable dans le fichier **config.php** Vérifier que le chemin renseigné et le nom du fichier sont identiques

Exemple: `const CAS_SERVER_CERT_FILE = __DIR__ . "/cert/IGC_A.crt"; `(chemin vers le certificat du serveur CAS en mode "https" dans le dossier cert de l'application)

3/ supprimer le fichier de \*\*config.exemple.php\*\*

## Actions particulières

Les actions particulières sont indiquées dans les **Note d'installation vX.Y.Z**

## Effectuer la VABF

- Test de connexion / déconnexion de l'application
- Vérifier l'application n'est pas accessible lorsqu'un utilisateur n'est pas connecté
- Vérifier que la création de documents s'effectue correctement (vérification des droits d'écriture)

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````

</details>


---

### 📄 `Meridienne-Fiche-Applicative.md` [6.777 octets]
<a id="Meridienne-Fiche-Applicative-md"></a> [↩ Retour à l'arborescence](#tree-Meridienne-Fiche-Applicative-md)

> **Chemin relatif** : `Meridienne-Fiche-Applicative.md`  
> **Taille** : 6.777 octets  
> **Lignes** : 205  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (205 lignes) - Cliquer pour déplier</summary>

```markdown
**<span dir="">Wiki</span>**

<table>
<tr>
<td>

**<span dir="">Wiki MERIDIENNE</span>**
</td>
<td>

<span dir="">http://sirh.redmine.ac.centre-serveur.i2/projects/psism/wiki</span>
</td>
</tr>
</table>

**<span dir="">Contexte et statut</span>**

<span dir="">Préciser le contexte, les particularités (ex issu de la fabnum etc), la criticité éventuelle.</span>

<table>
<tr>
<td>

**<span dir="">Application utilisée pour l'organisation des examens (CAP, Bac, BTS...) dans les lycées de l’enseignement maritime (DAM : Direction des Affaires Maritimes).<br>Elle est utlisée par :<br>- l’Unité des Concours et Examens Maritimes (UCEM) est chargée de l’organisation des concours et examens de l’enseignement maritime (élaboration des textes réglementaires, gestion des candidats, élaboration et mise à disposition des sujets, gestion des jurys, évaluation, attestations, …).<br>- les lycées professionnels maritimes (LPM) qui assurent la formation des élèves scolarisés et saisissent les notes CCF des candidats.<br>- les DIRM saisissent les dossiers d’inscriptions y compris les notes acquises et les dispenses.<br>- les Agents DGITM/DAM/GM1.<br>Elle a été développée par ATL4.</span>**
</td>
</tr>
</table>

**<span dir="">Criticité</span>**

**<span dir="">Période critique</span>**

<table>
<tr>
<td>

**<span dir="">Période critique :<br>janvier-février (inscription examens)<br>juin-juillet (période d'examens)</span>**
</td>
</tr>
</table>

**<span dir="">Statut du SI :</span>**

**<span dir="">Versions</span>**

| Environnement | Version | Date d'installation |
|---------------|---------|---------------------|
| Pré-Production | 1.6.45 | 26/06/2025 |
| Production | 1.6.45 | 26/06/2025 |

<table>
<tr>
<td>

**<span dir="">v1<br>L'application a été mise en place en 2017.<br>Elle évolue peu.</span>**
</td>
</tr>
</table>

**<span dir="">Description technique</span>**

<table>
<tr>
<td>

**<span dir="">Applicatif</span>**
</td>
<td>

**<span dir="">Accès SFTP en pré-production via intranet<br>Client FTP Filezilla <br>serveur: livraison8.ftp.vpn.e2.rie.gouv.fr<br>protocole: SFTP</span>**
</td>
</tr>
<tr>
<td>

**<span dir="">BDD en Pré-Production</span>**
</td>
<td>

**<span dir="">Accès phpmyadmin en pré-production<br>URL en pré-production:</span>** **<span dir="">https://pma.preprod.vpn.e2.rie.gouv.fr</span>**\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*<span dir=""><br>Choix du serveur : Livraison 8 - (Jessie)<br>Nom de la BDD : meridienne<br>Nom du serveur de base de données à paramétrer dans l'application: mydb</span>\*\*
</td>
</tr>
<tr>
<td>

**<span dir="">BDD en Production</span>**
</td>
<td>

**<span dir="">Accès phpmyadmin en production<br>URL en production:</span>** **<span dir="">https://pma.prod.vpn.e2.rie.gouv.fr</span>**\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*<span dir=""><br>nom de base, utilisateur et mot de passe identiques à ceux de la preprod <br>Choix du serveur : millepaysages (la VM BDD est mutualisée pour le site "1000paysages" et l'application MERIDIENNE)<br>Nom du serveur de base de données à paramétrer dans l'application: mydb</span>\*\*
</td>
</tr>
</table>

**<span dir="">Infra</span>**

**<span dir="">Hébergement</span>**

<span dir="">Préciser le type d'hébergement parmi : Nominal type acai, sec IAAS DOIP, extra dry (ex RGP, ORPA), , OSHIMAE, hébergement externe type ARMIN, ATE)</span>

<table>
<tr>
<td>

**<span dir="">ATE, à l'exception de la sécurisation HTTPS du site de production</span>**
</td>
</tr>
</table>

<span dir="">Préciser le VLAN :</span>

**<span dir="">Machine(s) et OS :</span>**

<span dir="">Machine(s) : physique si extra dry, vm si sec, so si nominal ?\
OS :</span>

<table>
<tr>
<td>

**<span dir="">Linux</span>**
</td>
</tr>
</table>

**<span dir="">Stockage</span>**

<span dir="">Préciser ce qui est stocké en local / en espace partagé (SAN, FTP, etc)</span>

**<span dir="">Techno</span>**

<span dir="">Langage/framework :</span>

<table>
<tr>
<td>

**<span dir="">PHP-Mysql (PHP v5.6.40)</span>**
</td>
</tr>
</table>

<span dir="">SGBD :</span>

<span dir="">Composants divers :</span>

<span dir="">Version JAVA</span>

**<span dir="">Staut pic</span>**

<span dir="">(eg : utilisation de git)</span>

**<span dir="">Services</span>**

**<span dir="">Supervision</span>**

**<span dir="">Gestion des incidents et problèmes</span>**

**<span dir="">Gestion des changements, des mep, déploiements</span>**

**<span dir="">Gestion de conf</span>**

**<span dir="">Gestion des opérations dont sauvegardes</span>**

**<span dir="">Gestion des RFS</span>**

**<span dir="">Gestion de la sécurité</span>**

**<span dir="">Gestion des accès et comptes</span>**

**<span dir="">Indicateurs</span>**

**<span dir="">Acteurs</span>**

* <span dir="">Pilote MCO</span>
* <span dir="">MOE :</span>
* **<span dir="">MOA : La maîtrise d'ouvrage est DGITM/DAM/GM1 : Mme Leila AZZAOUI (tél 13759) ou M. Nicolas SINGELLOS</span>**
* **<span dir="">Référent métier : Le référent métier est M. Laurent GALY (IGAM/UCEM)</span>**
* <span dir="">MOA/AMO/Product Owner :</span>
* <span dir="">Scrum Master si agile :</span>
* <span dir="">TMA :</span>
* <span dir="">Hébergement :</span>
* <span dir="">Administration :</span>
* <span dir="">Exploit / MCO :</span>
* <span dir="">Assistance :</span>
* <span dir="">Formation, animation réseau, etc :</span>
* <span dir="">Supervision :</span>

**<span dir="">Acquisitions</span>**

**<span dir="">Marchés mobilisés pour maintenance applicative, recette, exploitaiton</span>**

**<span dir="">Maintenance, support et licences matérielles, logicielles</span>**

**<span dir="">Liens</span>**

**<span dir="">URL du site en pré-production :</span>** 

<span dir="">https://meridienne.preprod.e2.rie.gouv.fr/</span><span dir=""> (avec un certificat auto-signé par ATE -\> il faut confirmer l'exception de sécurité.)</span>

**<span dir="">URL du site en production :</span>**

<span dir="">https://www.meridienne.developpement-durable.gouv.fr/</span>

 
```

</details>


---

### 📄 `Notes-d'installation/Note-d'installation-v1.5.2.md` [2.304 octets]
<a id="Notes-d'installation-Note-d'installation-v1-5-2-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-5-2-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.5.2.md`  
> **Taille** : 2.304 octets  
> **Lignes** : 83  
> **Type** : markdown

````markdown

Note d'installation v1.5.2
--------------------------------------------

# Tickets

- 20722 - Anomalie - Anomalies dans les éditions
- 20742 - Anomalie - Anomalies dans les éditions

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.

> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.5.2.zip** contenant :
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.5.2


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.5.2**.

Sinon, remonter une alerte.

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - lib/1.3.2
    - modeles/

## Modification à apporter sur les sources en exception

Cette version n'apporte aucune modification sur les fichiers mentionnés.

Aucune action n'est prévue dans cette étape.

## Configuration

Aucune action n'est prévue dans cette étape.

## Actions particulières

Vérifier qu'un répertoire **2022** est présent dans le répertoire **document**.

Si ce n'est pas le cas, le créer.

# Déploiement scripts SQL

## Exécution des scripts

Aucun script n'est à exécuter dans cette livraison.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.5.3.md` [2.390 octets]
<a id="Notes-d'installation-Note-d'installation-v1-5-3-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-5-3-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.5.3.md`  
> **Taille** : 2.390 octets  
> **Lignes** : 83  
> **Type** : markdown

````markdown
Note d'installation v1.5.3
--------------------------------------------

# Tickets

- 20722 - Anomalie - Anomalies dans les éditions
- 20742 - Anomalie - Anomalies dans les éditions
- 19125 - Ajout des habilitations au niveau de la matière pour les profils correcteur

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.

> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.5.3.zip** contenant :
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.5.3


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.5.3**.

Sinon, remonter une alerte.

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - lib/1.3.2
    - Modeles/

## Modification à apporter sur les sources en exception

Cette version n'apporte aucune modification sur les fichiers mentionnés.

Aucune action n'est prévue dans cette étape.

## Configuration

Aucune action n'est prévue dans cette étape.

## Actions particulières

Vérifier qu'un répertoire **2022** est présent dans le répertoire **document**.

Si ce n'est pas le cas, le créer.

# Déploiement scripts SQL

## Exécution des scripts

Aucun script n'est à exécuter dans cette livraison.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.5.4.md` [2.291 octets]
<a id="Notes-d'installation-Note-d'installation-v1-5-4-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-5-4-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.5.4.md`  
> **Taille** : 2.291 octets  
> **Lignes** : 82  
> **Type** : markdown

````markdown
Note d'installation v1.5.4
--------------------------------------------

# Tickets


- 19125 - Ajout des habilitations au niveau de la matière pour les profils correcteur

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.

> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.5.4.zip** contenant :
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.5.4


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.5.4**.

Sinon, remonter une alerte.

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - lib/1.3.2
    - Modeles/

## Modification à apporter sur les sources en exception

Cette version n'apporte aucune modification sur les fichiers mentionnés.

Aucune action n'est prévue dans cette étape.

## Configuration

Aucune action n'est prévue dans cette étape.

## Actions particulières

Vérifier qu'un répertoire **2022** est présent dans le répertoire **document**.

Si ce n'est pas le cas, le créer.

# Déploiement scripts SQL

## Exécution des scripts

Aucun script n'est à exécuter dans cette livraison.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.5.5.md` [2.670 octets]
<a id="Notes-d'installation-Note-d'installation-v1-5-5-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-5-5-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.5.5.md`  
> **Taille** : 2.670 octets  
> **Lignes** : 89  
> **Type** : markdown

````markdown
Note d'installation v1.5.5
--------------------------------------------

# Tickets


- 19125 - Ajout des habilitations au niveau de la matière pour les profils correcteur
- 20742 - Anomalies dans les éditions
- 20722 - Anomalie numéro anonymat

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.

> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.5.4.zip** contenant :
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.5.5


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.5.5**.

Sinon, remonter une alerte.

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - lib/1.3.2
    - Modeles/

## Modification à apporter sur les sources en exception

Il faudra remplacer les fichiers qui se trouve dans le répertoire Modeles/ ListeAdmin.odt ainsi PV_Admin.odt pour corriger le problème de signature


## Configuration

Aucune action n'est prévue dans cette étape.

## Actions particulières

Vérifier qu'un répertoire **2022** est présent dans le répertoire **document**.

Si ce n'est pas le cas, le créer.

Il faudra donner le droit dans le dossier web afin de corriger les problèmes des droits. 
Comme par exemple: à modifier selon votre environnement 

- sudo chmod -R 777 /home/vagrant/workspace/meridienne
- sudo chown -R www-data:www-data /home/vagrant/workspace/meridienne

# Déploiement scripts SQL

## Exécution des scripts

Aucun script n'est à exécuter dans cette livraison.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.5.6.md` [2.547 octets]
<a id="Notes-d'installation-Note-d'installation-v1-5-6-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-5-6-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.5.6.md`  
> **Taille** : 2.547 octets  
> **Lignes** : 87  
> **Type** : markdown

````markdown
Note d'installation v1.5.6
--------------------------------------------

# Tickets

- 20742 - Anomalies dans les éditions


# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.

> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.5.6.zip** contenant :
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.5.6


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.5.6**.

Sinon, remonter une alerte.

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - lib/1.3.2
    - Modeles/

## Modification à apporter sur les sources en exception

Il faudra remplacer les fichiers qui se trouve dans le répertoire Modeles/ ListeAdmin.odt ainsi PV_Admin.odt pour corriger le problème de signature


## Configuration

Aucune action n'est prévue dans cette étape.

## Actions particulières

Vérifier qu'un répertoire **2022** est présent dans le répertoire **document**.

Si ce n'est pas le cas, le créer.

Il faudra donner le droit dans le dossier web afin de corriger les problèmes des droits. 
Comme par exemple: à modifier selon votre environnement 

- sudo chmod -R 777 /home/vagrant/workspace/meridienne
- sudo chown -R www-data:www-data /home/vagrant/workspace/meridienne

# Déploiement scripts SQL

## Exécution des scripts

Aucun script n'est à exécuter dans cette livraison.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.0.md` [2.307 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-0-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-0-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.0.md`  
> **Taille** : 2.307 octets  
> **Lignes** : 83  
> **Type** : markdown

````markdown
Note d'installation v1.5.5
--------------------------------------------

# Tickets


- 20496

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.

> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.0.zip** contenant :
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.0


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.5.5**.

Sinon, remonter une alerte.

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - lib/1.3.2
    - Modeles/


## Configuration

Aucune action n'est prévue dans cette étape.

## Actions particulières

Vérifier qu'un répertoire **2022** est présent dans le répertoire **document**.

Si ce n'est pas le cas, le créer.

Il faudra donner le droit dans le dossier web afin de corriger les problèmes des droits. 
Comme par exemple: à modifier selon votre environnement 

- sudo chmod -R 777 /home/vagrant/workspace/meridienne
- sudo chown -R www-data:www-data /home/vagrant/workspace/meridienne

# Déploiement scripts SQL

## Exécution des scripts

Aucun script n'est à exécuter dans cette livraison.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.1.md` [2.325 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-1-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-1-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.1.md`  
> **Taille** : 2.325 octets  
> **Lignes** : 82  
> **Type** : markdown

````markdown
Note d'installation v1.6.1
--------------------------------------------

# Tickets

- 20742 - Pièces Jointes

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.

> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.1.zip** contenant :
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.1


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.1**.

Sinon, remonter une alerte.

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - lib/1.3.2
    - document/


## Configuration

Aucune action n'est prévue dans cette étape.

## Actions particulières

Vérifier qu'un répertoire **2022** est présent dans le répertoire **document**.

Si ce n'est pas le cas, le créer.

Il faudra donner le droit dans le dossier web afin de corriger les problèmes des droits. 
Comme par exemple: à modifier selon votre environnement 

- sudo chmod -R 777 /home/vagrant/workspace/meridienne
- sudo chown -R www-data:www-data /home/vagrant/workspace/meridienne

# Déploiement scripts SQL

## Exécution des scripts

Aucun script n'est à exécuter dans cette livraison.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.10.md` [2.440 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-10-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-10-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.10.md`  
> **Taille** : 2.440 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Tickets

- 20920 - Version 1.6.5 sur preprod : pour les bacs métier de la mer, le calcul correspondant à "autorisé à passer l'épreuve de contrôle" prend en compte les E13 et E14 à tord
- 20936 - A
- 20914 - permettre d'utiliser le paramétrage actuel épreuves bac culture marine E14 E33

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.10.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.10


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.10**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Exécution du script se trouvant dans : db/04_meridienne_E33_08_07_2022

Pour vérifier la bonne exécution de ce script, exécuter la requête suivante, elle doit retourner E14
SELECT CODE FROM EPREUVE e WHERE e.ID_EPREUVE = 2867;
## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.11.md` [2.145 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-11-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-11-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.11.md`  
> **Taille** : 2.145 octets  
> **Lignes** : 74  
> **Type** : markdown

````markdown
# Tickets

- 20920 - Version 1.6.5 sur preprod : pour les bacs métier de la mer, le calcul correspondant à "autorisé à passer l'épreuve de contrôle" prend en compte les E13 et E14 à tord
- 20936 - A

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.11.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.11


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.11**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Pas de script à exécuter

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.12.md` [2.131 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-12-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-12-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.12.md`  
> **Taille** : 2.131 octets  
> **Lignes** : 76  
> **Type** : markdown

````markdown
# Tickets

- 20948 - Apparition de codification
- 20947 - Edition procès-verbaux certificat de fin d'études professionnelles secondaires
- 20936 - A
- 20911 - Anomalie édition listes admis

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.12.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.12


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.12**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Pas de script à exécuter

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.13.md` [2.080 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-13-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-13-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.13.md`  
> **Taille** : 2.080 octets  
> **Lignes** : 73  
> **Type** : markdown

````markdown
# Tickets

- 20911 - Anomalies édition listes admis
- 20936 - A
- 20947 - Edition procès-verbaux certificat de fin d'études professionnelles secondaires

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.13.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.13


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.13**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Pas de script à exécuter

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.14.md` [1.999 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-14-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-14-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.14.md`  
> **Taille** : 1.999 octets  
> **Lignes** : 72  
> **Type** : markdown

````markdown
# Tickets

- 20911 - Anomalies édition listes admis
- 20955 - Edition RIN

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.14.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.14


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.14**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Pas de script à exécuter

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.15.md` [2.252 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-15-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-15-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.15.md`  
> **Taille** : 2.252 octets  
> **Lignes** : 76  
> **Type** : markdown

````markdown
# Tickets

- 20496 - Baccalauréat professionnel remplacement - Jury 3

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.14.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.14


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.14**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Exécution du script se trouvant dans : db/05_meridienne_jury3_25_08_2022

Pour vérifier la bonne exécution de ce script, exécuter la requête suivante, elle ne doit pas retourner de résultat
SELECT * EXAMEN WHERE LIB_EXAMEN  = "BAC PRO Cultures marines (jury 4)";

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.16.md` [2.183 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-16-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-16-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.16.md`  
> **Taille** : 2.183 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Tickets

- 20496 - Baccalauréat professionnel remplacement - Jury 3
- 20985 - Edition RIN CAP maritime jury 2
- 20955 - Edition RIN

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.16.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.16


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.16**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Exécution du script se trouvant dans : db/05_meridienne_jury3_25_08_2022

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.17.md` [2.044 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-17-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-17-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.17.md`  
> **Taille** : 2.044 octets  
> **Lignes** : 73  
> **Type** : markdown

````markdown
# Tickets

- 20496 - Baccalauréat professionnel remplacement - Jury 3

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.17.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.17


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.17**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.18.md` [2.069 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-18-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-18-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.18.md`  
> **Taille** : 2.069 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Tickets

- 20984 - Saisie des notes ponctuelles écrites

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.18.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.18


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.18**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèle a mettre à jours

Aucun
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.19.md` [2.200 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-19-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-19-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.19.md`  
> **Taille** : 2.200 octets  
> **Lignes** : 79  
> **Type** : markdown

````markdown
# Tickets

- 20984 - Saisie des notes ponctuelles écrites
- 20962 - Suppression du fichier /public/phpinfo.php des sources
- 20961 - Ajout d'une route de healthcheck sans authentification

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.19.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.19


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.19**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles a mettre à jours

Aucun
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.2.md` [2.513 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-2-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-2-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.2.md`  
> **Taille** : 2.513 octets  
> **Lignes** : 85  
> **Type** : markdown

````markdown
# Tickets

- 20817 - Evolution - Epreuves de contrôle
- 20496 - Evolution - Baccalauréat professionnel remplacement - Jury 3
- 20890 - Anomalie - Calcul moyenne générale
- 20742 - Anomalie - Anomalies dans les éditions

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.2.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.2


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.2**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Les scripts sont à exécuter dans l'ordre présenté ici.

### 1 - script_update_conditions_bacpro_epreuves_controle.sql

Vérifier que le script sera utile en lançant la requête suivante :

    SELECT * FROM DELIBERATION WHERE ID_DELIBERATION = 875;

Le champ RESULTAT doit contenir "Autorisé à passer l'épreuve de contrôle".
Sinon, remonter un problème de déploiement.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.20.md` [2.190 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-20-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-20-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.20.md`  
> **Taille** : 2.190 octets  
> **Lignes** : 81  
> **Type** : markdown

````markdown
# Tickets

- 21045 : Procès-verbal CFES
- 21046 : PV CFES CGEM
- 21047 : PV CFES bac EMM
- 21048 : PV CFES bac polyvalent
- 21056 : RIN BTSM
- 21060 : RIN CAPM de conchyliculture

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.20.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.20


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.20**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles a mettre à jours
Aucun
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.21.md` [2.059 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-21-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-21-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.21.md`  
> **Taille** : 2.059 octets  
> **Lignes** : 76  
> **Type** : markdown

````markdown
# Tickets

- 21060 : RIN CAPM de conchyliculture

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.21.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.21


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.21**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles a mettre à jours
Aucun
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.22.md` [2.432 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-22-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-22-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.22.md`  
> **Taille** : 2.432 octets  
> **Lignes** : 87  
> **Type** : markdown

````markdown
# Tickets

- 21042 : Modification RIN candidats ayant passés l'épreuve de contrôle
- 21044 : Signature procès-verbaux
- 21043 : RIN BTSM
- 21041 : Mention bas de page RIN candidat épreuve de contrôle
- 21040 : Modification RIN
- 21076 : Certificat de fin d'études maritimes

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.22.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.22


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.22**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles a mettre à jours
- PVCFES_BAC_PRO
- PVConvocationControleBAC_PRO
- PVDecisionControleBAC_PRO
- ReleveNotes
- ReleveNotesBTSM3
- ReleveNotesBTSM4
- ReleveNotesJury2
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.23.md` [2.119 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-23-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-23-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.23.md`  
> **Taille** : 2.119 octets  
> **Lignes** : 78  
> **Type** : markdown

````markdown
# Tickets

- 21077 : Génération des étiquettes d'anonymat
- 21044 : Signature procès-verbaux

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.23.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.23


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.23**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles a mettre à jours
- PVCFES_BAC_PRO

````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.24.md` [2.146 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-24-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-24-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.24.md`  
> **Taille** : 2.146 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Tickets

- 21076 : Certificat de fin d'études maritimes

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.24.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.24


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.24**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles a mettre à jours
Aucun

````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.25.md` [2.210 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-25-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-25-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.25.md`  
> **Taille** : 2.210 octets  
> **Lignes** : 81  
> **Type** : markdown

````markdown
# Tickets

- 21097 : Modification en-tête listes émargement et procès-verbaux

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.25.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.25


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.25**.

Sinon, remonter une alerte [Henri Berthe]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles a mettre à jour
- ListeEmargement.odt
- PVCFES_BAC_PRO.odt
- PVConvocationControleBAC_PRO.odt
- PVDecisionControleBAC_PRO.odt
- PV_Admis.odt

````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.26.md` [2.114 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-26-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-26-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.26.md`  
> **Taille** : 2.114 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Tickets

- 21096 : Anomalie - Epreuve de contrôle jury 2

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.26.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.26


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.26**.

Sinon, remonter une alerte [Henri Berthe / Emilie Desavoye]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles a mettre à jour

Aucun modèle à mettre à jour
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.27.md` [2.143 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-27-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-27-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.27.md`  
> **Taille** : 2.143 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Tickets

- 21105 : Evolution - RIN baccalauréats professionnels

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.27.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.27


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.27**.

Sinon, remonter une alerte [Henri Berthe / Emilie Desavoye]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles a mettre à jour

Le fichier ReleveNotesJury2.odt est à mettre à jour
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.28.md` [2.210 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-28-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-28-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.28.md`  
> **Taille** : 2.210 octets  
> **Lignes** : 78  
> **Type** : markdown

````markdown
# Tickets

- 21162 : Evolution - Saisie des notes de l'épreuve de contrôle
- 21197 : Anomalie - Saisie des notes CCF en bloc

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.28.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.28


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.28**.

Sinon, remonter une alerte [Henri Berthe / Emilie Desavoye]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles a mettre à jour

Aucune action particulière n'est prévue dans cette étape.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.29.md` [2.144 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-29-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-29-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.29.md`  
> **Taille** : 2.144 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Tickets

- 21197 : Anomalie - Saisie des notes CCF en bloc

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.29.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.29


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.29**.

Sinon, remonter une alerte [Henri Berthe / Emilie Desavoye]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles a mettre à jour

Aucune action particulière n'est prévue dans cette étape.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.3.md` [2.088 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-3-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-3-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.3.md`  
> **Taille** : 2.088 octets  
> **Lignes** : 75  
> **Type** : markdown

````markdown
# Tickets

- 20817 - Evolution - Epreuves de contrôle
- 20890 - Anomalie - Calcul moyenne générale
- 20742 - Anomalie - Anomalies dans les éditions

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.3.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.3


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.3**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Pas de script à exécuter

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.30.md` [2.167 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-30-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-30-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.30.md`  
> **Taille** : 2.167 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Tickets

- 21197 : Anomalie - Saisie des notes CCF en bloc (retour du 05/06/2023)

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.30.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.30


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.30**.

Sinon, remonter une alerte [Henri Berthe / Emilie Desavoye]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles a mettre à jour

Aucune action particulière n'est prévue dans cette étape.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.31.md` [2.161 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-31-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-31-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.31.md`  
> **Taille** : 2.161 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Tickets

- 21224 : Anomalie - Absences dans la saisie des notes ponctuelles

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.31.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.31


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.31**.

Sinon, remonter une alerte [Henri Berthe / Emilie Desavoye]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles a mettre à jour

Aucune action particulière n'est prévue dans cette étape.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.32.md` [2.140 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-32-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-32-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.32.md`  
> **Taille** : 2.140 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Tickets

- 21228 : Anomalie - Saisie notes ponctuelles

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.32.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.32


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.32**.

Sinon, remonter une alerte [Henri Berthe / Emilie Desavoye]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles a mettre à jour

Aucune action particulière n'est prévue dans cette étape.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.33.md` [2.129 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-33-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-33-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.33.md`  
> **Taille** : 2.129 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Tickets

- 21230 : Anomalie - Mentions BTSM

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.33.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.33


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.33**.

Sinon, remonter une alerte [Henri Berthe / Emilie Desavoye]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles a mettre à jour

Aucune action particulière n'est prévue dans cette étape.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.34.md` [2.872 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-34-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-34-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.34.md`  
> **Taille** : 2.872 octets  
> **Lignes** : 101  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (101 lignes) - Cliquer pour déplier</summary>

````markdown
# Tickets

- 21304 : Classement examens dans liste déroulante
- 21305 : Création d'un relevé de notes pour les candidats convoqués à l'épreuve de contrôle
- 21307 : Modification en-tête
- 21308 : Transformation procès-verbal convocation contrôle
- 21309 : Classement alphabétique - Saisie des notes CCF en bloc
- 21310 : Edition relevé individuel de notes BTSM
- 21312 : Saisie de notes ponctuelles 


# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

`X.Y.Z` version applicative à déployer.
> Exemple : 1.2.3 pour la v1.2.3.

## Entrants

La livraison 1.6.34 est disponible depuis Gitlab sous le tag 1.6.34-LIVREE. Elle comprend :
- un répertoire **web** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.34**.

Sinon, remonter une alerte [MAI PELLETIER]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires et fichier suivants du dossier **web** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- Modeles
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

Aucune action particulière n'est prévue dans cette étape.

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

# Déploiement scripts SQL

## Exécution des scripts

Le fichier "script_1.6.33_to_1.6.34.sql contenant des scripts SQL est à exécuter. Il se trouve dans le répertoire db/ 

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

# Modèles à ajouter et à mettre à jour

Un nouveau fichier modèle est à ajouter : 
- ReleveNotesEpreuvesControle.odt

Les fichiers de modèles suivants sont à mettre à jour :
- ListeEmargement.odt
- Liste_Admis.odt
- Modele_liste_convocation_controle.odt
- PVCFES_BAC_PRO.odt
- PVConvocationControleBAC_PRO.odt
- PVConvocationControleBAC_PRO_OLD.odt
- PVDecisionControleBAC_PRO.odt
- PV_Admis.odt
- ReleveNotes.odt
- ReleveNotesBEPM.odt
- ReleveNotesBTSM.odt
- ReleveNotesBTSM2.odt
- ReleveNotesBTSM3.odt
- ReleveNotesBTSM4.odt
- ReleveNotesJury2.odt
````

</details>


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.35.md` [2.699 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-35-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-35-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.35.md`  
> **Taille** : 2.699 octets  
> **Lignes** : 95  
> **Type** : markdown

````markdown
# Tickets

- 21305 : Création d'un relevé de notes pour les candidats convoqués à l'épreuve de contrôle
- 21307 : Modification en-tête
- 21308 : Transformation procès-verbal convocation contrôle
- 21311 : Résultat fiche individuelle
- 21357 : Création mentions CAP maritime et CAPM de conchyliculture
- 21358 : Mention baccalauréats professionnels

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

`X.Y.Z` version applicative à déployer.
> Exemple : 1.2.3 pour la v1.2.3.

## Entrants

La livraison 1.6.35 est disponible depuis Gitlab sous le tag 1.6.35-LIVREE. Elle comprend :
- un répertoire **web** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.35**.

Sinon, remonter une alerte [MAI PELLETIER]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires et fichier suivants du dossier **web** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- Modeles
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

Aucune action particulière n'est prévue dans cette étape.

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

# Déploiement scripts SQL

## Exécution des scripts

Le fichier "script_1.6.34_to_1.6.35.sql contenant des scripts SQL est à exécuter. Il se trouve dans le répertoire db/ 

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

# Modèles à ajouter et à mettre à jour

Les fichiers de modèles suivants sont à mettre à jour :
- ListeEmargement.odt
- Liste_Admis.odt
- Modele_liste_convocation_controle.odt
- PVCFES_BAC_PRO.odt
- PVDecisionControleBAC_PRO.odt
- PV_Admis.odt
- ReleveNotes.odt
- ReleveNotesBEPM.odt
- ReleveNotesBTSM.odt
- ReleveNotesBTSM2.odt
- ReleveNotesBTSM3.odt
- ReleveNotesBTSM4.odt
- ReleveNotesJury2.odt
- ReleveNotesEpreuvesControle.odt
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.36.md` [2.324 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-36-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-36-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.36.md`  
> **Taille** : 2.324 octets  
> **Lignes** : 81  
> **Type** : markdown

````markdown
# Tickets

- 21305 : Création d'un relevé de notes pour les candidats convoqués à l'épreuve de contrôle
- 21308 : Transformation procès-verbal convocation contrôle
- 21311 : Résultat fiche individuelle
- 21357 : Création mentions CAP maritime et CAPM de conchyliculture

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

`X.Y.Z` version applicative à déployer.
> Exemple : 1.2.3 pour la v1.2.3.

## Entrants

La livraison 1.6.35 est disponible depuis Gitlab sous le tag 1.6.36-LIVREE. Elle comprend :
- un répertoire **web** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.36**.

Sinon, remonter une alerte [MAI PELLETIER]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires et fichier suivants du dossier **web** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- Modeles
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

Aucune action particulière n'est prévue dans cette étape.

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

# Déploiement scripts SQL

## Exécution des scripts

Le fichier "script_1.6.35_to_1.6.36.sql contenant des scripts SQL est à exécuter. Il se trouve dans le répertoire db/ 

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

# Modèles à ajouter et à mettre à jour

Les fichiers de modèles suivants sont à mettre à jour :
- Modele_liste_convocation_controle.odt

````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.37.md` [2.087 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-37-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-37-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.37.md`  
> **Taille** : 2.087 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Ticket

- 21336 : Consultation fiche individuelle années antérieures à 2024

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

`X.Y.Z` version applicative à déployer.
> Exemple : 1.2.3 pour la v1.2.3.

## Entrants

La livraison 1.6.37 est disponible depuis Gitlab sous le tag 1.6.37-LIVREE. Elle comprend :
- un répertoire **web** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.37**.

Sinon, remonter une alerte [MAI PELLETIER]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires et fichier suivants du dossier **web** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- Modeles
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

Aucune action particulière n'est prévue dans cette étape.

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

# Déploiement scripts SQL

## Exécution des scripts

Le fichier "script_1.6.36_to_1.6.37.sql contenant des scripts SQL est à exécuter. Il se trouve dans le répertoire db/ 

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

# Modèles à ajouter et à mettre à jour

Aucune action particulière n'est prévue dans cette étape.

````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.38.md` [2.013 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-38-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-38-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.38.md`  
> **Taille** : 2.013 octets  
> **Lignes** : 75  
> **Type** : markdown

````markdown
# Ticket

- 21422 : Edition relevé individuel de notes

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

`X.Y.Z` version applicative à déployer.
> Exemple : 1.2.3 pour la v1.2.3.

## Entrants

La livraison 1.6.38 est disponible depuis Gitlab sous le tag 1.6.38-LIVREE. Elle comprend :
- un répertoire **web** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.38**.

Sinon, remonter une alerte [MAI PELLETIER]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires et fichier suivants du dossier **web** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- Modeles
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

Aucune action particulière n'est prévue dans cette étape.

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

# Déploiement scripts SQL

## Exécution des scripts

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

# Modèles à ajouter et à mettre à jour

Aucune action particulière n'est prévue dans cette étape.

````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.39.md` [2.186 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-39-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-39-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.39.md`  
> **Taille** : 2.186 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Ticket

- 21440 : Suppression d'un dossier d'inscription

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

`X.Y.Z` version applicative à déployer.
> Exemple : 1.2.3 pour la v1.2.3.

## Entrants

La livraison 1.6.39 est disponible depuis Gitlab sous le tag 1.6.39-LIVREE. Elle comprend :
- un répertoire **web** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.39**.

Sinon, remonter une alerte [MAI PELLETIER]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires et fichier suivants du dossier **web** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- Modeles
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

Aucune action particulière n'est prévue dans cette étape.

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

# Déploiement scripts SQL

## Exécution des scripts

Le fichier "script_1.6.38_to_1.6.39.sql contenant des scripts SQL est à exécuter uniquement sur l'environnement de production. Il se trouve dans le répertoire db/ 

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

# Modèles à ajouter et à mettre à jour

Aucune action particulière n'est prévue dans cette étape.

````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.4.md` [1.997 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-4-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-4-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.4.md`  
> **Taille** : 1.997 octets  
> **Lignes** : 73  
> **Type** : markdown

````markdown
# Tickets

- 20742 - Anomalie - Anomalies dans les éditions

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.4.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.4


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.4**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Pas de script à exécuter

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.40.md` [2.223 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-40-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-40-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.40.md`  
> **Taille** : 2.223 octets  
> **Lignes** : 83  
> **Type** : markdown

````markdown
---
title: Note d'installation v1.6.40
---


# Ticket

- 21434 : Saisie des notes ponctuelles écrites
- 21435 : Edition Liste convocation contrôle (BAC PRO)

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

`X.Y.Z` version applicative à déployer.
> Exemple : 1.2.3 pour la v1.2.3.

## Entrants

La livraison 1.6.40 est disponible depuis Gitlab sous le tag 1.6.40-LIVREE. Elle comprend :
- un répertoire **web** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.40**.

Sinon, remonter une alerte [MAI PELLETIER]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires et fichier suivants du dossier **web** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- Modeles
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

Aucune action particulière n'est prévue dans cette étape.

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

# Modèles à ajouter et à mettre à jour

Les fichiers de modèles suivants sont à mettre à jour :
- Modele_liste_convocation_controle.odt
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.42.md` [2.134 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-42-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-42-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.42.md`  
> **Taille** : 2.134 octets  
> **Lignes** : 76  
> **Type** : markdown

````markdown
# Ticket

- 21311 : Résultat fiche individuelle
- 21454 : Doublon de notes sur RIN et export

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

`X.Y.Z` version applicative à déployer.
> Exemple : 1.2.3 pour la v1.2.3.

## Entrants

La livraison 1.6.42 est disponible depuis Gitlab sous le tag 1.6.42-LIVREE. Elle comprend :
- un répertoire **web** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.42**.

Sinon, remonter une alerte [CEDRIC CHAPE]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires et fichier suivants du dossier **web** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- Modeles
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

Aucune action particulière n'est prévue dans cette étape.

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

# Déploiement scripts SQL

## Exécution des scripts

Deux scripts SQL sont à exécuter avant tout démarrage de recette, ils se trouvent dans le répertoire db/ :
- script_1.6.41_to_1.6.42_insert.sql
- script_1.6.41_to_1.6.42_procedure.sql

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.43.md` [1.965 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-43-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-43-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.43.md`  
> **Taille** : 1.965 octets  
> **Lignes** : 73  
> **Type** : markdown

````markdown
# Ticket

- 21454 : Doublon de notes sur RIN et export

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

`X.Y.Z` version applicative à déployer.
> Exemple : 1.2.3 pour la v1.2.3.

## Entrants

La livraison 1.6.43 est disponible depuis Gitlab sous le tag 1.6.43-LIVREE. Elle comprend :
- un répertoire **web** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.43**.

Sinon, remonter une alerte [CEDRIC CHAPE]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires et fichier suivants du dossier **web** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- Modeles
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

Aucune action particulière n'est prévue dans cette étape.

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.44.md` [2.522 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-44-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-44-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.44.md`  
> **Taille** : 2.522 octets  
> **Lignes** : 92  
> **Type** : markdown

````markdown
# Tickets

- 21454 : Doublon de notes sur RIN et export
- 21509 : Procès-verbaux certificats de fin d'études professionnelles secondaires
- 21510 : Modification bloc marque

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

`X.Y.Z` version applicative à déployer.
> Exemple : 1.2.3 pour la v1.2.3.

## Entrants

La livraison 1.6.44 est disponible depuis Gitlab sous le tag 1.6.44-LIVREE. Elle comprend :
- un répertoire **web** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.44**.

Sinon, remonter une alerte [CEDRIC CHAPE]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires et fichier suivants du dossier **web** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- Modeles
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

Aucune action particulière n'est prévue dans cette étape.

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

# Modèles à ajouter et à mettre à jour

Les fichiers de modèles suivants sont à mettre à jour :
- ListeEmargement.odt
- Liste_Admis.odt
- Modele_liste_convocation_controle.odt
- PVCFES_BAC_PRO.odt
- PVDecisionControleBAC_PRO.odt
- PV_Admis.odt
- ReleveNotes.odt
- ReleveNotesBTSM.odt
- ReleveNotesBTSM2.odt
- ReleveNotesBTSM3.odt
- ReleveNotesBTSM4.odt
- ReleveNotesEpreuvesControle.odt
- ReleveNotesJury2.odt

````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.45.md` [2.060 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-45-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-45-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.45.md`  
> **Taille** : 2.060 octets  
> **Lignes** : 76  
> **Type** : markdown

````markdown
 # Tickets

- 21546 : Notes UF extraction

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

`X.Y.Z` version applicative à déployer.
> Exemple : 1.2.3 pour la v1.2.3.

## Entrants

La livraison 1.6.45 est disponible depuis Gitlab sous le tag 1.6.45-LIVREE. Elle comprend :
- un répertoire **web** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.45**.

Sinon, remonter une alerte [CEDRIC CHAPE]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires et fichier suivants du dossier **web** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- Modeles
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

Aucune action particulière n'est prévue dans cette étape.

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

# Modèles à ajouter et à mettre à jour

Aucune action particulière n'est prévue dans cette étape.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.5.md` [1.989 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-5-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-5-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.5.md`  
> **Taille** : 1.989 octets  
> **Lignes** : 73  
> **Type** : markdown

````markdown
# Tickets

- 20817 - Evolution épreuve de contrôle

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.5.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.5


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.5**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Pas de script à exécuter

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.6.md` [2.873 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-6-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-6-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.6.md`  
> **Taille** : 2.873 octets  
> **Lignes** : 80  
> **Type** : markdown

````markdown
# Tickets

- 20920 - Version 1.6.5 sur preprod : pour les bacs métier de la mer, le calcul correspondant à "autorisé à passer l'épreuve de contrôle" prend en compte les E13 et E14 à tord
- 20907 - Saisie notes ponctuelles
- 20913 - règle d'obtention CAP 2022
- 20919 - Version 1.6.5 sur preprod : sur tous les bacs, sur les relevés de note apparaît en double la mention relative au cfeps le cas échéant et la moyenne épreuve de contrôle est = moyenne générale
- 20918 - Version 1.6.5 sur preprod : sur tous les bacs, la liste des candidats devant passer l'épreuve de contrôle est vide (alors que certains sont bien admis aux épreuves de contrôle)
- 20917 - Version 1.6.5 sur preprod : moyenne générale ok sur relevé individuel mais ko sur fiche individuelle
- 20911 - Anomalies édition listes admis
- 20903 - Exception foncitonnelle sur env de préprod le 23 06 22 (version -1.6.2 a priori- 1.6.3 + script 1.6.2)

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.6.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.6


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.6**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Pas de script à exécuter

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.7.md` [2.148 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-7-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-7-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.7.md`  
> **Taille** : 2.148 octets  
> **Lignes** : 74  
> **Type** : markdown

````markdown
# Tickets

- 20920 - Version 1.6.5 sur preprod : pour les bacs métier de la mer, le calcul correspondant à "autorisé à passer l'épreuve de contrôle" prend en compte les E13 et E14 à tord
- Calcul PV Admis

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.7.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.7


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.7**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Pas de script à exécuter

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.8.md` [2.168 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-8-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-8-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.8.md`  
> **Taille** : 2.168 octets  
> **Lignes** : 74  
> **Type** : markdown

````markdown
# Tickets

- 20920 - Version 1.6.5 sur preprod : pour les bacs métier de la mer, le calcul correspondant à "autorisé à passer l'épreuve de contrôle" prend en compte les E13 et E14 à tord
- 20929 - Edition relevés notes BTSM

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.8.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.8


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.8**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Pas de script à exécuter

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v1.6.9.md` [2.129 octets]
<a id="Notes-d'installation-Note-d'installation-v1-6-9-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v1-6-9-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v1.6.9.md`  
> **Taille** : 2.129 octets  
> **Lignes** : 72  
> **Type** : markdown

````markdown
# Tickets

- 20920 - Version 1.6.5 sur preprod : pour les bacs métier de la mer, le calcul correspondant à "autorisé à passer l'épreuve de contrôle" prend en compte les E13 et E14 à tord
# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_meridienne_v1.6.9.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > v1.6.9


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.9**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Pas de script à exécuter

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````


---

### 📄 `Notes-d'installation/Note-d'installation-v2.0.0-(PHP8.3).md` [1.833 octets]
<a id="Notes-d'installation-Note-d'installation-v2-0-0-(PHP8-3)-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Note-d'installation-v2-0-0-(PHP8-3)-md)

> **Chemin relatif** : `Notes-d'installation/Note-d'installation-v2.0.0-(PHP8.3).md`  
> **Taille** : 1.833 octets  
> **Lignes** : 44  
> **Type** : markdown

```markdown
Le manuel d'installation détaillée est disponible sur cette page:

[Manuel-d'installation-Méridienne-(PHP8.3)-MI-v1.0.0](../Manuel-d'installation-Méridienne-(PHP8.3)-MI-v1.0.0)

## Tickets traités:

- Montée de version

## Informations:

 - Cette version utilise les nouveaux environnements PHP8.3
 - Les actions ci-dessous sont spécifiques à la version 2.0.0 et ne sont à réaliser **qu'une seule fois**

### Préparation du fichier de configuration:

1/ Copier/coller le fichier **config.exemple.php** -> **config.php**

2/ Renseigner les constantes présentent dans le fichier:

    const DEBUG = false;

    /** Paramètres application */
    const LOG_FILE_NAME = 'web/log/app.log';
    const LOG_LEVEL = Logger::WARNING;
    const MAIL_EDITEUR = "@equipement.gouv.fr";
    const URL_USER_MANUAL = "";

    /** Paramètre base de données */
    const MYSQL_DSN = "mysql:host=localhost;port=3308;dbname=meridienne;charset=utf8mb4";
    const MYSQL_USER = "__MYSQL_USER__";
    const MYSQL_PASSWORD = "__MYSQL__PASSWORD__";
    const PDO_ERRORMODE = PDO::ERRMODE_EXCEPTION;
    const DATABASE_ENV = "Production"; //DEV / Préproduction / Production
   
    /** Paramètres serveur CAS */
    const CAS_HOST = "localhost"; // serveur CAS Host
    const CAS_PORT = 8085;        // serveur CAS port
    const CAS_CONTEXT = "/cas";   // serveur CAS sous répertoire
    const CAS_CLIENT_SERVICE_NAME = "https://www.meridienne.developpement-durable.gouv.fr/"; // Url de retour sur l'application depuis CAS serveur,
    const CAS_PROTOCOL = 'https';  // Protocol https / http pour le serveur CAS ou pour le bouchon
    const CAS_SERVER_CERT_FILE = __DIR__ . "/cert/IGC_A.crt"; 

3/ Récupérer le certificat du CAS serveur et le stocker dans le dossier "cert" (CAS_SERVER_CERT_FILE)

```


---

### 📄 `Notes-d'installation/Notes-d'installation-v1.6.41.md` [2.028 octets]
<a id="Notes-d'installation-Notes-d'installation-v1-6-41-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Notes-d'installation-v1-6-41-md)

> **Chemin relatif** : `Notes-d'installation/Notes-d'installation-v1.6.41.md`  
> **Taille** : 2.028 octets  
> **Lignes** : 80  
> **Type** : markdown

````markdown
---
title: Note d'installation v1.6.41
---




# Ticket

- 21438 : Procès-verbal baccalauréat CGEM commerce

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

`X.Y.Z` version applicative à déployer.
> Exemple : 1.2.3 pour la v1.2.3.

## Entrants

La livraison 1.6.41 est disponible depuis Gitlab sous le tag 1.6.41-LIVREE. Elle comprend :
- un répertoire **web** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v1.6.41**.

Sinon, remonter une alerte [MAI PELLETIER]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires et fichier suivants du dossier **web** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- Modeles
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

Aucune action particulière n'est prévue dans cette étape.

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

````


---

### 📄 `Notes-d'installation/Template-Note-d'installation-vX.Y.Z.md` [3.106 octets]
<a id="Notes-d'installation-Template-Note-d'installation-vX-Y-Z-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installation-Template-Note-d'installation-vX-Y-Z-md)

> **Chemin relatif** : `Notes-d'installation/Template-Note-d'installation-vX.Y.Z.md`  
> **Taille** : 3.106 octets  
> **Lignes** : 102  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (102 lignes) - Cliquer pour déplier</summary>

````markdown
# Tickets

- XXXXX - Anomalie - Libellé de l'anomalie
- XXXXX - Evolution - Libellé de l'évolution

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

`X.Y.Z` version applicative à déployer.
> Exemple : 1.2.3 pour la v1.2.3.

## Entrants

Un fichier **livraison_meridienne_vX.Y.Z.zip** contenant PRECISER LE CHEMIN DE LIVRAISON RESANA
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Méridienne (php) > Livraisons > vX.Y.Z


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **vX.Y.Z**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

Une nouvelle configuration Cerbere est à reporter.

Modifier le fichier **config/cerbere.php** et modifier la variable **$cas_context** comme suit :

    $cas_context = "/exemple-de-changement-de-contexte-cerbere";

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Les scripts sont à exécuter dans l'ordre présenté ici.

### 1 - script_delete_products_expired

Vérifier que le script sera utile en lançant la requête suivante :

    COUNT(1) FROM PRODUCTS WHERE expired = true;

Le résultat doit être supérieur à 0. Sinon, remonter une alerte.

Lancer le script **db/script_delete_products_expired.sql**.

Vérifier la bonne exécution du script en lançant la requête suivante :

    COUNT(1) FROM PRODUCTS WHERE expired = true;

Le résultat doit être égal à 0. Sinon, remonter un problème de déploiement.

### 2 - script_alter_weird_variables

Lancer le script **db/script_alter_weird_variables.sql**.

Il n'est pas possible de vérifier techniquement le bon fonctionnement du script à travers une requête de validation.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.
````

</details>


---

### 📄 `Opérations-techniques/Backup-base-de-données.md` [516 octets]
<a id="Opérations-techniques-Backup-base-de-données-md"></a> [↩ Retour à l'arborescence](#tree-Opérations-techniques-Backup-base-de-données-md)

> **Chemin relatif** : `Opérations-techniques/Backup-base-de-données.md`  
> **Taille** : 516 octets  
> **Lignes** : 9  
> **Type** : markdown

```markdown
Le backup de la base de données consiste en un export entier de la base de données de l'application Méridienne. Celui-ci est effectué au travers de l'outil PhpMyAdmin par l'exploitation directement.

Le fichier d'export de la base de données doit contenir:
- l'ensemble de la structure des tables de la base de données
- l'ensemble du contenu des tables de la base de données
- l'ensemble des procédures stockées de la base de données

La configuration de l'export est à la discrétion de l'exploitation.

```


---

### 📄 `Opérations-techniques/Backup-données-applicatives.md` [577 octets]
<a id="Opérations-techniques-Backup-données-applicatives-md"></a> [↩ Retour à l'arborescence](#tree-Opérations-techniques-Backup-données-applicatives-md)

> **Chemin relatif** : `Opérations-techniques/Backup-données-applicatives.md`  
> **Taille** : 577 octets  
> **Lignes** : 9  
> **Type** : markdown

```markdown
Le backup des données applicatives consiste en une sauvegarde complète des fichiers du projet.

L'ensemble du répertoire **web** sur le serveur doit être archivé dans un fichier **meridienne_sources_<#ENV>_DDMMYYYY.zip**

Ce fichier doit ensuite être conservé dans un endroit sécurisé, à minima, jusqu'à la clôture complète de la livraison. Le lieu de stockage est à la discrétion de l'exploitation, tant qu'il diffère du répertoire applicatif **web**.

Variables :
- <#ENV> = Environnement concerné (PREPROD, PROD)
- DDMMYYYY = Date du jour de l'intervention
```


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

`````

</details>


---

### 📄 `si/meridienne_fiche.md` [15.454 octets]
<a id="si-meridienne_fiche-md"></a> [↩ Retour à l'arborescence](#tree-si-meridienne_fiche-md)

> **Chemin relatif** : `si/meridienne_fiche.md`  
> **Taille** : 15.454 octets  
> **Lignes** : 277  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (277 lignes) - Cliquer pour déplier</summary>

```markdown
<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><b><span style='font-size:24.0pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
mso-font-kerning:18.0pt;mso-fareast-language:FR'><span class=msoIns><ins>Fiche
technique</ins></span><o:p></o:p></span></b></p>

<table class=MsoNormalTable border=0 cellpadding=0 style='mso-cellspacing:1.5pt;
 mso-yfti-tbllook:1184'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td style='background:lightgrey;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><b><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";color:black;mso-fareast-language:
  FR'>Base de connaissance</span></b><span style='font-size:12.0pt;font-family:
  "Times New Roman",serif;mso-fareast-font-family:"Times New Roman";color:black;
  mso-fareast-language:FR'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'><a
  href="https://sirh.projets.developpement-durable.gouv.fr/issues/18157">https://sirh.projets.developpement-durable.gouv.fr/issues/18157</a><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<div class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
text-align:center;line-height:normal'><span style='font-size:12.0pt;font-family:
"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";mso-fareast-language:
FR'>

<hr size=2 width="100%" align=center>

</span></div>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><a name=Périmètre-MCO></a><b><span
style='font-size:24.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-font-kerning:18.0pt;mso-fareast-language:FR'>Périmètre
MCO<o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Activités
reprises par la MCO ATOS : <o:p></o:p></span></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l2 level1 lfo1;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Déploiements<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l2 level1 lfo1;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Gestion des incidents<o:p></o:p></span></li>
</ul>

<div class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
text-align:center;line-height:normal'><span style='font-size:12.0pt;font-family:
"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";mso-fareast-language:
FR'>

<hr size=2 width="100%" align=center>

</span></div>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><a name=Documentation></a><b><span
style='font-size:24.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-font-kerning:18.0pt;mso-fareast-language:FR'>Documentation<o:p></o:p></span></b></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l3 level1 lfo2;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>La documentation est disponible
     dans <b>&quot;K:\K-SNUM\14_PNM\PNM6\13 - Transfert_Méridienne_ATL4&quot;</b><o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l3 level1 lfo2;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Le lien WikiSI est le suivant : 
     <a href="https://wikisi.e2.rie.gouv.fr/wikisi/application/552/"> 
     https://wikisi.e2.rie.gouv.fr/wikisi/application/552/</a><o:p></o:p></span></li>
</ul>

<div class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
text-align:center;line-height:normal'><span style='font-size:12.0pt;font-family:
"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";mso-fareast-language:
FR'>

<hr size=2 width="100%" align=center>

</span></div>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><a name=Accès-Identifiants-Application></a><b><span
style='font-size:24.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-font-kerning:18.0pt;mso-fareast-language:FR'>Accès :
Identifiants, Application...<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><a name=Identifiants-et-mots-de-passe></a><b><span
style='font-size:18.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Identifiants et mots de passe<o:p></o:p></span></b></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l5 level1 lfo3;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Des identifiants et mots de
     passe sont disponibles dans le <span class=SpellE><b>Keepass</b></span><b>
     Coffre de l'exploitation</b> (Atos).<o:p></o:p></span></li>
</ul>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><a name=Accès-application></a><b><span
style='font-size:18.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Accès application<o:p></o:p></span></b></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l7 level1 lfo4;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'><a
     href="https://sirh.projets.developpement-durable.gouv.fr/issues/18157#Liens">Accès
     à l'application</a><o:p></o:p></span></li>
</ul>

<div class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
text-align:center;line-height:normal'><span style='font-size:12.0pt;font-family:
"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";mso-fareast-language:
FR'>

<hr size=2 width="100%" align=center>

</span></div>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><a name=Gestion-des-incidents></a><b><span
style='font-size:24.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-font-kerning:18.0pt;mso-fareast-language:FR'>Gestion des
incidents<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><a name=Criticité></a><b><span
style='font-size:18.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Criticité<o:p></o:p></span></b></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l4 level1 lfo5;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'><a
     href="https://sirh.projets.developpement-durable.gouv.fr/issues/18157#Criticit%C3%A9">Criticité</a><o:p></o:p></span></li>
</ul>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><a
name=Qui-prévenir-et-comment-en-cas-dincident></a><b><span style='font-size:
18.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
mso-fareast-language:FR'>Qui prévenir et comment en cas d'incident<o:p></o:p></span></b></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l6 level1 lfo6;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Si <b><span class=msoIns><ins>incident
     fonctionnel</ins></span></b> : <o:p></o:p></span></li>
 <ul type=circle>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;line-height:normal;mso-list:l6 level2 lfo6;tab-stops:list 72.0pt'><span
      style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
      "Times New Roman";mso-fareast-language:FR'>Solliciter la <b>société CGI
      dans <span class=SpellE>Redmine</span> SIRH</b><o:p></o:p></span></li>
 </ul>
</ul>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l1 level1 lfo7;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Si <b><span class=msoIns><ins>incident
     technique</ins></span></b> (Exemples : Erreur 404, erreur 501, erreur de
     communication...) : <o:p></o:p></span></li>
 <ul type=circle>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;line-height:normal;mso-list:l1 level2 lfo7;tab-stops:list 72.0pt'><span
      style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
      "Times New Roman";mso-fareast-language:FR'>Solliciter le <b>Centre
      Serveur dans <span class=SpellE>Redmine</span> Portail Hébergement</b><o:p></o:p></span></li>
 </ul>
</ul>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><a
name=Emplacement-des-fichiers-de-logs></a><b><span style='font-size:18.0pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
mso-fareast-language:FR'>Emplacement des fichiers de logs<o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Les fichiers
de logs se trouvent sur le <b>FTP MERIDIENNE</b> : <o:p></o:p></span></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l0 level1 lfo8;tab-stops:list 36.0pt'><b><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Pré-Production</span></b><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'> : dans le <b>répertoire
     &quot;/logs-<span class=SpellE>preprod</span>&quot;</b>.<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l0 level1 lfo8;tab-stops:list 36.0pt'><b><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Production</span></b><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'> : dans le <b>répertoire
     &quot;/logs-<span class=SpellE>prod</span>&quot;</b>.<o:p></o:p></span></li>
</ul>

<div class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
text-align:center;line-height:normal'><span style='font-size:12.0pt;font-family:
"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";mso-fareast-language:
FR'>

<hr size=2 width="100%" align=center>

</span></div>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><a
name=Fiche-dexploitation-Erreurs-connues></a><b><span style='font-size:24.0pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
mso-font-kerning:18.0pt;mso-fareast-language:FR'>Fiche d'exploitation / Erreurs
connues<o:p></o:p></span></b></p>

<table class=MsoNormalTable border=0 cellpadding=0 style='mso-cellspacing:1.5pt;
 mso-yfti-tbllook:1184'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='background:lightgrey;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><b><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";color:black;mso-fareast-language:
  FR'>Description</span></b><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";color:black;mso-fareast-language:
  FR'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Lien<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;mso-yfti-lastrow:yes'>
  <td style='padding:.75pt .75pt .75pt .75pt'></td>
  <td style='padding:.75pt .75pt .75pt .75pt'></td>
 </tr>
</table>

<div class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
text-align:center;line-height:normal'><span style='font-size:12.0pt;font-family:
"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";mso-fareast-language:
FR'>

<hr size=2 width="100%" align=center>

</span></div>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><a name=Déploiement></a><b><span
style='font-size:24.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-font-kerning:18.0pt;mso-fareast-language:FR'><a
href="https://sirh.projets.developpement-durable.gouv.fr/projects/psism/wiki/D%C3%A9ploiement">Déploiement</a><o:p></o:p></span></b></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

```

</details>


---

### 📄 `si/orchidee_fiche.md` [6.646 octets]
<a id="si-orchidee_fiche-md"></a> [↩ Retour à l'arborescence](#tree-si-orchidee_fiche-md)

> **Chemin relatif** : `si/orchidee_fiche.md`  
> **Taille** : 6.646 octets  
> **Lignes** : 256  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (256 lignes) - Cliquer pour déplier</summary>

```markdown
**<span dir="">Contexte et statut</span>**

<table>
<tr>
<td>

**<span dir="">Application utilisée pour la gestion des dossiers de bourse de lenseignement maritime (DAM : Direction des Affaires Maritimes).<br>Elle permet la gestion et le calcul des aides sociales attribuées aux élèves des lycées maritimes<br>Elle est utilisée par les Agents DGITM/DAM/GM2.<br>Elle a été développée par ATL4.</span>**
</td>
</tr>
</table>

**<span dir="">Criticité</span>**

**<span dir="">Période critique</span>**

<table>
<tr>
<td>

**<span dir="">Période critique : essentiellement <ins>août - septembre - octobre</ins> (Période de constitution des dossiers et d'attribution des bourses)</span>**
</td>
</tr>
</table>

<div>

---

</div>\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\*\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\*<span dir="">Statut du SI :</span>\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\*\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\*

**<span dir="">Versions</span>**

* <span dir="">Versions installées</span>

<table>
<tr>
<td>

**<span dir="">Environnement</span>**
</td>
<td>

**<span dir="">Version</span>**
</td>
<td>

**<span dir="">Date d'installation</span>**
</td>
</tr>
<tr>
<td>

<span dir="">Pré-Production</span>
</td>
<td>

**<span dir="">3.</span>2.1**
</td>
<td>

<span dir="">26/06/202</span>3
</td>
</tr>
<tr>
<td>

<span dir="">Production</span>
</td>
<td>

**<span dir="">3.1.</span>8**
</td>
<td>

<span dir="">18/06/2022</span>
</td>
</tr>
</table>

* <span dir="">Versions antérieures </span>[<span dir="">Détails des versions antérieures</span>](https://sirh.projets.developpement-durable.gouv.fr/issues/18156)

**<span dir="">Description technique</span>**

<table>
<tr>
<td>

**<span dir="">accès FTP en pré-production serveur: 10.167.151.200 protocole: FTP<br>PHP 5.4.45 <br>MySql 5.5<br>Apache 5.2<br>serveur de BDD de preprod : vm-alai-mysql-preprod <br>serveur de BDD de prod : vm-alai-mysql-01 <br>Nom de la BDD de preprod : orchidee <br>Nom de la BDD de prod : orchidee.</span>**
</td>
</tr>
</table>

**<span dir="">Infra</span>**

<table>
<tr>
<td>

**<span dir="">Acces FTP pré-production<br>Serveur : 10.167.151.200<br>login : orchidee<br>Le passwd est four soit par Pascal Joudiou soit par Nicolas Jourdain.</span>**
</td>
</tr>
</table>

**<span dir="">Hébergement</span>**

<span dir="">Préciser le type d'hébergement parmi : Nominal type acai, sec IAAS DOIP, extra dry (ex RGP, ORPA), , OSHIMAE, hébergement externe type ARMIN, ATE)</span>

**<span dir="">Préciser le VLAN :</span>**

**<span dir="">Machine(s) et OS : \
Serveur Linux</span>**

<table>
<tr>
<td>

**<span dir="">Server: vip-dns.ac.cs<br>Address: 10.167.130.2<br>Name: vm-alai-php5-preprod.ac.cs<br>Address: 10.167.151.200.</span>**
</td>
</tr>
</table>

<span dir="">Machine(s) : physique si extra dry, vm si sec, so si nominal ?\
OS : nom et version</span>

**<span dir="">Stockage</span>**

<span dir="">Préciser ce qui est stocké en local / en espace partagé (SAN, FTP, etc)</span>

**<span dir="">Techno</span>**

<span dir="">Langage/framework : **PHP-Mysql**</span>

<span dir="">SGBD : serveur de BDD de preprod : vm-alai-mysql-preprod \
serveur de BDD de prod : vm-alai-mysql-01 \
Nom de la BDD de preprod : orchidee \
Nom de la BDD de prod : orchidee</span>

<span dir="">Nom du serveur de base de données à renseigner dans les paramètres de \
l'application: db-mysql (pour une base MySQL)</span>

<span dir="">Ce nom est identique en preprod et en prod, ainsi vous n'avez pas à modifier \
     la chaîne de connexion de l'application à la base de données lors d'une \
     synchro preprod vers prod.</span>

<span dir="">Composants divers :</span>

<span dir="">Version JAVA</span>

**<span dir="">Statut pic</span>**

<span dir="">(eg : utilisation de git)</span>

**<span dir="">Services</span>**

**<span dir="">Supervision</span>**

<span dir="">Oui supervision par le centre serveur</span>

**<span dir="">Gestion des incidents et problèmes</span>**

<span dir="">Non</span>

**<span dir="">Gestion des changements, des mep, déploiements</span>**

**<span dir="">Gestion de conf</span>**

**<span dir="">Gestion des opérations dont sauvegardes\
Centre serveurs</span>**

**<span dir="">Gestion des RFS</span>**

**<span dir="">Gestion de la sécurité</span>**

**<span dir="">Gestion des accès et comptes</span>**

**<span dir="">Indicateurs</span>**

**<span dir="">Acteurs</span>**

* <span dir="">Pilote MCO</span>
* <span dir="">MOE :</span>
* **<span dir="">MOA : La maîtrise d'ouvrage est DGITM/DAM/GM2 : Mme Agnès DESBOIS (tél : 13342)</span>**
* <span dir="">MOA/AMO/Product Owner :</span>
* **<span dir="">AMO : DGITM/DAM : Noel Monot</span>**
* <span dir="">Scrum Master si agile :</span>
* <span dir="">TMA :</span>
* <span dir="">Hébergement :</span>
* <span dir="">Administration :</span>
* <span dir="">Exploit / MCO :</span>
* <span dir="">Assistance :</span>
* <span dir="">Formation, animation réseau, etc :</span>
* <span dir="">Supervision :</span>

<table>
<tr>
<td>

<span dir="">Destinataire</span>
</td>
<td>

<span dir="">Service</span>
</td>
</tr>
<tr>
<td>

<span dir="">Elodie N'GUYEN</span>
</td>
<td>

<span dir="">DGITM/DAM/GM2</span>
</td>
</tr>
<tr>
<td>

<span dir="">Murielle MELANGE</span>
</td>
<td>

<span dir="">DGITM/DAM/GM2</span>
</td>
</tr>
<tr>
<td>

<span dir="">Noël MONOT</span>
</td>
<td>

<span dir="">Chef du bureau DGITM/DAM/SI1</span>
</td>
</tr>
</table>

**<span dir="">Acquisitions</span>**

**<span dir="">Marchés mobilisés pour maintenance applicative, recette, exploitation</span>**

**<span dir="">Maintenance, support et licences matérielles, logicielles</span>**

**<span dir="">Liens / URL</span>**

**<span dir="">URL du site en pré-production :</span>**

<span dir="">http://orchidee.preprod.appli.i2/public/index.php</span>

**<span dir="">URL du site en production :</span>**

<span dir="">http://orchidee.appli.i2/public/index.php</span>

* <span dir="">fiche programme d'action annuelle correspondante</span>
* <span dir="">projet du portail hébergement</span>

 
```

</details>


---

### 📄 `si/palome-django.md` [428.858 octets]
<a id="si-palome-django-md"></a> [↩ Retour à l'arborescence](#tree-si-palome-django-md)

> **Chemin relatif** : `si/palome-django.md`  
> **Taille** : 428.858 octets  
> **Lignes** : 14355  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (14355 lignes) - Cliquer pour déplier</summary>

`````markdown
﻿# Projet : palome-django

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\palome-django`

**Fichiers** : 105 fichiers non-binaires

## 📁 Arborescence des fichiers

├── **app/**
│   ├── **forms/**
│   │   ├── <a id="tree-app-forms-__init__-py"></a>[__init__.py](#app-forms-__init__-py) *(42 octets)*
│   │   └── <a id="tree-app-forms-housing-py"></a>[housing.py](#app-forms-housing-py) *(3.395 octets)*
│   ├── **migrations/**
│   │   ├── <a id="tree-app-migrations-0001_initial-py"></a>[0001_initial.py](#app-migrations-0001_initial-py) *(2.104 octets)*
│   │   ├── <a id="tree-app-migrations-0002_alter_logement_floor-py"></a>[0002_alter_logement_floor.py](#app-migrations-0002_alter_logement_floor-py) *(372 octets)*
│   │   ├── <a id="tree-app-migrations-0003_rename_logement_housing-py"></a>[0003_rename_logement_housing.py](#app-migrations-0003_rename_logement_housing-py) *(331 octets)*
│   │   ├── <a id="tree-app-migrations-0004_housing_created_housing_modified-py"></a>[0004_housing_created_housing_modified.py](#app-migrations-0004_housing_created_housing_modified-py) *(752 octets)*
│   │   ├── <a id="tree-app-migrations-0005_alter_housing_options_alter_housing_added_on_and_more-py"></a>[0005_alter_housing_options_alter_housing_added_on_and_more.py](#app-migrations-0005_alter_housing_options_alter_housing_added_on_and_more-py) *(5.371 octets)*
│   │   ├── <a id="tree-app-migrations-0006_remove_housing_code_alter_housing_number_and_more-py"></a>[0006_remove_housing_code_alter_housing_number_and_more.py](#app-migrations-0006_remove_housing_code_alter_housing_number_and_more-py) *(1.227 octets)*
│   │   ├── <a id="tree-app-migrations-0007_housing_displayed-py"></a>[0007_housing_displayed.py](#app-migrations-0007_housing_displayed-py) *(444 octets)*
│   │   ├── <a id="tree-app-migrations-0008_alter_housing_heating-py"></a>[0008_alter_housing_heating.py](#app-migrations-0008_alter_housing_heating-py) *(408 octets)*
│   │   └── <a id="tree-app-migrations-__init__-py"></a>[__init__.py](#app-migrations-__init__-py) *(0 octets)*
│   ├── **models/**
│   │   ├── <a id="tree-app-models-__init__-py"></a>[__init__.py](#app-models-__init__-py) *(39 octets)*
│   │   └── <a id="tree-app-models-housing-py"></a>[housing.py](#app-models-housing-py) *(2.430 octets)*
│   ├── **static/**
│   │   └── **app/**
│   │       └── **css/**
│   │           ├── **application/**
│   │           │   └── <a id="tree-app-static-app-css-application-application-css"></a>[application.css](#app-static-app-css-application-application-css) *(879 octets)*
│   │           ├── **intranet/**
│   │           │   ├── <a id="tree-app-static-app-css-intranet-complet-css"></a>[complet.css](#app-static-app-css-intranet-complet-css) *(22.711 octets)*
│   │           │   ├── <a id="tree-app-static-app-css-intranet-couleurs-css"></a>[couleurs.css](#app-static-app-css-intranet-couleurs-css) *(3.444 octets)*
│   │           │   └── <a id="tree-app-static-app-css-intranet-menu-horizontal-css"></a>[menu-horizontal.css](#app-static-app-css-intranet-menu-horizontal-css) *(1.014 octets)*
│   │           └── **texte/**
│   │               └── <a id="tree-app-static-app-css-texte-texte_seul-css"></a>[texte_seul.css](#app-static-app-css-texte-texte_seul-css) *(150 octets)*
│   ├── **templates/**
│   │   └── **app/**
│   │       ├── <a id="tree-app-templates-app-accessibilite-html"></a>[accessibilite.html](#app-templates-app-accessibilite-html) *(1.742 octets)*
│   │       ├── <a id="tree-app-templates-app-afficherlogements-html"></a>[afficherlogements.html](#app-templates-app-afficherlogements-html) *(2.431 octets)*
│   │       ├── <a id="tree-app-templates-app-aide-html"></a>[aide.html](#app-templates-app-aide-html) *(1.085 octets)*
│   │       ├── <a id="tree-app-templates-app-base-html"></a>[base.html](#app-templates-app-base-html) *(11.813 octets)*
│   │       ├── <a id="tree-app-templates-app-cartelogements-html"></a>[cartelogements.html](#app-templates-app-cartelogements-html) *(16.998 octets)*
│   │       ├── <a id="tree-app-templates-app-error-html"></a>[error.html](#app-templates-app-error-html) *(1.265 octets)*
│   │       ├── <a id="tree-app-templates-app-index-html"></a>[index.html](#app-templates-app-index-html) *(1.718 octets)*
│   │       ├── <a id="tree-app-templates-app-listerlogements-html"></a>[listerlogements.html](#app-templates-app-listerlogements-html) *(2.046 octets)*
│   │       ├── <a id="tree-app-templates-app-parc-html"></a>[parc.html](#app-templates-app-parc-html) *(659 octets)*
│   │       ├── <a id="tree-app-templates-app-plan-html"></a>[plan.html](#app-templates-app-plan-html) *(2.747 octets)*
│   │       ├── <a id="tree-app-templates-app-procedure_interministere-html"></a>[procedure_interministere.html](#app-templates-app-procedure_interministere-html) *(2.485 octets)*
│   │       ├── <a id="tree-app-templates-app-procedure_ministere-html"></a>[procedure_ministere.html](#app-templates-app-procedure_ministere-html) *(3.840 octets)*
│   │       ├── <a id="tree-app-templates-app-residencebollee-html"></a>[residencebollee.html](#app-templates-app-residencebollee-html) *(3.462 octets)*
│   │       ├── <a id="tree-app-templates-app-residencerenan-html"></a>[residencerenan.html](#app-templates-app-residencerenan-html) *(5.007 octets)*
│   │       ├── <a id="tree-app-templates-app-studette-html"></a>[studette.html](#app-templates-app-studette-html) *(1.605 octets)*
│   │       ├── <a id="tree-app-templates-app-studio-html"></a>[studio.html](#app-templates-app-studio-html) *(1.769 octets)*
│   │       └── <a id="tree-app-templates-app-taillelogement-html"></a>[taillelogement.html](#app-templates-app-taillelogement-html) *(1.274 octets)*
│   ├── **views/**
│   │   ├── **errors/**
│   │   │   ├── <a id="tree-app-views-errors-error403-py"></a>[error403.py](#app-views-errors-error403-py) *(192 octets)*
│   │   │   ├── <a id="tree-app-views-errors-error404-py"></a>[error404.py](#app-views-errors-error404-py) *(192 octets)*
│   │   │   └── <a id="tree-app-views-errors-error500-py"></a>[error500.py](#app-views-errors-error500-py) *(191 octets)*
│   │   ├── <a id="tree-app-views-__init__-py"></a>[__init__.py](#app-views-__init__-py) *(957 octets)*
│   │   ├── <a id="tree-app-views-accessibilite-py"></a>[accessibilite.py](#app-views-accessibilite-py) *(123 octets)*
│   │   ├── <a id="tree-app-views-accueil-py"></a>[accueil.py](#app-views-accueil-py) *(109 octets)*
│   │   ├── <a id="tree-app-views-afficher_logement-py"></a>[afficher_logement.py](#app-views-afficher_logement-py) *(462 octets)*
│   │   ├── <a id="tree-app-views-aide_generale-py"></a>[aide_generale.py](#app-views-aide_generale-py) *(114 octets)*
│   │   ├── <a id="tree-app-views-carte_logements-py"></a>[carte_logements.py](#app-views-carte_logements-py) *(2.178 octets)*
│   │   ├── <a id="tree-app-views-index-py"></a>[index.py](#app-views-index-py) *(92 octets)*
│   │   ├── <a id="tree-app-views-lister_logements-py"></a>[lister_logements.py](#app-views-lister_logements-py) *(410 octets)*
│   │   ├── <a id="tree-app-views-parc_logement-py"></a>[parc_logement.py](#app-views-parc_logement-py) *(114 octets)*
│   │   ├── <a id="tree-app-views-plan-py"></a>[plan.py](#app-views-plan-py) *(105 octets)*
│   │   ├── <a id="tree-app-views-procedure_interministere-py"></a>[procedure_interministere.py](#app-views-procedure_interministere-py) *(145 octets)*
│   │   ├── <a id="tree-app-views-procedure_ministere-py"></a>[procedure_ministere.py](#app-views-procedure_ministere-py) *(135 octets)*
│   │   ├── <a id="tree-app-views-residence_leon_bollee-py"></a>[residence_leon_bollee.py](#app-views-residence_leon_bollee-py) *(133 octets)*
│   │   ├── <a id="tree-app-views-residence_renan-py"></a>[residence_renan.py](#app-views-residence_renan-py) *(126 octets)*
│   │   ├── <a id="tree-app-views-studette-py"></a>[studette.py](#app-views-studette-py) *(113 octets)*
│   │   ├── <a id="tree-app-views-studio-py"></a>[studio.py](#app-views-studio-py) *(109 octets)*
│   │   └── <a id="tree-app-views-taille_logement-py"></a>[taille_logement.py](#app-views-taille_logement-py) *(126 octets)*
│   ├── <a id="tree-app-__init__-py"></a>[__init__.py](#app-__init__-py) *(0 octets)*
│   ├── <a id="tree-app-admin-py"></a>[admin.py](#app-admin-py) *(210 octets)*
│   ├── <a id="tree-app-apps-py"></a>[apps.py](#app-apps-py) *(187 octets)*
│   ├── <a id="tree-app-crons-py"></a>[crons.py](#app-crons-py) *(3.984 octets)*
│   ├── <a id="tree-app-signals-py"></a>[signals.py](#app-signals-py) *(347 octets)*
│   ├── <a id="tree-app-tests-py"></a>[tests.py](#app-tests-py) *(60 octets)*
│   └── <a id="tree-app-urls-py"></a>[urls.py](#app-urls-py) *(1.482 octets)*
├── **deploy/**
│   └── <a id="tree-deploy-vhost-conf"></a>[vhost.conf](#deploy-vhost-conf) *(394 octets)*
├── **palome/**
│   ├── <a id="tree-palome-__init__-py"></a>[__init__.py](#palome-__init__-py) *(0 octets)*
│   ├── <a id="tree-palome-asgi-py"></a>[asgi.py](#palome-asgi-py) *(167 octets)*
│   ├── <a id="tree-palome-settings-py"></a>[settings.py](#palome-settings-py) *(5.007 octets)*
│   ├── <a id="tree-palome-urls-py"></a>[urls.py](#palome-urls-py) *(1.107 octets)*
│   └── <a id="tree-palome-wsgi-py"></a>[wsgi.py](#palome-wsgi-py) *(167 octets)*
├── **static/**
│   ├── **admin/**
│   │   ├── **css/**
│   │   │   ├── **vendor/**
│   │   │   │   └── **select2/**
│   │   │   │       ├── <a id="tree-static-admin-css-vendor-select2-LICENSE-SELECT2-md"></a>[LICENSE-SELECT2.md](#static-admin-css-vendor-select2-LICENSE-SELECT2-md) *(1.124 octets)*
│   │   │   │       ├── <a id="tree-static-admin-css-vendor-select2-select2-css"></a>[select2.css](#static-admin-css-vendor-select2-select2-css) *(17.358 octets)*
│   │   │   │       └── <a id="tree-static-admin-css-vendor-select2-select2-min-css"></a>[select2.min.css](#static-admin-css-vendor-select2-select2-min-css) *(14.966 octets)*
│   │   │   ├── <a id="tree-static-admin-css-autocomplete-css"></a>[autocomplete.css](#static-admin-css-autocomplete-css) *(9.114 octets)*
│   │   │   ├── <a id="tree-static-admin-css-base-css"></a>[base.css](#static-admin-css-base-css) *(21.207 octets)*
│   │   │   ├── <a id="tree-static-admin-css-changelists-css"></a>[changelists.css](#static-admin-css-changelists-css) *(6.584 octets)*
│   │   │   ├── <a id="tree-static-admin-css-dark_mode-css"></a>[dark_mode.css](#static-admin-css-dark_mode-css) *(2.929 octets)*
│   │   │   ├── <a id="tree-static-admin-css-dashboard-css"></a>[dashboard.css](#static-admin-css-dashboard-css) *(441 octets)*
│   │   │   ├── <a id="tree-static-admin-css-forms-css"></a>[forms.css](#static-admin-css-forms-css) *(8.953 octets)*
│   │   │   ├── <a id="tree-static-admin-css-login-css"></a>[login.css](#static-admin-css-login-css) *(958 octets)*
│   │   │   ├── <a id="tree-static-admin-css-nav_sidebar-css"></a>[nav_sidebar.css](#static-admin-css-nav_sidebar-css) *(2.694 octets)*
│   │   │   ├── <a id="tree-static-admin-css-responsive-css"></a>[responsive.css](#static-admin-css-responsive-css) *(18.533 octets)*
│   │   │   ├── <a id="tree-static-admin-css-responsive_rtl-css"></a>[responsive_rtl.css](#static-admin-css-responsive_rtl-css) *(1.785 octets)*
│   │   │   ├── <a id="tree-static-admin-css-rtl-css"></a>[rtl.css](#static-admin-css-rtl-css) *(4.694 octets)*
│   │   │   └── <a id="tree-static-admin-css-widgets-css"></a>[widgets.css](#static-admin-css-widgets-css) *(11.900 octets)*
│   │   ├── **img/**
│   │   │   ├── <a id="tree-static-admin-img-LICENSE"></a>[LICENSE](#static-admin-img-LICENSE) *(1.081 octets)*
│   │   │   └── <a id="tree-static-admin-img-README-txt"></a>[README.txt](#static-admin-img-README-txt) *(319 octets)*
│   │   └── **js/**
│   │       └── **vendor/**
│   │           ├── **jquery/**
│   │           │   └── <a id="tree-static-admin-js-vendor-jquery-LICENSE-txt"></a>[LICENSE.txt](#static-admin-js-vendor-jquery-LICENSE-txt) *(1.097 octets)*
│   │           ├── **select2/**
│   │           │   └── <a id="tree-static-admin-js-vendor-select2-LICENSE-md"></a>[LICENSE.md](#static-admin-js-vendor-select2-LICENSE-md) *(1.124 octets)*
│   │           └── **xregexp/**
│   │               └── <a id="tree-static-admin-js-vendor-xregexp-LICENSE-txt"></a>[LICENSE.txt](#static-admin-js-vendor-xregexp-LICENSE-txt) *(1.103 octets)*
│   └── **app/**
│       └── **css/**
│           ├── **application/**
│           │   └── <a id="tree-static-app-css-application-application-css"></a>[application.css](#static-app-css-application-application-css) *(879 octets)*
│           ├── **intranet/**
│           │   ├── <a id="tree-static-app-css-intranet-complet-css"></a>[complet.css](#static-app-css-intranet-complet-css) *(22.711 octets)*
│           │   ├── <a id="tree-static-app-css-intranet-couleurs-css"></a>[couleurs.css](#static-app-css-intranet-couleurs-css) *(3.444 octets)*
│           │   └── <a id="tree-static-app-css-intranet-menu-horizontal-css"></a>[menu-horizontal.css](#static-app-css-intranet-menu-horizontal-css) *(1.014 octets)*
│           └── **texte/**
│               └── <a id="tree-static-app-css-texte-texte_seul-css"></a>[texte_seul.css](#static-app-css-texte-texte_seul-css) *(150 octets)*
├── <a id="tree--env-sample"></a>[.env.sample](#-env-sample) *(459 octets)*
├── <a id="tree--gitignore"></a>[.gitignore](#-gitignore) *(3.114 octets)*
├── <a id="tree--gitlab-ci-yml"></a>[.gitlab-ci.yml](#-gitlab-ci-yml) *(1.205 octets)*
├── <a id="tree-Dockerfile"></a>[Dockerfile](#Dockerfile) *(1.218 octets)*
├── <a id="tree-VERSION"></a>[VERSION](#VERSION) *(5 octets)*
├── <a id="tree-__init__-py"></a>[__init__.py](#__init__-py) *(0 octets)*
├── <a id="tree-docker-compose-dev-yml"></a>[docker-compose.dev.yml](#docker-compose-dev-yml) *(1.100 octets)*
├── <a id="tree-docker-compose-prod-yml"></a>[docker-compose.prod.yml](#docker-compose-prod-yml) *(876 octets)*
├── <a id="tree-makefile"></a>[makefile](#makefile) *(389 octets)*
├── <a id="tree-manage-py"></a>[manage.py](#manage-py) *(662 octets)*
├── <a id="tree-poetry-lock"></a>[poetry.lock](#poetry-lock) *(70.520 octets)*
└── <a id="tree-pyproject-toml"></a>[pyproject.toml](#pyproject-toml) *(611 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `.env.sample` [459 octets]
<a id="-env-sample"></a> [↩ Retour à l'arborescence](#tree--env-sample)

> **Chemin relatif** : `.env.sample`  
> **Taille** : 459 octets  
> **Lignes** : 16  
> **Type** : text

```text
DJANGO_DEBUG=True
CSRF_TRUSTED_ORIGINS=http://localhost,http://127.0.0.1,http://localhost:8080
CSRF_COOKIE_SECURE=False
CSRF_COOKIE_HTTPONLY=False
CSRF_TRUSTED_ORIGINS=http://localhost
CSRF_USE_PROXY=False
SECURE_CROSS_ORIGIN_OPENER_POLICY=None
HTTP_PROXY=
POSTGRES_HOST=
POSTGRES_PORT=5432
POSTGRES_DB=
POSTGRES_USER=
POSTGRES_PASSWORD=
AUTH_MODE=local
CAS_SERVER_URL=https://authentification.din.developpement-durable.gouv.fr/cas/public
CAS_ROOT_PROXIED_AS=
```


---

### 📄 `.gitignore` [3.114 octets]
<a id="-gitignore"></a> [↩ Retour à l'arborescence](#tree--gitignore)

> **Chemin relatif** : `.gitignore`  
> **Taille** : 3.114 octets  
> **Lignes** : 165  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (165 lignes) - Cliquer pour déplier</summary>

```text
env
.DS_Store
db.sqlite3
src/static

# Byte-compiled / optimized / DLL files
__pycache__/
*.py[cod]
*$py.class

# C extensions
*.so

# Distribution / packaging
.Python
build/
develop-eggs/
dist/
downloads/
eggs/
.eggs/
lib/
lib64/
parts/
sdist/
var/
wheels/
share/python-wheels/
*.egg-info/
.installed.cfg
*.egg
MANIFEST

# PyInstaller
#  Usually these files are written by a python script from a template
#  before PyInstaller builds the exe, so as to inject date/other infos into it.
*.manifest
*.spec

# Installer logs
pip-log.txt
pip-delete-this-directory.txt

# Unit test / coverage reports
htmlcov/
.tox/
.nox/
.coverage
.coverage.*
.cache
nosetests.xml
coverage.xml
*.cover
*.py,cover
.hypothesis/
.pytest_cache/
cover/

# Translations
*.mo
*.pot

# Django stuff:
*.log
local_settings.py
db.sqlite3
db.sqlite3-journal

# Flask stuff:
instance/
.webassets-cache

# Scrapy stuff:
.scrapy

# Sphinx documentation
docs/_build/

# PyBuilder
.pybuilder/
target/

# Jupyter Notebook
.ipynb_checkpoints

# IPython
profile_default/
ipython_config.py

# pyenv
#   For a library or package, you might want to ignore these files since the code is
#   intended to run in multiple environments; otherwise, check them in:
# .python-version

# pipenv
#   According to pypa/pipenv#598, it is recommended to include Pipfile.lock in version control.
#   However, in case of collaboration, if having platform-specific dependencies or dependencies
#   having no cross-platform support, pipenv may install dependencies that don't work, or not
#   install all needed dependencies.
#Pipfile.lock

# poetry
#   Similar to Pipfile.lock, it is generally recommended to include poetry.lock in version control.
#   This is especially recommended for binary packages to ensure reproducibility, and is more
#   commonly ignored for libraries.
#   https://python-poetry.org/docs/basic-usage/#commit-your-poetrylock-file-to-version-control
#poetry.lock

# pdm
#   Similar to Pipfile.lock, it is generally recommended to include pdm.lock in version control.
#pdm.lock
#   pdm stores project-wide configurations in .pdm.toml, but it is recommended to not include it
#   in version control.
#   https://pdm.fming.dev/#use-with-ide
.pdm.toml

# PEP 582; used by e.g. github.com/David-OConnor/pyflow and github.com/pdm-project/pdm
__pypackages__/

# Celery stuff
celerybeat-schedule
celerybeat.pid

# SageMath parsed files
*.sage.py

# Environments
.env
.venv
env/
venv/
ENV/
env.bak/
venv.bak/

# Spyder project settings
.spyderproject
.spyproject

# Rope project settings
.ropeproject

# mkdocs documentation
/site

# mypy
.mypy_cache/
.dmypy.json
dmypy.json

# Pyre type checker
.pyre/

# pytype static type analyzer
.pytype/

# Cython debug symbols
cython_debug/

# PyCharm
#  JetBrains specific template is maintained in a separate JetBrains.gitignore that can
#  be found at https://github.com/github/gitignore/blob/main/Global/JetBrains.gitignore
#  and can be added to the global gitignore or merged into this file.  For a more nuclear
#  option (not recommended) you can uncomment the following to ignore the entire idea folder.
#.idea/
```

</details>


---

### 📄 `.gitlab-ci.yml` [1.205 octets]
<a id="-gitlab-ci-yml"></a> [↩ Retour à l'arborescence](#tree--gitlab-ci-yml)

> **Chemin relatif** : `.gitlab-ci.yml`  
> **Taille** : 1.205 octets  
> **Lignes** : 35  
> **Type** : yaml

```yaml
stages:
  - build_image

# ---------- IMAGE BUILD when VERSION changes ----------
build_image:
  image: registry.gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/gti/images/pnm3-buildkit:latest
  stage: build_image
  variables:
    BUILDKITD_FLAGS: --oci-worker-no-process-sandbox
  before_script:
    - VERSION="$(grep -Eo '^[vV]?[0-9]+\.[0-9]+\.[0-9]+' VERSION | head -n1)"
    - echo "Building version:$VERSION"
  script:
    - |
      sed -i "207s@JJ\/MM\/AAAA@$(date '+%d/%m/%Y')@" app/templates/app/base.html
      sed -i "207s@X.Y.Z@v$VERSION@" app/templates/app/base.html
      sed -i "3s@VERSION@$VERSION@" pyproject.toml

      /auth.sh

      IMAGE_REF="$(printf '%s' "${CI_REGISTRY_IMAGE}" | tr '[:upper:]' '[:lower:]')"
      CACHE_REF="${IMAGE_REF}:buildcache"

      buildctl-daemonless.sh build \
          --frontend=dockerfile.v0 \
          --local context=. \
          --local dockerfile=. \
          --import-cache type=registry,ref="${CACHE_REF}" \
          --export-cache type=registry,ref="${CACHE_REF}",mode=max \
          --output type=image,name="${IMAGE_REF}:${VERSION}",name="${IMAGE_REF}:latest",push=true
  rules:
    - changes:
      - VERSION
  tags:
    - gcp
```


---

### 📄 `__init__.py` [0 octets]
<a id="__init__-py"></a> [↩ Retour à l'arborescence](#tree-__init__-py)

> **Chemin relatif** : `__init__.py`  
> **Taille** : 0 octets  
> **Lignes** : 0  
> **Type** : python

```python

```


---

### 📄 `app/__init__.py` [0 octets]
<a id="app-__init__-py"></a> [↩ Retour à l'arborescence](#tree-app-__init__-py)

> **Chemin relatif** : `app/__init__.py`  
> **Taille** : 0 octets  
> **Lignes** : 0  
> **Type** : python

```python

```


---

### 📄 `app/admin.py` [210 octets]
<a id="app-admin-py"></a> [↩ Retour à l'arborescence](#tree-app-admin-py)

> **Chemin relatif** : `app/admin.py`  
> **Taille** : 210 octets  
> **Lignes** : 13  
> **Type** : python

```python
from django.contrib import admin
from .forms import HousingForm
from .models import Housing


class HousingAdmin(admin.ModelAdmin):
    form = HousingForm

    pass


admin.site.register(Housing, HousingAdmin)

```


---

### 📄 `app/apps.py` [187 octets]
<a id="app-apps-py"></a> [↩ Retour à l'arborescence](#tree-app-apps-py)

> **Chemin relatif** : `app/apps.py`  
> **Taille** : 187 octets  
> **Lignes** : 10  
> **Type** : python

```python
from django.apps import AppConfig


class AppConfig(AppConfig):
    default_auto_field = "django.db.models.BigAutoField"
    name = "app"

    def ready(self):
        import app.signals

```


---

### 📄 `app/crons.py` [3.984 octets]
<a id="app-crons-py"></a> [↩ Retour à l'arborescence](#tree-app-crons-py)

> **Chemin relatif** : `app/crons.py`  
> **Taille** : 3.984 octets  
> **Lignes** : 93  
> **Type** : python

```python
from django_cron import CronJobBase, Schedule
from .models import Housing
from ftplib import FTP
from datetime import datetime
from pathlib import Path
from decouple import config

import csv, logging

logging.basicConfig(
    level=logging.DEBUG,
    format="%(asctime)s - %(levelname)s - %(message)s",
    filename="./cron.log",
    filemode="w",
)

# Build paths inside the project like this: BASE_DIR / 'subdir'.
BASE_DIR = Path(__file__).resolve().parent.parent.parent


class UpdateHousings(CronJobBase):
    RUN_EVERY_MINS = 1440  # every 24 hours

    schedule = Schedule(run_every_mins=RUN_EVERY_MINS)
    code = "app.update_housings"  # a unique code

    def do(self):
        # truncates the Housing table
        Housing.objects.all().delete()
        logging.debug("Housing table truncated")
        # fetches the data from the FTP server
        ftp = FTP(config("FTP_HOST", default=None, cast=str))
        ftp.login(
            config("FTP_USER", default=None, cast=str),
            config("FTP_PASS", default=None, cast=str),
        )
        ftp.cwd("csv")
        # checks if the file 'logements.txt' is present in the directory
        if "extrait.csv" in ftp.nlst():
            logging.debug("Data file has been found")
            with open("/tmp/housings.csv", "wb") as file:
                ftp.retrbinary("RETR extrait.csv", file.write)
                logging.debug("Data file has been downloaded")
            ftp.quit()
            # data processing
            with open("/tmp/housings.csv", "r", encoding="iso-8859-3") as file:
                csv_reader = csv.reader(file, delimiter="|")
                number_of_lines = 0
                for row in csv_reader:
                    if row:
                        try:
                            Housing(
                                added_on=datetime.strptime(
                                    row[0] + "+00:00", "%d/%m/%Y %H:%M%z"
                                ),
                                code=row[1],
                                number=row[2],
                                type=row[3],
                                address=row[4],
                                postal_code=row[5],
                                city=row[6],
                                floor=row[7],
                                size=row[8],
                                heating=row[9],
                                elevator=True if row[10] != "" else False,
                                intercom=True if row[11] != "" else False,
                                basement=True if row[12] != "" else False,
                                parking=True if row[13] != "" else False,
                                metro=True if row[14] != "" else False,
                                sncf=True if row[15] != "" else False,
                                rer=True if row[16] != "" else False,
                                bus=True if row[17] != "" else False,
                                info=row[18],
                                application_deadline=datetime.strptime(
                                    row[19] + "+00:00", "%d/%m/%y%z"
                                ),
                                renting_from=datetime.strptime(
                                    row[20] + "+00:00", "%d/%m/%y%z"
                                ),
                                rent_and_utilities=row[21],
                                minimum_income=row[22],
                                renting_model=row[23],
                                zone=row[24],
                                number_of_applications=row[25],
                            ).save()
                            number_of_lines += 1
                        except Exception as e:
                            logging.debug(f"Error: {e}")
                logging.debug(f"{number_of_lines} housings added to db!")
        else:
            logging.debug("No data file has been found")
        pass

```


---

### 📄 `app/forms/__init__.py` [42 octets]
<a id="app-forms-__init__-py"></a> [↩ Retour à l'arborescence](#tree-app-forms-__init__-py)

> **Chemin relatif** : `app/forms/__init__.py`  
> **Taille** : 42 octets  
> **Lignes** : 2  
> **Type** : python

```python
from app.forms.housing import HousingForm

```


---

### 📄 `app/forms/housing.py` [3.395 octets]
<a id="app-forms-housing-py"></a> [↩ Retour à l'arborescence](#tree-app-forms-housing-py)

> **Chemin relatif** : `app/forms/housing.py`  
> **Taille** : 3.395 octets  
> **Lignes** : 109  
> **Type** : python

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (109 lignes) - Cliquer pour déplier</summary>

```python
from app.models import Housing
from django import forms
from django.contrib.admin.widgets import AdminDateWidget
from datetime import datetime

zone_choices = [
    ("75", "Paris"),
    ("77", "Seine-et-Marne"),
    ("78", "Yvelines"),
    ("91", "Essonne"),
    ("92Sud", "Hauts-de-Seine Sud"),
    ("92Centre", "Hauts-de-Seine Centre"),
    ("92Ouest", "Hauts-de-Seine Ouest"),
    ("92Nord", "Hauts-de-Seine Nord"),
    ("93Nord", "Seine-Saint-Denis Nord"),
    ("93Est", "Seine-Saint-Denis Est"),
    ("94Sud", "Val-de-Marne Sud"),
    ("94Ouest", "Val-de-Marne Ouest"),
    ("94Nord", "Val-de-Marne Nord"),
    ("94Est", "Val-de-Marne Est"),
    ("95", "Val-d'Oise"),
]

renting_model_choices = [
    ("social", "Social"),
    ("intermediaire", "Intermédiaire"),
    ("nonplafonne", "Non plafonné"),
]

type_choices = [
    ("T1", "T1"),
    ("T2", "T2"),
    ("T3", "T3"),
    ("T4", "T4"),
    ("T5", "T5"),
]

heating_choices = [
    ("Collectif", "Collectif"),
    ("Individuel Gaz", "Individuel Gaz"),
    ("Individuel Electrique", "Individuel Electrique"),
]


class HousingForm(forms.ModelForm):
    displayed = forms.BooleanField(required=False, label="À afficher")
    number = forms.CharField(required=True, label="Numéro *")
    type = forms.ChoiceField(choices=type_choices, required=True, label="Type *")
    address = forms.CharField(required=True, label="Adresse *")
    postal_code = forms.CharField(required=True, label="Code postal *")
    city = forms.CharField(required=True, label="Ville *")
    floor = forms.CharField(required=True, label="Etage *")
    size = forms.CharField(required=True, label="Superficie (m²) *")
    heating = forms.ChoiceField(
        choices=heating_choices, required=True, label="Chauffage *"
    )
    info = forms.CharField(widget=forms.Textarea(), required=False, label="Remarque")
    application_deadline = forms.DateField(
        widget=AdminDateWidget(),
        label="Date limite de candidature *",
    )
    renting_from = forms.DateField(
        widget=AdminDateWidget(), label="Location prévue le *"
    )
    rent_and_utilities = forms.CharField(
        required=True, label="Loyer charges comprises (€) *"
    )
    renting_model = forms.ChoiceField(
        choices=renting_model_choices, required=True, label="Catégorie *"
    )
    zone = forms.ChoiceField(
        choices=zone_choices, required=True, label="Zone sur la carte *"
    )
    number_of_applications = forms.IntegerField(
        required=True, label="Nombre de candidatures enregistrées *"
    )

    class Meta:
        model = Housing
        fields = "__all__"
        exclude = ["minimum_income", "added_on"]

    def clean_city(self):
        return self.cleaned_data["city"].upper()

    def clean_application_deadline(self):
        old_date = self.cleaned_data["application_deadline"]
        new_datetime = datetime(
            year=old_date.year,
            month=old_date.month,
            day=old_date.day,
            hour=12,
            minute=0,
            second=0,
        )
        return new_datetime

    def clean_renting_from(self):
        old_date = self.cleaned_data["renting_from"]
        new_datetime = datetime(
            year=old_date.year,
            month=old_date.month,
            day=old_date.day,
            hour=12,
            minute=0,
            second=0,
        )
        return new_datetime

```

</details>


---

### 📄 `app/migrations/0001_initial.py` [2.104 octets]
<a id="app-migrations-0001_initial-py"></a> [↩ Retour à l'arborescence](#tree-app-migrations-0001_initial-py)

> **Chemin relatif** : `app/migrations/0001_initial.py`  
> **Taille** : 2.104 octets  
> **Lignes** : 48  
> **Type** : python

```python
# Generated by Django 4.2.2 on 2023-06-19 13:52

import datetime
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='Logement',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('added_on', models.DateTimeField(blank=True, default=datetime.datetime.now)),
                ('code', models.IntegerField()),
                ('number', models.IntegerField()),
                ('type', models.CharField(max_length=4)),
                ('address', models.CharField(max_length=300)),
                ('postal_code', models.CharField(max_length=6)),
                ('city', models.CharField(max_length=100)),
                ('floor', models.CharField(max_length=2)),
                ('size', models.CharField(max_length=3)),
                ('heating', models.CharField(max_length=20)),
                ('elevator', models.BooleanField(default=False)),
                ('intercom', models.BooleanField(default=False)),
                ('basement', models.BooleanField(default=False)),
                ('parking', models.BooleanField(default=False)),
                ('metro', models.BooleanField(default=False)),
                ('sncf', models.BooleanField(default=False)),
                ('rer', models.BooleanField(default=False)),
                ('bus', models.BooleanField(default=False)),
                ('info', models.CharField(max_length=500)),
                ('application_deadline', models.DateTimeField()),
                ('renting_from', models.DateTimeField()),
                ('rent_and_utilities', models.CharField(max_length=4)),
                ('minimum_income', models.CharField(max_length=4)),
                ('renting_model', models.CharField(max_length=20)),
                ('zone', models.CharField(max_length=20)),
                ('number_of_applications', models.IntegerField(default=0)),
            ],
        ),
    ]

```


---

### 📄 `app/migrations/0002_alter_logement_floor.py` [372 octets]
<a id="app-migrations-0002_alter_logement_floor-py"></a> [↩ Retour à l'arborescence](#tree-app-migrations-0002_alter_logement_floor-py)

> **Chemin relatif** : `app/migrations/0002_alter_logement_floor.py`  
> **Taille** : 372 octets  
> **Lignes** : 19  
> **Type** : python

```python
# Generated by Django 4.2.2 on 2023-06-19 14:00

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('app', '0001_initial'),
    ]

    operations = [
        migrations.AlterField(
            model_name='logement',
            name='floor',
            field=models.CharField(max_length=20),
        ),
    ]

```


---

### 📄 `app/migrations/0003_rename_logement_housing.py` [331 octets]
<a id="app-migrations-0003_rename_logement_housing-py"></a> [↩ Retour à l'arborescence](#tree-app-migrations-0003_rename_logement_housing-py)

> **Chemin relatif** : `app/migrations/0003_rename_logement_housing.py`  
> **Taille** : 331 octets  
> **Lignes** : 18  
> **Type** : python

```python
# Generated by Django 4.2.2 on 2023-07-11 10:02

from django.db import migrations


class Migration(migrations.Migration):

    dependencies = [
        ('app', '0002_alter_logement_floor'),
    ]

    operations = [
        migrations.RenameModel(
            old_name='Logement',
            new_name='Housing',
        ),
    ]

```


---

### 📄 `app/migrations/0004_housing_created_housing_modified.py` [752 octets]
<a id="app-migrations-0004_housing_created_housing_modified-py"></a> [↩ Retour à l'arborescence](#tree-app-migrations-0004_housing_created_housing_modified-py)

> **Chemin relatif** : `app/migrations/0004_housing_created_housing_modified.py`  
> **Taille** : 752 octets  
> **Lignes** : 26  
> **Type** : python

```python
# Generated by Django 4.2.2 on 2023-07-11 12:12

from django.db import migrations
import django.utils.timezone
import model_utils.fields


class Migration(migrations.Migration):

    dependencies = [
        ('app', '0003_rename_logement_housing'),
    ]

    operations = [
        migrations.AddField(
            model_name='housing',
            name='created',
            field=model_utils.fields.AutoCreatedField(default=django.utils.timezone.now, editable=False, verbose_name='created'),
        ),
        migrations.AddField(
            model_name='housing',
            name='modified',
            field=model_utils.fields.AutoLastModifiedField(default=django.utils.timezone.now, editable=False, verbose_name='modified'),
        ),
    ]

```


---

### 📄 `app/migrations/0005_alter_housing_options_alter_housing_added_on_and_more.py` [5.371 octets]
<a id="app-migrations-0005_alter_housing_options_alter_housing_added_on_and_more-py"></a> [↩ Retour à l'arborescence](#tree-app-migrations-0005_alter_housing_options_alter_housing_added_on_and_more-py)

> **Chemin relatif** : `app/migrations/0005_alter_housing_options_alter_housing_added_on_and_more.py`  
> **Taille** : 5.371 octets  
> **Lignes** : 156  
> **Type** : python

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (156 lignes) - Cliquer pour déplier</summary>

```python
# Generated by Django 4.2.2 on 2023-10-11 11:48

import datetime
from django.db import migrations, models


class Migration(migrations.Migration):
    dependencies = [
        ("app", "0004_housing_created_housing_modified"),
    ]

    operations = [
        migrations.AlterModelOptions(
            name="housing",
            options={"verbose_name": "Logement", "verbose_name_plural": "Logements"},
        ),
        migrations.AlterField(
            model_name="housing",
            name="added_on",
            field=models.DateTimeField(
                blank=True, default=datetime.datetime.now, verbose_name="Ajouté le"
            ),
        ),
        migrations.AlterField(
            model_name="housing",
            name="address",
            field=models.CharField(max_length=300, verbose_name="Adresse"),
        ),
        migrations.AlterField(
            model_name="housing",
            name="application_deadline",
            field=models.DateTimeField(verbose_name="Date limite de candidature"),
        ),
        migrations.AlterField(
            model_name="housing",
            name="basement",
            field=models.BooleanField(default=False, verbose_name="Cave"),
        ),
        migrations.AlterField(
            model_name="housing",
            name="bus",
            field=models.BooleanField(default=False, verbose_name="Accès bus"),
        ),
        migrations.AlterField(
            model_name="housing",
            name="city",
            field=models.CharField(max_length=100, verbose_name="Ville"),
        ),
        migrations.AlterField(
            model_name="housing",
            name="code",
            field=models.IntegerField(default=None, null=True),
        ),
        migrations.AlterField(
            model_name="housing",
            name="elevator",
            field=models.BooleanField(default=False, verbose_name="Ascenceur"),
        ),
        migrations.AlterField(
            model_name="housing",
            name="floor",
            field=models.CharField(max_length=20, verbose_name="Etage"),
        ),
        migrations.AlterField(
            model_name="housing",
            name="heating",
            field=models.CharField(max_length=20, verbose_name="Chauffage"),
        ),
        migrations.AlterField(
            model_name="housing",
            name="info",
            field=models.CharField(max_length=500, verbose_name="Remarque"),
        ),
        migrations.AlterField(
            model_name="housing",
            name="intercom",
            field=models.BooleanField(default=False, verbose_name="Intercom"),
        ),
        migrations.AlterField(
            model_name="housing",
            name="metro",
            field=models.BooleanField(default=False, verbose_name="Accès métro"),
        ),
        migrations.AlterField(
            model_name="housing",
            name="minimum_income",
            field=models.CharField(default="0", max_length=4),
        ),
        migrations.AlterField(
            model_name="housing",
            name="number",
            field=models.IntegerField(verbose_name="Numéro"),
        ),
        migrations.AlterField(
            model_name="housing",
            name="number_of_applications",
            field=models.IntegerField(
                default=0, verbose_name="Nombre de candidatures enregistrées"
            ),
        ),
        migrations.AlterField(
            model_name="housing",
            name="parking",
            field=models.BooleanField(default=False, verbose_name="Parking"),
        ),
        migrations.AlterField(
            model_name="housing",
            name="postal_code",
            field=models.CharField(max_length=6, verbose_name="Code postal"),
        ),
        migrations.AlterField(
            model_name="housing",
            name="rent_and_utilities",
            field=models.CharField(
                max_length=4, verbose_name="Loyer charges comprises (€)"
            ),
        ),
        migrations.AlterField(
            model_name="housing",
            name="renting_from",
            field=models.DateTimeField(verbose_name="Location prévue le"),
        ),
        migrations.AlterField(
            model_name="housing",
            name="renting_model",
            field=models.CharField(
                max_length=20, verbose_name="Social/intermédiaire/non plafonné"
            ),
        ),
        migrations.AlterField(
            model_name="housing",
            name="rer",
            field=models.BooleanField(default=False, verbose_name="Accès RER"),
        ),
        migrations.AlterField(
            model_name="housing",
            name="size",
            field=models.CharField(max_length=3, verbose_name="Superficie (m²)"),
        ),
        migrations.AlterField(
            model_name="housing",
            name="sncf",
            field=models.BooleanField(default=False, verbose_name="Accès SNCF"),
        ),
        migrations.AlterField(
            model_name="housing",
            name="type",
            field=models.CharField(max_length=4, verbose_name="Type"),
        ),
        migrations.AlterField(
            model_name="housing",
            name="zone",
            field=models.CharField(max_length=20, verbose_name="Zone sur la carte"),
        ),
    ]

```

</details>


---

### 📄 `app/migrations/0006_remove_housing_code_alter_housing_number_and_more.py` [1.227 octets]
<a id="app-migrations-0006_remove_housing_code_alter_housing_number_and_more-py"></a> [↩ Retour à l'arborescence](#tree-app-migrations-0006_remove_housing_code_alter_housing_number_and_more-py)

> **Chemin relatif** : `app/migrations/0006_remove_housing_code_alter_housing_number_and_more.py`  
> **Taille** : 1.227 octets  
> **Lignes** : 41  
> **Type** : python

```python
# Generated by Django 4.2.2 on 2023-10-25 07:22

from django.db import migrations, models


class Migration(migrations.Migration):
    dependencies = [
        ("app", "0005_alter_housing_options_alter_housing_added_on_and_more"),
    ]

    operations = [
        migrations.RemoveField(
            model_name="housing",
            name="code",
        ),
        migrations.AlterField(
            model_name="housing",
            name="number",
            field=models.CharField(max_length=10, verbose_name="Numéro"),
        ),
        migrations.AlterField(
            model_name="housing",
            name="number_of_applications",
            field=models.IntegerField(
                default=0, verbose_name="Nombre de candidatures enregistrées *"
            ),
        ),
        migrations.AlterField(
            model_name="housing",
            name="rent_and_utilities",
            field=models.CharField(
                max_length=4, verbose_name="Loyer charges comprises (€) *"
            ),
        ),
        migrations.AlterField(
            model_name="housing",
            name="renting_from",
            field=models.DateTimeField(verbose_name="Location prévue le *"),
        ),
    ]

```


---

### 📄 `app/migrations/0007_housing_displayed.py` [444 octets]
<a id="app-migrations-0007_housing_displayed-py"></a> [↩ Retour à l'arborescence](#tree-app-migrations-0007_housing_displayed-py)

> **Chemin relatif** : `app/migrations/0007_housing_displayed.py`  
> **Taille** : 444 octets  
> **Lignes** : 18  
> **Type** : python

```python
# Generated by Django 4.2.2 on 2023-10-25 07:24

from django.db import migrations, models


class Migration(migrations.Migration):
    dependencies = [
        ("app", "0006_remove_housing_code_alter_housing_number_and_more"),
    ]

    operations = [
        migrations.AddField(
            model_name="housing",
            name="displayed",
            field=models.BooleanField(default=True, verbose_name="À afficher"),
        ),
    ]

```


---

### 📄 `app/migrations/0008_alter_housing_heating.py` [408 octets]
<a id="app-migrations-0008_alter_housing_heating-py"></a> [↩ Retour à l'arborescence](#tree-app-migrations-0008_alter_housing_heating-py)

> **Chemin relatif** : `app/migrations/0008_alter_housing_heating.py`  
> **Taille** : 408 octets  
> **Lignes** : 18  
> **Type** : python

```python
# Generated by Django 4.2.2 on 2023-10-31 17:39

from django.db import migrations, models


class Migration(migrations.Migration):
    dependencies = [
        ("app", "0007_housing_displayed"),
    ]

    operations = [
        migrations.AlterField(
            model_name="housing",
            name="heating",
            field=models.CharField(max_length=30, verbose_name="Chauffage"),
        ),
    ]

```


---

### 📄 `app/migrations/__init__.py` [0 octets]
<a id="app-migrations-__init__-py"></a> [↩ Retour à l'arborescence](#tree-app-migrations-__init__-py)

> **Chemin relatif** : `app/migrations/__init__.py`  
> **Taille** : 0 octets  
> **Lignes** : 0  
> **Type** : python

```python

```


---

### 📄 `app/models/__init__.py` [39 octets]
<a id="app-models-__init__-py"></a> [↩ Retour à l'arborescence](#tree-app-models-__init__-py)

> **Chemin relatif** : `app/models/__init__.py`  
> **Taille** : 39 octets  
> **Lignes** : 2  
> **Type** : python

```python
from app.models.housing import Housing

```


---

### 📄 `app/models/housing.py` [2.430 octets]
<a id="app-models-housing-py"></a> [↩ Retour à l'arborescence](#tree-app-models-housing-py)

> **Chemin relatif** : `app/models/housing.py`  
> **Taille** : 2.430 octets  
> **Lignes** : 50  
> **Type** : python

```python
from django.db import models
from model_utils.models import TimeStampedModel
from datetime import datetime


class Housing(TimeStampedModel):
    displayed = models.BooleanField(default=True, verbose_name="À afficher")
    added_on = models.DateTimeField(
        default=datetime.now, blank=True, verbose_name="Ajouté le"
    )
    number = models.CharField(max_length=10, verbose_name="Numéro")
    type = models.CharField(max_length=4, verbose_name="Type")
    address = models.CharField(max_length=300, verbose_name="Adresse")
    postal_code = models.CharField(max_length=6, verbose_name="Code postal")
    city = models.CharField(max_length=100, verbose_name="Ville")
    floor = models.CharField(max_length=20, verbose_name="Etage")
    size = models.CharField(max_length=3, verbose_name="Superficie (m²)")
    heating = models.CharField(max_length=30, verbose_name="Chauffage")
    elevator = models.BooleanField(default=False, verbose_name="Ascenceur")
    intercom = models.BooleanField(default=False, verbose_name="Intercom")
    basement = models.BooleanField(default=False, verbose_name="Cave")
    parking = models.BooleanField(default=False, verbose_name="Parking")
    metro = models.BooleanField(default=False, verbose_name="Accès métro")
    sncf = models.BooleanField(default=False, verbose_name="Accès SNCF")
    rer = models.BooleanField(default=False, verbose_name="Accès RER")
    bus = models.BooleanField(default=False, verbose_name="Accès bus")
    info = models.CharField(max_length=500, verbose_name="Remarque")
    application_deadline = models.DateTimeField(
        verbose_name="Date limite de candidature"
    )
    renting_from = models.DateTimeField(verbose_name="Location prévue le *")
    rent_and_utilities = models.CharField(
        max_length=4, verbose_name="Loyer charges comprises (€) *"
    )
    minimum_income = models.CharField(max_length=4, default="0")
    renting_model = models.CharField(
        max_length=20, verbose_name="Social/intermédiaire/non plafonné"
    )
    zone = models.CharField(max_length=20, verbose_name="Zone sur la carte")
    number_of_applications = models.IntegerField(
        default=0, verbose_name="Nombre de candidatures enregistrées *"
    )

    def __str__(self):
        return str(self.city) + " - logement numéro " + str(self.number)

    class Meta:
        verbose_name = "Logement"
        verbose_name_plural = "Logements"

```


---

### 📄 `app/signals.py` [347 octets]
<a id="app-signals-py"></a> [↩ Retour à l'arborescence](#tree-app-signals-py)

> **Chemin relatif** : `app/signals.py`  
> **Taille** : 347 octets  
> **Lignes** : 11  
> **Type** : python

```python
from django.db.models.signals import post_save
from django.contrib.auth.models import User
from django.dispatch import receiver


@receiver(post_save, sender=User)
def update_email(sender, instance, created, **kwargs):
    if created and instance.username and not instance.email:
        instance.email = instance.username
        instance.save()

```


---

### 📄 `app/static/app/css/application/application.css` [879 octets]
<a id="app-static-app-css-application-application-css"></a> [↩ Retour à l'arborescence](#tree-app-static-app-css-application-application-css)

> **Chemin relatif** : `app/static/app/css/application/application.css`  
> **Taille** : 879 octets  
> **Lignes** : 51  
> **Type** : css

```css
/* Ce fichier contient les styles spécifiques à l'application ou surchargés par rapport au modèle */

#contenu form label {
  width: 300px;
}

.tableauCouleurs {
  font-weight: normal;
  border: 1px solid grey;
  border-collapse: collapse;
  width: auto;
}

.tableauCouleurs ul {
  padding-left: 15px;
  margin: 0px;
  font-weight: bold;
  font-style: normal;
}

.tableauCouleurs th {
  border: 1px solid black;
  width: 14%;
}

.tableauCouleurs td {
  border: 1px solid black;
  font-weight: bold;
  font-style: normal;
}

div#menu1 fieldset {
  clear: left;
  padding: 2px;
  margin: 2px;
  border: 1px solid #ca3353;
  background-color: #fbf2f4;
}

div#menu1 legend {
  padding: 2px;
  margin: 2px;
  border: 1px solid #ca3353;
  background-color: #fbf2f4;
}

div.blackwhite {
  color: black;
  background-color: white;
}

```


---

### 📄 `app/static/app/css/intranet/complet.css` [22.711 octets]
<a id="app-static-app-css-intranet-complet-css"></a> [↩ Retour à l'arborescence](#tree-app-static-app-css-intranet-complet-css)

> **Chemin relatif** : `app/static/app/css/intranet/complet.css`  
> **Taille** : 22.711 octets  
> **Lignes** : 1272  
> **Type** : css

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (1272 lignes) - Cliquer pour déplier</summary>

```css
div#haut {
  margin: 0px;
  padding: 0px;
  width: 100%;
  position: relative;
  z-index: 100;
}

div#conteneurmilieu {
  width: auto;
  padding: 0px 200px 0px 200px;
  position: relative;
}

div#conteneurmilieularge {
  width: auto;
  border: solid white 0px;
  background-color: white; /* couleur du centre */

  /*/*/
  border-left-width: 200px; /* left column width. NN4 hack to hide borders */
  border-left-color: white; /* couleur colonne de gauche */
  border-left-style: solid;
  position: relative;
}

div#milieu {
  margin: 0px;
  padding: 0px;
  width: 100%;
  position: relative;
}

div#milieuinterieur {
  float: left;
  position: relative;
}

div#gauche {
  margin: 0px;
  padding: 0px;
  width: 180px;
  float: left;
  position: relative;
  margin-left: -200px;
}

div#centre {
  float: left;
  width: 100%;
  position: relative;
}

div#droit {
  margin: 0px;
  padding: 0px;
  width: 180px;
  float: right;
  position: relative;
  margin-right: -200px;
  background: #fbf2f4;
}

div#bas {
  position: relative;
}

div#conteneurhaut {
  margin-right: 170px;
  position: relative;
  display: block;
  height: 100%;
}

/* placé en haut de page */
div#nomdusite {
  margin: 0px;
  background: #4b8fcc;
    top;
  height: 8em;
  padding: 0px;
  position: relative;
}

div#nomdusite p#logodusite {
  background: url("../../images/logo_mtect.jpg") no-repeat 5px 50%;
  margin: 0px;
  padding: 25px 0px 25px 140px;
  font-size: 2em;
  font-weight: bold;
  text-align: left;
  color: white;
}

/* en haut à droite */
div#telecommande {
  float: right;
  position: relative;
  margin-right: -170px;
  width: 170px;
  white-space: nowrap;
  height: 8em;
}

div#telecommande ul {
  list-style-type: none;
  margin: 0px;
  padding: 0px;
  padding-left: 3px;
}
div#telecommande li {
  line-height: 1.2em;
  font-size: 0.9em;
  background: url(../../images/structure/puce_menu_01.gif) no-repeat 0% 50%;
  padding: 0px 0px 0px 7px;
  margin: 0px;
}
div#telecommande a {
  margin: 0px;
  padding: 0px;
  font-weight: normal;
  color: black;
  text-decoration: none;
}

div#telecommande a:hover {
  text-decoration: underline;
}

/* Messages de service placé sous l'entête */
div#messagedeservice {
  position: relative;
  margin: 0px;
  padding: 0px;
  clear: both;
}

/* recherche */
div#recherche {
  width: 160px;
  font-size: 1em;
  overflow: hidden;
}

div#contenu {
  font-size: 1em;
  line-height: 1.5em;
}

div#contenu a {
  font-size: 1.1em;
  text-decoration: none;
}

div#contenu {
  width: auto;
  margin: 0px;
  padding: 0px;
  position: relative;
}

/* FIN DE LA MISE EN PAGE */
div#recherche form {
  padding: 0px;
  margin: 0px;
}

div#recherche label {
  padding: 2px;
  font-size: 1em;
  font-weight: normal;
  vertical-align: middle;
}

div#recherche fieldset {
  clear: left;
  padding: 2px;
  margin: 2px;
  border: 1px solid #ca3353;
  background-color: #fbf2f4;
}

div#recherche legend {
  padding: 2px;
  margin: 2px;
  border: 1px solid #ca3353;
  background-color: #fbf2f4;
}

div#recherche input {
  font-size: 1em;
  vertical-align: middle;
}

div#recherche form button:hover {
  color: #ca3353;
  cursor: pointer;
}

div#recherche img {
  vertical-align: middle;
}

div#recherche form button {
  border: none;
  font-weight: bold;
  text-align: left;
  font-size: 1em;
  color: #a0a0a0;
  vertical-align: middle;
}

div#messagedeservice p {
  font-size: 1.2em;
  font-weight: bold;
  text-align: center;
  padding: 0px 0px 0px 10px;
  margin: 2px;
  color: #ca3353;
}

/* pied de page sur toute la largeur */
div#pied {
  width: auto;
  position: relative;
  display: block;
  margin: 10px 5px 0px 0px;
  padding: 10px 0px 0px 0px;
}

div#pied p {
  margin: 0px;
  padding: 0px;
  color: #005fb8;
  text-decoration: none;
  font-size: 1em;
  margin-top: 1em;
}

div#pieddroit {
  padding-top: 10px;
  float: right;
}

div#pieddroit p {
  margin: 0px;
  padding: 0px;
  font-size: 2.5em;
  white-space: nowrap;
}

div#pied a {
  color: #005fb8;
}

div#pied a:hover {
  text-decoration: underline;
}

div#pied div#pieddroit a:hover {
  text-decoration: none;
}

div#outils ul {
  text-align: center;
  list-style-type: none;
  margin: 0px;
  padding: 0px;
}

div#outils li {
  position: relative;
  display: inline;
  font-size: 1em;
  font-weight: bold;
  background: transparent url(../../images/structure/puce_footer.gif) no-repeat
    5px 50%;
  margin: 0px;
  padding: 0px 0px 0px 13px;
}

div#copyright {
  color: #656565;
  margin-top: 1em;
  text-align: center;
}

/* Colonne de gauche */
div#menu1 {
  margin: 0px;
  padding: 0px;
  background-color: white;
  position: relative;
}

div#menu1 p {
  line-height: 1.7em;
  margin: 0px;
  padding: 3px 0px 3px 0px;
}

div#menu1 ul {
  list-style-type: none;
  margin: 0px;
  padding: 0px;
}

div#menu1 li {
  color: white;
  background: #ca3353;
  font-size: 1.2em;
  font-weight: bold;
  line-height: 1.7em;
  margin: 0px;
  padding: 0px;
  text-align: center;
}

div#menu1 ul ul {
  padding: 0px 0px 0px 3px;
  margin: 0px;
  background: white;
  color: black;
}
div#menu1 ul ul li {
  color: black;
  background: url(../../images/structure/puce_menu_01.gif) no-repeat 0% 50%;
  font-size: 0.8em;
  font-weight: normal;
  line-height: 1.1em;
  text-align: left;
  padding: 0px 0px 0px 7px;
}

div#menu1 a {
  font-weight: normal;
  color: black;
  text-decoration: none;
}

div#menu1 a:hover {
  text-decoration: underline;
  color: #ca3353;
}

div#menu1 form button {
  border: none;
  color: #a0a0a0;
  font-weight: bold;
  text-align: left;
  font-size: 1em;
  vertical-align: middle;
}

/* Colonne de droite */
div#menu2 {
  margin: 0px;
  padding: 0px;
  background: transparent;
  position: relative;
}

div#menu2 p {
  line-height: 1.7em;
  margin: 0px;
  padding: 3px 0px 3px 0px;
}

div#menu2 ul {
  list-style-type: none;
  margin: 0px;
  padding: 0px;
}

div#menu2 li {
  color: white;
  background-color: #ca3353;
  font-size: 1.2em;
  font-weight: bold;
  line-height: 1.7em;
  margin: 0px;
  padding: 0px;
  text-align: center;
}

div#menu2 ul li ul {
  padding: 0px 0px 0px 3px;
  margin: 0px;
  background-color: #fbf2f4;
}

div#menu2 ul li ul li {
  color: black;
  background: url(../../images/structure/puce_menu_01.gif) no-repeat 0% 50%;
  font-size: 0.8em;
  font-weight: normal;
  line-height: 1.1em;
  text-align: left;
  padding: 0px 0px 0px 7px;
}

div#menu2 a {
  font-weight: normal;
  color: black;
  text-decoration: none;
}

div#menu2 a:hover {
  text-decoration: underline;
}

div#menu2 form button:hover {
  color: #ca3353;
  cursor: pointer;
}

div#menu2 form button {
  border: none;
  color: #a0a0a0;
  font-weight: bold;
  text-align: left;
  font-size: 1em;
  vertical-align: middle;
}

div#menu2 label {
  padding: 2px;
  font-size: 1em;
  font-weight: normal;
  vertical-align: middle;
}

div#menu2 fieldset {
  clear: left;
  padding: 2px;
  margin: 2px;
  border: 1px solid #ca3353;
  background-color: #fbf2f4;
}

div#menu2 legend {
  padding: 2px;
  margin: 2px;
  border: 1px solid #ca3353;
  background-color: #fbf2f4;
}

/* barre de progression */
div#barreprogression {
  margin: 0px;
  padding: 0px;
}

div#barreprogression ul {
  position: relative;
  list-style-type: none;
  margin: 0px;
  padding: 0px;
}

div#barreprogression ul li {
  position: relative;
  display: inline;
  font-size: 1em;
  background: transparent url(../../images/structure/puce_menu_01.gif) no-repeat
    5px 50%;
  margin: 0px;
  padding: 0px;
}

div#barreprogression ul li a {
  text-decoration: underline;
  position: relative;
  padding: 0px 0px 0px 13px;
}

div#accessibilite {
  position: absolute;
  z-index: 200;
  top: 5px;
  left: 140px;
}

div#accessibilite ul {
  text-align: left;
  list-style-type: none;
  margin: 0px;
  padding: 0px;
}

div#accessibilite li {
  display: inline;
  font-size: 1em;
  margin: 0px;
  padding: 0px;
}

div#accessibilite li a {
  padding: 0px 0px 0px 13px;
}

div#accessibilite li a {
  background: transparent url(../../images/structure/puce_tool4.gif) no-repeat
    5px 50%;
}

div#accessibilite li + li a {
  background: transparent url(../../images/structure/puce_tool2.gif) no-repeat
    5px 50%;
}

div#accessibilite li + li + li a {
  background: transparent url(../../images/structure/puce_tool3.gif) no-repeat
    5px 50%;
}

div#accessibilite li + li + li + li a {
  background: transparent url(../../images/structure/puce_tool1.gif) no-repeat
    5px 50%;
}

div#accessibilite li + li + li + li + li a {
  background: transparent url(../../images/structure/puce_tool5.gif) no-repeat
    5px 50%;
}

/*
Feuille de style pour les applications intranet du METATM

Date    :18/05/2005
Auteur  :METLTM
*/

body {
  background-color: white;
  color: black;
  margin: 0px;
  width: 100%;
  font-family: Verdana, Geneva, Arial, Helvetica, sans-serif;
  font-style: normal;
  font-size: 65%;
}

a {
  color: #a0a0a0;
  font-weight: bold;
  text-decoration: none;
}

/* Changement de couleur au passage souris sur les liens */
a:active,
a:hover,
a:focus {
  color: #ca3353;
}

/* Par défaut les images n'ont pas de bordure */
a img {
  border: none;
  vertical-align: middle;
}

/* Titre de premier niveau */
h1 {
  background-color: white;
  color: #ca3353;
  font-size: 1.6em;
  font-weight: bold;
  margin: 0px;
  padding: 2px;
}

/* Titre de deuxième niveau */
h2 {
  background-color: #fbf2f4;
  color: #ca3353;
  border-top: #ca3353 1px solid;
  font-size: 1.4em;
  font-weight: bold;
  padding: 2px 2px 2px 10px;
}

/* Messages lors des erreurs de saisie ds formulaires */
.erreurSaisie {
  background-color: white;
  font-size: 1.4em;
  font-weight: bold;
  color: red;
}

table.tableau {
  border: 1px solid #ca3353;
  border-collapse: collapse;
  width: 100%;
  font-size: 1em;
}

table.tableau th {
  padding: 2px;
  background-color: #f8e5e9;
  color: #ca3353;
  border: 1px solid #ca3353;
}

table.tableau td {
  margin: 0px;
  padding: 2px;
  background-color: #fbf2f4;
  border: 1px solid #ca3353;
  color: black;
}

table.tableau tr.impair td {
  background-color: #f8e5e9;
  color: black;
}

.gauche {
  padding: 2px;
  float: left;
}

.encadre {
  padding: 2px;
  border: 1px solid;
  border-color: #ca3353;
}

.picto {
  padding: 5px 5px 5px 25px;
}

.besoin_aide {
  background: url("../../images/pictos/picto_besoin_aide.gif") no-repeat 2px 50%;
}

.plan_site {
  background: url("../../images/pictos/picto_plan_site.gif") no-repeat 2px 50%;
}

.aide_contextuelle {
  padding-left: 45px;
  background: url("../../images/pictos/picto_aide.gif") no-repeat 2px 50%;
}

.rechercher {
  background: url("../../images/pictos/picto_rechercher.gif") no-repeat 2px 50%;
}

.modifier {
  background: url("../../images/pictos/picto_modifier.gif") no-repeat 2px 50%;
}

.valider {
  background: url("../../images/pictos/picto_valider.gif") no-repeat 2px 50%;
}

.supprimer {
  background: url("../../images/pictos/picto_supprimer.gif") no-repeat 2px 50%;
}

.annuler {
  background: url("../../images/pictos/picto_annuler.gif") no-repeat 2px 50%;
}

.retablir {
  background: url("../../images/pictos/picto_retablir.gif") no-repeat 2px 50%;
}

.mail {
  background: url("../../images/pictos/picto_mail.gif") no-repeat 2px 50%;
}

.affiner {
  background: url("../../images/pictos/picto_affiner.gif") no-repeat 2px 50%;
}

.suivant {
  background: url("../../images/pictos/picto_suivant.gif") no-repeat 2px 50%;
}

.precedent {
  background: url("../../images/pictos/picto_precedent.gif") no-repeat 2px 50%;
}

.attente {
  padding-left: 82px;
  background: url("../../images/pictos/picto_attente.gif") no-repeat 2px 50%;
}

.enregistrer {
  background: url("../../images/pictos/picto_enregistrer.gif") no-repeat 2px 50%;
}

.imprimer {
  background: url("../../images/pictos/picto_imprimer.gif") no-repeat 2px 50%;
}

.liste {
  background: url("../../images/pictos/picto_liste.gif") no-repeat 2px 50%;
}

.exporter {
  background: url("../../images/pictos/picto_exporter.gif") no-repeat 2px 50%;
}

.ajouter {
  background: url("../../images/pictos/picto_ajouter.gif") no-repeat 2px 50%;
}

.enlever {
  background: url("../../images/pictos/picto_enlever.gif") no-repeat 2px 50%;
}

.quitter {
  background: url("../../images/pictos/picto_fermer_session.gif") no-repeat 2px
    50%;
}

.plus {
  background: url("../../images/pictos/picto_plus.gif") no-repeat 2px 50%;
}

.moins {
  background: url("../../images/pictos/picto_moins.gif") no-repeat 2px 50%;
}

.picto_obligatoire {
  padding-left: 15px;
  background: url("../../images/pictos/picto_obligatoire.gif") no-repeat 2px 50%;
}

.acrobat {
  padding: 10px 0px 10px 95px;
  background: url("../../images/pictos/picto_acrobat.gif") no-repeat 2px 50%;
}

.tri_haut_on {
  background: url("../../images/pictos/tri_haut_on.gif") no-repeat 2px 50%;
}

.tri_haut_off {
  background: url("../../images/pictos/tri_haut_off.gif") no-repeat 2px 50%;
}

.tri_bas_on {
  background: url("../../images/pictos/tri_bas_on.gif") no-repeat 2px 50%;
}

.tri_bas_off {
  background: url("../../images/pictos/tri_bas_off.gif") no-repeat 2px 50%;
}

.retour_haut {
  padding: 2px 0px 2px 90px;
  background: url("../../images/structure/haut_de_page.gif") no-repeat 70% 50%;
  background-color: #ca3353;
}

.mailto {
  padding-left: 50px;
  background: url("../../images/structure/mail_piedpage.gif") no-repeat 2px 50%;
}

.enlever {
  background: url("../../images/pictos/picto_enlever.gif") no-repeat 2px 50%;
}

.handicap {
  background: url("../../images/structure/handicap.png") no-repeat 2px 50%;
}

.obligatoire {
  color: red;
}

/* Ligne générique bleue */
.tdBleu {
  background-color: #ca3353;
}

#contenu div.pagination {
  margin: 0px;
  padding: 3px;
  text-align: left;
  font-size: 1em;
  background-color: #fbf2f4;
  border-top: 1px solid #f8e5e9;
  border-bottom: 1px solid #f8e5e9;
}

#contenu div.pagination a {
  text-decoration: none;
}

#contenu div.pagination img {
  vertical-align: middle;
}

#contenu div.pagination form {
  margin: 0px;
  padding: 0px;
  display: inline;
}

#contenu div.pagination form input.petit {
  float: none;
  margin: 0px;
  padding: 0px;
  text-align: right;
  font-size: 1em;
  background-color: white;
}

#contenu div.pagination form label {
  float: none;
  margin: 0px;
  padding: 0px;
  background: none;
  font-size: 1em;
}

#contenu div.pagination form button {
  margin: 0px;
  padding: 0px;
  background: none;
  font-size: 1em;
}

#contenu pre {
  font-size: 1.5em;
}

.invisible {
  display: none;
}

.rounded-bl {
  background: transparent url(../../images/structure/bl10x10.gif) no-repeat
    bottom left;
}
.rounded-tl {
  background: transparent url(../../images/structure/tl10x10.gif) no-repeat top
    left;
}
.rounded-br {
  background: transparent url(../../images/structure/br10x10.gif) no-repeat
    bottom right;
}
.rounded-tr {
  background: transparent url(../../images/structure/tr10x10.gif) no-repeat top
    right;
}

.clr {
  clear: both;
}

.validation_xhtml {
  padding: 2px 0px 2px 90px;
  height: 32px;
  background: url("../../images/structure/valid-xhtml10.png") no-repeat 70% 50%;
}

.validation_css {
  padding: 2px 0px 2px 90px;
  height: 32px;
  background: url("../../images/structure/vcss.png") no-repeat 70% 50%;
}

.validation_wai {
  padding: 2px 0px 2px 90px;
  height: 32px;
  background: url("../../images/structure/wcag1A.gif") no-repeat 70% 50%;
}

.validation_aprompt {
  padding: 2px 0px 2px 90px;
  height: 32px;
  background: url("../../images/structure/IconA.png") no-repeat 70% 50%;
}

.left100 {
  left: -100px;
}

.left200 {
  left: -200px;
}

.left300 {
  left: -300px;
}

.width90pc {
  width: 90%;
}

.width10pc {
  width: 10%;
}

.width20pc {
  width: 20%;
}

#contenu {
  padding: 0px;
  margin: 0px;
  border: 0px;
}

#contenu .onglet ul {
  font-weight: bold;
  white-space: nowrap;
  font-size: 1.2em;
  padding: 0px;
  margin: 0px;
  border: 0px;
  list-style-type: none;
}

#contenu .onglet li {
  display: inline;
}

#contenu .onglet li.current a {
  color: white;
  background: #ca3353 url(../../images/structure/tr10x10.gif) no-repeat top
    right;
}

#contenu .onglet li a {
  color: #ca3353;
  background: #f8e5e9 url(../../images/structure/tr10x10.gif) no-repeat top
    right;
  padding: 4px 6px;
  text-decoration: none;
}

#contenu .onglet li a:hover {
  color: white;
  background: #ca3353 url(../../images/structure/tr10x10.gif) no-repeat top
    right;
}

#contenu .corpsonglet {
  display: block;
  position: relative;
  padding: 2px;
  margin-top: 2px;
  border: solid 2px #ca3353;
  width: auto;
}

/* Positionnement */

#contenu form label {
  float: left;
  width: 120px;
  text-align: right;
  padding-right: 15px;
}

#contenu form div.ligne {
  clear: both;
}

#contenu div.adroite {
  float: left;
  width: 50%;
}

#contenu div.agauche {
  float: left;
  width: 50%;
}

#contenu div.unique {
}

/* styles */
#contenu form label.champ_obligatoire {
  background: url("../../images/pictos/picto_obligatoire.gif") no-repeat 97% 50%;
}

#contenu form input,
#contenu form select {
  background-color: #fbf2f4;
}

#contenu form input.button {
  border: none;
  font-weight: bold;
  text-align: left;
  color: #a0a0a0;
  background-color: transparent;
}

div#contenu form button:hover,
div#contenu form input.button:hover {
  color: #ca3353;
  cursor: pointer;
}

#contenu form button {
  border: none;
  font-weight: bold;
  text-align: left;
  color: #a0a0a0;
}

#contenu form input:focus,
#contenu form select:focus {
  background-color: #f8e5e9;
}

#contenu fieldset {
  border: 1px solid;
  background-color: #fbf2f4;
}

#contenu legend {
  border: 1px solid;
  background-color: #fbf2f4;
}

#contenu a.aide {
  /*** Mise en forme des bulles d'aide ***/
  text-decoration: none;
}
#contenu a.aide img {
  /*** Mise en forme de l'image des bulles d'aide ***/
  margin: 0;
  padding: 0;
  border: 0;
}
#contenu a.aide:hover {
  /*** Le curseur de la souris change d'aspect quand il passe au-dessus d'une bulle d'aide ***/
  cursor: help;
}

/* ----------------------------------------- */
/* Styles de présentations de formulaires */
/* colonne, horizontal, avec marge constante, vertical */

.columnarForm {
  border: 1px solid;
  padding: 5px;
}

.columnarForm fieldset {
  float: left;
  display: block;
  width: 17em;
  margin: 0 1em 1em 0;
  padding: 0 1em 1em 1em;
}

.columnarForm fieldset.radio {
  width: 15em;
  margin: 1em 0 2em 0;
}

.columnarForm fieldset.radio input {
  clear: both;
  float: left;
  width: auto;
}

.columnarForm fieldset.radio label {
  font-weight: normal;
}

.columnarForm input {
  display: block;
  width: 15em;
}

.columnarForm .submit {
  display: block;
  clear: both;
}

#contenu form.columnarForm fieldset label {
  display: block;
  float: none;
  text-align: left;
  margin-bottom: 1em;
  font-weight: bold;
}

.columnarForm label.first {
  padding-top: 1em;
}

.columnarForm select {
  display: block;
}

/* ----------------------------------------- */
.horizontalForm {
  border: 1px solid;
  padding: 5px;
}

.horizontalForm fieldset {
  display: block;
  margin: 0 0 1em 0;
  padding: 5px;
}

.horizontalForm fieldset.radio {
  margin: 1em 0 2em 0;
}

.horizontalForm fieldset.radio input {
  clear: both;
  float: left;
  width: auto;
}

.horizontalForm fieldset.radio label {
  font-weight: normal;
}

.horizontalForm input {
  display: block;
  height: 1.3em;
}

.horizontalForm input.submit {
  clear: both;
}

.horizontalForm input.button {
  height: 2em;
  display: inline;
}

#contenu form.horizontalForm fieldset label {
  float: left;
  display: block;
  text-align: left;
  margin: 0.5em 1em 0 0;
  font-weight: bold;
  width: auto;
}

.horizontalForm select {
  display: block;
}

/* ----------------------------------------- */
.marginForm {
  border: 1px solid;
  padding: 5px;
}

.marginForm fieldset {
  display: block;
  margin: 0 0 1em 0;
  border: 0 solid #ffffff;
  border-top: 1px solid #000000;
  padding: 1em 1em 1em 1em;
}

.marginForm fieldset.radio {
  margin: 0 0 0 0;
  border: 0 solid #ffffff;
}

.marginForm fieldset.radio input {
  position: static;
  clear: both;
  float: left;
}

.marginForm fieldset.radio label {
  position: relative;
  top: 0px;
  display: inline;
  width: auto;
  margin: 0 0 0 8em;
  font-weight: bold;
  font-weight: normal;
}

.marginForm fieldset.radio legend {
  float: left;
  font-weight: bold;
}

.marginForm input {
  position: relative;
  top: -1.4em;
  left: 8em;
  display: block;
}

.marginForm input.submit {
  clear: both;
  top: 0;
}

.marginForm label {
  clear: both;
  float: left;
  display: block;
  width: 8em;
  margin-top: -1em;
  font-weight: bold;
}

.marginForm label.first {
  margin-top: 1em;
}

.marginForm select {
  position: relative;
  top: -1.4em;
  left: 8em;
  display: block;
}

/* ----------------------------------------- */
.verticalForm {
  border: 1px solid;
  padding: 5px;
}

.verticalForm fieldset {
  display: block;
  width: 17em;
  margin: 0 0 3em 0;
  padding: 1em 1em 1em 1em;
}

.verticalForm fieldset.radio {
  width: 15em;
  margin: 1em 0 2em 0;
}

.verticalForm fieldset.radio input {
  clear: both;
  float: left;
  width: auto;
}

.verticalForm fieldset.radio label {
  font-weight: normal;
}

.verticalForm input {
  display: block;
  width: 15em;
}

.verticalForm label {
  display: block;
  margin-bottom: 1em;
  font-weight: bold;
}

.verticalForm label.first {
  padding-top: 1em;
}

.verticalForm select {
  display: block;
}

```

</details>


---

### 📄 `app/static/app/css/intranet/couleurs.css` [3.444 octets]
<a id="app-static-app-css-intranet-couleurs-css"></a> [↩ Retour à l'arborescence](#tree-app-static-app-css-intranet-couleurs-css)

> **Chemin relatif** : `app/static/app/css/intranet/couleurs.css`  
> **Taille** : 3.444 octets  
> **Lignes** : 239  
> **Type** : css

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (239 lignes) - Cliquer pour déplier</summary>

```css
div#menu1 {
  background-color: white;
}

div#recherche fieldset {
  border-color: #CA3353;
  background-color: #F8E5E9;
}

div#recherche legend {
  border-color: #CA3353;
  background-color: #F8E5E9;
}

div#recherche form button:hover {
  color: #CA3353;
}

div#messagedeservice p {
  color: #CA3353;
}

div#menu1 li {
  color: white;
  background-color: #CA3353;
}

div#menu1 ul ul {
  background-color: white;
  color: black;
}
div#menu1 ul ul li {
  color: black;
}

div#menu1 a {
  color: black;
}

div#droit {
  background: #F8E5E9;
}

div#menu2 li {
  color: white;
  background: #CA3353;
}

div#menu2 ul li ul {
  background: #F8E5E9;
  color: black;
}
div#menu2 ul li ul li {
  color: black;
}

div#menu2 a {
  color: black;
}

div#menu2 fieldset {
  border-color: #CA3353;
  background-color: #F8E5E9;
}

div#menu2 legend {
  border-color: #CA3353;
  background-color: #F8E5E9;
}

div#menu2 form button:hover {
  color: #CA3353;
}

/* formulaires.css */
#contenu form input,
#contenu form select {
  background-color: #F8E5E9;
}

#contenu form input:focus,
#contenu form select:focus {
  background-color: #ffe5d8;
}

#contenu fieldset {
  background-color: #F8E5E9;
}

#contenu legend {
  background-color: #F8E5E9;
}

div#contenu form button:hover {
  color: #CA3353;
}

/* menu-principal.css */
div#menuprincipal {
  background-color: #CA3353;
}

/* menu-horizontal.css */
div#menuprincipal ul li {
  color: white;
  background-color: #CA3353;
}

div#menuprincipal ul li.actif {
  background-color: #ffe5d8;
  color: #CA3353;
}

div#menuprincipal ul li a.courant {
  color: #CA3353;
  background-color: #F8E5E9;
}

div#menuprincipal ul li a:hover {
  background-color: #ffe5d8;
  color: #CA3353;
}

/* menu-vertical.css */
div#menuprincipal ul.menu li {
  color: white;
  background-color: #CA3353;
}

div#menuprincipal ul.menu li a.courant {
  color: #CA3353;
  background-color: #F8E5E9;
}

div#menuprincipal ul.menu li a:hover {
  color: #CA3353;
  background-color: #ffe5d8;
}

div#menuprincipal ul.menu li a {
  color: white;
}

div#menuprincipal ul.sousMenu li {
  color: white;
  background-color: #CA3353;
}

div#menuprincipal ul.sousMenu li a:hover {
  color: #CA3353;
  background-color: #ffe5d8;
}

div#menuprincipal ul.sousMenu li a {
  color: white;
}

/* onglets.css */
#contenu .onglet li.current a {
  color: white;
  background-color: #CA3353;
}

#contenu .onglet li a {
  color: #CA3353;
  background-color: #ffe5d8;
}

#contenu .onglet li a:hover {
  color: white;
  background-color: #CA3353;
}

#contenu .corpsonglet {
  border-color: #CA3353;
}

/* styles.css */
a:active,
a:hover,
a:focus {
  color: #CA3353;
}

h1 {
  background-color: white;
  color: #CA3353;
}

/* Titre de deuxi�me niveau */
h2 {
  background-color: #FBF2F4;
  color: #CA3353;
  border-top-color: #CA3353;
}

table.tableau {
  border-color: #CA3353;
}

table.tableau th {
  background-color: #F8E5E9;
  color: #CA3353;
  border-color: #CA3353;
}

table.tableau td {
  background-color: #FBF2F4;
  border-color: #CA3353;
  color: black;
}

table.tableau tr.impair td {
  background-color: #F8E5E9;
  color: black;
}

.encadre {
  border-color: #CA3353;
}

.retour_haut {
  background-color: #CA3353;
}

.tdBleu {
  background-color: #CA3353;
}

#contenu div.pagination {
  background-color: #F8E5E9;
  border-top-color: #F8E5E9;
  border-bottom-color: #F8E5E9;
}

#contenu div.pagination form input.petit {
  background-color: white;
}

```

</details>


---

### 📄 `app/static/app/css/intranet/menu-horizontal.css` [1.014 octets]
<a id="app-static-app-css-intranet-menu-horizontal-css"></a> [↩ Retour à l'arborescence](#tree-app-static-app-css-intranet-menu-horizontal-css)

> **Chemin relatif** : `app/static/app/css/intranet/menu-horizontal.css`  
> **Taille** : 1.014 octets  
> **Lignes** : 52  
> **Type** : css

```css
/* Liste des options principales de l'application */
/* Sous le bandeau avec le nom de l'application */
div#menuprincipal {
  margin: 0px 0px 0px 100px;
  background: #ca3353;
  margin-bottom: 1.5em;
  height: auto;
  position: relative; /*** IE6 needs this to display the div ***/
}

div#menuprincipal ul,
div#menuprincipal li,
div#menuprincipal a {
  margin: 0px;
  padding: 0px;
  border: 0px;
}

div#menuprincipal ul {
  list-style-type: none;
  margin-left: 20px;
  height: auto;
  padding: 0px;
}

div#menuprincipal ul li {
  display: inline;
  cursor: default;
  font-size: 1.25em;
  font-weight: bold;
  position: relative;
  color: white;
  background-color: #ca3353;
}

div#menuprincipal ul li a:hover {
  color: #ca3353;
  background-color: #f8e5e9;
}

div#menuprincipal ul li a.courant {
  color: #ca3353;
  background-color: #f8e5e9;
}

div#menuprincipal ul li a {
  color: white;
  padding: 0px 20px 0px 20px;
  border: 0px;
  position: relative;
}

```


---

### 📄 `app/static/app/css/texte/texte_seul.css` [150 octets]
<a id="app-static-app-css-texte-texte_seul-css"></a> [↩ Retour à l'arborescence](#tree-app-static-app-css-texte-texte_seul-css)

> **Chemin relatif** : `app/static/app/css/texte/texte_seul.css`  
> **Taille** : 150 octets  
> **Lignes** : 8  
> **Type** : css

```css
body {
  background-color: #ffffff;
  color: #000000;
  font-family: Arial, Helvetica, sans-serif;
  font-size: small;
  font-style: normal;
}

```


---

### 📄 `app/templates/app/accessibilite.html` [1.742 octets]
<a id="app-templates-app-accessibilite-html"></a> [↩ Retour à l'arborescence](#tree-app-templates-app-accessibilite-html)

> **Chemin relatif** : `app/templates/app/accessibilite.html`  
> **Taille** : 1.742 octets  
> **Lignes** : 77  
> **Type** : html

```html
{% extends "app/base.html" %}

{% block content %}

<div id="contenu">
    <a id="accescontenu"></a>
    <h2>Politique d'accessibilité</h2>

    <h3>Accès clavier</h3>

    <p>
        Pour faire fonctionner les raccourcis, appuyer sur Alt + "touche raccourci".
    </p>

    <table
        class="tableau"
        summary="Ce tableau présente la liste des raccourcis clavier utilisables dans l'application"
    >
        <caption>
        Liste des raccourcis
        </caption>
        <thead>
        <tr>
            <th>Raccourci</th>
            <th>Fonction</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>s</td>
            <td>passer le menu</td>
        </tr>
        <tr>
            <td>1</td>
            <td>page d'accueil</td>
        </tr>
        <tr>
            <td>2 (désactivé)</td>
            <td>page d'actualités</td>
        </tr>
        <tr>
            <td>3</td>
            <td>plan du site</td>
        </tr>
        <tr>
            <td>4</td>
            <td>moteur de recherche</td>
        </tr>
        <tr>
            <td>5</td>
            <td>FAQ, Aide générale</td>
        </tr>
        <tr>
            <td>6</td>
            <td>Page d'aide contextuelle quand elle existe, sinon aide générale</td>
        </tr>
        <tr>
            <td>7</td>
            <td>contact</td>
        </tr>
        <tr>
            <td>8 (désactivé)</td>
            <td>conditions d'utilisation</td>
        </tr>
        <tr>
            <td>9 (désactivé)</td>
            <td>livre d'or</td>
        </tr>
        <tr>
            <td>0</td>
            <td>lien vers la liste des raccourcis</td>
        </tr>
        </tbody>
    </table>
</div>

{% endblock %}
```


---

### 📄 `app/templates/app/afficherlogements.html` [2.431 octets]
<a id="app-templates-app-afficherlogements-html"></a> [↩ Retour à l'arborescence](#tree-app-templates-app-afficherlogements-html)

> **Chemin relatif** : `app/templates/app/afficherlogements.html`  
> **Taille** : 2.431 octets  
> **Lignes** : 74  
> **Type** : html

```html
{% extends "app/base.html" %}

{% block content %}

<div id="contenu">
    <a id="accescontenu"></a>
    <h2>Fiche d'un logement</h2>

    <table class="tableau" summary="Tableau des informations sur le logement">
        <caption>
        Informations sur le logement
        </caption>
        <tbody>
        <tr>
            <th scope="row">Numero</th>
            <td>{{ logement.number }}</td>
        </tr>
        <tr>
            <th scope="row">Type</th>
            <td>{{ logement.type }}</td>
        </tr>
        <tr>
            <th scope="row">Adresse</th>
            <td>{{ logement.address }} {{ logement.postal_code }} {{ logement.city }}</td>
        </tr>
        <tr>
            <th scope="row">Etage</th>
            <td>{{ logement.floor }}</td>
        </tr>
        <tr>
            <th scope="row">Superficie (m²)</th>
            <td>{{ logement.size }}</td>
        </tr>
        <tr>
            <th scope="row">Chauffage</th>
            <td>{{ logement.heating }}</td>
        </tr>
        <tr>
            <th scope="row">Divers</th>
            <td>{% if logement.elevator %}ascenceur{% endif %} {% if logement.intercom %}interphone{% endif %} {% if logement.basement %}cave{% endif %} {% if logement.parking %}parking{% endif %}</td>
        </tr>
        <tr>
            <th scope="row">Transport</th>
            <td>{% if logement.metro %}metro{% endif %} {% if logement.sncf %}train{% endif %} {% if logement.rer %}rer{% endif %} {% if logement.bus %}bus{% endif %}</td>
        </tr>
        <tr>
            <th scope="row">Loyer charges compr.</th>
            <td>{{ logement.rent_and_utilities }} €</td>
        </tr>
        <tr>
            <th scope="row">Social/intermédiaire/non plafonné</th>
            <td>{{ logement.renting_model }}</td>
        </tr>
        <tr>
            <th scope="row">Date limite de candidature</th>
            <td>{{ logement.application_deadline|date:"d/m/Y" }}</td>
        </tr>
        <tr>
            <th scope="row">Location prévue le</th>
            <td>{{ logement.renting_from|date:"d/m/Y" }}</td>
        </tr>
        <tr>
            <th scope="row">Nbre de candidatures enregistrées</th>
            <td>{{ logement.number_of_applications }}</td>
        </tr>
        <tr>
            <th scope="row">Remarque</th>
            <td>{{ logement.info }}</td>
        </tr>
        </tbody>
    </table>
</div>

{% endblock %}
```


---

### 📄 `app/templates/app/aide.html` [1.085 octets]
<a id="app-templates-app-aide-html"></a> [↩ Retour à l'arborescence](#tree-app-templates-app-aide-html)

> **Chemin relatif** : `app/templates/app/aide.html`  
> **Taille** : 1.085 octets  
> **Lignes** : 31  
> **Type** : html

```html
{% extends "app/base.html" %}

{% block content %}

<div id="contenu">
    <a id="accescontenu"></a>
    <h2>Aide générale de Palome</h2>
    <p>
        Le site Palome a vocation à vous aider à trouver un logement dans Paris ou
        dans ses environs, mis à disposition par des bailleurs, généralement
        sociétés d'HLM, qui ont signé une convention avec le Ministère.<br /><br />
        Dans le menu de gauche de chaque page:
    </p>
    <ul>
        <li>
        La partie "Consultation" vous permet de consulter la carte et la liste des
        logements ministériels disponibles, mis à jour très régulièrement (la date
        et l'heure sont indiqués), ainsi que la fiche de chacun des logements.
        </li>
        <li>
        La partie "Informations diverses" vous permet d'accéder à quelques pages
        d'informations qui vous seront nécessaires pour vous porter candidat sur
        un logement.
        </li>
    </ul>
    Bonne consultation de ce site<br />
    L'unité logement SG/DRH/CRHAC2/PAS/LOG
    <p></p>
</div>

{% endblock %}
```


---

### 📄 `app/templates/app/base.html` [11.813 octets]
<a id="app-templates-app-base-html"></a> [↩ Retour à l'arborescence](#tree-app-templates-app-base-html)

> **Chemin relatif** : `app/templates/app/base.html`  
> **Taille** : 11.813 octets  
> **Lignes** : 225  
> **Type** : html

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (225 lignes) - Cliquer pour déplier</summary>

```html
<!DOCTYPE html>
<html lang="en">
    <head>
        {% load static %}
        <title>Palome - logements réservés aux agents des administrations centrales</title>
        <meta charset="UTF-8"/>
        <link title="charte intranet" rel="stylesheet" href="{% static 'app/css/intranet/menu-horizontal.css' %}" type="text/css">
        <script type="text/javascript" src="{% static 'app/js/menu-horizontal.js' %}""></script>
        <link title="charte intranet" rel="stylesheet" href="{% static 'app/css/intranet/complet.css' %}" type="text/css">
        <link title="charte intranet" rel="stylesheet" href="{% static 'app/css/intranet/couleurs.css' %}" type="text/css">
        <link title="charte intranet" rel="stylesheet" href="{% static 'app/css/application/application.css' %}" type="text/css">
        <link title="texte seul" rel="stylesheet" href="{% static 'app/css/texte/texte_seul.css' %}" type="text/css">
        <link rel="icon" href="{% static 'app/images/favicon.ico' %}">
    </head>
    <body onload="init();">
        <noscript>
            <div>
                Si votre navigateur ne supporte pas les scripts, il ne sera pas possible d'utiliser les menus déroulants du menu principal avec le clavier
            </div>
        </noscript>
        <div id="accessibilite">
            <ul>
                <li>
                    <a href="/accessibilite/" accesskey="0" title="Comment ce site est accessible ?">
                        <span class="invisible">Politique d'accessibilité</span>&nbsp;
                    </a>
                </li>
                <li>
                    <a href="#contenu" accesskey="s" title="Aller au contenu">
                        <span class="invisible">Aller au contenu</span>&nbsp;
                    </a>
                </li>
                <li>
                    <a href="/accueil/" accesskey="1" title="Aller à la page d'accueil">
                        <span class="invisible">Aller à la page d'accueil</span>&nbsp;
                    </a>
                </li>
                <li>
                    <a href="#menu1" title="Aller au menu contextuel">
                        <span class="invisible">Aller au menu contextuel</span>&nbsp;
                    </a>
                </li>
                <li>
                    <a href="#recherche" title="Aller à la recherche">
                        <span class="invisible">Aller à la recherche</span>&nbsp;
                    </a>
                </li>
            </ul>
        </div>
        <div id="haut">
            <div id="conteneurhaut">
                <h2 class="invisible">Navigation et outils</h2>
                <div id="telecommande">
                    <h3 class="invisible">Télé-commande : liste de liens en rapport avec l'application</h3>
                    <ul>
                        <li>
                            <a href="https://intra.portail.e2.rie.gouv.fr/" title="ouverture nouvelle fenêtre" target="_blank">Portail intranet du ministère</a>
                        </li>
                        <li>
                            <a href="http://pandocsdx.cete-np.i2/annuaire/indexIntranet.xsp" title="ouverture nouvelle fenêtre" target="_blank">Guide ressources intranet</a>
                        </li>
                        <li>
                            <a href="https://www.ecologie.gouv.fr/" title="ouverture nouvelle fenêtre" target="_blank">Portail internet du ministère</a>
                        </li>
                        <li>
                            <a href="http://pandocsdx.cete-np.i2/annuaire/indexInternet.xsp" title="ouverture nouvelle fenêtre" target="_blank">Guide ressources internet</a>
                        </li>
                        <li>
                            <a href="http://recherche.application.i2" title="ouverture nouvelle fenêtre" target="_blank">Moteur de recherche national</a>
                        </li>
                    </ul>
                </div>
                <div id="nomdusite">
                    <h3 class="invisible">Nom de l'application</h3>
                    <p id="logodusite">
                        Palome - logements réservés aux agents des administrations centrales
                    </p>
                </div>
                <div class="clr"></div>
            </div>
            <div id="menuprincipal">
                <h3 class="invisible">Menu principal</h3>
            
                <div class="rounded-bl">
                    <div class="rounded-tl">
                        <ul id="menu" class="menu">
                            <li id="accueil">
                                <a href="/accueil/" tabindex="1" title="Retour à la page d'accueil">Accueil</a>
                            </li>
                            <li id="consultation">
                                <a href="" tabindex="2" title="">Consultation</a>
                            </li>
                            <li id="informations diverses">
                                <a href="" tabindex="5" title="">Informations diverses</a>
                            </li>
                            <li id="aide">
                                <a href="/aidegenerale/" accesskey="6" tabindex="10" title="Aide générale dans une nouvelle fenêtre" onclick="window.open('/aidegenerale/','','width=600,height=480,toolbar=no,location=no,menubar=no,resizable=yes,status=no');return false;">Aide générale</a>
                            </li>
                        </ul>
                    </div>
                </div>
            
                <div id="consultation_" style="display: none; position: absolute; top: 1.55em;">
                    <span class="LI_ListeTitre" style="display: none;">Consultation</span>
                    <ul class="sousMenu">
                        <li><a href="/cartelogements/" tabindex="3" title="Visualisation de la carte des logements">Carte des logements</a></li><li><a href="/listerlogements/" tabindex="4" title="Visualisation de la liste des logements">Liste des logements</a></li>
                    </ul>
                </div>
            
                <div id="informations diverses_" style="display: none; position: absolute; top: 1.55em;">
                    <span class="LI_ListeTitre" style="display: none;">Informations diverses</span>
                    <ul class="sousMenu">
                        <li><a href="/procedureministere/" tabindex="6" title="Procédure pour logements ministériels">Procédure pour logements ministériels</a></li><li><a href="/procedureinterministere/" tabindex="7" title="Procédure pour logements interministériels">Procédure pour logements interministériels</a></li><li><a href="/residencerenan/" tabindex="8" title="Résidence Ernest Renan">Résidence Ernest Renan</a></li><li><a href="/residencebollee/" tabindex="9" title="Résidence Léon Bollée">Résidence Léon Bollée</a></li>
                    </ul>
                </div>
            </div>
            <div id="messagedeservice">
                <h3 class="invisible">Message de service</h3>
            </div>
        </div>
        <div id="conteneurmilieularge">
            <div id="milieu">
                <div id="gauche">
                    <h3 class="invisible">Recherche</h3>
                    <div id="recherche"></div>
                    <br />
                    <div id="menu1">
                      <h3 class="invisible">Menu contextuel</h3>
                  
                      <br />
                      <ul>
                        <li>
                          <div class="rounded-tr"><div class="rounded-br">Consultation</div></div>
                          <ul>
                            <li>
                              <a
                                href="/cartelogements/"
                                title="Visualisation de la carte des logements"
                                >Carte des logements</a
                              >
                            </li>
                  
                            <li>
                              <a
                                href="/listerlogements/"
                                title="Visualisation de la liste des logements"
                                >Liste des logements</a
                              >
                            </li>
                          </ul>
                        </li>
                  
                        <li>
                          <div class="rounded-tr">
                            <div class="rounded-br">Informations diverses</div>
                          </div>
                          <ul>
                            <li>
                              <a
                                href="/procedureministere/"
                                title="Procédure pour logements ministériels"
                                >Procédure pour logements ministériels</a
                              >
                            </li>
                  
                            <li>
                              <a
                                href="/procedureinterministere/"
                                title="Procédure pour logements interministériels"
                                >Procédure pour logements interministériels</a
                              >
                            </li>
                  
                            <li>
                              <a href="/residencerenan/" title="Résidence Ernest Renan"
                                >Résidence Ernest Renan</a
                              >
                            </li>
                  
                            <li>
                              <a href="/residencebollee/" title="Résidence Léon Bollée"
                                >Résidence Léon Bollée</a
                              >
                            </li>
                          </ul>
                        </li>
                      </ul>
                    </div>
                </div>                  
                <div id="centre">
                    <div id="barreprogression">
                        <h3 class="invisible">Chemin de progression dans l'application</h3>
                      
                        <a href="/accueil/" title="Accueil">Accueil</a>
                    </div>
                    {% block content %}{% endblock %}
                </div>
                <div class="clr"></div>
            </div>
        </div>
        <div id="bas">
            <div class="clr"></div>
            <div id="pied">
                <h2 class="invisible">Outils du site</h2>
                <div id="outils">
                    <ul>
                        <li>X.Y.Z - Mise à jour le : JJ/MM/AAAA</li>
                        <li><a href="/plan/" accesskey="3" title="Plan du site">Plan du site</a></li>
                        <li>
                            <a href="/aidegenerale/" accesskey="5" title="Aide générale dans une nouvelle fenêtre" onclick="window.open('/aidegenerale/','','width=600,height=480,toolbar=no,location=no,menubar=no,resizable=yes,status=no');return false;">Aide générale</a>
                        </li>
                        <li><a accesskey="7" href="mailto:secteur-logement.log.pas.crhac2.drh.sg@developpement-durable.gouv.fr">Message à l'éditeur</a></li>
                    </ul>
                </div>
                <div id="copyright">
                    <p>© Direction des ressources humaines - département de la coordination des ressources humaines et de l'administration centrale</p> 
                </div>
                <div id="pieddroit">

                </div>
            </div>
        </div>
    </body>
</html>

```

</details>


---

### 📄 `app/templates/app/cartelogements.html` [16.998 octets]
<a id="app-templates-app-cartelogements-html"></a> [↩ Retour à l'arborescence](#tree-app-templates-app-cartelogements-html)

> **Chemin relatif** : `app/templates/app/cartelogements.html`  
> **Taille** : 16.998 octets  
> **Lignes** : 457  
> **Type** : html

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (457 lignes) - Cliquer pour déplier</summary>

```html
{% extends "app/base.html" %}

{% block content %}
{% load static %}

<div id="contenu">
    <a id="accescontenu"></a>
    <h2>Carte des logements</h2>

    <table
    width="394"
    height="402"
    cellspacing="0"
    cellpadding="0"
    border="0"
    background="{% static 'app/images/ile-de-france-secteurs-paris.gif' %}"
    >
    <tbody>
        <tr>
            <td width="7%" height="11"></td>
            <td width="7%" height="11"></td>
            <td width="7%" height="11"></td>
            <td width="7%" height="11"></td>
            <td width="7%" height="11"></td>
            <td width="7%" height="11"></td>
            <td width="7%" height="11"></td>
            <td width="7%" height="11"></td>
            <td width="7%" height="11"></td>
            <td width="7%" height="11"></td>
            <td width="7%" height="11"></td>
            <td width="7%" height="11"></td>
            <td width="7%" height="11"></td>
            <td width="9%" height="11"></td>
        </tr>

        <tr>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26" align="center">
                <font face="Comic Sans MS"
                ><input
                    type="text"
                    name="T1"
                    size="1"
                    style="font-family: Arial Narrow; font-size: xx-small"
                    value="X"
                    readonly=""
                /></font>
            </td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="9%" height="26"></td>
        </tr>
        
        <tr>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26">&nbsp;</td>
            <td width="7%" valign="bottom" height="26">
                <div align="right">
                <p>
                    <font face="Comic Sans MS"
                    ><input
                        type="text"
                        name="T1"
                        size="1"
                        style="font-family: Arial Narrow; font-size: xx-small"
                        value="{{ housings_in_95 }}"
                        readonly=""
                    /></font>
                </p>
                </div>
            </td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="9%" height="26"></td>
        </tr>

        <tr>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" valign="top" height="26" align="center">&nbsp;</td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="9%" height="26"></td>
        </tr>

        <tr>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" valign="bottom" height="26">
                <div align="center">
                <center>
                    <p>
                    <font face="Comic Sans MS"
                        ><input
                        type="text"
                        name="T1"
                        size="1"
                        style="font-family: Arial Narrow; font-size: xx-small"
                        value="{{ housings_in_92N }}"
                        readonly=""
                    /></font>
                    </p>
                </center>
                </div>
            </td>
            <td width="7%" height="26" align="center"></td>
            <td width="7%" height="26" align="center"></td>
            <td width="7%" height="26" align="center">
                <font face="Comic Sans MS"
                ><input
                    type="text"
                    name="T1"
                    size="1"
                    style="font-family: Arial Narrow; font-size: xx-small"
                    value="{{ housings_in_93N }}"
                    readonly=""
                /></font>
            </td>
            <td width="7%" height="26" align="center"></td>
            <td width="7%" height="26" align="center"></td>
            <td width="7%" height="26" align="center"></td>
            <td width="7%" height="26" align="center"></td>
            <td width="9%" height="26" align="center"></td>
        </tr>

        <tr align="center">
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26">
                <font face="Comic Sans MS"
                ><input
                    type="text"
                    name="T1"
                    size="1"
                    style="font-family: Arial Narrow; font-size: xx-small"
                    value="{{ housings_in_92O }}"
                    readonly=""
                /></font>
            </td>
            <td width="7%" valign="bottom" height="26">
                <div align="right"><p>&nbsp;</p></div>
            </td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26">
                <div align="right"><p>&nbsp;</p></div>
            </td>
            <td width="7%" height="26">
                <font face="Comic Sans MS"
                ><input
                    type="text"
                    name="T1"
                    size="1"
                    style="font-family: Arial Narrow; font-size: xx-small"
                    value="{{ housings_in_93E }}"
                    readonly=""
                /></font>
            </td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="9%" height="26"></td>
        </tr>

        <tr align="center">
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>

            <td width="7%" height="26">
                <font face="Comic Sans MS"
                ><input
                    type="text"
                    name="T1"
                    size="1"
                    style="font-family: Arial Narrow; font-size: xx-small"
                    value="{{ housings_in_75 }}"
                    readonly=""
                /></font>
            </td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="9%" height="26">&nbsp;</td>
        </tr>

        <tr align="center">
            <td width="7%" height="26">
                <font face="Comic Sans MS"
                ><input
                    type="text"
                    name="T1"
                    size="1"
                    style="font-family: Arial Narrow; font-size: xx-small"
                    value="{{ housings_in_78 }}"
                    readonly=""
                /></font>
            </td>
            <td width="7%" height="26">
                <div align="center">
                <center><p>&nbsp;</p></center>
                </div>
            </td>
            <td width="7%" height="26" align="center"></td>
            <td width="7%" height="26" align="center">
                <font face="Comic Sans MS"
                ><input
                    type="text"
                    name="T1"
                    size="1"
                    style="font-family: Arial Narrow; font-size: xx-small"
                    value="{{ housings_in_92C }}"
                    readonly=""
                /></font>
            </td>
            <td width="7%" height="26" align="center">
                <div align="center">
                <center><p>&nbsp;</p></center>
                </div>
            </td>
            <td width="7%" height="26" align="center"></td>
            <td width="7%" height="26" align="center"></td>
            <td width="7%" valign="bottom" height="26" align="center"></td>
            <td width="7%" height="26" align="center"></td>
            <td width="7%" height="26" align="center"></td>
            <td width="7%" height="26" align="center"></td>
            <td width="7%" height="26" align="center"></td>
            <td width="7%" height="26" align="center">&nbsp;</td>
            <td width="9%" valign="top" height="26" align="center">
                <font face="Comic Sans MS"
                ><input
                    type="text"
                    name="T1"
                    size="1"
                    style="font-family: Arial Narrow; font-size: xx-small"
                    value="{{ housings_in_77 }}"
                    readonly=""
                /></font>
            </td>
        </tr>

        <tr align="center">
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26">
                <div align="right"><p>&nbsp;</p></div>
            </td>
            <td width="7%" height="26">
                <div align="right"><p>&nbsp;</p></div>
            </td>
            <td width="7%" height="26">&nbsp;</td>
            <td width="7%" height="26"></td>

            <td width="7%" height="26">
                <div align="center">
                <center><p>&nbsp;</p></center>
                </div>
            </td>
            <td width="7%" height="26" align="center">
                <font face="Comic Sans MS"
                ><input
                    type="text"
                    name="T1"
                    size="1"
                    style="font-family: Arial Narrow; font-size: xx-small"
                    value="{{ housings_in_94N }}"
                    readonly=""
                /></font>
            </td>
            <td width="7%" height="26" align="center"></td>
            <td width="7%" height="26" align="center"></td>
            <td width="9%" height="26" align="center"></td>
        </tr>

        <tr align="center">
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26">
                <font face="Comic Sans MS"
                ><input
                    type="text"
                    name="T1"
                    size="1"
                    style="font-family: Arial Narrow; font-size: xx-small"
                    value="{{ housings_in_92S }}"
                    readonly=""
                /></font>
            </td>
            <td width="7%" height="26"></td>
            <td width="7%" valign="top" height="26">
                <font face="Comic Sans MS"
                ><input
                    type="text"
                    name="T2"
                    size="1"
                    style="font-family: Arial Narrow; font-size: xx-small"
                    value="{{ housings_in_94O }}"
                    readonly=""
                /></font>
            </td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="9%" height="26"></td>
        </tr>

        <tr align="center">
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26">
                <font face="Comic Sans MS"
                ><input
                    type="text"
                    name="T1"
                    size="1"
                    style="font-family: Arial Narrow; font-size: xx-small"
                    value="{{ housings_in_94S }}"
                    readonly=""
                /></font>
            </td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26">&nbsp;</td>
            <td width="7%" height="26">&nbsp;</td>
            <td width="7%" height="26">
                <font face="Comic Sans MS"
                ><input
                    type="text"
                    name="T1"
                    size="1"
                    style="font-family: Arial Narrow; font-size: xx-small"
                    value="{{ housings_in_94E }}"
                    readonly=""
                /></font>
            </td>
            <td width="9%" height="26"></td>
        </tr>

        <tr align="center">
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="9%" height="26"></td>
        </tr>

        <tr align="center">
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26">
                <font face="Comic Sans MS"
                ><input
                    type="text"
                    name="T1"
                    size="1"
                    style="font-family: Arial Narrow; font-size: xx-small"
                    value="{{ housings_in_91 }}"
                    readonly=""
                /></font>
            </td>
            <td width="7%" valign="top" height="26">&nbsp;</td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="9%" height="26"></td>
        </tr>

        <tr align="center">
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="7%" height="26"></td>
            <td width="9%" height="26"></td>
        </tr>
    </tbody>
    </table>

    {% load tz %}
    Informations du {{ latest_update|date:"d/m/Y H:i" }}

    <br />
</div>

{% endblock%}
```

</details>


---

### 📄 `app/templates/app/error.html` [1.265 octets]
<a id="app-templates-app-error-html"></a> [↩ Retour à l'arborescence](#tree-app-templates-app-error-html)

> **Chemin relatif** : `app/templates/app/error.html`  
> **Taille** : 1.265 octets  
> **Lignes** : 33  
> **Type** : html

```html
{% extends "app/base.html" %}

{% block content %}
{% load static %}

<div id="contenu">
    <h2>
        Erreur {{ type }} :
        {% if type == 403 %}accès non autorisé{% endif %}
        {% if type == 404 %}page non trouvée{% endif %}
        {% if type == 500 %}erreur de l'application{% endif %}
    </h2>
    <p>
        {% if type == 403 %}Vous n'avez pas les habilitations nécessaires pour accéder à la page que vous avez demandée.{% endif %}
        {% if type == 404 %}La page que vous avez demandée n'existe pas dans l'application.{% endif %}
        {% if type == 500 %}Une erreur vient de se produire dans l'application.{% endif %}
    </p>
    <p>
        Vous pouvez revenir à la <a href="javascript:history.back();">page précédente</a>, à la <a href="/accueil">page d'accueil</a> de l'application ou essayer de rafraîchir la page demandée.
    </p>
    <p>Si ce problème persiste, vous pouvez envoyer un message au gestionnaire pour lui en faire part.</p>
    {% if exception_message %}
        <h3>Message de l'exception</h3>
        <pre>{{ exception_message }}</pre>
    {% endif %}
    {% if exception_stack %}
        <h3>Pile de l'exception</h3>
        <pre>{{ exception_stack }}</pre>
    {% endif %}

</div>

{% endblock %}
```


---

### 📄 `app/templates/app/index.html` [1.718 octets]
<a id="app-templates-app-index-html"></a> [↩ Retour à l'arborescence](#tree-app-templates-app-index-html)

> **Chemin relatif** : `app/templates/app/index.html`  
> **Taille** : 1.718 octets  
> **Lignes** : 29  
> **Type** : html

```html
{% extends "app/base.html" %}

{% block content %}
<div id="contenu">
    <a id="accescontenu"></a>
    <h2>Page d'accueil</h2>
    <h3>Vous êtes agent en poste en administration centrale ou dans un service parisien ?</h3>
    <p>
        La Direction des Ressources Humaines peut vous aider à trouver un logement dans Paris ou dans ses environs. Le ministère a en effet obtenu que des bailleurs, généralement sociétés d'HLM, réservent des logements (voir la liste) pour les agents du ministère.
    </p>
    <h3>Logements ministériels</h3>
    <ul>
        <li><a href="/cartelogements/" title="Visualisation de la carte des logements">Voir la carte des logements</a></li><li><a href="/listerlogements/" title="Visualisation de la liste des logements">Voir la liste des logements</a></li>
        <li><a href="/procedureministere/" title="">La procédure pour les logements ministériels</a></li>
        <li><a href="/parclogement/" title="">Le parc de logements du ministère</a></li>
    </ul>
    <h3>Logements interministériels</h3>
    Comme tout fonctionnaire ou agent de l'État en poste en Île-de-France, vous pouvez demander à bénéficier de logements réservés dans le cadre interministériel.
    <ul>
        <li><a href="/procedureinterministere/" title="">La procédure pour les logements interministériels</a></li>
    </ul>
    <h3>Logements en résidences</h3>
    Des logements meublés en résidences sont également disponibles.
    <ul>
        <li><a href="/residencerenan/" title="">Résidence Ernest Renan à Issy-Les-Moulineaux</a></li>
        <li><a href="/residencebollee/" title="">Résidence Léon Bollée à Paris, XIIIème arr.</a></li>
    </ul>
</div>
{% endblock %}
```


---

### 📄 `app/templates/app/listerlogements.html` [2.046 octets]
<a id="app-templates-app-listerlogements-html"></a> [↩ Retour à l'arborescence](#tree-app-templates-app-listerlogements-html)

> **Chemin relatif** : `app/templates/app/listerlogements.html`  
> **Taille** : 2.046 octets  
> **Lignes** : 58  
> **Type** : html

```html
{% extends "app/base.html" %}

{% block content %}
{% load static %}

<div id="contenu">
    <a id="accescontenu"></a>
    <h2>Liste des logements</h2>

    {% if logements_list %}
    <b>Veuillez visiter les quartiers avant de vous porter candidat.</b>
    <table class="tableau" summary="Logements disponibles">
        <caption>
        Logements disponibles
        </caption>
        <thead>
        <tr>
            <th scope="col" id="action">Voir</th>
            <th scope="col" id="numero">Numero</th>
            <th scope="col" id="type">Type</th>
            <th scope="col" id="adresse">Adresse</th>
            <th scope="col" id="loyerCharges">Loyer charges compr.</th>
            <th scope="col" id="typeLogement">Social/intermédiaire/non plafonné</th>
            <th scope="col" id="nbrCandidats">Nbre de candidatures enregistrées</th>
        </tr>
        </thead>
        <tbody>
        {% for logement in logements_list %}
        <tr {% if forloop.counter|divisibleby:2 %}class="impair"{% else %}class=""{% endif %}>
            <td headers="action">
            <a href="/afficherlogement?id={{ logement.id }}"
                ><img
                src="{% static 'app/images/pictos/picto_rechercher.gif' %}"
                title="Voir"
                alt="Voir" /></a
            ><br />
            </td>
            <td headers="numero">{{ logement.number }}</td>
            <td headers="type">{{ logement.type }}</td>
            <td headers="adresse">{{ logement.address }} {{ logement.postal_code }} {{ logement.city }}</td>
            <td headers="loyerCharges">{{ logement.rent_and_utilities }} €</td>
            <td headers="typeLogement">{{ logement.renting_model }}</td>
            <td headers="nbrCandidats">{{ logement.number_of_applications }}</td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
    Informations du {{ latest_update|date:"d/m/Y H:i" }}
    {% else %}
    <p>Pas de logement disponible.</p>
    {% endif %}

    {% load tz %}

    <br />
</div>

{% endblock %}
```


---

### 📄 `app/templates/app/parc.html` [659 octets]
<a id="app-templates-app-parc-html"></a> [↩ Retour à l'arborescence](#tree-app-templates-app-parc-html)

> **Chemin relatif** : `app/templates/app/parc.html`  
> **Taille** : 659 octets  
> **Lignes** : 21  
> **Type** : html

```html
{% extends "app/base.html" %}

{% block content %}
{% load static %}

<div id="contenu">
    <a id="accescontenu"></a>
    <h2>Parc de logements réservés du ministère</h2>

    Ne sont représentées dans la carte ci-dessous que les 43 villes comportant
    plus de 10 logements.<br /><br />
    Les logements en résidences (180 dans Paris et 60 à Issy Les Moulineaux) sont
    également comptabilisés.<br /><br />
    <img src="{% static 'app/images/cartelogement.gif' %}" alt="carte des logements" border="0" />
    <p>
        Candidature et renseignements : téléphoner au secteur logement au
        01.40.81.66.91
    </p>
</div>

{% endblock %}
```


---

### 📄 `app/templates/app/plan.html` [2.747 octets]
<a id="app-templates-app-plan-html"></a> [↩ Retour à l'arborescence](#tree-app-templates-app-plan-html)

> **Chemin relatif** : `app/templates/app/plan.html`  
> **Taille** : 2.747 octets  
> **Lignes** : 99  
> **Type** : html

```html
{% extends "app/base.html" %}

{% block content %}
{% load static %}

<div id="contenu">
    <a id="accescontenu"></a>
    <h2>Plan des fonctions de Palome</h2>

    <div class="rounded-bl">
        <div class="rounded-tl">
        <ul id="menu" class="menu">
            <li id="accueil">
            <a href="/accueil" tabindex="1" title="Retour à la page d'accueil"
                >Accueil</a
            >
            </li>

            <li id="consultation">
            <a href="" tabindex="2" title="">Consultation</a>
            </li>

            <li id="informations diverses">
            <a href="" tabindex="5" title="">Informations diverses</a>
            </li>

            <li id="aide">
            <a
                href="/aidegenerale"
                accesskey="6"
                tabindex="10"
                title="Aide générale dans une nouvelle fenêtre"
                onclick="window.open('aidegenerale','','width=600,height=480,toolbar=no,location=no,menubar=no,resizable=yes,status=no');return false;"
                >Aide générale</a
            >
            </li>
        </ul>
        </div>
    </div>

    <div id="consultation_">
        <span class="LI_ListeTitre">Consultation</span>
        <ul class="sousMenu">
        <li>
            <a
            href="/cartelogements"
            tabindex="3"
            title="Visualisation de la carte des logements"
            >Carte des logements</a
            >
        </li>
        <li>
            <a
            href="/listerlogements"
            tabindex="4"
            title="Visualisation de la liste des logements"
            >Liste des logements</a
            >
        </li>
        </ul>
    </div>

    <div id="informations diverses_">
        <span class="LI_ListeTitre">Informations diverses</span>
    } 

    @() @main(content)
            <ul class="sousMenu">
        <li>
            <a
            href="/procedureministere"
            tabindex="6"
            title="Procédure pour logements ministériels"
            >Procédure pour logements ministériels</a
            >
        </li>
        <li>
            <a
            href="/procedureinterministere"
            tabindex="7"
            title="Procédure pour logements interministériels"
            >Procédure pour logements interministériels</a
            >
        </li>
        <li>
            <a href="/residencerenan" tabindex="8" title="Résidence Ernest Renan"
            >Résidence Ernest Renan</a
            >
        </li>
        <li>
            <a href="/residencebollee" tabindex="9" title="Résidence Léon Bollée"
            >Résidence Léon Bollée</a
            >
        </li>
        </ul>
    </div>
</div>

{% endblock %}
```


---

### 📄 `app/templates/app/procedure_interministere.html` [2.485 octets]
<a id="app-templates-app-procedure_interministere-html"></a> [↩ Retour à l'arborescence](#tree-app-templates-app-procedure_interministere-html)

> **Chemin relatif** : `app/templates/app/procedure_interministere.html`  
> **Taille** : 2.485 octets  
> **Lignes** : 70  
> **Type** : html

```html
{% extends "app/base.html" %}

{% block content %}
{% load static %}

<div id="contenu">
    <a id="accescontenu"></a>
    <h2>Procédure pour les logements interministériels</h2>

    <p>
        <b
        >La procédure d'accès aux logements interministériels a changé depuis le
        17 avril 2015.</b
        >
    </p>
    Vous trouverez pour votre recherche de logement interministériel toutes les
    informations utiles sur le site
    <a
        href="http://www.drihl.ile-de-france.developpement-durable.gouv.fr/comment-deposer-une-demande-a3021.html"
        title="ouverture nouvelle fenêtre"
        target="_blank"
        >http://www.drihl.ile-de-france.developpement-durable.gouv.fr/comment-deposer-une-demande-a3021.html</a
    >
    <h3>Pour accéder à cette procédure, vous devez :</h3>
    <ul>
        <li>
        avoir une demande de logement social active que vous pouvez déposer ou
        mettre à jour sur le site
        <a
            href="http://www.demande-logement-social.gouv.fr"
            title="ouverture nouvelle fenêtre"
            target="_blank"
            >www.demande-logement-social.gouv.fr</a
        >
        </li>
        <li>
        remplir
        <a
            href="{% static 'app/docs/Fiche de situation et liste justificatifs.pdf' %}"
            title="ouverture nouvelle fenêtre"
            target="_blank"
            >la présente fiche de situation<img
            src="{% static 'app/images/icones/icone_fichier_pdf.gif' %}"
            alt="Fiche"
            border="0"
        /></a>
        et la retourner à l'unité logement de SG/DRH/CRHAC2 afin que votre demande
        soit validée dans le logiciel SYPLO après vérification (adresse mèl :
        <a
            href="mailto:secteur-logement.log.pas.crhac2.drh.sg@developpement-durable.gouv.fr"
            >secteur-logement.log.pas.crhac2.drh.sg@developpement-durable.gouv.fr</a
        >)
        </li>
    </ul>
    <h3>
        Il est conseillé de lire attentivement le guide de "L'accès au logement
        social interministériel en Ile de France" avant de faire acte de candidature
        en ligne.
    </h3>
    Toutes les vacances de logement du parc interministériel d'Ile de France sont
    mises en ligne sur le portail internet :
    <a
        href="http://www.balae.logement.gouv.fr"
        title="ouverture nouvelle fenêtre"
        target="_blank"
        >www.balae.logement.gouv.fr</a
    >
</div>

{% endblock %}
```


---

### 📄 `app/templates/app/procedure_ministere.html` [3.840 octets]
<a id="app-templates-app-procedure_ministere-html"></a> [↩ Retour à l'arborescence](#tree-app-templates-app-procedure_ministere-html)

> **Chemin relatif** : `app/templates/app/procedure_ministere.html`  
> **Taille** : 3.840 octets  
> **Lignes** : 95  
> **Type** : html

```html
{% extends "app/base.html" %}

{% block content %}
{% load static %}

<div id="contenu">
    <a id="accescontenu"></a>
    <h2>Procédure pour les logements ministériels</h2>

    Avant de pouvoir demander des logements réservés par le ministère, vous devez
    vous inscrire. Les renseignements que vous allez alors fournir permettront de
    vous conseiller et de vérifier l'adéquation entre votre situation et les
    logements demandés, en particulier, entre
    <a
        href="{% static 'app/docs/revenus.doc' %}"
        title="ouverture nouvelle fenêtre"
        target="_blank"
        >vos revenus et le loyer<img
        src="{% static 'app/images/icones/icone_fichier_doc.gif' %}"
        alt="Fiche"
        border="0"
    /></a>
    et entre
    <a href="/taillelogement/"
        >la taille du logement et la composition familiale</a
    >.<br />
    Le <a href="/parclogement/"> parc des logements réservés</a> est réparti sur
    toute l'Île-de-France, avec cependant une forte concentration dans certaines
    communes, en particulier autour de la Défense. C'est dans ces agglomérations
    qu'il y a le plus de logements vacants.
    <h3>S’inscrire comme demandeur de logement</h3>
    <ul>
        <li>
        Télécharger le formulaire:
        <a
            href="{% static 'app/docs/formulaire_log_ministere.doc' %}"
            title="ouverture nouvelle fenêtre"
            target="_blank"
            >Demande de logement ministériel<img
            src="{% static 'app/images/icones/icone_fichier_doc.gif' %}"
            alt="Fiche"
            border="0"
        /></a>
        </li>
        <li>
        Retourner ce document dûment rempli et signé par courriel
        <a href="mailto:secteur-logement.sg@developpement-durable.gouv.fr"
            >secteur-logement.sg@developpement-durable.gouv.fr</a
        >
        ou par télécopie au bureau DRH/CRHAC2 au 01-40-81-66-90 avec la photocopie
        de vos trois derniers bulletins ou attestation de salaire, et de vos avis
        d'imposition ou de non-imposition de l'année n-1 ( ex : avis
        <b>2012</b> pour l'année <b>2013</b>) ainsi que tous les justificatifs
        précisés dans la fiche d'inscription. Ces documents sont indispensables
        pour chaque occupant salarié du futur logement.
        </li>
        <li>Attention, les dossiers incomplets ne seront pas étudiés.</li>
    </ul>
    <h3>Demander des logements</h3>
    <ul>
        <li>
        Si vous êtes intéressés par un ou plusieurs logements (voir la liste),
        téléphoner au 01-40-81-66-91 ou envoyer par courriel à l'unité logement
        (voir ci-dessus) qui enregistrera votre candidature.<b
            >- attention à la date limite -</b
        >
        </li>
        <li>
        Le nombre de demande n’est pas limité, il est donc conseillé de demander
        plusieurs logements à la fois pour augmenter ses chances d’être logé
        rapidement.
        </li>
        <li>
        Tous les dossiers sont présentés au bureau exécutif de la commission
        logement qui arrête une liste de candidats. Ce bureau se réunit
        périodiquement au vu du nombre des dossiers et au moins une fois par mois.
        </li>
        <li>
        Si vous êtes retenus, vous êtes avisés par DRH/CRHAC2 et vous disposerez
        au maximum d'une semaine pour visiter le logement et donner un avis
        définitif.
        </li>
        <li>
        Après votre accord, vous devrez constituer votre dossier qui sera envoyé à
        la société gestionnaire des logements. Cette dernière décidera de
        l'attribution définitive.
        </li>
    </ul>
    <p>
        Candidature et renseignements : téléphoner à l'unité logement au
        01.40.81.66.91
</p>
</div>

{% endblock %}
```


---

### 📄 `app/templates/app/residencebollee.html` [3.462 octets]
<a id="app-templates-app-residencebollee-html"></a> [↩ Retour à l'arborescence](#tree-app-templates-app-residencebollee-html)

> **Chemin relatif** : `app/templates/app/residencebollee.html`  
> **Taille** : 3.462 octets  
> **Lignes** : 93  
> **Type** : html

```html
{% extends "app/base.html" %}

{% block content %}
{% load static %}

    <div id="contenu">
        <a id="accescontenu"></a>
        <h2>Résidence Léon Bollée</h2>

        <h3>Adresse</h3>
        <p>
            Résidence Léon Bollée<br /><br />
            6 avenue Léon Bollée<br />
            75640 Paris cedex 13<br /><br />
            Métro Porte de Choisy<br /><br />
            <a href="{% static 'app/images/plan.jpg' %}" title="ouverture nouvelle fenêtre" target="_blank"
            >Plan<img src="{% static 'app/images/pictos/iconInformation.gif' %}" alt="Plan" border="0"
            /></a>
        </p>

        <h3>Descriptif de la résidence</h3>
        <p>
            Vous venez à la suite d'un concours ou d'une mutation, d'être affecté à
            Paris ou en Île-de-France; vous avez la possibilité de loger, pour une
            période d'un an, dans <a href="/studette">une studette</a> ou
            <a href="/studio">un studio</a> meublés au sein de la résidence sociale
            Léon Bollée.
        </p>
        <p>
            La résidence gérée par l'association Résidences des Jeunes, conventionnée
            auprès de la Caisse d'Allocations Familiales, possède une capacité d'accueil
            de 140 studettes pour une personne et de 40 studios pour deux personnes.
        </p>
        <p>
            Elle est équipée d'une salle de sport et d'une laverie; un local est
            également mis à votre disposition afin de ranger, le cas échéant, votre
            bicyclette.
        </p>
        <p>
            Des emplacements de parking sont attribués sur demande, moyennant location
            et <b>sous réserve de disponibilité</b>.
        </p>

        <h3>Liste des pièces à fournir</h3>
        <p>
            Formulaire :
            <a
            href="{% static 'app/docs/fiche_candidature_residence.doc' %}"
            title="ouverture nouvelle fenêtre"
            target="_blank"
            >Fiche de candidature<img
                src="{% static 'app/images/icones/icone_fichier_doc.gif' %}"
                alt="Fiche"
                border="0"
            /></a>
            <br />Descriptif :
            <a
            href="{% static 'app/docs/descriptionfoyerleonbollee.doc' %}"
            title="ouverture nouvelle fenêtre"
            target="_blank"
            >Fiche de la résidence<img
                src="{% static 'app/images/icones/icone_fichier_doc.gif' %}"
                alt="Fiche"
                border="0"
            /></a>
        </p>
        <h3>A qui s'adresser ?</h3>
        <table class="tableau" summary="A qui s'adresser">
            <caption></caption>
            <thead>
            <tr>
                <th>Où déposer sa candidature ?</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>
                Unité Logement<br />SG/DRH/CRHAC2<br />Tour Pascal B - Pièce: 14.21<br />Poste
                : 01-40-81-66-91<br />
                <a href="mailto:secteur-logement.sg@developpement-durable.gouv.fr"
                    ><img
                    src="{% static 'app/images/pictos/picto_mail.gif' %}"
                    alt="Envoyer un message"
                    border="0"
                    />Envoyer un message</a
                >
                </td>
            </tr>
            </tbody>
        </table>
    </div>

{% endblock %}
```


---

### 📄 `app/templates/app/residencerenan.html` [5.007 octets]
<a id="app-templates-app-residencerenan-html"></a> [↩ Retour à l'arborescence](#tree-app-templates-app-residencerenan-html)

> **Chemin relatif** : `app/templates/app/residencerenan.html`  
> **Taille** : 5.007 octets  
> **Lignes** : 162  
> **Type** : html

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (162 lignes) - Cliquer pour déplier</summary>

```html
{% extends "app/base.html" %}

{% block content %}
{% load static %}

<div id="contenu">
    <a id="accescontenu"></a>
    <h2>Résidence sociale Ernest Renan</h2>

    <h3>Adresse</h3>
    <p>
        Résidence sociale Ernest Renan <br /><br />
        35 rue Ernest Renan<br />
        92130 Issy les Moulineaux
        <br /><br />
        Métro Corentin Celton<br /><br />
        <a href="{% static 'app/images/issy.jpg' %}" title="ouverture nouvelle fenêtre" target="_blank"
        >Plan<img src="{% static 'app/images/pictos/iconInformation.gif' %}" alt="Plan" border="0"
        /></a>
    </p>

    <h3>Descriptifs des logements</h3>
    <table class="tableau" summary="Descriptifs des logements">
        <caption></caption>
        <thead>
        <tr>
            <th></th>
            <th>Studette (1 personne)</th>
            <th>Studio meublé (2 personnes)</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>Surface</td>
            <td>environ 20m²</td>
            <td>35m²</td>
        </tr>
        <tr>
            <td>Redevance d'occupation</td>
            <td>
            <a
                href="{% static 'app/docs/redevance.doc' %}"
                title="ouverture nouvelle fenêtre"
                target="_blank"
                >Voir fiche<img
                src="{% static 'app/images/icones/icone_fichier_doc.gif' %}"
                alt="Fiche"
                border="0"
            /></a>
            </td>
            <td>
            <a
                href="{% static 'app/docs/redevance.doc' %}"
                title="ouverture nouvelle fenêtre"
                target="_blank"
                >Voir fiche<img
                src="{% static 'app/images/icones/icone_fichier_doc.gif' %}"
                alt="Fiche"
                border="0"
            /></a>
            </td>
        </tr>
        <tr>
            <td>Caution</td>
            <td>un mois de redevance d'occupation</td>
            <td>un mois de redevance d'occupation</td>
        </tr>
        <tr>
            <td>Aménagements</td>
            <td>
            ·1 lit une place<br />
            ·1 évier et 1 meuble sous-évier<br />
            ·1 placard<br />
            ·1 table et 2 chaises<br />
            ·Réfrigérateur + plaque<br />
            ·Prises téléphone et télévision<br />
            ·Douches et WC individuels
            </td>
            <td>
            ·1 lit deux places<br />
            ·1 évier et 1 meuble sous-évier<br />
            ·1 placard<br />
            ·1 table et 4 chaises<br />
            ·Réfrigérateur + plaque<br />
            ·Pas de prises téléphone ou télévision<br />
            ·Douches et WC individuels
            </td>
        </tr>
        <tr>
            <td>Literie</td>
            <td>Draps non fournis</td>
            <td>Draps non fournis</td>
        </tr>
        <tr>
            <td>Préavis de départ</td>
            <td>un mois (fin de mois ou de quinzaine)</td>
            <td>un mois (fin de mois ou de quinzaine)</td>
        </tr>
        <tr>
            <td>Parking</td>
            <td>sous réserve de disponibilité</td>
            <td>sous réserve de disponibilité</td>
        </tr>
        <tr>
            <td>Restauration</td>
            <td>non</td>
            <td>non</td>
        </tr>
        </tbody>
    </table>
    <br /><br />
    Une laverie automatique est disponible à la résidence.
    <h3>Liste des pièces à fournir</h3>
    <p>
        Formulaire :
        <a
        href="{% static 'app/docs/fiche_candidature_residence.doc' %}"
        title="ouverture nouvelle fenêtre"
        target="_blank"
        >Fiche de candidature<img
            src="{% static 'app/images/icones/icone_fichier_doc.gif' %}"
            alt="Fiche"
            border="0"
        /></a>
        <br />Descriptif :
        <a
        href="{% static 'app/docs/descriptionfoyerernestrenan.doc' %}"
        title="ouverture nouvelle fenêtre"
        target="_blank"
        >Fiche de la résidence<img
            src="{% static 'app/images/icones/icone_fichier_doc.gif' %}"
            alt="Fiche"
            border="0"
        /></a>
    </p>
    <h3>A qui s'adresser ?</h3>
    <table class="tableau" summary="A qui s'adresser">
        <caption></caption>
        <thead>
        <tr>
            <th>Où déposer sa candidature ?</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>
            Unité Logement<br />SG/DRH/CRHAC2<br />Tour Pascal B - Pièce: 14.21<br />Poste
            : 01-40-81-66-91<br />
            <a href="mailto:secteur-logement.sg@developpement-durable.gouv.fr"
                ><img
                src="{% static 'app/images/pictos/picto_mail.gif' %}"
                alt="Envoyer un message"
                border="0"
                />Envoyer un message</a
            >
            </td>
        </tr>
        </tbody>
    </table>
</div>

{% endblock %}
```

</details>


---

### 📄 `app/templates/app/studette.html` [1.605 octets]
<a id="app-templates-app-studette-html"></a> [↩ Retour à l'arborescence](#tree-app-templates-app-studette-html)

> **Chemin relatif** : `app/templates/app/studette.html`  
> **Taille** : 1.605 octets  
> **Lignes** : 47  
> **Type** : html

```html
{% extends "app/base.html" %}

{% block content %}
{% load static %}

<div id="contenu">
    <a id="accescontenu"></a>
    <h2>Descriptif studette</h2>

    <h3>Informations pratiques</h3>
    <p>
        - studette 20m² pour une personne<br />
        - Redevance d'occupation révisable au 1er juillet de chaque année :
        <a
        href="{% static 'app/docs/redevance.doc' %}"
        title="ouverture nouvelle fenêtre"
        target="_blank"
        >Voir fiche<img
            src="{% static 'app/images/icones/icone_fichier_doc.gif' %}"
            alt="Fiche"
            border="0" /></a
        ><br />
        - Caution : un mois de redevance d'occupation<br />
        - Préavis de départ : un mois<br />
        - Parking : location sur demande et dans la limite des places disponibles.
    </p>
    <img src="{% static 'app/images/studette.gif' %}" alt="plan studette" border="0" />
    <h3>Description du mobilier</h3>
    (non contractuelle et à titre indicatif)
    <p>
        - Un lit de 90*190, avec deux tiroirs<br />
        - Un meuble et une lampe de chevet<br />
        - Un meuble bas et son sur-meuble "bibliothèque"<br />
        - Un meuble TV-Hifi<br />
        - Une table et deux chaises<br />
        - Une penderie avec un côté rayonnage<br />
        - Une kitchenette avec réfrigérateur, et deux plaques de cuisson
        électrique<br />
        - Un meuble en hauteur et sous l'évier<br />
        - Prises téléphone, télévision et FM<br />
        <b>- Prévoir literie (draps) et ustensiles de cuisine.</b>
    </p>
</div>

{% endblock %}


```


---

### 📄 `app/templates/app/studio.html` [1.769 octets]
<a id="app-templates-app-studio-html"></a> [↩ Retour à l'arborescence](#tree-app-templates-app-studio-html)

> **Chemin relatif** : `app/templates/app/studio.html`  
> **Taille** : 1.769 octets  
> **Lignes** : 49  
> **Type** : html

```html
{% extends "app/base.html" %}

{% block content %}
{% load static %}

<div id="contenu">
    <a id="accescontenu"></a>
    <h2>Descriptif studio</h2>

    <h3>Informations pratiques</h3>
    <p>
        - studio 32m² pour deux personnes<br />
        - Redevance d'occupation révisable au 1er juillet de chaque année :
        <a
        href="{% static 'app/docs/redevance.doc' %}"
        title="ouverture nouvelle fenêtre"
        target="_blank"
        >Voir fiche<img
            src="{% static 'app/images/icones/icone_fichier_doc.gif' %}"
            alt="Fiche"
            border="0" /></a
        ><br />
        - Caution : un mois de redevance d'occupation<br />
        - Préavis de départ : un mois<br />
        - Parking : location sur demande et dans la limite des places disponibles.
    </p>
    <img src="{% static 'app/images/studio.jpg' %}" alt="plan studio" border="0" />
    <h3>Description du mobilier</h3>
    (non contractuelle et à titre indicatif)
    <p>
        - Un lit de 140*190<br />
        - Un meuble et une lampe de chevet<br />
        - Un meuble bas et son sur-meuble "bibliothèque"<br />
        - Un meuble TV-Hifi<br />
        - Une table ronde et deux chaises<br />
        - Un fauteuil<br />
        - Une penderie avec un côté rayonnage<br />
        - Un évier avec deux plaques de cuisson électrique, et un réfrigérateur
        <br />
        - Un meuble en hauteur et sous l'évier<br />
        - Une table portefeuille et deux tabourets<br />
        - Branchements lave linge et vaisselle<br />
        - Une armoire de toilette vitrée<br />
        - Prises téléphone, télévision et FM<br />
        <b>- Prévoir literie (draps) et ustensiles de cuisine.</b>
    </p>
</div>

{% endblock %}
```


---

### 📄 `app/templates/app/taillelogement.html` [1.274 octets]
<a id="app-templates-app-taillelogement-html"></a> [↩ Retour à l'arborescence](#tree-app-templates-app-taillelogement-html)

> **Chemin relatif** : `app/templates/app/taillelogement.html`  
> **Taille** : 1.274 octets  
> **Lignes** : 32  
> **Type** : html

```html
{% extends "app/base.html" %}

{% block content %}
{% load static %}

<div id="contenu">
    <a id="accescontenu"></a>
    <h2>Taille du logement et composition familiale</h2>

    Les normes d’occupation pour le logement social sont bien définies, par
    exemple:
    <ul>
        <li>1 personne T1 au T2 maximum (studio ou deux pièces)</li>
        <li>2 personnes du T1 au T3 maximum (studio au trois pièces)</li>
        <li>3 personnes T2 au T4 maximum (deux, trois ou quatre pièces)</li>
        <li>4 personnes T3 au T5 maximum (deux au cinq pièces)</li>
    </ul>
    Les sociétés louant les logements n’acceptent pas de sous-occupation ni de
    sur-occupation, sont comptés comme pièces principales d'habitation les
    chambres, salon et/ou salle à manger. La cuisine, salle de bain et WC ne sont
    jamais comptés.<br /><br />
    <b>La surface des logements</b> est aussi un critère de choix important, A
    titre indicatif, même si pour un même nombre de pièces, la surface peut
    beaucoup varier, elle est en moyenne pour un T1 de 30m², un T2 40m², un T3 68
    m², un T4 80m² et un T5 95m².
    <p>
        Candidature et renseignements : téléphoner au secteur logement au
        01.40.81.66.91
    </p>
</div>

{% endblock %}
```


---

### 📄 `app/tests.py` [60 octets]
<a id="app-tests-py"></a> [↩ Retour à l'arborescence](#tree-app-tests-py)

> **Chemin relatif** : `app/tests.py`  
> **Taille** : 60 octets  
> **Lignes** : 4  
> **Type** : python

```python
from django.test import TestCase

# Create your tests here.

```


---

### 📄 `app/urls.py` [1.482 octets]
<a id="app-urls-py"></a> [↩ Retour à l'arborescence](#tree-app-urls-py)

> **Chemin relatif** : `app/urls.py`  
> **Taille** : 1.482 octets  
> **Lignes** : 44  
> **Type** : python

```python
from django.urls import path

from app.views import (
    index,
    accueil,
    procedure_ministere,
    procedure_interministere,
    parc_logement,
    plan,
    studette,
    studio,
    taille_logement,
    lister_logements,
    carte_logements,
    aide_generale,
    afficher_logement,
    accessibilite,
    residence_leon_bollee,
    residence_renan,
)

urlpatterns = [
    path("", index, name="index"),
    path("accueil/", accueil, name="accueil"),
    path("procedureministere/", procedure_ministere, name="procédure ministérielle"),
    path(
        "procedureinterministere/",
        procedure_interministere,
        name="procédure interministérielle",
    ),
    path("parclogement/", parc_logement, name="parc logement"),
    path("plan/", plan, name="plan du site"),
    path("studette/", studette, name="studette"),
    path("studio/", studio, name="studio"),
    path("taillelogement/", taille_logement, name="taille logement"),
    path("listerlogements/", lister_logements, name="lister les logements"),
    path("cartelogements/", carte_logements, name="carte des logements"),
    path("aidegenerale/", aide_generale, name="aide générale"),
    path("afficherlogement/", afficher_logement, name="affichage d'un logement"),
    path("accessibilite/", accessibilite, name="accessibilité"),
    path("residencebollee/", residence_leon_bollee, name="résidence Léon Boléee"),
    path("residencerenan/", residence_renan, name="résidence Renan"),
]

```


---

### 📄 `app/views/__init__.py` [957 octets]
<a id="app-views-__init__-py"></a> [↩ Retour à l'arborescence](#tree-app-views-__init__-py)

> **Chemin relatif** : `app/views/__init__.py`  
> **Taille** : 957 octets  
> **Lignes** : 22  
> **Type** : python

```python
from app.views.accessibilite import accessibilite
from app.views.accueil import accueil
from app.views.afficher_logement import afficher_logement
from app.views.aide_generale import aide_generale
from app.views.carte_logements import carte_logements
from app.views.index import index
from app.views.lister_logements import lister_logements
from app.views.parc_logement import parc_logement
from app.views.plan import plan
from app.views.procedure_ministere import procedure_ministere
from app.views.procedure_interministere import procedure_interministere
from app.views.residence_leon_bollee import residence_leon_bollee
from app.views.residence_renan import residence_renan
from app.views.studette import studette
from app.views.studio import studio
from app.views.taille_logement import taille_logement

# errors
from app.views.errors.error403 import error403
from app.views.errors.error404 import error404
from app.views.errors.error500 import error500

```


---

### 📄 `app/views/accessibilite.py` [123 octets]
<a id="app-views-accessibilite-py"></a> [↩ Retour à l'arborescence](#tree-app-views-accessibilite-py)

> **Chemin relatif** : `app/views/accessibilite.py`  
> **Taille** : 123 octets  
> **Lignes** : 6  
> **Type** : python

```python
from django.shortcuts import render


def accessibilite(request):
    return render(request, "app/accessibilite.html", {})

```


---

### 📄 `app/views/accueil.py` [109 octets]
<a id="app-views-accueil-py"></a> [↩ Retour à l'arborescence](#tree-app-views-accueil-py)

> **Chemin relatif** : `app/views/accueil.py`  
> **Taille** : 109 octets  
> **Lignes** : 6  
> **Type** : python

```python
from django.shortcuts import render


def accueil(request):
    return render(request, "app/index.html", {})

```


---

### 📄 `app/views/afficher_logement.py` [462 octets]
<a id="app-views-afficher_logement-py"></a> [↩ Retour à l'arborescence](#tree-app-views-afficher_logement-py)

> **Chemin relatif** : `app/views/afficher_logement.py`  
> **Taille** : 462 octets  
> **Lignes** : 16  
> **Type** : python

```python
from django.shortcuts import render

from app.models import Housing


def afficher_logement(request):
    id = request.GET.get("id", None)
    if id is None:
        return render(request, "app/error.html", {})
    else:
        logement = Housing.objects.filter(id=id)[0]
        if logement is None:
            return render(request, "app/error.html", {})
        else:
            return render(request, "app/afficherlogements.html", {"logement": logement})

```


---

### 📄 `app/views/aide_generale.py` [114 octets]
<a id="app-views-aide_generale-py"></a> [↩ Retour à l'arborescence](#tree-app-views-aide_generale-py)

> **Chemin relatif** : `app/views/aide_generale.py`  
> **Taille** : 114 octets  
> **Lignes** : 6  
> **Type** : python

```python
from django.shortcuts import render


def aide_generale(request):
    return render(request, "app/aide.html", {})

```


---

### 📄 `app/views/carte_logements.py` [2.178 octets]
<a id="app-views-carte_logements-py"></a> [↩ Retour à l'arborescence](#tree-app-views-carte_logements-py)

> **Chemin relatif** : `app/views/carte_logements.py`  
> **Taille** : 2.178 octets  
> **Lignes** : 44  
> **Type** : python

```python
from django.shortcuts import render

from app.models import Housing


def carte_logements(request):
    housings_in_75 = Housing.objects.filter(zone="75", displayed=True).count()
    housings_in_77 = Housing.objects.filter(zone="77", displayed=True).count()
    housings_in_78 = Housing.objects.filter(zone="78", displayed=True).count()
    housings_in_91 = Housing.objects.filter(zone="91", displayed=True).count()
    housings_in_92S = Housing.objects.filter(zone="92Sud", displayed=True).count()
    housings_in_92C = Housing.objects.filter(zone="92Centre", displayed=True).count()
    housings_in_92O = Housing.objects.filter(zone="92Ouest", displayed=True).count()
    housings_in_92N = Housing.objects.filter(zone="92Nord", displayed=True).count()
    housings_in_93N = Housing.objects.filter(zone="93Nord", displayed=True).count()
    housings_in_93E = Housing.objects.filter(zone="93Est", displayed=True).count()
    housings_in_94S = Housing.objects.filter(zone="94Sud", displayed=True).count()
    housings_in_94O = Housing.objects.filter(zone="94Ouest", displayed=True).count()
    housings_in_94N = Housing.objects.filter(zone="94Nord", displayed=True).count()
    housings_in_94E = Housing.objects.filter(zone="94Est", displayed=True).count()
    housings_in_95 = Housing.objects.filter(zone="95", displayed=True).count()
    latest_update = Housing.objects.order_by("-added_on").first()

    context = {
        "housings_in_75": housings_in_75,
        "housings_in_77": housings_in_77,
        "housings_in_78": housings_in_78,
        "housings_in_91": housings_in_91,
        "housings_in_92S": housings_in_92S,
        "housings_in_92C": housings_in_92C,
        "housings_in_92O": housings_in_92O,
        "housings_in_92N": housings_in_92N,
        "housings_in_93N": housings_in_93N,
        "housings_in_93E": housings_in_93E,
        "housings_in_94S": housings_in_94S,
        "housings_in_94O": housings_in_94O,
        "housings_in_94N": housings_in_94N,
        "housings_in_94E": housings_in_94E,
        "housings_in_95": housings_in_95,
        "latest_update": latest_update,
    }

    return render(request, "app/cartelogements.html", context)

```


---

### 📄 `app/views/errors/error403.py` [192 octets]
<a id="app-views-errors-error403-py"></a> [↩ Retour à l'arborescence](#tree-app-views-errors-error403-py)

> **Chemin relatif** : `app/views/errors/error403.py`  
> **Taille** : 192 octets  
> **Lignes** : 8  
> **Type** : python

```python
from django.shortcuts import render


def error403(request, exception=None):
    response = render(request, "app/error.html", {"type": 403})
    response.status_code = 403
    return response

```


---

### 📄 `app/views/errors/error404.py` [192 octets]
<a id="app-views-errors-error404-py"></a> [↩ Retour à l'arborescence](#tree-app-views-errors-error404-py)

> **Chemin relatif** : `app/views/errors/error404.py`  
> **Taille** : 192 octets  
> **Lignes** : 8  
> **Type** : python

```python
from django.shortcuts import render


def error404(request, exception=None):
    response = render(request, "app/error.html", {"type": 404})
    response.status_code = 404
    return response

```


---

### 📄 `app/views/errors/error500.py` [191 octets]
<a id="app-views-errors-error500-py"></a> [↩ Retour à l'arborescence](#tree-app-views-errors-error500-py)

> **Chemin relatif** : `app/views/errors/error500.py`  
> **Taille** : 191 octets  
> **Lignes** : 8  
> **Type** : python

```python
from django.shortcuts import render


def error500(request, *args, **argv):
    response = render(request, "app/error.html", {"type": 500})
    response.status_code = 500
    return response

```


---

### 📄 `app/views/index.py` [92 octets]
<a id="app-views-index-py"></a> [↩ Retour à l'arborescence](#tree-app-views-index-py)

> **Chemin relatif** : `app/views/index.py`  
> **Taille** : 92 octets  
> **Lignes** : 6  
> **Type** : python

```python
from django.shortcuts import redirect


def index(request):
    return redirect("accueil/")

```


---

### 📄 `app/views/lister_logements.py` [410 octets]
<a id="app-views-lister_logements-py"></a> [↩ Retour à l'arborescence](#tree-app-views-lister_logements-py)

> **Chemin relatif** : `app/views/lister_logements.py`  
> **Taille** : 410 octets  
> **Lignes** : 14  
> **Type** : python

```python
from django.shortcuts import render

from app.models import Housing


def lister_logements(request):
    logements_list = Housing.objects.all().filter(displayed=True)
    latest_update = Housing.objects.order_by("-added_on").first().added_on
    context = {
        "logements_list": logements_list,
        "latest_update": latest_update,
    }
    return render(request, "app/listerlogements.html", context)

```


---

### 📄 `app/views/parc_logement.py` [114 octets]
<a id="app-views-parc_logement-py"></a> [↩ Retour à l'arborescence](#tree-app-views-parc_logement-py)

> **Chemin relatif** : `app/views/parc_logement.py`  
> **Taille** : 114 octets  
> **Lignes** : 6  
> **Type** : python

```python
from django.shortcuts import render


def parc_logement(request):
    return render(request, "app/parc.html", {})

```


---

### 📄 `app/views/plan.py` [105 octets]
<a id="app-views-plan-py"></a> [↩ Retour à l'arborescence](#tree-app-views-plan-py)

> **Chemin relatif** : `app/views/plan.py`  
> **Taille** : 105 octets  
> **Lignes** : 6  
> **Type** : python

```python
from django.shortcuts import render


def plan(request):
    return render(request, "app/plan.html", {})

```


---

### 📄 `app/views/procedure_interministere.py` [145 octets]
<a id="app-views-procedure_interministere-py"></a> [↩ Retour à l'arborescence](#tree-app-views-procedure_interministere-py)

> **Chemin relatif** : `app/views/procedure_interministere.py`  
> **Taille** : 145 octets  
> **Lignes** : 6  
> **Type** : python

```python
from django.shortcuts import render


def procedure_interministere(request):
    return render(request, "app/procedure_interministere.html", {})

```


---

### 📄 `app/views/procedure_ministere.py` [135 octets]
<a id="app-views-procedure_ministere-py"></a> [↩ Retour à l'arborescence](#tree-app-views-procedure_ministere-py)

> **Chemin relatif** : `app/views/procedure_ministere.py`  
> **Taille** : 135 octets  
> **Lignes** : 6  
> **Type** : python

```python
from django.shortcuts import render


def procedure_ministere(request):
    return render(request, "app/procedure_ministere.html", {})

```


---

### 📄 `app/views/residence_leon_bollee.py` [133 octets]
<a id="app-views-residence_leon_bollee-py"></a> [↩ Retour à l'arborescence](#tree-app-views-residence_leon_bollee-py)

> **Chemin relatif** : `app/views/residence_leon_bollee.py`  
> **Taille** : 133 octets  
> **Lignes** : 6  
> **Type** : python

```python
from django.shortcuts import render


def residence_leon_bollee(request):
    return render(request, "app/residencebollee.html", {})

```


---

### 📄 `app/views/residence_renan.py` [126 octets]
<a id="app-views-residence_renan-py"></a> [↩ Retour à l'arborescence](#tree-app-views-residence_renan-py)

> **Chemin relatif** : `app/views/residence_renan.py`  
> **Taille** : 126 octets  
> **Lignes** : 6  
> **Type** : python

```python
from django.shortcuts import render


def residence_renan(request):
    return render(request, "app/residencerenan.html", {})

```


---

### 📄 `app/views/studette.py` [113 octets]
<a id="app-views-studette-py"></a> [↩ Retour à l'arborescence](#tree-app-views-studette-py)

> **Chemin relatif** : `app/views/studette.py`  
> **Taille** : 113 octets  
> **Lignes** : 6  
> **Type** : python

```python
from django.shortcuts import render


def studette(request):
    return render(request, "app/studette.html", {})

```


---

### 📄 `app/views/studio.py` [109 octets]
<a id="app-views-studio-py"></a> [↩ Retour à l'arborescence](#tree-app-views-studio-py)

> **Chemin relatif** : `app/views/studio.py`  
> **Taille** : 109 octets  
> **Lignes** : 6  
> **Type** : python

```python
from django.shortcuts import render


def studio(request):
    return render(request, "app/studio.html", {})

```


---

### 📄 `app/views/taille_logement.py` [126 octets]
<a id="app-views-taille_logement-py"></a> [↩ Retour à l'arborescence](#tree-app-views-taille_logement-py)

> **Chemin relatif** : `app/views/taille_logement.py`  
> **Taille** : 126 octets  
> **Lignes** : 6  
> **Type** : python

```python
from django.shortcuts import render


def taille_logement(request):
    return render(request, "app/taillelogement.html", {})

```


---

### 📄 `deploy/vhost.conf` [394 octets]
<a id="deploy-vhost-conf"></a> [↩ Retour à l'arborescence](#tree-deploy-vhost-conf)

> **Chemin relatif** : `deploy/vhost.conf`  
> **Taille** : 394 octets  
> **Lignes** : 17  
> **Type** : conf

```conf
server {
        listen 8080 default_server;
        listen [::]:8080 default_server;

        index index.html index.htm index.nginx-debian.html;

        server_name _;

        location /static/ {
                autoindex on;
                autoindex_exact_size on;
                root /opt/app;
        }
        location / {
                proxy_pass http://127.0.0.1:8000;
        }
}
```


---

### 📄 `docker-compose.dev.yml` [1.100 octets]
<a id="docker-compose-dev-yml"></a> [↩ Retour à l'arborescence](#tree-docker-compose-dev-yml)

> **Chemin relatif** : `docker-compose.dev.yml`  
> **Taille** : 1.100 octets  
> **Lignes** : 38  
> **Type** : yaml

```yaml
version: "3.9"

services:
  # app:
  #   image: palome:latest
  #   container_name: palome-app
  #   build:
  #     dockerfile: ./Dockerfile
  #     args:
  #       http_proxy: "${HTTP_PROXY}"
  #       https_proxy: "${HTTP_PROXY}"
  #       HTTP_PROXY: "${HTTP_PROXY}"
  #       HTTPS_PROXY: "${HTTP_PROXY}"
  #   environment:
  #     POSTGRES_USER: "${POSTGRES_USER}"
  #     POSTGRES_PASSWORD: "${POSTGRES_PASSWORD}"
  #     POSTGRES_DB: "${POSTGRES_DB}"
  #     POSTGRES_HOST: "${POSTGRES_HOST}"
  #     POSTGRES_PORT: "${POSTGRES_PORT}"
  #     DJANGO_DEBUG: "${DJANGO_DEBUG}"
  #     CSRF_COOKIE_HTTPONLY: "${CSRF_COOKIE_HTTPONLY}"
  #     CSRF_COOKIE_SECURE: "${CSRF_COOKIE_SECURE}"
  #     CSRF_TRUSTED_ORIGINS: "${CSRF_TRUSTED_ORIGINS}"
  #   ports:
  #     - 8080:8080
  db:
    image: postgres:15.2-alpine
    container_name: palome-db
    restart: unless-stopped
    environment:
      POSTGRES_USER: "${POSTGRES_USER}"
      POSTGRES_PASSWORD: "${POSTGRES_PASSWORD}"
      POSTGRES_DB: "${POSTGRES_DB}"
    ports:
      - 5432:5432
    volumes:
      - ./pgdata:/var/lib/postgresql/data

```


---

### 📄 `docker-compose.prod.yml` [876 octets]
<a id="docker-compose-prod-yml"></a> [↩ Retour à l'arborescence](#tree-docker-compose-prod-yml)

> **Chemin relatif** : `docker-compose.prod.yml`  
> **Taille** : 876 octets  
> **Lignes** : 31  
> **Type** : yaml

```yaml
version: "3.9"

services:
  app:
    image: eu.gcr.io/dpnm3-lab/palome:latest
    container_name: palome-app
    environment:
      POSTGRES_USER: "${POSTGRES_USER}"
      POSTGRES_PASSWORD: "${POSTGRES_PASSWORD}"
      POSTGRES_DB: "${POSTGRES_DB}"
      POSTGRES_HOST: "${POSTGRES_HOST}"
      POSTGRES_PORT: "${POSTGRES_PORT}"
      DJANGO_DEBUG: "${DJANGO_DEBUG}"
      CSRF_COOKIE_HTTPONLY: "${CSRF_COOKIE_HTTPONLY}"
      CSRF_COOKIE_SECURE: "${CSRF_COOKIE_SECURE}"
      CSRF_TRUSTED_ORIGINS: "${CSRF_TRUSTED_ORIGINS}"
    ports:
      - 8080:8080
  db:
    image: postgres:15.2-alpine
    container_name: palome-db
    restart: unless-stopped
    environment:
      POSTGRES_USER: "${POSTGRES_USER}"
      POSTGRES_PASSWORD: "${POSTGRES_PASSWORD}"
      POSTGRES_DB: "${POSTGRES_DB}"
    ports:
      - 5432:5432
    volumes:
      - ./pgdata:/var/lib/postgresql/data

```


---

### 📄 `Dockerfile` [1.218 octets]
<a id="Dockerfile"></a> [↩ Retour à l'arborescence](#tree-Dockerfile)

> **Chemin relatif** : `Dockerfile`  
> **Taille** : 1.218 octets  
> **Lignes** : 50  
> **Type** : dockerfile

```dockerfile
FROM python:3.11.3-alpine3.17
ARG http_proxy
ARG https_proxy
ARG HTTP_PROXY
ARG HTTPS_PROXY

ENV DJANGO_DEBUG=False

RUN pip install -U pip setuptools && \
    pip install poetry

# make a venv
RUN python3 -m venv /opt/app/.venv
ENV PATH="/opt/app/.venv/bin:$PATH"
RUN poetry config virtualenvs.create false

# creates main work dir and copy source files
WORKDIR /opt/app
ADD app /opt/app/app
ADD static /opt/app/static
ADD palome /opt/app/palome
ADD poetry.lock /opt/app/poetry.lock
ADD pyproject.toml /opt/app/pyproject.toml
ADD manage.py /opt/app/manage.py
ADD __init__.py /opt/app/__init__.py

# activates venv
RUN poetry env use /opt/app/.venv/bin/python3

# installs building dependencies for psycopg2 + nginx
RUN apk update && \ 
    apk add --no-cache python3-dev libc-dev libpq-dev gcc nginx

# initializes project
RUN poetry install --no-interaction --no-ansi

# installs Daphne server
RUN poetry add daphne

# copies Palome vhost
COPY deploy/vhost.conf /etc/nginx/http.d/default.conf

# copies entrypoint script
COPY deploy/entrypoint.sh /entrypoint.sh
RUN chmod +x /entrypoint.sh

# builds static assets folder
RUN /opt/app/.venv/bin/python3 manage.py collectstatic --noinput

ENTRYPOINT ["/entrypoint.sh"]
```


---

### 📄 `makefile` [389 octets]
<a id="makefile"></a> [↩ Retour à l'arborescence](#tree-makefile)

> **Chemin relatif** : `makefile`  
> **Taille** : 389 octets  
> **Lignes** : 23  
> **Type** : makefile

```makefile
venv:
	python3 -m venv venv

run:
	python3 manage.py runserver 0.0.0.0:5050

migrations:
	python3 manage.py makemigrations app

migrate:
	python3 manage.py migrate

migrate_django_cron:
	python manage.py migrate django_cron

superuser:
	python3 manage.py createsuperuser

loadlogements:
	python3 manage.py loaddata fixtures/app/logements.json

runcrons:
	python3 manage.py runcrons --force
```


---

### 📄 `manage.py` [662 octets]
<a id="manage-py"></a> [↩ Retour à l'arborescence](#tree-manage-py)

> **Chemin relatif** : `manage.py`  
> **Taille** : 662 octets  
> **Lignes** : 23  
> **Type** : python

```python
#!/usr/bin/env python
"""Django's command-line utility for administrative tasks."""
import os
import sys


def main():
    """Run administrative tasks."""
    os.environ.setdefault("DJANGO_SETTINGS_MODULE", "palome.settings")
    try:
        from django.core.management import execute_from_command_line
    except ImportError as exc:
        raise ImportError(
            "Couldn't import Django. Are you sure it's installed and "
            "available on your PYTHONPATH environment variable? Did you "
            "forget to activate a virtual environment?"
        ) from exc
    execute_from_command_line(sys.argv)


if __name__ == "__main__":
    main()

```


---

### 📄 `palome/__init__.py` [0 octets]
<a id="palome-__init__-py"></a> [↩ Retour à l'arborescence](#tree-palome-__init__-py)

> **Chemin relatif** : `palome/__init__.py`  
> **Taille** : 0 octets  
> **Lignes** : 0  
> **Type** : python

```python

```


---

### 📄 `palome/asgi.py` [167 octets]
<a id="palome-asgi-py"></a> [↩ Retour à l'arborescence](#tree-palome-asgi-py)

> **Chemin relatif** : `palome/asgi.py`  
> **Taille** : 167 octets  
> **Lignes** : 8  
> **Type** : python

```python
import os

from django.core.asgi import get_asgi_application

os.environ.setdefault("DJANGO_SETTINGS_MODULE", "palome.settings")

application = get_asgi_application()

```


---

### 📄 `palome/settings.py` [5.007 octets]
<a id="palome-settings-py"></a> [↩ Retour à l'arborescence](#tree-palome-settings-py)

> **Chemin relatif** : `palome/settings.py`  
> **Taille** : 5.007 octets  
> **Lignes** : 171  
> **Type** : python

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (171 lignes) - Cliquer pour déplier</summary>

```python
import os
from pathlib import Path
from decouple import config

# Build paths inside the project like this: BASE_DIR / 'subdir'.
BASE_DIR = Path(__file__).resolve().parent.parent

# SECURITY WARNING: keep the secret key used in production secret!
SECRET_KEY = config("DJANGO_SECRET", default="toto", cast=str)

# SECURITY WARNING: don't run with debug turned on in production!
DEBUG = config("DJANGO_DEBUG", default=True, cast=bool)

ALLOWED_HOSTS = ["*"]

# CSRF STUFF
CSRF_TRUSTED_ORIGINS = config(
    "CSRF_TRUSTED_ORIGINS", default="http://localhost", cast=str
).split(",")
CSRF_COOKIE_SECURE = config("CSRF_COOKIE_SECURE", default=False, cast=bool)
CSRF_COOKIE_HTTPONLY = config("CSRF_COOKIE_HTTPONLY", default=False, cast=bool)
SECURE_CROSS_ORIGIN_OPENER_POLICY = config(
    "SECURE_CROSS_ORIGIN_OPENER_POLICY", default="same-origin", cast=str
)

# Application definition

INSTALLED_APPS = [
    "palome",
    "app.apps.AppConfig",
    "django.contrib.admin",
    "django.contrib.auth",
    "django.contrib.contenttypes",
    "django.contrib.sessions",
    "django.contrib.messages",
    "django.contrib.staticfiles",
    "django_cron",
]

MIDDLEWARE = [
    "django.middleware.security.SecurityMiddleware",
    "django.contrib.sessions.middleware.SessionMiddleware",
    "django.middleware.common.CommonMiddleware",
    "django.middleware.csrf.CsrfViewMiddleware",
    "django.contrib.auth.middleware.AuthenticationMiddleware",
    "django.contrib.messages.middleware.MessageMiddleware",
    "django.middleware.clickjacking.XFrameOptionsMiddleware",
]

CRON_CLASSES = [
    "app.crons.UpdateHousings",
]

ROOT_URLCONF = "palome.urls"

TEMPLATES = [
    {
        "BACKEND": "django.template.backends.django.DjangoTemplates",
        "DIRS": [],
        "APP_DIRS": True,
        "OPTIONS": {
            "context_processors": [
                "django.template.context_processors.debug",
                "django.template.context_processors.request",
                "django.contrib.auth.context_processors.auth",
                "django.contrib.messages.context_processors.messages",
            ],
        },
    },
]

# WSGI_APPLICATION = "wsgi.application"


# Database
# https://docs.djangoproject.com/en/4.2/ref/settings/#databases

DATABASES = {
    "default": {  #
        "ENGINE": "django.db.backends.postgresql_psycopg2",
        "NAME": config("POSTGRES_DB", default=None, cast=str),
        "USER": config("POSTGRES_USER", default=None, cast=str),
        "PASSWORD": config("POSTGRES_PASSWORD", default=None, cast=str),
        "HOST": config("POSTGRES_HOST", default="db", cast=str),
        "PORT": config("POSTGRES_PORT", default=5432, cast=int),
    }
}


# Password validation
# https://docs.djangoproject.com/en/4.2/ref/settings/#auth-password-validators

AUTH_PASSWORD_VALIDATORS = [
    {
        "NAME": "django.contrib.auth.password_validation.UserAttributeSimilarityValidator",
    },
    {
        "NAME": "django.contrib.auth.password_validation.MinimumLengthValidator",
    },
    {
        "NAME": "django.contrib.auth.password_validation.CommonPasswordValidator",
    },
    {
        "NAME": "django.contrib.auth.password_validation.NumericPasswordValidator",
    },
]

AUTHENTICATION_BACKENDS = [
    "django.contrib.auth.backends.ModelBackend",
]

# auth mode
AUTH_MODE = config("AUTH_MODE", default="local", cast=str)
# adds 'django_cas_ng to INSTALLED_APPS if AUTH_MODE is set to 'cas'
if AUTH_MODE == "cas":
    INSTALLED_APPS.append("django_cas_ng")
    MIDDLEWARE.append("django_cas_ng.middleware.CASMiddleware")
    AUTHENTICATION_BACKENDS.append("django_cas_ng.backends.CASBackend")
# CAS Params
CAS_SERVER_URL = config(
    "CAS_SERVER_URL",
    default="https://authentification.din.developpement-durable.gouv.fr/cas/public",
    cast=str,
)
CAS_LOGOUT_COMPLETELY = True
CAS_REDIRECT_URL = "/"
CAS_VERSION = "2"
CAS_LOGIN_MSG = None
CAS_ROOT_PROXIED_AS = config("CAS_ROOT_PROXIED_AS", default="", cast=str)


# Internationalization
# https://docs.djangoproject.com/en/4.2/topics/i18n/

LANGUAGE_CODE = "fr-fr"
TIME_ZONE = "Europe/Paris"
USE_I18N = True
USE_TZ = True


# Static files (CSS, JavaScript, Images)
# https://docs.djangoproject.com/en/4.2/howto/static-files/

STATIC_URL = "static/"
if DEBUG:
    STATICFILES_DIRS = [os.path.join(BASE_DIR, "static")]
else:
    STATIC_ROOT = os.path.join(BASE_DIR, "static")

# Default primary key field type
# https://docs.djangoproject.com/en/4.2/ref/settings/#default-auto-field

DEFAULT_AUTO_FIELD = "django.db.models.BigAutoField"

LOGGING = {
    "version": 1,
    "disable_existing_loggers": False,
    "handlers": {"console": {"class": "logging.StreamHandler"}},
    "loggers": {
        "django": {
            "handlers": ["console"],
            "level": config("DJANGO_LOG_LEVEL", default="INFO", cast=str),
        }
    },
}

MESSAGE_STORAGE = "django.contrib.messages.storage.session.SessionStorage"

MEDIA_ROOT = os.path.join(Path(__file__).resolve().parent.parent, "media")
MEDIA_URL = "/media/"

```

</details>


---

### 📄 `palome/urls.py` [1.107 octets]
<a id="palome-urls-py"></a> [↩ Retour à l'arborescence](#tree-palome-urls-py)

> **Chemin relatif** : `palome/urls.py`  
> **Taille** : 1.107 octets  
> **Lignes** : 43  
> **Type** : python

```python
from django.urls import include, path
from django.contrib import admin
from django.conf import settings
from django.conf.urls.static import static

urlpatterns = [
    path("", include("app.urls")),
    path("admin/", admin.site.urls),
]

if settings.AUTH_MODE == "cas":
    import django_cas_ng.views

    urlpatterns += [
        path("login/", django_cas_ng.views.LoginView.as_view(), name="cas_ng_login"),
        path(
            "logout/",
            django_cas_ng.views.LogoutView.as_view(),
            name="cas_ng_logout",
        ),
    ]
else:
    from django.contrib.auth.views import LoginView, LogoutView

    urlpatterns += [
        path(
            "login/", LoginView.as_view(template_name="common/login.html"), name="login"
        ),
        path(
            "logout/",
            LogoutView.as_view(template_name="common/logout.html"),
            name="logout",
        ),
    ]

urlpatterns = urlpatterns + static(
    settings.MEDIA_URL, document_root=settings.MEDIA_ROOT
)

handler403 = "app.views.error403"
handler404 = "app.views.error404"
handler500 = "app.views.error500"

```


---

### 📄 `palome/wsgi.py` [167 octets]
<a id="palome-wsgi-py"></a> [↩ Retour à l'arborescence](#tree-palome-wsgi-py)

> **Chemin relatif** : `palome/wsgi.py`  
> **Taille** : 167 octets  
> **Lignes** : 8  
> **Type** : python

```python
import os

from django.core.wsgi import get_wsgi_application

os.environ.setdefault("DJANGO_SETTINGS_MODULE", "palome.settings")

application = get_wsgi_application()

```


---

### 📄 `poetry.lock` [70.520 octets]
<a id="poetry-lock"></a> [↩ Retour à l'arborescence](#tree-poetry-lock)

> **Chemin relatif** : `poetry.lock`  
> **Taille** : 70.520 octets  
> **Lignes** : 826  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (826 lignes) - Cliquer pour déplier</summary>

````text
# This file is automatically @generated by Poetry 1.4.2 and should not be changed by hand.

[[package]]
name = "asgiref"
version = "3.8.1"
description = "ASGI specs, helper code, and adapters"
category = "main"
optional = false
python-versions = ">=3.8"
files = [
    {file = "asgiref-3.8.1-py3-none-any.whl", hash = "sha256:3e1e3ecc849832fe52ccf2cb6686b7a55f82bb1d6aee72a58826471390335e47"},
    {file = "asgiref-3.8.1.tar.gz", hash = "sha256:c343bd80a0bec947a9860adb4c432ffa7db769836c64238fc34bdc3fec84d590"},
]

[package.dependencies]
typing-extensions = {version = ">=4", markers = "python_version < \"3.11\""}

[package.extras]
tests = ["mypy (>=0.800)", "pytest", "pytest-asyncio"]

[[package]]
name = "black"
version = "23.12.1"
description = "The uncompromising code formatter."
category = "dev"
optional = false
python-versions = ">=3.8"
files = [
    {file = "black-23.12.1-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:e0aaf6041986767a5e0ce663c7a2f0e9eaf21e6ff87a5f95cbf3675bfd4c41d2"},
    {file = "black-23.12.1-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:c88b3711d12905b74206227109272673edce0cb29f27e1385f33b0163c414bba"},
    {file = "black-23.12.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:a920b569dc6b3472513ba6ddea21f440d4b4c699494d2e972a1753cdc25df7b0"},
    {file = "black-23.12.1-cp310-cp310-win_amd64.whl", hash = "sha256:3fa4be75ef2a6b96ea8d92b1587dd8cb3a35c7e3d51f0738ced0781c3aa3a5a3"},
    {file = "black-23.12.1-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:8d4df77958a622f9b5a4c96edb4b8c0034f8434032ab11077ec6c56ae9f384ba"},
    {file = "black-23.12.1-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:602cfb1196dc692424c70b6507593a2b29aac0547c1be9a1d1365f0d964c353b"},
    {file = "black-23.12.1-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:9c4352800f14be5b4864016882cdba10755bd50805c95f728011bcb47a4afd59"},
    {file = "black-23.12.1-cp311-cp311-win_amd64.whl", hash = "sha256:0808494f2b2df923ffc5723ed3c7b096bd76341f6213989759287611e9837d50"},
    {file = "black-23.12.1-cp312-cp312-macosx_10_9_x86_64.whl", hash = "sha256:25e57fd232a6d6ff3f4478a6fd0580838e47c93c83eaf1ccc92d4faf27112c4e"},
    {file = "black-23.12.1-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:2d9e13db441c509a3763a7a3d9a49ccc1b4e974a47be4e08ade2a228876500ec"},
    {file = "black-23.12.1-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:6d1bd9c210f8b109b1762ec9fd36592fdd528485aadb3f5849b2740ef17e674e"},
    {file = "black-23.12.1-cp312-cp312-win_amd64.whl", hash = "sha256:ae76c22bde5cbb6bfd211ec343ded2163bba7883c7bc77f6b756a1049436fbb9"},
    {file = "black-23.12.1-cp38-cp38-macosx_10_9_x86_64.whl", hash = "sha256:1fa88a0f74e50e4487477bc0bb900c6781dbddfdfa32691e780bf854c3b4a47f"},
    {file = "black-23.12.1-cp38-cp38-macosx_11_0_arm64.whl", hash = "sha256:a4d6a9668e45ad99d2f8ec70d5c8c04ef4f32f648ef39048d010b0689832ec6d"},
    {file = "black-23.12.1-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:b18fb2ae6c4bb63eebe5be6bd869ba2f14fd0259bda7d18a46b764d8fb86298a"},
    {file = "black-23.12.1-cp38-cp38-win_amd64.whl", hash = "sha256:c04b6d9d20e9c13f43eee8ea87d44156b8505ca8a3c878773f68b4e4812a421e"},
    {file = "black-23.12.1-cp39-cp39-macosx_10_9_x86_64.whl", hash = "sha256:3e1b38b3135fd4c025c28c55ddfc236b05af657828a8a6abe5deec419a0b7055"},
    {file = "black-23.12.1-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:4f0031eaa7b921db76decd73636ef3a12c942ed367d8c3841a0739412b260a54"},
    {file = "black-23.12.1-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:97e56155c6b737854e60a9ab1c598ff2533d57e7506d97af5481141671abf3ea"},
    {file = "black-23.12.1-cp39-cp39-win_amd64.whl", hash = "sha256:dd15245c8b68fe2b6bd0f32c1556509d11bb33aec9b5d0866dd8e2ed3dba09c2"},
    {file = "black-23.12.1-py3-none-any.whl", hash = "sha256:78baad24af0f033958cad29731e27363183e140962595def56423e626f4bee3e"},
    {file = "black-23.12.1.tar.gz", hash = "sha256:4ce3ef14ebe8d9509188014d96af1c456a910d5b5cbf434a09fef7e024b3d0d5"},
]

[package.dependencies]
click = ">=8.0.0"
mypy-extensions = ">=0.4.3"
packaging = ">=22.0"
pathspec = ">=0.9.0"
platformdirs = ">=2"
tomli = {version = ">=1.1.0", markers = "python_version < \"3.11\""}
typing-extensions = {version = ">=4.0.1", markers = "python_version < \"3.11\""}

[package.extras]
colorama = ["colorama (>=0.4.3)"]
d = ["aiohttp (>=3.7.4)", "aiohttp (>=3.7.4,!=3.9.0)"]
jupyter = ["ipython (>=7.8.0)", "tokenize-rt (>=3.2.0)"]
uvloop = ["uvloop (>=0.15.2)"]

[[package]]
name = "certifi"
version = "2024.7.4"
description = "Python package for providing Mozilla's CA Bundle."
category = "main"
optional = false
python-versions = ">=3.6"
files = [
    {file = "certifi-2024.7.4-py3-none-any.whl", hash = "sha256:c198e21b1289c2ab85ee4e67bb4b4ef3ead0892059901a8d5b622f24a1101e90"},
    {file = "certifi-2024.7.4.tar.gz", hash = "sha256:5a1e7645bc0ec61a09e26c36f6106dd4cf40c6db3a1fb6352b0244e7fb057c7b"},
]

[[package]]
name = "charset-normalizer"
version = "3.3.2"
description = "The Real First Universal Charset Detector. Open, modern and actively maintained alternative to Chardet."
category = "main"
optional = false
python-versions = ">=3.7.0"
files = [
    {file = "charset-normalizer-3.3.2.tar.gz", hash = "sha256:f30c3cb33b24454a82faecaf01b19c18562b1e89558fb6c56de4d9118a032fd5"},
    {file = "charset_normalizer-3.3.2-cp310-cp310-macosx_10_9_universal2.whl", hash = "sha256:25baf083bf6f6b341f4121c2f3c548875ee6f5339300e08be3f2b2ba1721cdd3"},
    {file = "charset_normalizer-3.3.2-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:06435b539f889b1f6f4ac1758871aae42dc3a8c0e24ac9e60c2384973ad73027"},
    {file = "charset_normalizer-3.3.2-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:9063e24fdb1e498ab71cb7419e24622516c4a04476b17a2dab57e8baa30d6e03"},
    {file = "charset_normalizer-3.3.2-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:6897af51655e3691ff853668779c7bad41579facacf5fd7253b0133308cf000d"},
    {file = "charset_normalizer-3.3.2-cp310-cp310-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:1d3193f4a680c64b4b6a9115943538edb896edc190f0b222e73761716519268e"},
    {file = "charset_normalizer-3.3.2-cp310-cp310-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:cd70574b12bb8a4d2aaa0094515df2463cb429d8536cfb6c7ce983246983e5a6"},
    {file = "charset_normalizer-3.3.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:8465322196c8b4d7ab6d1e049e4c5cb460d0394da4a27d23cc242fbf0034b6b5"},
    {file = "charset_normalizer-3.3.2-cp310-cp310-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:a9a8e9031d613fd2009c182b69c7b2c1ef8239a0efb1df3f7c8da66d5dd3d537"},
    {file = "charset_normalizer-3.3.2-cp310-cp310-musllinux_1_1_aarch64.whl", hash = "sha256:beb58fe5cdb101e3a055192ac291b7a21e3b7ef4f67fa1d74e331a7f2124341c"},
    {file = "charset_normalizer-3.3.2-cp310-cp310-musllinux_1_1_i686.whl", hash = "sha256:e06ed3eb3218bc64786f7db41917d4e686cc4856944f53d5bdf83a6884432e12"},
    {file = "charset_normalizer-3.3.2-cp310-cp310-musllinux_1_1_ppc64le.whl", hash = "sha256:2e81c7b9c8979ce92ed306c249d46894776a909505d8f5a4ba55b14206e3222f"},
    {file = "charset_normalizer-3.3.2-cp310-cp310-musllinux_1_1_s390x.whl", hash = "sha256:572c3763a264ba47b3cf708a44ce965d98555f618ca42c926a9c1616d8f34269"},
    {file = "charset_normalizer-3.3.2-cp310-cp310-musllinux_1_1_x86_64.whl", hash = "sha256:fd1abc0d89e30cc4e02e4064dc67fcc51bd941eb395c502aac3ec19fab46b519"},
    {file = "charset_normalizer-3.3.2-cp310-cp310-win32.whl", hash = "sha256:3d47fa203a7bd9c5b6cee4736ee84ca03b8ef23193c0d1ca99b5089f72645c73"},
    {file = "charset_normalizer-3.3.2-cp310-cp310-win_amd64.whl", hash = "sha256:10955842570876604d404661fbccbc9c7e684caf432c09c715ec38fbae45ae09"},
    {file = "charset_normalizer-3.3.2-cp311-cp311-macosx_10_9_universal2.whl", hash = "sha256:802fe99cca7457642125a8a88a084cef28ff0cf9407060f7b93dca5aa25480db"},
    {file = "charset_normalizer-3.3.2-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:573f6eac48f4769d667c4442081b1794f52919e7edada77495aaed9236d13a96"},
    {file = "charset_normalizer-3.3.2-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:549a3a73da901d5bc3ce8d24e0600d1fa85524c10287f6004fbab87672bf3e1e"},
    {file = "charset_normalizer-3.3.2-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:f27273b60488abe721a075bcca6d7f3964f9f6f067c8c4c605743023d7d3944f"},
    {file = "charset_normalizer-3.3.2-cp311-cp311-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:1ceae2f17a9c33cb48e3263960dc5fc8005351ee19db217e9b1bb15d28c02574"},
    {file = "charset_normalizer-3.3.2-cp311-cp311-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:65f6f63034100ead094b8744b3b97965785388f308a64cf8d7c34f2f2e5be0c4"},
    {file = "charset_normalizer-3.3.2-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:753f10e867343b4511128c6ed8c82f7bec3bd026875576dfd88483c5c73b2fd8"},
    {file = "charset_normalizer-3.3.2-cp311-cp311-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:4a78b2b446bd7c934f5dcedc588903fb2f5eec172f3d29e52a9096a43722adfc"},
    {file = "charset_normalizer-3.3.2-cp311-cp311-musllinux_1_1_aarch64.whl", hash = "sha256:e537484df0d8f426ce2afb2d0f8e1c3d0b114b83f8850e5f2fbea0e797bd82ae"},
    {file = "charset_normalizer-3.3.2-cp311-cp311-musllinux_1_1_i686.whl", hash = "sha256:eb6904c354526e758fda7167b33005998fb68c46fbc10e013ca97f21ca5c8887"},
    {file = "charset_normalizer-3.3.2-cp311-cp311-musllinux_1_1_ppc64le.whl", hash = "sha256:deb6be0ac38ece9ba87dea880e438f25ca3eddfac8b002a2ec3d9183a454e8ae"},
    {file = "charset_normalizer-3.3.2-cp311-cp311-musllinux_1_1_s390x.whl", hash = "sha256:4ab2fe47fae9e0f9dee8c04187ce5d09f48eabe611be8259444906793ab7cbce"},
    {file = "charset_normalizer-3.3.2-cp311-cp311-musllinux_1_1_x86_64.whl", hash = "sha256:80402cd6ee291dcb72644d6eac93785fe2c8b9cb30893c1af5b8fdd753b9d40f"},
    {file = "charset_normalizer-3.3.2-cp311-cp311-win32.whl", hash = "sha256:7cd13a2e3ddeed6913a65e66e94b51d80a041145a026c27e6bb76c31a853c6ab"},
    {file = "charset_normalizer-3.3.2-cp311-cp311-win_amd64.whl", hash = "sha256:663946639d296df6a2bb2aa51b60a2454ca1cb29835324c640dafb5ff2131a77"},
    {file = "charset_normalizer-3.3.2-cp312-cp312-macosx_10_9_universal2.whl", hash = "sha256:0b2b64d2bb6d3fb9112bafa732def486049e63de9618b5843bcdd081d8144cd8"},
    {file = "charset_normalizer-3.3.2-cp312-cp312-macosx_10_9_x86_64.whl", hash = "sha256:ddbb2551d7e0102e7252db79ba445cdab71b26640817ab1e3e3648dad515003b"},
    {file = "charset_normalizer-3.3.2-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:55086ee1064215781fff39a1af09518bc9255b50d6333f2e4c74ca09fac6a8f6"},
    {file = "charset_normalizer-3.3.2-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:8f4a014bc36d3c57402e2977dada34f9c12300af536839dc38c0beab8878f38a"},
    {file = "charset_normalizer-3.3.2-cp312-cp312-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:a10af20b82360ab00827f916a6058451b723b4e65030c5a18577c8b2de5b3389"},
    {file = "charset_normalizer-3.3.2-cp312-cp312-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:8d756e44e94489e49571086ef83b2bb8ce311e730092d2c34ca8f7d925cb20aa"},
    {file = "charset_normalizer-3.3.2-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:90d558489962fd4918143277a773316e56c72da56ec7aa3dc3dbbe20fdfed15b"},
    {file = "charset_normalizer-3.3.2-cp312-cp312-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:6ac7ffc7ad6d040517be39eb591cac5ff87416c2537df6ba3cba3bae290c0fed"},
    {file = "charset_normalizer-3.3.2-cp312-cp312-musllinux_1_1_aarch64.whl", hash = "sha256:7ed9e526742851e8d5cc9e6cf41427dfc6068d4f5a3bb03659444b4cabf6bc26"},
    {file = "charset_normalizer-3.3.2-cp312-cp312-musllinux_1_1_i686.whl", hash = "sha256:8bdb58ff7ba23002a4c5808d608e4e6c687175724f54a5dade5fa8c67b604e4d"},
    {file = "charset_normalizer-3.3.2-cp312-cp312-musllinux_1_1_ppc64le.whl", hash = "sha256:6b3251890fff30ee142c44144871185dbe13b11bab478a88887a639655be1068"},
    {file = "charset_normalizer-3.3.2-cp312-cp312-musllinux_1_1_s390x.whl", hash = "sha256:b4a23f61ce87adf89be746c8a8974fe1c823c891d8f86eb218bb957c924bb143"},
    {file = "charset_normalizer-3.3.2-cp312-cp312-musllinux_1_1_x86_64.whl", hash = "sha256:efcb3f6676480691518c177e3b465bcddf57cea040302f9f4e6e191af91174d4"},
    {file = "charset_normalizer-3.3.2-cp312-cp312-win32.whl", hash = "sha256:d965bba47ddeec8cd560687584e88cf699fd28f192ceb452d1d7ee807c5597b7"},
    {file = "charset_normalizer-3.3.2-cp312-cp312-win_amd64.whl", hash = "sha256:96b02a3dc4381e5494fad39be677abcb5e6634bf7b4fa83a6dd3112607547001"},
    {file = "charset_normalizer-3.3.2-cp37-cp37m-macosx_10_9_x86_64.whl", hash = "sha256:95f2a5796329323b8f0512e09dbb7a1860c46a39da62ecb2324f116fa8fdc85c"},
    {file = "charset_normalizer-3.3.2-cp37-cp37m-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:c002b4ffc0be611f0d9da932eb0f704fe2602a9a949d1f738e4c34c75b0863d5"},
    {file = "charset_normalizer-3.3.2-cp37-cp37m-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:a981a536974bbc7a512cf44ed14938cf01030a99e9b3a06dd59578882f06f985"},
    {file = "charset_normalizer-3.3.2-cp37-cp37m-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:3287761bc4ee9e33561a7e058c72ac0938c4f57fe49a09eae428fd88aafe7bb6"},
    {file = "charset_normalizer-3.3.2-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:42cb296636fcc8b0644486d15c12376cb9fa75443e00fb25de0b8602e64c1714"},
    {file = "charset_normalizer-3.3.2-cp37-cp37m-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:0a55554a2fa0d408816b3b5cedf0045f4b8e1a6065aec45849de2d6f3f8e9786"},
    {file = "charset_normalizer-3.3.2-cp37-cp37m-musllinux_1_1_aarch64.whl", hash = "sha256:c083af607d2515612056a31f0a8d9e0fcb5876b7bfc0abad3ecd275bc4ebc2d5"},
    {file = "charset_normalizer-3.3.2-cp37-cp37m-musllinux_1_1_i686.whl", hash = "sha256:87d1351268731db79e0f8e745d92493ee2841c974128ef629dc518b937d9194c"},
    {file = "charset_normalizer-3.3.2-cp37-cp37m-musllinux_1_1_ppc64le.whl", hash = "sha256:bd8f7df7d12c2db9fab40bdd87a7c09b1530128315d047a086fa3ae3435cb3a8"},
    {file = "charset_normalizer-3.3.2-cp37-cp37m-musllinux_1_1_s390x.whl", hash = "sha256:c180f51afb394e165eafe4ac2936a14bee3eb10debc9d9e4db8958fe36afe711"},
    {file = "charset_normalizer-3.3.2-cp37-cp37m-musllinux_1_1_x86_64.whl", hash = "sha256:8c622a5fe39a48f78944a87d4fb8a53ee07344641b0562c540d840748571b811"},
    {file = "charset_normalizer-3.3.2-cp37-cp37m-win32.whl", hash = "sha256:db364eca23f876da6f9e16c9da0df51aa4f104a972735574842618b8c6d999d4"},
    {file = "charset_normalizer-3.3.2-cp37-cp37m-win_amd64.whl", hash = "sha256:86216b5cee4b06df986d214f664305142d9c76df9b6512be2738aa72a2048f99"},
    {file = "charset_normalizer-3.3.2-cp38-cp38-macosx_10_9_universal2.whl", hash = "sha256:6463effa3186ea09411d50efc7d85360b38d5f09b870c48e4600f63af490e56a"},
    {file = "charset_normalizer-3.3.2-cp38-cp38-macosx_10_9_x86_64.whl", hash = "sha256:6c4caeef8fa63d06bd437cd4bdcf3ffefe6738fb1b25951440d80dc7df8c03ac"},
    {file = "charset_normalizer-3.3.2-cp38-cp38-macosx_11_0_arm64.whl", hash = "sha256:37e55c8e51c236f95b033f6fb391d7d7970ba5fe7ff453dad675e88cf303377a"},
    {file = "charset_normalizer-3.3.2-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:fb69256e180cb6c8a894fee62b3afebae785babc1ee98b81cdf68bbca1987f33"},
    {file = "charset_normalizer-3.3.2-cp38-cp38-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:ae5f4161f18c61806f411a13b0310bea87f987c7d2ecdbdaad0e94eb2e404238"},
    {file = "charset_normalizer-3.3.2-cp38-cp38-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:b2b0a0c0517616b6869869f8c581d4eb2dd83a4d79e0ebcb7d373ef9956aeb0a"},
    {file = "charset_normalizer-3.3.2-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:45485e01ff4d3630ec0d9617310448a8702f70e9c01906b0d0118bdf9d124cf2"},
    {file = "charset_normalizer-3.3.2-cp38-cp38-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:eb00ed941194665c332bf8e078baf037d6c35d7c4f3102ea2d4f16ca94a26dc8"},
    {file = "charset_normalizer-3.3.2-cp38-cp38-musllinux_1_1_aarch64.whl", hash = "sha256:2127566c664442652f024c837091890cb1942c30937add288223dc895793f898"},
    {file = "charset_normalizer-3.3.2-cp38-cp38-musllinux_1_1_i686.whl", hash = "sha256:a50aebfa173e157099939b17f18600f72f84eed3049e743b68ad15bd69b6bf99"},
    {file = "charset_normalizer-3.3.2-cp38-cp38-musllinux_1_1_ppc64le.whl", hash = "sha256:4d0d1650369165a14e14e1e47b372cfcb31d6ab44e6e33cb2d4e57265290044d"},
    {file = "charset_normalizer-3.3.2-cp38-cp38-musllinux_1_1_s390x.whl", hash = "sha256:923c0c831b7cfcb071580d3f46c4baf50f174be571576556269530f4bbd79d04"},
    {file = "charset_normalizer-3.3.2-cp38-cp38-musllinux_1_1_x86_64.whl", hash = "sha256:06a81e93cd441c56a9b65d8e1d043daeb97a3d0856d177d5c90ba85acb3db087"},
    {file = "charset_normalizer-3.3.2-cp38-cp38-win32.whl", hash = "sha256:6ef1d82a3af9d3eecdba2321dc1b3c238245d890843e040e41e470ffa64c3e25"},
    {file = "charset_normalizer-3.3.2-cp38-cp38-win_amd64.whl", hash = "sha256:eb8821e09e916165e160797a6c17edda0679379a4be5c716c260e836e122f54b"},
    {file = "charset_normalizer-3.3.2-cp39-cp39-macosx_10_9_universal2.whl", hash = "sha256:c235ebd9baae02f1b77bcea61bce332cb4331dc3617d254df3323aa01ab47bd4"},
    {file = "charset_normalizer-3.3.2-cp39-cp39-macosx_10_9_x86_64.whl", hash = "sha256:5b4c145409bef602a690e7cfad0a15a55c13320ff7a3ad7ca59c13bb8ba4d45d"},
    {file = "charset_normalizer-3.3.2-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:68d1f8a9e9e37c1223b656399be5d6b448dea850bed7d0f87a8311f1ff3dabb0"},
    {file = "charset_normalizer-3.3.2-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:22afcb9f253dac0696b5a4be4a1c0f8762f8239e21b99680099abd9b2b1b2269"},
    {file = "charset_normalizer-3.3.2-cp39-cp39-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:e27ad930a842b4c5eb8ac0016b0a54f5aebbe679340c26101df33424142c143c"},
    {file = "charset_normalizer-3.3.2-cp39-cp39-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:1f79682fbe303db92bc2b1136016a38a42e835d932bab5b3b1bfcfbf0640e519"},
    {file = "charset_normalizer-3.3.2-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:b261ccdec7821281dade748d088bb6e9b69e6d15b30652b74cbbac25e280b796"},
    {file = "charset_normalizer-3.3.2-cp39-cp39-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:122c7fa62b130ed55f8f285bfd56d5f4b4a5b503609d181f9ad85e55c89f4185"},
    {file = "charset_normalizer-3.3.2-cp39-cp39-musllinux_1_1_aarch64.whl", hash = "sha256:d0eccceffcb53201b5bfebb52600a5fb483a20b61da9dbc885f8b103cbe7598c"},
    {file = "charset_normalizer-3.3.2-cp39-cp39-musllinux_1_1_i686.whl", hash = "sha256:9f96df6923e21816da7e0ad3fd47dd8f94b2a5ce594e00677c0013018b813458"},
    {file = "charset_normalizer-3.3.2-cp39-cp39-musllinux_1_1_ppc64le.whl", hash = "sha256:7f04c839ed0b6b98b1a7501a002144b76c18fb1c1850c8b98d458ac269e26ed2"},
    {file = "charset_normalizer-3.3.2-cp39-cp39-musllinux_1_1_s390x.whl", hash = "sha256:34d1c8da1e78d2e001f363791c98a272bb734000fcef47a491c1e3b0505657a8"},
    {file = "charset_normalizer-3.3.2-cp39-cp39-musllinux_1_1_x86_64.whl", hash = "sha256:ff8fa367d09b717b2a17a052544193ad76cd49979c805768879cb63d9ca50561"},
    {file = "charset_normalizer-3.3.2-cp39-cp39-win32.whl", hash = "sha256:aed38f6e4fb3f5d6bf81bfa990a07806be9d83cf7bacef998ab1a9bd660a581f"},
    {file = "charset_normalizer-3.3.2-cp39-cp39-win_amd64.whl", hash = "sha256:b01b88d45a6fcb69667cd6d2f7a9aeb4bf53760d7fc536bf679ec94fe9f3ff3d"},
    {file = "charset_normalizer-3.3.2-py3-none-any.whl", hash = "sha256:3e4d1f6587322d2788836a99c69062fbb091331ec940e02d12d179c1d53e25fc"},
]

[[package]]
name = "click"
version = "8.1.7"
description = "Composable command line interface toolkit"
category = "dev"
optional = false
python-versions = ">=3.7"
files = [
    {file = "click-8.1.7-py3-none-any.whl", hash = "sha256:ae74fb96c20a0277a1d615f1e4d73c8414f5a98db8b799a7931d1582f3390c28"},
    {file = "click-8.1.7.tar.gz", hash = "sha256:ca9853ad459e787e2192211578cc907e7594e294c7ccc834310722b41b9ca6de"},
]

[package.dependencies]
colorama = {version = "*", markers = "platform_system == \"Windows\""}

[[package]]
name = "colorama"
version = "0.4.6"
description = "Cross-platform colored terminal text."
category = "dev"
optional = false
python-versions = "!=3.0.*,!=3.1.*,!=3.2.*,!=3.3.*,!=3.4.*,!=3.5.*,!=3.6.*,>=2.7"
files = [
    {file = "colorama-0.4.6-py2.py3-none-any.whl", hash = "sha256:4f1d9991f5acc0ca119f9d443620b77f9d6b33703e51011c16baf57afb285fc6"},
    {file = "colorama-0.4.6.tar.gz", hash = "sha256:08695f5cb7ed6e0531a20572697297273c47b8cae5a63ffc6d6ed5c201be6e44"},
]

[[package]]
name = "django"
version = "4.2.14"
description = "A high-level Python web framework that encourages rapid development and clean, pragmatic design."
category = "main"
optional = false
python-versions = ">=3.8"
files = [
    {file = "Django-4.2.14-py3-none-any.whl", hash = "sha256:3ec32bc2c616ab02834b9cac93143a7dc1cdcd5b822d78ac95fc20a38c534240"},
    {file = "Django-4.2.14.tar.gz", hash = "sha256:fc6919875a6226c7ffcae1a7d51e0f2ceaf6f160393180818f6c95f51b1e7b96"},
]

[package.dependencies]
asgiref = ">=3.6.0,<4"
sqlparse = ">=0.3.1"
tzdata = {version = "*", markers = "sys_platform == \"win32\""}

[package.extras]
argon2 = ["argon2-cffi (>=19.1.0)"]
bcrypt = ["bcrypt"]

[[package]]
name = "django-cas-ng"
version = "5.0.1"
description = "Django CAS 1.0/2.0/3.0 client authentication library, support Django 2.2, 3.0, 3.1, 3.2, 4.0 and Python 3.7+"
category = "main"
optional = false
python-versions = ">=3.7"
files = [
    {file = "django-cas-ng-5.0.1.tar.gz", hash = "sha256:e02ba35cc289e3478ca43185383ba24e4f690a41110927e87e92ac6675248541"},
    {file = "django_cas_ng-5.0.1-py2.py3-none-any.whl", hash = "sha256:76f400c1efc75511fbc8566cb376ece7178a922187c8e01bede257f5b405892a"},
]

[package.dependencies]
Django = ">=2.2"
python-cas = ">=1.6.0"

[[package]]
name = "django-cron"
version = "0.6.0"
description = "Running python crons in a Django project"
category = "main"
optional = false
python-versions = "*"
files = [
    {file = "django-cron-0.6.0.tar.gz", hash = "sha256:dc3c0d3433a2e4e7012f77f6d8415ad90367ba068649db2674325bc36f935841"},
    {file = "django_cron-0.6.0-py3-none-any.whl", hash = "sha256:016203554748512b7f19d7363b4fde8741c6ff63fe8a15051f3031f4a0506a41"},
]

[package.dependencies]
Django = ">=3.2"

[[package]]
name = "django-model-utils"
version = "4.5.1"
description = "Django model mixins and utilities"
category = "main"
optional = false
python-versions = ">=3.8"
files = [
    {file = "django_model_utils-4.5.1-py3-none-any.whl", hash = "sha256:f1141fc71796242edeffed5ad53a8cc57f00d345eb5a3a63e3f69401cd562ee2"},
    {file = "django_model_utils-4.5.1.tar.gz", hash = "sha256:1220f22d9a467d53a1e0f4cda4857df0b2f757edf9a29955c42461988caa648a"},
]

[package.dependencies]
Django = ">=3.2"

[[package]]
name = "flake8"
version = "6.1.0"
description = "the modular source code checker: pep8 pyflakes and co"
category = "dev"
optional = false
python-versions = ">=3.8.1"
files = [
    {file = "flake8-6.1.0-py2.py3-none-any.whl", hash = "sha256:ffdfce58ea94c6580c77888a86506937f9a1a227dfcd15f245d694ae20a6b6e5"},
    {file = "flake8-6.1.0.tar.gz", hash = "sha256:d5b3857f07c030bdb5bf41c7f53799571d75c4491748a3adcd47de929e34cd23"},
]

[package.dependencies]
mccabe = ">=0.7.0,<0.8.0"
pycodestyle = ">=2.11.0,<2.12.0"
pyflakes = ">=3.1.0,<3.2.0"

[[package]]
name = "idna"
version = "3.7"
description = "Internationalized Domain Names in Applications (IDNA)"
category = "main"
optional = false
python-versions = ">=3.5"
files = [
    {file = "idna-3.7-py3-none-any.whl", hash = "sha256:82fee1fc78add43492d3a1898bfa6d8a904cc97d8427f683ed8e798d07761aa0"},
    {file = "idna-3.7.tar.gz", hash = "sha256:028ff3aadf0609c1fd278d8ea3089299412a7a8b9bd005dd08b9f8285bcb5cfc"},
]

[[package]]
name = "lxml"
version = "5.2.2"
description = "Powerful and Pythonic XML processing library combining libxml2/libxslt with the ElementTree API."
category = "main"
optional = false
python-versions = ">=3.6"
files = [
    {file = "lxml-5.2.2-cp310-cp310-macosx_10_9_universal2.whl", hash = "sha256:364d03207f3e603922d0d3932ef363d55bbf48e3647395765f9bfcbdf6d23632"},
    {file = "lxml-5.2.2-cp310-cp310-macosx_10_9_x86_64.whl", hash = "sha256:50127c186f191b8917ea2fb8b206fbebe87fd414a6084d15568c27d0a21d60db"},
    {file = "lxml-5.2.2-cp310-cp310-manylinux_2_12_i686.manylinux2010_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:74e4f025ef3db1c6da4460dd27c118d8cd136d0391da4e387a15e48e5c975147"},
    {file = "lxml-5.2.2-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:981a06a3076997adf7c743dcd0d7a0415582661e2517c7d961493572e909aa1d"},
    {file = "lxml-5.2.2-cp310-cp310-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:aef5474d913d3b05e613906ba4090433c515e13ea49c837aca18bde190853dff"},
    {file = "lxml-5.2.2-cp310-cp310-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:1e275ea572389e41e8b039ac076a46cb87ee6b8542df3fff26f5baab43713bca"},
    {file = "lxml-5.2.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:f5b65529bb2f21ac7861a0e94fdbf5dc0daab41497d18223b46ee8515e5ad297"},
    {file = "lxml-5.2.2-cp310-cp310-manylinux_2_28_aarch64.whl", hash = "sha256:bcc98f911f10278d1daf14b87d65325851a1d29153caaf146877ec37031d5f36"},
    {file = "lxml-5.2.2-cp310-cp310-manylinux_2_28_ppc64le.whl", hash = "sha256:b47633251727c8fe279f34025844b3b3a3e40cd1b198356d003aa146258d13a2"},
    {file = "lxml-5.2.2-cp310-cp310-manylinux_2_28_s390x.whl", hash = "sha256:fbc9d316552f9ef7bba39f4edfad4a734d3d6f93341232a9dddadec4f15d425f"},
    {file = "lxml-5.2.2-cp310-cp310-manylinux_2_28_x86_64.whl", hash = "sha256:13e69be35391ce72712184f69000cda04fc89689429179bc4c0ae5f0b7a8c21b"},
    {file = "lxml-5.2.2-cp310-cp310-musllinux_1_1_aarch64.whl", hash = "sha256:3b6a30a9ab040b3f545b697cb3adbf3696c05a3a68aad172e3fd7ca73ab3c835"},
    {file = "lxml-5.2.2-cp310-cp310-musllinux_1_1_ppc64le.whl", hash = "sha256:a233bb68625a85126ac9f1fc66d24337d6e8a0f9207b688eec2e7c880f012ec0"},
    {file = "lxml-5.2.2-cp310-cp310-musllinux_1_1_s390x.whl", hash = "sha256:dfa7c241073d8f2b8e8dbc7803c434f57dbb83ae2a3d7892dd068d99e96efe2c"},
    {file = "lxml-5.2.2-cp310-cp310-musllinux_1_1_x86_64.whl", hash = "sha256:1a7aca7964ac4bb07680d5c9d63b9d7028cace3e2d43175cb50bba8c5ad33316"},
    {file = "lxml-5.2.2-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:ae4073a60ab98529ab8a72ebf429f2a8cc612619a8c04e08bed27450d52103c0"},
    {file = "lxml-5.2.2-cp310-cp310-musllinux_1_2_ppc64le.whl", hash = "sha256:ffb2be176fed4457e445fe540617f0252a72a8bc56208fd65a690fdb1f57660b"},
    {file = "lxml-5.2.2-cp310-cp310-musllinux_1_2_s390x.whl", hash = "sha256:e290d79a4107d7d794634ce3e985b9ae4f920380a813717adf61804904dc4393"},
    {file = "lxml-5.2.2-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:96e85aa09274955bb6bd483eaf5b12abadade01010478154b0ec70284c1b1526"},
    {file = "lxml-5.2.2-cp310-cp310-win32.whl", hash = "sha256:f956196ef61369f1685d14dad80611488d8dc1ef00be57c0c5a03064005b0f30"},
    {file = "lxml-5.2.2-cp310-cp310-win_amd64.whl", hash = "sha256:875a3f90d7eb5c5d77e529080d95140eacb3c6d13ad5b616ee8095447b1d22e7"},
    {file = "lxml-5.2.2-cp311-cp311-macosx_10_9_universal2.whl", hash = "sha256:45f9494613160d0405682f9eee781c7e6d1bf45f819654eb249f8f46a2c22545"},
    {file = "lxml-5.2.2-cp311-cp311-macosx_10_9_x86_64.whl", hash = "sha256:b0b3f2df149efb242cee2ffdeb6674b7f30d23c9a7af26595099afaf46ef4e88"},
    {file = "lxml-5.2.2-cp311-cp311-manylinux_2_12_i686.manylinux2010_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:d28cb356f119a437cc58a13f8135ab8a4c8ece18159eb9194b0d269ec4e28083"},
    {file = "lxml-5.2.2-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:657a972f46bbefdbba2d4f14413c0d079f9ae243bd68193cb5061b9732fa54c1"},
    {file = "lxml-5.2.2-cp311-cp311-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:b74b9ea10063efb77a965a8d5f4182806fbf59ed068b3c3fd6f30d2ac7bee734"},
    {file = "lxml-5.2.2-cp311-cp311-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:07542787f86112d46d07d4f3c4e7c760282011b354d012dc4141cc12a68cef5f"},
    {file = "lxml-5.2.2-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:303f540ad2dddd35b92415b74b900c749ec2010e703ab3bfd6660979d01fd4ed"},
    {file = "lxml-5.2.2-cp311-cp311-manylinux_2_28_aarch64.whl", hash = "sha256:2eb2227ce1ff998faf0cd7fe85bbf086aa41dfc5af3b1d80867ecfe75fb68df3"},
    {file = "lxml-5.2.2-cp311-cp311-manylinux_2_28_ppc64le.whl", hash = "sha256:1d8a701774dfc42a2f0b8ccdfe7dbc140500d1049e0632a611985d943fcf12df"},
    {file = "lxml-5.2.2-cp311-cp311-manylinux_2_28_s390x.whl", hash = "sha256:56793b7a1a091a7c286b5f4aa1fe4ae5d1446fe742d00cdf2ffb1077865db10d"},
    {file = "lxml-5.2.2-cp311-cp311-manylinux_2_28_x86_64.whl", hash = "sha256:eb00b549b13bd6d884c863554566095bf6fa9c3cecb2e7b399c4bc7904cb33b5"},
    {file = "lxml-5.2.2-cp311-cp311-musllinux_1_1_aarch64.whl", hash = "sha256:1a2569a1f15ae6c8c64108a2cd2b4a858fc1e13d25846be0666fc144715e32ab"},
    {file = "lxml-5.2.2-cp311-cp311-musllinux_1_1_ppc64le.whl", hash = "sha256:8cf85a6e40ff1f37fe0f25719aadf443686b1ac7652593dc53c7ef9b8492b115"},
    {file = "lxml-5.2.2-cp311-cp311-musllinux_1_1_s390x.whl", hash = "sha256:d237ba6664b8e60fd90b8549a149a74fcc675272e0e95539a00522e4ca688b04"},
    {file = "lxml-5.2.2-cp311-cp311-musllinux_1_1_x86_64.whl", hash = "sha256:0b3f5016e00ae7630a4b83d0868fca1e3d494c78a75b1c7252606a3a1c5fc2ad"},
    {file = "lxml-5.2.2-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:23441e2b5339bc54dc949e9e675fa35efe858108404ef9aa92f0456929ef6fe8"},
    {file = "lxml-5.2.2-cp311-cp311-musllinux_1_2_ppc64le.whl", hash = "sha256:2fb0ba3e8566548d6c8e7dd82a8229ff47bd8fb8c2da237607ac8e5a1b8312e5"},
    {file = "lxml-5.2.2-cp311-cp311-musllinux_1_2_s390x.whl", hash = "sha256:79d1fb9252e7e2cfe4de6e9a6610c7cbb99b9708e2c3e29057f487de5a9eaefa"},
    {file = "lxml-5.2.2-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:6dcc3d17eac1df7859ae01202e9bb11ffa8c98949dcbeb1069c8b9a75917e01b"},
    {file = "lxml-5.2.2-cp311-cp311-win32.whl", hash = "sha256:4c30a2f83677876465f44c018830f608fa3c6a8a466eb223535035fbc16f3438"},
    {file = "lxml-5.2.2-cp311-cp311-win_amd64.whl", hash = "sha256:49095a38eb333aaf44c06052fd2ec3b8f23e19747ca7ec6f6c954ffea6dbf7be"},
    {file = "lxml-5.2.2-cp312-cp312-macosx_10_9_universal2.whl", hash = "sha256:7429e7faa1a60cad26ae4227f4dd0459efde239e494c7312624ce228e04f6391"},
    {file = "lxml-5.2.2-cp312-cp312-macosx_10_9_x86_64.whl", hash = "sha256:50ccb5d355961c0f12f6cf24b7187dbabd5433f29e15147a67995474f27d1776"},
    {file = "lxml-5.2.2-cp312-cp312-manylinux_2_12_i686.manylinux2010_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:dc911208b18842a3a57266d8e51fc3cfaccee90a5351b92079beed912a7914c2"},
    {file = "lxml-5.2.2-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:33ce9e786753743159799fdf8e92a5da351158c4bfb6f2db0bf31e7892a1feb5"},
    {file = "lxml-5.2.2-cp312-cp312-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:ec87c44f619380878bd49ca109669c9f221d9ae6883a5bcb3616785fa8f94c97"},
    {file = "lxml-5.2.2-cp312-cp312-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:08ea0f606808354eb8f2dfaac095963cb25d9d28e27edcc375d7b30ab01abbf6"},
    {file = "lxml-5.2.2-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:75a9632f1d4f698b2e6e2e1ada40e71f369b15d69baddb8968dcc8e683839b18"},
    {file = "lxml-5.2.2-cp312-cp312-manylinux_2_28_aarch64.whl", hash = "sha256:74da9f97daec6928567b48c90ea2c82a106b2d500f397eeb8941e47d30b1ca85"},
    {file = "lxml-5.2.2-cp312-cp312-manylinux_2_28_ppc64le.whl", hash = "sha256:0969e92af09c5687d769731e3f39ed62427cc72176cebb54b7a9d52cc4fa3b73"},
    {file = "lxml-5.2.2-cp312-cp312-manylinux_2_28_s390x.whl", hash = "sha256:9164361769b6ca7769079f4d426a41df6164879f7f3568be9086e15baca61466"},
    {file = "lxml-5.2.2-cp312-cp312-manylinux_2_28_x86_64.whl", hash = "sha256:d26a618ae1766279f2660aca0081b2220aca6bd1aa06b2cf73f07383faf48927"},
    {file = "lxml-5.2.2-cp312-cp312-musllinux_1_1_aarch64.whl", hash = "sha256:ab67ed772c584b7ef2379797bf14b82df9aa5f7438c5b9a09624dd834c1c1aaf"},
    {file = "lxml-5.2.2-cp312-cp312-musllinux_1_1_ppc64le.whl", hash = "sha256:3d1e35572a56941b32c239774d7e9ad724074d37f90c7a7d499ab98761bd80cf"},
    {file = "lxml-5.2.2-cp312-cp312-musllinux_1_1_s390x.whl", hash = "sha256:8268cbcd48c5375f46e000adb1390572c98879eb4f77910c6053d25cc3ac2c67"},
    {file = "lxml-5.2.2-cp312-cp312-musllinux_1_1_x86_64.whl", hash = "sha256:e282aedd63c639c07c3857097fc0e236f984ceb4089a8b284da1c526491e3f3d"},
    {file = "lxml-5.2.2-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:6dfdc2bfe69e9adf0df4915949c22a25b39d175d599bf98e7ddf620a13678585"},
    {file = "lxml-5.2.2-cp312-cp312-musllinux_1_2_ppc64le.whl", hash = "sha256:4aefd911793b5d2d7a921233a54c90329bf3d4a6817dc465f12ffdfe4fc7b8fe"},
    {file = "lxml-5.2.2-cp312-cp312-musllinux_1_2_s390x.whl", hash = "sha256:8b8df03a9e995b6211dafa63b32f9d405881518ff1ddd775db4e7b98fb545e1c"},
    {file = "lxml-5.2.2-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:f11ae142f3a322d44513de1018b50f474f8f736bc3cd91d969f464b5bfef8836"},
    {file = "lxml-5.2.2-cp312-cp312-win32.whl", hash = "sha256:16a8326e51fcdffc886294c1e70b11ddccec836516a343f9ed0f82aac043c24a"},
    {file = "lxml-5.2.2-cp312-cp312-win_amd64.whl", hash = "sha256:bbc4b80af581e18568ff07f6395c02114d05f4865c2812a1f02f2eaecf0bfd48"},
    {file = "lxml-5.2.2-cp36-cp36m-macosx_10_9_x86_64.whl", hash = "sha256:e3d9d13603410b72787579769469af730c38f2f25505573a5888a94b62b920f8"},
    {file = "lxml-5.2.2-cp36-cp36m-manylinux_2_12_i686.manylinux2010_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:38b67afb0a06b8575948641c1d6d68e41b83a3abeae2ca9eed2ac59892b36706"},
    {file = "lxml-5.2.2-cp36-cp36m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:c689d0d5381f56de7bd6966a4541bff6e08bf8d3871bbd89a0c6ab18aa699573"},
    {file = "lxml-5.2.2-cp36-cp36m-manylinux_2_28_x86_64.whl", hash = "sha256:cf2a978c795b54c539f47964ec05e35c05bd045db5ca1e8366988c7f2fe6b3ce"},
    {file = "lxml-5.2.2-cp36-cp36m-manylinux_2_5_x86_64.manylinux1_x86_64.whl", hash = "sha256:739e36ef7412b2bd940f75b278749106e6d025e40027c0b94a17ef7968d55d56"},
    {file = "lxml-5.2.2-cp36-cp36m-musllinux_1_1_x86_64.whl", hash = "sha256:d8bbcd21769594dbba9c37d3c819e2d5847656ca99c747ddb31ac1701d0c0ed9"},
    {file = "lxml-5.2.2-cp36-cp36m-musllinux_1_2_x86_64.whl", hash = "sha256:2304d3c93f2258ccf2cf7a6ba8c761d76ef84948d87bf9664e14d203da2cd264"},
    {file = "lxml-5.2.2-cp36-cp36m-win32.whl", hash = "sha256:02437fb7308386867c8b7b0e5bc4cd4b04548b1c5d089ffb8e7b31009b961dc3"},
    {file = "lxml-5.2.2-cp36-cp36m-win_amd64.whl", hash = "sha256:edcfa83e03370032a489430215c1e7783128808fd3e2e0a3225deee278585196"},
    {file = "lxml-5.2.2-cp37-cp37m-macosx_10_9_x86_64.whl", hash = "sha256:28bf95177400066596cdbcfc933312493799382879da504633d16cf60bba735b"},
    {file = "lxml-5.2.2-cp37-cp37m-manylinux_2_12_i686.manylinux2010_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:3a745cc98d504d5bd2c19b10c79c61c7c3df9222629f1b6210c0368177589fb8"},
    {file = "lxml-5.2.2-cp37-cp37m-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:1b590b39ef90c6b22ec0be925b211298e810b4856909c8ca60d27ffbca6c12e6"},
    {file = "lxml-5.2.2-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:b336b0416828022bfd5a2e3083e7f5ba54b96242159f83c7e3eebaec752f1716"},
    {file = "lxml-5.2.2-cp37-cp37m-manylinux_2_28_aarch64.whl", hash = "sha256:c2faf60c583af0d135e853c86ac2735ce178f0e338a3c7f9ae8f622fd2eb788c"},
    {file = "lxml-5.2.2-cp37-cp37m-manylinux_2_28_x86_64.whl", hash = "sha256:4bc6cb140a7a0ad1f7bc37e018d0ed690b7b6520ade518285dc3171f7a117905"},
    {file = "lxml-5.2.2-cp37-cp37m-musllinux_1_1_aarch64.whl", hash = "sha256:7ff762670cada8e05b32bf1e4dc50b140790909caa8303cfddc4d702b71ea184"},
    {file = "lxml-5.2.2-cp37-cp37m-musllinux_1_1_x86_64.whl", hash = "sha256:57f0a0bbc9868e10ebe874e9f129d2917750adf008fe7b9c1598c0fbbfdde6a6"},
    {file = "lxml-5.2.2-cp37-cp37m-musllinux_1_2_aarch64.whl", hash = "sha256:a6d2092797b388342c1bc932077ad232f914351932353e2e8706851c870bca1f"},
    {file = "lxml-5.2.2-cp37-cp37m-musllinux_1_2_x86_64.whl", hash = "sha256:60499fe961b21264e17a471ec296dcbf4365fbea611bf9e303ab69db7159ce61"},
    {file = "lxml-5.2.2-cp37-cp37m-win32.whl", hash = "sha256:d9b342c76003c6b9336a80efcc766748a333573abf9350f4094ee46b006ec18f"},
    {file = "lxml-5.2.2-cp37-cp37m-win_amd64.whl", hash = "sha256:b16db2770517b8799c79aa80f4053cd6f8b716f21f8aca962725a9565ce3ee40"},
    {file = "lxml-5.2.2-cp38-cp38-macosx_10_9_x86_64.whl", hash = "sha256:7ed07b3062b055d7a7f9d6557a251cc655eed0b3152b76de619516621c56f5d3"},
    {file = "lxml-5.2.2-cp38-cp38-manylinux_2_12_i686.manylinux2010_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:f60fdd125d85bf9c279ffb8e94c78c51b3b6a37711464e1f5f31078b45002421"},
    {file = "lxml-5.2.2-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:8a7e24cb69ee5f32e003f50e016d5fde438010c1022c96738b04fc2423e61706"},
    {file = "lxml-5.2.2-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:23cfafd56887eaed93d07bc4547abd5e09d837a002b791e9767765492a75883f"},
    {file = "lxml-5.2.2-cp38-cp38-manylinux_2_28_aarch64.whl", hash = "sha256:19b4e485cd07b7d83e3fe3b72132e7df70bfac22b14fe4bf7a23822c3a35bff5"},
    {file = "lxml-5.2.2-cp38-cp38-manylinux_2_28_x86_64.whl", hash = "sha256:7ce7ad8abebe737ad6143d9d3bf94b88b93365ea30a5b81f6877ec9c0dee0a48"},
    {file = "lxml-5.2.2-cp38-cp38-musllinux_1_1_aarch64.whl", hash = "sha256:e49b052b768bb74f58c7dda4e0bdf7b79d43a9204ca584ffe1fb48a6f3c84c66"},
    {file = "lxml-5.2.2-cp38-cp38-musllinux_1_1_x86_64.whl", hash = "sha256:d14a0d029a4e176795cef99c056d58067c06195e0c7e2dbb293bf95c08f772a3"},
    {file = "lxml-5.2.2-cp38-cp38-musllinux_1_2_aarch64.whl", hash = "sha256:be49ad33819d7dcc28a309b86d4ed98e1a65f3075c6acd3cd4fe32103235222b"},
    {file = "lxml-5.2.2-cp38-cp38-musllinux_1_2_x86_64.whl", hash = "sha256:a6d17e0370d2516d5bb9062c7b4cb731cff921fc875644c3d751ad857ba9c5b1"},
    {file = "lxml-5.2.2-cp38-cp38-win32.whl", hash = "sha256:5b8c041b6265e08eac8a724b74b655404070b636a8dd6d7a13c3adc07882ef30"},
    {file = "lxml-5.2.2-cp38-cp38-win_amd64.whl", hash = "sha256:f61efaf4bed1cc0860e567d2ecb2363974d414f7f1f124b1df368bbf183453a6"},
    {file = "lxml-5.2.2-cp39-cp39-macosx_10_9_universal2.whl", hash = "sha256:fb91819461b1b56d06fa4bcf86617fac795f6a99d12239fb0c68dbeba41a0a30"},
    {file = "lxml-5.2.2-cp39-cp39-macosx_10_9_x86_64.whl", hash = "sha256:d4ed0c7cbecde7194cd3228c044e86bf73e30a23505af852857c09c24e77ec5d"},
    {file = "lxml-5.2.2-cp39-cp39-manylinux_2_12_i686.manylinux2010_i686.manylinux_2_17_i686.manylinux2014_i686.whl", hash = "sha256:54401c77a63cc7d6dc4b4e173bb484f28a5607f3df71484709fe037c92d4f0ed"},
    {file = "lxml-5.2.2-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:625e3ef310e7fa3a761d48ca7ea1f9d8718a32b1542e727d584d82f4453d5eeb"},
    {file = "lxml-5.2.2-cp39-cp39-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl", hash = "sha256:519895c99c815a1a24a926d5b60627ce5ea48e9f639a5cd328bda0515ea0f10c"},
    {file = "lxml-5.2.2-cp39-cp39-manylinux_2_17_s390x.manylinux2014_s390x.whl", hash = "sha256:c7079d5eb1c1315a858bbf180000757db8ad904a89476653232db835c3114001"},
    {file = "lxml-5.2.2-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:343ab62e9ca78094f2306aefed67dcfad61c4683f87eee48ff2fd74902447726"},
    {file = "lxml-5.2.2-cp39-cp39-manylinux_2_28_aarch64.whl", hash = "sha256:cd9e78285da6c9ba2d5c769628f43ef66d96ac3085e59b10ad4f3707980710d3"},
    {file = "lxml-5.2.2-cp39-cp39-manylinux_2_28_ppc64le.whl", hash = "sha256:546cf886f6242dff9ec206331209db9c8e1643ae642dea5fdbecae2453cb50fd"},
    {file = "lxml-5.2.2-cp39-cp39-manylinux_2_28_s390x.whl", hash = "sha256:02f6a8eb6512fdc2fd4ca10a49c341c4e109aa6e9448cc4859af5b949622715a"},
    {file = "lxml-5.2.2-cp39-cp39-manylinux_2_28_x86_64.whl", hash = "sha256:339ee4a4704bc724757cd5dd9dc8cf4d00980f5d3e6e06d5847c1b594ace68ab"},
    {file = "lxml-5.2.2-cp39-cp39-musllinux_1_1_aarch64.whl", hash = "sha256:0a028b61a2e357ace98b1615fc03f76eb517cc028993964fe08ad514b1e8892d"},
    {file = "lxml-5.2.2-cp39-cp39-musllinux_1_1_ppc64le.whl", hash = "sha256:f90e552ecbad426eab352e7b2933091f2be77115bb16f09f78404861c8322981"},
    {file = "lxml-5.2.2-cp39-cp39-musllinux_1_1_s390x.whl", hash = "sha256:d83e2d94b69bf31ead2fa45f0acdef0757fa0458a129734f59f67f3d2eb7ef32"},
    {file = "lxml-5.2.2-cp39-cp39-musllinux_1_1_x86_64.whl", hash = "sha256:a02d3c48f9bb1e10c7788d92c0c7db6f2002d024ab6e74d6f45ae33e3d0288a3"},
    {file = "lxml-5.2.2-cp39-cp39-musllinux_1_2_aarch64.whl", hash = "sha256:6d68ce8e7b2075390e8ac1e1d3a99e8b6372c694bbe612632606d1d546794207"},
    {file = "lxml-5.2.2-cp39-cp39-musllinux_1_2_ppc64le.whl", hash = "sha256:453d037e09a5176d92ec0fd282e934ed26d806331a8b70ab431a81e2fbabf56d"},
    {file = "lxml-5.2.2-cp39-cp39-musllinux_1_2_s390x.whl", hash = "sha256:3b019d4ee84b683342af793b56bb35034bd749e4cbdd3d33f7d1107790f8c472"},
    {file = "lxml-5.2.2-cp39-cp39-musllinux_1_2_x86_64.whl", hash = "sha256:cb3942960f0beb9f46e2a71a3aca220d1ca32feb5a398656be934320804c0df9"},
    {file = "lxml-5.2.2-cp39-cp39-win32.whl", hash = "sha256:ac6540c9fff6e3813d29d0403ee7a81897f1d8ecc09a8ff84d2eea70ede1cdbf"},
    {file = "lxml-5.2.2-cp39-cp39-win_amd64.whl", hash = "sha256:610b5c77428a50269f38a534057444c249976433f40f53e3b47e68349cca1425"},
    {file = "lxml-5.2.2-pp310-pypy310_pp73-macosx_10_9_x86_64.whl", hash = "sha256:b537bd04d7ccd7c6350cdaaaad911f6312cbd61e6e6045542f781c7f8b2e99d2"},
    {file = "lxml-5.2.2-pp310-pypy310_pp73-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:4820c02195d6dfb7b8508ff276752f6b2ff8b64ae5d13ebe02e7667e035000b9"},
    {file = "lxml-5.2.2-pp310-pypy310_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:f2a09f6184f17a80897172863a655467da2b11151ec98ba8d7af89f17bf63dae"},
    {file = "lxml-5.2.2-pp310-pypy310_pp73-manylinux_2_28_aarch64.whl", hash = "sha256:76acba4c66c47d27c8365e7c10b3d8016a7da83d3191d053a58382311a8bf4e1"},
    {file = "lxml-5.2.2-pp310-pypy310_pp73-manylinux_2_28_x86_64.whl", hash = "sha256:b128092c927eaf485928cec0c28f6b8bead277e28acf56800e972aa2c2abd7a2"},
    {file = "lxml-5.2.2-pp310-pypy310_pp73-win_amd64.whl", hash = "sha256:ae791f6bd43305aade8c0e22f816b34f3b72b6c820477aab4d18473a37e8090b"},
    {file = "lxml-5.2.2-pp37-pypy37_pp73-macosx_10_9_x86_64.whl", hash = "sha256:a2f6a1bc2460e643785a2cde17293bd7a8f990884b822f7bca47bee0a82fc66b"},
    {file = "lxml-5.2.2-pp37-pypy37_pp73-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:8e8d351ff44c1638cb6e980623d517abd9f580d2e53bfcd18d8941c052a5a009"},
    {file = "lxml-5.2.2-pp37-pypy37_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:bec4bd9133420c5c52d562469c754f27c5c9e36ee06abc169612c959bd7dbb07"},
    {file = "lxml-5.2.2-pp37-pypy37_pp73-manylinux_2_28_aarch64.whl", hash = "sha256:55ce6b6d803890bd3cc89975fca9de1dff39729b43b73cb15ddd933b8bc20484"},
    {file = "lxml-5.2.2-pp37-pypy37_pp73-manylinux_2_28_x86_64.whl", hash = "sha256:8ab6a358d1286498d80fe67bd3d69fcbc7d1359b45b41e74c4a26964ca99c3f8"},
    {file = "lxml-5.2.2-pp37-pypy37_pp73-win_amd64.whl", hash = "sha256:06668e39e1f3c065349c51ac27ae430719d7806c026fec462e5693b08b95696b"},
    {file = "lxml-5.2.2-pp38-pypy38_pp73-macosx_10_9_x86_64.whl", hash = "sha256:9cd5323344d8ebb9fb5e96da5de5ad4ebab993bbf51674259dbe9d7a18049525"},
    {file = "lxml-5.2.2-pp38-pypy38_pp73-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:89feb82ca055af0fe797a2323ec9043b26bc371365847dbe83c7fd2e2f181c34"},
    {file = "lxml-5.2.2-pp38-pypy38_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:e481bba1e11ba585fb06db666bfc23dbe181dbafc7b25776156120bf12e0d5a6"},
    {file = "lxml-5.2.2-pp38-pypy38_pp73-manylinux_2_28_aarch64.whl", hash = "sha256:9d6c6ea6a11ca0ff9cd0390b885984ed31157c168565702959c25e2191674a14"},
    {file = "lxml-5.2.2-pp38-pypy38_pp73-manylinux_2_28_x86_64.whl", hash = "sha256:3d98de734abee23e61f6b8c2e08a88453ada7d6486dc7cdc82922a03968928db"},
    {file = "lxml-5.2.2-pp38-pypy38_pp73-win_amd64.whl", hash = "sha256:69ab77a1373f1e7563e0fb5a29a8440367dec051da6c7405333699d07444f511"},
    {file = "lxml-5.2.2-pp39-pypy39_pp73-macosx_10_9_x86_64.whl", hash = "sha256:34e17913c431f5ae01d8658dbf792fdc457073dcdfbb31dc0cc6ab256e664a8d"},
    {file = "lxml-5.2.2-pp39-pypy39_pp73-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:05f8757b03208c3f50097761be2dea0aba02e94f0dc7023ed73a7bb14ff11eb0"},
    {file = "lxml-5.2.2-pp39-pypy39_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:6a520b4f9974b0a0a6ed73c2154de57cdfd0c8800f4f15ab2b73238ffed0b36e"},
    {file = "lxml-5.2.2-pp39-pypy39_pp73-manylinux_2_28_aarch64.whl", hash = "sha256:5e097646944b66207023bc3c634827de858aebc226d5d4d6d16f0b77566ea182"},
    {file = "lxml-5.2.2-pp39-pypy39_pp73-manylinux_2_28_x86_64.whl", hash = "sha256:b5e4ef22ff25bfd4ede5f8fb30f7b24446345f3e79d9b7455aef2836437bc38a"},
    {file = "lxml-5.2.2-pp39-pypy39_pp73-win_amd64.whl", hash = "sha256:ff69a9a0b4b17d78170c73abe2ab12084bdf1691550c5629ad1fe7849433f324"},
    {file = "lxml-5.2.2.tar.gz", hash = "sha256:bb2dc4898180bea79863d5487e5f9c7c34297414bad54bcd0f0852aee9cfdb87"},
]

[package.extras]
cssselect = ["cssselect (>=0.7)"]
html-clean = ["lxml-html-clean"]
html5 = ["html5lib"]
htmlsoup = ["BeautifulSoup4"]
source = ["Cython (>=3.0.10)"]

[[package]]
name = "mccabe"
version = "0.7.0"
description = "McCabe checker, plugin for flake8"
category = "dev"
optional = false
python-versions = ">=3.6"
files = [
    {file = "mccabe-0.7.0-py2.py3-none-any.whl", hash = "sha256:6c2d30ab6be0e4a46919781807b4f0d834ebdd6c6e3dca0bda5a15f863427b6e"},
    {file = "mccabe-0.7.0.tar.gz", hash = "sha256:348e0240c33b60bbdf4e523192ef919f28cb2c3d7d5c7794f74009290f236325"},
]

[[package]]
name = "mypy-extensions"
version = "1.0.0"
description = "Type system extensions for programs checked with the mypy type checker."
category = "dev"
optional = false
python-versions = ">=3.5"
files = [
    {file = "mypy_extensions-1.0.0-py3-none-any.whl", hash = "sha256:4392f6c0eb8a5668a69e23d168ffa70f0be9ccfd32b5cc2d26a34ae5b844552d"},
    {file = "mypy_extensions-1.0.0.tar.gz", hash = "sha256:75dbf8955dc00442a438fc4d0666508a9a97b6bd41aa2f0ffe9d2f2725af0782"},
]

[[package]]
name = "packaging"
version = "24.1"
description = "Core utilities for Python packages"
category = "dev"
optional = false
python-versions = ">=3.8"
files = [
    {file = "packaging-24.1-py3-none-any.whl", hash = "sha256:5b8f2217dbdbd2f7f384c41c628544e6d52f2d0f53c6d0c3ea61aa5d1d7ff124"},
    {file = "packaging-24.1.tar.gz", hash = "sha256:026ed72c8ed3fcce5bf8950572258698927fd1dbda10a5e981cdf0ac37f4f002"},
]

[[package]]
name = "pathspec"
version = "0.12.1"
description = "Utility library for gitignore style pattern matching of file paths."
category = "dev"
optional = false
python-versions = ">=3.8"
files = [
    {file = "pathspec-0.12.1-py3-none-any.whl", hash = "sha256:a0d503e138a4c123b27490a4f7beda6a01c6f288df0e4a8b79c7eb0dc7b4cc08"},
    {file = "pathspec-0.12.1.tar.gz", hash = "sha256:a482d51503a1ab33b1c67a6c3813a26953dbdc71c31dacaef9a838c4e29f5712"},
]

[[package]]
name = "pillow"
version = "10.4.0"
description = "Python Imaging Library (Fork)"
category = "main"
optional = false
python-versions = ">=3.8"
files = [
    {file = "pillow-10.4.0-cp310-cp310-macosx_10_10_x86_64.whl", hash = "sha256:4d9667937cfa347525b319ae34375c37b9ee6b525440f3ef48542fcf66f2731e"},
    {file = "pillow-10.4.0-cp310-cp310-macosx_11_0_arm64.whl", hash = "sha256:543f3dc61c18dafb755773efc89aae60d06b6596a63914107f75459cf984164d"},
    {file = "pillow-10.4.0-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:7928ecbf1ece13956b95d9cbcfc77137652b02763ba384d9ab508099a2eca856"},
    {file = "pillow-10.4.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:e4d49b85c4348ea0b31ea63bc75a9f3857869174e2bf17e7aba02945cd218e6f"},
    {file = "pillow-10.4.0-cp310-cp310-manylinux_2_28_aarch64.whl", hash = "sha256:6c762a5b0997f5659a5ef2266abc1d8851ad7749ad9a6a5506eb23d314e4f46b"},
    {file = "pillow-10.4.0-cp310-cp310-manylinux_2_28_x86_64.whl", hash = "sha256:a985e028fc183bf12a77a8bbf36318db4238a3ded7fa9df1b9a133f1cb79f8fc"},
    {file = "pillow-10.4.0-cp310-cp310-musllinux_1_2_aarch64.whl", hash = "sha256:812f7342b0eee081eaec84d91423d1b4650bb9828eb53d8511bcef8ce5aecf1e"},
    {file = "pillow-10.4.0-cp310-cp310-musllinux_1_2_x86_64.whl", hash = "sha256:ac1452d2fbe4978c2eec89fb5a23b8387aba707ac72810d9490118817d9c0b46"},
    {file = "pillow-10.4.0-cp310-cp310-win32.whl", hash = "sha256:bcd5e41a859bf2e84fdc42f4edb7d9aba0a13d29a2abadccafad99de3feff984"},
    {file = "pillow-10.4.0-cp310-cp310-win_amd64.whl", hash = "sha256:ecd85a8d3e79cd7158dec1c9e5808e821feea088e2f69a974db5edf84dc53141"},
    {file = "pillow-10.4.0-cp310-cp310-win_arm64.whl", hash = "sha256:ff337c552345e95702c5fde3158acb0625111017d0e5f24bf3acdb9cc16b90d1"},
    {file = "pillow-10.4.0-cp311-cp311-macosx_10_10_x86_64.whl", hash = "sha256:0a9ec697746f268507404647e531e92889890a087e03681a3606d9b920fbee3c"},
    {file = "pillow-10.4.0-cp311-cp311-macosx_11_0_arm64.whl", hash = "sha256:dfe91cb65544a1321e631e696759491ae04a2ea11d36715eca01ce07284738be"},
    {file = "pillow-10.4.0-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:5dc6761a6efc781e6a1544206f22c80c3af4c8cf461206d46a1e6006e4429ff3"},
    {file = "pillow-10.4.0-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:5e84b6cc6a4a3d76c153a6b19270b3526a5a8ed6b09501d3af891daa2a9de7d6"},
    {file = "pillow-10.4.0-cp311-cp311-manylinux_2_28_aarch64.whl", hash = "sha256:bbc527b519bd3aa9d7f429d152fea69f9ad37c95f0b02aebddff592688998abe"},
    {file = "pillow-10.4.0-cp311-cp311-manylinux_2_28_x86_64.whl", hash = "sha256:76a911dfe51a36041f2e756b00f96ed84677cdeb75d25c767f296c1c1eda1319"},
    {file = "pillow-10.4.0-cp311-cp311-musllinux_1_2_aarch64.whl", hash = "sha256:59291fb29317122398786c2d44427bbd1a6d7ff54017075b22be9d21aa59bd8d"},
    {file = "pillow-10.4.0-cp311-cp311-musllinux_1_2_x86_64.whl", hash = "sha256:416d3a5d0e8cfe4f27f574362435bc9bae57f679a7158e0096ad2beb427b8696"},
    {file = "pillow-10.4.0-cp311-cp311-win32.whl", hash = "sha256:7086cc1d5eebb91ad24ded9f58bec6c688e9f0ed7eb3dbbf1e4800280a896496"},
    {file = "pillow-10.4.0-cp311-cp311-win_amd64.whl", hash = "sha256:cbed61494057c0f83b83eb3a310f0bf774b09513307c434d4366ed64f4128a91"},
    {file = "pillow-10.4.0-cp311-cp311-win_arm64.whl", hash = "sha256:f5f0c3e969c8f12dd2bb7e0b15d5c468b51e5017e01e2e867335c81903046a22"},
    {file = "pillow-10.4.0-cp312-cp312-macosx_10_10_x86_64.whl", hash = "sha256:673655af3eadf4df6b5457033f086e90299fdd7a47983a13827acf7459c15d94"},
    {file = "pillow-10.4.0-cp312-cp312-macosx_11_0_arm64.whl", hash = "sha256:866b6942a92f56300012f5fbac71f2d610312ee65e22f1aa2609e491284e5597"},
    {file = "pillow-10.4.0-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:29dbdc4207642ea6aad70fbde1a9338753d33fb23ed6956e706936706f52dd80"},
    {file = "pillow-10.4.0-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:bf2342ac639c4cf38799a44950bbc2dfcb685f052b9e262f446482afaf4bffca"},
    {file = "pillow-10.4.0-cp312-cp312-manylinux_2_28_aarch64.whl", hash = "sha256:f5b92f4d70791b4a67157321c4e8225d60b119c5cc9aee8ecf153aace4aad4ef"},
    {file = "pillow-10.4.0-cp312-cp312-manylinux_2_28_x86_64.whl", hash = "sha256:86dcb5a1eb778d8b25659d5e4341269e8590ad6b4e8b44d9f4b07f8d136c414a"},
    {file = "pillow-10.4.0-cp312-cp312-musllinux_1_2_aarch64.whl", hash = "sha256:780c072c2e11c9b2c7ca37f9a2ee8ba66f44367ac3e5c7832afcfe5104fd6d1b"},
    {file = "pillow-10.4.0-cp312-cp312-musllinux_1_2_x86_64.whl", hash = "sha256:37fb69d905be665f68f28a8bba3c6d3223c8efe1edf14cc4cfa06c241f8c81d9"},
    {file = "pillow-10.4.0-cp312-cp312-win32.whl", hash = "sha256:7dfecdbad5c301d7b5bde160150b4db4c659cee2b69589705b6f8a0c509d9f42"},
    {file = "pillow-10.4.0-cp312-cp312-win_amd64.whl", hash = "sha256:1d846aea995ad352d4bdcc847535bd56e0fd88d36829d2c90be880ef1ee4668a"},
    {file = "pillow-10.4.0-cp312-cp312-win_arm64.whl", hash = "sha256:e553cad5179a66ba15bb18b353a19020e73a7921296a7979c4a2b7f6a5cd57f9"},
    {file = "pillow-10.4.0-cp313-cp313-macosx_10_13_x86_64.whl", hash = "sha256:8bc1a764ed8c957a2e9cacf97c8b2b053b70307cf2996aafd70e91a082e70df3"},
    {file = "pillow-10.4.0-cp313-cp313-macosx_11_0_arm64.whl", hash = "sha256:6209bb41dc692ddfee4942517c19ee81b86c864b626dbfca272ec0f7cff5d9fb"},
    {file = "pillow-10.4.0-cp313-cp313-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:bee197b30783295d2eb680b311af15a20a8b24024a19c3a26431ff83eb8d1f70"},
    {file = "pillow-10.4.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:1ef61f5dd14c300786318482456481463b9d6b91ebe5ef12f405afbba77ed0be"},
    {file = "pillow-10.4.0-cp313-cp313-manylinux_2_28_aarch64.whl", hash = "sha256:297e388da6e248c98bc4a02e018966af0c5f92dfacf5a5ca22fa01cb3179bca0"},
    {file = "pillow-10.4.0-cp313-cp313-manylinux_2_28_x86_64.whl", hash = "sha256:e4db64794ccdf6cb83a59d73405f63adbe2a1887012e308828596100a0b2f6cc"},
    {file = "pillow-10.4.0-cp313-cp313-musllinux_1_2_aarch64.whl", hash = "sha256:bd2880a07482090a3bcb01f4265f1936a903d70bc740bfcb1fd4e8a2ffe5cf5a"},
    {file = "pillow-10.4.0-cp313-cp313-musllinux_1_2_x86_64.whl", hash = "sha256:4b35b21b819ac1dbd1233317adeecd63495f6babf21b7b2512d244ff6c6ce309"},
    {file = "pillow-10.4.0-cp313-cp313-win32.whl", hash = "sha256:551d3fd6e9dc15e4c1eb6fc4ba2b39c0c7933fa113b220057a34f4bb3268a060"},
    {file = "pillow-10.4.0-cp313-cp313-win_amd64.whl", hash = "sha256:030abdbe43ee02e0de642aee345efa443740aa4d828bfe8e2eb11922ea6a21ea"},
    {file = "pillow-10.4.0-cp313-cp313-win_arm64.whl", hash = "sha256:5b001114dd152cfd6b23befeb28d7aee43553e2402c9f159807bf55f33af8a8d"},
    {file = "pillow-10.4.0-cp38-cp38-macosx_10_10_x86_64.whl", hash = "sha256:8d4d5063501b6dd4024b8ac2f04962d661222d120381272deea52e3fc52d3736"},
    {file = "pillow-10.4.0-cp38-cp38-macosx_11_0_arm64.whl", hash = "sha256:7c1ee6f42250df403c5f103cbd2768a28fe1a0ea1f0f03fe151c8741e1469c8b"},
    {file = "pillow-10.4.0-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:b15e02e9bb4c21e39876698abf233c8c579127986f8207200bc8a8f6bb27acf2"},
    {file = "pillow-10.4.0-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:7a8d4bade9952ea9a77d0c3e49cbd8b2890a399422258a77f357b9cc9be8d680"},
    {file = "pillow-10.4.0-cp38-cp38-manylinux_2_28_aarch64.whl", hash = "sha256:43efea75eb06b95d1631cb784aa40156177bf9dd5b4b03ff38979e048258bc6b"},
    {file = "pillow-10.4.0-cp38-cp38-manylinux_2_28_x86_64.whl", hash = "sha256:950be4d8ba92aca4b2bb0741285a46bfae3ca699ef913ec8416c1b78eadd64cd"},
    {file = "pillow-10.4.0-cp38-cp38-musllinux_1_2_aarch64.whl", hash = "sha256:d7480af14364494365e89d6fddc510a13e5a2c3584cb19ef65415ca57252fb84"},
    {file = "pillow-10.4.0-cp38-cp38-musllinux_1_2_x86_64.whl", hash = "sha256:73664fe514b34c8f02452ffb73b7a92c6774e39a647087f83d67f010eb9a0cf0"},
    {file = "pillow-10.4.0-cp38-cp38-win32.whl", hash = "sha256:e88d5e6ad0d026fba7bdab8c3f225a69f063f116462c49892b0149e21b6c0a0e"},
    {file = "pillow-10.4.0-cp38-cp38-win_amd64.whl", hash = "sha256:5161eef006d335e46895297f642341111945e2c1c899eb406882a6c61a4357ab"},
    {file = "pillow-10.4.0-cp39-cp39-macosx_10_10_x86_64.whl", hash = "sha256:0ae24a547e8b711ccaaf99c9ae3cd975470e1a30caa80a6aaee9a2f19c05701d"},
    {file = "pillow-10.4.0-cp39-cp39-macosx_11_0_arm64.whl", hash = "sha256:298478fe4f77a4408895605f3482b6cc6222c018b2ce565c2b6b9c354ac3229b"},
    {file = "pillow-10.4.0-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:134ace6dc392116566980ee7436477d844520a26a4b1bd4053f6f47d096997fd"},
    {file = "pillow-10.4.0-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:930044bb7679ab003b14023138b50181899da3f25de50e9dbee23b61b4de2126"},
    {file = "pillow-10.4.0-cp39-cp39-manylinux_2_28_aarch64.whl", hash = "sha256:c76e5786951e72ed3686e122d14c5d7012f16c8303a674d18cdcd6d89557fc5b"},
    {file = "pillow-10.4.0-cp39-cp39-manylinux_2_28_x86_64.whl", hash = "sha256:b2724fdb354a868ddf9a880cb84d102da914e99119211ef7ecbdc613b8c96b3c"},
    {file = "pillow-10.4.0-cp39-cp39-musllinux_1_2_aarch64.whl", hash = "sha256:dbc6ae66518ab3c5847659e9988c3b60dc94ffb48ef9168656e0019a93dbf8a1"},
    {file = "pillow-10.4.0-cp39-cp39-musllinux_1_2_x86_64.whl", hash = "sha256:06b2f7898047ae93fad74467ec3d28fe84f7831370e3c258afa533f81ef7f3df"},
    {file = "pillow-10.4.0-cp39-cp39-win32.whl", hash = "sha256:7970285ab628a3779aecc35823296a7869f889b8329c16ad5a71e4901a3dc4ef"},
    {file = "pillow-10.4.0-cp39-cp39-win_amd64.whl", hash = "sha256:961a7293b2457b405967af9c77dcaa43cc1a8cd50d23c532e62d48ab6cdd56f5"},
    {file = "pillow-10.4.0-cp39-cp39-win_arm64.whl", hash = "sha256:32cda9e3d601a52baccb2856b8ea1fc213c90b340c542dcef77140dfa3278a9e"},
    {file = "pillow-10.4.0-pp310-pypy310_pp73-macosx_10_15_x86_64.whl", hash = "sha256:5b4815f2e65b30f5fbae9dfffa8636d992d49705723fe86a3661806e069352d4"},
    {file = "pillow-10.4.0-pp310-pypy310_pp73-macosx_11_0_arm64.whl", hash = "sha256:8f0aef4ef59694b12cadee839e2ba6afeab89c0f39a3adc02ed51d109117b8da"},
    {file = "pillow-10.4.0-pp310-pypy310_pp73-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:9f4727572e2918acaa9077c919cbbeb73bd2b3ebcfe033b72f858fc9fbef0026"},
    {file = "pillow-10.4.0-pp310-pypy310_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:ff25afb18123cea58a591ea0244b92eb1e61a1fd497bf6d6384f09bc3262ec3e"},
    {file = "pillow-10.4.0-pp310-pypy310_pp73-manylinux_2_28_aarch64.whl", hash = "sha256:dc3e2db6ba09ffd7d02ae9141cfa0ae23393ee7687248d46a7507b75d610f4f5"},
    {file = "pillow-10.4.0-pp310-pypy310_pp73-manylinux_2_28_x86_64.whl", hash = "sha256:02a2be69f9c9b8c1e97cf2713e789d4e398c751ecfd9967c18d0ce304efbf885"},
    {file = "pillow-10.4.0-pp310-pypy310_pp73-win_amd64.whl", hash = "sha256:0755ffd4a0c6f267cccbae2e9903d95477ca2f77c4fcf3a3a09570001856c8a5"},
    {file = "pillow-10.4.0-pp39-pypy39_pp73-macosx_10_15_x86_64.whl", hash = "sha256:a02364621fe369e06200d4a16558e056fe2805d3468350df3aef21e00d26214b"},
    {file = "pillow-10.4.0-pp39-pypy39_pp73-macosx_11_0_arm64.whl", hash = "sha256:1b5dea9831a90e9d0721ec417a80d4cbd7022093ac38a568db2dd78363b00908"},
    {file = "pillow-10.4.0-pp39-pypy39_pp73-manylinux_2_17_aarch64.manylinux2014_aarch64.whl", hash = "sha256:9b885f89040bb8c4a1573566bbb2f44f5c505ef6e74cec7ab9068c900047f04b"},
    {file = "pillow-10.4.0-pp39-pypy39_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl", hash = "sha256:87dd88ded2e6d74d31e1e0a99a726a6765cda32d00ba72dc37f0651f306daaa8"},
    {file = "pillow-10.4.0-pp39-pypy39_pp73-manylinux_2_28_aarch64.whl", hash = "sha256:2db98790afc70118bd0255c2eeb465e9767ecf1f3c25f9a1abb8ffc8cfd1fe0a"},
    {file = "pillow-10.4.0-pp39-pypy39_pp73-manylinux_2_28_x86_64.whl", hash = "sha256:f7baece4ce06bade126fb84b8af1c33439a76d8a6fd818970215e0560ca28c27"},
    {file = "pillow-10.4.0-pp39-pypy39_pp73-win_amd64.whl", hash = "sha256:cfdd747216947628af7b259d274771d84db2268ca062dd5faf373639d00113a3"},
    {file = "pillow-10.4.0.tar.gz", hash = "sha256:166c1cd4d24309b30d61f79f4a9114b7b2313d7450912277855ff5dfd7cd4a06"},
]

[package.extras]
docs = ["furo", "olefile", "sphinx (>=7.3)", "sphinx-copybutton", "sphinx-inline-tabs", "sphinxext-opengraph"]
fpx = ["olefile"]
mic = ["olefile"]
tests = ["check-manifest", "coverage", "defusedxml", "markdown2", "olefile", "packaging", "pyroma", "pytest", "pytest-cov", "pytest-timeout"]
typing = ["typing-extensions"]
xmp = ["defusedxml"]

[[package]]
name = "platformdirs"
version = "4.2.2"
description = "A small Python package for determining appropriate platform-specific dirs, e.g. a `user data dir`."
category = "dev"
optional = false
python-versions = ">=3.8"
files = [
    {file = "platformdirs-4.2.2-py3-none-any.whl", hash = "sha256:2d7a1657e36a80ea911db832a8a6ece5ee53d8de21edd5cc5879af6530b1bfee"},
    {file = "platformdirs-4.2.2.tar.gz", hash = "sha256:38b7b51f512eed9e84a22788b4bce1de17c0adb134d6becb09836e37d8654cd3"},
]

[package.extras]
docs = ["furo (>=2023.9.10)", "proselint (>=0.13)", "sphinx (>=7.2.6)", "sphinx-autodoc-typehints (>=1.25.2)"]
test = ["appdirs (==1.4.4)", "covdefaults (>=2.3)", "pytest (>=7.4.3)", "pytest-cov (>=4.1)", "pytest-mock (>=3.12)"]
type = ["mypy (>=1.8)"]

[[package]]
name = "psycopg2"
version = "2.9.9"
description = "psycopg2 - Python-PostgreSQL Database Adapter"
category = "main"
optional = false
python-versions = ">=3.7"
files = [
    {file = "psycopg2-2.9.9-cp310-cp310-win32.whl", hash = "sha256:38a8dcc6856f569068b47de286b472b7c473ac7977243593a288ebce0dc89516"},
    {file = "psycopg2-2.9.9-cp310-cp310-win_amd64.whl", hash = "sha256:426f9f29bde126913a20a96ff8ce7d73fd8a216cfb323b1f04da402d452853c3"},
    {file = "psycopg2-2.9.9-cp311-cp311-win32.whl", hash = "sha256:ade01303ccf7ae12c356a5e10911c9e1c51136003a9a1d92f7aa9d010fb98372"},
    {file = "psycopg2-2.9.9-cp311-cp311-win_amd64.whl", hash = "sha256:121081ea2e76729acfb0673ff33755e8703d45e926e416cb59bae3a86c6a4981"},
    {file = "psycopg2-2.9.9-cp312-cp312-win32.whl", hash = "sha256:d735786acc7dd25815e89cc4ad529a43af779db2e25aa7c626de864127e5a024"},
    {file = "psycopg2-2.9.9-cp312-cp312-win_amd64.whl", hash = "sha256:a7653d00b732afb6fc597e29c50ad28087dcb4fbfb28e86092277a559ae4e693"},
    {file = "psycopg2-2.9.9-cp37-cp37m-win32.whl", hash = "sha256:5e0d98cade4f0e0304d7d6f25bbfbc5bd186e07b38eac65379309c4ca3193efa"},
    {file = "psycopg2-2.9.9-cp37-cp37m-win_amd64.whl", hash = "sha256:7e2dacf8b009a1c1e843b5213a87f7c544b2b042476ed7755be813eaf4e8347a"},
    {file = "psycopg2-2.9.9-cp38-cp38-win32.whl", hash = "sha256:ff432630e510709564c01dafdbe996cb552e0b9f3f065eb89bdce5bd31fabf4c"},
    {file = "psycopg2-2.9.9-cp38-cp38-win_amd64.whl", hash = "sha256:bac58c024c9922c23550af2a581998624d6e02350f4ae9c5f0bc642c633a2d5e"},
    {file = "psycopg2-2.9.9-cp39-cp39-win32.whl", hash = "sha256:c92811b2d4c9b6ea0285942b2e7cac98a59e166d59c588fe5cfe1eda58e72d59"},
    {file = "psycopg2-2.9.9-cp39-cp39-win_amd64.whl", hash = "sha256:de80739447af31525feddeb8effd640782cf5998e1a4e9192ebdf829717e3913"},
    {file = "psycopg2-2.9.9.tar.gz", hash = "sha256:d1454bde93fb1e224166811694d600e746430c006fbb031ea06ecc2ea41bf156"},
]

[[package]]
name = "pycodestyle"
version = "2.11.1"
description = "Python style guide checker"
category = "dev"
optional = false
python-versions = ">=3.8"
files = [
    {file = "pycodestyle-2.11.1-py2.py3-none-any.whl", hash = "sha256:44fe31000b2d866f2e41841b18528a505fbd7fef9017b04eff4e2648a0fadc67"},
    {file = "pycodestyle-2.11.1.tar.gz", hash = "sha256:41ba0e7afc9752dfb53ced5489e89f8186be00e599e712660695b7a75ff2663f"},
]

[[package]]
name = "pyflakes"
version = "3.1.0"
description = "passive checker of Python programs"
category = "dev"
optional = false
python-versions = ">=3.8"
files = [
    {file = "pyflakes-3.1.0-py2.py3-none-any.whl", hash = "sha256:4132f6d49cb4dae6819e5379898f2b8cce3c5f23994194c24b77d5da2e36f774"},
    {file = "pyflakes-3.1.0.tar.gz", hash = "sha256:a0aae034c444db0071aa077972ba4768d40c830d9539fd45bf4cd3f8f6992efc"},
]

[[package]]
name = "python-cas"
version = "1.6.0"
description = "Python CAS client library"
category = "main"
optional = false
python-versions = ">=2.7, !=3.0.*, !=3.1.*, !=3.2.*, !=3.3.*, !=3.4.*"
files = [
    {file = "python-cas-1.6.0.tar.gz", hash = "sha256:b8f1dcb1b6c56b3ff4f86bbef47bcdfcf932061ccd4812ae35e3f63954dfdb28"},
    {file = "python_cas-1.6.0-py2.py3-none-any.whl", hash = "sha256:2abc0dae93c3b14097999fb7062f23cd09bc9f4e33d93f03c0cc040bd71ed50e"},
]

[package.dependencies]
lxml = ">=3.4"
requests = ">=2.11.1"
six = ">=1.10.0"

[[package]]
name = "python-decouple"
version = "3.8"
description = "Strict separation of settings from code."
category = "main"
optional = false
python-versions = "*"
files = [
    {file = "python-decouple-3.8.tar.gz", hash = "sha256:ba6e2657d4f376ecc46f77a3a615e058d93ba5e465c01bbe57289bfb7cce680f"},
    {file = "python_decouple-3.8-py3-none-any.whl", hash = "sha256:d0d45340815b25f4de59c974b855bb38d03151d81b037d9e3f463b0c9f8cbd66"},
]

[[package]]
name = "requests"
version = "2.32.3"
description = "Python HTTP for Humans."
category = "main"
optional = false
python-versions = ">=3.8"
files = [
    {file = "requests-2.32.3-py3-none-any.whl", hash = "sha256:70761cfe03c773ceb22aa2f671b4757976145175cdfca038c02654d061d6dcc6"},
    {file = "requests-2.32.3.tar.gz", hash = "sha256:55365417734eb18255590a9ff9eb97e9e1da868d4ccd6402399eaf68af20a760"},
]

[package.dependencies]
certifi = ">=2017.4.17"
charset-normalizer = ">=2,<4"
idna = ">=2.5,<4"
urllib3 = ">=1.21.1,<3"

[package.extras]
socks = ["PySocks (>=1.5.6,!=1.5.7)"]
use-chardet-on-py3 = ["chardet (>=3.0.2,<6)"]

[[package]]
name = "setuptools"
version = "69.5.1"
description = "Easily download, build, install, upgrade, and uninstall Python packages"
category = "main"
optional = false
python-versions = ">=3.8"
files = [
    {file = "setuptools-69.5.1-py3-none-any.whl", hash = "sha256:c636ac361bc47580504644275c9ad802c50415c7522212252c033bd15f301f32"},
    {file = "setuptools-69.5.1.tar.gz", hash = "sha256:6c1fccdac05a97e598fb0ae3bbed5904ccb317337a51139dcd51453611bbb987"},
]

[package.extras]
docs = ["furo", "jaraco.packaging (>=9.3)", "jaraco.tidelift (>=1.4)", "pygments-github-lexers (==0.0.5)", "rst.linker (>=1.9)", "sphinx (>=3.5)", "sphinx-favicon", "sphinx-inline-tabs", "sphinx-lint", "sphinx-notfound-page (>=1,<2)", "sphinx-reredirects", "sphinxcontrib-towncrier"]
testing = ["build[virtualenv]", "filelock (>=3.4.0)", "importlib-metadata", "ini2toml[lite] (>=0.9)", "jaraco.develop (>=7.21)", "jaraco.envs (>=2.2)", "jaraco.path (>=3.2.0)", "mypy (==1.9)", "packaging (>=23.2)", "pip (>=19.1)", "pytest (>=6,!=8.1.1)", "pytest-checkdocs (>=2.4)", "pytest-cov", "pytest-enabler (>=2.2)", "pytest-home (>=0.5)", "pytest-mypy", "pytest-perf", "pytest-ruff (>=0.2.1)", "pytest-timeout", "pytest-xdist (>=3)", "tomli", "tomli-w (>=1.0.0)", "virtualenv (>=13.0.0)", "wheel"]
testing-integration = ["build[virtualenv] (>=1.0.3)", "filelock (>=3.4.0)", "jaraco.envs (>=2.2)", "jaraco.path (>=3.2.0)", "packaging (>=23.2)", "pytest", "pytest-enabler", "pytest-xdist", "tomli", "virtualenv (>=13.0.0)", "wheel"]

[[package]]
name = "six"
version = "1.16.0"
description = "Python 2 and 3 compatibility utilities"
category = "main"
optional = false
python-versions = ">=2.7, !=3.0.*, !=3.1.*, !=3.2.*"
files = [
    {file = "six-1.16.0-py2.py3-none-any.whl", hash = "sha256:8abb2f1d86890a2dfb989f9a77cfcfd3e47c2a354b01111771326f8aa26e0254"},
    {file = "six-1.16.0.tar.gz", hash = "sha256:1e61c37477a1626458e36f7b1d82aa5c9b094fa4802892072e49de9c60c4c926"},
]

[[package]]
name = "sqlparse"
version = "0.5.0"
description = "A non-validating SQL parser."
category = "main"
optional = false
python-versions = ">=3.8"
files = [
    {file = "sqlparse-0.5.0-py3-none-any.whl", hash = "sha256:c204494cd97479d0e39f28c93d46c0b2d5959c7b9ab904762ea6c7af211c8663"},
    {file = "sqlparse-0.5.0.tar.gz", hash = "sha256:714d0a4932c059d16189f58ef5411ec2287a4360f17cdd0edd2d09d4c5087c93"},
]

[package.extras]
dev = ["build", "hatch"]
doc = ["sphinx"]

[[package]]
name = "tomli"
version = "2.0.1"
description = "A lil' TOML parser"
category = "dev"
optional = false
python-versions = ">=3.7"
files = [
    {file = "tomli-2.0.1-py3-none-any.whl", hash = "sha256:939de3e7a6161af0c887ef91b7d41a53e7c5a1ca976325f429cb46ea9bc30ecc"},
    {file = "tomli-2.0.1.tar.gz", hash = "sha256:de526c12914f0c550d15924c62d72abc48d6fe7364aa87328337a31007fe8a4f"},
]

[[package]]
name = "typing-extensions"
version = "4.12.2"
description = "Backported and Experimental Type Hints for Python 3.8+"
category = "main"
optional = false
python-versions = ">=3.8"
files = [
    {file = "typing_extensions-4.12.2-py3-none-any.whl", hash = "sha256:04e5ca0351e0f3f85c6853954072df659d0d13fac324d0072316b67d7794700d"},
    {file = "typing_extensions-4.12.2.tar.gz", hash = "sha256:1a7ead55c7e559dd4dee8856e3a88b41225abfe1ce8df57b7c13915fe121ffb8"},
]

[[package]]
name = "tzdata"
version = "2024.1"
description = "Provider of IANA time zone data"
category = "main"
optional = false
python-versions = ">=2"
files = [
    {file = "tzdata-2024.1-py2.py3-none-any.whl", hash = "sha256:9068bc196136463f5245e51efda838afa15aaeca9903f49050dfa2679db4d252"},
    {file = "tzdata-2024.1.tar.gz", hash = "sha256:2674120f8d891909751c38abcdfd386ac0a5a1127954fbc332af6b5ceae07efd"},
]

[[package]]
name = "urllib3"
version = "2.2.2"
description = "HTTP library with thread-safe connection pooling, file post, and more."
category = "main"
optional = false
python-versions = ">=3.8"
files = [
    {file = "urllib3-2.2.2-py3-none-any.whl", hash = "sha256:a448b2f64d686155468037e1ace9f2d2199776e17f0a46610480d311f73e3472"},
    {file = "urllib3-2.2.2.tar.gz", hash = "sha256:dd505485549a7a552833da5e6063639d0d177c04f23bc3864e41e5dc5f612168"},
]

[package.extras]
brotli = ["brotli (>=1.0.9)", "brotlicffi (>=0.8.0)"]
h2 = ["h2 (>=4,<5)"]
socks = ["pysocks (>=1.5.6,!=1.5.7,<2.0)"]
zstd = ["zstandard (>=0.18.0)"]

[metadata]
lock-version = "2.0"
python-versions = "^3.9.7"
content-hash = "b5504e0bee987806914830b868c0930db7869c0b022b8a2707a1bc06ae84114d"

````

</details>


---

### 📄 `pyproject.toml` [611 octets]
<a id="pyproject-toml"></a> [↩ Retour à l'arborescence](#tree-pyproject-toml)

> **Chemin relatif** : `pyproject.toml`  
> **Taille** : 611 octets  
> **Lignes** : 29  
> **Type** : toml

```toml
[tool.poetry]
name = "Palome"
version = "VERSION"
description = ""
authors = ["Florent Cappon <florent.cappon@developpement-durable.gouv.fr>"]
packages = [{include = "palome"}]

[tool.poetry.dependencies]
python = "^3.9.7"
Django = "^4.2.1"
django-cron = "^0.6.0"
django-model-utils = "^4.3.1"
pillow = "^10.2.0"
psycopg2 = "^2.9.9"
setuptools = "^69.1.0"
python-decouple = "^3.8"
django-cas-ng = "^5.0.1"

[tool.poetry.group.dev.dependencies]
black = "^23.7.0"
flake8 = "^6.0.0"

[build-system]
requires = ["poetry-core"]
build-backend = "poetry.core.masonry.api"

[virtualenvs]
create = true
in-project = true
```


---

### 📄 `static/admin/css/autocomplete.css` [9.114 octets]
<a id="static-admin-css-autocomplete-css"></a> [↩ Retour à l'arborescence](#tree-static-admin-css-autocomplete-css)

> **Chemin relatif** : `static/admin/css/autocomplete.css`  
> **Taille** : 9.114 octets  
> **Lignes** : 276  
> **Type** : css

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (276 lignes) - Cliquer pour déplier</summary>

```css
select.admin-autocomplete {
    width: 20em;
}

.select2-container--admin-autocomplete.select2-container {
    min-height: 30px;
}

.select2-container--admin-autocomplete .select2-selection--single,
.select2-container--admin-autocomplete .select2-selection--multiple {
    min-height: 30px;
    padding: 0;
}

.select2-container--admin-autocomplete.select2-container--focus .select2-selection,
.select2-container--admin-autocomplete.select2-container--open .select2-selection {
    border-color: var(--body-quiet-color);
    min-height: 30px;
}

.select2-container--admin-autocomplete.select2-container--focus .select2-selection.select2-selection--single,
.select2-container--admin-autocomplete.select2-container--open .select2-selection.select2-selection--single {
    padding: 0;
}

.select2-container--admin-autocomplete.select2-container--focus .select2-selection.select2-selection--multiple,
.select2-container--admin-autocomplete.select2-container--open .select2-selection.select2-selection--multiple {
    padding: 0;
}

.select2-container--admin-autocomplete .select2-selection--single {
    background-color: var(--body-bg);
    border: 1px solid var(--border-color);
    border-radius: 4px;
}

.select2-container--admin-autocomplete .select2-selection--single .select2-selection__rendered {
    color: var(--body-fg);
    line-height: 30px;
}

.select2-container--admin-autocomplete .select2-selection--single .select2-selection__clear {
    cursor: pointer;
    float: right;
    font-weight: bold;
}

.select2-container--admin-autocomplete .select2-selection--single .select2-selection__placeholder {
    color: var(--body-quiet-color);
}

.select2-container--admin-autocomplete .select2-selection--single .select2-selection__arrow {
    height: 26px;
    position: absolute;
    top: 1px;
    right: 1px;
    width: 20px;
}

.select2-container--admin-autocomplete .select2-selection--single .select2-selection__arrow b {
    border-color: #888 transparent transparent transparent;
    border-style: solid;
    border-width: 5px 4px 0 4px;
    height: 0;
    left: 50%;
    margin-left: -4px;
    margin-top: -2px;
    position: absolute;
    top: 50%;
    width: 0;
}

.select2-container--admin-autocomplete[dir="rtl"] .select2-selection--single .select2-selection__clear {
    float: left;
}

.select2-container--admin-autocomplete[dir="rtl"] .select2-selection--single .select2-selection__arrow {
    left: 1px;
    right: auto;
}

.select2-container--admin-autocomplete.select2-container--disabled .select2-selection--single {
    background-color: var(--darkened-bg);
    cursor: default;
}

.select2-container--admin-autocomplete.select2-container--disabled .select2-selection--single .select2-selection__clear {
    display: none;
}

.select2-container--admin-autocomplete.select2-container--open .select2-selection--single .select2-selection__arrow b {
    border-color: transparent transparent #888 transparent;
    border-width: 0 4px 5px 4px;
}

.select2-container--admin-autocomplete .select2-selection--multiple {
    background-color: var(--body-bg);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    cursor: text;
}

.select2-container--admin-autocomplete .select2-selection--multiple .select2-selection__rendered {
    box-sizing: border-box;
    list-style: none;
    margin: 0;
    padding: 0 10px 5px 5px;
    width: 100%;
    display: flex;
    flex-wrap: wrap;
}

.select2-container--admin-autocomplete .select2-selection--multiple .select2-selection__rendered li {
    list-style: none;
}

.select2-container--admin-autocomplete .select2-selection--multiple .select2-selection__placeholder {
    color: var(--body-quiet-color);
    margin-top: 5px;
    float: left;
}

.select2-container--admin-autocomplete .select2-selection--multiple .select2-selection__clear {
    cursor: pointer;
    float: right;
    font-weight: bold;
    margin: 5px;
    position: absolute;
    right: 0;
}

.select2-container--admin-autocomplete .select2-selection--multiple .select2-selection__choice {
    background-color: var(--darkened-bg);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    cursor: default;
    float: left;
    margin-right: 5px;
    margin-top: 5px;
    padding: 0 5px;
}

.select2-container--admin-autocomplete .select2-selection--multiple .select2-selection__choice__remove {
    color: var(--body-quiet-color);
    cursor: pointer;
    display: inline-block;
    font-weight: bold;
    margin-right: 2px;
}

.select2-container--admin-autocomplete .select2-selection--multiple .select2-selection__choice__remove:hover {
    color: var(--body-fg);
}

.select2-container--admin-autocomplete[dir="rtl"] .select2-selection--multiple .select2-selection__choice, .select2-container--admin-autocomplete[dir="rtl"] .select2-selection--multiple .select2-selection__placeholder, .select2-container--admin-autocomplete[dir="rtl"] .select2-selection--multiple .select2-search--inline {
    float: right;
}

.select2-container--admin-autocomplete[dir="rtl"] .select2-selection--multiple .select2-selection__choice {
    margin-left: 5px;
    margin-right: auto;
}

.select2-container--admin-autocomplete[dir="rtl"] .select2-selection--multiple .select2-selection__choice__remove {
    margin-left: 2px;
    margin-right: auto;
}

.select2-container--admin-autocomplete.select2-container--focus .select2-selection--multiple {
    border: solid var(--body-quiet-color) 1px;
    outline: 0;
}

.select2-container--admin-autocomplete.select2-container--disabled .select2-selection--multiple {
    background-color: var(--darkened-bg);
    cursor: default;
}

.select2-container--admin-autocomplete.select2-container--disabled .select2-selection__choice__remove {
    display: none;
}

.select2-container--admin-autocomplete.select2-container--open.select2-container--above .select2-selection--single, .select2-container--admin-autocomplete.select2-container--open.select2-container--above .select2-selection--multiple {
    border-top-left-radius: 0;
    border-top-right-radius: 0;
}

.select2-container--admin-autocomplete.select2-container--open.select2-container--below .select2-selection--single, .select2-container--admin-autocomplete.select2-container--open.select2-container--below .select2-selection--multiple {
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
}

.select2-container--admin-autocomplete .select2-search--dropdown {
    background: var(--darkened-bg);
}

.select2-container--admin-autocomplete .select2-search--dropdown .select2-search__field {
    background: var(--body-bg);
    color: var(--body-fg);
    border: 1px solid var(--border-color);
    border-radius: 4px;
}

.select2-container--admin-autocomplete .select2-search--inline .select2-search__field {
    background: transparent;
    color: var(--body-fg);
    border: none;
    outline: 0;
    box-shadow: none;
    -webkit-appearance: textfield;
}

.select2-container--admin-autocomplete .select2-results > .select2-results__options {
    max-height: 200px;
    overflow-y: auto;
    color: var(--body-fg);
    background: var(--body-bg);
}

.select2-container--admin-autocomplete .select2-results__option[role=group] {
    padding: 0;
}

.select2-container--admin-autocomplete .select2-results__option[aria-disabled=true] {
    color: var(--body-quiet-color);
}

.select2-container--admin-autocomplete .select2-results__option[aria-selected=true] {
    background-color: var(--selected-bg);
    color: var(--body-fg);
}

.select2-container--admin-autocomplete .select2-results__option .select2-results__option {
    padding-left: 1em;
}

.select2-container--admin-autocomplete .select2-results__option .select2-results__option .select2-results__group {
    padding-left: 0;
}

.select2-container--admin-autocomplete .select2-results__option .select2-results__option .select2-results__option {
    margin-left: -1em;
    padding-left: 2em;
}

.select2-container--admin-autocomplete .select2-results__option .select2-results__option .select2-results__option .select2-results__option {
    margin-left: -2em;
    padding-left: 3em;
}

.select2-container--admin-autocomplete .select2-results__option .select2-results__option .select2-results__option .select2-results__option .select2-results__option {
    margin-left: -3em;
    padding-left: 4em;
}

.select2-container--admin-autocomplete .select2-results__option .select2-results__option .select2-results__option .select2-results__option .select2-results__option .select2-results__option {
    margin-left: -4em;
    padding-left: 5em;
}

.select2-container--admin-autocomplete .select2-results__option .select2-results__option .select2-results__option .select2-results__option .select2-results__option .select2-results__option .select2-results__option {
    margin-left: -5em;
    padding-left: 6em;
}

.select2-container--admin-autocomplete .select2-results__option--highlighted[aria-selected] {
    background-color: var(--primary);
    color: var(--primary-fg);
}

.select2-container--admin-autocomplete .select2-results__group {
    cursor: default;
    display: block;
    padding: 6px;
}

```

</details>


---

### 📄 `static/admin/css/base.css` [21.207 octets]
<a id="static-admin-css-base-css"></a> [↩ Retour à l'arborescence](#tree-static-admin-css-base-css)

> **Chemin relatif** : `static/admin/css/base.css`  
> **Taille** : 21.207 octets  
> **Lignes** : 1139  
> **Type** : css

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (1139 lignes) - Cliquer pour déplier</summary>

```css
/*
    DJANGO Admin styles
*/

/* VARIABLE DEFINITIONS */
html[data-theme="light"],
:root {
    --primary: #79aec8;
    --secondary: #417690;
    --accent: #f5dd5d;
    --primary-fg: #fff;

    --body-fg: #333;
    --body-bg: #fff;
    --body-quiet-color: #666;
    --body-loud-color: #000;

    --header-color: #ffc;
    --header-branding-color: var(--accent);
    --header-bg: var(--secondary);
    --header-link-color: var(--primary-fg);

    --breadcrumbs-fg: #c4dce8;
    --breadcrumbs-link-fg: var(--body-bg);
    --breadcrumbs-bg: var(--primary);

    --link-fg: #417893;
    --link-hover-color: #036;
    --link-selected-fg: #5b80b2;

    --hairline-color: #e8e8e8;
    --border-color: #ccc;

    --error-fg: #ba2121;

    --message-success-bg: #dfd;
    --message-warning-bg: #ffc;
    --message-error-bg: #ffefef;

    --darkened-bg: #f8f8f8; /* A bit darker than --body-bg */
    --selected-bg: #e4e4e4; /* E.g. selected table cells */
    --selected-row: #ffc;

    --button-fg: #fff;
    --button-bg: var(--primary);
    --button-hover-bg: #609ab6;
    --default-button-bg: var(--secondary);
    --default-button-hover-bg: #205067;
    --close-button-bg: #747474;
    --close-button-hover-bg: #333;
    --delete-button-bg: #ba2121;
    --delete-button-hover-bg: #a41515;

    --object-tools-fg: var(--button-fg);
    --object-tools-bg: var(--close-button-bg);
    --object-tools-hover-bg: var(--close-button-hover-bg);

    --font-family-primary:
        -apple-system,
        BlinkMacSystemFont,
        "Segoe UI",
        system-ui,
        Roboto,
        "Helvetica Neue",
        Arial,
        sans-serif,
        "Apple Color Emoji",
        "Segoe UI Emoji",
        "Segoe UI Symbol",
        "Noto Color Emoji";
    --font-family-monospace:
        ui-monospace,
        Menlo,
        Monaco,
        "Cascadia Mono",
        "Segoe UI Mono",
        "Roboto Mono",
        "Oxygen Mono",
        "Ubuntu Monospace",
        "Source Code Pro",
        "Fira Mono",
        "Droid Sans Mono",
        "Courier New",
        monospace,
        "Apple Color Emoji",
        "Segoe UI Emoji",
        "Segoe UI Symbol",
        "Noto Color Emoji";
}

html, body {
    height: 100%;
}

body {
    margin: 0;
    padding: 0;
    font-size: 0.875rem;
    font-family: var(--font-family-primary);
    color: var(--body-fg);
    background: var(--body-bg);
}

/* LINKS */

a:link, a:visited {
    color: var(--link-fg);
    text-decoration: none;
    transition: color 0.15s, background 0.15s;
}

a:focus, a:hover {
    color: var(--link-hover-color);
}

a:focus {
    text-decoration: underline;
}

a img {
    border: none;
}

a.section:link, a.section:visited {
    color: var(--header-link-color);
    text-decoration: none;
}

a.section:focus, a.section:hover {
    text-decoration: underline;
}

/* GLOBAL DEFAULTS */

p, ol, ul, dl {
    margin: .2em 0 .8em 0;
}

p {
    padding: 0;
    line-height: 140%;
}

h1,h2,h3,h4,h5 {
    font-weight: bold;
}

h1 {
    margin: 0 0 20px;
    font-weight: 300;
    font-size: 1.25rem;
    color: var(--body-quiet-color);
}

h2 {
    font-size: 1rem;
    margin: 1em 0 .5em 0;
}

h2.subhead {
    font-weight: normal;
    margin-top: 0;
}

h3 {
    font-size: 0.875rem;
    margin: .8em 0 .3em 0;
    color: var(--body-quiet-color);
    font-weight: bold;
}

h4 {
    font-size: 0.75rem;
    margin: 1em 0 .8em 0;
    padding-bottom: 3px;
}

h5 {
    font-size: 0.625rem;
    margin: 1.5em 0 .5em 0;
    color: var(--body-quiet-color);
    text-transform: uppercase;
    letter-spacing: 1px;
}

ul > li {
    list-style-type: square;
    padding: 1px 0;
}

li ul {
    margin-bottom: 0;
}

li, dt, dd {
    font-size: 0.8125rem;
    line-height: 1.25rem;
}

dt {
    font-weight: bold;
    margin-top: 4px;
}

dd {
    margin-left: 0;
}

form {
    margin: 0;
    padding: 0;
}

fieldset {
    margin: 0;
    min-width: 0;
    padding: 0;
    border: none;
    border-top: 1px solid var(--hairline-color);
}

blockquote {
    font-size: 0.6875rem;
    color: #777;
    margin-left: 2px;
    padding-left: 10px;
    border-left: 5px solid #ddd;
}

code, pre {
    font-family: var(--font-family-monospace);
    color: var(--body-quiet-color);
    font-size: 0.75rem;
    overflow-x: auto;
}

pre.literal-block {
    margin: 10px;
    background: var(--darkened-bg);
    padding: 6px 8px;
}

code strong {
    color: #930;
}

hr {
    clear: both;
    color: var(--hairline-color);
    background-color: var(--hairline-color);
    height: 1px;
    border: none;
    margin: 0;
    padding: 0;
    line-height: 1px;
}

/* TEXT STYLES & MODIFIERS */

.small {
    font-size: 0.6875rem;
}

.mini {
    font-size: 0.625rem;
}

.help, p.help, form p.help, div.help, form div.help, div.help li {
    font-size: 0.6875rem;
    color: var(--body-quiet-color);
}

div.help ul {
     margin-bottom: 0;
}

.help-tooltip {
    cursor: help;
}

p img, h1 img, h2 img, h3 img, h4 img, td img {
    vertical-align: middle;
}

.quiet, a.quiet:link, a.quiet:visited {
    color: var(--body-quiet-color);
    font-weight: normal;
}

.clear {
    clear: both;
}

.nowrap {
    white-space: nowrap;
}

.hidden {
    display: none !important;
}

/* TABLES */

table {
    border-collapse: collapse;
    border-color: var(--border-color);
}

td, th {
    font-size: 0.8125rem;
    line-height: 1rem;
    border-bottom: 1px solid var(--hairline-color);
    vertical-align: top;
    padding: 8px;
}

th {
    font-weight: 600;
    text-align: left;
}

thead th,
tfoot td {
    color: var(--body-quiet-color);
    padding: 5px 10px;
    font-size: 0.6875rem;
    background: var(--body-bg);
    border: none;
    border-top: 1px solid var(--hairline-color);
    border-bottom: 1px solid var(--hairline-color);
}

tfoot td {
    border-bottom: none;
    border-top: 1px solid var(--hairline-color);
}

thead th.required {
    color: var(--body-loud-color);
}

tr.alt {
    background: var(--darkened-bg);
}

tr:nth-child(odd), .row-form-errors {
    background: var(--body-bg);
}

tr:nth-child(even),
tr:nth-child(even) .errorlist,
tr:nth-child(odd) + .row-form-errors,
tr:nth-child(odd) + .row-form-errors .errorlist {
    background: var(--darkened-bg);
}

/* SORTABLE TABLES */

thead th {
    padding: 5px 10px;
    line-height: normal;
    text-transform: uppercase;
    background: var(--darkened-bg);
}

thead th a:link, thead th a:visited {
    color: var(--body-quiet-color);
}

thead th.sorted {
    background: var(--selected-bg);
}

thead th.sorted .text {
    padding-right: 42px;
}

table thead th .text span {
    padding: 8px 10px;
    display: block;
}

table thead th .text a {
    display: block;
    cursor: pointer;
    padding: 8px 10px;
}

table thead th .text a:focus, table thead th .text a:hover {
    background: var(--selected-bg);
}

thead th.sorted a.sortremove {
    visibility: hidden;
}

table thead th.sorted:hover a.sortremove {
    visibility: visible;
}

table thead th.sorted .sortoptions {
    display: block;
    padding: 9px 5px 0 5px;
    float: right;
    text-align: right;
}

table thead th.sorted .sortpriority {
    font-size: .8em;
    min-width: 12px;
    text-align: center;
    vertical-align: 3px;
    margin-left: 2px;
    margin-right: 2px;
}

table thead th.sorted .sortoptions a {
    position: relative;
    width: 14px;
    height: 14px;
    display: inline-block;
    background: url(../img/sorting-icons.svg) 0 0 no-repeat;
    background-size: 14px auto;
}

table thead th.sorted .sortoptions a.sortremove {
    background-position: 0 0;
}

table thead th.sorted .sortoptions a.sortremove:after {
    content: '\\';
    position: absolute;
    top: -6px;
    left: 3px;
    font-weight: 200;
    font-size: 1.125rem;
    color: var(--body-quiet-color);
}

table thead th.sorted .sortoptions a.sortremove:focus:after,
table thead th.sorted .sortoptions a.sortremove:hover:after {
    color: var(--link-fg);
}

table thead th.sorted .sortoptions a.sortremove:focus,
table thead th.sorted .sortoptions a.sortremove:hover {
    background-position: 0 -14px;
}

table thead th.sorted .sortoptions a.ascending {
    background-position: 0 -28px;
}

table thead th.sorted .sortoptions a.ascending:focus,
table thead th.sorted .sortoptions a.ascending:hover {
    background-position: 0 -42px;
}

table thead th.sorted .sortoptions a.descending {
    top: 1px;
    background-position: 0 -56px;
}

table thead th.sorted .sortoptions a.descending:focus,
table thead th.sorted .sortoptions a.descending:hover {
    background-position: 0 -70px;
}

/* FORM DEFAULTS */

input, textarea, select, .form-row p, form .button {
    margin: 2px 0;
    padding: 2px 3px;
    vertical-align: middle;
    font-family: var(--font-family-primary);
    font-weight: normal;
    font-size: 0.8125rem;
}
.form-row div.help {
    padding: 2px 3px;
}

textarea {
    vertical-align: top;
}

input[type=text], input[type=password], input[type=email], input[type=url],
input[type=number], input[type=tel], textarea, select, .vTextField {
    border: 1px solid var(--border-color);
    border-radius: 4px;
    padding: 5px 6px;
    margin-top: 0;
    color: var(--body-fg);
    background-color: var(--body-bg);
}

input[type=text]:focus, input[type=password]:focus, input[type=email]:focus,
input[type=url]:focus, input[type=number]:focus, input[type=tel]:focus,
textarea:focus, select:focus, .vTextField:focus {
    border-color: var(--body-quiet-color);
}

select {
    height: 1.875rem;
}

select[multiple] {
    /* Allow HTML size attribute to override the height in the rule above. */
    height: auto;
    min-height: 150px;
}

/* FORM BUTTONS */

.button, input[type=submit], input[type=button], .submit-row input, a.button {
    background: var(--button-bg);
    padding: 10px 15px;
    border: none;
    border-radius: 4px;
    color: var(--button-fg);
    cursor: pointer;
    transition: background 0.15s;
}

a.button {
    padding: 4px 5px;
}

.button:active, input[type=submit]:active, input[type=button]:active,
.button:focus, input[type=submit]:focus, input[type=button]:focus,
.button:hover, input[type=submit]:hover, input[type=button]:hover {
    background: var(--button-hover-bg);
}

.button[disabled], input[type=submit][disabled], input[type=button][disabled] {
    opacity: 0.4;
}

.button.default, input[type=submit].default, .submit-row input.default {
    border: none;
    font-weight: 400;
    background: var(--default-button-bg);
}

.button.default:active, input[type=submit].default:active,
.button.default:focus, input[type=submit].default:focus,
.button.default:hover, input[type=submit].default:hover {
    background: var(--default-button-hover-bg);
}

.button[disabled].default,
input[type=submit][disabled].default,
input[type=button][disabled].default {
    opacity: 0.4;
}


/* MODULES */

.module {
    border: none;
    margin-bottom: 30px;
    background: var(--body-bg);
}

.module p, .module ul, .module h3, .module h4, .module dl, .module pre {
    padding-left: 10px;
    padding-right: 10px;
}

.module blockquote {
    margin-left: 12px;
}

.module ul, .module ol {
    margin-left: 1.5em;
}

.module h3 {
    margin-top: .6em;
}

.module h2, .module caption, .inline-group h2 {
    margin: 0;
    padding: 8px;
    font-weight: 400;
    font-size: 0.8125rem;
    text-align: left;
    background: var(--primary);
    color: var(--header-link-color);
}

.module caption,
.inline-group h2 {
    font-size: 0.75rem;
    letter-spacing: 0.5px;
    text-transform: uppercase;
}

.module table {
    border-collapse: collapse;
}

/* MESSAGES & ERRORS */

ul.messagelist {
    padding: 0;
    margin: 0;
}

ul.messagelist li {
    display: block;
    font-weight: 400;
    font-size: 0.8125rem;
    padding: 10px 10px 10px 65px;
    margin: 0 0 10px 0;
    background: var(--message-success-bg) url(../img/icon-yes.svg) 40px 12px no-repeat;
    background-size: 16px auto;
    color: var(--body-fg);
    word-break: break-word;
}

ul.messagelist li.warning {
    background: var(--message-warning-bg) url(../img/icon-alert.svg) 40px 14px no-repeat;
    background-size: 14px auto;
}

ul.messagelist li.error {
    background: var(--message-error-bg) url(../img/icon-no.svg) 40px 12px no-repeat;
    background-size: 16px auto;
}

.errornote {
    font-size: 0.875rem;
    font-weight: 700;
    display: block;
    padding: 10px 12px;
    margin: 0 0 10px 0;
    color: var(--error-fg);
    border: 1px solid var(--error-fg);
    border-radius: 4px;
    background-color: var(--body-bg);
    background-position: 5px 12px;
    overflow-wrap: break-word;
}

ul.errorlist {
    margin: 0 0 4px;
    padding: 0;
    color: var(--error-fg);
    background: var(--body-bg);
}

ul.errorlist li {
    font-size: 0.8125rem;
    display: block;
    margin-bottom: 4px;
    overflow-wrap: break-word;
}

ul.errorlist li:first-child {
    margin-top: 0;
}

ul.errorlist li a {
    color: inherit;
    text-decoration: underline;
}

td ul.errorlist {
    margin: 0;
    padding: 0;
}

td ul.errorlist li {
    margin: 0;
}

.form-row.errors {
    margin: 0;
    border: none;
    border-bottom: 1px solid var(--hairline-color);
    background: none;
}

.form-row.errors ul.errorlist li {
    padding-left: 0;
}

.errors input, .errors select, .errors textarea,
td ul.errorlist + input, td ul.errorlist + select, td ul.errorlist + textarea {
    border: 1px solid var(--error-fg);
}

.description {
    font-size: 0.75rem;
    padding: 5px 0 0 12px;
}

/* BREADCRUMBS */

div.breadcrumbs {
    background: var(--breadcrumbs-bg);
    padding: 10px 40px;
    border: none;
    color: var(--breadcrumbs-fg);
    text-align: left;
}

div.breadcrumbs a {
    color: var(--breadcrumbs-link-fg);
}

div.breadcrumbs a:focus, div.breadcrumbs a:hover {
    color: var(--breadcrumbs-fg);
}

/* ACTION ICONS */

.viewlink, .inlineviewlink {
    padding-left: 16px;
    background: url(../img/icon-viewlink.svg) 0 1px no-repeat;
}

.addlink {
    padding-left: 16px;
    background: url(../img/icon-addlink.svg) 0 1px no-repeat;
}

.changelink, .inlinechangelink {
    padding-left: 16px;
    background: url(../img/icon-changelink.svg) 0 1px no-repeat;
}

.deletelink {
    padding-left: 16px;
    background: url(../img/icon-deletelink.svg) 0 1px no-repeat;
}

a.deletelink:link, a.deletelink:visited {
    color: #CC3434; /* XXX Probably unused? */
}

a.deletelink:focus, a.deletelink:hover {
    color: #993333; /* XXX Probably unused? */
    text-decoration: none;
}

/* OBJECT TOOLS */

.object-tools {
    font-size: 0.625rem;
    font-weight: bold;
    padding-left: 0;
    float: right;
    position: relative;
    margin-top: -48px;
}

.object-tools li {
    display: block;
    float: left;
    margin-left: 5px;
    height: 1rem;
}

.object-tools a {
    border-radius: 15px;
}

.object-tools a:link, .object-tools a:visited {
    display: block;
    float: left;
    padding: 3px 12px;
    background: var(--object-tools-bg);
    color: var(--object-tools-fg);
    font-weight: 400;
    font-size: 0.6875rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.object-tools a:focus, .object-tools a:hover {
    background-color: var(--object-tools-hover-bg);
}

.object-tools a:focus{
    text-decoration: none;
}

.object-tools a.viewsitelink, .object-tools a.addlink {
    background-repeat: no-repeat;
    background-position: right 7px center;
    padding-right: 26px;
}

.object-tools a.viewsitelink {
    background-image: url(../img/tooltag-arrowright.svg);
}

.object-tools a.addlink {
    background-image: url(../img/tooltag-add.svg);
}

/* OBJECT HISTORY */

#change-history table {
    width: 100%;
}

#change-history table tbody th {
    width: 16em;
}

#change-history .paginator {
    color: var(--body-quiet-color);
    border-bottom: 1px solid var(--hairline-color);
    background: var(--body-bg);
    overflow: hidden;
}

/* PAGE STRUCTURE */

#container {
    position: relative;
    width: 100%;
    min-width: 980px;
    padding: 0;
    display: flex;
    flex-direction: column;
    height: 100%;
}

#container > div {
    flex-shrink: 0;
}

#container > .main {
    display: flex;
    flex: 1 0 auto;
}

.main > .content {
    flex:  1 0;
    max-width: 100%;
}

.skip-to-content-link {
    position: absolute;
    top: -999px;
    margin: 5px;
    padding: 5px;
    background: var(--body-bg);
    z-index: 1;
}

.skip-to-content-link:focus {
    left: 0px;
    top: 0px;
}

#content {
    padding: 20px 40px;
}

.dashboard #content {
    width: 600px;
}

#content-main {
    float: left;
    width: 100%;
}

#content-related {
    float: right;
    width: 260px;
    position: relative;
    margin-right: -300px;
}

#footer {
    clear: both;
    padding: 10px;
}

/* COLUMN TYPES */

.colMS {
    margin-right: 300px;
}

.colSM {
    margin-left: 300px;
}

.colSM #content-related {
    float: left;
    margin-right: 0;
    margin-left: -300px;
}

.colSM #content-main {
    float: right;
}

.popup .colM {
    width: auto;
}

/* HEADER */

#header {
    width: auto;
    height: auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 40px;
    background: var(--header-bg);
    color: var(--header-color);
    overflow: hidden;
}

#header a:link, #header a:visited, #logout-form button {
    color: var(--header-link-color);
}

#header a:focus , #header a:hover {
    text-decoration: underline;
}

#branding {
    display: flex;
}

#branding h1 {
    padding: 0;
    margin: 0;
    margin-inline-end: 20px;
    font-weight: 300;
    font-size: 1.5rem;
    color: var(--header-branding-color);
}

#branding h1 a:link, #branding h1 a:visited {
    color: var(--accent);
}

#branding h2 {
    padding: 0 10px;
    font-size: 0.875rem;
    margin: -8px 0 8px 0;
    font-weight: normal;
    color: var(--header-color);
}

#branding a:hover {
    text-decoration: none;
}

#logout-form {
    display: inline;
}

#logout-form button {
    background: none;
    border: 0;
    cursor: pointer;
    font-family: var(--font-family-primary);
}

#user-tools {
    float: right;
    margin: 0 0 0 20px;
    text-align: right;
}

#user-tools, #logout-form button{
    padding: 0;
    font-weight: 300;
    font-size: 0.6875rem;
    letter-spacing: 0.5px;
    text-transform: uppercase;
}

#user-tools a, #logout-form button {
    border-bottom: 1px solid rgba(255, 255, 255, 0.25);
}

#user-tools a:focus, #user-tools a:hover,
#logout-form button:active, #logout-form button:hover {
    text-decoration: none;
    border-bottom: 0;
}

#logout-form button:active, #logout-form button:hover {
    margin-bottom: 1px;
}

/* SIDEBAR */

#content-related {
    background: var(--darkened-bg);
}

#content-related .module {
    background: none;
}

#content-related h3 {
    color: var(--body-quiet-color);
    padding: 0 16px;
    margin: 0 0 16px;
}

#content-related h4 {
    font-size: 0.8125rem;
}

#content-related p {
    padding-left: 16px;
    padding-right: 16px;
}

#content-related .actionlist {
    padding: 0;
    margin: 16px;
}

#content-related .actionlist li {
    line-height: 1.2;
    margin-bottom: 10px;
    padding-left: 18px;
}

#content-related .module h2 {
    background: none;
    padding: 16px;
    margin-bottom: 16px;
    border-bottom: 1px solid var(--hairline-color);
    font-size: 1.125rem;
    color: var(--body-fg);
}

.delete-confirmation form input[type="submit"] {
    background: var(--delete-button-bg);
    border-radius: 4px;
    padding: 10px 15px;
    color: var(--button-fg);
}

.delete-confirmation form input[type="submit"]:active,
.delete-confirmation form input[type="submit"]:focus,
.delete-confirmation form input[type="submit"]:hover {
    background: var(--delete-button-hover-bg);
}

.delete-confirmation form .cancel-link {
    display: inline-block;
    vertical-align: middle;
    height: 0.9375rem;
    line-height: 0.9375rem;
    border-radius: 4px;
    padding: 10px 15px;
    color: var(--button-fg);
    background: var(--close-button-bg);
    margin: 0 0 0 10px;
}

.delete-confirmation form .cancel-link:active,
.delete-confirmation form .cancel-link:focus,
.delete-confirmation form .cancel-link:hover {
    background: var(--close-button-hover-bg);
}

/* POPUP */
.popup #content {
    padding: 20px;
}

.popup #container {
    min-width: 0;
}

.popup #header {
    padding: 10px 20px;
}

/* PAGINATOR */

.paginator {
    font-size: 0.8125rem;
    padding-top: 10px;
    padding-bottom: 10px;
    line-height: 22px;
    margin: 0;
    border-top: 1px solid var(--hairline-color);
    width: 100%;
}

.paginator a:link, .paginator a:visited {
    padding: 2px 6px;
    background: var(--button-bg);
    text-decoration: none;
    color: var(--button-fg);
}

.paginator a.showall {
    border: none;
    background: none;
    color: var(--link-fg);
}

.paginator a.showall:focus, .paginator a.showall:hover {
    background: none;
    color: var(--link-hover-color);
}

.paginator .end {
    margin-right: 6px;
}

.paginator .this-page {
    padding: 2px 6px;
    font-weight: bold;
    font-size: 0.8125rem;
    vertical-align: top;
}

.paginator a:focus, .paginator a:hover {
    color: white;
    background: var(--link-hover-color);
}

.base-svgs {
    display: none;
}

```

</details>


---

### 📄 `static/admin/css/changelists.css` [6.584 octets]
<a id="static-admin-css-changelists-css"></a> [↩ Retour à l'arborescence](#tree-static-admin-css-changelists-css)

> **Chemin relatif** : `static/admin/css/changelists.css`  
> **Taille** : 6.584 octets  
> **Lignes** : 329  
> **Type** : css

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (329 lignes) - Cliquer pour déplier</summary>

```css
/* CHANGELISTS */

#changelist {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
}

#changelist .changelist-form-container {
    flex: 1 1 auto;
    min-width: 0;
}

#changelist table {
    width: 100%;
}

.change-list .hiddenfields { display:none; }

.change-list .filtered table {
    border-right: none;
}

.change-list .filtered {
    min-height: 400px;
}

.change-list .filtered .results, .change-list .filtered .paginator,
.filtered #toolbar, .filtered div.xfull {
    width: auto;
}

.change-list .filtered table tbody th {
    padding-right: 1em;
}

#changelist-form .results {
    overflow-x: auto;
    width: 100%;
}

#changelist .toplinks {
    border-bottom: 1px solid var(--hairline-color);
}

#changelist .paginator {
    color: var(--body-quiet-color);
    border-bottom: 1px solid var(--hairline-color);
    background: var(--body-bg);
    overflow: hidden;
}

/* CHANGELIST TABLES */

#changelist table thead th {
    padding: 0;
    white-space: nowrap;
    vertical-align: middle;
}

#changelist table thead th.action-checkbox-column {
    width: 1.5em;
    text-align: center;
}

#changelist table tbody td.action-checkbox {
    text-align: center;
}

#changelist table tfoot {
    color: var(--body-quiet-color);
}

/* TOOLBAR */

#toolbar {
    padding: 8px 10px;
    margin-bottom: 15px;
    border-top: 1px solid var(--hairline-color);
    border-bottom: 1px solid var(--hairline-color);
    background: var(--darkened-bg);
    color: var(--body-quiet-color);
}

#toolbar form input {
    border-radius: 4px;
    font-size: 0.875rem;
    padding: 5px;
    color: var(--body-fg);
}

#toolbar #searchbar {
    height: 1.1875rem;
    border: 1px solid var(--border-color);
    padding: 2px 5px;
    margin: 0;
    vertical-align: top;
    font-size: 0.8125rem;
    max-width: 100%;
}

#toolbar #searchbar:focus {
    border-color: var(--body-quiet-color);
}

#toolbar form input[type="submit"] {
    border: 1px solid var(--border-color);
    font-size: 0.8125rem;
    padding: 4px 8px;
    margin: 0;
    vertical-align: middle;
    background: var(--body-bg);
    box-shadow: 0 -15px 20px -10px rgba(0, 0, 0, 0.15) inset;
    cursor: pointer;
    color: var(--body-fg);
}

#toolbar form input[type="submit"]:focus,
#toolbar form input[type="submit"]:hover {
    border-color: var(--body-quiet-color);
}

#changelist-search img {
    vertical-align: middle;
    margin-right: 4px;
}

#changelist-search .help {
    word-break: break-word;
}

/* FILTER COLUMN */

#changelist-filter {
    flex: 0 0 240px;
    order: 1;
    background: var(--darkened-bg);
    border-left: none;
    margin: 0 0 0 30px;
}

#changelist-filter h2 {
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    padding: 5px 15px;
    margin-bottom: 12px;
    border-bottom: none;
}

#changelist-filter h3,
#changelist-filter details summary {
    font-weight: 400;
    padding: 0 15px;
    margin-bottom: 10px;
}

#changelist-filter details summary > * {
    display: inline;
}

#changelist-filter details > summary {
    list-style-type: none;
}

#changelist-filter details > summary::-webkit-details-marker {
    display: none;
}

#changelist-filter details > summary::before {
    content: '→';
    font-weight: bold;
    color: var(--link-hover-color);
}

#changelist-filter details[open] > summary::before {
    content: '↓';
}

#changelist-filter ul {
    margin: 5px 0;
    padding: 0 15px 15px;
    border-bottom: 1px solid var(--hairline-color);
}

#changelist-filter ul:last-child {
    border-bottom: none;
}

#changelist-filter li {
    list-style-type: none;
    margin-left: 0;
    padding-left: 0;
}

#changelist-filter a {
    display: block;
    color: var(--body-quiet-color);
    word-break: break-word;
}

#changelist-filter li.selected {
    border-left: 5px solid var(--hairline-color);
    padding-left: 10px;
    margin-left: -15px;
}

#changelist-filter li.selected a {
    color: var(--link-selected-fg);
}

#changelist-filter a:focus, #changelist-filter a:hover,
#changelist-filter li.selected a:focus,
#changelist-filter li.selected a:hover {
    color: var(--link-hover-color);
}

#changelist-filter #changelist-filter-clear a {
    font-size: 0.8125rem;
    padding-bottom: 10px;
    border-bottom: 1px solid var(--hairline-color);
}

/* DATE DRILLDOWN */

.change-list .toplinks {
    display: flex;
    padding-bottom: 5px;
    flex-wrap: wrap;
    gap: 3px 17px;
    font-weight: bold;
}

.change-list .toplinks a {
    font-size: 0.8125rem;
}

.change-list .toplinks .date-back {
    color: var(--body-quiet-color);
}

.change-list .toplinks .date-back:focus,
.change-list .toplinks .date-back:hover {
    color: var(--link-hover-color);
}

/* ACTIONS */

.filtered .actions {
    border-right: none;
}

#changelist table input {
    margin: 0;
    vertical-align: baseline;
}

/* Once the :has() pseudo-class is supported by all browsers, the tr.selected
   selector and the JS adding the class can be removed. */
#changelist table tbody tr.selected {
    background-color: var(--selected-row);
}

#changelist table tbody tr:has(input[type=checkbox]:checked) {
    background-color: var(--selected-row);
}

#changelist .actions {
    padding: 10px;
    background: var(--body-bg);
    border-top: none;
    border-bottom: none;
    line-height: 1.5rem;
    color: var(--body-quiet-color);
    width: 100%;
}

#changelist .actions span.all,
#changelist .actions span.action-counter,
#changelist .actions span.clear,
#changelist .actions span.question {
    font-size: 0.8125rem;
    margin: 0 0.5em;
}

#changelist .actions:last-child {
    border-bottom: none;
}

#changelist .actions select {
    vertical-align: top;
    height: 1.5rem;
    color: var(--body-fg);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    font-size: 0.875rem;
    padding: 0 0 0 4px;
    margin: 0;
    margin-left: 10px;
}

#changelist .actions select:focus {
    border-color: var(--body-quiet-color);
}

#changelist .actions label {
    display: inline-block;
    vertical-align: middle;
    font-size: 0.8125rem;
}

#changelist .actions .button {
    font-size: 0.8125rem;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    background: var(--body-bg);
    box-shadow: 0 -15px 20px -10px rgba(0, 0, 0, 0.15) inset;
    cursor: pointer;
    height: 1.5rem;
    line-height: 1;
    padding: 4px 8px;
    margin: 0;
    color: var(--body-fg);
}

#changelist .actions .button:focus, #changelist .actions .button:hover {
    border-color: var(--body-quiet-color);
}

```

</details>


---

### 📄 `static/admin/css/dark_mode.css` [2.929 octets]
<a id="static-admin-css-dark_mode-css"></a> [↩ Retour à l'arborescence](#tree-static-admin-css-dark_mode-css)

> **Chemin relatif** : `static/admin/css/dark_mode.css`  
> **Taille** : 2.929 octets  
> **Lignes** : 138  
> **Type** : css

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (138 lignes) - Cliquer pour déplier</summary>

```css
@media (prefers-color-scheme: dark) {
    :root {
      --primary: #264b5d;
      --primary-fg: #f7f7f7;
  
      --body-fg: #eeeeee;
      --body-bg: #121212;
      --body-quiet-color: #e0e0e0;
      --body-loud-color: #ffffff;
  
      --breadcrumbs-link-fg: #e0e0e0;
      --breadcrumbs-bg: var(--primary);
  
      --link-fg: #81d4fa;
      --link-hover-color: #4ac1f7;
      --link-selected-fg: #6f94c6;
  
      --hairline-color: #272727;
      --border-color: #353535;
  
      --error-fg: #e35f5f;
      --message-success-bg: #006b1b;
      --message-warning-bg: #583305;
      --message-error-bg: #570808;
  
      --darkened-bg: #212121;
      --selected-bg: #1b1b1b;
      --selected-row: #00363a;
  
      --close-button-bg: #333333;
      --close-button-hover-bg: #666666;
    }
  }


html[data-theme="dark"] {
    --primary: #264b5d;
    --primary-fg: #f7f7f7;

    --body-fg: #eeeeee;
    --body-bg: #121212;
    --body-quiet-color: #e0e0e0;
    --body-loud-color: #ffffff;

    --breadcrumbs-link-fg: #e0e0e0;
    --breadcrumbs-bg: var(--primary);

    --link-fg: #81d4fa;
    --link-hover-color: #4ac1f7;
    --link-selected-fg: #6f94c6;

    --hairline-color: #272727;
    --border-color: #353535;

    --error-fg: #e35f5f;
    --message-success-bg: #006b1b;
    --message-warning-bg: #583305;
    --message-error-bg: #570808;

    --darkened-bg: #212121;
    --selected-bg: #1b1b1b;
    --selected-row: #00363a;

    --close-button-bg: #333333;
    --close-button-hover-bg: #666666;
}

/* THEME SWITCH */
.theme-toggle {
    cursor: pointer;
    border: none;
    padding: 0;
    background: transparent;
    vertical-align: middle;
    margin-inline-start: 5px;
    margin-top: -1px;
}

.theme-toggle svg {
    vertical-align: middle;
    height: 1rem;
    width: 1rem;
    display: none;
}

/*
Fully hide screen reader text so we only show the one matching the current
theme.
*/
.theme-toggle .visually-hidden {
    display: none;
}

html[data-theme="auto"] .theme-toggle .theme-label-when-auto {
    display: block;
}

html[data-theme="dark"] .theme-toggle .theme-label-when-dark {
    display: block;
}

html[data-theme="light"] .theme-toggle .theme-label-when-light {
    display: block;
}

/* ICONS */
.theme-toggle svg.theme-icon-when-auto,
.theme-toggle svg.theme-icon-when-dark,
.theme-toggle svg.theme-icon-when-light {
    fill: var(--header-link-color);
    color: var(--header-bg);
}

html[data-theme="auto"] .theme-toggle svg.theme-icon-when-auto {
    display: block;
}

html[data-theme="dark"] .theme-toggle svg.theme-icon-when-dark {
    display: block;
}

html[data-theme="light"] .theme-toggle svg.theme-icon-when-light {
    display: block;
}

.visually-hidden {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    overflow: hidden;
    clip: rect(0,0,0,0);
    white-space: nowrap;
    border: 0;
    color: var(--body-fg);
    background-color: var(--body-bg);
}

```

</details>


---

### 📄 `static/admin/css/dashboard.css` [441 octets]
<a id="static-admin-css-dashboard-css"></a> [↩ Retour à l'arborescence](#tree-static-admin-css-dashboard-css)

> **Chemin relatif** : `static/admin/css/dashboard.css`  
> **Taille** : 441 octets  
> **Lignes** : 30  
> **Type** : css

```css
/* DASHBOARD */
.dashboard td, .dashboard th {
    word-break: break-word;
}

.dashboard .module table th {
    width: 100%;
}

.dashboard .module table td {
    white-space: nowrap;
}

.dashboard .module table td a {
    display: block;
    padding-right: .6em;
}

/* RECENT ACTIONS MODULE */

.module ul.actionlist {
    margin-left: 0;
}

ul.actionlist li {
    list-style-type: none;
    overflow: hidden;
    text-overflow: ellipsis;
}

```


---

### 📄 `static/admin/css/forms.css` [8.953 octets]
<a id="static-admin-css-forms-css"></a> [↩ Retour à l'arborescence](#tree-static-admin-css-forms-css)

> **Chemin relatif** : `static/admin/css/forms.css`  
> **Taille** : 8.953 octets  
> **Lignes** : 529  
> **Type** : css

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (529 lignes) - Cliquer pour déplier</summary>

```css
@import url('widgets.css');

/* FORM ROWS */

.form-row {
    overflow: hidden;
    padding: 10px;
    font-size: 0.8125rem;
    border-bottom: 1px solid var(--hairline-color);
}

.form-row img, .form-row input {
    vertical-align: middle;
}

.form-row label input[type="checkbox"] {
    margin-top: 0;
    vertical-align: 0;
}

form .form-row p {
    padding-left: 0;
}

.flex-container {
    display: flex;
    flex-wrap: wrap;
}

.form-multiline > div {
    padding-bottom: 10px;
}

/* FORM LABELS */

label {
    font-weight: normal;
    color: var(--body-quiet-color);
    font-size: 0.8125rem;
}

.required label, label.required {
    font-weight: bold;
    color: var(--body-fg);
}

/* RADIO BUTTONS */

form div.radiolist div {
    padding-right: 7px;
}

form div.radiolist.inline div {
    display: inline-block;
}

form div.radiolist label {
    width: auto;
}

form div.radiolist input[type="radio"] {
    margin: -2px 4px 0 0;
    padding: 0;
}

form ul.inline {
    margin-left: 0;
    padding: 0;
}

form ul.inline li {
    float: left;
    padding-right: 7px;
}

/* ALIGNED FIELDSETS */

.aligned label {
    display: block;
    padding: 4px 10px 0 0;
    width: 160px;
    word-wrap: break-word;
    line-height: 1;
}

.aligned label:not(.vCheckboxLabel):after {
    content: '';
    display: inline-block;
    vertical-align: middle;
    height: 1.625rem;
}

.aligned label + p, .aligned .checkbox-row + div.help, .aligned label + div.readonly {
    padding: 6px 0;
    margin-top: 0;
    margin-bottom: 0;
    margin-left: 0;
    overflow-wrap: break-word;
}

.aligned ul label {
    display: inline;
    float: none;
    width: auto;
}

.aligned .form-row input {
    margin-bottom: 0;
}

.colMS .aligned .vLargeTextField, .colMS .aligned .vXMLLargeTextField {
    width: 350px;
}

form .aligned ul {
    margin-left: 160px;
    padding-left: 10px;
}

form .aligned div.radiolist {
    display: inline-block;
    margin: 0;
    padding: 0;
}

form .aligned p.help,
form .aligned div.help {
    margin-top: 0;
    margin-left: 160px;
    padding-left: 10px;
}

form .aligned p.datetime div.help.timezonewarning {
    margin-left: 0;
    padding-left: 0;
    font-weight: normal;
}

form .aligned p.help:last-child,
form .aligned div.help:last-child {
    margin-bottom: 0;
    padding-bottom: 0;
}

form .aligned input + p.help,
form .aligned textarea + p.help,
form .aligned select + p.help,
form .aligned input + div.help,
form .aligned textarea + div.help,
form .aligned select + div.help {
    margin-left: 160px;
    padding-left: 10px;
}

form .aligned ul li {
    list-style: none;
}

form .aligned table p {
    margin-left: 0;
    padding-left: 0;
}

.aligned .vCheckboxLabel {
    float: none;
    width: auto;
    display: inline-block;
    vertical-align: -3px;
    padding: 0 0 5px 5px;
}

.aligned .vCheckboxLabel + p.help,
.aligned .vCheckboxLabel + div.help {
    margin-top: -4px;
}

.colM .aligned .vLargeTextField, .colM .aligned .vXMLLargeTextField {
    width: 610px;
}

fieldset .fieldBox {
    margin-right: 20px;
}

/* WIDE FIELDSETS */

.wide label {
    width: 200px;
}

form .wide p,
form .wide ul.errorlist,
form .wide input + p.help,
form .wide input + div.help {
    margin-left: 200px;
}

form .wide p.help,
form .wide div.help {
    padding-left: 50px;
}

form div.help ul {
    padding-left: 0;
    margin-left: 0;
}

.colM fieldset.wide .vLargeTextField, .colM fieldset.wide .vXMLLargeTextField {
    width: 450px;
}

/* COLLAPSED FIELDSETS */

fieldset.collapsed * {
    display: none;
}

fieldset.collapsed h2, fieldset.collapsed {
    display: block;
}

fieldset.collapsed {
    border: 1px solid var(--hairline-color);
    border-radius: 4px;
    overflow: hidden;
}

fieldset.collapsed h2 {
    background: var(--darkened-bg);
    color: var(--body-quiet-color);
}

fieldset .collapse-toggle {
    color: var(--header-link-color);
}

fieldset.collapsed .collapse-toggle {
    background: transparent;
    display: inline;
    color: var(--link-fg);
}

/* MONOSPACE TEXTAREAS */

fieldset.monospace textarea {
    font-family: var(--font-family-monospace);
}

/* SUBMIT ROW */

.submit-row {
    padding: 12px 14px 12px;
    margin: 0 0 20px;
    background: var(--darkened-bg);
    border: 1px solid var(--hairline-color);
    border-radius: 4px;
    overflow: hidden;
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

body.popup .submit-row {
    overflow: auto;
}

.submit-row input {
    height: 2.1875rem;
    line-height: 0.9375rem;
}

.submit-row input, .submit-row a {
    margin: 0;
}

.submit-row input.default {
    text-transform: uppercase;
}

.submit-row a.deletelink {
    margin-left: auto;
}

.submit-row a.deletelink {
    display: block;
    background: var(--delete-button-bg);
    border-radius: 4px;
    padding: 0.625rem 0.9375rem;
    height: 0.9375rem;
    line-height: 0.9375rem;
    color: var(--button-fg);
}

.submit-row a.closelink {
    display: inline-block;
    background: var(--close-button-bg);
    border-radius: 4px;
    padding: 10px 15px;
    height: 0.9375rem;
    line-height: 0.9375rem;
    color: var(--button-fg);
}

.submit-row a.deletelink:focus,
.submit-row a.deletelink:hover,
.submit-row a.deletelink:active {
    background: var(--delete-button-hover-bg);
    text-decoration: none;
}

.submit-row a.closelink:focus,
.submit-row a.closelink:hover,
.submit-row a.closelink:active {
    background: var(--close-button-hover-bg);
    text-decoration: none;
}

/* CUSTOM FORM FIELDS */

.vSelectMultipleField {
    vertical-align: top;
}

.vCheckboxField {
    border: none;
}

.vDateField, .vTimeField {
    margin-right: 2px;
    margin-bottom: 4px;
}

.vDateField {
    min-width: 6.85em;
}

.vTimeField {
    min-width: 4.7em;
}

.vURLField {
    width: 30em;
}

.vLargeTextField, .vXMLLargeTextField {
    width: 48em;
}

.flatpages-flatpage #id_content {
    height: 40.2em;
}

.module table .vPositiveSmallIntegerField {
    width: 2.2em;
}

.vIntegerField {
    width: 5em;
}

.vBigIntegerField {
    width: 10em;
}

.vForeignKeyRawIdAdminField {
    width: 5em;
}

.vTextField, .vUUIDField {
    width: 20em;
}

/* INLINES */

.inline-group {
    padding: 0;
    margin: 0 0 30px;
}

.inline-group thead th {
    padding: 8px 10px;
}

.inline-group .aligned label {
    width: 160px;
}

.inline-related {
    position: relative;
}

.inline-related h3 {
    margin: 0;
    color: var(--body-quiet-color);
    padding: 5px;
    font-size: 0.8125rem;
    background: var(--darkened-bg);
    border-top: 1px solid var(--hairline-color);
    border-bottom: 1px solid var(--hairline-color);
}

.inline-related h3 span.delete {
    float: right;
}

.inline-related h3 span.delete label {
    margin-left: 2px;
    font-size: 0.6875rem;
}

.inline-related fieldset {
    margin: 0;
    background: var(--body-bg);
    border: none;
    width: 100%;
}

.inline-related fieldset.module h3 {
    margin: 0;
    padding: 2px 5px 3px 5px;
    font-size: 0.6875rem;
    text-align: left;
    font-weight: bold;
    background: #bcd;
    color: var(--body-bg);
}

.inline-group .tabular fieldset.module {
    border: none;
}

.inline-related.tabular fieldset.module table {
    width: 100%;
    overflow-x: scroll;
}

.last-related fieldset {
    border: none;
}

.inline-group .tabular tr.has_original td {
    padding-top: 2em;
}

.inline-group .tabular tr td.original {
    padding: 2px 0 0 0;
    width: 0;
    _position: relative;
}

.inline-group .tabular th.original {
    width: 0px;
    padding: 0;
}

.inline-group .tabular td.original p {
    position: absolute;
    left: 0;
    height: 1.1em;
    padding: 2px 9px;
    overflow: hidden;
    font-size: 0.5625rem;
    font-weight: bold;
    color: var(--body-quiet-color);
    _width: 700px;
}

.inline-group ul.tools {
    padding: 0;
    margin: 0;
    list-style: none;
}

.inline-group ul.tools li {
    display: inline;
    padding: 0 5px;
}

.inline-group div.add-row,
.inline-group .tabular tr.add-row td {
    color: var(--body-quiet-color);
    background: var(--darkened-bg);
    padding: 8px 10px;
    border-bottom: 1px solid var(--hairline-color);
}

.inline-group .tabular tr.add-row td {
    padding: 8px 10px;
    border-bottom: 1px solid var(--hairline-color);
}

.inline-group ul.tools a.add,
.inline-group div.add-row a,
.inline-group .tabular tr.add-row td a {
    background: url(../img/icon-addlink.svg) 0 1px no-repeat;
    padding-left: 16px;
    font-size: 0.75rem;
}

.empty-form {
    display: none;
}

/* RELATED FIELD ADD ONE / LOOKUP */

.related-lookup {
    margin-left: 5px;
    display: inline-block;
    vertical-align: middle;
    background-repeat: no-repeat;
    background-size: 14px;
}

.related-lookup {
    width: 1rem;
    height: 1rem;
    background-image: url(../img/search.svg);
}

form .related-widget-wrapper ul {
    display: inline-block;
    margin-left: 0;
    padding-left: 0;
}

.clearable-file-input input {
    margin-top: 0;
}

```

</details>


---

### 📄 `static/admin/css/login.css` [958 octets]
<a id="static-admin-css-login-css"></a> [↩ Retour à l'arborescence](#tree-static-admin-css-login-css)

> **Chemin relatif** : `static/admin/css/login.css`  
> **Taille** : 958 octets  
> **Lignes** : 62  
> **Type** : css

```css
/* LOGIN FORM */

.login {
    background: var(--darkened-bg);
    height: auto;
}

.login #header {
    height: auto;
    padding: 15px 16px;
    justify-content: center;
}

.login #header h1 {
    font-size: 1.125rem;
    margin: 0;
}

.login #header h1 a {
    color: var(--header-link-color);
}

.login #content {
    padding: 20px 20px 0;
}

.login #container {
    background: var(--body-bg);
    border: 1px solid var(--hairline-color);
    border-radius: 4px;
    overflow: hidden;
    width: 28em;
    min-width: 300px;
    margin: 100px auto;
    height: auto;
}

.login .form-row {
    padding: 4px 0;
}

.login .form-row label {
    display: block;
    line-height: 2em;
}

.login .form-row #id_username, .login .form-row #id_password {
    padding: 8px;
    width: 100%;
    box-sizing: border-box;
}

.login .submit-row {
    padding: 1em 0 0 0;
    margin: 0;
    text-align: center;
}

.login .password-reset-link {
    text-align: center;
}

```


---

### 📄 `static/admin/css/nav_sidebar.css` [2.694 octets]
<a id="static-admin-css-nav_sidebar-css"></a> [↩ Retour à l'arborescence](#tree-static-admin-css-nav_sidebar-css)

> **Chemin relatif** : `static/admin/css/nav_sidebar.css`  
> **Taille** : 2.694 octets  
> **Lignes** : 145  
> **Type** : css

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (145 lignes) - Cliquer pour déplier</summary>

```css
.sticky {
    position: sticky;
    top: 0;
    max-height: 100vh;
}

.toggle-nav-sidebar {
    z-index: 20;
    left: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    flex: 0 0 23px;
    width: 23px;
    border: 0;
    border-right: 1px solid var(--hairline-color);
    background-color: var(--body-bg);
    cursor: pointer;
    font-size: 1.25rem;
    color: var(--link-fg);
    padding: 0;
}

[dir="rtl"] .toggle-nav-sidebar {
    border-left: 1px solid var(--hairline-color);
    border-right: 0;
}

.toggle-nav-sidebar:hover,
.toggle-nav-sidebar:focus {
    background-color: var(--darkened-bg);
}

#nav-sidebar {
    z-index: 15;
    flex: 0 0 275px;
    left: -276px;
    margin-left: -276px;
    border-top: 1px solid transparent;
    border-right: 1px solid var(--hairline-color);
    background-color: var(--body-bg);
    overflow: auto;
}

[dir="rtl"] #nav-sidebar {
    border-left: 1px solid var(--hairline-color);
    border-right: 0;
    left: 0;
    margin-left: 0;
    right: -276px;
    margin-right: -276px;
}

.toggle-nav-sidebar::before {
    content: '\00BB';
}

.main.shifted .toggle-nav-sidebar::before {
    content: '\00AB';
}

.main > #nav-sidebar {
    visibility: hidden;
}

.main.shifted > #nav-sidebar {
    margin-left: 0;
    visibility: visible;
}

[dir="rtl"] .main.shifted > #nav-sidebar {
    margin-right: 0;
}

#nav-sidebar .module th {
    width: 100%;
    overflow-wrap: anywhere;
}

#nav-sidebar .module th,
#nav-sidebar .module caption {
    padding-left: 16px;
}

#nav-sidebar .module td {
    white-space: nowrap;
}

[dir="rtl"] #nav-sidebar .module th,
[dir="rtl"] #nav-sidebar .module caption {
    padding-left: 8px;
    padding-right: 16px;
}

#nav-sidebar .current-app .section:link,
#nav-sidebar .current-app .section:visited {
    color: var(--header-color);
    font-weight: bold;
}

#nav-sidebar .current-model {
    background: var(--selected-row);
}

.main > #nav-sidebar + .content {
    max-width: calc(100% - 23px);
}

.main.shifted > #nav-sidebar + .content {
    max-width: calc(100% - 299px);
}

@media (max-width: 767px) {
    #nav-sidebar, #toggle-nav-sidebar {
        display: none;
    }

    .main > #nav-sidebar + .content,
    .main.shifted > #nav-sidebar + .content {
        max-width: 100%;
    }
}

#nav-filter {
    width: 100%;
    box-sizing: border-box;
    padding: 2px 5px;
    margin: 5px 0;
    border: 1px solid var(--border-color);
    background-color: var(--darkened-bg);
    color: var(--body-fg);
}

#nav-filter:focus {
    border-color: var(--body-quiet-color);
}

#nav-filter.no-results {
    background: var(--message-error-bg);
}

#nav-sidebar table {
    width: 100%;
}

```

</details>


---

### 📄 `static/admin/css/responsive.css` [18.533 octets]
<a id="static-admin-css-responsive-css"></a> [↩ Retour à l'arborescence](#tree-static-admin-css-responsive-css)

> **Chemin relatif** : `static/admin/css/responsive.css`  
> **Taille** : 18.533 octets  
> **Lignes** : 999  
> **Type** : css

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (999 lignes) - Cliquer pour déplier</summary>

```css
/* Tablets */

input[type="submit"], button {
    -webkit-appearance: none;
    appearance: none;
}

@media (max-width: 1024px) {
    /* Basic */

    html {
        -webkit-text-size-adjust: 100%;
    }

    td, th {
        padding: 10px;
        font-size: 0.875rem;
    }

    .small {
        font-size: 0.75rem;
    }

    /* Layout */

    #container {
        min-width: 0;
    }

    #content {
        padding: 15px 20px 20px;
    }

    div.breadcrumbs {
        padding: 10px 30px;
    }

    /* Header */

    #header {
        flex-direction: column;
        padding: 15px 30px;
        justify-content: flex-start;
    }

    #branding h1 {
        margin: 0 0 8px;
        line-height: 1.2;
    }

    #user-tools {
        margin: 0;
        font-weight: 400;
        line-height: 1.85;
        text-align: left;
    }

    #user-tools a {
        display: inline-block;
        line-height: 1.4;
    }

    /* Dashboard */

    .dashboard #content {
        width: auto;
    }

    #content-related {
        margin-right: -290px;
    }

    .colSM #content-related {
        margin-left: -290px;
    }

    .colMS {
        margin-right: 290px;
    }

    .colSM {
        margin-left: 290px;
    }

    .dashboard .module table td a {
        padding-right: 0;
    }

    td .changelink, td .addlink {
        font-size: 0.8125rem;
    }

    /* Changelist */

    #toolbar {
        border: none;
        padding: 15px;
    }

    #changelist-search > div {
        display: flex;
        flex-wrap: nowrap;
        max-width: 480px;
    }

    #changelist-search label {
        line-height: 1.375rem;
    }

    #toolbar form #searchbar {
        flex: 1 0 auto;
        width: 0;
        height: 1.375rem;
        margin: 0 10px 0 6px;
    }

    #toolbar form input[type=submit] {
        flex: 0 1 auto;
    }

    #changelist-search .quiet {
        width: 0;
        flex: 1 0 auto;
        margin: 5px 0 0 25px;
    }

    #changelist .actions {
        display: flex;
        flex-wrap: wrap;
        padding: 15px 0;
    }

    #changelist .actions label {
        display: flex;
    }

    #changelist .actions select {
        background: var(--body-bg);
    }

    #changelist .actions .button {
        min-width: 48px;
        margin: 0 10px;
    }

    #changelist .actions span.all,
    #changelist .actions span.clear,
    #changelist .actions span.question,
    #changelist .actions span.action-counter {
        font-size: 0.6875rem;
        margin: 0 10px 0 0;
    }

    #changelist-filter {
        flex-basis: 200px;
    }

    .change-list .filtered .results,
    .change-list .filtered .paginator,
    .filtered #toolbar,
    .filtered .actions,

    #changelist .paginator {
        border-top-color: var(--hairline-color); /* XXX Is this used at all? */
    }

    #changelist .results + .paginator {
        border-top: none;
    }

    /* Forms */

    label {
        font-size: 0.875rem;
    }

    .form-row input[type=text],
    .form-row input[type=password],
    .form-row input[type=email],
    .form-row input[type=url],
    .form-row input[type=tel],
    .form-row input[type=number],
    .form-row textarea,
    .form-row select,
    .form-row .vTextField {
        box-sizing: border-box;
        margin: 0;
        padding: 6px 8px;
        min-height: 2.25rem;
        font-size: 0.875rem;
    }

    .form-row select {
        height: 2.25rem;
    }

    .form-row select[multiple] {
        height: auto;
        min-height: 0;
    }

    fieldset .fieldBox + .fieldBox {
        margin-top: 10px;
        padding-top: 10px;
        border-top: 1px solid var(--hairline-color);
    }

    textarea {
        max-width: 100%;
        max-height: 120px;
    }

    .aligned label {
        padding-top: 6px;
    }

    .aligned .related-lookup,
    .aligned .datetimeshortcuts,
    .aligned .related-lookup + strong {
        align-self: center;
        margin-left: 15px;
    }

    form .aligned div.radiolist {
        margin-left: 2px;
    }

    .submit-row {
        padding: 8px;
    }

    .submit-row a.deletelink {
        padding: 10px 7px;
    }

    .button, input[type=submit], input[type=button], .submit-row input, a.button {
        padding: 7px;
    }

    /* Related widget */

    .related-widget-wrapper {
        float: none;
    }

    .related-widget-wrapper-link + .selector {
        max-width: calc(100% - 30px);
        margin-right: 15px;
    }

    select + .related-widget-wrapper-link,
    .related-widget-wrapper-link + .related-widget-wrapper-link {
        margin-left: 10px;
    }

    /* Selector */

    .selector {
        display: flex;
        width: 100%;
    }

    .selector .selector-filter {
        display: flex;
        align-items: center;
    }

    .selector .selector-filter label {
        margin: 0 8px 0 0;
    }

    .selector .selector-filter input {
        width: auto;
        min-height: 0;
        flex: 1 1;
    }

    .selector-available, .selector-chosen {
        width: auto;
        flex: 1 1;
        display: flex;
        flex-direction: column;
    }

    .selector select {
        width: 100%;
        flex: 1 0 auto;
        margin-bottom: 5px;
    }

    .selector ul.selector-chooser {
        width: 26px;
        height: 52px;
        padding: 2px 0;
        margin: auto 15px;
        border-radius: 20px;
        transform: translateY(-10px);
    }

    .selector-add, .selector-remove {
        width: 20px;
        height: 20px;
        background-size: 20px auto;
    }

    .selector-add {
        background-position: 0 -120px;
    }

    .selector-remove {
        background-position: 0 -80px;
    }

    a.selector-chooseall, a.selector-clearall {
        align-self: center;
    }

    .stacked {
        flex-direction: column;
        max-width: 480px;
    }

    .stacked > * {
        flex: 0 1 auto;
    }

    .stacked select {
        margin-bottom: 0;
    }

    .stacked .selector-available, .stacked .selector-chosen {
        width: auto;
    }

    .stacked ul.selector-chooser {
        width: 52px;
        height: 26px;
        padding: 0 2px;
        margin: 15px auto;
        transform: none;
    }

    .stacked .selector-chooser li {
        padding: 3px;
    }

    .stacked .selector-add, .stacked .selector-remove {
        background-size: 20px auto;
    }

    .stacked .selector-add {
        background-position: 0 -40px;
    }

    .stacked .active.selector-add {
        background-position: 0 -40px;
    }

    .active.selector-add:focus, .active.selector-add:hover {
        background-position: 0 -140px;
    }

    .stacked .active.selector-add:focus, .stacked .active.selector-add:hover {
        background-position: 0 -60px;
    }

    .stacked .selector-remove {
        background-position: 0 0;
    }

    .stacked .active.selector-remove {
        background-position: 0 0;
    }

    .active.selector-remove:focus, .active.selector-remove:hover {
        background-position: 0 -100px;
    }

    .stacked .active.selector-remove:focus, .stacked .active.selector-remove:hover {
        background-position: 0 -20px;
    }

    .help-tooltip, .selector .help-icon {
        display: none;
    }

    .datetime input {
        width: 50%;
        max-width: 120px;
    }

    .datetime span {
        font-size: 0.8125rem;
    }

    .datetime .timezonewarning {
        display: block;
        font-size: 0.6875rem;
        color: var(--body-quiet-color);
    }

    .datetimeshortcuts {
        color: var(--border-color); /* XXX Redundant, .datetime span also sets #ccc */
    }

    .form-row .datetime input.vDateField, .form-row .datetime input.vTimeField {
        width: 75%;
    }

    .inline-group {
        overflow: auto;
    }

    /* Messages */

    ul.messagelist li {
        padding-left: 55px;
        background-position: 30px 12px;
    }

    ul.messagelist li.error {
        background-position: 30px 12px;
    }

    ul.messagelist li.warning {
        background-position: 30px 14px;
    }

    /* Login */

    .login #header {
        padding: 15px 20px;
    }

    .login #branding h1 {
        margin: 0;
    }

    /* GIS */

    div.olMap {
        max-width: calc(100vw - 30px);
        max-height: 300px;
    }

    .olMap + .clear_features {
        display: block;
        margin-top: 10px;
    }

    /* Docs */

    .module table.xfull {
        width: 100%;
    }

    pre.literal-block {
        overflow: auto;
    }
}

/* Mobile */

@media (max-width: 767px) {
    /* Layout */

    #header, #content, #footer {
        padding: 15px;
    }

    #footer:empty {
        padding: 0;
    }

    div.breadcrumbs {
        padding: 10px 15px;
    }

    /* Dashboard */

    .colMS, .colSM {
        margin: 0;
    }

    #content-related, .colSM #content-related {
        width: 100%;
        margin: 0;
    }

    #content-related .module {
        margin-bottom: 0;
    }

    #content-related .module h2 {
        padding: 10px 15px;
        font-size: 1rem;
    }

    /* Changelist */

    #changelist {
        align-items: stretch;
        flex-direction: column;
    }

    #toolbar {
        padding: 10px;
    }

    #changelist-filter {
        margin-left: 0;
    }

    #changelist .actions label {
        flex: 1 1;
    }

    #changelist .actions select {
        flex: 1 0;
        width: 100%;
    }

    #changelist .actions span {
        flex: 1 0 100%;
    }

    #changelist-filter {
        position: static;
        width: auto;
        margin-top: 30px;
    }

    .object-tools {
        float: none;
        margin: 0 0 15px;
        padding: 0;
        overflow: hidden;
    }

    .object-tools li {
        height: auto;
        margin-left: 0;
    }

    .object-tools li + li {
        margin-left: 15px;
    }

    /* Forms */

    .form-row {
        padding: 15px 0;
    }

    .aligned .form-row,
    .aligned .form-row > div {
        max-width: 100vw;
    }

    .aligned .form-row > div {
        width: calc(100vw - 30px);
    }

    .flex-container {
        flex-flow: column;
    }

    textarea {
        max-width: none;
    }

    .vURLField {
        width: auto;
    }

    fieldset .fieldBox + .fieldBox {
        margin-top: 15px;
        padding-top: 15px;
    }

    fieldset.collapsed .form-row {
        display: none;
    }

    .aligned label {
        width: 100%;
        padding: 0 0 10px;
    }

    .aligned label:after {
        max-height: 0;
    }

    .aligned .form-row input,
    .aligned .form-row select,
    .aligned .form-row textarea {
        flex: 1 1 auto;
        max-width: 100%;
    }

    .aligned .checkbox-row {
        align-items: center;
    }

    .aligned .checkbox-row input {
        flex: 0 1 auto;
        margin: 0;
    }

    .aligned .vCheckboxLabel {
        flex: 1 0;
        padding: 1px 0 0 5px;
    }

    .aligned label + p,
    .aligned label + div.help,
    .aligned label + div.readonly {
        padding: 0;
        margin-left: 0;
    }

    .aligned p.file-upload {
        font-size: 0.8125rem;
    }

    span.clearable-file-input {
        margin-left: 15px;
    }

    span.clearable-file-input label {
        font-size: 0.8125rem;
        padding-bottom: 0;
    }

    .aligned .timezonewarning {
        flex: 1 0 100%;
        margin-top: 5px;
    }

    form .aligned .form-row div.help {
        width: 100%;
        margin: 5px 0 0;
        padding: 0;
    }

    form .aligned ul,
    form .aligned ul.errorlist {
        margin-left: 0;
        padding-left: 0;
    }

    form .aligned div.radiolist {
        margin-top: 5px;
        margin-right: 15px;
        margin-bottom: -3px;
    }

    form .aligned div.radiolist:not(.inline) div + div {
        margin-top: 5px;
    }

    /* Related widget */

    .related-widget-wrapper {
        width: 100%;
        display: flex;
        align-items: flex-start;
    }

    .related-widget-wrapper .selector {
        order: 1;
    }

    .related-widget-wrapper > a {
        order: 2;
    }

    .related-widget-wrapper .radiolist ~ a {
        align-self: flex-end;
    }

    .related-widget-wrapper > select ~ a {
        align-self: center;
    }

    select + .related-widget-wrapper-link,
    .related-widget-wrapper-link + .related-widget-wrapper-link {
        margin-left: 15px;
    }

    /* Selector */

    .selector {
        flex-direction: column;
    }

    .selector > * {
        float: none;
    }

    .selector-available, .selector-chosen {
        margin-bottom: 0;
        flex: 1 1 auto;
    }

    .selector select {
        max-height: 96px;
    }

    .selector ul.selector-chooser {
        display: block;
        float: none;
        width: 52px;
        height: 26px;
        padding: 0 2px;
        margin: 15px auto 20px;
        transform: none;
    }

    .selector ul.selector-chooser li {
        float: left;
    }

    .selector-remove {
        background-position: 0 0;
    }

    .active.selector-remove:focus, .active.selector-remove:hover {
        background-position: 0 -20px;
    }

    .selector-add  {
        background-position: 0 -40px;
    }

    .active.selector-add:focus, .active.selector-add:hover {
        background-position: 0 -60px;
    }

    /* Inlines */

    .inline-group[data-inline-type="stacked"] .inline-related {
        border: 1px solid var(--hairline-color);
        border-radius: 4px;
        margin-top: 15px;
        overflow: auto;
    }

    .inline-group[data-inline-type="stacked"] .inline-related > * {
        box-sizing: border-box;
    }

    .inline-group[data-inline-type="stacked"] .inline-related .module {
        padding: 0 10px;
    }

    .inline-group[data-inline-type="stacked"] .inline-related .module .form-row {
        border-top: 1px solid var(--hairline-color);
        border-bottom: none;
    }

    .inline-group[data-inline-type="stacked"] .inline-related .module .form-row:first-child {
        border-top: none;
    }

    .inline-group[data-inline-type="stacked"] .inline-related h3 {
        padding: 10px;
        border-top-width: 0;
        border-bottom-width: 2px;
        display: flex;
        flex-wrap: wrap;
        align-items: center;
    }

    .inline-group[data-inline-type="stacked"] .inline-related h3 .inline_label {
        margin-right: auto;
    }

    .inline-group[data-inline-type="stacked"] .inline-related h3 span.delete {
        float: none;
        flex: 1 1 100%;
        margin-top: 5px;
    }

    .inline-group[data-inline-type="stacked"] .aligned .form-row > div:not([class]) {
        width: 100%;
    }

    .inline-group[data-inline-type="stacked"] .aligned label {
        width: 100%;
    }

    .inline-group[data-inline-type="stacked"] div.add-row {
        margin-top: 15px;
        border: 1px solid var(--hairline-color);
        border-radius: 4px;
    }

    .inline-group div.add-row,
    .inline-group .tabular tr.add-row td {
        padding: 0;
    }

    .inline-group div.add-row a,
    .inline-group .tabular tr.add-row td a {
        display: block;
        padding: 8px 10px 8px 26px;
        background-position: 8px 9px;
    }

    /* Submit row */

    .submit-row {
        padding: 10px;
        margin: 0 0 15px;
        flex-direction: column;
        gap: 8px;
    }

    .submit-row input, .submit-row input.default, .submit-row a {
        text-align: center;
    }

    .submit-row a.closelink {
        padding: 10px 0;
        text-align: center;
    }

    .submit-row a.deletelink {
        margin: 0;
    }

    /* Messages */

    ul.messagelist li {
        padding-left: 40px;
        background-position: 15px 12px;
    }

    ul.messagelist li.error {
        background-position: 15px 12px;
    }

    ul.messagelist li.warning {
        background-position: 15px 14px;
    }

    /* Paginator */

    .paginator .this-page, .paginator a:link, .paginator a:visited {
        padding: 4px 10px;
    }

    /* Login */

    body.login {
        padding: 0 15px;
    }

    .login #container {
        width: auto;
        max-width: 480px;
        margin: 50px auto;
    }

    .login #header,
    .login #content {
        padding: 15px;
    }

    .login #content-main {
        float: none;
    }

    .login .form-row {
        padding: 0;
    }

    .login .form-row + .form-row {
        margin-top: 15px;
    }

    .login .form-row label {
        margin: 0 0 5px;
        line-height: 1.2;
    }

    .login .submit-row {
        padding: 15px 0 0;
    }

    .login br {
        display: none;
    }

    .login .submit-row input {
        margin: 0;
        text-transform: uppercase;
    }

    .errornote {
        margin: 0 0 20px;
        padding: 8px 12px;
        font-size: 0.8125rem;
    }

    /* Calendar and clock */

    .calendarbox, .clockbox {
        position: fixed !important;
        top: 50% !important;
        left: 50% !important;
        transform: translate(-50%, -50%);
        margin: 0;
        border: none;
        overflow: visible;
    }

    .calendarbox:before, .clockbox:before {
        content: '';
        position: fixed;
        top: 50%;
        left: 50%;
        width: 100vw;
        height: 100vh;
        background: rgba(0, 0, 0, 0.75);
        transform: translate(-50%, -50%);
    }

    .calendarbox > *, .clockbox > * {
        position: relative;
        z-index: 1;
    }

    .calendarbox > div:first-child {
        z-index: 2;
    }

    .calendarbox .calendar, .clockbox h2 {
        border-radius: 4px 4px 0 0;
        overflow: hidden;
    }

    .calendarbox .calendar-cancel, .clockbox .calendar-cancel {
        border-radius: 0 0 4px 4px;
        overflow: hidden;
    }

    .calendar-shortcuts {
        padding: 10px 0;
        font-size: 0.75rem;
        line-height: 0.75rem;
    }

    .calendar-shortcuts a {
        margin: 0 4px;
    }

    .timelist a {
        background: var(--body-bg);
        padding: 4px;
    }

    .calendar-cancel {
        padding: 8px 10px;
    }

    .clockbox h2 {
        padding: 8px 15px;
    }

    .calendar caption {
        padding: 10px;
    }

    .calendarbox .calendarnav-previous, .calendarbox .calendarnav-next {
        z-index: 1;
        top: 10px;
    }

    /* History */

    table#change-history tbody th, table#change-history tbody td {
        font-size: 0.8125rem;
        word-break: break-word;
    }

    table#change-history tbody th {
        width: auto;
    }

    /* Docs */

    table.model tbody th, table.model tbody td {
        font-size: 0.8125rem;
        word-break: break-word;
    }
}

```

</details>


---

### 📄 `static/admin/css/responsive_rtl.css` [1.785 octets]
<a id="static-admin-css-responsive_rtl-css"></a> [↩ Retour à l'arborescence](#tree-static-admin-css-responsive_rtl-css)

> **Chemin relatif** : `static/admin/css/responsive_rtl.css`  
> **Taille** : 1.785 octets  
> **Lignes** : 82  
> **Type** : css

```css
/* TABLETS */

@media (max-width: 1024px) {
    [dir="rtl"] .colMS {
        margin-right: 0;
    }

    [dir="rtl"] #user-tools {
        text-align: right;
    }

    [dir="rtl"] #changelist .actions label {
        padding-left: 10px;
        padding-right: 0;
    }

    [dir="rtl"] #changelist .actions select {
        margin-left: 0;
        margin-right: 15px;
    }

    [dir="rtl"] .change-list .filtered .results,
    [dir="rtl"] .change-list .filtered .paginator,
    [dir="rtl"] .filtered #toolbar,
    [dir="rtl"] .filtered div.xfull,
    [dir="rtl"] .filtered .actions,
    [dir="rtl"] #changelist-filter {
        margin-left: 0;
    }

    [dir="rtl"] .inline-group ul.tools a.add,
    [dir="rtl"] .inline-group div.add-row a,
    [dir="rtl"] .inline-group .tabular tr.add-row td a {
        padding: 8px 26px 8px 10px;
        background-position: calc(100% - 8px) 9px;
    }

    [dir="rtl"] .related-widget-wrapper-link + .selector {
        margin-right: 0;
        margin-left: 15px;
    }

    [dir="rtl"] .selector .selector-filter label {
        margin-right: 0;
        margin-left: 8px;
    }

    [dir="rtl"] .object-tools li {
        float: right;
    }

    [dir="rtl"] .object-tools li + li {
        margin-left: 0;
        margin-right: 15px;
    }

    [dir="rtl"] .dashboard .module table td a {
        padding-left: 0;
        padding-right: 16px;
    }
}

/* MOBILE */

@media (max-width: 767px) {
    [dir="rtl"] .aligned .related-lookup,
    [dir="rtl"] .aligned .datetimeshortcuts {
        margin-left: 0;
        margin-right: 15px;
    }

    [dir="rtl"] .aligned ul,
    [dir="rtl"] form .aligned ul.errorlist {
        margin-right: 0;
    }

    [dir="rtl"] #changelist-filter {
        margin-left: 0;
        margin-right: 0;
    }
}

```


---

### 📄 `static/admin/css/rtl.css` [4.694 octets]
<a id="static-admin-css-rtl-css"></a> [↩ Retour à l'arborescence](#tree-static-admin-css-rtl-css)

> **Chemin relatif** : `static/admin/css/rtl.css`  
> **Taille** : 4.694 octets  
> **Lignes** : 287  
> **Type** : css

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (287 lignes) - Cliquer pour déplier</summary>

```css
/* GLOBAL */

th {
    text-align: right;
}

.module h2, .module caption {
    text-align: right;
}

.module ul, .module ol {
    margin-left: 0;
    margin-right: 1.5em;
}

.viewlink, .addlink, .changelink {
    padding-left: 0;
    padding-right: 16px;
    background-position: 100% 1px;
}

.deletelink {
    padding-left: 0;
    padding-right: 16px;
    background-position: 100% 1px;
}

.object-tools {
    float: left;
}

thead th:first-child,
tfoot td:first-child {
    border-left: none;
}

/* LAYOUT */

#user-tools {
    right: auto;
    left: 0;
    text-align: left;
}

div.breadcrumbs {
    text-align: right;
}

#content-main {
    float: right;
}

#content-related {
    float: left;
    margin-left: -300px;
    margin-right: auto;
}

.colMS {
    margin-left: 300px;
    margin-right: 0;
}

/* SORTABLE TABLES */

table thead th.sorted .sortoptions {
   float: left;
}

thead th.sorted .text {
    padding-right: 0;
    padding-left: 42px;
}

/* dashboard styles */

.dashboard .module table td a {
    padding-left: .6em;
    padding-right: 16px;
}

/* changelists styles */

.change-list .filtered table {
    border-left: none;
    border-right: 0px none;
}

#changelist-filter {
    border-left: none;
    border-right: none;
    margin-left: 0;
    margin-right: 30px;
}

#changelist-filter li.selected {
    border-left: none;
    padding-left: 10px;
    margin-left: 0;
    border-right: 5px solid var(--hairline-color);
    padding-right: 10px;
    margin-right: -15px;
}

#changelist table tbody td:first-child, #changelist table tbody th:first-child {
    border-right: none;
    border-left: none;
}

/* FORMS */

.aligned label {
    padding: 0 0 3px 1em;
}

.submit-row a.deletelink {
    margin-left: 0;
    margin-right: auto;
}

.vDateField, .vTimeField {
    margin-left: 2px;
}

.aligned .form-row input {
    margin-left: 5px;
}

form .aligned ul {
    margin-right: 163px;
    padding-right: 10px;
    margin-left: 0;
    padding-left: 0;
}

form ul.inline li {
    float: right;
    padding-right: 0;
    padding-left: 7px;
}

form .aligned p.help,
form .aligned div.help {
    margin-right: 160px;
    padding-right: 10px;
}

form div.help ul,
form .aligned .checkbox-row + .help,
form .aligned p.datetime div.help.timezonewarning {
    margin-right: 0;
    padding-right: 0;
}

form .wide p.help, form .wide div.help {
    padding-left: 0;
    padding-right: 50px;
}

form .wide p,
form .wide ul.errorlist,
form .wide input + p.help,
form .wide input + div.help {
    margin-right: 200px;
    margin-left: 0px;
}

.submit-row {
    text-align: right;
}

fieldset .fieldBox {
    margin-left: 20px;
    margin-right: 0;
}

.errorlist li {
    background-position: 100% 12px;
    padding: 0;
}

.errornote {
    background-position: 100% 12px;
    padding: 10px 12px;
}

/* WIDGETS */

.calendarnav-previous {
    top: 0;
    left: auto;
    right: 10px;
    background: url(../img/calendar-icons.svg) 0 -30px no-repeat;
}

.calendarbox .calendarnav-previous:focus,
.calendarbox .calendarnav-previous:hover {
    background-position: 0 -45px;
}

.calendarnav-next {
    top: 0;
    right: auto;
    left: 10px;
    background: url(../img/calendar-icons.svg) 0 0 no-repeat;
}

.calendarbox .calendarnav-next:focus,
.calendarbox .calendarnav-next:hover {
    background-position: 0 -15px;
}

.calendar caption, .calendarbox h2 {
    text-align: center;
}

.selector {
    float: right;
}

.selector .selector-filter {
    text-align: right;
}

.selector-add {
  background: url(../img/selector-icons.svg) 0 -64px no-repeat;
}

.active.selector-add:focus, .active.selector-add:hover {
  background-position: 0 -80px;
}

.selector-remove {
  background: url(../img/selector-icons.svg) 0 -96px no-repeat;
}

.active.selector-remove:focus, .active.selector-remove:hover {
  background-position: 0 -112px;
}

a.selector-chooseall {
    background: url(../img/selector-icons.svg) right -128px no-repeat;
}

a.active.selector-chooseall:focus, a.active.selector-chooseall:hover {
    background-position: 100% -144px;
}

a.selector-clearall {
    background: url(../img/selector-icons.svg) 0 -160px no-repeat;
}

a.active.selector-clearall:focus, a.active.selector-clearall:hover {
    background-position: 0 -176px;
}

.inline-deletelink {
    float: left;
}

form .form-row p.datetime {
    overflow: hidden;
}

.related-widget-wrapper {
    float: right;
}

/* MISC */

.inline-related h2, .inline-group h2 {
    text-align: right
}

.inline-related h3 span.delete {
    padding-right: 20px;
    padding-left: inherit;
    left: 10px;
    right: inherit;
    float:left;
}

.inline-related h3 span.delete label {
    margin-left: inherit;
    margin-right: 2px;
}

```

</details>


---

### 📄 `static/admin/css/vendor/select2/LICENSE-SELECT2.md` [1.124 octets]
<a id="static-admin-css-vendor-select2-LICENSE-SELECT2-md"></a> [↩ Retour à l'arborescence](#tree-static-admin-css-vendor-select2-LICENSE-SELECT2-md)

> **Chemin relatif** : `static/admin/css/vendor/select2/LICENSE-SELECT2.md`  
> **Taille** : 1.124 octets  
> **Lignes** : 22  
> **Type** : markdown

```markdown
The MIT License (MIT)

Copyright (c) 2012-2017 Kevin Brown, Igor Vaynberg, and Select2 contributors

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

```


---

### 📄 `static/admin/css/vendor/select2/select2.css` [17.358 octets]
<a id="static-admin-css-vendor-select2-select2-css"></a> [↩ Retour à l'arborescence](#tree-static-admin-css-vendor-select2-select2-css)

> **Chemin relatif** : `static/admin/css/vendor/select2/select2.css`  
> **Taille** : 17.358 octets  
> **Lignes** : 482  
> **Type** : css

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (482 lignes) - Cliquer pour déplier</summary>

```css
.select2-container {
  box-sizing: border-box;
  display: inline-block;
  margin: 0;
  position: relative;
  vertical-align: middle; }
  .select2-container .select2-selection--single {
    box-sizing: border-box;
    cursor: pointer;
    display: block;
    height: 28px;
    user-select: none;
    -webkit-user-select: none; }
    .select2-container .select2-selection--single .select2-selection__rendered {
      display: block;
      padding-left: 8px;
      padding-right: 20px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap; }
    .select2-container .select2-selection--single .select2-selection__clear {
      position: relative; }
  .select2-container[dir="rtl"] .select2-selection--single .select2-selection__rendered {
    padding-right: 8px;
    padding-left: 20px; }
  .select2-container .select2-selection--multiple {
    box-sizing: border-box;
    cursor: pointer;
    display: block;
    min-height: 32px;
    user-select: none;
    -webkit-user-select: none; }
    .select2-container .select2-selection--multiple .select2-selection__rendered {
      display: inline-block;
      overflow: hidden;
      padding-left: 8px;
      text-overflow: ellipsis;
      white-space: nowrap; }
  .select2-container .select2-search--inline {
    float: left; }
    .select2-container .select2-search--inline .select2-search__field {
      box-sizing: border-box;
      border: none;
      font-size: 100%;
      margin-top: 5px;
      padding: 0; }
      .select2-container .select2-search--inline .select2-search__field::-webkit-search-cancel-button {
        -webkit-appearance: none; }

.select2-dropdown {
  background-color: white;
  border: 1px solid #aaa;
  border-radius: 4px;
  box-sizing: border-box;
  display: block;
  position: absolute;
  left: -100000px;
  width: 100%;
  z-index: 1051; }

.select2-results {
  display: block; }

.select2-results__options {
  list-style: none;
  margin: 0;
  padding: 0; }

.select2-results__option {
  padding: 6px;
  user-select: none;
  -webkit-user-select: none; }
  .select2-results__option[aria-selected] {
    cursor: pointer; }

.select2-container--open .select2-dropdown {
  left: 0; }

.select2-container--open .select2-dropdown--above {
  border-bottom: none;
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0; }

.select2-container--open .select2-dropdown--below {
  border-top: none;
  border-top-left-radius: 0;
  border-top-right-radius: 0; }

.select2-search--dropdown {
  display: block;
  padding: 4px; }
  .select2-search--dropdown .select2-search__field {
    padding: 4px;
    width: 100%;
    box-sizing: border-box; }
    .select2-search--dropdown .select2-search__field::-webkit-search-cancel-button {
      -webkit-appearance: none; }
  .select2-search--dropdown.select2-search--hide {
    display: none; }

.select2-close-mask {
  border: 0;
  margin: 0;
  padding: 0;
  display: block;
  position: fixed;
  left: 0;
  top: 0;
  min-height: 100%;
  min-width: 100%;
  height: auto;
  width: auto;
  opacity: 0;
  z-index: 99;
  background-color: #fff;
  filter: alpha(opacity=0); }

.select2-hidden-accessible {
  border: 0 !important;
  clip: rect(0 0 0 0) !important;
  -webkit-clip-path: inset(50%) !important;
  clip-path: inset(50%) !important;
  height: 1px !important;
  overflow: hidden !important;
  padding: 0 !important;
  position: absolute !important;
  width: 1px !important;
  white-space: nowrap !important; }

.select2-container--default .select2-selection--single {
  background-color: #fff;
  border: 1px solid #aaa;
  border-radius: 4px; }
  .select2-container--default .select2-selection--single .select2-selection__rendered {
    color: #444;
    line-height: 28px; }
  .select2-container--default .select2-selection--single .select2-selection__clear {
    cursor: pointer;
    float: right;
    font-weight: bold; }
  .select2-container--default .select2-selection--single .select2-selection__placeholder {
    color: #999; }
  .select2-container--default .select2-selection--single .select2-selection__arrow {
    height: 26px;
    position: absolute;
    top: 1px;
    right: 1px;
    width: 20px; }
    .select2-container--default .select2-selection--single .select2-selection__arrow b {
      border-color: #888 transparent transparent transparent;
      border-style: solid;
      border-width: 5px 4px 0 4px;
      height: 0;
      left: 50%;
      margin-left: -4px;
      margin-top: -2px;
      position: absolute;
      top: 50%;
      width: 0; }

.select2-container--default[dir="rtl"] .select2-selection--single .select2-selection__clear {
  float: left; }

.select2-container--default[dir="rtl"] .select2-selection--single .select2-selection__arrow {
  left: 1px;
  right: auto; }

.select2-container--default.select2-container--disabled .select2-selection--single {
  background-color: #eee;
  cursor: default; }
  .select2-container--default.select2-container--disabled .select2-selection--single .select2-selection__clear {
    display: none; }

.select2-container--default.select2-container--open .select2-selection--single .select2-selection__arrow b {
  border-color: transparent transparent #888 transparent;
  border-width: 0 4px 5px 4px; }

.select2-container--default .select2-selection--multiple {
  background-color: white;
  border: 1px solid #aaa;
  border-radius: 4px;
  cursor: text; }
  .select2-container--default .select2-selection--multiple .select2-selection__rendered {
    box-sizing: border-box;
    list-style: none;
    margin: 0;
    padding: 0 5px;
    width: 100%; }
    .select2-container--default .select2-selection--multiple .select2-selection__rendered li {
      list-style: none; }
  .select2-container--default .select2-selection--multiple .select2-selection__clear {
    cursor: pointer;
    float: right;
    font-weight: bold;
    margin-top: 5px;
    margin-right: 10px;
    padding: 1px; }
  .select2-container--default .select2-selection--multiple .select2-selection__choice {
    background-color: #e4e4e4;
    border: 1px solid #aaa;
    border-radius: 4px;
    cursor: default;
    float: left;
    margin-right: 5px;
    margin-top: 5px;
    padding: 0 5px; }
  .select2-container--default .select2-selection--multiple .select2-selection__choice__remove {
    color: #999;
    cursor: pointer;
    display: inline-block;
    font-weight: bold;
    margin-right: 2px; }
    .select2-container--default .select2-selection--multiple .select2-selection__choice__remove:hover {
      color: #333; }

.select2-container--default[dir="rtl"] .select2-selection--multiple .select2-selection__choice, .select2-container--default[dir="rtl"] .select2-selection--multiple .select2-search--inline {
  float: right; }

.select2-container--default[dir="rtl"] .select2-selection--multiple .select2-selection__choice {
  margin-left: 5px;
  margin-right: auto; }

.select2-container--default[dir="rtl"] .select2-selection--multiple .select2-selection__choice__remove {
  margin-left: 2px;
  margin-right: auto; }

.select2-container--default.select2-container--focus .select2-selection--multiple {
  border: solid black 1px;
  outline: 0; }

.select2-container--default.select2-container--disabled .select2-selection--multiple {
  background-color: #eee;
  cursor: default; }

.select2-container--default.select2-container--disabled .select2-selection__choice__remove {
  display: none; }

.select2-container--default.select2-container--open.select2-container--above .select2-selection--single, .select2-container--default.select2-container--open.select2-container--above .select2-selection--multiple {
  border-top-left-radius: 0;
  border-top-right-radius: 0; }

.select2-container--default.select2-container--open.select2-container--below .select2-selection--single, .select2-container--default.select2-container--open.select2-container--below .select2-selection--multiple {
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0; }

.select2-container--default .select2-search--dropdown .select2-search__field {
  border: 1px solid #aaa; }

.select2-container--default .select2-search--inline .select2-search__field {
  background: transparent;
  border: none;
  outline: 0;
  box-shadow: none;
  -webkit-appearance: textfield; }

.select2-container--default .select2-results > .select2-results__options {
  max-height: 200px;
  overflow-y: auto; }

.select2-container--default .select2-results__option[role=group] {
  padding: 0; }

.select2-container--default .select2-results__option[aria-disabled=true] {
  color: #999; }

.select2-container--default .select2-results__option[aria-selected=true] {
  background-color: #ddd; }

.select2-container--default .select2-results__option .select2-results__option {
  padding-left: 1em; }
  .select2-container--default .select2-results__option .select2-results__option .select2-results__group {
    padding-left: 0; }
  .select2-container--default .select2-results__option .select2-results__option .select2-results__option {
    margin-left: -1em;
    padding-left: 2em; }
    .select2-container--default .select2-results__option .select2-results__option .select2-results__option .select2-results__option {
      margin-left: -2em;
      padding-left: 3em; }
      .select2-container--default .select2-results__option .select2-results__option .select2-results__option .select2-results__option .select2-results__option {
        margin-left: -3em;
        padding-left: 4em; }
        .select2-container--default .select2-results__option .select2-results__option .select2-results__option .select2-results__option .select2-results__option .select2-results__option {
          margin-left: -4em;
          padding-left: 5em; }
          .select2-container--default .select2-results__option .select2-results__option .select2-results__option .select2-results__option .select2-results__option .select2-results__option .select2-results__option {
            margin-left: -5em;
            padding-left: 6em; }

.select2-container--default .select2-results__option--highlighted[aria-selected] {
  background-color: #5897fb;
  color: white; }

.select2-container--default .select2-results__group {
  cursor: default;
  display: block;
  padding: 6px; }

.select2-container--classic .select2-selection--single {
  background-color: #f7f7f7;
  border: 1px solid #aaa;
  border-radius: 4px;
  outline: 0;
  background-image: -webkit-linear-gradient(top, white 50%, #eeeeee 100%);
  background-image: -o-linear-gradient(top, white 50%, #eeeeee 100%);
  background-image: linear-gradient(to bottom, white 50%, #eeeeee 100%);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFFFFFFF', endColorstr='#FFEEEEEE', GradientType=0); }
  .select2-container--classic .select2-selection--single:focus {
    border: 1px solid #5897fb; }
  .select2-container--classic .select2-selection--single .select2-selection__rendered {
    color: #444;
    line-height: 28px; }
  .select2-container--classic .select2-selection--single .select2-selection__clear {
    cursor: pointer;
    float: right;
    font-weight: bold;
    margin-right: 10px; }
  .select2-container--classic .select2-selection--single .select2-selection__placeholder {
    color: #999; }
  .select2-container--classic .select2-selection--single .select2-selection__arrow {
    background-color: #ddd;
    border: none;
    border-left: 1px solid #aaa;
    border-top-right-radius: 4px;
    border-bottom-right-radius: 4px;
    height: 26px;
    position: absolute;
    top: 1px;
    right: 1px;
    width: 20px;
    background-image: -webkit-linear-gradient(top, #eeeeee 50%, #cccccc 100%);
    background-image: -o-linear-gradient(top, #eeeeee 50%, #cccccc 100%);
    background-image: linear-gradient(to bottom, #eeeeee 50%, #cccccc 100%);
    background-repeat: repeat-x;
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFEEEEEE', endColorstr='#FFCCCCCC', GradientType=0); }
    .select2-container--classic .select2-selection--single .select2-selection__arrow b {
      border-color: #888 transparent transparent transparent;
      border-style: solid;
      border-width: 5px 4px 0 4px;
      height: 0;
      left: 50%;
      margin-left: -4px;
      margin-top: -2px;
      position: absolute;
      top: 50%;
      width: 0; }

.select2-container--classic[dir="rtl"] .select2-selection--single .select2-selection__clear {
  float: left; }

.select2-container--classic[dir="rtl"] .select2-selection--single .select2-selection__arrow {
  border: none;
  border-right: 1px solid #aaa;
  border-radius: 0;
  border-top-left-radius: 4px;
  border-bottom-left-radius: 4px;
  left: 1px;
  right: auto; }

.select2-container--classic.select2-container--open .select2-selection--single {
  border: 1px solid #5897fb; }
  .select2-container--classic.select2-container--open .select2-selection--single .select2-selection__arrow {
    background: transparent;
    border: none; }
    .select2-container--classic.select2-container--open .select2-selection--single .select2-selection__arrow b {
      border-color: transparent transparent #888 transparent;
      border-width: 0 4px 5px 4px; }

.select2-container--classic.select2-container--open.select2-container--above .select2-selection--single {
  border-top: none;
  border-top-left-radius: 0;
  border-top-right-radius: 0;
  background-image: -webkit-linear-gradient(top, white 0%, #eeeeee 50%);
  background-image: -o-linear-gradient(top, white 0%, #eeeeee 50%);
  background-image: linear-gradient(to bottom, white 0%, #eeeeee 50%);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFFFFFFF', endColorstr='#FFEEEEEE', GradientType=0); }

.select2-container--classic.select2-container--open.select2-container--below .select2-selection--single {
  border-bottom: none;
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0;
  background-image: -webkit-linear-gradient(top, #eeeeee 50%, white 100%);
  background-image: -o-linear-gradient(top, #eeeeee 50%, white 100%);
  background-image: linear-gradient(to bottom, #eeeeee 50%, white 100%);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFEEEEEE', endColorstr='#FFFFFFFF', GradientType=0); }

.select2-container--classic .select2-selection--multiple {
  background-color: white;
  border: 1px solid #aaa;
  border-radius: 4px;
  cursor: text;
  outline: 0; }
  .select2-container--classic .select2-selection--multiple:focus {
    border: 1px solid #5897fb; }
  .select2-container--classic .select2-selection--multiple .select2-selection__rendered {
    list-style: none;
    margin: 0;
    padding: 0 5px; }
  .select2-container--classic .select2-selection--multiple .select2-selection__clear {
    display: none; }
  .select2-container--classic .select2-selection--multiple .select2-selection__choice {
    background-color: #e4e4e4;
    border: 1px solid #aaa;
    border-radius: 4px;
    cursor: default;
    float: left;
    margin-right: 5px;
    margin-top: 5px;
    padding: 0 5px; }
  .select2-container--classic .select2-selection--multiple .select2-selection__choice__remove {
    color: #888;
    cursor: pointer;
    display: inline-block;
    font-weight: bold;
    margin-right: 2px; }
    .select2-container--classic .select2-selection--multiple .select2-selection__choice__remove:hover {
      color: #555; }

.select2-container--classic[dir="rtl"] .select2-selection--multiple .select2-selection__choice {
  float: right;
  margin-left: 5px;
  margin-right: auto; }

.select2-container--classic[dir="rtl"] .select2-selection--multiple .select2-selection__choice__remove {
  margin-left: 2px;
  margin-right: auto; }

.select2-container--classic.select2-container--open .select2-selection--multiple {
  border: 1px solid #5897fb; }

.select2-container--classic.select2-container--open.select2-container--above .select2-selection--multiple {
  border-top: none;
  border-top-left-radius: 0;
  border-top-right-radius: 0; }

.select2-container--classic.select2-container--open.select2-container--below .select2-selection--multiple {
  border-bottom: none;
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0; }

.select2-container--classic .select2-search--dropdown .select2-search__field {
  border: 1px solid #aaa;
  outline: 0; }

.select2-container--classic .select2-search--inline .select2-search__field {
  outline: 0;
  box-shadow: none; }

.select2-container--classic .select2-dropdown {
  background-color: white;
  border: 1px solid transparent; }

.select2-container--classic .select2-dropdown--above {
  border-bottom: none; }

.select2-container--classic .select2-dropdown--below {
  border-top: none; }

.select2-container--classic .select2-results > .select2-results__options {
  max-height: 200px;
  overflow-y: auto; }

.select2-container--classic .select2-results__option[role=group] {
  padding: 0; }

.select2-container--classic .select2-results__option[aria-disabled=true] {
  color: grey; }

.select2-container--classic .select2-results__option--highlighted[aria-selected] {
  background-color: #3875d7;
  color: white; }

.select2-container--classic .select2-results__group {
  cursor: default;
  display: block;
  padding: 6px; }

.select2-container--classic.select2-container--open .select2-dropdown {
  border-color: #5897fb; }

```

</details>


---

### 📄 `static/admin/css/vendor/select2/select2.min.css` [14.966 octets]
<a id="static-admin-css-vendor-select2-select2-min-css"></a> [↩ Retour à l'arborescence](#tree-static-admin-css-vendor-select2-select2-min-css)

> **Chemin relatif** : `static/admin/css/vendor/select2/select2.min.css`  
> **Taille** : 14.966 octets  
> **Lignes** : 2  
> **Type** : css

```css
.select2-container{box-sizing:border-box;display:inline-block;margin:0;position:relative;vertical-align:middle}.select2-container .select2-selection--single{box-sizing:border-box;cursor:pointer;display:block;height:28px;user-select:none;-webkit-user-select:none}.select2-container .select2-selection--single .select2-selection__rendered{display:block;padding-left:8px;padding-right:20px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.select2-container .select2-selection--single .select2-selection__clear{position:relative}.select2-container[dir="rtl"] .select2-selection--single .select2-selection__rendered{padding-right:8px;padding-left:20px}.select2-container .select2-selection--multiple{box-sizing:border-box;cursor:pointer;display:block;min-height:32px;user-select:none;-webkit-user-select:none}.select2-container .select2-selection--multiple .select2-selection__rendered{display:inline-block;overflow:hidden;padding-left:8px;text-overflow:ellipsis;white-space:nowrap}.select2-container .select2-search--inline{float:left}.select2-container .select2-search--inline .select2-search__field{box-sizing:border-box;border:none;font-size:100%;margin-top:5px;padding:0}.select2-container .select2-search--inline .select2-search__field::-webkit-search-cancel-button{-webkit-appearance:none}.select2-dropdown{background-color:white;border:1px solid #aaa;border-radius:4px;box-sizing:border-box;display:block;position:absolute;left:-100000px;width:100%;z-index:1051}.select2-results{display:block}.select2-results__options{list-style:none;margin:0;padding:0}.select2-results__option{padding:6px;user-select:none;-webkit-user-select:none}.select2-results__option[aria-selected]{cursor:pointer}.select2-container--open .select2-dropdown{left:0}.select2-container--open .select2-dropdown--above{border-bottom:none;border-bottom-left-radius:0;border-bottom-right-radius:0}.select2-container--open .select2-dropdown--below{border-top:none;border-top-left-radius:0;border-top-right-radius:0}.select2-search--dropdown{display:block;padding:4px}.select2-search--dropdown .select2-search__field{padding:4px;width:100%;box-sizing:border-box}.select2-search--dropdown .select2-search__field::-webkit-search-cancel-button{-webkit-appearance:none}.select2-search--dropdown.select2-search--hide{display:none}.select2-close-mask{border:0;margin:0;padding:0;display:block;position:fixed;left:0;top:0;min-height:100%;min-width:100%;height:auto;width:auto;opacity:0;z-index:99;background-color:#fff;filter:alpha(opacity=0)}.select2-hidden-accessible{border:0 !important;clip:rect(0 0 0 0) !important;-webkit-clip-path:inset(50%) !important;clip-path:inset(50%) !important;height:1px !important;overflow:hidden !important;padding:0 !important;position:absolute !important;width:1px !important;white-space:nowrap !important}.select2-container--default .select2-selection--single{background-color:#fff;border:1px solid #aaa;border-radius:4px}.select2-container--default .select2-selection--single .select2-selection__rendered{color:#444;line-height:28px}.select2-container--default .select2-selection--single .select2-selection__clear{cursor:pointer;float:right;font-weight:bold}.select2-container--default .select2-selection--single .select2-selection__placeholder{color:#999}.select2-container--default .select2-selection--single .select2-selection__arrow{height:26px;position:absolute;top:1px;right:1px;width:20px}.select2-container--default .select2-selection--single .select2-selection__arrow b{border-color:#888 transparent transparent transparent;border-style:solid;border-width:5px 4px 0 4px;height:0;left:50%;margin-left:-4px;margin-top:-2px;position:absolute;top:50%;width:0}.select2-container--default[dir="rtl"] .select2-selection--single .select2-selection__clear{float:left}.select2-container--default[dir="rtl"] .select2-selection--single .select2-selection__arrow{left:1px;right:auto}.select2-container--default.select2-container--disabled .select2-selection--single{background-color:#eee;cursor:default}.select2-container--default.select2-container--disabled .select2-selection--single .select2-selection__clear{display:none}.select2-container--default.select2-container--open .select2-selection--single .select2-selection__arrow b{border-color:transparent transparent #888 transparent;border-width:0 4px 5px 4px}.select2-container--default .select2-selection--multiple{background-color:white;border:1px solid #aaa;border-radius:4px;cursor:text}.select2-container--default .select2-selection--multiple .select2-selection__rendered{box-sizing:border-box;list-style:none;margin:0;padding:0 5px;width:100%}.select2-container--default .select2-selection--multiple .select2-selection__rendered li{list-style:none}.select2-container--default .select2-selection--multiple .select2-selection__clear{cursor:pointer;float:right;font-weight:bold;margin-top:5px;margin-right:10px;padding:1px}.select2-container--default .select2-selection--multiple .select2-selection__choice{background-color:#e4e4e4;border:1px solid #aaa;border-radius:4px;cursor:default;float:left;margin-right:5px;margin-top:5px;padding:0 5px}.select2-container--default .select2-selection--multiple .select2-selection__choice__remove{color:#999;cursor:pointer;display:inline-block;font-weight:bold;margin-right:2px}.select2-container--default .select2-selection--multiple .select2-selection__choice__remove:hover{color:#333}.select2-container--default[dir="rtl"] .select2-selection--multiple .select2-selection__choice,.select2-container--default[dir="rtl"] .select2-selection--multiple .select2-search--inline{float:right}.select2-container--default[dir="rtl"] .select2-selection--multiple .select2-selection__choice{margin-left:5px;margin-right:auto}.select2-container--default[dir="rtl"] .select2-selection--multiple .select2-selection__choice__remove{margin-left:2px;margin-right:auto}.select2-container--default.select2-container--focus .select2-selection--multiple{border:solid black 1px;outline:0}.select2-container--default.select2-container--disabled .select2-selection--multiple{background-color:#eee;cursor:default}.select2-container--default.select2-container--disabled .select2-selection__choice__remove{display:none}.select2-container--default.select2-container--open.select2-container--above .select2-selection--single,.select2-container--default.select2-container--open.select2-container--above .select2-selection--multiple{border-top-left-radius:0;border-top-right-radius:0}.select2-container--default.select2-container--open.select2-container--below .select2-selection--single,.select2-container--default.select2-container--open.select2-container--below .select2-selection--multiple{border-bottom-left-radius:0;border-bottom-right-radius:0}.select2-container--default .select2-search--dropdown .select2-search__field{border:1px solid #aaa}.select2-container--default .select2-search--inline .select2-search__field{background:transparent;border:none;outline:0;box-shadow:none;-webkit-appearance:textfield}.select2-container--default .select2-results>.select2-results__options{max-height:200px;overflow-y:auto}.select2-container--default .select2-results__option[role=group]{padding:0}.select2-container--default .select2-results__option[aria-disabled=true]{color:#999}.select2-container--default .select2-results__option[aria-selected=true]{background-color:#ddd}.select2-container--default .select2-results__option .select2-results__option{padding-left:1em}.select2-container--default .select2-results__option .select2-results__option .select2-results__group{padding-left:0}.select2-container--default .select2-results__option .select2-results__option .select2-results__option{margin-left:-1em;padding-left:2em}.select2-container--default .select2-results__option .select2-results__option .select2-results__option .select2-results__option{margin-left:-2em;padding-left:3em}.select2-container--default .select2-results__option .select2-results__option .select2-results__option .select2-results__option .select2-results__option{margin-left:-3em;padding-left:4em}.select2-container--default .select2-results__option .select2-results__option .select2-results__option .select2-results__option .select2-results__option .select2-results__option{margin-left:-4em;padding-left:5em}.select2-container--default .select2-results__option .select2-results__option .select2-results__option .select2-results__option .select2-results__option .select2-results__option .select2-results__option{margin-left:-5em;padding-left:6em}.select2-container--default .select2-results__option--highlighted[aria-selected]{background-color:#5897fb;color:white}.select2-container--default .select2-results__group{cursor:default;display:block;padding:6px}.select2-container--classic .select2-selection--single{background-color:#f7f7f7;border:1px solid #aaa;border-radius:4px;outline:0;background-image:-webkit-linear-gradient(top, #fff 50%, #eee 100%);background-image:-o-linear-gradient(top, #fff 50%, #eee 100%);background-image:linear-gradient(to bottom, #fff 50%, #eee 100%);background-repeat:repeat-x;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFFFFFFF', endColorstr='#FFEEEEEE', GradientType=0)}.select2-container--classic .select2-selection--single:focus{border:1px solid #5897fb}.select2-container--classic .select2-selection--single .select2-selection__rendered{color:#444;line-height:28px}.select2-container--classic .select2-selection--single .select2-selection__clear{cursor:pointer;float:right;font-weight:bold;margin-right:10px}.select2-container--classic .select2-selection--single .select2-selection__placeholder{color:#999}.select2-container--classic .select2-selection--single .select2-selection__arrow{background-color:#ddd;border:none;border-left:1px solid #aaa;border-top-right-radius:4px;border-bottom-right-radius:4px;height:26px;position:absolute;top:1px;right:1px;width:20px;background-image:-webkit-linear-gradient(top, #eee 50%, #ccc 100%);background-image:-o-linear-gradient(top, #eee 50%, #ccc 100%);background-image:linear-gradient(to bottom, #eee 50%, #ccc 100%);background-repeat:repeat-x;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFEEEEEE', endColorstr='#FFCCCCCC', GradientType=0)}.select2-container--classic .select2-selection--single .select2-selection__arrow b{border-color:#888 transparent transparent transparent;border-style:solid;border-width:5px 4px 0 4px;height:0;left:50%;margin-left:-4px;margin-top:-2px;position:absolute;top:50%;width:0}.select2-container--classic[dir="rtl"] .select2-selection--single .select2-selection__clear{float:left}.select2-container--classic[dir="rtl"] .select2-selection--single .select2-selection__arrow{border:none;border-right:1px solid #aaa;border-radius:0;border-top-left-radius:4px;border-bottom-left-radius:4px;left:1px;right:auto}.select2-container--classic.select2-container--open .select2-selection--single{border:1px solid #5897fb}.select2-container--classic.select2-container--open .select2-selection--single .select2-selection__arrow{background:transparent;border:none}.select2-container--classic.select2-container--open .select2-selection--single .select2-selection__arrow b{border-color:transparent transparent #888 transparent;border-width:0 4px 5px 4px}.select2-container--classic.select2-container--open.select2-container--above .select2-selection--single{border-top:none;border-top-left-radius:0;border-top-right-radius:0;background-image:-webkit-linear-gradient(top, #fff 0%, #eee 50%);background-image:-o-linear-gradient(top, #fff 0%, #eee 50%);background-image:linear-gradient(to bottom, #fff 0%, #eee 50%);background-repeat:repeat-x;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFFFFFFF', endColorstr='#FFEEEEEE', GradientType=0)}.select2-container--classic.select2-container--open.select2-container--below .select2-selection--single{border-bottom:none;border-bottom-left-radius:0;border-bottom-right-radius:0;background-image:-webkit-linear-gradient(top, #eee 50%, #fff 100%);background-image:-o-linear-gradient(top, #eee 50%, #fff 100%);background-image:linear-gradient(to bottom, #eee 50%, #fff 100%);background-repeat:repeat-x;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFEEEEEE', endColorstr='#FFFFFFFF', GradientType=0)}.select2-container--classic .select2-selection--multiple{background-color:white;border:1px solid #aaa;border-radius:4px;cursor:text;outline:0}.select2-container--classic .select2-selection--multiple:focus{border:1px solid #5897fb}.select2-container--classic .select2-selection--multiple .select2-selection__rendered{list-style:none;margin:0;padding:0 5px}.select2-container--classic .select2-selection--multiple .select2-selection__clear{display:none}.select2-container--classic .select2-selection--multiple .select2-selection__choice{background-color:#e4e4e4;border:1px solid #aaa;border-radius:4px;cursor:default;float:left;margin-right:5px;margin-top:5px;padding:0 5px}.select2-container--classic .select2-selection--multiple .select2-selection__choice__remove{color:#888;cursor:pointer;display:inline-block;font-weight:bold;margin-right:2px}.select2-container--classic .select2-selection--multiple .select2-selection__choice__remove:hover{color:#555}.select2-container--classic[dir="rtl"] .select2-selection--multiple .select2-selection__choice{float:right;margin-left:5px;margin-right:auto}.select2-container--classic[dir="rtl"] .select2-selection--multiple .select2-selection__choice__remove{margin-left:2px;margin-right:auto}.select2-container--classic.select2-container--open .select2-selection--multiple{border:1px solid #5897fb}.select2-container--classic.select2-container--open.select2-container--above .select2-selection--multiple{border-top:none;border-top-left-radius:0;border-top-right-radius:0}.select2-container--classic.select2-container--open.select2-container--below .select2-selection--multiple{border-bottom:none;border-bottom-left-radius:0;border-bottom-right-radius:0}.select2-container--classic .select2-search--dropdown .select2-search__field{border:1px solid #aaa;outline:0}.select2-container--classic .select2-search--inline .select2-search__field{outline:0;box-shadow:none}.select2-container--classic .select2-dropdown{background-color:#fff;border:1px solid transparent}.select2-container--classic .select2-dropdown--above{border-bottom:none}.select2-container--classic .select2-dropdown--below{border-top:none}.select2-container--classic .select2-results>.select2-results__options{max-height:200px;overflow-y:auto}.select2-container--classic .select2-results__option[role=group]{padding:0}.select2-container--classic .select2-results__option[aria-disabled=true]{color:grey}.select2-container--classic .select2-results__option--highlighted[aria-selected]{background-color:#3875d7;color:#fff}.select2-container--classic .select2-results__group{cursor:default;display:block;padding:6px}.select2-container--classic.select2-container--open .select2-dropdown{border-color:#5897fb}

```


---

### 📄 `static/admin/css/widgets.css` [11.900 octets]
<a id="static-admin-css-widgets-css"></a> [↩ Retour à l'arborescence](#tree-static-admin-css-widgets-css)

> **Chemin relatif** : `static/admin/css/widgets.css`  
> **Taille** : 11.900 octets  
> **Lignes** : 604  
> **Type** : css

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (604 lignes) - Cliquer pour déplier</summary>

```css
/* SELECTOR (FILTER INTERFACE) */

.selector {
    width: 800px;
    float: left;
    display: flex;
}

.selector select {
    width: 380px;
    height: 17.2em;
    flex: 1 0 auto;
}

.selector-available, .selector-chosen {
    width: 380px;
    text-align: center;
    margin-bottom: 5px;
    display: flex;
    flex-direction: column;
}

.selector-available h2, .selector-chosen h2 {
    border: 1px solid var(--border-color);
    border-radius: 4px 4px 0 0;
}

.selector-chosen .list-footer-display {
    border: 1px solid var(--border-color);
    border-top: none;
    border-radius: 0 0 4px 4px;
    margin: 0 0 10px;
    padding: 8px;
    text-align: center;
    background: var(--primary);
    color: var(--header-link-color);
    cursor: pointer;
}
.selector-chosen .list-footer-display__clear {
    color: var(--breadcrumbs-fg);
}

.selector-chosen h2 {
    background: var(--primary);
    color: var(--header-link-color);
}

.selector .selector-available h2 {
    background: var(--darkened-bg);
    color: var(--body-quiet-color);
}

.selector .selector-filter {
    border: 1px solid var(--border-color);
    border-width: 0 1px;
    padding: 8px;
    color: var(--body-quiet-color);
    font-size: 0.625rem;
    margin: 0;
    text-align: left;
}

.selector .selector-filter label,
.inline-group .aligned .selector .selector-filter label {
    float: left;
    margin: 7px 0 0;
    width: 18px;
    height: 18px;
    padding: 0;
    overflow: hidden;
    line-height: 1;
}

.selector .selector-available input,
.selector .selector-chosen input {
    width: 320px;
    margin-left: 8px;
}

.selector ul.selector-chooser {
    align-self: center;
    width: 22px;
    background-color: var(--selected-bg);
    border-radius: 10px;
    margin: 0 5px;
    padding: 0;
    transform: translateY(-17px);
}

.selector-chooser li {
    margin: 0;
    padding: 3px;
    list-style-type: none;
}

.selector select {
    padding: 0 10px;
    margin: 0 0 10px;
    border-radius: 0 0 4px 4px;
}
.selector .selector-chosen--with-filtered select {
    margin: 0;
    border-radius: 0;
    height: 14em;
}

.selector .selector-chosen:not(.selector-chosen--with-filtered) .list-footer-display {
    display: none;
}

.selector-add, .selector-remove {
    width: 16px;
    height: 16px;
    display: block;
    text-indent: -3000px;
    overflow: hidden;
    cursor: default;
    opacity: 0.55;
}

.active.selector-add, .active.selector-remove {
    opacity: 1;
}

.active.selector-add:hover, .active.selector-remove:hover {
    cursor: pointer;
}

.selector-add {
    background: url(../img/selector-icons.svg) 0 -96px no-repeat;
}

.active.selector-add:focus, .active.selector-add:hover {
    background-position: 0 -112px;
}

.selector-remove {
    background: url(../img/selector-icons.svg) 0 -64px no-repeat;
}

.active.selector-remove:focus, .active.selector-remove:hover {
    background-position: 0 -80px;
}

a.selector-chooseall, a.selector-clearall {
    display: inline-block;
    height: 16px;
    text-align: left;
    margin: 1px auto 3px;
    overflow: hidden;
    font-weight: bold;
    line-height: 16px;
    color: var(--body-quiet-color);
    text-decoration: none;
    opacity: 0.55;
}

a.active.selector-chooseall:focus, a.active.selector-clearall:focus,
a.active.selector-chooseall:hover, a.active.selector-clearall:hover {
    color: var(--link-fg);
}

a.active.selector-chooseall, a.active.selector-clearall {
    opacity: 1;
}

a.active.selector-chooseall:hover, a.active.selector-clearall:hover {
    cursor: pointer;
}

a.selector-chooseall {
    padding: 0 18px 0 0;
    background: url(../img/selector-icons.svg) right -160px no-repeat;
    cursor: default;
}

a.active.selector-chooseall:focus, a.active.selector-chooseall:hover {
    background-position: 100% -176px;
}

a.selector-clearall {
    padding: 0 0 0 18px;
    background: url(../img/selector-icons.svg) 0 -128px no-repeat;
    cursor: default;
}

a.active.selector-clearall:focus, a.active.selector-clearall:hover {
    background-position: 0 -144px;
}

/* STACKED SELECTORS */

.stacked {
    float: left;
    width: 490px;
    display: block;
}

.stacked select {
    width: 480px;
    height: 10.1em;
}

.stacked .selector-available, .stacked .selector-chosen {
    width: 480px;
}

.stacked .selector-available {
    margin-bottom: 0;
}

.stacked .selector-available input {
    width: 422px;
}

.stacked ul.selector-chooser {
    height: 22px;
    width: 50px;
    margin: 0 0 10px 40%;
    background-color: #eee;
    border-radius: 10px;
    transform: none;
}

.stacked .selector-chooser li {
    float: left;
    padding: 3px 3px 3px 5px;
}

.stacked .selector-chooseall, .stacked .selector-clearall {
    display: none;
}

.stacked .selector-add {
    background: url(../img/selector-icons.svg) 0 -32px no-repeat;
    cursor: default;
}

.stacked .active.selector-add {
    background-position: 0 -32px;
    cursor: pointer;
}

.stacked .active.selector-add:focus, .stacked .active.selector-add:hover {
    background-position: 0 -48px;
    cursor: pointer;
}

.stacked .selector-remove {
    background: url(../img/selector-icons.svg) 0 0 no-repeat;
    cursor: default;
}

.stacked .active.selector-remove {
    background-position: 0 0px;
    cursor: pointer;
}

.stacked .active.selector-remove:focus, .stacked .active.selector-remove:hover {
    background-position: 0 -16px;
    cursor: pointer;
}

.selector .help-icon {
    background: url(../img/icon-unknown.svg) 0 0 no-repeat;
    display: inline-block;
    vertical-align: middle;
    margin: -2px 0 0 2px;
    width: 13px;
    height: 13px;
}

.selector .selector-chosen .help-icon {
    background: url(../img/icon-unknown-alt.svg) 0 0 no-repeat;
}

.selector .search-label-icon {
    background: url(../img/search.svg) 0 0 no-repeat;
    display: inline-block;
    height: 1.125rem;
    width: 1.125rem;
}

/* DATE AND TIME */

p.datetime {
    line-height: 20px;
    margin: 0;
    padding: 0;
    color: var(--body-quiet-color);
    font-weight: bold;
}

.datetime span {
    white-space: nowrap;
    font-weight: normal;
    font-size: 0.6875rem;
    color: var(--body-quiet-color);
}

.datetime input, .form-row .datetime input.vDateField, .form-row .datetime input.vTimeField {
    margin-left: 5px;
    margin-bottom: 4px;
}

table p.datetime {
    font-size: 0.6875rem;
    margin-left: 0;
    padding-left: 0;
}

.datetimeshortcuts .clock-icon, .datetimeshortcuts .date-icon {
    position: relative;
    display: inline-block;
    vertical-align: middle;
    height: 16px;
    width: 16px;
    overflow: hidden;
}

.datetimeshortcuts .clock-icon {
    background: url(../img/icon-clock.svg) 0 0 no-repeat;
}

.datetimeshortcuts a:focus .clock-icon,
.datetimeshortcuts a:hover .clock-icon {
    background-position: 0 -16px;
}

.datetimeshortcuts .date-icon {
    background: url(../img/icon-calendar.svg) 0 0 no-repeat;
    top: -1px;
}

.datetimeshortcuts a:focus .date-icon,
.datetimeshortcuts a:hover .date-icon {
    background-position: 0 -16px;
}

.timezonewarning {
    font-size: 0.6875rem;
    color: var(--body-quiet-color);
}

/* URL */

p.url {
    line-height: 20px;
    margin: 0;
    padding: 0;
    color: var(--body-quiet-color);
    font-size: 0.6875rem;
    font-weight: bold;
}

.url a {
    font-weight: normal;
}

/* FILE UPLOADS */

p.file-upload {
    line-height: 20px;
    margin: 0;
    padding: 0;
    color: var(--body-quiet-color);
    font-size: 0.6875rem;
    font-weight: bold;
}

.file-upload a {
    font-weight: normal;
}

.file-upload .deletelink {
    margin-left: 5px;
}

span.clearable-file-input label {
    color: var(--body-fg);
    font-size: 0.6875rem;
    display: inline;
    float: none;
}

/* CALENDARS & CLOCKS */

.calendarbox, .clockbox {
    margin: 5px auto;
    font-size: 0.75rem;
    width: 19em;
    text-align: center;
    background: var(--body-bg);
    color: var(--body-fg);
    border: 1px solid var(--hairline-color);
    border-radius: 4px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
    overflow: hidden;
    position: relative;
}

.clockbox {
    width: auto;
}

.calendar {
    margin: 0;
    padding: 0;
}

.calendar table {
    margin: 0;
    padding: 0;
    border-collapse: collapse;
    background: white;
    width: 100%;
}

.calendar caption, .calendarbox h2 {
    margin: 0;
    text-align: center;
    border-top: none;
    font-weight: 700;
    font-size: 0.75rem;
    color: #333;
    background: var(--accent);
}

.calendar th {
    padding: 8px 5px;
    background: var(--darkened-bg);
    border-bottom: 1px solid var(--border-color);
    font-weight: 400;
    font-size: 0.75rem;
    text-align: center;
    color: var(--body-quiet-color);
}

.calendar td {
    font-weight: 400;
    font-size: 0.75rem;
    text-align: center;
    padding: 0;
    border-top: 1px solid var(--hairline-color);
    border-bottom: none;
}

.calendar td.selected a {
    background: var(--primary);
    color: var(--button-fg);
}

.calendar td.nonday {
    background: var(--darkened-bg);
}

.calendar td.today a {
    font-weight: 700;
}

.calendar td a, .timelist a {
    display: block;
    font-weight: 400;
    padding: 6px;
    text-decoration: none;
    color: var(--body-quiet-color);
}

.calendar td a:focus, .timelist a:focus,
.calendar td a:hover, .timelist a:hover {
    background: var(--primary);
    color: white;
}

.calendar td a:active, .timelist a:active {
    background: var(--header-bg);
    color: white;
}

.calendarnav {
    font-size: 0.625rem;
    text-align: center;
    color: #ccc;
    margin: 0;
    padding: 1px 3px;
}

.calendarnav a:link, #calendarnav a:visited,
#calendarnav a:focus, #calendarnav a:hover {
    color: var(--body-quiet-color);
}

.calendar-shortcuts {
    background: var(--body-bg);
    color: var(--body-quiet-color);
    font-size: 0.6875rem;
    line-height: 0.6875rem;
    border-top: 1px solid var(--hairline-color);
    padding: 8px 0;
}

.calendarbox .calendarnav-previous, .calendarbox .calendarnav-next {
    display: block;
    position: absolute;
    top: 8px;
    width: 15px;
    height: 15px;
    text-indent: -9999px;
    padding: 0;
}

.calendarnav-previous {
    left: 10px;
    background: url(../img/calendar-icons.svg) 0 0 no-repeat;
}

.calendarbox .calendarnav-previous:focus,
.calendarbox .calendarnav-previous:hover {
    background-position: 0 -15px;
}

.calendarnav-next {
    right: 10px;
    background: url(../img/calendar-icons.svg) 0 -30px no-repeat;
}

.calendarbox .calendarnav-next:focus,
.calendarbox .calendarnav-next:hover {
    background-position: 0 -45px;
}

.calendar-cancel {
    margin: 0;
    padding: 4px 0;
    font-size: 0.75rem;
    background: #eee;
    border-top: 1px solid var(--border-color);
    color: var(--body-fg);
}

.calendar-cancel:focus, .calendar-cancel:hover {
    background: #ddd;
}

.calendar-cancel a {
    color: black;
    display: block;
}

ul.timelist, .timelist li {
    list-style-type: none;
    margin: 0;
    padding: 0;
}

.timelist a {
    padding: 2px;
}

/* EDIT INLINE */

.inline-deletelink {
    float: right;
    text-indent: -9999px;
    background: url(../img/inline-delete.svg) 0 0 no-repeat;
    width: 16px;
    height: 16px;
    border: 0px none;
}

.inline-deletelink:focus, .inline-deletelink:hover {
    cursor: pointer;
}

/* RELATED WIDGET WRAPPER */
.related-widget-wrapper {
    float: left;       /* display properly in form rows with multiple fields */
    overflow: hidden;  /* clear floated contents */
}

.related-widget-wrapper-link {
    opacity: 0.3;
}

.related-widget-wrapper-link:link {
    opacity: .8;
}

.related-widget-wrapper-link:link:focus,
.related-widget-wrapper-link:link:hover {
    opacity: 1;
}

select + .related-widget-wrapper-link,
.related-widget-wrapper-link + .related-widget-wrapper-link {
    margin-left: 7px;
}

/* GIS MAPS */
.dj_map {
    width: 600px;
    height: 400px;
}

```

</details>


---

### 📄 `static/admin/img/LICENSE` [1.081 octets]
<a id="static-admin-img-LICENSE"></a> [↩ Retour à l'arborescence](#tree-static-admin-img-LICENSE)

> **Chemin relatif** : `static/admin/img/LICENSE`  
> **Taille** : 1.081 octets  
> **Lignes** : 21  
> **Type** : text

```text
The MIT License (MIT)

Copyright (c) 2014 Code Charm Ltd

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

```


---

### 📄 `static/admin/img/README.txt` [319 octets]
<a id="static-admin-img-README-txt"></a> [↩ Retour à l'arborescence](#tree-static-admin-img-README-txt)

> **Chemin relatif** : `static/admin/img/README.txt`  
> **Taille** : 319 octets  
> **Lignes** : 8  
> **Type** : text

```text
All icons are taken from Font Awesome (http://fontawesome.io/) project.
The Font Awesome font is licensed under the SIL OFL 1.1:
- https://scripts.sil.org/OFL

SVG icons source: https://github.com/encharm/Font-Awesome-SVG-PNG
Font-Awesome-SVG-PNG is licensed under the MIT license (see file license
in current folder).

```


---

### 📄 `static/admin/js/vendor/jquery/LICENSE.txt` [1.097 octets]
<a id="static-admin-js-vendor-jquery-LICENSE-txt"></a> [↩ Retour à l'arborescence](#tree-static-admin-js-vendor-jquery-LICENSE-txt)

> **Chemin relatif** : `static/admin/js/vendor/jquery/LICENSE.txt`  
> **Taille** : 1.097 octets  
> **Lignes** : 21  
> **Type** : text

```text
Copyright OpenJS Foundation and other contributors, https://openjsf.org/

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

```


---

### 📄 `static/admin/js/vendor/select2/LICENSE.md` [1.124 octets]
<a id="static-admin-js-vendor-select2-LICENSE-md"></a> [↩ Retour à l'arborescence](#tree-static-admin-js-vendor-select2-LICENSE-md)

> **Chemin relatif** : `static/admin/js/vendor/select2/LICENSE.md`  
> **Taille** : 1.124 octets  
> **Lignes** : 22  
> **Type** : markdown

```markdown
The MIT License (MIT)

Copyright (c) 2012-2017 Kevin Brown, Igor Vaynberg, and Select2 contributors

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

```


---

### 📄 `static/admin/js/vendor/xregexp/LICENSE.txt` [1.103 octets]
<a id="static-admin-js-vendor-xregexp-LICENSE-txt"></a> [↩ Retour à l'arborescence](#tree-static-admin-js-vendor-xregexp-LICENSE-txt)

> **Chemin relatif** : `static/admin/js/vendor/xregexp/LICENSE.txt`  
> **Taille** : 1.103 octets  
> **Lignes** : 22  
> **Type** : text

```text
The MIT License

Copyright (c) 2007-2017 Steven Levithan <http://xregexp.com/>

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

```


---

### 📄 `static/app/css/application/application.css` [879 octets]
<a id="static-app-css-application-application-css"></a> [↩ Retour à l'arborescence](#tree-static-app-css-application-application-css)

> **Chemin relatif** : `static/app/css/application/application.css`  
> **Taille** : 879 octets  
> **Lignes** : 51  
> **Type** : css

```css
/* Ce fichier contient les styles spécifiques à l'application ou surchargés par rapport au modèle */

#contenu form label {
  width: 300px;
}

.tableauCouleurs {
  font-weight: normal;
  border: 1px solid grey;
  border-collapse: collapse;
  width: auto;
}

.tableauCouleurs ul {
  padding-left: 15px;
  margin: 0px;
  font-weight: bold;
  font-style: normal;
}

.tableauCouleurs th {
  border: 1px solid black;
  width: 14%;
}

.tableauCouleurs td {
  border: 1px solid black;
  font-weight: bold;
  font-style: normal;
}

div#menu1 fieldset {
  clear: left;
  padding: 2px;
  margin: 2px;
  border: 1px solid #ca3353;
  background-color: #fbf2f4;
}

div#menu1 legend {
  padding: 2px;
  margin: 2px;
  border: 1px solid #ca3353;
  background-color: #fbf2f4;
}

div.blackwhite {
  color: black;
  background-color: white;
}

```


---

### 📄 `static/app/css/intranet/complet.css` [22.711 octets]
<a id="static-app-css-intranet-complet-css"></a> [↩ Retour à l'arborescence](#tree-static-app-css-intranet-complet-css)

> **Chemin relatif** : `static/app/css/intranet/complet.css`  
> **Taille** : 22.711 octets  
> **Lignes** : 1272  
> **Type** : css

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (1272 lignes) - Cliquer pour déplier</summary>

```css
div#haut {
  margin: 0px;
  padding: 0px;
  width: 100%;
  position: relative;
  z-index: 100;
}

div#conteneurmilieu {
  width: auto;
  padding: 0px 200px 0px 200px;
  position: relative;
}

div#conteneurmilieularge {
  width: auto;
  border: solid white 0px;
  background-color: white; /* couleur du centre */

  /*/*/
  border-left-width: 200px; /* left column width. NN4 hack to hide borders */
  border-left-color: white; /* couleur colonne de gauche */
  border-left-style: solid;
  position: relative;
}

div#milieu {
  margin: 0px;
  padding: 0px;
  width: 100%;
  position: relative;
}

div#milieuinterieur {
  float: left;
  position: relative;
}

div#gauche {
  margin: 0px;
  padding: 0px;
  width: 180px;
  float: left;
  position: relative;
  margin-left: -200px;
}

div#centre {
  float: left;
  width: 100%;
  position: relative;
}

div#droit {
  margin: 0px;
  padding: 0px;
  width: 180px;
  float: right;
  position: relative;
  margin-right: -200px;
  background: #fbf2f4;
}

div#bas {
  position: relative;
}

div#conteneurhaut {
  margin-right: 170px;
  position: relative;
  display: block;
  height: 100%;
}

/* placé en haut de page */
div#nomdusite {
  margin: 0px;
  background: #4b8fcc;
    top;
  height: 8em;
  padding: 0px;
  position: relative;
}

div#nomdusite p#logodusite {
  background: url("../../images/logo_mtect.jpg") no-repeat 5px 50%;
  margin: 0px;
  padding: 25px 0px 25px 140px;
  font-size: 2em;
  font-weight: bold;
  text-align: left;
  color: white;
}

/* en haut à droite */
div#telecommande {
  float: right;
  position: relative;
  margin-right: -170px;
  width: 170px;
  white-space: nowrap;
  height: 8em;
}

div#telecommande ul {
  list-style-type: none;
  margin: 0px;
  padding: 0px;
  padding-left: 3px;
}
div#telecommande li {
  line-height: 1.2em;
  font-size: 0.9em;
  background: url(../../images/structure/puce_menu_01.gif) no-repeat 0% 50%;
  padding: 0px 0px 0px 7px;
  margin: 0px;
}
div#telecommande a {
  margin: 0px;
  padding: 0px;
  font-weight: normal;
  color: black;
  text-decoration: none;
}

div#telecommande a:hover {
  text-decoration: underline;
}

/* Messages de service placé sous l'entête */
div#messagedeservice {
  position: relative;
  margin: 0px;
  padding: 0px;
  clear: both;
}

/* recherche */
div#recherche {
  width: 160px;
  font-size: 1em;
  overflow: hidden;
}

div#contenu {
  font-size: 1em;
  line-height: 1.5em;
}

div#contenu a {
  font-size: 1.1em;
  text-decoration: none;
}

div#contenu {
  width: auto;
  margin: 0px;
  padding: 0px;
  position: relative;
}

/* FIN DE LA MISE EN PAGE */
div#recherche form {
  padding: 0px;
  margin: 0px;
}

div#recherche label {
  padding: 2px;
  font-size: 1em;
  font-weight: normal;
  vertical-align: middle;
}

div#recherche fieldset {
  clear: left;
  padding: 2px;
  margin: 2px;
  border: 1px solid #ca3353;
  background-color: #fbf2f4;
}

div#recherche legend {
  padding: 2px;
  margin: 2px;
  border: 1px solid #ca3353;
  background-color: #fbf2f4;
}

div#recherche input {
  font-size: 1em;
  vertical-align: middle;
}

div#recherche form button:hover {
  color: #ca3353;
  cursor: pointer;
}

div#recherche img {
  vertical-align: middle;
}

div#recherche form button {
  border: none;
  font-weight: bold;
  text-align: left;
  font-size: 1em;
  color: #a0a0a0;
  vertical-align: middle;
}

div#messagedeservice p {
  font-size: 1.2em;
  font-weight: bold;
  text-align: center;
  padding: 0px 0px 0px 10px;
  margin: 2px;
  color: #ca3353;
}

/* pied de page sur toute la largeur */
div#pied {
  width: auto;
  position: relative;
  display: block;
  margin: 10px 5px 0px 0px;
  padding: 10px 0px 0px 0px;
}

div#pied p {
  margin: 0px;
  padding: 0px;
  color: #005fb8;
  text-decoration: none;
  font-size: 1em;
  margin-top: 1em;
}

div#pieddroit {
  padding-top: 10px;
  float: right;
}

div#pieddroit p {
  margin: 0px;
  padding: 0px;
  font-size: 2.5em;
  white-space: nowrap;
}

div#pied a {
  color: #005fb8;
}

div#pied a:hover {
  text-decoration: underline;
}

div#pied div#pieddroit a:hover {
  text-decoration: none;
}

div#outils ul {
  text-align: center;
  list-style-type: none;
  margin: 0px;
  padding: 0px;
}

div#outils li {
  position: relative;
  display: inline;
  font-size: 1em;
  font-weight: bold;
  background: transparent url(../../images/structure/puce_footer.gif) no-repeat
    5px 50%;
  margin: 0px;
  padding: 0px 0px 0px 13px;
}

div#copyright {
  color: #656565;
  margin-top: 1em;
  text-align: center;
}

/* Colonne de gauche */
div#menu1 {
  margin: 0px;
  padding: 0px;
  background-color: white;
  position: relative;
}

div#menu1 p {
  line-height: 1.7em;
  margin: 0px;
  padding: 3px 0px 3px 0px;
}

div#menu1 ul {
  list-style-type: none;
  margin: 0px;
  padding: 0px;
}

div#menu1 li {
  color: white;
  background: #ca3353;
  font-size: 1.2em;
  font-weight: bold;
  line-height: 1.7em;
  margin: 0px;
  padding: 0px;
  text-align: center;
}

div#menu1 ul ul {
  padding: 0px 0px 0px 3px;
  margin: 0px;
  background: white;
  color: black;
}
div#menu1 ul ul li {
  color: black;
  background: url(../../images/structure/puce_menu_01.gif) no-repeat 0% 50%;
  font-size: 0.8em;
  font-weight: normal;
  line-height: 1.1em;
  text-align: left;
  padding: 0px 0px 0px 7px;
}

div#menu1 a {
  font-weight: normal;
  color: black;
  text-decoration: none;
}

div#menu1 a:hover {
  text-decoration: underline;
  color: #ca3353;
}

div#menu1 form button {
  border: none;
  color: #a0a0a0;
  font-weight: bold;
  text-align: left;
  font-size: 1em;
  vertical-align: middle;
}

/* Colonne de droite */
div#menu2 {
  margin: 0px;
  padding: 0px;
  background: transparent;
  position: relative;
}

div#menu2 p {
  line-height: 1.7em;
  margin: 0px;
  padding: 3px 0px 3px 0px;
}

div#menu2 ul {
  list-style-type: none;
  margin: 0px;
  padding: 0px;
}

div#menu2 li {
  color: white;
  background-color: #ca3353;
  font-size: 1.2em;
  font-weight: bold;
  line-height: 1.7em;
  margin: 0px;
  padding: 0px;
  text-align: center;
}

div#menu2 ul li ul {
  padding: 0px 0px 0px 3px;
  margin: 0px;
  background-color: #fbf2f4;
}

div#menu2 ul li ul li {
  color: black;
  background: url(../../images/structure/puce_menu_01.gif) no-repeat 0% 50%;
  font-size: 0.8em;
  font-weight: normal;
  line-height: 1.1em;
  text-align: left;
  padding: 0px 0px 0px 7px;
}

div#menu2 a {
  font-weight: normal;
  color: black;
  text-decoration: none;
}

div#menu2 a:hover {
  text-decoration: underline;
}

div#menu2 form button:hover {
  color: #ca3353;
  cursor: pointer;
}

div#menu2 form button {
  border: none;
  color: #a0a0a0;
  font-weight: bold;
  text-align: left;
  font-size: 1em;
  vertical-align: middle;
}

div#menu2 label {
  padding: 2px;
  font-size: 1em;
  font-weight: normal;
  vertical-align: middle;
}

div#menu2 fieldset {
  clear: left;
  padding: 2px;
  margin: 2px;
  border: 1px solid #ca3353;
  background-color: #fbf2f4;
}

div#menu2 legend {
  padding: 2px;
  margin: 2px;
  border: 1px solid #ca3353;
  background-color: #fbf2f4;
}

/* barre de progression */
div#barreprogression {
  margin: 0px;
  padding: 0px;
}

div#barreprogression ul {
  position: relative;
  list-style-type: none;
  margin: 0px;
  padding: 0px;
}

div#barreprogression ul li {
  position: relative;
  display: inline;
  font-size: 1em;
  background: transparent url(../../images/structure/puce_menu_01.gif) no-repeat
    5px 50%;
  margin: 0px;
  padding: 0px;
}

div#barreprogression ul li a {
  text-decoration: underline;
  position: relative;
  padding: 0px 0px 0px 13px;
}

div#accessibilite {
  position: absolute;
  z-index: 200;
  top: 5px;
  left: 140px;
}

div#accessibilite ul {
  text-align: left;
  list-style-type: none;
  margin: 0px;
  padding: 0px;
}

div#accessibilite li {
  display: inline;
  font-size: 1em;
  margin: 0px;
  padding: 0px;
}

div#accessibilite li a {
  padding: 0px 0px 0px 13px;
}

div#accessibilite li a {
  background: transparent url(../../images/structure/puce_tool4.gif) no-repeat
    5px 50%;
}

div#accessibilite li + li a {
  background: transparent url(../../images/structure/puce_tool2.gif) no-repeat
    5px 50%;
}

div#accessibilite li + li + li a {
  background: transparent url(../../images/structure/puce_tool3.gif) no-repeat
    5px 50%;
}

div#accessibilite li + li + li + li a {
  background: transparent url(../../images/structure/puce_tool1.gif) no-repeat
    5px 50%;
}

div#accessibilite li + li + li + li + li a {
  background: transparent url(../../images/structure/puce_tool5.gif) no-repeat
    5px 50%;
}

/*
Feuille de style pour les applications intranet du METATM

Date    :18/05/2005
Auteur  :METLTM
*/

body {
  background-color: white;
  color: black;
  margin: 0px;
  width: 100%;
  font-family: Verdana, Geneva, Arial, Helvetica, sans-serif;
  font-style: normal;
  font-size: 65%;
}

a {
  color: #a0a0a0;
  font-weight: bold;
  text-decoration: none;
}

/* Changement de couleur au passage souris sur les liens */
a:active,
a:hover,
a:focus {
  color: #ca3353;
}

/* Par défaut les images n'ont pas de bordure */
a img {
  border: none;
  vertical-align: middle;
}

/* Titre de premier niveau */
h1 {
  background-color: white;
  color: #ca3353;
  font-size: 1.6em;
  font-weight: bold;
  margin: 0px;
  padding: 2px;
}

/* Titre de deuxième niveau */
h2 {
  background-color: #fbf2f4;
  color: #ca3353;
  border-top: #ca3353 1px solid;
  font-size: 1.4em;
  font-weight: bold;
  padding: 2px 2px 2px 10px;
}

/* Messages lors des erreurs de saisie ds formulaires */
.erreurSaisie {
  background-color: white;
  font-size: 1.4em;
  font-weight: bold;
  color: red;
}

table.tableau {
  border: 1px solid #ca3353;
  border-collapse: collapse;
  width: 100%;
  font-size: 1em;
}

table.tableau th {
  padding: 2px;
  background-color: #f8e5e9;
  color: #ca3353;
  border: 1px solid #ca3353;
}

table.tableau td {
  margin: 0px;
  padding: 2px;
  background-color: #fbf2f4;
  border: 1px solid #ca3353;
  color: black;
}

table.tableau tr.impair td {
  background-color: #f8e5e9;
  color: black;
}

.gauche {
  padding: 2px;
  float: left;
}

.encadre {
  padding: 2px;
  border: 1px solid;
  border-color: #ca3353;
}

.picto {
  padding: 5px 5px 5px 25px;
}

.besoin_aide {
  background: url("../../images/pictos/picto_besoin_aide.gif") no-repeat 2px 50%;
}

.plan_site {
  background: url("../../images/pictos/picto_plan_site.gif") no-repeat 2px 50%;
}

.aide_contextuelle {
  padding-left: 45px;
  background: url("../../images/pictos/picto_aide.gif") no-repeat 2px 50%;
}

.rechercher {
  background: url("../../images/pictos/picto_rechercher.gif") no-repeat 2px 50%;
}

.modifier {
  background: url("../../images/pictos/picto_modifier.gif") no-repeat 2px 50%;
}

.valider {
  background: url("../../images/pictos/picto_valider.gif") no-repeat 2px 50%;
}

.supprimer {
  background: url("../../images/pictos/picto_supprimer.gif") no-repeat 2px 50%;
}

.annuler {
  background: url("../../images/pictos/picto_annuler.gif") no-repeat 2px 50%;
}

.retablir {
  background: url("../../images/pictos/picto_retablir.gif") no-repeat 2px 50%;
}

.mail {
  background: url("../../images/pictos/picto_mail.gif") no-repeat 2px 50%;
}

.affiner {
  background: url("../../images/pictos/picto_affiner.gif") no-repeat 2px 50%;
}

.suivant {
  background: url("../../images/pictos/picto_suivant.gif") no-repeat 2px 50%;
}

.precedent {
  background: url("../../images/pictos/picto_precedent.gif") no-repeat 2px 50%;
}

.attente {
  padding-left: 82px;
  background: url("../../images/pictos/picto_attente.gif") no-repeat 2px 50%;
}

.enregistrer {
  background: url("../../images/pictos/picto_enregistrer.gif") no-repeat 2px 50%;
}

.imprimer {
  background: url("../../images/pictos/picto_imprimer.gif") no-repeat 2px 50%;
}

.liste {
  background: url("../../images/pictos/picto_liste.gif") no-repeat 2px 50%;
}

.exporter {
  background: url("../../images/pictos/picto_exporter.gif") no-repeat 2px 50%;
}

.ajouter {
  background: url("../../images/pictos/picto_ajouter.gif") no-repeat 2px 50%;
}

.enlever {
  background: url("../../images/pictos/picto_enlever.gif") no-repeat 2px 50%;
}

.quitter {
  background: url("../../images/pictos/picto_fermer_session.gif") no-repeat 2px
    50%;
}

.plus {
  background: url("../../images/pictos/picto_plus.gif") no-repeat 2px 50%;
}

.moins {
  background: url("../../images/pictos/picto_moins.gif") no-repeat 2px 50%;
}

.picto_obligatoire {
  padding-left: 15px;
  background: url("../../images/pictos/picto_obligatoire.gif") no-repeat 2px 50%;
}

.acrobat {
  padding: 10px 0px 10px 95px;
  background: url("../../images/pictos/picto_acrobat.gif") no-repeat 2px 50%;
}

.tri_haut_on {
  background: url("../../images/pictos/tri_haut_on.gif") no-repeat 2px 50%;
}

.tri_haut_off {
  background: url("../../images/pictos/tri_haut_off.gif") no-repeat 2px 50%;
}

.tri_bas_on {
  background: url("../../images/pictos/tri_bas_on.gif") no-repeat 2px 50%;
}

.tri_bas_off {
  background: url("../../images/pictos/tri_bas_off.gif") no-repeat 2px 50%;
}

.retour_haut {
  padding: 2px 0px 2px 90px;
  background: url("../../images/structure/haut_de_page.gif") no-repeat 70% 50%;
  background-color: #ca3353;
}

.mailto {
  padding-left: 50px;
  background: url("../../images/structure/mail_piedpage.gif") no-repeat 2px 50%;
}

.enlever {
  background: url("../../images/pictos/picto_enlever.gif") no-repeat 2px 50%;
}

.handicap {
  background: url("../../images/structure/handicap.png") no-repeat 2px 50%;
}

.obligatoire {
  color: red;
}

/* Ligne générique bleue */
.tdBleu {
  background-color: #ca3353;
}

#contenu div.pagination {
  margin: 0px;
  padding: 3px;
  text-align: left;
  font-size: 1em;
  background-color: #fbf2f4;
  border-top: 1px solid #f8e5e9;
  border-bottom: 1px solid #f8e5e9;
}

#contenu div.pagination a {
  text-decoration: none;
}

#contenu div.pagination img {
  vertical-align: middle;
}

#contenu div.pagination form {
  margin: 0px;
  padding: 0px;
  display: inline;
}

#contenu div.pagination form input.petit {
  float: none;
  margin: 0px;
  padding: 0px;
  text-align: right;
  font-size: 1em;
  background-color: white;
}

#contenu div.pagination form label {
  float: none;
  margin: 0px;
  padding: 0px;
  background: none;
  font-size: 1em;
}

#contenu div.pagination form button {
  margin: 0px;
  padding: 0px;
  background: none;
  font-size: 1em;
}

#contenu pre {
  font-size: 1.5em;
}

.invisible {
  display: none;
}

.rounded-bl {
  background: transparent url(../../images/structure/bl10x10.gif) no-repeat
    bottom left;
}
.rounded-tl {
  background: transparent url(../../images/structure/tl10x10.gif) no-repeat top
    left;
}
.rounded-br {
  background: transparent url(../../images/structure/br10x10.gif) no-repeat
    bottom right;
}
.rounded-tr {
  background: transparent url(../../images/structure/tr10x10.gif) no-repeat top
    right;
}

.clr {
  clear: both;
}

.validation_xhtml {
  padding: 2px 0px 2px 90px;
  height: 32px;
  background: url("../../images/structure/valid-xhtml10.png") no-repeat 70% 50%;
}

.validation_css {
  padding: 2px 0px 2px 90px;
  height: 32px;
  background: url("../../images/structure/vcss.png") no-repeat 70% 50%;
}

.validation_wai {
  padding: 2px 0px 2px 90px;
  height: 32px;
  background: url("../../images/structure/wcag1A.gif") no-repeat 70% 50%;
}

.validation_aprompt {
  padding: 2px 0px 2px 90px;
  height: 32px;
  background: url("../../images/structure/IconA.png") no-repeat 70% 50%;
}

.left100 {
  left: -100px;
}

.left200 {
  left: -200px;
}

.left300 {
  left: -300px;
}

.width90pc {
  width: 90%;
}

.width10pc {
  width: 10%;
}

.width20pc {
  width: 20%;
}

#contenu {
  padding: 0px;
  margin: 0px;
  border: 0px;
}

#contenu .onglet ul {
  font-weight: bold;
  white-space: nowrap;
  font-size: 1.2em;
  padding: 0px;
  margin: 0px;
  border: 0px;
  list-style-type: none;
}

#contenu .onglet li {
  display: inline;
}

#contenu .onglet li.current a {
  color: white;
  background: #ca3353 url(../../images/structure/tr10x10.gif) no-repeat top
    right;
}

#contenu .onglet li a {
  color: #ca3353;
  background: #f8e5e9 url(../../images/structure/tr10x10.gif) no-repeat top
    right;
  padding: 4px 6px;
  text-decoration: none;
}

#contenu .onglet li a:hover {
  color: white;
  background: #ca3353 url(../../images/structure/tr10x10.gif) no-repeat top
    right;
}

#contenu .corpsonglet {
  display: block;
  position: relative;
  padding: 2px;
  margin-top: 2px;
  border: solid 2px #ca3353;
  width: auto;
}

/* Positionnement */

#contenu form label {
  float: left;
  width: 120px;
  text-align: right;
  padding-right: 15px;
}

#contenu form div.ligne {
  clear: both;
}

#contenu div.adroite {
  float: left;
  width: 50%;
}

#contenu div.agauche {
  float: left;
  width: 50%;
}

#contenu div.unique {
}

/* styles */
#contenu form label.champ_obligatoire {
  background: url("../../images/pictos/picto_obligatoire.gif") no-repeat 97% 50%;
}

#contenu form input,
#contenu form select {
  background-color: #fbf2f4;
}

#contenu form input.button {
  border: none;
  font-weight: bold;
  text-align: left;
  color: #a0a0a0;
  background-color: transparent;
}

div#contenu form button:hover,
div#contenu form input.button:hover {
  color: #ca3353;
  cursor: pointer;
}

#contenu form button {
  border: none;
  font-weight: bold;
  text-align: left;
  color: #a0a0a0;
}

#contenu form input:focus,
#contenu form select:focus {
  background-color: #f8e5e9;
}

#contenu fieldset {
  border: 1px solid;
  background-color: #fbf2f4;
}

#contenu legend {
  border: 1px solid;
  background-color: #fbf2f4;
}

#contenu a.aide {
  /*** Mise en forme des bulles d'aide ***/
  text-decoration: none;
}
#contenu a.aide img {
  /*** Mise en forme de l'image des bulles d'aide ***/
  margin: 0;
  padding: 0;
  border: 0;
}
#contenu a.aide:hover {
  /*** Le curseur de la souris change d'aspect quand il passe au-dessus d'une bulle d'aide ***/
  cursor: help;
}

/* ----------------------------------------- */
/* Styles de présentations de formulaires */
/* colonne, horizontal, avec marge constante, vertical */

.columnarForm {
  border: 1px solid;
  padding: 5px;
}

.columnarForm fieldset {
  float: left;
  display: block;
  width: 17em;
  margin: 0 1em 1em 0;
  padding: 0 1em 1em 1em;
}

.columnarForm fieldset.radio {
  width: 15em;
  margin: 1em 0 2em 0;
}

.columnarForm fieldset.radio input {
  clear: both;
  float: left;
  width: auto;
}

.columnarForm fieldset.radio label {
  font-weight: normal;
}

.columnarForm input {
  display: block;
  width: 15em;
}

.columnarForm .submit {
  display: block;
  clear: both;
}

#contenu form.columnarForm fieldset label {
  display: block;
  float: none;
  text-align: left;
  margin-bottom: 1em;
  font-weight: bold;
}

.columnarForm label.first {
  padding-top: 1em;
}

.columnarForm select {
  display: block;
}

/* ----------------------------------------- */
.horizontalForm {
  border: 1px solid;
  padding: 5px;
}

.horizontalForm fieldset {
  display: block;
  margin: 0 0 1em 0;
  padding: 5px;
}

.horizontalForm fieldset.radio {
  margin: 1em 0 2em 0;
}

.horizontalForm fieldset.radio input {
  clear: both;
  float: left;
  width: auto;
}

.horizontalForm fieldset.radio label {
  font-weight: normal;
}

.horizontalForm input {
  display: block;
  height: 1.3em;
}

.horizontalForm input.submit {
  clear: both;
}

.horizontalForm input.button {
  height: 2em;
  display: inline;
}

#contenu form.horizontalForm fieldset label {
  float: left;
  display: block;
  text-align: left;
  margin: 0.5em 1em 0 0;
  font-weight: bold;
  width: auto;
}

.horizontalForm select {
  display: block;
}

/* ----------------------------------------- */
.marginForm {
  border: 1px solid;
  padding: 5px;
}

.marginForm fieldset {
  display: block;
  margin: 0 0 1em 0;
  border: 0 solid #ffffff;
  border-top: 1px solid #000000;
  padding: 1em 1em 1em 1em;
}

.marginForm fieldset.radio {
  margin: 0 0 0 0;
  border: 0 solid #ffffff;
}

.marginForm fieldset.radio input {
  position: static;
  clear: both;
  float: left;
}

.marginForm fieldset.radio label {
  position: relative;
  top: 0px;
  display: inline;
  width: auto;
  margin: 0 0 0 8em;
  font-weight: bold;
  font-weight: normal;
}

.marginForm fieldset.radio legend {
  float: left;
  font-weight: bold;
}

.marginForm input {
  position: relative;
  top: -1.4em;
  left: 8em;
  display: block;
}

.marginForm input.submit {
  clear: both;
  top: 0;
}

.marginForm label {
  clear: both;
  float: left;
  display: block;
  width: 8em;
  margin-top: -1em;
  font-weight: bold;
}

.marginForm label.first {
  margin-top: 1em;
}

.marginForm select {
  position: relative;
  top: -1.4em;
  left: 8em;
  display: block;
}

/* ----------------------------------------- */
.verticalForm {
  border: 1px solid;
  padding: 5px;
}

.verticalForm fieldset {
  display: block;
  width: 17em;
  margin: 0 0 3em 0;
  padding: 1em 1em 1em 1em;
}

.verticalForm fieldset.radio {
  width: 15em;
  margin: 1em 0 2em 0;
}

.verticalForm fieldset.radio input {
  clear: both;
  float: left;
  width: auto;
}

.verticalForm fieldset.radio label {
  font-weight: normal;
}

.verticalForm input {
  display: block;
  width: 15em;
}

.verticalForm label {
  display: block;
  margin-bottom: 1em;
  font-weight: bold;
}

.verticalForm label.first {
  padding-top: 1em;
}

.verticalForm select {
  display: block;
}

```

</details>


---

### 📄 `static/app/css/intranet/couleurs.css` [3.444 octets]
<a id="static-app-css-intranet-couleurs-css"></a> [↩ Retour à l'arborescence](#tree-static-app-css-intranet-couleurs-css)

> **Chemin relatif** : `static/app/css/intranet/couleurs.css`  
> **Taille** : 3.444 octets  
> **Lignes** : 239  
> **Type** : css

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (239 lignes) - Cliquer pour déplier</summary>

```css
div#menu1 {
  background-color: white;
}

div#recherche fieldset {
  border-color: #CA3353;
  background-color: #F8E5E9;
}

div#recherche legend {
  border-color: #CA3353;
  background-color: #F8E5E9;
}

div#recherche form button:hover {
  color: #CA3353;
}

div#messagedeservice p {
  color: #CA3353;
}

div#menu1 li {
  color: white;
  background-color: #CA3353;
}

div#menu1 ul ul {
  background-color: white;
  color: black;
}
div#menu1 ul ul li {
  color: black;
}

div#menu1 a {
  color: black;
}

div#droit {
  background: #F8E5E9;
}

div#menu2 li {
  color: white;
  background: #CA3353;
}

div#menu2 ul li ul {
  background: #F8E5E9;
  color: black;
}
div#menu2 ul li ul li {
  color: black;
}

div#menu2 a {
  color: black;
}

div#menu2 fieldset {
  border-color: #CA3353;
  background-color: #F8E5E9;
}

div#menu2 legend {
  border-color: #CA3353;
  background-color: #F8E5E9;
}

div#menu2 form button:hover {
  color: #CA3353;
}

/* formulaires.css */
#contenu form input,
#contenu form select {
  background-color: #F8E5E9;
}

#contenu form input:focus,
#contenu form select:focus {
  background-color: #ffe5d8;
}

#contenu fieldset {
  background-color: #F8E5E9;
}

#contenu legend {
  background-color: #F8E5E9;
}

div#contenu form button:hover {
  color: #CA3353;
}

/* menu-principal.css */
div#menuprincipal {
  background-color: #CA3353;
}

/* menu-horizontal.css */
div#menuprincipal ul li {
  color: white;
  background-color: #CA3353;
}

div#menuprincipal ul li.actif {
  background-color: #ffe5d8;
  color: #CA3353;
}

div#menuprincipal ul li a.courant {
  color: #CA3353;
  background-color: #F8E5E9;
}

div#menuprincipal ul li a:hover {
  background-color: #ffe5d8;
  color: #CA3353;
}

/* menu-vertical.css */
div#menuprincipal ul.menu li {
  color: white;
  background-color: #CA3353;
}

div#menuprincipal ul.menu li a.courant {
  color: #CA3353;
  background-color: #F8E5E9;
}

div#menuprincipal ul.menu li a:hover {
  color: #CA3353;
  background-color: #ffe5d8;
}

div#menuprincipal ul.menu li a {
  color: white;
}

div#menuprincipal ul.sousMenu li {
  color: white;
  background-color: #CA3353;
}

div#menuprincipal ul.sousMenu li a:hover {
  color: #CA3353;
  background-color: #ffe5d8;
}

div#menuprincipal ul.sousMenu li a {
  color: white;
}

/* onglets.css */
#contenu .onglet li.current a {
  color: white;
  background-color: #CA3353;
}

#contenu .onglet li a {
  color: #CA3353;
  background-color: #ffe5d8;
}

#contenu .onglet li a:hover {
  color: white;
  background-color: #CA3353;
}

#contenu .corpsonglet {
  border-color: #CA3353;
}

/* styles.css */
a:active,
a:hover,
a:focus {
  color: #CA3353;
}

h1 {
  background-color: white;
  color: #CA3353;
}

/* Titre de deuxi�me niveau */
h2 {
  background-color: #FBF2F4;
  color: #CA3353;
  border-top-color: #CA3353;
}

table.tableau {
  border-color: #CA3353;
}

table.tableau th {
  background-color: #F8E5E9;
  color: #CA3353;
  border-color: #CA3353;
}

table.tableau td {
  background-color: #FBF2F4;
  border-color: #CA3353;
  color: black;
}

table.tableau tr.impair td {
  background-color: #F8E5E9;
  color: black;
}

.encadre {
  border-color: #CA3353;
}

.retour_haut {
  background-color: #CA3353;
}

.tdBleu {
  background-color: #CA3353;
}

#contenu div.pagination {
  background-color: #F8E5E9;
  border-top-color: #F8E5E9;
  border-bottom-color: #F8E5E9;
}

#contenu div.pagination form input.petit {
  background-color: white;
}

```

</details>


---

### 📄 `static/app/css/intranet/menu-horizontal.css` [1.014 octets]
<a id="static-app-css-intranet-menu-horizontal-css"></a> [↩ Retour à l'arborescence](#tree-static-app-css-intranet-menu-horizontal-css)

> **Chemin relatif** : `static/app/css/intranet/menu-horizontal.css`  
> **Taille** : 1.014 octets  
> **Lignes** : 52  
> **Type** : css

```css
/* Liste des options principales de l'application */
/* Sous le bandeau avec le nom de l'application */
div#menuprincipal {
  margin: 0px 0px 0px 100px;
  background: #ca3353;
  margin-bottom: 1.5em;
  height: auto;
  position: relative; /*** IE6 needs this to display the div ***/
}

div#menuprincipal ul,
div#menuprincipal li,
div#menuprincipal a {
  margin: 0px;
  padding: 0px;
  border: 0px;
}

div#menuprincipal ul {
  list-style-type: none;
  margin-left: 20px;
  height: auto;
  padding: 0px;
}

div#menuprincipal ul li {
  display: inline;
  cursor: default;
  font-size: 1.25em;
  font-weight: bold;
  position: relative;
  color: white;
  background-color: #ca3353;
}

div#menuprincipal ul li a:hover {
  color: #ca3353;
  background-color: #f8e5e9;
}

div#menuprincipal ul li a.courant {
  color: #ca3353;
  background-color: #f8e5e9;
}

div#menuprincipal ul li a {
  color: white;
  padding: 0px 20px 0px 20px;
  border: 0px;
  position: relative;
}

```


---

### 📄 `static/app/css/texte/texte_seul.css` [150 octets]
<a id="static-app-css-texte-texte_seul-css"></a> [↩ Retour à l'arborescence](#tree-static-app-css-texte-texte_seul-css)

> **Chemin relatif** : `static/app/css/texte/texte_seul.css`  
> **Taille** : 150 octets  
> **Lignes** : 8  
> **Type** : css

```css
body {
  background-color: #ffffff;
  color: #000000;
  font-family: Arial, Helvetica, sans-serif;
  font-size: small;
  font-style: normal;
}

```


---

### 📄 `VERSION` [5 octets]
<a id="VERSION"></a> [↩ Retour à l'arborescence](#tree-VERSION)

> **Chemin relatif** : `VERSION`  
> **Taille** : 5 octets  
> **Lignes** : 1  
> **Type** : text

```text
1.3.3
```


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

`````

</details>


---

### 📄 `si/palome-django.wiki.md` [4.186 octets]
<a id="si-palome-django-wiki-md"></a> [↩ Retour à l'arborescence](#tree-si-palome-django-wiki-md)

> **Chemin relatif** : `si/palome-django.wiki.md`  
> **Taille** : 4.186 octets  
> **Lignes** : 178  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (178 lignes) - Cliquer pour déplier</summary>

````markdown
﻿# Projet : palome-django.wiki

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\palome-django.wiki`

**Fichiers** : 1 fichiers non-binaires

## 📁 Arborescence des fichiers

└── <a id="tree-home-md"></a>[home.md](#home-md) *(205 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `home.md` [205 octets]
<a id="home-md"></a> [↩ Retour à l'arborescence](#tree-home-md)

> **Chemin relatif** : `home.md`  
> **Taille** : 205 octets  
> **Lignes** : 9  
> **Type** : markdown

```markdown
# PALOME-DJANGO

## Descriptif :
Gestion du parc de logements destinés aux agents du ministère. Gestion des demandes de logement.


## Voir:
https://wikisi.e2.rie.gouv.fr/wikisi/application/472/

```


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

````

</details>


---

### 📄 `si/palome-legacy.analysis.md` [15.063 octets]
<a id="si-palome-legacy-analysis-md"></a> [↩ Retour à l'arborescence](#tree-si-palome-legacy-analysis-md)

> **Chemin relatif** : `si/palome-legacy.analysis.md`  
> **Taille** : 15.063 octets  
> **Lignes** : 486  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (486 lignes) - Cliquer pour déplier</summary>

````markdown
# 📋 Analyse Technique & Fonctionnelle — Application **PALOME**

> 📌 **Nom** : PALOME  
> 📆 **Contexte détecté** : Application web interne de gestion / consultation de logements réservés (ministère, probablement SG/DRH/CRHAC2/PAS/LOG).  
> 🛠️ **Stack technique** : Java EE 1.4 / Struts 1.2.4 / Hibernate / Tiles / Tomcat 5.5.23 / Cerbère (SSO interne)

---

## 🧭 Sommaire

- [1. Vue d’ensemble](#1-vue-densemble)
- [2. Partie fonctionnelle](#2-partie-fonctionnelle)
  - [2.1 Acteurs](#21-acteurs)
  - [2.2 Cas d’usage](#22-cas-dusage)
  - [2.3 Règles métier](#23-règles-métier)
  - [2.4 Workflow utilisateur](#24-workflow-utilisateur)
- [3. Partie technique](#3-partie-technique)
  - [3.1 Architecture globale](#31-architecture-globale)
  - [3.2 Modules & couches](#32-modules--couches)
  - [3.3 Dépendances](#33-dépendances)
  - [3.4 Sécurité](#34-sécurité)
  - [3.5 Dette technique](#35-dette-technique)
- [4. Annexes](#4-annexes)
  - [4.1 Fichiers clés](#41-fichiers-clés)
  - [4.2 Configuration Cerbère](#42-configuration-cerbère)
  - [4.3 Messages d’erreur & i18n](#43-messages-derreur--i18n)

---

## 1. Vue d’ensemble

PALOME est une **application web de consultation de logements ministériels réservés**, destinée aux agents (et anonymes en mode lecture seule). Elle offre :
- Une **cartographie** des logements (`cartelogements.jsp`),
- Une **liste tabulaire** (`listelogements.jsp`),
- Des **descriptions détaillées** (studette, studio, procédures),
- Des informations sur **revenus / loyers / taille familiale**.

Elle suit les bonnes pratiques de l’époque :
- **Struts 1** pour le contrôleur MVC,
- **Tiles** pour la composition de vue,
- **Hibernate** pour l’accès aux données,
- **Cerbère** (bouchonné en dev) pour l’authentification.

---

## 2. Partie fonctionnelle

### 2.1 Acteurs

| Acteur | Description | Habilitation (fichier `cerbere-bouchon.xml`) |
|--------|-------------|-----------------------------------------------|
| `anonyme` | Visiteur non connecté | `LECTEUR` (lecture seule) |
| `test` | Utilisateur de test | `LECTEUR` |
| `ADMIN` | Administrateur (non utilisé dans les JSP visibles) | `ADMIN` |

> 💡 Le fichier `cerbere-bouchon.xml` suggère que l’authentification est désactivée en local (`test` / `anonyme`).

---

### 2.2 Cas d’usage

```plantuml
@startuml
left to right direction
actor "Anonyme / Agent" as User

rectangle "PALOME" {
  User --> (Consulter la carte des logements)
  User --> (Consulter la liste des logements)
  User --> (Voir détails d’un logement)
  User --> (Lire procédure ministérielle)
  User --> (Lire procédure interministérielle)
  User --> (Consulter revenus & loyer)
  User --> (Lire aide contextuelle)
}

(Consulter la carte des logements) --> (Voir détails d’un logement)
(Consulter la liste des logements) --> (Voir détails d’un logement)
@enduml
```

> ✅ **Remarque** : Aucun cas d’usage *d’écriture* (création/modification) n’est présent dans les actions (`*.do`) listées → Application **en lecture seule**.

---

### 2.3 Règles métier

#### A. Typologie des logements

D’après les JSPs et les définitions Tiles (`tiles-config.xml`) :

| Type | Titre clé (i18n) | Description |
|------|------------------|-------------|
| `studette` | `studette.title` | ~17m², meublée partiellement, literie non fournie |
| `studio` | `studio.title` | 32m², pour 2 personnes, caution = 1 mois |
| `résidence Renan / Léon Bollée` | — | Résidences spécifiques citées dans les JSP compilés |

> 📌 Extrait de `listelogements_jsp.java` :
> ```java
> out.write("- studio 32m² pour deux personnes\n");
> out.write("- Redevance : 513 € (charges comprises)\n");
> out.write("- Caution : un mois de redevance\n");
> ```

#### B. Calculs implicites (revenu / éligibilité)

Dans `revenusetloyer.jsp` (201 lignes), on détecte une **logique conditionnelle** sur les revenus minimaux selon zone et type de logement.

> ❗ **Aucune formule explicite n’est fournie**, mais le mapping `Logement.hbm.xml` expose :
> - `revenuMinimum` (`t`)
> - `typeLogement` (`u`)
> - `zone` (`v`)
> - `nbrCandidats` (`w`)

➡️ Donc :  
**Éligibilité** = fonction(revenuSalarial ≥ `revenuMinimum` pour `zone` ∧ `typeLogement`)

```plantuml
@startuml
title Règle d'éligibilité (inférée)
skinparam ConditionStyle diamond

[*] --> "Lire critères"
"Lire critères" --> "Revenu ≥ revenuMinimum(zone, typeLogement) ?"
"Revenu ≥ revenuMinimum(zone, typeLogement) ?" --> [Oui] "Éligible"
"Revenu ≥ revenuMinimum(zone, typeLogement) ?" --> [Non] "Non éligible"
"Éligible" --> [*]
"Non éligible" --> [*]
@enduml
```

#### C. Pagination

Dans `initialisation.properties` :

```properties
pager.nombre.lignes.par.page.max=100
pager.nombre.lignes.par.page=10
liste.restreinte.nombre = 5
```

→ Contrainte métier : **pas plus de 100 logements affichables par page** (protection anti-DOS / UX).

---

### 2.4 Workflow utilisateur

```plantuml
@startuml
title Navigation principale (workflow linéaire/hiérarchique)

[*] --> Accueil
Accueil --> Consultation : menu "Consultation"
Consultation --> Carte : "Carte des logements"
Consultation --> Liste : "Liste des logements"
Carte --> Détail : clic sur logement
Liste --> Détail : clic sur logement
Détail --> Procédures : liens internes
Détail --> Revenus : lien "Revenus et loyer"

note right of Détail
  Affiche :
  - Surface
  - Loyer
  - Revenu min.
  - Photo (studio.jpg)
end note
@enduml
```

> 🛣️ Le workflow est **principalement linéaire / exploratoire**, sans étapes obligatoires — cohérent avec une application d’information.

---

## 3. Partie technique

### 3.1 Architecture globale

```plantuml
@startuml
!theme plain
top to bottom direction

package "Client (Navigateur)" {
  [HTML/CSS/JS]
}

node "Tomcat 5.5.23" as tomcat {
  component "Struts ActionServlet" as struts
  component "TilesRequestProcessor" as tiles
  component "Hibernate SessionFactory" as hibernate
  component "Cerbère Filter" as cerbere
  [WEB-INF/classes] as classes
  [WEB-INF/lib] as lib
}

database "Base de données" as db {
  [extrait] as table
}

[HTML/CSS/JS] --> struts : HTTP GET /cartelogements.do
struts --> tiles : forward ".cartelogements"
tiles --> classes : instancie LogementService
classes --> hibernate : session.get(Logement.class, id)
hibernate --> db : SELECT * FROM extrait WHERE ...
cerbere -.-> struts : @WebFilter sur *.do

note right of cerbere
  SecurityFilter
  (securityfilter-2.0.jar)
end note
@enduml
```

> 🧱 **Stack verticale** :
> - **Présentation** : JSP + Struts Tags + Tiles  
> - **Contrôle** : Struts `ActionMapping` + `GenericActionServlet`  
> - **Métier** : `LogementService extends AbstractService`  
> - **Accès données** : `LogementDAO` → Hibernate → `extrait` (vue/table)

---

### 3.2 Modules & couches

#### Arborescence logique (reconstruite)

```
src/
├─ i2.application.palome/
│  ├─ presentation/       # Contrôleur Struts (Actions)
│  │  └─ consultation/
│  │     ├─ AfficherLogementAction.java
│  │     └─ CarteLogementsAction.java
│  ├─ metier/             # Service métier
│  │  ├─ LogementService.java
│  │  └─ ServiceFactory.java
│  ├─ integration/        # Couche persistance
│  │  ├─ hibernate/
│  │  │  ├─ Logement.hbm.xml
│  │  │  └─ LogementDAO.java
│  │  └─ ILogementDAO.java
│  └─ valueobject/        # DTO
│     └─ Logement.java
└─ i2.application.commun/ # Framework maison
   ├─ presentation/
   ├─ metier/
   ├─ exception/
   └─ util/
```

#### Diagramme de classes clés

```plantuml
@startuml
package "PALOME" {
  class Logement {
    +String code
    +Date dateHeure
    +String numero
    +String typeLogement
    +BigDecimal revenuMinimum
    +String zone
    +Integer nbrCandidats
  }

  interface ILogementService {
    +Logement getLogement(String id)
  }

  class LogementService {
    -ILogementDAO dao
  }

  interface ILogementDAO {
    +Logement findById(String id)
  }

  class LogementDAO {
    // impl Hibernate
  }

  class AfficherLogementAction {
    +ActionForward doExecute(...)
  }
}

package "Struts" {
  class Action
  class ActionMapping
  class ActionForm
}

package "Commun" {
  class AbstractService
  class AbstractBasicAction
}

LogementService ..|> ILogementService
LogementDAO ..|> ILogementDAO
LogementService *-- ILogementDAO
AfficherLogementAction --> LogementService : getService()

AbstractService <|-- LogementService
AbstractBasicAction <|-- AfficherLogementAction

Action <|-- AbstractBasicAction
@enduml
```

---

### 3.3 Dépendances

#### Bibliothèques détectées (`Libs requises.txt`)

| Type | Librairie |
|------|-----------|
| **Web MVC** | `struts-1.2.4.jar` |
| **Validation** | `commons-validator-1.1.3.jar`, `validator_1_1_3.dtd` |
| **Accès données** | `hibernate3.jar`, `ehcache.xml`, `hibernate.cfg.xml` |
| **Sécurité** | `securityfilter-2.0.jar`, `cerbere-bouchon-1.6.1.jar` |
| **Utils** | `commons-beanutils-1.6.jar`, `commons-collections-3.1.jar`, `jakarta-oro-2.0.8.jar` |

> ⚠️ **Conflit possible** : `jakarta-oro` est cité 2× (typo ? doublon ?)

#### Arbre de dépendances (simplifié)

```plantuml
@startuml
digraph G {
  rankdir=LR
  node [shape=box]

  "palome.war" -> "struts-1.2.4.jar"
  "palome.war" -> "hibernate3.jar"
  "palome.war" -> "securityfilter-2.0.jar"
  "struts-1.2.4.jar" -> "commons-beanutils-1.6.jar"
  "struts-1.2.4.jar" -> "commons-collections-3.1.jar"
  "struts-1.2.4.jar" -> "commons-digester-1.6.jar"
  "struts-1.2.4.jar" -> "commons-logging-1.0.4.jar"
  "hibernate3.jar" -> "ehcache-core.jar"
  "securityfilter-2.0.jar" -> "cerbere-bouchon-1.6.1.jar"
}
@enduml
```

---

### 3.4 Sécurité

#### Chaîne de filtrage (d’après `web.xml`)

```xml
<filter>
  <filter-name>Security Filter</filter-name>
  <filter-class>org.securityfilter.SecurityFilter</filter-class>
  <init-param>
    <param-name>config</param-name>
    <param-value>/WEB-INF/classes/security-filter.xml</param-value>
  </init-param>
</filter>
<filter-mapping>
  <filter-name>Security Filter</filter-name>
  <url-pattern>*.do</url-pattern>
</filter-mapping>
```

→ **Toutes les actions Struts (`.do`) sont protégées.**

#### Configuration (`security-filter.xml`)

```xml
<securityfilter-config>
  <realm className="org.securityfilter.realm.catalina.CatalinaRealmAdapter"/>
</securityfilter-config>
```

→ Utilise un **adaptateur Cerbère ↔ Tomcat Realm**.

#### Données sensibles

- `build.properties` contient `tomcat.home=xxx` → **valeur masquée**, bon signe.
- `cerbere-bouchon.xml` expose des utilisateurs de test → à **exclure en prod**.

✅ **Bonnes pratiques présentes** :
- `errorPage="/WEB-INF/jsp/commun/erreur.jsp"` → pas de stack trace exposée.
- `WEB-INF/` non accessible via HTTP.

---

### 3.5 Dette technique

| Catégorie | Problème | Preuve | Gravité |
|----------|----------|--------|---------|
| 🔴 **Obsolète** | Tomcat 5.5.23 (2007), Java EE 1.4, Struts 1 (EOL) | `apache-tomcat-5.5.23/`, `struts-config.xml` v1.2 | Critique |
| 🟠 **Déprécié** | `tiles-config.xml` utilise Tiles 1 (pas Tiles 2/3) | `<definition name=".accueil" path="..."/>` | Élevée |
| 🟠 **Encodage** | Fichiers `.jsp` en `ISO-8859-1` (pas UTF-8) | `<%@ page ... contentType="text/html;charset=ISO-8859-1" %>` | Moyenne |
| 🟠 **Duplication** | `src/validation.xml` ≡ `palome/WEB-INF/classes/validation.xml` | Même contenu, 670 octets | Moyenne |
| 🟡 **Doc / Tests** | Aucun test unitaire détecté (`*.test.*`, `*Test.java`) | Absence dans arborescence | Faible |

#### Risque principal : **incompatibilité avec JDK ≥ 8**

> Struts 1.2.9+ est requis pour Java 8. Ici : **1.2.4** → risque de `NoSuchMethodError` (ex: `java.lang.VerifyError` sur `Collections.unmodifiableMap`).

```plantuml
@startuml
title Risque technique majeur

[*] --> "Démarrage Tomcat 5.5.23 + JDK 11"
"Démarrage..." --> "Chargement struts-1.2.4.jar"
"Chargement..." --> "Appel méthode deprecated (ex: Hashtable.keys())"
"Appel..." --> [JDK ≥ 9] "java.lang.NoSuchMethodError"
"Appel..." --> [JDK ≤ 8] "OK (déprécié)"
@enduml
```

---

## 4. Annexes

### 4.1 Fichiers clés

| Fichier | Rôle | Commentaire |
|--------|------|-------------|
| `struts-config.xml` | Routage MVC | Définit les `Action` → `forward` Tiles |
| `tiles-config.xml` | Composition des pages | Modèles (`modele2colonnes`) et définitions (`studio`, `studette`) |
| `Logement.hbm.xml` | Mapping ORM | Table `extrait`, champs `t`→`revenuMinimum`, `v`→`zone` |
| `menu.xml` | Arborescence navigation | Menu principal → Consultation → Carte / Liste |
| `initialisation.properties` | Config métier | Pagination, mode (`production`/`developpement`) |
| `cerbere-bouchon.xml` | Auth bouchon | Habilitations `anonyme=LECTEUR` |

---

### 4.2 Configuration Cerbère

```xml
<!-- palome/WEB-INF/web.xml -->
<env-entry>
  <env-entry-name>cerbere/application/id</env-entry-name>
  <env-entry-value>palome</env-entry-value>
</env-entry>
<env-entry>
  <env-entry-name>cerbere/cookie/time</env-entry-name>
  <env-entry-value>120</env-entry-value>
</env-entry>
<env-entry>
  <env-entry-name>cerbere/gate/url</env-entry-name>
  <env-entry-value>Authentification</env-entry-value>
</env-entry>
```

→ Timeout session : **120 secondes**  
→ Point d’entrée SSO : `/Authentification`

---

### 4.3 Messages d’erreur & i18n

Fichiers de messages détectés :
- `palome.properties` (81 clés détectées dans `struts-config.xml` → `message-resources parameter="palome"`)
- Exemples :
  ```properties
  carte.titre=Titre de la carte
  carte.description=Description de la carte
  erreur.application.champNull=Le champ {0} doit être rempli
  erreur.integration.rechercherTous=Erreur dans rechercherTous
  ```

> 🌐 **Pas de gestion multilingue détectée** : seules des clés FR présentes.

---

## ✅ Conclusion

PALOME est une **application métier stable mais technologiquement obsolète**, typique des SI de l’administration française des années 2000–2010.

- ✅ **Fonctionnellement** : claire, cohérente, centrée utilisateur.
- ⚠️ **Techniquement** : nécessite une **modernisation urgente** (migration Struts 1 → Spring MVC / Quarkus, Tomcat 5 → 10+, JDK 8+).

> 📌 Recommandation :  
> **1.** Containeriser avec Docker (Tomcat 5.5 + JRE 6) → stabilisation immédiate.  
> **2.** Refonte progressive via Strangler Fig Pattern (API → SPA front).

---


````

</details>


---

### 📄 `si/pasta-cooker-back.md` [18.328 octets]
<a id="si-pasta-cooker-back-md"></a> [↩ Retour à l'arborescence](#tree-si-pasta-cooker-back-md)

> **Chemin relatif** : `si/pasta-cooker-back.md`  
> **Taille** : 18.328 octets  
> **Lignes** : 600  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (600 lignes) - Cliquer pour déplier</summary>

`````markdown
﻿# Projet : pasta-cooker-back

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\pasta-cooker-back`

**Fichiers** : 14 fichiers non-binaires

## 📁 Arborescence des fichiers

├── **certs/**
│   ├── <a id="tree-certs-cert-pem"></a>[cert.pem](#certs-cert-pem) *(1.785 octets)*
│   └── <a id="tree-certs-key-pem"></a>[key.pem](#certs-key-pem) *(3.272 octets)*
├── **src/**
│   └── **ansible/**
│       ├── **ansible-docker/**
│       │   ├── <a id="tree-src-ansible-ansible-docker-Dockerfile"></a>[Dockerfile](#src-ansible-ansible-docker-Dockerfile) *(70 octets)*
│       │   └── <a id="tree-src-ansible-ansible-docker-ansible-cfg"></a>[ansible.cfg](#src-ansible-ansible-docker-ansible-cfg) *(107 octets)*
│       └── **ansible-local/**
│           └── <a id="tree-src-ansible-ansible-local-ansible-cfg"></a>[ansible.cfg](#src-ansible-ansible-local-ansible-cfg) *(107 octets)*
├── <a id="tree--dockerignore"></a>[.dockerignore](#-dockerignore) *(13 octets)*
├── <a id="tree--editorconfig"></a>[.editorconfig](#-editorconfig) *(172 octets)*
├── <a id="tree--eslintignore"></a>[.eslintignore](#-eslintignore) *(29 octets)*
├── <a id="tree--gitignore"></a>[.gitignore](#-gitignore) *(449 octets)*
├── <a id="tree--gitlab-ci-yml"></a>[.gitlab-ci.yml](#-gitlab-ci-yml) *(136 octets)*
├── <a id="tree--npmrc"></a>[.npmrc](#-npmrc) *(35 octets)*
├── <a id="tree-Dockerfile"></a>[Dockerfile](#Dockerfile) *(257 octets)*
├── <a id="tree-README-md"></a>[README.md](#README-md) *(1.909 octets)*
└── <a id="tree-docker-compose-template-yml"></a>[docker-compose.template.yml](#docker-compose-template-yml) *(553 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `.dockerignore` [13 octets]
<a id="-dockerignore"></a> [↩ Retour à l'arborescence](#tree--dockerignore)

> **Chemin relatif** : `.dockerignore`  
> **Taille** : 13 octets  
> **Lignes** : 2  
> **Type** : text

```text
node_modules

```


---

### 📄 `.editorconfig` [172 octets]
<a id="-editorconfig"></a> [↩ Retour à l'arborescence](#tree--editorconfig)

> **Chemin relatif** : `.editorconfig`  
> **Taille** : 172 octets  
> **Lignes** : 13  
> **Type** : text

```text
root = true

[*]
indent_style = space
indent_size = 2
end_of_line = lf
charset = utf-8
trim_trailing_whitespace = true
insert_final_newline = true

[*.yml]
indent_size = 2

```


---

### 📄 `.eslintignore` [29 octets]
<a id="-eslintignore"></a> [↩ Retour à l'arborescence](#tree--eslintignore)

> **Chemin relatif** : `.eslintignore`  
> **Taille** : 29 octets  
> **Lignes** : 4  
> **Type** : text

```text
.eslintrc.js
dist
migrations

```


---

### 📄 `.gitignore` [449 octets]
<a id="-gitignore"></a> [↩ Retour à l'arborescence](#tree--gitignore)

> **Chemin relatif** : `.gitignore`  
> **Taille** : 449 octets  
> **Lignes** : 44  
> **Type** : text

```text
# compiled output
/dist
/node_modules

# Logs
logs
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*
lerna-debug.log*

# OS
.DS_Store

# Tests
/coverage
/.nyc_output

# IDEs and editors
/.idea
.project
.classpath
.c9/
*.launch
.settings/
*.sublime-workspace

# IDE - VSCode
.vscode/*
!.vscode/settings.json
!.vscode/tasks.json
!.vscode/launch.json
!.vscode/extensions.json

# TypeORM
/ormconfig.json

ANSIBLE_VAULT_PASSWORD

# other
auth.sh
.env

```


---

### 📄 `.gitlab-ci.yml` [136 octets]
<a id="-gitlab-ci-yml"></a> [↩ Retour à l'arborescence](#tree--gitlab-ci-yml)

> **Chemin relatif** : `.gitlab-ci.yml`  
> **Taille** : 136 octets  
> **Lignes** : 7  
> **Type** : yaml

```yaml
include:
  - project: "snum/pnm3/public/pasta/pasta-ci"
    file: "applications/back.yml"

variables:
  SKIP_DEFAULT_DEV_DEPLOY: "true"

```


---

### 📄 `.npmrc` [35 octets]
<a id="-npmrc"></a> [↩ Retour à l'arborescence](#tree--npmrc)

> **Chemin relatif** : `.npmrc`  
> **Taille** : 35 octets  
> **Lignes** : 2  
> **Type** : text

```text
registry=https://npm.snum-pnm3.dev

```


---

### 📄 `certs/cert.pem` [1.785 octets]
<a id="certs-cert-pem"></a> [↩ Retour à l'arborescence](#tree-certs-cert-pem)

> **Chemin relatif** : `certs/cert.pem`  
> **Taille** : 1.785 octets  
> **Lignes** : 30  
> **Type** : text

```text
-----BEGIN CERTIFICATE-----
MIIE+DCCAuACCQCGnPt28RLFoTANBgkqhkiG9w0BAQsFADA+MRIwEAYDVQQDDAls
b2NhbGhvc3QxKDAmBgkqhkiG9w0BCQEWGW1vcmVhdS5yb21haW44M0BnbWFpbC5j
b20wHhcNMjIxMjAxMTY1OTE0WhcNMjMxMjAxMTY1OTE0WjA+MRIwEAYDVQQDDAls
b2NhbGhvc3QxKDAmBgkqhkiG9w0BCQEWGW1vcmVhdS5yb21haW44M0BnbWFpbC5j
b20wggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQDDknFcnXCexBlnuOk/
B1hICocbzUVAV+6goDhLWwjenVd4TQqzRRjGvtEMaBLY5nyaBhrJi0VBqHso1lQW
UNHXX8d2VNbyLtSkm4xbwXnuVDGZ+nzaF4j9remQJ9Y+Y5Lwszj09VtKHACUZ6ip
OTNUClZmPV7eEitGOR2li0Zudo6ARqpXV6bIAR4GmLORQqRmmvs0Q9Bao/8WleU7
Ziulm1MC4g0OztKkePq1z6RfjZTVX0tjZgFtFHlTrm/YOGuveLQ4fLaCTxtM2zPn
O6raxB84HsAx8a/4X8NsCDP3HlpyKWsXrukgcVnA9H+JM5qfVvmCXOX8xfjm7hvv
J3AkxlA2flUcA1ogzOOXVeFNladb8YSDm2f/uxGImh/e6H8l8ivjRitwJPqTi9wb
YPJeGXPILnYq9MO+vtJXbHoFbX6RkFj7ghl6QJuuhYSXFn0D4HtTO7qtjBfRHS9r
aby+lxc10Au7poj9d6rKatDaD/Ja74AjIpOIq4BlG5+UeFkGCmkNHgEyZBU/yuk3
SDCxXiOCyW40tkB52esE5QbobNqKqLzOdm/0sswMhuxxiWY2I80Yu3osCJSTe62q
K1+iTmlxKNmzyZu/QInXlRp7KBZ/nQ7+cRmeQg2VX32IfPLXs5ksR0/Idi9ABfex
9eBhhVyzcJELGHcZ2yAf2qMVhwIDAQABMA0GCSqGSIb3DQEBCwUAA4ICAQC/S7jX
75yYI/rdSrOJVBqWaO9uHWN+K3zR05IosobenGxM447usc2eDUPThW10G5wNwr79
zBhirvEGIxEpMV99Vb0eH/fFrQII2MmQ/vIxHtnT7YGYDJ77nUfeItE7U0aHW0na
u7Pg/urt0qcoJTRIwLLa43C5i4orp8cpqIIODFKgttWmql1jIFlybkSoCsO1TkrE
kAzqvo8sor24MMXaXoDuQLONW0nEUMu8nwAD4rh6cs6KEvN/GBzOCayulZfoMnRB
KhdNBbq8eTiyuC5geqYN4/wiJaL0mspjALJR4MEhb5y9Bh8euVLYey2bWuSgTMKi
kHDjDODkxH4qxZJ4Vk8b2NcN8RpSDis1ncdE3Cjs63Oozs1S9KDYUdSt+5g2KhLN
4xP65iFXMvBGHjtKU+ypqvLoTHsi/kX4LDn1RYpaEjziiWwe0ysnVt3EYfvr85MU
IOC4/PQ1ByYyxyskR52X7sGAh+JT/PWymvGWC6pyVmSygVzwFO9tdl2K3/J+Z/C6
2VYKfWQiCIMeC74247Ey7PqXIZvU7hAQvzNqRf88I2wYjLahvnqg2z0KUlCvz733
X4kixOhta+7esp+43j0rvv570+/QPME3xC8pdGL+l2clWZCglm09MmXAFCSlahFX
hpkwSRpIp50IJRBzbWMxcC2cFd+1ixgL6zmTWw==
-----END CERTIFICATE-----

```


---

### 📄 `certs/key.pem` [3.272 octets]
<a id="certs-key-pem"></a> [↩ Retour à l'arborescence](#tree-certs-key-pem)

> **Chemin relatif** : `certs/key.pem`  
> **Taille** : 3.272 octets  
> **Lignes** : 53  
> **Type** : text

```text
-----BEGIN PRIVATE KEY-----
MIIJQgIBADANBgkqhkiG9w0BAQEFAASCCSwwggkoAgEAAoICAQDDknFcnXCexBln
uOk/B1hICocbzUVAV+6goDhLWwjenVd4TQqzRRjGvtEMaBLY5nyaBhrJi0VBqHso
1lQWUNHXX8d2VNbyLtSkm4xbwXnuVDGZ+nzaF4j9remQJ9Y+Y5Lwszj09VtKHACU
Z6ipOTNUClZmPV7eEitGOR2li0Zudo6ARqpXV6bIAR4GmLORQqRmmvs0Q9Bao/8W
leU7Ziulm1MC4g0OztKkePq1z6RfjZTVX0tjZgFtFHlTrm/YOGuveLQ4fLaCTxtM
2zPnO6raxB84HsAx8a/4X8NsCDP3HlpyKWsXrukgcVnA9H+JM5qfVvmCXOX8xfjm
7hvvJ3AkxlA2flUcA1ogzOOXVeFNladb8YSDm2f/uxGImh/e6H8l8ivjRitwJPqT
i9wbYPJeGXPILnYq9MO+vtJXbHoFbX6RkFj7ghl6QJuuhYSXFn0D4HtTO7qtjBfR
HS9raby+lxc10Au7poj9d6rKatDaD/Ja74AjIpOIq4BlG5+UeFkGCmkNHgEyZBU/
yuk3SDCxXiOCyW40tkB52esE5QbobNqKqLzOdm/0sswMhuxxiWY2I80Yu3osCJST
e62qK1+iTmlxKNmzyZu/QInXlRp7KBZ/nQ7+cRmeQg2VX32IfPLXs5ksR0/Idi9A
Bfex9eBhhVyzcJELGHcZ2yAf2qMVhwIDAQABAoICAEESguGcCRLqkMFwRzuPiBJA
XoAjpr0oBOAxL0nzeloH5EjE6aCIhxvp9ci5ADxnRGJDUbppupuEIaaO2d+q+Ic+
+TEoPXTLnDlBAEyvbZCdNvvS2qP+XLh7m1E50BFmNEgeef8XfE6GTrMSYo4b2DZI
UkMmfGBLj1aIPpMMalzq2bNYz+jL41R8+q6bNHRKxkTVoGvdfIAMPR4YtfMzpaYu
rkoxSML6kh/jmRfRhRG+HB163ayvDh5rR4tOaSx6aWozMVPyOw/UnnLOJND1i33K
79BOewijMDfmNTHG8PNyiAmgOl/g9PS0gnavY5gVMYd++vojSur2PEEqTOUgLDGb
JgMGRMnmqfUJpcJlpDwkzG3xMtk5H/saiSTqSz2uYqO10HFxDOII1hVmkZqv7pao
pXS1iXjUYNo50cHT9KS2ZUPHQWWo75dqjsMiKeeMCAVKLEKNTmzoWuMEfMDoUKaA
tIZjumbsb12stVmquO2iTuOJ9KsKJ2e6YBBu+aJ6Utw7eyRC8WTXeOE7uzCAFk1C
pZTytWjCuhEqJmuTK1u3KI/JZNy8DLRoTveGwXP4ssF3VhneT0HDeJmOfKAALSTO
iexB1kuK+c0iWVQMMtR6Ybc/2lUamVLUbETxlHZjOxpL24+B1QKTEWi+EVTGit1Z
ej+0VKek4B/mX8BfbvZBAoIBAQDr95zNX+FKkv0nXl325vQJ7K5W9U+uZattSWl3
khrWzvzECI3Z9JpSThBrZPU6JiQs5WeC4OjGgBCmi6xAp8cPI+w/msvm+Ul6ZBBn
im8stHbfAqVYELn/p++3iEbcvMDD+cvnnEt59C3bWLeNAOaLqp4DdqE47kI8ucqS
+hyiNFd1vXdbvfjPbN8oXL0sIyucpCe3LNiavGJlMJeE94Y9vKBgFWv2xFf3SgXk
qAAVDcEfEU3amBsWBMhyWfSFkaMyvu0rJyE0tsNs6R54JfMSAbVM/thXlURzBVn7
yH4jD+nsCbRfU9cSnR1QNkmke9lM4AF5YRKb6aIwZgps2e7RAoIBAQDULOcHw81u
Cx3gC89F3uGHTuu2TZ5uLkHdu7sSHbh/ec3WrI7oOwZ/9AdheBjSC1U9cVE1ekak
xUICcKeVB1LUqz/ydTM3yqZJ78vwUf9FPgEucMIQQ5O37Iq9llyhpNVaZK95vgpz
LnwdnJgXAIbWeg6TI+kYvaYFfrL2yghU3xTUxwMscTNrOBzFb0n2B5b6lyVAk6Og
ErWE7yR/sysGJDJYAIMyAX7yvVx6q0CpZrsawz6zCY7ucs6XtMrvNmZILNes/bcT
536nevyHcvxYCJvN62pMKGkk3H8hYkBJqvto9ks1M/wAOmTVzfWS4cxI1W9Suxav
4dI4+LIMbETXAoIBAB4PjGVJiqzybte+GOBkacB963PeiokgIKeqi4oVDeBBvEfJ
AzE6DRLhKQxVbzw6Ma+ahgZRWrY3CGf/MTGHbj+KhwVPVhyVs3upFcHrC+C5GM+u
SZwffWKJZWuPK9/hF/mfcA+QhLkDl3fzJGcNL1GpqbmtOjrDd6K+1ITG4jDz1BSG
z5bba8AZEZDVx6/Ax0SMURbv2qRTzYEwoIzq76obxp6W/AsS1lYFkxyfHmuQNgMc
NDvd1s2GTHbs6M6/T/geBJ7TvFI32kucoyoRQ5cOqqclbDA0LuUsUFtYHmGfHGDa
l6TxTFvtshdO4zDWKke13do1uKYuLGBYD4nwdZECggEAYyDzc4pEgURKWfHKji9a
mRgDQnIzMfEEru7VsNoX597lj4WhYtio6cD+bchpeED5OzKlKWIOfU73zyII+bSp
O1kjEEk3e7p/RI33bzkwFY6piKP/1w9rhYPLMlZ8wry7PXdLEIr8YOH39PHDkQOa
+7uc8ZvWfMumNG0Eeg7cI6LyHZM5ZVsiFdbqgkfDe2ICZOOW8PvJd7EmA4yjNdJk
qILizoC2yvct84ULHvjBxiOMCS3tLkKp97fF09UQ9wAoe1IQFe+XyIHgh6kLMNFF
GnAzMtrpF9nNff5SmytHM+PhgCGJ87ps40Jk+As4z74U7nZhg3qLV/Mef6WZsfon
kwKCAQEAgoWjsNKl+Ot/h7hxyn2VrnyvPMVXLuiMBZW+k9Atjzpp11O5Be9pv6+q
i0nSd+U2zAtjhTmxUMcawO8qS5d/gjalbjS1YMBYV0xOM0PBuj1l85VgFwfINerE
Hbt8sUVdsLL5nuPbJKbp4N82oWJyuhCo5N/ZOIhwj7j2cR2/6QgzAcKdEmcAZ5+n
TmSjN5UaihL9JFETo1Rf3CxR5nJoszPYHQs5Zhdi6QEDn6Vx8y1BdKN3s177NYl+
//D+z8HfK5vvKqk0bkvSY9+uGUbWJ8asiOYX7zGJ3og2+6Ch9QN07BTtpMza8jj8
L7mx+iwKBKtwPqjyVQrJAt1hIfMj2A==
-----END PRIVATE KEY-----

```


---

### 📄 `docker-compose.template.yml` [553 octets]
<a id="docker-compose-template-yml"></a> [↩ Retour à l'arborescence](#tree-docker-compose-template-yml)

> **Chemin relatif** : `docker-compose.template.yml`  
> **Taille** : 553 octets  
> **Lignes** : 21  
> **Type** : yaml

```yaml
version: "3.0"

services:
  cooker:
    image: pasta-cooker
    init: true
    environment:
      BASE_DIR: "/var/pasta-cooker"
      SSH_DIR: "TODO" # path to your host's .ssh dir
      SHOULD_PULL_INVENTORY: "false"
      SHOULD_PULL_PROJECT: "false"
      SECRET_KEY: "TODO" # a secure key
      GIT_CONNECTION_URL: "TODO" # url to pull from git
      INVENTORY_PATH: "TODO"
      EXECUTION_MODE: "ansible-docker"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - /var/pasta-cooker:/var/pasta-cooker
    ports:
      - 3000:3000

```


---

### 📄 `Dockerfile` [257 octets]
<a id="Dockerfile"></a> [↩ Retour à l'arborescence](#tree-Dockerfile)

> **Chemin relatif** : `Dockerfile`  
> **Taille** : 257 octets  
> **Lignes** : 17  
> **Type** : dockerfile

```dockerfile
FROM node:16.13.1

WORKDIR /opt/app/

RUN apt-get update && apt-get install -y vim && apt-get clean;

COPY .npmrc .
COPY package-lock.json .
COPY package.json .
COPY .pastarc.json .

RUN npm ci --production

COPY dist/ ./dist/

CMD ["node", "dist/main.js"]

```


---

### 📄 `README.md` [1.909 octets]
<a id="README-md"></a> [↩ Retour à l'arborescence](#tree-README-md)

> **Chemin relatif** : `README.md`  
> **Taille** : 1.909 octets  
> **Lignes** : 20  
> **Type** : markdown

````markdown
# Intro

Pasta-cooker est un projet permettant d'exécuter des playbooks [Ansible](https://www.ansible.com/) à distance.
Ce repo contient le code serveur.

![Schema de fonctionnement](docs/Schema.jpeg)

## Config

- `PASTA_COOKER_BASE_DIR`: Le répertoire dans lequel pasta-cooker va travailler. `/tmp/pasta-cooker` par défaut
- `PASTA_COOKER_SSH_DIR`: Le répertoire dans lequel pasta-cooker va aller chercher les clés SSH qu'il fournira à Ansible. `~/.ssh` par défaut
- `PASTA_COOKER_GIT_CONNECTION_URL`: L'url de base dans laquelle pasta-cooker ira chercher les projets git qu'on lui demande de cloner.
- `PASTA_COOKER_SECRET_KEY`: La clé secrète que le client doit fournir pour s'authentifier
- `PASTA_COOKER_SHOULD_PULL_PROJECT`: Si `true`, le nom de projet passé en paramètre par le client sera cherché puis cloné depuis `PASTA_COOKER_GIT_CONNECTION_URL`. Si `false`, il sera cherché dans le projet local `${PASTA_COOKER_BASE_DIR}/project`
- `PASTA_COOKER_SHOULD_PULL_INVENTORY`: Si `true`, l'inventaire de machine sera cloné depuis `PASTA_COOKER_INVENTORY_PATH`. Si `false`, il utilisera l'inventaire local dans `${PASTA_COOKER_BASE_DIR}/inventory`
- `PASTA_COOKER_SSL_KEY_PATH`: Chemin ou trouver la partie privée du certificat SSL (Les certificats fournis dans le dépôts sont utilise pour le développement, et autorise uniquement les connexions sur localhost. Ils ne sont pas utilisés en production)
- `PASTA_COOKER_SSL_CERT_PATH`: Chemin ou trouver la partie publique du certificat SSL (Les certificats fournis dans le dépôts sont utilise pour le développement, et autorise uniquement les connexions sur localhost. Ils ne sont pas utilisés en production)
- `PASTA_COOKER_EXECUTION_MODE`: Mode d'execution. Supporte `ansible-local` qui utilise un ansible installé sur la machine, et `ansible-docker` qui utilise l'image docker défini par `PASTA_COOKER_ANSIBLE_DOCKER_IMAGE`
a

````


---

### 📄 `src/ansible/ansible-docker/ansible.cfg` [107 octets]
<a id="src-ansible-ansible-docker-ansible-cfg"></a> [↩ Retour à l'arborescence](#tree-src-ansible-ansible-docker-ansible-cfg)

> **Chemin relatif** : `src/ansible/ansible-docker/ansible.cfg`  
> **Taille** : 107 octets  
> **Lignes** : 5  
> **Type** : ini

```ini
[defaults]
inventory = inventory/inventory.ini
interpreter_python=/usr/bin/python3
host_key_checking=False

```


---

### 📄 `src/ansible/ansible-docker/Dockerfile` [70 octets]
<a id="src-ansible-ansible-docker-Dockerfile"></a> [↩ Retour à l'arborescence](#tree-src-ansible-ansible-docker-Dockerfile)

> **Chemin relatif** : `src/ansible/ansible-docker/Dockerfile`  
> **Taille** : 70 octets  
> **Lignes** : 8  
> **Type** : dockerfile

```dockerfile
FROM python:3

RUN pip install ansible

WORKDIR /run

CMD ["ansible"]

```


---

### 📄 `src/ansible/ansible-local/ansible.cfg` [107 octets]
<a id="src-ansible-ansible-local-ansible-cfg"></a> [↩ Retour à l'arborescence](#tree-src-ansible-ansible-local-ansible-cfg)

> **Chemin relatif** : `src/ansible/ansible-local/ansible.cfg`  
> **Taille** : 107 octets  
> **Lignes** : 5  
> **Type** : ini

```ini
[defaults]
inventory = inventory/inventory.ini
interpreter_python=/usr/bin/python3
host_key_checking=False

```


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

`````

</details>


---

### 📄 `si/pastacooker-back.analysis.md` [15.355 octets]
<a id="si-pastacooker-back-analysis-md"></a> [↩ Retour à l'arborescence](#tree-si-pastacooker-back-analysis-md)

> **Chemin relatif** : `si/pastacooker-back.analysis.md`  
> **Taille** : 15.355 octets  
> **Lignes** : 483  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (483 lignes) - Cliquer pour déplier</summary>

````markdown
# ?? Analyse complète de `pasta-cooker-back`

> ? Projet : `pasta-cooker-back`  
> ?? Chemin racine : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\pasta-cooker-back`  
> ?? Objectif principal : *exécuter des playbooks Ansible à distance via une API serveur*  
> ?? Base danalyse : **seulement les fichiers fournis** (14 fichiers, 0 hypothèse externe)

---

## ?? Sommaire

1. [Vue densemble](#-vue-densemble)
2. [Analyse fonctionnelle](#-analyse-fonctionnelle)
   - [Acteurs](#acteurs)
   - [Cas dusage](#cas-dusage)
   - [Règles métier](#règles-métier)
   - [Workflow dexécution](#workflow-dexécution)
3. [Analyse technique](#-analyse-technique)
   - [Architecture globale](#architecture-globale)
   - [Modules et responsabilités](#modules-et-responsabilités)
   - [Dépendances & outils](#dépendances--outils)
   - [Sécurité](#sécurité)
   - [Dette technique](#dette-technique)
4. [Modélisations détaillées (PlantUML)](#-modélisations-détaillées-plantuml)
   - [Diagrammes dacteurs / cas dusage](#diagramme-dacteurs--cas-dusage)
   - [Diagramme de classes (structure de config)](#diagramme-de-classes-structure-de-config)
   - [Diagramme de séquence (exécution typique)](#diagramme-de-séquence-exécution-typique)
   - [Diagramme de déploiement](#diagramme-de-déploiement)
   - [Diagramme détats (exécution mode)](#diagramme-détats-mode-dexécution)
   - [Swimlane (Workflow principal)](#swimlane-workflow-principal)
5. [Annexes](#-annexes)
   - [Variables denvironnement](#variables-denvironnement)
   - [Fichiers critiques à compléter](#fichiers-critiques-à-compléter)

---

## ?? Vue densemble

`pasta-cooker-back` est un **serveur Node.js** qui orchestre lexécution d**Ansible** (via local ou Docker), destiné à être invoqué par un client distant.

Il est conçu pour :
- Cloner dynamiquement des projets Git (playbooks + inventaires),
- Exécuter des playbooks,
- Utiliser des certificats TLS (dev-only dans le dépôt),
- Être déployé via Docker / `docker-compose`.

Il **ne contient pas** de code applicatif (pas de `src/main`, `dist/` absent, `package.json` non listé), ce qui suggère un état *intermédiaire de build*.

---

## ????? Analyse fonctionnelle

### Acteurs

| Acteur | Description | Origine (fichiers) |
|--------|-------------|---------------------|
| **Client distant** | Appelle le serveur pour déclencher un playbook | `README.md` (schéma de fonctionnement), variables `SECRET_KEY`, `GIT_CONNECTION_URL` |
| **Serveur `pasta-cooker`** | API Node.js exposant une interface dexécution | `Dockerfile`, `README.md` |
| **Ansible** | Moteur dexécution (local ou via conteneur Docker) | `src/ansible/*/`, `EXECUTION_MODE`, `ansible.cfg` |
| **Git / dépôt distant** | Source des projets (playbooks) et inventaires | `SHOULD_PULL_PROJECT`, `SHOULD_PULL_INVENTORY`, `GIT_CONNECTION_URL` |

---

### Cas dusage

```plantuml
@startuml
left to right direction
actor "Client distant" as C
rectangle "pasta-cooker-back" {
  C --> (Authentifier\navec SECRET_KEY)
  C --> (Demander exécution\nplaybook)
  (Authentifier\navec SECRET_KEY) .> (Demander exécution\nplaybook) : <<include>>
  (Demander exécution\nplaybook) --> (Cloner projet si\nSHOULD_PULL_PROJECT=true)
  (Demander exécution\nplaybook) --> (Cloner inventaire si\nSHOULD_PULL_INVENTORY=true)
  (Cloner projet si\nSHOULD_PULL_PROJECT=true) --> (Lancer Ansible)
  (Cloner inventaire si\nSHOULD_PULL_INVENTORY=true) --> (Lancer Ansible)
  (Lancer Ansible) --> (Renvoyer résultat)
}
@enduml
```

> ? **4 cas dusage principaux** :
> 1. Authentification (par clé secrète)
> 2. Exécution dun playbook depuis dépôt local ou distant
> 3. Gestion dynamique de linventaire (local ou distant)
> 4. Choix du mode dexécution Ansible (`ansible-local` vs `ansible-docker`)

---

### Règles métier

#### Règle 1  Source du projet (playbook)

| Condition | Action |
|-----------|--------|
| `SHOULD_PULL_PROJECT=true` | Clone depuis `GIT_CONNECTION_URL/<project_name>` vers `${BASE_DIR}/project` |
| `SHOULD_PULL_PROJECT=false` | Utilise `${BASE_DIR}/project` (déjà présent) |

#### Règle 2  Source de linventaire

| Condition | Action |
|-----------|--------|
| `SHOULD_PULL_INVENTORY=true` | Clone depuis `INVENTORY_PATH` vers `${BASE_DIR}/inventory` |
| `SHOULD_PULL_INVENTORY=false` | Utilise `${BASE_DIR}/inventory` (déjà présent) |

#### Règle 3  Mode dexécution Ansible

Valeur de `EXECUTION_MODE` :
- `"ansible-local"` ? exécute `ansible-playbook` sur la machine hôte (via `ansible.cfg` dans `src/ansible/ansible-local/`)
- `"ansible-docker"` ? execute via conteneur Docker basé sur `src/ansible/ansible-docker/Dockerfile`

> ?? Les deux `ansible.cfg` sont *identiques* (mêmes paramètres), ce qui simplifie la compatibilité.

#### Règle 4  Authentification

- **Obligatoire** via `SECRET_KEY`.
- Pas de mécanisme dauth avancé visible (JWT, OAuth).

#### Règle 5  TLS (développement uniquement)

- Les certificats (`certs/cert.pem`, `certs/key.pem`) sont **expirés** (valables jusquau `2023-12-01`) et **réservés à `localhost`**.
- En production, le serveur doit utiliser `PASTA_COOKER_SSL_KEY_PATH` / `PASTA_COOKER_SSL_CERT_PATH`.

---

### Workflow dexécution

```plantuml
@startuml
title Workflow d'exécution d'un playbook

(*) --> "Authentification\n(SECRET_KEY)"

if "Cloner projet ?" then
  -->[SHOULD_PULL_PROJECT=true] "git clone GIT_CONNECTION_URL\n? BASE_DIR/project"
else
  -->[false] "Utiliser BASE_DIR/project"
endif

if "Cloner inventaire ?" then
  -->[SHOULD_PULL_INVENTORY=true] "git clone INVENTORY_PATH\n? BASE_DIR/inventory"
else
  -->[false] "Utiliser BASE_DIR/inventory"
endif

--> "Déterminer EXECUTION_MODE"

if "Mode ?" then
  -->[ansible-local] "Exécuter ansible-playbook\nvia config locale"
  -->[ansible-docker] "Lancer conteneur Docker\navec volume BASE_DIR"
endif

--> "Renvoyer logs/résultat au client"
--> (*)
@enduml
```

---

## ?? Analyse technique

### Architecture globale

```plantuml
@startuml
package "Client distant" {
  [API Client]
}

node "Serveur pasta-cooker" {
  [Node.js API]
  [Config Env]
  [TLS Layer]
  [Ansible Executor]
}

cloud "Git" {
  [Dépôt playbooks]
  [Dépôt inventaires]
}

database "État local" {
  folder "BASE_DIR/project"
  folder "BASE_DIR/inventory"
}

[API Client] --> [Node.js API] : HTTPS (SECRET_KEY)\n/playbook?name=...
[Node.js API] --> [Config Env] : lecture
[Node.js API] --> [TLS Layer] : SSL (certs/)
[Node.js API] ..> [Dépôt playbooks] : git clone\n(SHOULD_PULL_PROJECT)
[Node.js API] ..> [Dépôt inventaires] : git clone\n(SHOULD_PULL_INVENTORY)
[Node.js API] --> [État local]
[Node.js API] --> [Ansible Executor]

note right of [Ansible Executor]
  Deux implémentations :
  - ansible-local : binaire sur host
  - ansible-docker : conteneur à la volée
end note
@enduml
```

---

### Modules et responsabilités

| Module / Dossier | Responsabilité | Fichiers associés |
|------------------|----------------|-------------------|
| `certs/` | Stockage certificats TLS (dev) | `cert.pem`, `key.pem` |
| `src/ansible/ansible-local/` | Config Ansible exécuté sur hôte | `ansible.cfg` |
| `src/ansible/ansible-docker/` | Image Docker + config Ansible conteneurisée | `Dockerfile`, `ansible.cfg` |
| Racine | Build & déploiement | `Dockerfile`, `docker-compose.template.yml`, `.gitlab-ci.yml` |
| CI/CD | Intégration via GitLab | `.gitlab-ci.yml` |

---

### Dépendances & outils

| Type | Outil | Preuve |
|------|-------|--------|
| Runtime serveur | Node.js 16.13.1 | `Dockerfile`: `FROM node:16.13.1` |
| Gestion paquets | `npm` (registry privé) | `.npmrc`, `npm ci --production` |
| Ansible | `ansible` (via `pip`) | `src/ansible/ansible-docker/Dockerfile` |
| Build | Docker, Docker Compose | `Dockerfile`, `docker-compose.template.yml` |
| CI | GitLab CI | `.gitlab-ci.yml` |
| Linting | ESLint | `.eslintignore` |

> ?? Aucun `package.json` dans larborescence fournie ? probablement généré à la build ou absent du commit.

---

### Sécurité

| Problème | Détail | Fichier(s) |
|----------|--------|------------|
| ?? **Clé privée exposée** | `certs/key.pem` est dans le dépôt | ?? **Grave**  doit être supprimée / `.gitignore` |
| ?? **Certificat expiré** | Valide jusquau `2023-12-01` (? obsolète en 2025) | `certs/cert.pem` |
| ?? **Hostname fixe `localhost`** | Ne permet pas dusage hors localhost | `cert.pem` (CN=`localhost`) |
| ?? **Auth faible** | `SECRET_KEY` en clair dans `docker-compose.template.yml` | `docker-compose.template.yml` |
| ?? **Pas de HTTPS obligatoire** | TLS optionnel (dev-only), pas de force en prod visible | `README.md` |
| ?? **Socket Docker exposé** | Volume `/var/run/docker.sock` ? privilège escalade possible | `docker-compose.template.yml` |

---

### Dette technique

| Point | Gravité | Justification |
|-------|---------|---------------|
| ? `TODO` dans `docker-compose.template.yml` | Haute | 4 champs non renseignés (`SSH_DIR`, `SECRET_KEY`, `GIT_CONNECTION_URL`, `INVENTORY_PATH`) ? non déployable tel quel |
| ??? Image Node.js obsolète | Moyenne | `node:16.13.1` (EOL depuis 2023) |
| ?? `dist/` non présent | Bloquante | `Dockerfile` copie `dist/`, mais répertoire absent ? build échoue sûrement |
| ?? Pas de tests visibles | Moyenne | `.gitignore` exclut `/coverage`, mais aucun test listé |
| ?? Pas de healthcheck / readiness probe | Faible | Manquant dans `docker-compose.template.yml` |

---

## ?? Modélisations détaillées (PlantUML)

### Diagramme dacteurs & cas dusage (complément)

```plantuml
@startuml
left to right direction
actor Client
rectangle "pasta-cooker-back" {
  usecase "Authentifier" as UC1
  usecase "Lancer un playbook" as UC2
  usecase "Configurer mode exécution" as UC3
  usecase "Gérer inventaire dynamique" as UC4

  UC1 .> UC2 : <<include>>
  UC3 .. UC2 : <<extend>>
  UC4 .. UC2 : <<extend>>
}
Client --> UC1
Client --> UC2
Client --> UC3
Client --> UC4
@enduml
```

---

### Diagramme de classes (structure de configuration)

```plantuml
@startuml
class PastaCookerConfig {
  + BASE_DIR: String = "/tmp/pasta-cooker"
  + SSH_DIR: String = "~/.ssh"
  + SECRET_KEY: String
  + GIT_CONNECTION_URL: String
  + INVENTORY_PATH: String
  + SHOULD_PULL_PROJECT: Boolean
  + SHOULD_PULL_INVENTORY: Boolean
  + EXECUTION_MODE: "ansible-local" | "ansible-docker"
  + SSL_KEY_PATH: String
  + SSL_CERT_PATH: String
}

class ExecutionMode {
  <<enumeration>>
  ansible-local
  ansible-docker
}

PastaCookerConfig --> ExecutionMode : utilise
@enduml
```

---

### Diagramme de séquence (exécution typique)

```plantuml
@startuml
actor Client
participant "API Node.js" as API
participant "Git" as Git
participant "Ansible\nExecutor" as Ansible
participant "Docker\nEngine" as Docker

Client -> API: POST /playbook\n{project: "x", inventory: "y"}\n+ SECRET_KEY
API -> API: Valider SECRET_KEY
alt SHOULD_PULL_PROJECT = true
  API -> Git: git clone GIT_CONNECTION_URL/x
  Git --> API: OK
endif
alt SHOULD_PULL_INVENTORY = true
  API -> Git: git clone INVENTORY_PATH/y
  Git --> API: OK
endif
API -> API: Choisir EXECUTION_MODE
alt ansible-docker
  API -> Docker: docker run -v BASE_DIR:/run\nansible-playbook ...
  Docker -> Ansible: exécute playbook
  Ansible --> Docker: logs
  Docker --> API: sortie
else ansible-local
  API -> Ansible: ansible-playbook -i inventory ...\n(avec ansible.cfg)
  Ansible --> API: sortie
endif
API --> Client: {status, logs}
@enduml
```

---

### Diagramme de déploiement

```plantuml
@startuml
package "Client" {
  [Navigateur / Script]
}

node "Serveur hôte" {
  artifact "pasta-cooker\n(container)" as cooker {
    file "Dockerfile"
    file "dist/main.js"
  }

  artifact "Ansible (local)" as ansible_local #lightblue
  node "Docker Engine" as docker {
    artifact "ansible:python" as ansible_docker {
      file "Dockerfile (ansible-docker/)"
    }
  }

  folder "BASE_DIR" as basedir #lightgreen
  folder ".ssh" as sshdir #lightyellow
}

cooker --> ansible_local : EXECUTION_MODE=ansible-local
cooker --> docker : EXECUTION_MODE=ansible-docker
cooker --> basedir : volumes
cooker --> sshdir : mount SSH_DIR
cooker --> [Navigateur / Script] : HTTPS:3000
@enduml
```

---

### Diagramme détats (mode dexécution)

```plantuml
@startuml
[*] --> AttenteRequete

state AttenteRequete {
  [*] --> Pret
  Pret --> Clonage : SHOULD_PULL_* = true
  Pret --> Execution : SHOULD_PULL_* = false
}

state Clonage {
  [*] --> ClonerProjet
  ClonerProjet --> ClonerInventaire : ok
  ClonerProjet --> Erreur : échec git
  ClonerInventaire --> Execution : ok
  ClonerInventaire --> Erreur : échec git
}

state Execution {
  [*] --> ChoisirMode
  ChoisirMode --> ExecLocal : ansible-local
  ChoisirMode --> ExecDocker : ansible-docker
  ExecLocal --> Resultat : ansible-playbook termine
  ExecDocker --> Resultat : docker run termine
}

Resultat --> AttenteRequete
Erreur --> AttenteRequete
@enduml
```

---

### Swimlane (Workflow principal)

```plantuml
@startuml
|Client|
start
:Envoyer requête\navec SECRET_KEY\n+ paramètres;
|API pasta-cooker|
if (SECRET_KEY valide?) then (non)
  :401 Unauthorized;
  stop
endif
if (SHOULD_PULL_PROJECT?) then (oui)
  :git clone projet;
endif
if (SHOULD_PULL_INVENTORY?) then (oui)
  :git clone inventaire;
endif
:Charger ansible.cfg;
if (EXECUTION_MODE?) then (ansible-local)
  :Exécuter localement;
else (ansible-docker)
  :docker run\navec volume BASE_DIR;
endif
:Capturer sortie;
|Client|
:Renvoyer résultat\n(200 + logs);
stop
@enduml
```

---

## ?? Annexes

### Variables denvironnement

| Variable | Valeur par défaut | Obligatoire ? | Utilisation |
|----------|-------------------|---------------|-------------|
| `BASE_DIR` | `/tmp/pasta-cooker` | Non | Répertoire de travail |
| `SSH_DIR` | `~/.ssh` | Non | Clés SSH pour Ansible |
| `GIT_CONNECTION_URL` |  | Oui (si `SHOULD_PULL_PROJECT=true`) | URL racine Git des playbooks |
| `SECRET_KEY` |  | Oui | Authentification client |
| `SHOULD_PULL_PROJECT` | `false` | Non | Clone projet avant exécution |
| `SHOULD_PULL_INVENTORY` | `false` | Non | Clone inventaire avant exécution |
| `INVENTORY_PATH` |  | Oui (si `SHOULD_PULL_INVENTORY=true`) | URL Git de linventaire |
| `EXECUTION_MODE` | ? (non spécifié) | Oui | `"ansible-local"` ou `"ansible-docker"` |
| `SSL_KEY_PATH` |  | Non (dev: `certs/key.pem`) | Clé privée TLS |
| `SSL_CERT_PATH` |  | Non (dev: `certs/cert.pem`) | Certificat TLS |

> ?? Source : `README.md` + `docker-compose.template.yml`

---

### Fichiers critiques à compléter

| Fichier | Problème | Action requise |
|--------|----------|----------------|
| `docker-compose.template.yml` | 4× `TODO` | Remplacer par valeurs réelles (sécurisées via secrets) |
| `certs/key.pem` | Exposé dans Git | Supprimer + ajouter à `.gitignore` + utiliser secrets en prod |
| `Dockerfile` | `COPY dist/` mais `dist/` absent | Vérifier build (`npm run build` ?) |
| `.gitlab-ci.yml` | Inclut un fichier externe | Vérifier que `snum/pnm3/public/pasta/pasta-ci/applications/back.yml` existe et est accessible |


````

</details>


---

### 📄 `si/primes.analysis.md` [12.596 octets]
<a id="si-primes-analysis-md"></a> [↩ Retour à l'arborescence](#tree-si-primes-analysis-md)

> **Chemin relatif** : `si/primes.analysis.md`  
> **Taille** : 12.596 octets  
> **Lignes** : 470  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (470 lignes) - Cliquer pour déplier</summary>

````markdown
# ?? Analyse complète de lapplication **PRIMES**

> Application de **gestion et calcul des primes** pour agents publics.  
> Référence : `REHUCIT-GP-PRIMES`, version `1.16.5` (10/06/2024)

---

## ?? Sommaire

- [1. Vue densemble](#1-vue-densemble)
- [2. Partie fonctionnelle](#2-partie-fonctionnelle)
  - [2.1. Acteurs](#21-acteurs)
  - [2.2. Cas dusage](#22-cas-dusage)
  - [2.3. Règles métiers clés](#23-règles-métiers-clés)
  - [2.4. Workflow principal](#24-workflow-principal)
- [3. Partie technique](#3-partie-technique)
  - [3.1. Architecture globale](#31-architecture-globale)
  - [3.2. Modules Maven](#32-modules-maven)
  - [3.3. Dépendances clés](#33-dépendances-clés)
  - [3.4. Sécurité](#34-sécurité)
  - [3.5. Dette technique & risques](#35-dette-technique--risques)
- [4. Annexes](#4-annexes)
  - [4.1. Glossaire fonctionnel](#41-glossaire-fonctionnel)
  - [4.2. Diagrammes détaillés](#42-diagrammes-détaillés)

---

## 1. Vue densemble

Lapplication **PRIMES** permet la **gestion réglementaire** et le **calcul automatisé** des primes versées aux agents publics, en lien avec :
- les **fonctions**, **grades**, **échelons**, **services**
- les **mouvements** (mutations, affectations)
- des **règles de plafonnement**, **harmonisation**, et **droits individuels**

Elle intègre :
- une **interface web** (Struts 2 + JSP + FreeMarker)
- une **base de données relationnelle** (scripts SQL fournis)
- des **traitements batch** (calcul, harmonisation)
- une **intégration avec Talend** (ETL)
- une **génération de documents** (ODT ? PDF via Quarto Publisher)

---

## 2. Partie fonctionnelle

### 2.1. Acteurs

```plantuml
@startuml
actor "Agent" as A
actor "Gestionnaire RH" as RH
actor "Administrateur" as ADM
actor "Système REHUCIT" as REHUCIT
actor "Batch" as BATCH

A --> (Consulter mes droits)
A --> (Déclarer compléments IFSE)

RH --> (Gérer les agents)
RH --> (Simuler un calcul)
RH --> (Lancer une harmonisation)

ADM --> (Gérer les référentiels)
ADM --> (Importer des données)
ADM --> (Gérer les regroupements)

BATCH --> (Exécuter un calcul mensuel)
REHUCIT --> (Importer des mouvements)
@enduml
```

> ? **3 profils humains** + **2 systèmes externes** (`REHUCIT`, batchs).

---

### 2.2. Cas dusage majeurs (extrait)

| Cas dusage | Description | Modules impliqués |
|-------------|-------------|------------------|
| `Gérer un agent` | Saisie/mise à jour des données (matricule, grade, service, etc.) | `agents`, `reglementaire`, `administration` |
| `Simuler un calcul de prime` | Simulation interactive pour un agent et un mois donné | `calculPrimes`, `simulationDetail.jsp` |
| `Lancer une harmonisation CIA` | Génération de notifications PDF pour agents non conformes | `harmonisation`, `PublisherManager`, `ConverterManager` |
| `Importer des données CSV` | Grille dimport (agents, grades, services, etc.) | `*ImportDTO.java`, `ImportCSVHelper.java` |
| `Gérer les regroupements` | Regrouper grades/services pour mutualiser les règles | `RegroupServicesDAO.java`, `gradesRegroupementDetail.jsp` |

---

### 2.3. Règles métiers clés

#### ?? Domaines réglementaires

- **Clôture de droits** après mutation (`AccueilMutationAction.java`)
- **Plafonnement** par grade/fonction (`PrimesMontantPlafondDetailAction.java`)
- **Bonification** selon ancienneté / situation spécifique (`valeurBonificationAgent.jsp`)
- **Harmonisation** selon règles métier strictes (ex. si écart > X%, notifier)

#### ?? Exemple de règle (extrait de code implicite)

> _Si un agent est affecté à un service hors ministère (`AGENT_HORS_MINISTERE`) et quil na pas de `TgNumDossier`, alors il est éligible à une prime spécifique (iss/IFSE), sous réserve de déclaration._

Voir :
- `TgNumDossierImportDTO.java`
- `complementIssDetail.jsp`
- `DeclarationComplementIfseDetailAction.java`

---

### 2.4. Workflow principal : **Calcul dune prime**

```plantuml
@startuml
title Cycle de calcul d'une prime mensuelle

[*] --> SaisieCritères
SaisieCritères --> Simulation : "valider"
Simulation --> Calcul : "lancer calcul"
Calcul --> ExportCSV : "résultats"
ExportCSV --> GénérationBordereau : "valider"
GénérationBordereau --> [*] : "bordereau généré"

note right of Simulation
  Utilise DetailCalculAction
  et ResultatCalculAction
end note

note right of Calcul
  Batch ou action interactive
  (calpriAgent peut être appelé)
end note

note right of GénérationBordereau
  generationBordereauJobDao.ksp
  + PublisherManager
end note
@enduml
```

---

## 3. Partie technique

### 3.1. Architecture globale (macro)

```plantuml
@startuml
!theme aws-orange

package "Frontend\n(Struts2 + JSP/FreeMarker)" {
  [index.html]
  [accueil.jsp]
  [complementIssDetail.jsp]
  [simulationDetail.jsp]
}

package "Contrôleurs\n(*Action.java)" {
  [AgentsListAction]
  [DetailCalculAction]
  [MutationDetailAction]
}

package "Services\n(*Services.java / *ServicesImpl.java)" {
  [AgentsServices]
  [CalculPrimesServices]
  [HarmonisationServices]
}

package "DAOs\n(générés ou manuels)" {
  [AgentDAO]
  [EchelonDAO]
  [QuotitesDAO]
}

database "Base de données\n(Oracle/PostgreSQL)" {
  frame "Schéma PRIMES" {
    [AGENT]
    [GRADE]
    [SERVICE]
    [PRIME]
    [MUTATION]
    [DETAIL_CALCUL]
  }
}

[Frontend\n(Struts2 + JSP/FreeMarker)] --> [Contrôleurs\n(*Action.java)]
[Contrôleurs\n(*Action.java)] --> [Services\n(*Services.java / *ServicesImpl.java)]
[Services\n(*Services.java / *ServicesImpl.java)] --> [DAOs\n(générés ou manuels)]
[DAOs\n(générés ou manuels)] --> [Base de données\n(Oracle/PostgreSQL)]

package "Batchs" {
  [CalpriAgent.java]
  [BatchLancementAction.java]
  [harmonisationJob]
}

cloud "Systèmes externes" {
  [REHUCIT]
  [Talend]
  [Cerbère/LDAP]
}

[Batchs] --> [Services]
[Batchs] --> [DAOs]
[Talend] --> [Base de données]
[REHUCIT] --> [Batchs]
[Cerbère/LDAP] --> [Frontend]

@enduml
```

> ? Architecture **stratifiée classique** (web ? service ? DAO ? DB), avec composants batchs et ETL.

---

### 3.2. Modules Maven

```plantuml
@startuml
package "primes" {
  folder "primes-database" {
    file "contraintes.sql"
    file "donnees-test.sql"
    file "update_1.13.1_to_1.14_typologie_1794-complement.sql"
  }
  folder "primes-talend" {
    file "assembly.xml"
    note "Jobs ETL (v5.6.0)"
  }
  folder "primes-batch" {
    file "CalpriAgent.java"
  }
  folder "primes-web" {
    folder "src/main/java"
    folder "src/main/resources"
    folder "src/main/webapp"
  }
  folder "primes-doc"
  folder "primes-deployment"
}
@enduml
```

- ? `primes-database` : versionné, avec migrations (`update_*.sql`)
- ? `primes-talend` : jobs pour import/export
- ? `primes-web` : cur applicatif (95 % du code fourni)
- ? `primes-deployment` : désactivé dans `<modules>` (`<!--<module>primes-deployment</module>-->`)

---

### 3.3. Dépendances clés (extrait de `pom.xml`)

| Technologie | Version | Usage |
|-------------|---------|-------|
| **Java** | `1.8` | Runtime minimal |
| **Struts 2** | implicite | Framework MVC web |
| **Hibernate** | `5.1.0.Final` | ORM (mapping DB) |
| **Vertigo** | `io.vertigo.*` | Framework interne (Dynamo, Struts2-core, Publisher) |
| **Log4j** | `1.7.6` (slf4j-log4j12) | Journalisation |
| **Quarto Publisher** | implicite | Génération ODT/PDF (via `PublisherManager`) |
| **DisplayTag** | implicite | Tableaux dynamiques en JSP |
| **DataTables** | `AutoFill-2.3.3`, `Scroller-2.0.0`, `Responsive-2.2.2` | Tableaux front enrichis |

> ? Stack **Java EE 7-like**, orientée entreprise (pas de Spring ni Jakarta EE 9+).

---

### 3.4. Sécurité

#### ?? Authentification & Autorisation

- **Cerbère** (SSO gouvernemental) ? filtre XML :
  ```xml
  <!-- cerbere-filtre.xml (19.217 octets) -->
  ```
- Contrôle daccès métier dans les contrôleurs :
  ```java
  import io.vertigo.struts2.exception.VSecurityException;
  // Voir DetailMouvementAdmAction.java, ServicesRegroupementsDetailAction.java
  ```

#### ?? Permissions (extrait implicite)

Dans `PrimesUtil.java` :
```java
import i2.application.primes.controller.accueil.CodesPermissions;
```

=> Le système utilise un **modèle de permissions granulaires** (non détaillé dans les extraits, mais présent).

---

### 3.5. Dette technique & risques

| Type | Élément | Risque |
|------|---------|--------|
| ?? **Obsolète** | Java 8, Hibernate 5.1 (2016), Struts 2 ancien | Vulnérabilités non patchées, incompatibilité future |
| ?? **Dépendances log4j 1.x** | `slf4j-log4j12:1.7.6` | CVE connues (log4j 1.x non maintenu) |
| ?? **Génération de code** | `/javagen/`, `.ksp`, `.kpr` | Couplage fort à outil MDA propriétaire (Vertigo ?) |
| ?? **UI Legacy** | JSP + Struts tags + DisplayTag | Difficile à moderniser (pas de composants réactifs) |
| ?? **Pas de tests unitaires visibles** | Aucun `*Test.java` listé | Risque élevé de régressions |
| ?? **Déploiement manuel ?** | `primes-deployment` désactivé | CI/CD non automatisé (malgré `livraison-continue-kpi.yml`) |

---

## 4. Annexes

### 4.1. Glossaire fonctionnel

| Terme | Définition |
|-------|------------|
| **CIA** | *Complément Individuel dActivité*  prime discrétionnaire |
| **IFSE** | *Indemnité de Fonction, de Suivi et dExpertise* |
| **ISS** | *Indemnité Spécifique de Service*  liée à la mission |
| **Harmonisation** | Processus de rapprochement des primes versées vs réglementaire |
| **TgNumDossier** | Numéro de dossier unique (ex. Téléservice Gestion) |
| **REHUCIT** | Système RH externe (source des mouvements) |
| **PSI** | *Pôle de Services Informatiques* ou *Structure daffectation* |

---

### 4.2. Diagrammes détaillés (supplémentaires)

#### ?? Structure des packages (simplifiée)

```plantuml
@startuml
package i2.application.primes {
  package controller {
    [accueil]
    [agents]
    [reglementaire]
    [calculprimes]
    [harmonisation]
    [mutation]
    [administration]
  }
  package services {
    [agents]
    [reglementaire]
    [calculprimes]
    [harmonisation]
    [administration]
  }
  package dao {
    [agent]
    [reglementaire]
    [administration]
  }
  package model {
    [agents.imports]
    [reglementaire.imports]
    [calculprimes.imports]
  }
}
@enduml
```

#### ?? Cycle de vie dun agent (simplifié)

```plantuml
@startuml
state "Nouvel agent" as NEW
state "Actif" as ACTIVE
state "En mutation" as MUT
state "Hors ministère" as HORS
state "Supprimé" as SUPPR

[*] --> NEW
NEW --> ACTIVE : validation
ACTIVE --> MUT : demande mutation
MUT --> ACTIVE : mutation effective
ACTIVE --> HORS : affectation hors ministère
HORS --> ACTIVE : retour
ACTIVE --> SUPPR : départ définitif
SUPPR --> [*]

note right of HORS
  Utilise table AGENT_HORS_MINISTERE
  et peut déclencher prime ISS
end note
@enduml
```

#### ?? Relations clés (entités métier)

```plantuml
@startuml
' Entités principales
entity "AGENT" as AGT {
  * agt_id
  --
  matricule
  nom
  prenom
  grd_id
  ser_id
  psi_id
}

entity "GRADE" as GRD {
  * grd_id
  --
  code
  libelle
}

entity "SERVICE" as SER {
  * ser_id
  --
  code
  libelle
}

entity "PRIME" as PRI {
  * pri_id
  --
  code
  libelle
  montant_plafond
}

entity "MUTATION" as MUT {
  * mut_id
  --
  agt_id
  date_mutation
  ser_depart_id
  ser_arrivee_id
}

entity "DETAIL_CALCUL" as DET {
  * det_id
  --
  agt_id
  pri_id
  montant
  mois_paie
}

AGT ||--o{ GRD
AGT ||--o{ SER
AGT ||--o{ MUT
AGT ||--o{ DET
DET }o--|| PRI
@enduml
```

---

## ? Conclusion

**PRIMES** est une **application métier mature**, fortement réglementée, avec :

- ? Une **modélisation riche** (agents, grades, mouvements, primes)
- ? Une **automatisation poussée** (calculs, harmonisation, documents)
- ? Un **contrôle fin** (permissions, validation, workflows)

Mais elle souffre de :

- ?? Une **stack technique vieillissante**
- ?? Une **dette technique implicite** (UI legacy, dépendances critiques)
- ?? Une **dépendance forte à des outils propriétaires** (Vertigo, MDA)

? Recommandation : **audit de sécurité approfondi** + **feuille de route de modernisation** (ex. migration vers Spring Boot + React/Vue, suppression de log4j 1.x).

---

> ?? Ce document est autoporté : collez-le dans un `.md`, activez le rendu PlantUML, et cest prêt.  
> Aucune information externe na été supposée.


````

</details>


---

### 📄 `si/primesauto.analysis.md` [16.817 octets]
<a id="si-primesauto-analysis-md"></a> [↩ Retour à l'arborescence](#tree-si-primesauto-analysis-md)

> **Chemin relatif** : `si/primesauto.analysis.md`  
> **Taille** : 16.817 octets  
> **Lignes** : 570  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (570 lignes) - Cliquer pour déplier</summary>

````markdown
# ?? Analyse approfondie du projet `primesauto`

> **Référence** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\primesauto`  
> **Type de projet** : Application de gestion automatisée de primes (fonction publique), basée sur des tests dinterface et de calculs métier  
> **Technologie** : Java, Selenium WebDriver, TestNG, Apache POI, ExtentReports  
> **Objectif principal** : Valider les règles de calcul de primes (ex. ISS, IFSE, dérogations), la gestion dévénements RH (mutations, grades, quotités), et linterfaçage avec Chrono (paie).

---

## ?? Table des matières

1. [Vue densemble fonctionnelle](#-vue-densemble-fonctionnelle)
2. [Acteurs et cas dusage](#-acteurs-et-cas-dusage)
3. [Règles métier clés](#-règles-métier-clés)
   - 3.1. [Hiérarchie des événements RH](#31-hiérarchie-des-événements-rh)
   - 3.2. [Calcul des primes ISS/IFSE](#32-calcul-des-primes-issifse)
   - 3.3. [Gestion des dérogations & rappels](#33-gestion-des-dérogations--rappels)
   - 3.4. [Intérim (lissé / non lissé)](#34-intérim-lissé--non-lissé)
4. [Workflows majeurs](#-workflows-majeurs)
   - 4.1. [Workflow général de simulation de paie](#41-workflow-général-de-simulation-de-paie)
   - 4.2. [Cycle de vie dun événement RH](#42-cycle-de-vie-dun-événement-rh)
5. [Architecture technique](#-architecture-technique)
   - 5.1. [Vue densemble modulaire](#51-vue-densemble-modulaire)
   - 5.2. [Arborescence logique](#52-arborescence-logique)
   - 5.3. [Dépendances majeures](#53-dépendances-majeures)
6. [Sécurité & qualité](#-sécurité--qualité)
   - 6.1. [CI/CD & analyse statique](#61-cicd--analyse-statique)
   - 6.2. [Dette technique identifiée](#62-dette-technique-identifiée)
7. [Annexes & modèles complets](#-annexes--modèles-complets)

---

## ?? Vue densemble fonctionnelle

Le système `primesauto` est un **framework de tests automatisés** (pas une application front-end), conçu pour :

- Simuler la gestion RH (mutations, événements GRADE/REM/QUOTITE/SERVICE/CLM)
- Valider les **mouvements de paie** générés (rappels, montants ISS/IFSE, dérogations)
- Vérifier lexactitude des **calculs mensuels de primes**
- Exporter les résultats (CSV, rapports HTML via ExtentReports)

?? **Remarque** : Il interagit avec une application web existante (probablement une GPEC ou SIRH interne), via Selenium.

---

## ?? Acteurs et cas dusage

### Acteurs (rôles fonctionnels)

| Acteur | Description |
|-------|-------------|
| **Agent RH** | Saisit/maintient les événements (mutations, primes, quotité) |
| **Système Chrono** | Système de paie externe (interfaçage mensuel/batch) |
| **Test automation engine** (`primesauto`) | Exécute des scénarios préprogrammés à partir de données Excel |

### Cas dusage principaux (extrait de `testng*.xml`, classes de test)

```plantuml
@startuml
left to right direction
actor "Agent RH" as agent
actor "Chrono" as chrono
usecase "Gérer Mutations" as UC1
usecase "Ajouter Événement RH (GRADE/REM)" as UC2
usecase "Calculer Prime ISS/IFSE" as UC3
usecase "Générer Rappels" as UC4
usecase "Exporter CSV" as UC5
usecase "Interfacer avec Chrono" as UC6

agent --> UC1
agent --> UC2
agent --> UC3
agent --> UC5

UC3 --> UC4 : déclenche si mutation rétroactive
UC3 --> UC6 : export batch mensuel
@enduml
```

---

## ?? Règles métier clés

### 3.1. Hiérarchie des événements RH

Le système reconnaît plusieurs types dévénements, avec une priorité implicite (déterminée par les tests de rappel/mutation).

```plantuml
@startmindmap
* Événements RH
** GRADE
*** Code grade (ex. GV0001)
*** Échelon (ex. E01)
*** Date effet
** REM (Rémunération)
*** Régime (01, 02, 05)
*** Code fin de fonction (ex. 90, 92, 99)
*** Date effet
** QUOTITE
*** Code quotité (ML1ML7)
*** Date effet
** SERVICE
*** SLR (3, B, C)
*** Service / Service accueil
** CLM (Congé longue maladie)
*** Code absence (ML1ML7)
*** Date début / reprise
@endmindmap
```

> **Source** : `CommonEvenement.java`, `DataStructure.java`, `J04GestionREM90.java`, `PaieISSDécembre.java`

---

### 3.2. Calcul des primes ISS/IFSE

#### Principe général

Les primes sont calculées mensuellement, **à partir de létat RH courant**, mais tiennent compte :
- Des **coefficients ISS/IFSE** par grade/échelon
- Des **dérogations** (ex. primes exceptionnelles pour détachement)
- Des **intériims** (lissés ou non)
- Des **muta-tions rétroactives** ? déclenchent des **rappels**

#### Algorithme abrégé (daprès `CommonDétailCalculISS.java`, `CommonDétailCalculIFSE.java`)

```java
if (mutation.retroactive) {
  créerRappel(mutation.dateEffet, moisCourant);
}
if (agent.estEnIntérim()) {
  prime = dotation_intérim_lissée ? (dotation / nb_mois) : dotation;
}
if (dérogation.active) {
  prime += dérogation.montant;
}
if (quotité < 100%) {
  prime *= quotité / 100.0;
}
```

#### Diagramme de séquence : Calcul prime ISS mensuelle

```plantuml
@startuml
actor Agent
participant "Simulation\nCalcul Mensuel" as sim
participant "DataParser" as parser
participant "CommonOperations" as ops
participant "CommonDétailCalculISS" as calc
database "Excel (données tests)" as excel

Agent -> sim : lance test J01SimulationCalculMensuel
sim -> parser : parserEntrées(15,19,file,3,"all")
parser -> excel : lit paramètres (matricule, évènements)
parser --> sim : DataStructure[]
sim -> ops : init_agent(matricule, mois, année)
ops -> calc : getMouvementsPaie()
calc --> sim : List<Mouvement>
sim -> calc : vérif_montant_prime_ISS(mouvement, attendu)
@enduml
```

---

### 3.3. Gestion des dérogations & rappels

#### Règle métier clé (extrait de `J04ComplémentExceptionnelIndemnitaire.java`)

> *« Un agent détaché sur emploi fonctionnel de chef de subdivision (REM 96) perçoit un complément exceptionnel, **sauf** sil est en CLM ou en quotité < 50% »*

| Condition | Action |
|----------|--------|
| `REM.régime == "96"` ? `CLM.absent` ? `QUOTITE = 50%` | Ajout dérogation ISS |
| `mutation.dateEffet < datePaieCourante` | Génération rappel automatique |

#### Diagramme de décision (SWIMLANE simplifié)

```plantuml
@startuml
|Agent RH|
start
:Evénement REM 96\n(régime détachement)?;
if (Quotité = 50%?) then (non)
  :Prime = 0;
  stop
endif
if (En CLM?) then (oui)
  :Prime = 0;
  stop
endif

|Système|
:Calculer prime ISS base;
:Ajouter dérogation ISS CMI;
:Stocker mouvement "bleu";

|Chrono|
:Exporter mouvement\nen batch mensuel;
stop
@enduml
```

---

### 3.4. Intérim (lissé / non lissé)

#### Différences clés

| Critère | Intérim **non lissé** | Intérim **lissé** |
|--------|-----------------------|------------------|
| Montant | Perçu intégralement le mois courant | Réparti sur durée (dotation / nb mois) |
| Bouton UI | `"Ajouter un intérim non lissé"` | `"Ajouter un intérim lissé"` |
| Champ `dotation` | Calculée à la volée (`mntRegl`) | Saisie ou calculée (`calculInterim`) |
| Effet paie | Un seul mouvement | Plusieurs mouvements (un par mois) |

#### État machine : Cycle de vie dun intérim

```plantuml
@startuml
[*] --> Saisie
Saisie --> Validation : click "Valider"
Validation --> Enregistré : succès
Enregistré --> Modification : click "Modifier"
Enregistré --> Suppression : click "Supprimer"
Modification --> Validation
Suppression --> [*] : confirmé

state Enregistré {
  [*] --> Visible_dans_tableau
  Visible_dans_tableau --> Exporté_au_batch : mois de paie
}

@enduml
```

---

## ?? Workflows majeurs

### 4.1. Workflow général de simulation de paie

```plantuml
@startuml
title Workflow Simulation Calcul Mensuel

start

:Charger données Excel\n(SAMPLE_XLSX_FILE_PATH_TNR);
:Extraire matricule, évènements,\nmouvements attendus;

repeat
  :Accéder à "Gestion des agents";
  :Rechercher agent par matricule;
  :Cliquer lien matricule;

  :Naviguer vers\n"Simulation du calcul mensuel";
  :Appliquer filtres (matricule, mois, prime);
  :Lancer simulation (click "Simuler");
  
  :Scraping résultats HTML ?\nList<LignePaie>;

  :Comparer montants\nattendus vs obtenus;
repeat while (agents restants?) is (oui)
->non;

if (Tous OK?) then (oui)
  :Marquer test ?;
else (non)
  :Générer screenshot + log erreur;
  :Marquer test ?;
endif

stop
@enduml
```

> **Implémentation** : `J01SimulationCalculMensuel.java`, `CommonOperations.java`

---

### 4.2. Cycle de vie dun événement RH (ex: Mutation)

```plantuml
@startuml
title Cycle Mutation ? Rappel

Agent --> Application : Saisie mutation\n(date effet = 15/03, date saisie = 20/04)

Application --> Batch : Export mutation\nvers Chrono (avril)

Batch --> Chrono : Calcul paie avril\n? prime *pro-rata* mars-avril

Chrono --> Application : Retour mouvements\n(rappel mars en "rouge")

Application --> TestEngine : Vérif présence\nmouvement Rappel_Mutation

TestEngine --> Rapport : ? Rappel détecté\nou ? anomalie
@enduml
```

> **Validation** : `J05GestionMutationVérifCalcul.java`, `Mouvement_Rappel_Mutation.java`

---

## ??? Architecture technique

### 5.1. Vue densemble modulaire

```plantuml
@startcomponent
package "primesauto" {
  [Main] --> [BaseTest]
  [BaseTest] --> [Common*]
  [BaseTest] --> [Model.*]
  [BaseTest] --> [DataRetrieval.*]

  component "Common\n(fonctions partagées)" as common {
    [CommonOperations]
    [CommonEvenement]
    [CommonIntérim]
    [CommonDétailCalculISS]
    [CommonDétailCalculIFSE]
    [CommonBonification]
    [CommonCoefficient]
  }

  component "Model\n(entités métier)" as model {
    [Evènement]
    [Mouvement]
    [Mouvement_Rappel_Mutation]
    [Intérim]
    [Dérogation]
    [Coefficient]
    [DétailCalcul_ISS]
    [DétailCalcul]
  }

  component "DataRetrieval\n(POI + parsing)" as data {
    [DataParser]
    [DataStructure]
  }

  component "Tests\n(TestNG + Selenium)" as tests {
    folder "CalculPrimes"
    folder "GestionPrimes"
    folder "TNR"
    folder "interfaçage_chrono"
  }

  [BaseTest] ..> common : utilise
  tests ..> [BaseTest] : hérite
  tests ..> model : instancie
  tests ..> data : appelle parserEntrées()
  [BaseTest] --> [ExtentReports] : reporting
  [BaseTest] --> [Selenium WebDriver] : pilotage UI
}

[Apache POI] --> data
[TestNG] --> tests
[Selenium] --> [BaseTest]
[ExtentReports] --> [BaseTest]
@endcomponent
```

---

### 5.2. Arborescence logique

```
src/main/java/rgp/primes/
+-- BaseTest.java                ? initialisation WebDriver, reporting
+-- Main.java
+-- Config/
¦   +-- ConfigProperties.java   ? lecture config.properties
+-- Common/                      ? bibliothèque de fonctions métier/test
¦   +-- CommonEvenement.java
¦   +-- CommonIntérim.java
¦   +-- CommonDétailCalculISS.java
¦   +-- ...
+-- Model/                       ? entités métier (POJOs)
¦   +-- Evènement.java
¦   +-- Mouvement.java
¦   +-- Intérim.java
¦   +-- ...
+-- DataRetrieval/               ? parsing Excel ? objets métier
¦   +-- DataParser.java          ? cur du parsing (POI)
¦   +-- DataStructure.java
+-- CalculPrimes/                ? tests unitaires/métier
¦   +-- CalculPrimes_01/
¦   ¦   +-- J01GestionIntérimsFiltres.java
¦   ¦   +-- ...
¦   +-- CalculPrimes_02/
+-- GestionPrimes/
+-- TNR/                         ? Tests de Non-Regression
+-- interfaçage_chrono/          ? interfaçage batch mensuel
```

---

### 5.3. Dépendances majeures

Extrait de `pom.xml` :

| Dépendance | Version | Usage |
|-----------|---------|-------|
| `org.seleniumhq.selenium:selenium-java` | 3.141.59 | Automatisation UI |
| `org.testng:testng` | 6.14.3 | Orchestration tests |
| `org.apache.poi:poi-ooxml` | 4.1.2 | Parsing Excel (XLSX) |
| `com.aventstack:extentreports` | 4.1.7 | Reporting HTML |
| `com.google.collections:google-collections` | 1.0-rc2 | `ImmutableMap` |
| `com.opencsv:opencsv` | 4.0 | Export CSV |

?? **Désuétude** :  
- TestNG 6.14.3 ? version actuelle : 7.10+  
- Selenium 3.x ? version actuelle : 4.x  
? **Dette technique** (voir §6.2)

---

## ?? Sécurité & qualité

### 6.1. CI/CD & analyse statique

#### `.gitlab-ci.yml` ? pipeline typique

```yaml
stages:
  - compile
  - sonarqube-check

compile:
  image: maven:3.6-adoptopenjdk-8
  script:
    - mvn clean compile -s ci_settings.xml
  artifacts:
    paths:
      - "**/*"
    expire_in: 3 days

sonarqube-check:
  script:
    - sonar-scanner -Dsonar.java.binaries=target/classes/rgp/primes
  allow_failure: true
```

> ? Intégration SonarCloud (`sonar-project.properties`)  
> ? Reporting HTML (`Rapport_tests_primes.html`, `rgp_test_automation_report.html`)

---

### 6.2. Dette technique identifiée

| Type | Localisation | Risque | Remédiation proposée |
|------|--------------|--------|----------------------|
| ?? **Encodage implicite** | `System.setProperty("file.encoding", "UTF-8");` dans `BaseTest.java` | Problèmes Windows/Linux | Utiliser `-Dfile.encoding=UTF-8` en JVM args (déjà partiellement fait via `surefire`) |
| ?? **XPath fragiles** | ex. `//*[@id="popin"]/div[3]/div/div/a` | Cassure en cas de MAJ UI | Préférer `By.cssSelector("button.close-popin")` + attributs `data-testid` |
| ?? **Thread.sleep() abusif** | >30 occurrences (`Thread.sleep(3000)`) | Ralentit les tests, non fiable | Remplacer par `WebDriverWait.until(...)` |
| ?? **Parsing Excel manuel** | `DataParser.java` : boucles lignes/colonnes | Complexité O(n·m) + erreurs de mapping | Envisager un binding objet-Excel (ex. `@ExcelColumn("Date effet")`) |
| ?? **Absence de typage événements** | `Map<String, String> ValeursEvenement` | Erreurs de clé ("Date effet" vs "date_effet") | Créer des classes `EvenementREM`, `EvenementCLM` étendant `Evenement` |

---

## ?? Annexes & modèles complets

### A. Modèle `Evènement` (POJO)

```java
public class Evènement {
  private String type;        // "REM", "GRADE", "CLM"
  private String date_effet;
  private String régime;      // REM seulement
  private String codeFin;     // REM seulement
  private String grade;       // GRADE seulement
  private String echelon;     // GRADE seulement
  private String quotité;     // QUOTITE seulement
  private String codeAbsence; // CLM seulement
  private String date_début_arrêt;
  private String date_reprise_versement;
  //  + getters/setters
}
```

> **Source** : `DataParser.java`, `J04GestionREM90.java`

---

### B. Structure fichier Excel (inférée)

| Colonne | Contenu | Exemple |
|--------|---------|---------|
| 1 | Matricule | `G04132164` |
| 2 | Type événement | `REM` |
| 3 | Paramètres (JSON-like) | `{date:"01/09/2024", régime:"96", codeFin:""}` |
| 4 | Type entrée | `Intérim`, `Dérogation` |
| 5 | Valeurs entrée | `{prime:"0605", dateDébut:"01/10/2024", dotation:"1200"}` |
| 6 | Mouvements attendus (ligne/mois) | `ISS janv=210.50, rappel=35.75` |

? Parsing via `parserEntrées(début, fin, file, sheetIndex, période)`.

---

### C. Configuration (`config.properties`)

```properties
app_path=https://primes.rgp.local/
username=herve.marchal
passwd=***
mois_paie_en_cours=04
année_de_paie=2025
tempsCalculBatch=7
profil=ADMIN
```

> Utilisé dans `BaseTest.java` ? `init_driver()`

---

### D. Exemple de test complet (J03ComplémentExceptionnelIndemnitaire)

**Objectif** : Valider prime exceptionnelle pour détachement fonctionnel.

```plantuml
@startuml
title J03  Complément exceptionnel (REM 96)

participant Test as T
participant DataParser as DP
participant CommonEvenement as CE
participant Application as APP

T -> DP : dataProvider()
DP --> T : {matricules, ValeursEvenement_REM96,}

T -> APP : Ouvrir "Gestion des mutations"
T -> APP : Filtrer par matricule
T -> APP : Cliquer "Muter"

T -> CE : ajout_évènement_REMUNERATION(mat, ValeursEvenement_REM96)
CE -> APP : saisir date, régime=96, codeFin=
CE -> APP : valider

T -> APP : Lancer batch de calcul (7s)
T -> APP : Vérifier mouvement "bleu" ISS\navec montant = attendu + dérogation

alt OK
  T --> Rapport : ? PASS
else KO
  T --> Rapport : ? FAIL + screenshot
end
@enduml
```

---

## ? Conclusion

`primesauto` est un **framework de tests robuste**, couvrant :

- ? Une logique métier RH complexe (mutations, quotités, dérogations)
- ? Des algorithmes de calcul de paie éprouvés (ISS/IFSE, rappels, intérim)
- ? Une intégration CI/CD fonctionnelle (GitLab, Sonar, ExtentReports)

**Recommandations prioritaires** :
1. Moderniser les dépendances (Selenium 4, TestNG 7+)
2. Éliminer les `Thread.sleep()` au profit de `WebDriverWait`
3. Typage fort des événements RH ? réduire les erreurs de mapping
4. Ajouter des tests unitaires hors-browser pour `DataParser` et calculs


````

</details>


---

### 📄 `si/RenoiRH-GTA.analysis.md` [17.659 octets]
<a id="si-RenoiRH-GTA-analysis-md"></a> [↩ Retour à l'arborescence](#tree-si-RenoiRH-GTA-analysis-md)

> **Chemin relatif** : `si/RenoiRH-GTA.analysis.md`  
> **Taille** : 17.659 octets  
> **Lignes** : 600  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (600 lignes) - Cliquer pour déplier</summary>

````markdown
# ?? Analyse Technique & Fonctionnelle de **RenoiRH-GTA**  
*(daprès les sources fournies dans `RenoiRH-GTA.md`)*

> ?? Ce rapport est **entièrement autoporté** : tous les diagrammes sont au format **PlantUML** compatible VS Code / Obsidian (avec extension PlantUML ou Mermaid préférée).  
> ?? Aucune hypothèse externe nest faite : toute lanalyse repose sur les extraits de code, fichiers `.dta`, `.lng`, `.h`, `.c`, `makefile`, etc.

---

## ?? Table des matières

- [1. Introduction & Périmètre](#1-introduction--périmètre)
- [2. Vue densemble fonctionnelle](#2-vue-densemble-fonctionnelle)
  - [2.1. Acteurs identifiés](#21-acteurs-identifiés)
  - [2.2. Cas dutilisation principaux](#22-cas-dutilisation-principaux)
  - [2.3. Terminologie métier](#23-terminologie-métier)
- [3. Workflow & Règles métier](#3-workflow--règles-métier)
  - [3.1. Cycle de vie dune session `Ternet`](#31-cycle-de-vie-dune-session-ternet)
  - [3.2. Gestion des fichiers (lock/unlock/transfert)](#32-gestion-des-fichiers-lockunlocktransfert)
  - [3.3. Stratégie de reconnexion & timeout](#33-stratégie-de-reconnexion--timeout)
  - [3.4. Gestion multi-langue (`tndrv.lng`)](#34-gestion-multi-langue-tndrvlng)
- [4. Architecture technique](#4-architecture-technique)
  - [4.1. Arborescence & organisation](#41-arborescence--organisation)
  - [4.2. Dépendances & modules](#42-dépendances--modules)
  - [4.3. Diagramme de composants](#43-diagramme-de-composants)
- [5. Modélisation détaillée](#5-modélisation-détaillée)
  - [5.1. Structures de données clés](#51-structures-de-données-clés)
  - [5.2. Séquence typique : chargement dun MALT](#52-séquence-typique--chargement-dun-malt)
  - [5.3. Diagramme détat du driver `Ternet()`](#53-diagramme-détat-du-driver-ternet)
  - [5.4. Gestion des erreurs (hiérarchie)](#54-gestion-des-erreurs-hiérarchie)
- [6. Dette technique & risques](#6-dette-technique--risques)
  - [6.1. Points critiques identifiés](#61-points-critiques-identifiés)
  - [6.2. Couverture linguistique incomplète](#62-couverture-linguistique-incomplète)
- [7. Annexes](#7-annexes)
  - [7.1. Constantes de phase (`PHASE_*`)](#71-constantes-de-phase-phase_)
  - [7.2. Codes derreur connus](#72-codes-derreur-connus)
  - [7.3. Formats de fichiers de configuration](#73-formats-de-fichiers-de-configuration)

---

## 1. Introduction & Périmètre

Le système **RenoiRH-GTA** (probablement *Gestion Terminal Automatique* ou *Gestion Télématique Avancée*) est un **moteur de communication avec des terminaux distants** (« **Termod** »), typiquement des bornes de badgeage, caisses, ou contrôleurs daccès.

Il repose sur un module central `Ternet()` exposé via `tndrv.h`, avec :
- un protocole binaire propriétaire (commandes `RI`, `PL`, `MI`, `GP`, `X0`, `XE`, `WD`, `WE`, ),
- une logique état-machine centralisée,
- un système de **MALT** (*Macro Application Language Terminale* ?) pour exécuter des scripts métier compilés,
- une gestion multi-langue via `tndrv.lng`.

Ce document analyse **strictement les éléments présents** dans les extraits fournis.

---

## 2. Vue densemble fonctionnelle

### 2.1. Acteurs identifiés

```plantuml
@startuml
actor "Utilisateur" as User
actor "Terminal (Termod)" as Termod
actor "Serveur Central (TnSrv)" as Server
actor "Administrateur" as Admin

User --> Termod : Badge, saisie clavier
Termod <--> Server : Protocole GPTRM (RI/PL/MI/X0)
Admin --> Server : Configuration (fichiers .dta), supervision
Server --> Termod : Envoi de MALT, fichiers binaires, X0
@enduml
```

- **Termod** : terminal distant (ex. borne de badgeage PNT_STD / PNT_SSL)
- **Serveur (`TnSrv`)** : hôte exécutant `Ternet()` ? `src/ternet`, `tdial.c`, etc.
- **Utilisateur** : personne badgeant sur le Termod
- **Administrateur** : configure via `*.dta`, gère les MALTs

---

### 2.2. Cas dutilisation principaux

```plantuml
@startuml
left to right direction
actor User
actor Admin
rectangle "Système RenoiRH-GTA" {
  User --> (Badgeage)
  Admin --> (Déploiement MALT)
  Admin --> (Gestion Fichiers)
  Admin --> (Maintenance à distance)
  (Badgeage) .> (Émission X0) : include
  (Déploiement MALT) .> (Transfert MI/MD/ME) : include
  (Gestion Fichiers) .> (Lock/Unlock/Transfert FD/FI) : include
}
@enduml
```

| Cas | Description | Fichiers impliqués |
|-----|-------------|---------------------|
| **Badgeage** | Un utilisateur badge ? Termod envoie `X0` au serveur | `pnt_std.mac`, `ffictrm.dta` |
| **Déploiement MALT** | Envoi dun programme compilé (`.mac` ? `.dbg`) | `cmpmalt.c`, `pnt_std.lnc`, `pnt_std.dsc` |
| **Gestion fichiers** | Transfert FL01FL12 (lock ? send ? unlock) | `fpgmtrm.dta`, `fpartrm.dta`, `ffictrm.dta` |
| **Maintenance** | Mise à jour firmware, activation mode maintenance | `fssltrm.dta`, `frstrm.dta` |

---

### 2.3. Terminologie métier

| Terme | Signification (induite) |
|------|--------------------------|
| **Termod** | Terminal distant (ex. *Point de badgeage standard*) |
| **MALT** | Programme métier compilé (langage propriétaire, `.mac` ? `.dbg`) |
| **X0** | Message utilisateur ? serveur (ex. notification de badge) |
| **XE** | Erreur dexécution MALT ? serveur (format `E:%u L:%u`) |
| **GPTRM** | Protocole binaire hôte ? Termod (`RI`, `PL`, `MI`, `GP`, `FD`, `WI`, ) |
| **FL01FL12** | Fichiers logiques transférables (badge, historique, etc.) |
| **PNT_STD / PNT_SSL** | Profils de terminal (standard vs sécurisé) |

---

## 3. Workflow & Règles métier

### 3.1. Cycle de vie dune session `Ternet`

```plantuml
@startuml
title Cycle de vie typique d'une connexion Termod

[*] --> START
START --> START_REQUEST_STATUS : Connexion établie
START_REQUEST_STATUS --> MALT_INIT : Paramètres OK (partrm.dta)
MALT_INIT --> MALT_DATA : MALT ouvert (cmpmalt.c)
MALT_DATA --> MALT_END : Données transférées (MD)
MALT_END --> GO_PGM : Fin transfert (ME)
GO_PGM --> POLL_INIT : Lancement réussi (GP)
POLL_INIT --> POLL : Fréquence (PI)
POLL --> REQUEST_TIME : timeout / besoin synchro
REQUEST_TIME --> WRITE_TIME : Réponse WT
WRITE_TIME --> FILE_INIT : fpartrm.dta ? file2do[]
FILE_INIT --> FILE_LOCK : Demande X0 LOCK
FILE_LOCK --> FILE_WAIT_OK
FILE_WAIT_OK --> REQUEST_FILE : OK reçu
REQUEST_FILE --> WRITE_FILE_DATA : Transfert FI/FD
WRITE_FILE_DATA --> WRITE_FILE_END
WRITE_FILE_END --> FILE_NEXT
FILE_NEXT --> POLL : Plus de fichiers
POLL --> [*] : Déconnexion / erreur fatale
@enduml
```

Les **phases** sont définies dans `src/tdial.c` :
```c
#define PHASE_START 0
#define PHASE_START_REQUEST_STATUS 1
#define PHASE_MALT_INIT 2
#define PHASE_MALT_DATA 3
#define PHASE_MALT_END 4
#define PHASE_GO_PGM 5
#define PHASE_POLL_INIT 6
#define PHASE_POLL 7
#define PHASE_REQUEST_TIME 8
#define PHASE_WRITE_TIME 9
#define PHASE_FILE_INIT 10
// ...
#define PHASE_WRITE_FILE_END 21
```

---

### 3.2. Gestion des fichiers (lock/unlock/transfert)

Logique conditionnelle extraite de `tdial.c` :

```plantuml
@startuml
skinparam ConditionStyle diamond
title Transfert de fichier (ex. FL01)

start
:Initialisation file2do[i];
if (fileOpType in {1,4,6,9}) then
  :DECHARGEMENT (Termod ? Serveur);
  :Envoi GP_FD();
else if (fileOpType == 2) then
  :EMISSION (Serveur ? Termod);
  :Envoi GP_FI();
else if (fileOpType == 3) then
  :SUPPRESSION;
  :Envoi GP_FU();
endif
:Attente réponse;
if (réponse == GP_RX_AK) then
  :Succès ? phase suivante;
else
  :Erreur ? historique MALT;
  stop
endif
end
@enduml
```

**Règle métier** (codée dans `ffictrm.dta` & `fpgmtrm.dta`) :
```
PNT_STD 2 file/perso.dta file/badge.txt
PNT_SSL 2 file/perso.dta file/badge.txt
```
? Le terminal `PNT_STD` ou `PNT_SSL` lit **2 fichiers** : `perso.dta` (? `FILE_IN`) et `badge.txt` (? `FILE_OUT`), avec mapping de champs (`FILE_FLD`).

Structure :
```c
typedef struct FICTRM_s {
  char FILE_IN[4][30];   // 4 fichiers max en entrée
  struct { char BEGIN[4]; char END[4]; } FLD[3][10]; // 3 fichiers × 10 champs max
  char FILE_OUT[4][30];
  char FILE_RX[4][10];   // mode (*ADD / *REPLACE)
} FICTRM;
```

---

### 3.3. Stratégie de reconnexion & timeout

```plantuml
@startuml
start
:Connexion établie (RS232/ETH/MODEM/SSL);
:timeoutRxCpt = 0;
while (pas d'arrêt demandé)
  :Envoi GP_PL (polling);
  if (réponse OK) then
    :timeoutRxCpt = 0;
  else
    :timeoutRxCpt++;
    if (timeoutRxCpt % 3 == 0 and TRXEPG != "") then
      :Appel TraiteXE(#DRIVEROFF);
    endif
    if (timeoutRxCpt >= 9) then
      :Trop derreurs ? déconnexion;
      stop
    endif
  endif
endwhile
stop
@enduml
```

> ?? Source : bloc `if(timeoutRxCpt >=3)` dans `tdial.c`, avec gestion de `pgmTrm.TRXEPG`.

---

### 3.4. Gestion multi-langue (`tndrv.lng`)

Le fichier `tndrv.lng` contient **4 langues** :

```plantuml
@startuml
rectangle "tndrv.lng" {
  [LANG_FR] --> "#define SRC_Demarrage \"Démarrage \""
  [LANG_GB] --> "#define SRC_Demarrage \"Starting \""
  [LANG_D]  --> "#define SRC_Demarrage \"Start \""
  [LANG_ESP]--> "#define SRC_Demarrage \"Inicio \""
}
interface "langsel.h" as LangSel
LangSel ..> tndrv.lng : #include
@enduml
```

- Sélection par `#ifdef LANG_FR` / `LANG_GB` / `LANG_D` / `LANG_ESP`
- Support incomplet pour lespagnol (ex. `SRC_FONCTION_TraiteXE_dans_DLL_p1_INACCESSIBLE` utilise encore *TrataXE* au lieu de *TraiteXE*)
- Format des macros : `SRC_Label(p1, p2)` ? expansion en chaîne formatée avec `%u`, `%-10.10s`, etc.

---

## 4. Architecture technique

### 4.1. Arborescence & organisation

```plantuml
@startuml
folder "src" {
  folder "file" {
    file "perso.dta"
  }
  folder "malt" {
    file "pnt_std.dbg"
    file "pnt_std.dsc"
    file "pnt_std.lnc"
  }
  folder "maltsrc" {
    file "pnt_std.mac"
  }
  folder "par" {
    file "ffictrm.dta"
    file "fpartrm.dta"
    file "fpgmtrm.dta"
    file "fporttrm.dta"
    file "frstrm.dta"
    file "fssltrm.dta"
  }
  file "tndrv.h"
  file "tndrv.lng"
  file "tdial.c"
  file "cmpmalt.c"
  file "makefile"
  file "ternet"
}
@enduml
```

- `*.dta` : fichiers de configuration **structurés en lignes fixes** (ex. `partrm.dta` = 258 octets, 4 lignes)
- `malt/` : artefacts compilés (`*.dbg`, `*.lnc`, `*.dsc`)
- `maltsrc/` : sources MALT (`*.mac` ? langage propriétaire)
- `ternet` : exécutable/script de lancement (74 lignes)

---

### 4.2. Dépendances & modules

Modules clés :

| Fichier | Rôle | Dépendances |
|--------|------|-------------|
| `tndrv.h` | API publique (`Ternet()`) | `langsel.h`, `extern "C"` |
| `tdial.c` | Implémentation du driver | `osdef.h`, `filefnct.h`, `cmpmalt.h` |
| `cmpmalt.c` | Préprocesseur/compilateur MALT | `osinc.h` |
| `filefnct.h` | Structures `PARTRM`, `PGMTRM`, `RSTRM`, `FICTRM` | `osdef.h` |
| `stat.h` | Journalisation (`LogStat`) |  |
| `ternet` | Point dentrée (CLI ?) | probablement exécute `Ternet()` |

---

### 4.3. Diagramme de composants

```plantuml
@startuml
package "Serveur TnSrv" {
  [Ternet()] as driver
  [MALT Compiler] as cmpmalt
  [Gestion Fichiers] as filemgr
  [Log & Trace] as logger
}

package "Configuration" {
  file "par/*.dta"
  file "malt/*.dbg"
  file "Pyrescom.ini"
}

package "Terminal Termod" {
  [PNT_STD]
  [PNT_SSL]
}

driver --> cmpmalt : Compile\npnt_std.mac ? pnt_std.dbg
driver --> filemgr : Lit/écrit\nperso.dta, badge.txt
driver --> logger : AddHstMlt(), FicTrace()
driver --> "par/*.dta" : GetParTrm(), GetFicTrm()
driver <--> Termod : GPTRM (RI/PL/MI/X0)
driver --> "Pyrescom.ini" : GetParameterString()

cmpmalt --> "maltsrc/pnt_std.mac"
@enduml
```

---

## 5. Modélisation détaillée

### 5.1. Structures de données clés

#### `PARTRM` (Paramètres Termod)

```c
typedef struct PARTRM_s {
  char ID_TERMOD[10];
  char ESP_ACT;   // 'O'/'N' ? traçage complet
  char TRC_ACT;   // 'O'/'N' ? traçage tronqué
  char POL_INT[4]; // intervalle polling (ex. "0010")
  char HST_ACT;   // historique erreurs MALT
  char DFT_BIB[10]; // programme MALT par défaut
  char HEU_DEB[4], HEU_FIN[4]; // fenêtre horaire activité
};
```

#### `FICTRM` (Fichiers à transférer)

```plantuml
@startuml
class FICTRM {
  +FILE_IN[4][30]
  +FILE_OUT[4][30]
  +FILE_RX[4][10] // "*ADD", "*REPLACE"
}
class FILE_FLD {
  +BEGIN[4]
  +END[4]
}
FICTRM *-- "3" FILE_FLD : champs par fichier >
@enduml
```

---

### 5.2. Séquence typique : chargement dun MALT

```plantuml
@startuml
actor Admin
participant "TnSrv" as S
participant "Termod" as T

Admin -> S : Configure DFT_BIB = "pnt_std"
S -> S : GetParTrm()
S -> S : OpenMaltObj("pnt_std")
S -> S : GetMaltObjData() ? maltData
S -> T : GpMi(seq, len, "pnt_std", maltData)
T --> S : AK
S -> T : GpMd(seq, maltData) // données
loop jusquà fin
  T --> S : AK
end
S -> T : GpMe(seq, fin)
T --> S : AK
S -> T : GpGp(seq) // GO PGM
T --> S : AS (statut)
S -> Admin : "P Lancement_programme"
@enduml
```

> ?? `GpMi()` = *MALT Init*, `GpMd()` = *MALT Data*, `GpMe()` = *MALT End*, `GpGp()` = *Go Program*

---

### 5.3. Diagramme détat du driver `Ternet()`

```plantuml
@startuml
hide empty description
[*] --> PHASE_START
state "PHASE_START" as S0
state "PHASE_POLL" as S7
state "PHASE_FILE_INIT" as S10
state "PHASE_WRITE_FILE_DATA" as S20

S0 --> S1 : Connexion OK
S1 --> S2 : Paramètres OK
S2 --> S3 : MALT ouvert
S3 --> S4 : Données envoyées
S4 --> S5 : Fin transfert
S5 --> S6 : MALT lancé
S6 --> S7 : GP_AK reçu

S7 --> S8 : timeout / besoin heure
S8 --> S9 : WT envoyé
S9 --> S7 : WT OK

S7 --> S10 : fpartrm.dta ? file2do[]
S10 --> S15 : FD/FI/FU envoyé
S15 --> S20 : données transférées
S20 --> S7 : fin fichier

S7 --> [*] : Erreur fatale / arrêt
@enduml
```

---

### 5.4. Gestion des erreurs (hiérarchie)

```plantuml
@startuml
class Erreur {
  {abstract} +code: int
  +message(): string
}

class ErreurFatale {
  <<final>>
  -arrêt immédiat
}

class Warning {
  <<final>>
  -continue exécution
}

class ErreurProtocole {
  <<final>>
  -GP_RX_ER, GP_RX_INCORRECT
}

class ErreurMALT {
  <<final>>
  -XE reçu (E:%u L:%u)
}

Erreur <|-- ErreurFatale
Erreur <|-- Warning
Erreur <|-- ErreurProtocole
Erreur <|-- ErreurMALT

ErreurFatale --> "Log dans hstmlt.dta"
Warning --> "Log si MLT_ACT='O'"
ErreurProtocole --> "Envoyer 'P Erreur_Protocole'"
ErreurMALT --> "Appeler TraiteXE()"
@enduml
```

Exemples :
- `"ERREUR FATALE %u SUR 'RI'"` ? arrêt (`stopRequest = 1`)
- `"WARNING %u SUR 'MI'"` ? log seulement
- `"REPONSE INCONNUE SUR 'PL'"` ? erreur protocole ? `P Erreur_Protocole`

---

## 6. Dette technique & risques

### 6.1. Points critiques identifiés

| Problème | Localisation | Risque |
|---------|--------------|--------|
| **Buffer overflow potentiel** | `strncat(buf, ficTrm.FILE_FLD[i-1].FLD[j].BEGIN, sizeof(...))` ? taille non vérifiée | Corruption mémoire |
| **Magic values** | `#define FLASH_VER_MIN 522`, `FILE_NUM = 4`, `SIZEOF_IDTERMOD = 10` | Maintenance difficile |
| **Gestion manuelle mémoire** | `malloc(fileBuf)` sans `free()` dans certains chemins (ex. erreur `strstr() == 0`) | Fuite mémoire |
| **Logique dupliquée** | Traitement `tdialPushed` répété 5× dans `tdial.c` | Incohérence possible |
| **Pas de tests** | Aucun `.test`, `.spec`, ou `assert()` visible | Fiabilité douteuse |

---

### 6.2. Couverture linguistique incomplète

- Lespagnol utilise des termes anglais (`TrataXE`, `OCX`, `EXE`) ? risque de confusion
- Lallemand a des coquilles (`DEBUT V4` non traduit, `CountDefine++; BufToDecode[0]=0;`)
- Le fichier `langsel.h` nest pas fourni ? impossible de savoir comment la langue est sélectionnée à lexécution

---

## 7. Annexes

### 7.1. Constantes de phase (`PHASE_*`)

| Valeur | Nom | Description |
|-------|-----|-------------|
| 0 | `PHASE_START` | Initialisation connexion |
| 1 | `PHASE_START_REQUEST_STATUS` | Demande statut (`RI`) |
| 2 | `PHASE_MALT_INIT` | Chargement MALT |
| 3 | `PHASE_MALT_DATA` | Transfert données (`MD`) |
| 4 | `PHASE_MALT_END` | Fin MALT (`ME`) |
| 5 | `PHASE_GO_PGM` | Lancement (`GP`) |
| 6 | `PHASE_POLL_INIT` | Initialisation polling |
| 7 | `PHASE_POLL` | Boucle principale (`PL`) |
| 21 | `PHASE_WRITE_FILE_END` | Fin transfert fichier |

> Source : `#define PHASE_*` dans `tdial.c`

---

### 7.2. Codes derreur connus

| Code | Contexte | Message |
|------|----------|---------|
| `-1` | `OpenMaltObj()` | `MALT_INACCESSIBLE` |
| `-2` | `OpenMaltObj()` | `SANS_INFORMATION_DE_LONGUEUR` |
| `-3` | `OpenMaltObj()` | `POSITIONNEMENT_IMPOSSIBLE` |
| `-4` | `OpenMaltObj()` | `FICHIER_DEJA_OUVERT` |
| `0` | `TraiteXE()` | Succès (réponse vide) |
| `-1` | `TraiteXE()` | `DLL_INACCESSIBLE` |
| `-2` | `TraiteXE()` | `FONCTION_TraiteXE_dans_DLL_INACCESSIBLE` |
| `-3` | `TraiteXE()` | `ERREUR_SUR_TraiteXE_PAR_EXE` |

---

### 7.3. Formats de fichiers de configuration

#### `fpartrm.dta` (258 octets)

```
PNT_STD NO0010 pnt_std 00000000OE0100 N
PNT_SSL NO0010 pnt_std 00000000OS0100 N
```

- Col 18 : ID terminal (`PNT_STD`)
- Col 915 : ? (`NO0010`)
- Col 1625 : programme MALT (`pnt_std`)
- Col 2633 : ? (`00000000`)
- Col 3435 : type réseau ? (`OE` / `OS`)
- Col 3637 : fréquence ? (`01`)
- Col 38 : activation ? (`0` / `N`)

#### `ffictrm.dta` (1026 octets)

```
PNT_STD 2 file/perso.dta file/badge.txt 080000010046...
```

- `2` = nombre de fichiers
- `file/perso.dta`, `file/badge.txt` = chemins
- `0800` = bitmap de configuration (ex. `*ADD N` répété)

?
````

</details>


---

### 📄 `si/RenoiRH-GTA.dat.md` [11.120 octets]
<a id="si-RenoiRH-GTA-dat-md"></a> [↩ Retour à l'arborescence](#tree-si-RenoiRH-GTA-dat-md)

> **Chemin relatif** : `si/RenoiRH-GTA.dat.md`  
> **Taille** : 11.120 octets  
> **Lignes** : 294  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (294 lignes) - Cliquer pour déplier</summary>

````markdown
Voici un **Dossier d’Architecture Technique (DAT)** complet pour **RenoiRH-GTA**, rédigé **sur le modèle de `_example.dat.md`**, entièrement autoporté, pédagogique, et ancré strictement dans les sources fournies (`RenoiRH-GTA.md`).  
Il couvre **vue d’ensemble**, **fonctionnalités**, **diagrammes**, **déploiement**, **supervision**, **sécurité**, **exigences**, **dette technique**, **glossaire**, **ADR**, **parties prenantes**, **modèles**, **environnement**, **CI/CD**, et **scénarios d’exécution**.

---

# 📄 Dossier d’Architecture Technique — RenoiRH-GTA  
*Gestion Terminal Automatique – Communication bi-directionnelle avec terminaux distants (Termod)*  
📌 **Document en chantier – Version 1.0**

[TOC]

---

## 🔍 Vue d’ensemble

Le système **RenoiRH-GTA** (*Gestion Terminal Automatique*) est un **moteur de dialogue asynchrone** entre un **serveur central (TnSrv)** et des **terminaux distants (Termod)**, typiquement des bornes de badgeage, caisses autonomes ou contrôleurs d’accès.

Il repose sur un protocole binaire propriétaire (**GPTRM**) incluant les commandes `RI`, `PL`, `MI`, `MD`, `ME`, `GP`, `FD`, `FI`, `X0`, `XE`, `WT`, etc., et permet :
- chargement de programmes **MALT** compilés (`pnt_std.dbg`),
- transfert de fichiers binaires (`FL01`–`FL12`),
- échange d’événements utilisateur (`X0`) et erreurs (`XE`),
- synchronisation horaire (`WT`),
- mode maintenance à distance.

```plantuml
@startuml
cloud "Serveur Central TnSrv" as S {
  [Ternet()] as drv
  [MALT Compiler] as cmp
  [Gestion Fichiers] as fs
  database "Config" as cfg
}
rectangle "Termod (PNT_STD / PNT_SSL)" as T {
  [Moteur MALT] as m
  [FL01: badges] as f1
  [FL02: perso] as f2
}
drv <--> T : GPTRM (RI/PL/MI/MD/ME/GP/FD/FI/X0/XE/WT…)
cmp --> drv : pnt_std.dbg
fs --> drv : file/perso.dta, file/badge.txt
cfg --> drv : fpartrm.dta, fpgmtrm.dta, flict rm.dta
@enduml
```

---

## 🧩 Fonctionnalités principales

| Fonctionnalité | Description | Fichiers clés |
|----------------|-------------|----------------|
| **Dialogue Termod** | Connexion RS232/ETH/SSL, polling, timeout | `tdial.c`, `fporttrm.dta`, `fssltrm.dta` |
| **Chargement MALT** | Transfert d’un programme compilé (`MI`/`MD`/`ME`) | `cmpmalt.c`, `malt/pnt_std.dbg`, `fpgmtrm.dta` |
| **Gestion fichiers** | Transfert `FL01`–`FL12` (lock → data → unlock) | `ffictrm.dta`, `file/perso.dta`, `file/badge.txt` |
| **Badgeage & X0** | Réception badge → `X0` → réponse (ex. ouverture relais) | `pnt_std.mac`, `recbadfic.c`, `traitexe.c` |
| **Gestion erreurs** | Historisation via `XE` (`E:%u L:%u`) | `hstmlt.dta`, `tndrv.lng` |
| **Synchronisation** | Envoi heure via `WT`, `TZWT` | `tdial.c`, `gp_trm.h` |

```plantuml
@startuml
title Cycle de badgeage (PNT_STD)
User -> Termod : Badge (B00)
Termod -> TnSrv : X0 (BDG_HST)
TnSrv -> Termod : RELAY ON (via PGM MALT)
Termod -> TnSrv : X0 ACK (relais actif)
@enduml
```

---

## 🗺 Vue Déploiement

| Environnement | Serveur | Usage | Accès |
|---------------|---------|-------|------|
| **Développement** | `127.0.0.1` / VM locale | Débogage MALT, tests GPTRM | `./ternet PNT_STD` |
| **Production** | Serveur dédié (Linux/OS400) | Supervision badgeage | `Pyrescom.ini` + `TnSrv` daemon |

```plantuml
@startuml
cloud "Serveur TnSrv" {
  [Ternet Driver] -> [Config]
  [Ternet Driver] -> [MALT DB] : *.dbg
  [Ternet Driver] -> [Fichiers] : FL01–FL12
}
node "Termod PNT_STD" {
  [MALT pnt_std]
  [FL01: badge]
  [FL02: perso]
}
node "Termod PNT_SSL" {
  [MALT pnt_std]
  [SSL Handshake]
}
Ternet Driver <--> Termod PNT_STD : TCP/IP (port 3000)
Ternet Driver <--> Termod PNT_SSL : SSL/TLS
@enduml
```

> 📁 Configurations réseau : `src/par/ftxteth.dta`, `src/par/fssltrm.dta`

---

## 🛡 Supervision & Sauvegarde

### Supervision
- **Logs** :
  - `TRACE(PNT_STD)` (trames tronquées)
  - `ESPION(PNT_STD)` (trames complètes)
  - `hstmlt.dta` (erreurs MALT)
- **Tracing** activable via `ESP_ACT`, `TRC_ACT`, `HST_ACT` dans `fpartrm.dta`
- **Statut en temps réel** : réponse `AS` après `GP` (statut MALT + fichiers)

### Sauvegarde
- **Fichiers Termod** (`FL01`–`FL12`) :
  - Transferts **bidirectionnels** (`FI`/`FD`/`FU`)
  - Mode `*ADD` ou `*REPLACE` (ex. `*ADD N` dans `ffictrm.dta`)
- **MALT** :
  - Versionné via `pnt_std.dbg`, `pnt_std.dsc`, `pnt_std.lnc`
- **Config** :
  - Snapshots manuels des `*.dta`
  - Pas de mécanisme automatisé détecté → **risque**

---

## 🔐 Sécurité

| Couche | Mesure | Source |
|--------|--------|--------|
| **Transport** | RS232 / TCP brut / SSL (via `fssltrm.dta`) | `fssltrm.dta`, `tdial.c` |
| **Authentification** | Couple `USER`/`PASSWORD` (optionnel) + `USER_PASS_CRYPT='1'` | `SSLTRM` struct |
| **Intégrité** | CRC16 sur trames GPTRM (RS232) | `osrs232.c` |
| **Accès fichiers** | Lock exclusif (`OsFLock()`) avant transfert | `osfile.c` |
| **Erreurs** | Journalisation conditionnelle (`MLT_ACT='O'`) | `AddHstMlt()` |

> ⚠️ **Alerte** : `USER_PASS_CRYPT=' '` = pas de cryptage par défaut.

---

## ✅ Exigences de qualité

| Exigence | Validation | Mesure |
|----------|------------|--------|
| **Fiabilité connexion** | Timeout après 3×3 pollings sans réponse | `timeoutRxCpt` ≥ 9 → déconnexion |
| **Intégrité MALT** | Checksum interne (`flashVersion`) | `SM1`/`SM0` dans réponse `eq` |
| **Temps réponse X0** | ≤ `%REP_HST_TO` (10 s) | Boucle `RE_SEND_X0` |
| **Maintenabilité** | Modularité `TRTPGM` (DLL externalisables) | `OsEExecRecBad()`, `OsEExecTraiteX0()` |
| **Multi-lingue** | FR/GB/D/ESP via `tndrv.lng` | `#ifdef LANG_*` |

---

## 🧱 Dette technique & Risques

| Dette | Impact | Solution proposée |
|------|--------|------------------|
| **Magic numbers** | Fragilité (`FILE_NUM=4`, `SIZEOF_IDTERMOD=10`) | → Définir constantes dans `.h` |
| **Gestion mémoire manuelle** | Fuites possibles (ex. `malloc` sans `free` dans erreurs) | → Wrapper avec RAII/`goto cleanup` |
| **Parsing fragile** | `strncmp(data, "B1 ",2)` → cassant si espace | → Utiliser `strspn` / tokenizer |
| **Pas de tests automatisés** | Rég. non garantie | → Ajout de `test_tdial.c` |
| **Couverture linguistique partielle** | Espagnol partiellement traduit | → Audit `tndrv.lng` |

---

## 📘 Glossaire

| Terme | Définition |
|------|------------|
| **Termod** | Terminal distant (ex. borne de badgeage `PNT_STD`) |
| **MALT** | Programme exécutable embarqué (`.mac` → `.dbg`) |
| **GPTRM** | Protocole binaire hôte ↔ Termod (`RI`, `PL`, `MI`, `X0`…) |
| **FL01–FL12** | Fichiers logiques transférables (ex. badge, perso) |
| **X0** | Message utilisateur → serveur (ex. badge scanné) |
| **XE** | Erreur MALT → serveur (`E:%u L:%u`) |
| **TnSrv** | Serveur central RenoiRH-GTA |
| **Ternet()** | Point d’entrée API (ex. `int Ternet(char *idTermodClient,…)`) |

---

## 📜 Décisions d’Architecture – ADR

### ✅ [ADR-001] Choix du protocole binaire GPTRM vs HTTP/JSON  
- **Contexte** : Besoin de faible latence, bande passante limitée (RS232), terminaux embarqués.
- **Décision** : Protocole binaire compact, CRC16, polling basse fréquence (`POL_INT="0010"` = 10 s).
- **Conséquence** : Développement complexe, mais **latence < 200 ms**, **surcharge réseau minimale**.

### ✅ [ADR-002] MALT vs interpréteur embarqué  
- **Contexte** : Logique métier (badge, relais, touches F1-F5) variable par site.
- **Décision** : Langage propriétaire compilé (`cmpmalt.c`) → exécution rapide sur Termod contraint.
- **Conséquence** : Déploiement par `MI/MD/ME`, debug via `.lnc`/`.dsc`.

---

## 👥 Parties prenantes

| Rôle | Contact | Attentes |
|------|---------|----------|
| **Exploitants Termod** | - | Fiabilité badgeage, temps de réponse < 1 s |
| **Administrateurs GTA** | - | Supervision, rechargement F01–F12 à distance |
| **Développeurs MALT** | - | Débogage via `XE`, outils `cmpmalt` |
| **DSI / Sécurité** | - | Chiffrement SSL, audit logs |

---

## 🧩 Modèles de conception

- **État-machine centralisé** : `phase = PHASE_*` (22 états dans `tdial.c`)
- **Plugin DLL** : Logique externalisable (`RecBad`, `TraiteX0`, `TraiteXE`) via `TRTPGM`
- **Transfert fichiers en 3 phases** : `LOCK` → `DATA` (`FI`/`FD`) → `UNLOCK`
- **Configuration par tables** : `fpartrm.dta`, `ffictrm.dta`, `fpgmtrm.dta` → structures C

```plantuml
@startuml
[*] --> PHASE_START
PHASE_START --> PHASE_MALT_INIT
PHASE_MALT_INIT --> PHASE_MALT_DATA
PHASE_MALT_DATA --> PHASE_MALT_END
PHASE_MALT_END --> PHASE_GO_PGM
PHASE_GO_PGM --> PHASE_POLL
PHASE_POLL --> PHASE_FILE_INIT : file2do[]
PHASE_FILE_INIT --> PHASE_WRITE_FILE_DATA
PHASE_WRITE_FILE_DATA --> PHASE_POLL
PHASE_POLL --> [*] : Erreur fatale
@enduml
```

---

## 🛠 Environnement technologique

| Couche | Techno |
|-------|--------|
| **Langage** | C ANSI (portable OS400/Win32/Linux) |
| **Compilation** | `make` (GNU Make), `gcc` |
| **Gestion dépendances** | Bibliothèques statiques (`libbz2`, `ssl`) |
| **Compression** | BZ2 (`osbz2.c`) pour fichiers volumineux |
| **Multi-langue** | Préprocesseur C (`#ifdef LANG_FR`) |
| **Tests** | Manuel (`ternet PNT_STD` + `recbadfic`) |

---

## 🔄 Forge logicielle – CI/CD

| Étape | Outil | Description |
|-------|-------|-------------|
| **Versioning** | Git | Repository interne (non visible ici) |
| **Build** | `make` | Compilation de `ternet`, `cmpmalt`, `recbadfic` |
| **Déploiement** | Copie manuelle | Transfert `.dbg`, `.dta`, `Pyrescom.ini` |
| **Validation** | Manuel | `./ternet PNT_STD` + badge réel |

> 📌 **Amélioration CI/CD** proposée :  
> ```makefile
> deploy-prod: build
> 	scp src/malt/*.dbg prod:/opt/gta/malt/
> 	scp src/par/*.dta prod:/opt/gta/par/
> 	ssh prod "systemctl restart tn_srv"
> ```

---

## 🧪 Scénario d’exécution

### 🔄 Scénario : Déploiement d’un nouveau MALT + synchronisation badge

```plantuml
@startuml
title Déploiement MALT + badge
actor Admin
participant TnSrv
participant Termod
Admin -> TnSrv : Modifie DFT_BIB=pnt_v2 dans fpartrm.dta
TnSrv -> TnSrv : Recompilation (cmpmalt pnt_v2.mac)
Admin -> TnSrv : Lance ./ternet PNT_STD
TnSrv -> Termod : RI (statut)
Termod --> TnSrv : AS (OK)
TnSrv -> Termod : MI (init pnt_v2)
Termod --> TnSrv : AK
TnSrv -> Termod : MD (blocs binaires…)
loop
  Termod --> TnSrv : AK
end
TnSrv -> Termod : ME + GP (lancement)
Termod --> TnSrv : AS (MALT actif)
User -> Termod : Badge B00
Termod -> TnSrv : X0 (BDG_HST)
TnSrv -> Termod : RELAY ON (via MALT v2)
@enduml
```

---

> ✅ **Document terminé** — prêt pour intégration dans Confluence, Obsidian ou comme livrable technique.

Souhaitez-vous :
- une version **PDF imprimable**,
- un export **Mermaid** (pour Obsidian native),
- ou un focus sur une section (ex. détails GPTRM, ADR complémentaires) ?
````

</details>


---

### 📄 `si/resif.analysis.md` [10.898 octets]
<a id="si-resif-analysis-md"></a> [↩ Retour à l'arborescence](#tree-si-resif-analysis-md)

> **Chemin relatif** : `si/resif.analysis.md`  
> **Taille** : 10.898 octets  
> **Lignes** : 335  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (335 lignes) - Cliquer pour déplier</summary>

````markdown
# ?? Analyse complète de lapplication *Resif*

> ?? **Contexte** : Application web PHP orientée statistiques et gestion des agents (probablement dans un ministère  écologie/énergie).  
> ?? **Nom suggéré** : *FORCQ* (Fréquence des Opérations de Recensement des Compétences Qualifiées ?), vu la fréquence des chemins `/FORCQ/`.  
> ?? Source : Arborescence fournie via fichier `resif.md`.

---

## ?? 1. Vue densemble fonctionnelle

### 1.1 Acteurs identifiés
Daprès les noms des templates (`VisuUtilisateur`, `VisuListeMinistere`, etc.) :

| Acteur | Rôle | Preuves dans les fichiers |
|--------|------|----------------------------|
| **Agent** | Utilisateur final, probablement un employé ministériel | `VisuUtilisateur.php`, `ExportAgent.php`, paramètre `id == 'Agent'` |
| **Administrateur** | Gère les utilisateurs, services, profils, droits | `VisuListeUtilisateurService.php`, `VisuDroits.php`, `VisuProfil.php` |
| **Service / Cellule** | Unité administrative (ministère, cellule, onglet) | `MinistereDao.class.php`, `CelluleDao.class.php`, `OngletDao.class.php` |
| **Système** | Génération de PDF, logs, authentification CAS | `util::GenerePDF()`, `web/lib/CAS`, `web/lib/log4php` |

### 1.2 Cas dusage principaux (extraits des templates & classes)

```plantuml
@startuml
left to right direction
actor Agent
actor Admin as "Administrateur"
actor Service

rectangle "Application FORCQ" {
  Agent --> (Consulter ses données)
  Agent --> (Exporter son dossier)
  Admin --> (Gérer les utilisateurs)
  Admin --> (Configurer les droits)
  Admin --> (Gérer les tableaux statistiques)
  Service --> (Visualiser agrégats)
}

(Exporter son dossier) .> (Générer PDF) : include
(Générer PDF) .> (FPDF) : utilise
@enduml
```

### 1.3 Workflow typique (ex. export PDF dun agent)

```plantuml
@startuml
title Workflow : Export PDF par un agent

Agent -> Edition.class.php : action Export(id='Agent')
Edition.class.php -> util.php : util::GenerePDF()
util.php -> FPDF : new PDF(); AddPage(); Cell()...
FPDF --> util.php : buffer PDF
util.php --> Agent : téléchargement/stream

note right
  Basé sur :
  - web/classes/FORCQ/presentation/Edition.class.php
  - web/classes/commun/util.php (méthode GenerePDF)
  - web/lib/fpdf/
@enduml
```

### 1.4 Règles métier déduites

| Règle | Justification |
|------|----------------|
| ?? Authentification centralisée via **CAS** | Présence de `web/lib/CAS/`, `esup-phpcas-0.5.1-1` |
| ?? Les données sont regroupées par **Ministère / Cellule / Onglet / Tableau** | Classes `MinistereDao`, `CelluleDao`, `OngletDao`, `EnteteColonneDao` |
| ?? Les exports PDF utilisent **FPDF v1.84+** | `web/lib/fpdf/`, `version.php` indique `2.0.0` et dépendances FPDF |
| ?? Génération dynamique de tableaux à N niveaux | `EnteteColonneVO.class.php`, `VisuTableau.php` (588 lignes), `VisuTableauAgregation.php` |
| ?? Audit/log via **log4php** | `web/lib/log4php/`, `web/config/log4php-config.xml` |

---

## ?? 2. Architecture technique

### 2.1 Structure MVC (classique, mais maison)

```plantuml
@startuml
package "web/" {
  [index.php] --> [Requete.class.php]
  [Requete.class.php] --> Controler : route
}

package "Contrôleurs" {
  class Edition
  class Defaut
  class Referentiel
}

package "Modèle (DAO + VO)" {
  class MinistereDao
  class UtilisateurDao
  class OngletDao
  class EnteteColonneDao
  class UtilisateurVO
  class EnteteColonneVO
}

package "Vue (Templates FORCQ)" {
  [VisuUtilisateur.php]
  [VisuTableau.php]
  [VisuListeMinistere.php]
  [ExportAgent.php]
}

Controler --> Modèle : charge/écrit les données
Controler --> Vue : affiche / exporte
@enduml
```

> ? **Preuves** :
> - Contrôleurs : `web/classes/FORCQ/presentation/Utilisateur.class.php`, `Edition.class.php`
> - Modèles (DAO) : `web/classes/FORCQ/integration/*.class.php`
> - Vues (Templates) : `web/templates/FORCQ/*.php`

---

### 2.2 Dépendances externes identifiées

| Bibliothèque | Version | Usage | Preuves |
|--------------|---------|-------|---------|
| **FPDF** | = 1.84 (28/08/2021) | Génération PDF | `web/lib/fpdf/`, commentaires changelog dans FAQ.htm |
| **phpCAS (esup)** | 0.5.1-1 | Authentification SSO | `web/lib/CAS/upload/esup-phpcas-0.5.1-1/`, `CAS.php`, `README` |
| **log4php (Apache)** | 2.3.0 | Journalisation | `web/lib/apache-log4php-2.3.0/`, `LoggerRoot.php` |
| **Pager** | non précisé | Pagination ? | `web/lib/Pager/` (mais peu de références dans le reste) |

> ?? **Note** : La présence de `domxml-php4-php5.php` (v1.5.5, 2005) montre une **forte dette technique** : compatibilité PHP 4 ? 5 pour lextension `domxml`, obsolète depuis PHP 5.1 (2005). Utilisée probablement par `log4php` ou `CAS`.

```plantuml
@startuml
title Dépendances externes (schéma de composition)

package "Application FORCQ" {
  [Contrôleur] --> [FPDF]
  [Authentification] --> [phpCAS 0.5.1]
  [Journalisation] --> [log4php 2.3.0]
}

[FPDF] #LightBlue
[phpCAS 0.5.1] #LightGreen
[log4php 2.3.0] #LightYellow
[domxml compat layer] #Pink

log4php 2.3.0 -down-> [domxml compat layer]
phpCAS 0.5.1 -down-> [domxml compat layer]

note right of [domxml compat layer]
  Compatibilité artificielle PHP4?PHP5.
  Risque : instabilité, non-maintenu, incompatibilité PHP = 7.4.
end note
@enduml
```

---

## ?? 3. Sécurité

### 3.1 Points forts

- ? **Authentification centralisée CAS** (standard ESUP-Portail, utilisé dans lenseignement supérieur français)
- ? **Gestion fine des droits** (`Profil_DroitsDao.class.php`, `VisuDroits.php`)
- ? **Journalisation structurée** via log4php (XML layout, DOM configurator)

### 3.2 Risques critiques

| Risque | Localisation | Commentaire |
|--------|--------------|-------------|
| ?? `domxml-php4-php5.php` obsolète | `web/lib/CAS/.../domxml-php4-php5.php` | Bibliothèque *abandonnée depuis 2007*, incompatible avec les versions modernes de PHP. Utilisée par phpCAS 0.5.1 (très ancien). |
| ?? phpCAS 0.5.1-1 (20062007 ?) | `web/lib/CAS/upload/esup-phpcas-0.5.1-1/` | Version *extrêmement ancienne* (actuelle : = 1.6.x). Vulnérabilités connues non corrigées (ex. CVE-2010-3690, CVE-2014-3538). |
| ?? Pas de framework moderne (ex. Symfony/Laravel) | Partout | Code "maison", probablement fragile face aux injections, CSRF, XSS (non prouvé ici, mais risque élevé). |
| ?? `short_open_tag` (<?) | Mention dans `version.php` : *« Correction des "short tag" php »* | Indique que le code en dépendait ? fragile si désactivé. |

```plantuml
@startuml
title Chaîne de risque sécurité

package "Frontend PHP" {
  [Page utilisateur] --> [phpCAS 0.5.1]
}

package "Bibliothèques" {
  [phpCAS 0.5.1] --> [domxml-php4-php5.php]
  [log4php] --> [domxml-php4-php5.php]
}

[domxml-php4-php5.php] --> PHP7.4+ : "INCOMPATIBLE"
note right
  - domxml_* supprimé en PHP 5.1 (2005)
  - log4php 2.3 est la dernière avant abandon (Apache 2015)
  - phpCAS 0.5.1 est pré-1.0 (2006)
end note

@enduml
```

---

## ?? 4. Modules fonctionnels

### 4.1 Arborescence fonctionnelle déduite

```plantuml
@startmindmap
* Application FORCQ
** Gestion des utilisateurs
*** CRUD Utilisateur (`UtilisateurDao`, `VisuUtilisateur`)
*** Affectation service / cellule
*** Gestion des droits (`Profil_DroitsDao`)
** Référentiels
*** Ministères (`MinistereDao`, `VisuListeMinistere`)
*** Onglets (`OngletDao`, `VisuListeOnglet`)
*** Cellules
** Tableaux statistiques
*** Définition (`EnteteColonneDao`)
*** Visualisation (`VisuTableau.php`)
*** Agrégation (`VisuTableauAgregation.php`)
** Export & reporting
*** PDF (`util::GenerePDF()`, FPDF)
*** Templates (`ExportAgent.php`, etc.)
** Authentification & sécurité
*** CAS (`/lib/CAS/`)
*** Logs (`log4php`)
@endmindmap
```

### 4.2 Modules techniques (packages)

```plantuml
@startuml
package "web/" {
  package "classes/" {
    package "FORCQ/" {
      package "presentation/" as pres #LightBlue
      package "integration/" as dao #LightGreen
      package "ValueObject/" as vo #Yellow
    }
    package "commun/" as common #LightGrey
  }
  package "templates/" {
    package "FORCQ/" as views #Pink
    package "commun/" as common_views #Pink
  }
  package "lib/" {
    package "fpdf/" as fpdf #AliceBlue
    package "CAS/" as cas #PaleGreen
    package "log4php/" as log #Khaki
    package "Pager/" as pager #LightCyan
  }
  package "config/" as config #Lavender
}

common --> pres : hérite/utilise
pres --> dao : appelle DAO
dao --> vo : hydrate VO
pres --> views : rendu
common --> fpdf : GenerePDF()
pres --> cas : auth
common --> log : log()
@enduml
```

---

## ?? 5. Dette technique (synthèse visuelle)

```plantuml
@startgantt
Project starts 2005-01-01
[domxml-php4-php5.php] happens at 2005-01-18
[phpCAS 0.5.1] happens at 2006-12-01
[log4php 2.3.0] happens at 2013-06-01
[FPDF 1.84] happens at 2021-08-28
[Application v2.0.0] happens at 2025-01-20

[domxml] #Pink
[phpCAS] #Red
[log4php] #Orange
[FPDF] #Green
[App v2.0] #Blue

note on [domxml]
  Compatibilité artificielle.
  Non maintenu depuis > 20 ans.
end note

note on [phpCAS]
  Version non sécurisée.
  Aucun correctif depuis ~18 ans.
end note
@endgantt
```

> ?? **Conclusion dette** : Lapplication repose sur **trois piliers obsolètes**, dont deux critiques (*phpCAS 0.5.1* + *domxml compat*). Mise à jour urgente nécessaire pour compatibilité PHP = 8.0 et sécurité.

---

## ?? 6. Recommandations techniques

| Priorité | Action | Bénéfice |
|----------|--------|----------|
| ?? **Critique** | Migrer vers **phpCAS = 1.6.x** + suppression de `domxml-php4-php5.php` | Sécurité, compatibilité PHP 8.x |
| ?? **Critique** | Mettre à jour **log4php ? Monolog** ou **PSR-3 Logger** | Maintenance, performance, sécurité |
| ?? **Élevée** | Externaliser la génération PDF ? **TCPDF** ou **Dompdf** | UTF-8 natif, plus de fonctionnalités |
| ?? **Moyenne** | Ajouter un framework léger (ex. *Slim* ou *Laminas*) | Sécurité (filtres, CSRF), maintenabilité |
| ?? **Moyenne** | Scripts danalyse statique (ex. PHPStan, Psalm) | Détecter erreurs typage, dead code |

---

## ?? Annexes

### A. Versions clés (extraites des fichiers)

| Composant | Version | Source |
|-----------|---------|--------|
| Application | `2.0.0` (20 janv. 2025) | `version.php` |
| FPDF | = 1.84 (28/08/2021) | `web/lib/fpdf/FAQ.htm` |
| phpCAS | `0.5.1-1` | Chemin du dossier + `README` |
| log4php | `2.3.0` | `web/lib/apache-log4php-2.3.0/LoggerRoot.php` |

### B. Exemple de génération PDF (code minimal déduit)

```php
// util.php (méthode GenerePDF)
$pdf = new FPDF();
$pdf->AddPage();
$pdf->SetFont('Arial', '', 10);
$pdf->Cell(30, 4, "Ministère", 0, 1, "L");
$pdf->Cell(30, 4, "de l'Écologie...", 0, 1, "L");
$pdf->Output(); // ? download ou inline
```


````

</details>


---

### 📄 `si/riga2.wiki.md` [78.354 octets]
<a id="si-riga2-wiki-md"></a> [↩ Retour à l'arborescence](#tree-si-riga2-wiki-md)

> **Chemin relatif** : `si/riga2.wiki.md`  
> **Taille** : 78.354 octets  
> **Lignes** : 2134  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (2134 lignes) - Cliquer pour déplier</summary>

`````markdown
﻿# Projet : riga2.wiki

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\riga2.wiki`

**Fichiers** : 16 fichiers non-binaires

## 📁 Arborescence des fichiers

├── **Notes-d'installations/**
│   ├── <a id="tree-Notes-d'installations-Note-d'installation-v2-1-10-md"></a>[Note-d'installation-v2.1.10.md](#Notes-d'installations-Note-d'installation-v2-1-10-md) *(2.139 octets)*
│   ├── <a id="tree-Notes-d'installations-Note-d'installation-v2-1-11-md"></a>[Note-d'installation-v2.1.11.md](#Notes-d'installations-Note-d'installation-v2-1-11-md) *(2.146 octets)*
│   ├── <a id="tree-Notes-d'installations-Note-d'installation-v2-1-12-md"></a>[Note-d'installation-v2.1.12.md](#Notes-d'installations-Note-d'installation-v2-1-12-md) *(2.188 octets)*
│   ├── <a id="tree-Notes-d'installations-Note-d'installation-v2-1-13-md"></a>[Note-d'installation-v2.1.13.md](#Notes-d'installations-Note-d'installation-v2-1-13-md) *(2.180 octets)*
│   ├── <a id="tree-Notes-d'installations-Note-d'installation-v2-1-14-md"></a>[Note-d'installation-v2.1.14.md](#Notes-d'installations-Note-d'installation-v2-1-14-md) *(2.180 octets)*
│   ├── <a id="tree-Notes-d'installations-Note-d'installation-v2-1-15-md"></a>[Note-d'installation-v2.1.15.md](#Notes-d'installations-Note-d'installation-v2-1-15-md) *(2.039 octets)*
│   ├── <a id="tree-Notes-d'installations-Note-d'installation-v2-1-2-md"></a>[Note-d'installation-v2.1.2.md](#Notes-d'installations-Note-d'installation-v2-1-2-md) *(2.044 octets)*
│   ├── <a id="tree-Notes-d'installations-Note-d'installation-v2-1-3-md"></a>[Note-d'installation-v2.1.3.md](#Notes-d'installations-Note-d'installation-v2-1-3-md) *(2.080 octets)*
│   ├── <a id="tree-Notes-d'installations-Note-d'installation-v2-1-4-md"></a>[Note-d'installation-v2.1.4.md](#Notes-d'installations-Note-d'installation-v2-1-4-md) *(2.089 octets)*
│   ├── <a id="tree-Notes-d'installations-Note-d'installation-v2-1-5-md"></a>[Note-d'installation-v2.1.5.md](#Notes-d'installations-Note-d'installation-v2-1-5-md) *(2.161 octets)*
│   ├── <a id="tree-Notes-d'installations-Note-d'installation-v2-1-6-md"></a>[Note-d'installation-v2.1.6.md](#Notes-d'installations-Note-d'installation-v2-1-6-md) *(2.176 octets)*
│   ├── <a id="tree-Notes-d'installations-Note-d'installation-v2-1-7-md"></a>[Note-d'installation-v2.1.7.md](#Notes-d'installations-Note-d'installation-v2-1-7-md) *(2.115 octets)*
│   ├── <a id="tree-Notes-d'installations-Note-d'installation-v2-1-8-md"></a>[Note-d'installation-v2.1.8.md](#Notes-d'installations-Note-d'installation-v2-1-8-md) *(2.195 octets)*
│   └── <a id="tree-Notes-d'installations-Note-d'installation-v2-1-9-md"></a>[Note-d'installation-v2.1.9.md](#Notes-d'installations-Note-d'installation-v2-1-9-md) *(2.176 octets)*
├── <a id="tree-RIGA2-Fiche-applicative-md"></a>[RIGA2-Fiche-applicative.md](#RIGA2-Fiche-applicative-md) *(6.898 octets)*
└── <a id="tree-home-md"></a>[home.md](#home-md) *(26.696 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `home.md` [26.696 octets]
<a id="home-md"></a> [↩ Retour à l'arborescence](#tree-home-md)

> **Chemin relatif** : `home.md`  
> **Taille** : 26.696 octets  
> **Lignes** : 439  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (439 lignes) - Cliquer pour déplier</summary>

```markdown
L’application RIGA est une application ACAI ancienne, lourde d’exploitation obligeant à de nombreuses actions manuelles pour permettre le recueil, la consolidation et la diffusion des informations relatives aux taux de participations aux grèves.
L’objectif de ce projet est de refondre cette application vers une nouvelle forme ergonomique intégrant les actions qui à ce jour doivent être réalisées manuellement en marge de RIGA et élargissant le périmètre des utilisateurs aux services qui ne sont pas reliés à notre réseau intranet (cas de certains établissements publics).
RIGA2 apporte essentiellement ces fonctionnalités supplémentaires :
- envoi de mail dans l’application
- exploitation statique (tableaux de synthèse)
- courant 2020 des évolutions pourront être envisagée pour intégrer l'utilisation des données du SIRH (effectifs, liste des services, liste des corps) en s'appuyant sur les web services de la zone d'échange.
Hébergement : chez un hébergeur externe (entreprise ATE) car RIGA2 a besoin d’être accessible en internet, du fait d’utilisateurs (établissements publics) n’ayant pas accès au RIE. Cet hébergeur héberge les applications de type PHP. Alain Nicolas (Chef du pôle mise en production externalisée) au Pôle hébergement externe: est l'interlocuteur pour les applis PHP en ce qui concerne l'hébergement, plutôt que le CS.

![image](uploads/26a6845308cafe9945f81e1f9c78f158/image.png)



<div class=WordSection1>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><b><span style='font-size:24.0pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
mso-font-kerning:18.0pt;mso-fareast-language:FR'>Qui fait quoi<o:p></o:p></span></b></p>

<table class=MsoNormalTable border=0 cellpadding=0 style='mso-cellspacing:1.5pt;
 mso-yfti-tbllook:1184'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Intervenants<o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Commentaires<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>MOA MTES -
  SG/DRH/RS3 <o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>BAUD
  Marion (Cheffe de bureau) - <a
  href="mailto:Marion.Baud@developpement-durable.gouv.fr">Marion.Baud@developpement-durable.gouv.fr</a><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>AMOA MTES
  - SG/DRH/P/DSNUMRH2 <o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Justine <span
  class=SpellE>Houriez</span> (cheffe de projet)- <a
  href="mailto:justine.houriez@developpement-durable.gouv.fr">justine.houriez@developpement-durable.gouv.fr</a><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>MOE
  prestataire - CGI <o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Marc
  KANAAN (Directeur de Projet Senior) <a href="mailto:marc.kanaan@cgi.com">marc.kanaan@cgi.com</a>
  <o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>MOE MTES -
  SG/SNUM/PNM/DPNM3-6 <o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>VODUNGBO
  Jeanne (Cheffe du pôle MOE) - <a
  href="mailto:jeanne.vodungbo@developpement-durable.gouv.fr">jeanne.vodungbo@developpement-durable.gouv.fr</a><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td style='padding:.75pt .75pt .75pt .75pt'></td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>- FAYOL
  Pascale (Cheffe de projet SIRH) - <a
  href="mailto:Pascale.Fayol@developpement-durable.gouv.fr">Pascale.Fayol@developpement-durable.gouv.fr</a>
  <o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td style='padding:.75pt .75pt .75pt .75pt'></td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>- ASPERTI
  Dominique (Chargée de projet SIRH) - <a
  href="mailto:Dominique.Asperti@developpement-durable.gouv.fr">Dominique.Asperti@developpement-durable.gouv.fr</a><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7;mso-yfti-lastrow:yes'>
  <td style='padding:.75pt .75pt .75pt .75pt'></td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>- DROMZEE
  Thierry (Chargé de projet SIRH) - <a
  href="mailto:Thierry.Dromzee@developpement-durable.gouv.fr">Thierry.Dromzee@developpement-durable.gouv.fr</a><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

</div>


<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><b><span style='font-size:24.0pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
mso-font-kerning:18.0pt;mso-fareast-language:FR'><span class=msoIns><ins>Fiche
technique</ins></span><o:p></o:p></span></b></p>

<table class=MsoNormalTable border=0 cellpadding=0 style='mso-cellspacing:1.5pt;
 mso-yfti-tbllook:1184'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td style='background:lightgrey;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><b><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";color:black;mso-fareast-language:
  FR'>Base de connaissance</span></b><span style='font-size:12.0pt;font-family:
  "Times New Roman",serif;mso-fareast-font-family:"Times New Roman";color:black;
  mso-fareast-language:FR'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'><a
  href="https://sirh.projets.developpement-durable.gouv.fr/issues/18143">https://sirh.projets.developpement-durable.gouv.fr/issues/18143</a><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><a name=Périmètre-MCO></a><b><span
style='font-size:24.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-font-kerning:18.0pt;mso-fareast-language:FR'>Périmètre
MCO<o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Activités
reprises par la MCO ATOS : <o:p></o:p></span></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Déploiements<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Gestion des incidents <o:p></o:p></span></li>
 <ul type=circle>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;line-height:normal;mso-list:l0 level2 lfo1;tab-stops:list 72.0pt'><span
      style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
      "Times New Roman";mso-fareast-language:FR'>Si incident fonctionnel :
      sollicitation de Klee dans <span class=SpellE>Redmine</span> SIRH (<span
      style='color:blue'>à vérifier</span>)<o:p></o:p></span></li>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;line-height:normal;mso-list:l0 level2 lfo1;tab-stops:list 72.0pt'><span
      style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
      "Times New Roman";mso-fareast-language:FR'>Si incident technique :
      sollicitation du Centre Serveur dans <span class=SpellE>Redmine</span>
      Portail Hébergement (<span style='color:blue'>à vérifier</span>)<o:p></o:p></span></li>
 </ul>
</ul>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><a name=Documentation></a><b><span
style='font-size:24.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-font-kerning:18.0pt;mso-fareast-language:FR'>Documentation<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>La
documentation est disponible dans <b>&quot;K:\K-SNUM\14_PNM\PNM6\07 - Transfert
RIGA V2&quot;</b><o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><a
name=Déploiement-de-lapplication-Riga-V2-Pas-></a><b><span style='font-size:
24.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
mso-font-kerning:18.0pt;mso-fareast-language:FR'>D<span class=msoIns><ins>éploiement
de l'application Riga V2 (Pas à pas)</ins></span><o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><a name=Pré-requis></a><span
class=SpellE><b><span style='font-size:18.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Pré-requis</span></b></span><b><span
style='font-size:18.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'><o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:3'><a name=Outil></a><b><span
style='font-size:13.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Outil<a
href="http://sirh.redmine.ac.centre-serveur.i2/projects/psirv/wiki#Outil">¶</a><o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Avoir
télécharger <span class=SpellE>FileZilla</span> <span class=GramE>( logiciel</span>
FTP libre ) ou équivalent.<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:3'><a name=Configuration-du-FTP></a><b><span
style='font-size:13.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Configuration du FTP<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>1- Créer un
&quot;Nouveau site&quot; : Riga V2 Pré-<span class=SpellE>prod</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>2- Remplir
l'onglet &quot;Général&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Hôte:
livraison8.ftp.vpn.e2.rie.gouv.fr<br>
Protocole: SFTP - SSH File Transfer Protocol<br>
Type d'<span class=SpellE>audhentification</span> : <span class=SpellE>ftp_RIGA</span><br>
Mot de passe : *<b>*</b>**<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><a
name=Livraison-dune-nouvelle-version-de-lappl></a><b><span style='font-size:
18.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
mso-fareast-language:FR'>Livraison d'une nouvelle version de l'applicatif<o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:3'><a name=Mode-de-livraison></a><b><span
style='font-size:13.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Mode de livraison<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>A définir -
soit par mail soit par GIT<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:3'><a name=Récupération-de-la-livraison></a><b><span
style='font-size:13.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Récupération de la livraison<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Le fichier à
récupérer doit être zipper et avoir un numéro de version (riga2_vX.Y.Z.zip)<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Le <span
class=SpellE>dézipper</span> en local.<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:3'><a name=Contenu-de-la-livraison></a><b><span
style='font-size:13.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Contenu de la livraison<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Le contenu
du zip doit avoir :<br>
- un lisez-moi.txt qui décrit les modifications apportées (N° de l'incident,
...), les manipulations à effectuer.<br>
- les fichiers modifiés<br>
- les requêtes nécessaires<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><b><span style='font-size:18.0pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
mso-fareast-language:FR'>Mise en place de l'applicatif sur la plateforme de
pré-production<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:3'><a name=Sous-FileZilla></a><b><span
style='font-size:13.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Sous <span class=SpellE>FileZilla</span><o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Glisser les
nouveaux fichiers et/ou répertoire selon le lisez-moi.txt<br>
Écraser les fichiers existants<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:3'><a name=Sur-la-base-de-données></a><b><span
style='font-size:13.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Sur la base de données<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>1- Se
connecter à la base <br>
<a href="https://pma.preprod.vpn.e2.rie.gouv.fr">https://pma.preprod.vpn.e2.rie.gouv.fr</a><br>
Login : riga_u1<br>
<span class=SpellE>mdp</span> : *<b>**</b><br>
serveur : Livraison 8 - (Jessie)<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>2- Passer le
script SQL comme demandé<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:3'><a name=Tester-la-nouvelle-version></a><b><span
style='font-size:13.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Tester la nouvelle version<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>1- URL de la
<span class=SpellE>preprod</span> : <a href="http://riga.preprod.e2.rie.gouv.fr">http://riga.preprod.e2.rie.gouv.fr</a><br>
(avec un certificat auto-signé par ATE -&gt; il faut confirmer l'exception de
sécurité.)<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>2- Tester
les nouveautés et les fonctionnalités anciennes (non régression). <br>
Pour cela ajouter son identifiant dans la base de données
&quot;Méridienne&quot; dans la table &quot;Utilisateurs&quot;.<br>
(S'il n'existe pas déjà)<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>3- Demander
à l'AMOA et/ou MOA de valider<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><a
name=Mise-en-place-de-lapplicatif-sur-la-plat></a><b><span style='font-size:
18.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
mso-fareast-language:FR'>Mise en place de l'applicatif sur la plateforme de
production<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:3'><a name=Sur-la-base-de-données-2></a><b><span
style='font-size:13.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Sur la base de données<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>1- Se
connecter à la base <br>
<a href="https://pma.preprod.vpn.e2.rie.gouv.fr">https://pma.preprod.vpn.e2.rie.gouv.fr</a><br>
Login : riga_u1<br>
<span class=SpellE>mdp</span> : *<b>**</b><br>
serveur : Mutu03<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>2- Passer le
script SQL comme demandé<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:3'><a name=Sous-FileZilla-2></a><b><span
style='font-size:13.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Sous <span class=SpellE>FileZilla</span><o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Glisser le
fichier &quot;SYNCFULL&quot; dans le répertoire &quot;ACTIONS&quot; pour une
synchronisation totale.<br>
ou<br>
Glisser le fichier &quot;SYNCSPECIFIC&quot; dans le répertoire
&quot;ACTIONS&quot; pour une synchronisation partielle. ce fichier contient la
liste des seuls fichiers à modifier.<br>
Exemple :<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:10.0pt;font-family:"Courier New";mso-fareast-font-family:"Times New Roman";
mso-fareast-language:FR'>classes/<span class=SpellE>Mvc</span>/<span
class=SpellE>metier</span>/<span class=SpellE>EditionBo.class.php</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:3'><a name=Tester-la-nouvelle-version-2></a><b><span
style='font-size:13.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Tester la nouvelle version<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>URL de la <span
class=SpellE>prod</span> : <a
href="http://www.riga.developpement-durable.gouv.fr/">http://www.riga.developpement-durable.gouv.fr/</a><o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>




```

</details>


---

### 📄 `Notes-d'installations/Note-d'installation-v2.1.10.md` [2.139 octets]
<a id="Notes-d'installations-Note-d'installation-v2-1-10-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installations-Note-d'installation-v2-1-10-md)

> **Chemin relatif** : `Notes-d'installations/Note-d'installation-v2.1.10.md`  
> **Taille** : 2.139 octets  
> **Lignes** : 78  
> **Type** : markdown

````markdown
# Tickets

- 21115 - Evolution - Evolution des extractions - Bilan statistique et par période

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_riga2_v2.1.10.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Riga2 (php) > Livraisons > v2.1.10


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v2.1.10**.

Sinon, remonter une alerte [HENRI BERTHE]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles à mettre à jour

- maintien-emploi.ods
- edition-ministerielle.ods
````


---

### 📄 `Notes-d'installations/Note-d'installation-v2.1.11.md` [2.146 octets]
<a id="Notes-d'installations-Note-d'installation-v2-1-11-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installations-Note-d'installation-v2-1-11-md)

> **Chemin relatif** : `Notes-d'installations/Note-d'installation-v2.1.11.md`  
> **Taille** : 2.146 octets  
> **Lignes** : 78  
> **Type** : markdown

````markdown
# Tickets

- 21115 - Evolution - Evolution des extractions - Bilan statistique et par période

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_riga2_v2.1.11.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Riga2 (php) > Livraisons > v2.1.11


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v2.1.11**.

Sinon, remonter une alerte [HENRI BERTHE]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles à mettre à jour

- edition-ministerielle.xlsx
- edition-ministerielle.ods
````


---

### 📄 `Notes-d'installations/Note-d'installation-v2.1.12.md` [2.188 octets]
<a id="Notes-d'installations-Note-d'installation-v2-1-12-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installations-Note-d'installation-v2-1-12-md)

> **Chemin relatif** : `Notes-d'installations/Note-d'installation-v2.1.12.md`  
> **Taille** : 2.188 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Tickets

- 21210 - Evolution - Mise à jour des formules de l’effectif prévu- Mon bilan et Mouvement de grèves et jours perdus

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_riga2_v2.1.12.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Riga2 (php) > Livraisons > v2.1.12


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v2.1.12**.

Sinon, remonter une alerte [HENRI BERTHE]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles à mettre à jour

Aucune action particulière n'est prévue dans cette étape.
````


---

### 📄 `Notes-d'installations/Note-d'installation-v2.1.13.md` [2.180 octets]
<a id="Notes-d'installations-Note-d'installation-v2-1-13-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installations-Note-d'installation-v2-1-13-md)

> **Chemin relatif** : `Notes-d'installations/Note-d'installation-v2.1.13.md`  
> **Taille** : 2.180 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Tickets

- 21318 - EditionMouvementsEtJoursPerdus - colonne Nb de journées perdues pour fait de grève : chiffres erronés

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_riga2_v2.1.13.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Riga2 (php) > Livraisons > v2.1.13


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v2.1.13**.

Sinon, remonter une alerte [MAI PELLETIER]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles à mettre à jour

Aucun modèle particulier n'est prévue dans cette étape.
````


---

### 📄 `Notes-d'installations/Note-d'installation-v2.1.14.md` [2.180 octets]
<a id="Notes-d'installations-Note-d'installation-v2-1-14-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installations-Note-d'installation-v2-1-14-md)

> **Chemin relatif** : `Notes-d'installations/Note-d'installation-v2.1.14.md`  
> **Taille** : 2.180 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Tickets

- 21318 - EditionMouvementsEtJoursPerdus - colonne Nb de journées perdues pour fait de grève : chiffres erronés

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_riga2_v2.1.14.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Riga2 (php) > Livraisons > v2.1.14


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v2.1.14**.

Sinon, remonter une alerte [MAI PELLETIER]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles à mettre à jour

Aucun modèle particulier n'est prévue dans cette étape.
````


---

### 📄 `Notes-d'installations/Note-d'installation-v2.1.15.md` [2.039 octets]
<a id="Notes-d'installations-Note-d'installation-v2-1-15-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installations-Note-d'installation-v2-1-15-md)

> **Chemin relatif** : `Notes-d'installations/Note-d'installation-v2.1.15.md`  
> **Taille** : 2.039 octets  
> **Lignes** : 75  
> **Type** : markdown

````markdown
# Tickets

- 21470 : Impossible d'accéder à l'application

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

La livraison 2.1.15 est disponible depuis Gitlab sous le tag 2.1.15-LIVREE. Elle comprend :
- un répertoire **web** contenant les sources applicatives
- un répertoire **bd** contenant d'éventuels scripts SQL


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v2.1.15**.

Sinon, remonter une alerte [MAI PELLETIER]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Le fichier "script_2.1.14_to_2.1.15.sql" contenant un script SQL est à exécuter. Il se trouve dans le répertoire bd/

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles à mettre à jour

Aucun modèle particulier n'est prévue dans cette étape.
````


---

### 📄 `Notes-d'installations/Note-d'installation-v2.1.2.md` [2.044 octets]
<a id="Notes-d'installations-Note-d'installation-v2-1-2-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installations-Note-d'installation-v2-1-2-md)

> **Chemin relatif** : `Notes-d'installations/Note-d'installation-v2.1.2.md`  
> **Taille** : 2.044 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Tickets

- 21073 - Export ne fonctionne pas 

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_riga2_v2.1.1.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Riga2 (php) > Livraisons > v2.1.2


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v2.1.2**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles a mettre à jours

Aucun
````


---

### 📄 `Notes-d'installations/Note-d'installation-v2.1.3.md` [2.080 octets]
<a id="Notes-d'installations-Note-d'installation-v2-1-3-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installations-Note-d'installation-v2-1-3-md)

> **Chemin relatif** : `Notes-d'installations/Note-d'installation-v2.1.3.md`  
> **Taille** : 2.080 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Tickets

- 20781 - Authentification avec un autre utilisateur - message d'erreur

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_riga2_v2.1.3.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Riga2 (php) > Livraisons > v2.1.3


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v2.1.3**.

Sinon, remonter une alerte [BRICE CARDON]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles a mettre à jours

Aucun
````


---

### 📄 `Notes-d'installations/Note-d'installation-v2.1.4.md` [2.089 octets]
<a id="Notes-d'installations-Note-d'installation-v2-1-4-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installations-Note-d'installation-v2-1-4-md)

> **Chemin relatif** : `Notes-d'installations/Note-d'installation-v2.1.4.md`  
> **Taille** : 2.089 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Tickets

- 21113 - Anomalie - Horodatage des extractions "Bilan statistique de la grève"

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_riga2_v2.1.4.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Riga2 (php) > Livraisons > v2.1.4


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v2.1.4**.

Sinon, remonter une alerte [HENRI BERTHE]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles a mettre à jours

Aucun
````


---

### 📄 `Notes-d'installations/Note-d'installation-v2.1.5.md` [2.161 octets]
<a id="Notes-d'installations-Note-d'installation-v2-1-5-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installations-Note-d'installation-v2-1-5-md)

> **Chemin relatif** : `Notes-d'installations/Note-d'installation-v2.1.5.md`  
> **Taille** : 2.161 octets  
> **Lignes** : 78  
> **Type** : markdown

````markdown
# Tickets

- 20781 - Authentification avec un autre utilisateur - message d'erreur
- 21113 - Anomalie - Horodatage des extractions "Bilan statistique de la grève"

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_riga2_v2.1.5.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Riga2 (php) > Livraisons > v2.1.5


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v2.1.5**.

Sinon, remonter une alerte [HENRI BERTHE]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles a mettre à jours

Aucun
````


---

### 📄 `Notes-d'installations/Note-d'installation-v2.1.6.md` [2.176 octets]
<a id="Notes-d'installations-Note-d'installation-v2-1-6-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installations-Note-d'installation-v2-1-6-md)

> **Chemin relatif** : `Notes-d'installations/Note-d'installation-v2.1.6.md`  
> **Taille** : 2.176 octets  
> **Lignes** : 79  
> **Type** : markdown

````markdown
# Tickets

- 21115 - Evolution - Evolution des extractions - Bilan statistique et par période

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_riga2_v2.1.6.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Riga2 (php) > Livraisons > v2.1.6


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v2.1.6**.

Sinon, remonter une alerte [HENRI BERTHE]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles à mettre à jour

- edition-ministerielle.xlsx
- maintien-emploi.xlsx
- EditionMouvementsEtJoursPerdus.xlsx
````


---

### 📄 `Notes-d'installations/Note-d'installation-v2.1.7.md` [2.115 octets]
<a id="Notes-d'installations-Note-d'installation-v2-1-7-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installations-Note-d'installation-v2-1-7-md)

> **Chemin relatif** : `Notes-d'installations/Note-d'installation-v2.1.7.md`  
> **Taille** : 2.115 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Tickets

- 21115 - Evolution : Evolution des extractions - Bilan statistique et par période

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_riga2_v2.1.7.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Riga2 (php) > Livraisons > v2.1.7


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v2.1.7**.

Sinon, remonter une alerte [HENRI BERTHE]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles à mettre à jour

- edition-ministerielle.xlsx
````


---

### 📄 `Notes-d'installations/Note-d'installation-v2.1.8.md` [2.195 octets]
<a id="Notes-d'installations-Note-d'installation-v2-1-8-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installations-Note-d'installation-v2-1-8-md)

> **Chemin relatif** : `Notes-d'installations/Note-d'installation-v2.1.8.md`  
> **Taille** : 2.195 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Tickets

- 21161 - Anomalie : EditionMouvementsEtJoursPerdus - colonne Nbre de jours de grève effectifs : mauvais comptage

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_riga2_v2.1.8.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Riga2 (php) > Livraisons > v2.1.8


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v2.1.8**.

Sinon, remonter une alerte [HENRI BERTHE / EMILIE DESAVOYE]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles à mettre à jour

Aucune action particulière n'est prévue dans cette étape
````


---

### 📄 `Notes-d'installations/Note-d'installation-v2.1.9.md` [2.176 octets]
<a id="Notes-d'installations-Note-d'installation-v2-1-9-md"></a> [↩ Retour à l'arborescence](#tree-Notes-d'installations-Note-d'installation-v2-1-9-md)

> **Chemin relatif** : `Notes-d'installations/Note-d'installation-v2.1.9.md`  
> **Taille** : 2.176 octets  
> **Lignes** : 77  
> **Type** : markdown

````markdown
# Tickets

- 21154 - Anomalie : Impossible de sélectionner une date dans "mon bilan" pour grève > 2 mois

# Pré-requis

## Conventions

`<#ENV>` nom de l’environnement.
> Exemple : RECETTE pour l’environnement de recette.

## Entrants

Un fichier **livraison_riga2_v2.1.9.zip** contenant 
- un répertoire **app** contenant les sources applicatives
- un répertoire **db** contenant d'éventuels scripts SQL

Le fichier est disponible depuis l'application [Résana](https://resana.numerique.gouv.fr/public/perimetre/consulter/107665) sous l'arborescence suivante : Produits PNM3- Base documentaire > Produits ex PNM6 > Riga2 (php) > Livraisons > v2.1.9


### Vérification des sources applicatives

Vérifier dans le fichier **templates/commun/footer.php** à la ligne 6 que le sources concernent bien la **v2.1.9**.

Sinon, remonter une alerte [HENRI BERTHE / EMILIE DESAVOYE]

## Actions préliminaires

 1. Faire un [backup de la base de données](Opérations-techniques/Backup-base-de-données).
 2. Faire un [backup des sources applicatives](Opérations-techniques/Backup-données-applicatives)


# Déploiement applicatif

## Activation de la maintenance

Mettre l'application en maintenance en suivant la procédure adéquate.

## Copie des sources

Copier les répertoires suivants du dossier **app** vers celui du dossier **web** :
- classes (sauf classes/Mvc/integration/Dao.class.php)
- templates
- Modeles

**RAPPEL : EXCEPTIONS des répertoires et fichiers du projet à ne pas écraser :**

    - classes/Mvc/integration/Dao.class.php
    - public/index.php
    - lib/CAS/cas_cerbere.php
    - document/

## Modification à apporter sur les sources en exception

N/A

## Configuration

Aucune action particulière n'est prévue dans cette étape.

## Actions particulières

Aucune action particulière n'est prévue dans cette étape.

# Déploiement scripts SQL

## Exécution des scripts

Aucune action particulière n'est prévue dans cette étape.

## Désactivation de la maintenance

Mettre l'application hors maintenance en suivant la procédure adéquate.

## Modèles à mettre à jour

Aucune action particulière n'est prévue dans cette étape
````


---

### 📄 `RIGA2-Fiche-applicative.md` [6.898 octets]
<a id="RIGA2-Fiche-applicative-md"></a> [↩ Retour à l'arborescence](#tree-RIGA2-Fiche-applicative-md)

> **Chemin relatif** : `RIGA2-Fiche-applicative.md`  
> **Taille** : 6.898 octets  
> **Lignes** : 209  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (209 lignes) - Cliquer pour déplier</summary>

```markdown
**<span dir="">Wiki</span>**

<table>
<tr>
<td>

**<span dir="">Wiki RIGA 2</span>**
</td>
<td>

<span dir="">http://sirh.redmine.ac.centre-serveur.i2/projects/psirv/wiki/Wiki</span>
</td>
</tr>
</table>

**<span dir="">Contexte et statut</span>**

<table>
<tr>
<td>

**<span dir="">L’application RIGA est une application ACAI ancienne, lourde d’exploitation obligeant à de nombreuses actions manuelles pour permettre le recueil, la consolidation et la diffusion des informations relatives aux taux de participations aux grèves.<br>L’objectif de ce projet est de refondre cette application vers une nouvelle forme ergonomique intégrant les actions qui à ce jour doivent être réalisées manuellement en marge de RIGA et élargissant le périmètre des utilisateurs aux services qui ne sont pas reliés à notre réseau intranet (cas de certains établissements publics).<br>RIGA2 apporte essentiellement ces fonctionnalités supplémentaires :<br>- envoi de mail dans l’application<br>- exploitation statique (tableaux de synthèse)<br>- courant 2020 des évolutions pourront être envisagée pour intégrer l'utilisation des données du SIRH (effectifs, liste des services, liste des corps) en s'appuyant sur les web services de la zone d'échange</span>**
</td>
</tr>
</table>

 

<table>
<tr>
<td>

<span dir="">Application utilisée pour le recueil, la consolidation et la diffusion d’informations relatives aux taux de participations aux grèves.</span>
</td>
</tr>
</table>

**<span dir="">Statut du SI :</span>**

| Environnement | Version | Date d'installation |
|---------------|---------|---------------------|
| Pré-Production | 2.1.15 | 09/12/2024 |
| Production | 2.1.15 | 11/12/2024 |

<span dir="">Refonte de l'application est en cours de recette.</span>

**<span dir="">Description technique</span>**

<table>
<tr>
<td>

**<span dir="">Client FTP Filezilla<br>serveur: livraison8.ftp.vpn.e2.rie.gouv.fr<br>protocole: SFTP<br>login : ftp_RIGA<br>mot de passe : stocké sur dossier partagé</span>**
</td>
</tr>
<tr>
<td>

**<span dir="">Accès phpmyadmin en pré-production<br>URL en pré-production:</span>** **<span dir="">https://pma.preprod.vpn.e2.rie.gouv.fr</span>****\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*<span dir=""><br>Utilisateur BDD : riga_u1<br>Mot de passe BDD : stocké sur dossier partagé<br>Choix du serveur : Livraison 8 - (Jessie)<br>Nom de la BDD : riga<br>Nom du serveur de base de données à paramétrer dans l'application: mydb</span>**
</td>
</tr>
<tr>
<td>

**<span dir="">Accès phpmyadmin en production<br>URL en production:</span>** **<span dir="">https://pma.prod.vpn.e2.rie.gouv.fr</span>****\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*<span dir=""><br>nom de base, utilisateur et mot de passe identiques à ceux de la preprod<br>Choix du serveur : Mutu03 (la VM BDD est mutualisée pour le site "1000paysages" ??? et l'application "RIGA")<br>Nom du serveur de base de données à paramétrer dans l'application: mydb</span>**
</td>
</tr>
</table>

**<span dir="">Infra</span>**

<table>
<tr>
<td>

**<span dir="">URL du site en production :</span>** **<span dir="">http://riga.developpement-durable.gouv.fr/</span>**
</td>
</tr>
<tr>
<td>

**<span dir="">URL du site en préproduction :</span>** **<span dir="">http://riga.preprod.e2.rie.gouv.fr/</span>**
</td>
</tr>
</table>

**<span dir="">Hébergement</span>**

<table>
<tr>
<td>

<span dir="">Hébergement : **chez un hébergeur externe (entreprise ATE) car RIGA2 a besoin d’être accessible en internet, du fait d’utilisateurs (établissements publics) n’ayant pas accès au RIE. Cet hébergeur héberge les applications de type PHP. Alain Nicolas (Chef du pôle mise en production externalisée) au Pôle hébergement externe: est l'interlocuteur pour les applis PHP en ce qui concerne l'hébergement, plutôt que le CS.**</span>
</td>
</tr>
</table>

<span dir="">Préciser le VLAN :</span>

**<span dir="">Machine(s) et OS :</span>**

<span dir="">Machine(s) : physique si extra dry, vm si sec, so si nominal ?\
OS : nom et version</span>

**<span dir="">Stockage</span>**

<span dir="">Préciser ce qui est stocké en local / en espace partagé (SAN, FTP, etc)</span>

**<span dir="">Techno</span>**

<span dir="">Langage/framework :</span>

<table>
<tr>
<td>

**<span dir="">PHP-Mysql (PHP v5.6.4)</span>**
</td>
</tr>
</table>

<span dir="">SGBD :</span>

<table>
<tr>
<td>

**<span dir="">Mysql 5.5.62</span>**
</td>
</tr>
</table>

![image](uploads/432363be545f7f83c6bfc4fe80474d53/image.png)

<span dir="">Composants divers :</span>

<span dir="">Version JAVA</span>

**<span dir="">Staut pic</span>**

<span dir="">(eg : utilisation de git)</span>

**<span dir="">Services</span>**

**<span dir="">Supervision</span>**

**<span dir="">Gestion des incidents et problèmes</span>**

**<span dir="">Gestion des changements, des mep, déploiements</span>**

**<span dir="">Gestion de conf</span>**

**<span dir="">Gestion des opérations dont sauvegardes</span>**

**<span dir="">Gestion des RFS</span>**

**<span dir="">Gestion de la sécurité</span>**

**<span dir="">Gestion des accès et comptes</span>**

**<span dir="">Indicateurs</span>**

**<span dir="">Acteurs</span>**

* <span dir="">Pilote MCO : néant</span>
* <span dir="">MOE :</span>

<table>
<tr>
<td>

**<span dir="">SNUM/PNM/DPNM6</span>**
</td>
</tr>
</table>

* <span dir="">MOA/AMO/Product Owner :</span>

<table>
<tr>
<td>

**<span dir="">SG/DRH/P/DSNUMRH : Eric Boyon, qui passera la main à S. Rigobert en 2020.</span>**
</td>
</tr>
</table>

* <span dir="">Scrum Master si agile :</span>
* <span dir="">TMA : néant</span>
* <span dir="">Hébergement :</span>
* <span dir="">Administration :</span>
* <span dir="">Exploit / MCO : néant</span>
* <span dir="">Assistance :</span>
* <span dir="">Formation, animation réseau, etc :</span>
* <span dir="">Supervision :</span>

**<span dir="">Acquisitions</span>**

**<span dir="">Marchés mobilisés pour maintenance applicative, recette, exploitaiton</span>**

**<span dir="">Maintenance, support et licences matérielles, logicielles</span>**

**<span dir="">Liens</span>**

* [<span dir="">projet du portail hébergement - RIGA 2</span>](https://portail.centre-serveur.din.developpement-durable.gouv.fr/projects/riga-php)
* [<span dir="">Site web: </span>](https://sirh.projets.developpement-durable.gouv.fr/issues/www.riga.developpement-durable.gouv.fr)<span dir="">www.riga.developpement-durable.gouv.fr</span>
* <span dir="">fiche programme d'action annuelle correspondante</span>

 
```

</details>


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

`````

</details>


---

### 📄 `si/rimenvue-back.md` [9.489 octets]
<a id="si-rimenvue-back-md"></a> [↩ Retour à l'arborescence](#tree-si-rimenvue-back-md)

> **Chemin relatif** : `si/rimenvue-back.md`  
> **Taille** : 9.489 octets  
> **Lignes** : 463  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (463 lignes) - Cliquer pour déplier</summary>

`````markdown
﻿# Projet : rimenvue-back

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\rimenvue-back`

**Fichiers** : 9 fichiers non-binaires

## 📁 Arborescence des fichiers

├── <a id="tree--dockerignore"></a>[.dockerignore](#-dockerignore) *(13 octets)*
├── <a id="tree--editorconfig"></a>[.editorconfig](#-editorconfig) *(172 octets)*
├── <a id="tree--env-example"></a>[.env.example](#-env-example) *(451 octets)*
├── <a id="tree--eslintignore"></a>[.eslintignore](#-eslintignore) *(29 octets)*
├── <a id="tree--gitignore"></a>[.gitignore](#-gitignore) *(449 octets)*
├── <a id="tree--gitlab-ci-yml"></a>[.gitlab-ci.yml](#-gitlab-ci-yml) *(90 octets)*
├── <a id="tree--npmrc"></a>[.npmrc](#-npmrc) *(129 octets)*
├── <a id="tree-Dockerfile"></a>[Dockerfile](#Dockerfile) *(257 octets)*
└── <a id="tree-README-md"></a>[README.md](#README-md) *(1.032 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `.dockerignore` [13 octets]
<a id="-dockerignore"></a> [↩ Retour à l'arborescence](#tree--dockerignore)

> **Chemin relatif** : `.dockerignore`  
> **Taille** : 13 octets  
> **Lignes** : 2  
> **Type** : text

```text
node_modules

```


---

### 📄 `.editorconfig` [172 octets]
<a id="-editorconfig"></a> [↩ Retour à l'arborescence](#tree--editorconfig)

> **Chemin relatif** : `.editorconfig`  
> **Taille** : 172 octets  
> **Lignes** : 13  
> **Type** : text

```text
root = true

[*]
indent_style = space
indent_size = 2
end_of_line = lf
charset = utf-8
trim_trailing_whitespace = true
insert_final_newline = true

[*.yml]
indent_size = 2

```


---

### 📄 `.env.example` [451 octets]
<a id="-env-example"></a> [↩ Retour à l'arborescence](#tree--env-example)

> **Chemin relatif** : `.env.example`  
> **Taille** : 451 octets  
> **Lignes** : 17  
> **Type** : text

```text
TYPEORM_HOST=127.0.0.1
TYPEORM_PORT=5432
TYPEORM_USERNAME=root
TYPEORM_PASSWORD=root
TYPEORM_DATABASE=rimenvue-db
TYPEORM_ENTITIES="dist/**/*.entity{.ts,.js}||node_modules/@pasta/**/*.entity.js"
TYPEORM_SYNCHRONIZE=true

STORAGE_BUCKET=rimenvue
STORAGE_HOST=localhost
STORAGE_PORT=9000
STORAGE_SIGNED_URL_EXPIRATION=7d
STORAGE_ACCESS_KEY=ROOT
STORAGE_SECRET_KEY=ROOTROOT
STORAGE_ACCEPTED_EXTENSIONS="pdf"
STORAGE_ACCEPTED_MIME_TYPES="application/pdf"

```


---

### 📄 `.eslintignore` [29 octets]
<a id="-eslintignore"></a> [↩ Retour à l'arborescence](#tree--eslintignore)

> **Chemin relatif** : `.eslintignore`  
> **Taille** : 29 octets  
> **Lignes** : 4  
> **Type** : text

```text
.eslintrc.js
dist
migrations

```


---

### 📄 `.gitignore` [449 octets]
<a id="-gitignore"></a> [↩ Retour à l'arborescence](#tree--gitignore)

> **Chemin relatif** : `.gitignore`  
> **Taille** : 449 octets  
> **Lignes** : 44  
> **Type** : text

```text
# compiled output
/dist
/node_modules

# Logs
logs
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*
lerna-debug.log*

# OS
.DS_Store

# Tests
/coverage
/.nyc_output

# IDEs and editors
/.idea
.project
.classpath
.c9/
*.launch
.settings/
*.sublime-workspace

# IDE - VSCode
.vscode/*
!.vscode/settings.json
!.vscode/tasks.json
!.vscode/launch.json
!.vscode/extensions.json

# TypeORM
/ormconfig.json

ANSIBLE_VAULT_PASSWORD

# other
auth.sh
.env

```


---

### 📄 `.gitlab-ci.yml` [90 octets]
<a id="-gitlab-ci-yml"></a> [↩ Retour à l'arborescence](#tree--gitlab-ci-yml)

> **Chemin relatif** : `.gitlab-ci.yml`  
> **Taille** : 90 octets  
> **Lignes** : 4  
> **Type** : yaml

```yaml
include:
  - project: "snum/pnm3/public/pasta/pasta-ci"
    file: "applications/back.yml"

```


---

### 📄 `.npmrc` [129 octets]
<a id="-npmrc"></a> [↩ Retour à l'arborescence](#tree--npmrc)

> **Chemin relatif** : `.npmrc`  
> **Taille** : 129 octets  
> **Lignes** : 3  
> **Type** : text

```text
@pnm3:registry=https://europe-west9-npm.pkg.dev/dpnm3-lab/pnm3/
@pasta:registry=https://europe-west9-npm.pkg.dev/dpnm3-lab/pnm3/

```


---

### 📄 `Dockerfile` [257 octets]
<a id="Dockerfile"></a> [↩ Retour à l'arborescence](#tree-Dockerfile)

> **Chemin relatif** : `Dockerfile`  
> **Taille** : 257 octets  
> **Lignes** : 17  
> **Type** : dockerfile

```dockerfile
FROM node:16.13.1

WORKDIR /opt/app/

RUN apt-get update && apt-get install -y vim && apt-get clean;

COPY .npmrc .
COPY package-lock.json .
COPY package.json .
COPY .pastarc.json .

RUN npm ci --production

COPY dist/ ./dist/

CMD ["node", "dist/main.js"]

```


---

### 📄 `README.md` [1.032 octets]
<a id="README-md"></a> [↩ Retour à l'arborescence](#tree-README-md)

> **Chemin relatif** : `README.md`  
> **Taille** : 1.032 octets  
> **Lignes** : 70  
> **Type** : markdown

````markdown
# RIMENVUE - BACK

## First startup on local

1. Clone the repo

```bash
git clone https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/produits/support/rimenvue/back-rimenvue
```

2. Create a basic configuration

```bash
cd
cp .env.example .env
```

3. Install dependencies

```bash
npm i
```

4. Create the database

```bash
psql -c "CREATE DATABASE \"rimenvue-db\"";

## or if you are using docker

docker exec -ti postgres psql -c "CREATE DATABASE \"rimenvue-db\";
```

5. Run a meilisearch container

```bash
docker run -d --name search -p 7700:7700 getmeili/meilisearch:v1.13
```

6. Run a minio container

```bash
docker run -d \
  -p 9000:9000 \
  -p 9001:9001 \
  --name minio \
  -v ~/minio/data:/data \
  -e "MINIO_ROOT_USER=ROOT" \
  -e "MINIO_ROOT_PASSWORD=ROOTROOT" \
  quay.io/minio/minio server /data --console-address ":9001"
```

7. Start the server

```bash
npm run start:dev
```

8. Init auth in db

```bash
npx pasta init-auth-module
```

9. Restart server and DONE !

```bash
npm run start:dev
```

````


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

`````

</details>


---

### 📄 `si/rimenvue.md` [25.123 octets]
<a id="si-rimenvue-md"></a> [↩ Retour à l'arborescence](#tree-si-rimenvue-md)

> **Chemin relatif** : `si/rimenvue.md`  
> **Taille** : 25.123 octets  
> **Lignes** : 1021  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (1021 lignes) - Cliquer pour déplier</summary>

`````markdown
﻿# Projet : rimenvue

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\rimenvue`

**Fichiers** : 27 fichiers non-binaires

## 📁 Arborescence des fichiers

├── **rimenvue-back/**
│   ├── <a id="tree-rimenvue-back--dockerignore"></a>[.dockerignore](#rimenvue-back--dockerignore) *(13 octets)*
│   ├── <a id="tree-rimenvue-back--editorconfig"></a>[.editorconfig](#rimenvue-back--editorconfig) *(172 octets)*
│   ├── <a id="tree-rimenvue-back--env-example"></a>[.env.example](#rimenvue-back--env-example) *(451 octets)*
│   ├── <a id="tree-rimenvue-back--eslintignore"></a>[.eslintignore](#rimenvue-back--eslintignore) *(29 octets)*
│   ├── <a id="tree-rimenvue-back--gitignore"></a>[.gitignore](#rimenvue-back--gitignore) *(449 octets)*
│   ├── <a id="tree-rimenvue-back--gitlab-ci-yml"></a>[.gitlab-ci.yml](#rimenvue-back--gitlab-ci-yml) *(90 octets)*
│   ├── <a id="tree-rimenvue-back--npmrc"></a>[.npmrc](#rimenvue-back--npmrc) *(129 octets)*
│   ├── <a id="tree-rimenvue-back-Dockerfile"></a>[Dockerfile](#rimenvue-back-Dockerfile) *(257 octets)*
│   └── <a id="tree-rimenvue-back-README-md"></a>[README.md](#rimenvue-back-README-md) *(1.032 octets)*
└── **rimenvue-front/**
    ├── **docker/**
    │   └── <a id="tree-rimenvue-front-docker-nginx-conf"></a>[nginx.conf](#rimenvue-front-docker-nginx-conf) *(886 octets)*
    ├── **src/**
    │   ├── **app/**
    │   │   ├── **components/**
    │   │   │   └── <a id="tree-rimenvue-front-src-app-components--gitkeep"></a>[.gitkeep](#rimenvue-front-src-app-components--gitkeep) *(0 octets)*
    │   │   ├── **composable/**
    │   │   │   └── <a id="tree-rimenvue-front-src-app-composable--gitkeep"></a>[.gitkeep](#rimenvue-front-src-app-composable--gitkeep) *(0 octets)*
    │   │   ├── **stores/**
    │   │   │   └── <a id="tree-rimenvue-front-src-app-stores--gitkeep"></a>[.gitkeep](#rimenvue-front-src-app-stores--gitkeep) *(0 octets)*
    │   │   ├── **views/**
    │   │   │   └── <a id="tree-rimenvue-front-src-app-views-Home-vue"></a>[Home.vue](#rimenvue-front-src-app-views-Home-vue) *(1.366 octets)*
    │   │   └── <a id="tree-rimenvue-front-src-app-App-vue"></a>[App.vue](#rimenvue-front-src-app-App-vue) *(656 octets)*
    │   └── <a id="tree-rimenvue-front-src-style-css"></a>[style.css](#rimenvue-front-src-style-css) *(130 octets)*
    ├── <a id="tree-rimenvue-front--editorconfig"></a>[.editorconfig](#rimenvue-front--editorconfig) *(172 octets)*
    ├── <a id="tree-rimenvue-front--eslintignore"></a>[.eslintignore](#rimenvue-front--eslintignore) *(29 octets)*
    ├── <a id="tree-rimenvue-front--eslintrc-cjs"></a>[.eslintrc.cjs](#rimenvue-front--eslintrc-cjs) *(1.023 octets)*
    ├── <a id="tree-rimenvue-front--gitignore"></a>[.gitignore](#rimenvue-front--gitignore) *(253 octets)*
    ├── <a id="tree-rimenvue-front--gitlab-ci-yml"></a>[.gitlab-ci.yml](#rimenvue-front--gitlab-ci-yml) *(153 octets)*
    ├── <a id="tree-rimenvue-front--npmrc"></a>[.npmrc](#rimenvue-front--npmrc) *(128 octets)*
    ├── <a id="tree-rimenvue-front-Dockerfile"></a>[Dockerfile](#rimenvue-front-Dockerfile) *(95 octets)*
    ├── <a id="tree-rimenvue-front-README-md"></a>[README.md](#rimenvue-front-README-md) *(137 octets)*
    ├── <a id="tree-rimenvue-front-index-html"></a>[index.html](#rimenvue-front-index-html) *(566 octets)*
    ├── <a id="tree-rimenvue-front-postcss-config-cjs"></a>[postcss.config.cjs](#rimenvue-front-postcss-config-cjs) *(83 octets)*
    └── <a id="tree-rimenvue-front-tailwind-config-cjs"></a>[tailwind.config.cjs](#rimenvue-front-tailwind-config-cjs) *(274 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `rimenvue-back/.dockerignore` [13 octets]
<a id="rimenvue-back--dockerignore"></a> [↩ Retour à l'arborescence](#tree-rimenvue-back--dockerignore)

> **Chemin relatif** : `rimenvue-back/.dockerignore`  
> **Taille** : 13 octets  
> **Lignes** : 2  
> **Type** : text

```text
node_modules

```


---

### 📄 `rimenvue-back/.editorconfig` [172 octets]
<a id="rimenvue-back--editorconfig"></a> [↩ Retour à l'arborescence](#tree-rimenvue-back--editorconfig)

> **Chemin relatif** : `rimenvue-back/.editorconfig`  
> **Taille** : 172 octets  
> **Lignes** : 13  
> **Type** : text

```text
root = true

[*]
indent_style = space
indent_size = 2
end_of_line = lf
charset = utf-8
trim_trailing_whitespace = true
insert_final_newline = true

[*.yml]
indent_size = 2

```


---

### 📄 `rimenvue-back/.env.example` [451 octets]
<a id="rimenvue-back--env-example"></a> [↩ Retour à l'arborescence](#tree-rimenvue-back--env-example)

> **Chemin relatif** : `rimenvue-back/.env.example`  
> **Taille** : 451 octets  
> **Lignes** : 17  
> **Type** : text

```text
TYPEORM_HOST=127.0.0.1
TYPEORM_PORT=5432
TYPEORM_USERNAME=root
TYPEORM_PASSWORD=root
TYPEORM_DATABASE=rimenvue-db
TYPEORM_ENTITIES="dist/**/*.entity{.ts,.js}||node_modules/@pasta/**/*.entity.js"
TYPEORM_SYNCHRONIZE=true

STORAGE_BUCKET=rimenvue
STORAGE_HOST=localhost
STORAGE_PORT=9000
STORAGE_SIGNED_URL_EXPIRATION=7d
STORAGE_ACCESS_KEY=ROOT
STORAGE_SECRET_KEY=ROOTROOT
STORAGE_ACCEPTED_EXTENSIONS="pdf"
STORAGE_ACCEPTED_MIME_TYPES="application/pdf"

```


---

### 📄 `rimenvue-back/.eslintignore` [29 octets]
<a id="rimenvue-back--eslintignore"></a> [↩ Retour à l'arborescence](#tree-rimenvue-back--eslintignore)

> **Chemin relatif** : `rimenvue-back/.eslintignore`  
> **Taille** : 29 octets  
> **Lignes** : 4  
> **Type** : text

```text
.eslintrc.js
dist
migrations

```


---

### 📄 `rimenvue-back/.gitignore` [449 octets]
<a id="rimenvue-back--gitignore"></a> [↩ Retour à l'arborescence](#tree-rimenvue-back--gitignore)

> **Chemin relatif** : `rimenvue-back/.gitignore`  
> **Taille** : 449 octets  
> **Lignes** : 44  
> **Type** : text

```text
# compiled output
/dist
/node_modules

# Logs
logs
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*
lerna-debug.log*

# OS
.DS_Store

# Tests
/coverage
/.nyc_output

# IDEs and editors
/.idea
.project
.classpath
.c9/
*.launch
.settings/
*.sublime-workspace

# IDE - VSCode
.vscode/*
!.vscode/settings.json
!.vscode/tasks.json
!.vscode/launch.json
!.vscode/extensions.json

# TypeORM
/ormconfig.json

ANSIBLE_VAULT_PASSWORD

# other
auth.sh
.env

```


---

### 📄 `rimenvue-back/.gitlab-ci.yml` [90 octets]
<a id="rimenvue-back--gitlab-ci-yml"></a> [↩ Retour à l'arborescence](#tree-rimenvue-back--gitlab-ci-yml)

> **Chemin relatif** : `rimenvue-back/.gitlab-ci.yml`  
> **Taille** : 90 octets  
> **Lignes** : 4  
> **Type** : yaml

```yaml
include:
  - project: "snum/pnm3/public/pasta/pasta-ci"
    file: "applications/back.yml"

```


---

### 📄 `rimenvue-back/.npmrc` [129 octets]
<a id="rimenvue-back--npmrc"></a> [↩ Retour à l'arborescence](#tree-rimenvue-back--npmrc)

> **Chemin relatif** : `rimenvue-back/.npmrc`  
> **Taille** : 129 octets  
> **Lignes** : 3  
> **Type** : text

```text
@pnm3:registry=https://europe-west9-npm.pkg.dev/dpnm3-lab/pnm3/
@pasta:registry=https://europe-west9-npm.pkg.dev/dpnm3-lab/pnm3/

```


---

### 📄 `rimenvue-back/Dockerfile` [257 octets]
<a id="rimenvue-back-Dockerfile"></a> [↩ Retour à l'arborescence](#tree-rimenvue-back-Dockerfile)

> **Chemin relatif** : `rimenvue-back/Dockerfile`  
> **Taille** : 257 octets  
> **Lignes** : 17  
> **Type** : dockerfile

```dockerfile
FROM node:16.13.1

WORKDIR /opt/app/

RUN apt-get update && apt-get install -y vim && apt-get clean;

COPY .npmrc .
COPY package-lock.json .
COPY package.json .
COPY .pastarc.json .

RUN npm ci --production

COPY dist/ ./dist/

CMD ["node", "dist/main.js"]

```


---

### 📄 `rimenvue-back/README.md` [1.032 octets]
<a id="rimenvue-back-README-md"></a> [↩ Retour à l'arborescence](#tree-rimenvue-back-README-md)

> **Chemin relatif** : `rimenvue-back/README.md`  
> **Taille** : 1.032 octets  
> **Lignes** : 70  
> **Type** : markdown

````markdown
# RIMENVUE - BACK

## First startup on local

1. Clone the repo

```bash
git clone https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/produits/support/rimenvue/back-rimenvue
```

2. Create a basic configuration

```bash
cd
cp .env.example .env
```

3. Install dependencies

```bash
npm i
```

4. Create the database

```bash
psql -c "CREATE DATABASE \"rimenvue-db\"";

## or if you are using docker

docker exec -ti postgres psql -c "CREATE DATABASE \"rimenvue-db\";
```

5. Run a meilisearch container

```bash
docker run -d --name search -p 7700:7700 getmeili/meilisearch:v1.13
```

6. Run a minio container

```bash
docker run -d \
  -p 9000:9000 \
  -p 9001:9001 \
  --name minio \
  -v ~/minio/data:/data \
  -e "MINIO_ROOT_USER=ROOT" \
  -e "MINIO_ROOT_PASSWORD=ROOTROOT" \
  quay.io/minio/minio server /data --console-address ":9001"
```

7. Start the server

```bash
npm run start:dev
```

8. Init auth in db

```bash
npx pasta init-auth-module
```

9. Restart server and DONE !

```bash
npm run start:dev
```

````


---

### 📄 `rimenvue-front/.editorconfig` [172 octets]
<a id="rimenvue-front--editorconfig"></a> [↩ Retour à l'arborescence](#tree-rimenvue-front--editorconfig)

> **Chemin relatif** : `rimenvue-front/.editorconfig`  
> **Taille** : 172 octets  
> **Lignes** : 13  
> **Type** : text

```text
root = true

[*]
indent_style = space
indent_size = 2
end_of_line = lf
charset = utf-8
trim_trailing_whitespace = true
insert_final_newline = true

[*.yml]
indent_size = 2

```


---

### 📄 `rimenvue-front/.eslintignore` [29 octets]
<a id="rimenvue-front--eslintignore"></a> [↩ Retour à l'arborescence](#tree-rimenvue-front--eslintignore)

> **Chemin relatif** : `rimenvue-front/.eslintignore`  
> **Taille** : 29 octets  
> **Lignes** : 4  
> **Type** : text

```text
.eslintrc.js
dist
migrations

```


---

### 📄 `rimenvue-front/.eslintrc.cjs` [1.023 octets]
<a id="rimenvue-front--eslintrc-cjs"></a> [↩ Retour à l'arborescence](#tree-rimenvue-front--eslintrc-cjs)

> **Chemin relatif** : `rimenvue-front/.eslintrc.cjs`  
> **Taille** : 1.023 octets  
> **Lignes** : 39  
> **Type** : text

```text
// eslint-disable-next-line @typescript-eslint/no-var-requires
const pastaLint = require("@pasta/lint/front");

pastaLint.extends = [
  "eslint:recommended",
  "plugin:@typescript-eslint/eslint-recommended",
  "plugin:@typescript-eslint/recommended",
  "plugin:vue/essential",
  // "@vue/typescript",
];

pastaLint.rules["vue/no-setup-props-destructure"] = "off";
pastaLint.rules["vue/require-v-for-key"] = ["warn"];
pastaLint.rules["vue/no-multiple-template-root"] = ["warn"];
pastaLint.rules["vue/no-v-model-argument"] = ["off"];
pastaLint.rules["vue/multi-word-component-names"] = ["off"];
pastaLint.rules["vue/valid-v-slot"] = ["off"];
pastaLint.rules["no-empty"] = ["warn"];

module.exports = {
  ...pastaLint,
  parser: "vue-eslint-parser",
  parserOptions: {
    parser: "@typescript-eslint/parser",
    sourceType: "module",
  },
  overrides: [
    {
      files: [
        "**/__tests__/*.{j,t}s?(x)",
        "**/tests/unit/**/*.spec.{j,t}s?(x)",
      ],
      env: {
        jest: true,
      },
    },
  ],
};

```


---

### 📄 `rimenvue-front/.gitignore` [253 octets]
<a id="rimenvue-front--gitignore"></a> [↩ Retour à l'arborescence](#tree-rimenvue-front--gitignore)

> **Chemin relatif** : `rimenvue-front/.gitignore`  
> **Taille** : 253 octets  
> **Lignes** : 25  
> **Type** : text

```text
# Logs
logs
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*
pnpm-debug.log*
lerna-debug.log*

node_modules
dist
dist-ssr
*.local

# Editor directories and files
.vscode/*
!.vscode/extensions.json
.idea
.DS_Store
*.suo
*.ntvs*
*.njsproj
*.sln
*.sw?

```


---

### 📄 `rimenvue-front/.gitlab-ci.yml` [153 octets]
<a id="rimenvue-front--gitlab-ci-yml"></a> [↩ Retour à l'arborescence](#tree-rimenvue-front--gitlab-ci-yml)

> **Chemin relatif** : `rimenvue-front/.gitlab-ci.yml`  
> **Taille** : 153 octets  
> **Lignes** : 8  
> **Type** : yaml

```yaml
include:
  - project: "snum/pnm3/public/pasta/pasta-ci"
    file: "applications/front.yml"

variables:
  USE_NEW_REGISTRY: "true"
  NODE_VERSION: 20.9.0

```


---

### 📄 `rimenvue-front/.npmrc` [128 octets]
<a id="rimenvue-front--npmrc"></a> [↩ Retour à l'arborescence](#tree-rimenvue-front--npmrc)

> **Chemin relatif** : `rimenvue-front/.npmrc`  
> **Taille** : 128 octets  
> **Lignes** : 2  
> **Type** : text

```text
@pnm3:registry=https://europe-west9-npm.pkg.dev/dpnm3-lab/pnm3/
@pasta:registry=https://europe-west9-npm.pkg.dev/dpnm3-lab/pnm3/
```


---

### 📄 `rimenvue-front/docker/nginx.conf` [886 octets]
<a id="rimenvue-front-docker-nginx-conf"></a> [↩ Retour à l'arborescence](#tree-rimenvue-front-docker-nginx-conf)

> **Chemin relatif** : `rimenvue-front/docker/nginx.conf`  
> **Taille** : 886 octets  
> **Lignes** : 33  
> **Type** : conf

```conf
# from https://cli.vuejs.org/guide/deployment.html#docker-nginx

user  nginx;
worker_processes  1;
error_log  /var/log/nginx/error.log warn;
pid        /var/run/nginx.pid;
events {
  worker_connections  1024;
}
http {
  include       /etc/nginx/mime.types;
  default_type  application/octet-stream;
  log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                    '$status $body_bytes_sent "$http_referer" '
                    '"$http_user_agent" "$http_x_forwarded_for"';
  access_log  /var/log/nginx/access.log  main;
  sendfile        on;
  keepalive_timeout  65;
  server {
    listen       80;
    server_name  localhost;
    location / {
      root   /app;
      index  index.html;
      try_files $uri $uri/ /index.html;
    }
    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
      root   /usr/share/nginx/html;
    }
  }
}

```


---

### 📄 `rimenvue-front/Dockerfile` [95 octets]
<a id="rimenvue-front-Dockerfile"></a> [↩ Retour à l'arborescence](#tree-rimenvue-front-Dockerfile)

> **Chemin relatif** : `rimenvue-front/Dockerfile`  
> **Taille** : 95 octets  
> **Lignes** : 7  
> **Type** : dockerfile

```dockerfile
FROM nginx:latest

RUN mkdir /app
COPY dist /app
COPY docker/nginx.conf /etc/nginx/nginx.conf


```


---

### 📄 `rimenvue-front/index.html` [566 octets]
<a id="rimenvue-front-index-html"></a> [↩ Retour à l'arborescence](#tree-rimenvue-front-index-html)

> **Chemin relatif** : `rimenvue-front/index.html`  
> **Taille** : 566 octets  
> **Lignes** : 17  
> **Type** : html

```html
<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <link rel="icon" href="bnumloader.svg" />
    <link rel="bnum-icon" href="/bnumloader.svg" />
    <link rel="icon" href="/bnumloader.svg" type="image/svg+xml" />
    <link rel="shortcut icon" href="/bnumloader.svg" type="image/x-icon" />
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>

```


---

### 📄 `rimenvue-front/postcss.config.cjs` [83 octets]
<a id="rimenvue-front-postcss-config-cjs"></a> [↩ Retour à l'arborescence](#tree-rimenvue-front-postcss-config-cjs)

> **Chemin relatif** : `rimenvue-front/postcss.config.cjs`  
> **Taille** : 83 octets  
> **Lignes** : 7  
> **Type** : text

```text
module.exports = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
};

```


---

### 📄 `rimenvue-front/README.md` [137 octets]
<a id="rimenvue-front-README-md"></a> [↩ Retour à l'arborescence](#tree-rimenvue-front-README-md)

> **Chemin relatif** : `rimenvue-front/README.md`  
> **Taille** : 137 octets  
> **Lignes** : 16  
> **Type** : markdown

````markdown
# RIMENVUE - FRONT

## First startup on local

1. Install dependencies

```bash
npm i
```

2.  Start and DONE !

```bash
npm run dev
```

````


---

### 📄 `rimenvue-front/src/app/App.vue` [656 octets]
<a id="rimenvue-front-src-app-App-vue"></a> [↩ Retour à l'arborescence](#tree-rimenvue-front-src-app-App-vue)

> **Chemin relatif** : `rimenvue-front/src/app/App.vue`  
> **Taille** : 656 octets  
> **Lignes** : 28  
> **Type** : text

````text
<template>
  <PMain
    :footer-label="footerLabel"
    :header-title="config.headerTitle || ''"
    :header-subtitle="config.headerSubtitle || ''"
    root-link="/"
  >
    <template #header-right>
      <UserDropdown aria-label="Profil" />
    </template>
  </PMain>
</template>

<script setup lang="ts">
import { PMain, useConfig } from "@pasta/box-v2";
import { useHead } from "@unhead/vue";
import { UserDropdown } from "@pasta/front-auth-v2";

const config = useConfig();

useHead({
  title: config.headerTitle || "Demo app",
  meta: [{ charset: "utf-8" }],
});

const footerLabel = `${config.footerNote || ""} - v${config.version || ""}`;
</script>

````


---

### 📄 `rimenvue-front/src/app/components/.gitkeep` [0 octets]
<a id="rimenvue-front-src-app-components--gitkeep"></a> [↩ Retour à l'arborescence](#tree-rimenvue-front-src-app-components--gitkeep)

> **Chemin relatif** : `rimenvue-front/src/app/components/.gitkeep`  
> **Taille** : 0 octets  
> **Lignes** : 0  
> **Type** : text

```text

```


---

### 📄 `rimenvue-front/src/app/composable/.gitkeep` [0 octets]
<a id="rimenvue-front-src-app-composable--gitkeep"></a> [↩ Retour à l'arborescence](#tree-rimenvue-front-src-app-composable--gitkeep)

> **Chemin relatif** : `rimenvue-front/src/app/composable/.gitkeep`  
> **Taille** : 0 octets  
> **Lignes** : 0  
> **Type** : text

```text

```


---

### 📄 `rimenvue-front/src/app/stores/.gitkeep` [0 octets]
<a id="rimenvue-front-src-app-stores--gitkeep"></a> [↩ Retour à l'arborescence](#tree-rimenvue-front-src-app-stores--gitkeep)

> **Chemin relatif** : `rimenvue-front/src/app/stores/.gitkeep`  
> **Taille** : 0 octets  
> **Lignes** : 0  
> **Type** : text

```text

```


---

### 📄 `rimenvue-front/src/app/views/Home.vue` [1.366 octets]
<a id="rimenvue-front-src-app-views-Home-vue"></a> [↩ Retour à l'arborescence](#tree-rimenvue-front-src-app-views-Home-vue)

> **Chemin relatif** : `rimenvue-front/src/app/views/Home.vue`  
> **Taille** : 1.366 octets  
> **Lignes** : 56  
> **Type** : text

```text
<template>
  <div>
    <div>Bienvenue dans votre application Pasta</div>

    <PFileupload
      label="Fichier"
      detail="aa"
      @change="uploadFiles"
    ></PFileupload>

    <PButton
      v-for="document in documents"
      :key="document.storageKey"
      @click="openLink(document)"
      >{{ document.name }}</PButton
    >
  </div>
</template>

<script setup lang="ts">
import { PButton, PFileupload } from "@pasta/box-v2";
import { useFileApi } from "../http/file.api";
import { onMounted, ref } from "vue";
import { useDocumentApi } from "../http/document.api";
import { DocumentDto } from "../dto/document.dto";

const fileApi = useFileApi();
const documentApi = useDocumentApi();

const documents = ref<DocumentDto[]>([]);

onMounted(async () => {
  documents.value = (
    await documentApi.fetchList({ limit: 100, offset: 0 })
  ).data;
});

const openLink = async (document: DocumentDto) => {
  const url = await documentApi.getLink(document.id);
  window.open(url, "_blank");
};

async function uploadFiles(files: File[]): Promise<void> {
  for (const file of files) {
    const form = new FormData();
    form.append("file", file);
    const response = await fileApi.uploadFile(form);
    await documentApi.create({
      storageKey: response.key,
      mimeType: response.mimeType,
      name: response.originalname,
    });
  }
}
</script>

```


---

### 📄 `rimenvue-front/src/style.css` [130 octets]
<a id="rimenvue-front-src-style-css"></a> [↩ Retour à l'arborescence](#tree-rimenvue-front-src-style-css)

> **Chemin relatif** : `rimenvue-front/src/style.css`  
> **Taille** : 130 octets  
> **Lignes** : 10  
> **Type** : css

```css
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  body {
    -webkit-font-smoothing: antialiased;
  }
}

```


---

### 📄 `rimenvue-front/tailwind.config.cjs` [274 octets]
<a id="rimenvue-front-tailwind-config-cjs"></a> [↩ Retour à l'arborescence](#tree-rimenvue-front-tailwind-config-cjs)

> **Chemin relatif** : `rimenvue-front/tailwind.config.cjs`  
> **Taille** : 274 octets  
> **Lignes** : 11  
> **Type** : text

```text
// eslint-disable-next-line @typescript-eslint/no-var-requires
const tailwind = require("@pasta/box-v2/tailwind.config.cjs");
module.exports = {
  ...tailwind,
  content: [
    "./index.html",
    "./src/**/*.{vue,ts}",
    "./node_modules/@pasta/**/*.{vue,ts,js}",
  ],
};

```


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

`````

</details>


---

### 📄 `si/sigefoups.analysis.md` [13.736 octets]
<a id="si-sigefoups-analysis-md"></a> [↩ Retour à l'arborescence](#tree-si-sigefoups-analysis-md)

> **Chemin relatif** : `si/sigefoups.analysis.md`  
> **Taille** : 13.736 octets  
> **Lignes** : 383  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (383 lignes) - Cliquer pour déplier</summary>

````markdown
# ?? Analyse complète de **SIGEF-OUPS**

> **SIGEF-OUPS**  
> *OUtils de Publication de Stages*  CMVRH de Toulouse  
> Auteurs : Alexandre DUMONT (20142015), Bakary TOUNKARA (2016)  
> Licence : CC-BY-NC-SA 3.0  

---

## ?? Table des matières

- [1. Vue densemble fonctionnelle](#1-vue-densemble-fonctionnelle)
  - [1.1 Acteurs](#11-acteurs)
  - [1.2 Cas dusage](#12-cas-dusage)
  - [1.3 Fonctionnalités principales](#13-fonctionnalités-principales)
  - [1.4 Règles métier structurantes](#14-règles-métier-structurantes)
- [2. Modélisation détaillée des processus métier](#2-modélisation-détaillée-des-processus-métier)
  - [2.1 Cycle de vie dune action de formation](#21-cycle-de-vie-dune-action-de-formation)
  - [2.2 Workflow : extraction dindicateurs](#22-workflow--extraction-dindicateurs)
  - [2.3 Algorithme de filtrage multi-critères](#23-algorithme-de-filtrage-multi-critères)
- [3. Architecture technique](#3-architecture-technique)
  - [3.1 Structure du code](#31-structure-du-code)
  - [3.2 Dépendances externes](#32-dépendances-externes)
  - [3.3 Sécurité](#33-sécurité)
  - [3.4 Dette technique](#34-dette-technique)
- [4. Annexes](#4-annexes)
  - [4.1 Modèles de données (tables principales)](#41-modèles-de-données-tables-principales)
  - [4.2 Références techniques et liens utiles](#42-références-techniques-et-liens-utiles)

---

## 1. Vue densemble fonctionnelle

### 1.1 Acteurs

| Acteur | Rôle | Fichiers clés impliqués |
|--------|------|-------------------------|
| **Agent / Stagiaire** | Consulter / Sinscrire / Consulter son panier | `web/consulter.php`, `web/rechercher.php`, `web/gestion_panier.php` |
| **Formateur** | Accéder à ses sessions, éventuellement modifier ses données | `web/extract/formateur_extract.php`, `web/admin/admin_formateur.php` |
| **Chef de projet / MOE (Maître duvre)** | Gestion des actions de formation, édition, validation | `web/gestion/gestion.php`, `web/gestion/modifier_formation.php`, `web/validation.php` |
| **MOA (Maître douvrage)** | Suivi budgétaire, indicateurs, reporting | `web/extract/indicateurs_suivi.php`, `web/report/entite.php`, `web/report/budget.php` |
| **Administrateur** | Gestion des utilisateurs, des modèles, des paramètres | `web/admin/admin_modele.php`, `web/param/gestion_formateur.php`, `web/user/ajouter.php` |

---

### 1.2 Cas dusage

```plantuml
@startuml
left to right direction
actor Agent as A
actor MOE as M
actor MOA as O
actor Admin as D

A --> (Consulter offre de formation)
A --> (S'inscrire à une formation)
A --> (Consulter ses inscriptions)

M --> (Créer / modifier action de formation)
M --> (Gérer les sessions)
M --> (Valider une action)

O --> (Extraire indicateurs)
O --> (Générer calendrier / catalogue PDF)
O --> (Consulter répartition par MOA)

D --> (Gérer formateurs / services / modèles)
D --> (Exporter données administratives)

note right of O
  Extraction via web/extract/indicateurs_suivi.php
  Génération PDF via FPDF
end note
@enduml
```

---

### 1.3 Fonctionnalités principales

| Module | Fonctionnalité | Fichiers clés |
|--------|----------------|---------------|
| **Catalogue & Recherche** | Recherche textuelle, filtres dynamiques, auto-complétion | `web/rechercher.php`, `web/recherche_autocompletion.php`, `web/recherche_detail.php` |
| **Gestion des formations** | Création, édition, suppression, validation, abonnement | `web/gestion/gestion.php`, `web/gestion/modifier_formation.php`, `web/validation.php`, `web/gestion_abonnement.php` |
| **Extraction & Reporting** | PDF/ODS (calendrier, catalogue, indicateurs), exports structurés | `web/extract/indicateurs_suivi.php`, `web/extract/doc_extract.php`, `web/lib/inc/fpdf/`, `web/lib/inc/calc/` |
| **Paramétrage** | Modèles, formateurs, MOA/MOE, parcours, typologies | `web/param/gestion_formateur.php`, `web/param/gestion_modele.php`, `web/param/parcours_du.php` |

---

### 1.4 Règles métier structurantes

#### ? Typologie dune formation

Une **action de formation** est définie par des champs obligatoires :

| Champ | Source | Contrainte métier |
|-------|--------|-------------------|
| `num_enreg` | `action_formation.num_enreg` | Identifiant unique |
| `annee_reference` | `action_formation.annee_reference` | Année civile de gestion |
| `titre`, `objectif`, `cible` | `action_formation.*` | Texte obligatoire, UTF-8 |
| `domaine_formation`, `sous_domaine`, `parcours_du` | Jointures `domaine_formation`, `parcours_du` | Hiérarchie contrôlée |
| `duree`, `nb_session`, `nb_jour` | `FLOAT` | `nb_jour = duree × nb_session` |
| `moe`, `moa`, `type_moa` | Tables `maitre_oeuvre`, `maitre_ouvrage` | MOE ? MOA (peut être multi-MOA via `action_formation_multimoa`) |

> ?? Voir aussi : `web/gestion/session_utils.php` (1917 lignes), cur de la logique métier.

#### ? Budget

Répartition des dépenses (cf. `session_utils.php`, `indicateurs_suivi.php`) :

```
Total engagé = titre2 + titre3_deplacement_formateur + titre3_achat_prestation + titre3_frais_logistique + titre9
```

- `titre2` : coûts pédagogiques
- `titre3_*` : coûts annexes (déplacement, prestation, logistique)
- `titre9` : autres

#### ? Validation

Une formation ne peut être publiée que si :

1. Elle possède au moins **une session planifiée**
2. Le statut est ? `'brouillon'`
3. Les champs `duree`, `titre`, `objectif`, `cible` sont non vides

> Contrôle dans `web/validation.php` (L150200)

---

## 2. Modélisation détaillée des processus métier

### 2.1 Cycle de vie dune action de formation

```plantuml
@startuml
[*] --> Brouillon : création
Brouillon --> En_validation : soumission
En_validation --> Refusée : rejet MOE
En_validation --> Publiée : validation MOE
Publiée --> Archivée : +1 an après fin dernière session
Refusée --> Brouillon : correction
@enduml
```

> **Sources** : `web/validation.php`, `web/gestion/gestion.php`, `web/gestion/modifier_formation.php`

---

### 2.2 Workflow : extraction dindicateurs

```plantuml
@startuml
title Extraction des indicateurs de suivi

actor Utilisateur
participant "web/extract/indicateurs_suivi.php" as UI
participant "web/extract/indicateurs_suivi_extract.php" as EXTRACT
database "Base de données" as DB

Utilisateur -> UI : POST(filtres, annee, etc.)
UI -> EXTRACT : Appel (require)
EXTRACT -> DB : SELECT + jointures complexes\n(action_formation, maitre_ouvrage,\nparcours_du, programme_lolf...)
DB --> EXTRACT : Résultats bruts
EXTRACT --> UI : Pré-formatage (tableaux HTML / tableau intermédiaire)
UI -> UI : Construction interface (onglets, exports)
UI --> Utilisateur : Interface interactive + liens vers exports PDF/ODS

note right
  Filtres dynamiques via `get_filter()`,\net `extract_util.php`
end note
@enduml
```

---

### 2.3 Algorithme de filtrage multi-critères

Extrait du code (`web/extract/indicateurs_suivi.php`, `fiche_indicateurs_suivi.php`) :

```php
// Construction dynamique des colonnes sélectionnées
function get_filter($input_name, $label, &$tab_retour_sql) {
    if (!isset($_POST[$input_name]) || empty($_POST[$input_name])) return;
    $tab_retour_sql[] = $label; // utilisé pour lentête HTML/PDF
}
```

#### Matrice des filtres disponibles

| Groupe | Checkbox `name` | Colonne SQL | Format sortie |
|--------|-----------------|-------------|---------------|
| **Action** | `check_num_enreg` | `af.num_enreg` | `2cm_center` |
|  | `check_titre` | `af.titre` | `7cm` |
|  | `check_domaine` | `d.libelle` | `6.5cm` |
|  | `check_maitrise_ouvrage` | `af.type_moa` | `2cm_center` |
|  | `check_moe` | `moe.libelle` | `3cm_center` |
|  | `check_standard` | `af.formation_standardisee` | `2cm_center` |
| **Session** | `check_num_enreg_session` | `CONCAT(af.num_enreg,'-',s.numero_session)` | `2cm_center` |
|  | `check_moa_session` | `moa.libelle` | `4cm_center` |
|  | `check_date_deb_session` | `s.debut` | `2.3cm_center` |
| **Formateur** | `check_externe` | `f.externe` | `2cm_center` |
|  | `check_duree_intervention` | `f.duree_intervention` | `3cm_center` |

> Les filtres sont **cumulatifs (ET)**. Le préfixe `%session%` ou `%formateur%` déclenche une jointure conditionnelle.

#### Diagramme décisionnel (extrait du filtre MOA)

```plantuml
@startuml
start
:GET filtre_moa;
if (valeur fournie?) then (oui)
  :Ajouter\nWHERE moa.id = :filtre_moa;
else (non)
  :Ignorer ce critère;
endif
stop
@enduml
```

---

## 3. Architecture technique

### 3.1 Structure du code

```plantuml
@startuml
skinparam componentStyle rectangle
skinparam wrapWidth 200

package "web/" {
  [index.php] --> [lib/auth.php]
  [gestion/gestion.php]
  [extract/indicateurs_suivi.php]
  [param/gestion_formateur.php]
  [admin/admin_formateur.php]
  [rechercher.php]
  [consulter.php]
  
  package "lib/" {
    [auth.php] --> [template/en_tete.php]
    [gestion/session_utils.php] as UTILS
    [inc/fpdf/] as FPDF
    [inc/calc/] as CALC
  }

  package "gestion/" {
    [modifier_formation.php]
    [supprimer.php]
    [edition_modele.php]
  }

  package "extract/" {
    [indicateurs_suivi_extract.php]
    [formateur_extract.php]
    [doc_extract.php]
  }
}

UTILS ..> FPDF : Utilise PDF.php (wrapper fpdf)
UTILS ..> CALC : Utilise OpenOfficeSpreadsheet.class.php

@enduml
```

> ?? **Note** : Tous les scripts passent par `lib/auth.php` ? authentification obligatoire (voir `.htaccess` pour blocage Edge/Trident).

---

### 3.2 Dépendances externes

| Composant | Type | Usage | Fichiers concernés |
|-----------|------|-------|--------------------|
| **FPDF** | Librairie PDF | Génération de catalogues, calendriers, rapports | `web/lib/inc/fpdf/`, `web/lib/inc/PDF.php`, `web/mon_document.php` |
| **OpenOffice Spreadsheet** | Générateur ODS | Export tableau indicateurs (format OpenDocument) | `web/lib/inc/calc/`, classes `XMLDocument`, `Table`, `Fonction` |
| **MDB2 (PEAR)** | Couche daccès BD | Connexion SQL, exécution requêtes | `web/lib/inc/inc_general.php`, tous les `.php` de `extract/` et `gestion/` |

> ?? **Obsolescence** :  
> - MDB2 est déprécié depuis 2012 (remplacé par PDO ou Doctrine).  
> - Pas de gestion de *prepared statements* détectée ? risque **dinjection SQL** si non filtré en amont.

---

### 3.3 Sécurité

| Mécanisme | Implémentation | Fiabilité |
|-----------|----------------|-----------|
| **Authentification** | `lib/auth.php` + sessions PHP | ? Basique mais fonctionnel (pas de SSO, ni MFA) |
| **Contrôle daccès** | Variables `$_SESSION['etendu_moe']`, `$_SESSION['etendu_programme']` dans les requêtes | ?? Basé sur des listes CSV dans les `WHERE IN (...)`  vulnérable à contournement si session compromise |
| **Filtrage navigateur** | `.htaccess` bloque Edge/IE | ?? UX only  pas de sécurité réelle |
| **Sortie PDF** | `header()` + `readfile()` | ? Sécurisé si `$location` est validé (ex. `web/mon_document.php`) |

> ?? **Recommandation critique** :  
> - Remplacer les `$_POST` directs par des `filter_input()` (déjà partiellement utilisé)  
> - Éviter `require_once("../lib/inc/fpdf/fpdf.php")` sans validation de chemin

---

### 3.4 Dette technique

#### ?? Dette critique

| Problème | Localisation | Impact |
|----------|--------------|--------|
| **Duplication massive** | Mêmes blocs HTML/JS dans `gestion.php`, `modifier_formation.php`, `abonner.php` | Maintenance difficile, risque dincohérence |
| **SQL embarqué** | Longues requêtes en dur (ex. `indicateurs_suivi_extract.php`, L100+) | Impossible à tester/unit-tester, risque derreur |
| **Encodage manuel** | `iconv('UTF-8', 'windows-1252', ...)` pour FPDF | Fragile, échoue sur caractères hors CP1252 (ex. , ) |
| **Pas de tests** | Aucun fichier `test/` détecté | Rétro-compatibilité non garantie |

#### ?? Dette modérée

- PHP 5.x style (`require`, pas de classes MVC)
- FPDF v1.7 (2007) ? pas de Unicode natif
- Pas de cache applicatif ? requêtes répétées à chaque chargement

---

## 4. Annexes

### 4.1 Modèles de données (tables principales)

```sql
action_formation (
  id_action_formation PK,
  annee_reference INT,
  num_enreg VARCHAR,
  titre TEXT,
  objectif TEXT,
  cible TEXT,
  duree FLOAT,
  nb_session INT,
  nb_jour FLOAT,
  moe INT FK ? maitre_oeuvre,
  type_responsable VARCHAR(3),
  responsable INT FK ? maitre_oeuvre,
  moa INT FK ? maitre_ouvrage,
  type_moa VARCHAR,
  reunion_reseau VARCHAR(3),
  formation_standardisee VARCHAR(3),
  formation_distance VARCHAR(3),
  dern_modif DATETIME,
  statut VARCHAR(20) -- 'brouillon', 'validee', 'publiee'
)

session (
  id_session PK,
  id_action_formation FK,
  numero_session INT,
  debut DATETIME,
  fin DATETIME,
  lieu VARCHAR,
  code_region CHAR(2),
  code_departement CHAR(3),
  chef_formation VARCHAR,
  secretaire_formation VARCHAR,
  statut VARCHAR
)

maitre_ouvrage (id_maitre_ouvrage PK, libelle, type_moa)
maitre_oeuvre (id_maitre_oeuvre PK, libelle, service, externe BOOL)
parcours_du (id_parcours_du PK, libelle, ref_externe)
```

> ??? **Multi-MOA/MOE** via tables de jointure :  
> `action_formation_multimoa`, `action_formation_multimoe`

---

### 4.2 Références techniques et liens utiles

| Type | Valeur |
|------|--------|
| **URL assistance** | `http://intra.cmvrh.i2/sigef-r444.html?var_mode=calcul` |
| **Aide en ligne** | `http://info.rh.e2.rie.gouv.fr/aide_sigef` |
| **Contact admin** | `th.giraud@developpement-durable.gouv.fr` |
| **Navigateurs supportés** | Tous sauf Edge/IE (blocage via `.htaccess`) |
| **Encodage** | UTF-8 ? converti en CP1252 pour PDF |
| **Langue** | Français uniquement |


````

</details>


---

### 📄 `si/sij.analysis.md` [18.140 octets]
<a id="si-sij-analysis-md"></a> [↩ Retour à l'arborescence](#tree-si-sij-analysis-md)

> **Chemin relatif** : `si/sij.analysis.md`  
> **Taille** : 18.140 octets  
> **Lignes** : 565  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (565 lignes) - Cliquer pour déplier</summary>

````markdown
# Analyse Complète du Projet SIJ

> **Document autoporté** - Prêt à être rendu dans VS Code, Obsidian ou tout autre éditeur Markdown compatible avec PlantUML

## Table des Matières
- [1. Introduction et Contexte](#1-introduction-et-contexte)
- [2. Analyse Fonctionnelle](#2-analyse-fonctionnelle)
  - [2.1. Acteurs Principaux](#21-acteurs-principaux)
  - [2.2. Cas d'Usage](#22-cas-dusage)
  - [2.3. Règles Métier](#23-règles-métier)
  - [2.4. Workflow Fonctionnel](#24-workflow-fonctionnel)
- [3. Analyse Technique](#3-analyse-technique)
  - [3.1. Architecture Globale](#31-architecture-globale)
  - [3.2. Modules et Composants](#32-modules-et-composants)
  - [3.3. Dépendances et Stack Technique](#33-dépendances-et-stack-technique)
  - [3.4. Sécurité](#34-sécurité)
  - [3.5. Dette Technique](#35-dette-technique)
- [4. Processus CI/CD et Qualité](#4-processus-cicd-et-qualité)
- [5. Conclusion et Perspectives](#5-conclusion-et-perspectives)

## 1. Introduction et Contexte

Le projet SIJ (Support d'Information pour la Justice?) est une application web développée dans un contexte gouvernemental français, plus précisément au sein du ministère du développement durable. Le projet est hébergé sur l'infrastructure GitLab de l'administration et suit des pratiques de livraison continue avec monitoring de qualité.

**Points clés à retenir :**
- Projet hébergé sur l'infrastructure gouvernementale (`developpement-durable.gouv.fr`)
- Déployé via GitLab Pages à l'URL : https://snum.gitlab-pages.din.developpement-durable.gouv.fr/pnm3/produits/support/sij
- Architecture conteneurisée avec Docker
- Processus CI/CD automatisé avec GitLab CI
- Monitoring qualité complet via divers outils d'analyse

```plantuml
@startuml
!theme aws-orange
skinparam backgroundColor #f5f5f5
skinparam defaultFontSize 14

rectangle "Infrastructure Gouvernementale" {
  component "GitLab Instance\n(développement-durable.gouv.fr)" as gitlab
  component "GitLab Pages" as pages
  component "Registry\n(eu.gcr.io/dpnm3-lab)" as registry
  
  gitlab -r-> pages : "Déploiement"
  gitlab -d-> registry : "Push d'images"
}

rectangle "Projet SIJ" {
  component "Code Source" as code
  component "Pipeline CI/CD" as pipeline
  component "Application Web" as app
}

code --> pipeline : "Déclenche"
pipeline --> gitlab : "Utilise"
pipeline --> registry : "Stocke images"
pipeline --> pages : "Déploie vers"
pages --> app : "Héberge"
registry --> app : "Fournit images Docker"

note right of app
  URL publique:
  https://snum.gitlab-pages.din.developpement-durable.gouv.fr/pnm3/produits/support/sij
end note

@enduml
```

## 2. Analyse Fonctionnelle

### 2.1. Acteurs Principaux

D'après les fichiers fournis, on peut identifier les acteurs suivants :

```plantuml
@startuml
skinparam actor {
  BackgroundColor #FFE4B5
  BorderColor #8B4513
}
skinparam usecase {
  BackgroundColor #F0F8FF
  BorderColor #4682B4
}

actor "Administrateur Technique" as admin
actor "Utilisateur Final" as user
actor "Système de Monitoring" as monitor
actor "Processus CI/CD" as ci

rectangle "Système SIJ" {
  usecase "Consulter les pages d'information" as uc1
  usecase "Accéder aux statistiques" as uc2
  usecase "Vérifier le budget" as uc3
  usecase "Consulter les mentions légales" as uc4
  usecase "Accéder à la déclaration RGPD" as uc5
  usecase "Consulter la déclaration d'accessibilité" as uc6
}

user --> uc1
user --> uc2
user --> uc3
user --> uc4
user --> uc5
user --> uc6

admin --> ci : "Configure et supervise"
ci --> monitor : "Alimente les données"
monitor -[hidden]-> admin

note right of user
  Les utilisateurs finaux peuvent être:
  - Agents administratifs
  - Citoyens
  - Partenaires institutionnels
end note

@enduml
```

### 2.2. Cas d'Usage

Le projet SIJ semble principalement fournir un ensemble de pages d'information institutionnelles standardisées :

- **Page Statistiques** : Affichage des données et indicateurs
- **Page Budget** : Information sur les aspects financiers
- **Mentions Légales** : Cadre juridique de l'application
- **Déclaration RGPD** : Conformité au règlement général sur la protection des données
- **Déclaration d'Accessibilité** : Engagement pour l'accessibilité aux personnes handicapées

```plantuml
@startuml
left to right direction
skinparam packageStyle rectangle
skinparam wrapWidth 200

actor Utilisateur as user

package "SIJ - Pages d'information" {
  usecase "Accéder à la page d'accueil" as home
  usecase "Consulter les statistiques" as stats
  usecase "Vérifier le budget" as budget
  usecase "Lire les mentions légales" as legales
  usecase "Consulter la déclaration RGPD" as rgpd
  usecase "Vérifier l'accessibilité" as access
  
  home .> stats : "lien"
  home .> budget : "lien"
  home .> legales : "lien"
  home .> rgpd : "lien"
  home .> access : "lien"
}

user --> home
user --> stats
user --> budget
user --> legales
user --> rgpd
user --> access

note top of package
  Le système fournit un ensemble de pages
  institutionnelles standardisées pour répondre
  aux obligations légales et d'information
end note

@enduml
```

### 2.3. Règles Métier

Les règles métier identifiables dans les fichiers fournis sont principalement liées aux exigences institutionnelles françaises :

1. **Conformité RGPD** : Obligation de fournir une déclaration RGPD accessible
2. **Accessibilité** : Engagement pour le respect des normes d'accessibilité (probablement au niveau AA du RGAA)
3. **Transparence budgétaire** : Affichage des informations budgétaires
4. **Mentions légales complètes** : Respect du cadre juridique pour les sites publics
5. **Statistiques d'usage** : Fourniture de données sur l'utilisation du service

### 2.4. Workflow Fonctionnel

```plantuml
@startuml
title Workflow d'accès aux informations SIJ

start
:Utilisateur accède à l'URL;
if (Page demandée?) then (principale)
  :Afficher page d'accueil\navec menu de navigation;
else (spécifique)
  if (Type de page?) then (statistiques)
    :Charger et afficher les données statistiques;
  elseif (budget) then
    :Afficher les informations budgétaires;
  elseif (mentions légales) then
    :Afficher le cadre juridique;
  elseif (RGPD) then
    :Afficher les informations de conformité RGPD;
  elseif (accessibilité) then
    :Afficher la déclaration d'accessibilité;
  else (autre)
    :Afficher une page 404;
  endif
endif

stop

note right
  Ce workflow illustre comment un utilisateur
  navigue dans les différentes pages
  d'information fournies par le système SIJ.
end note

@enduml
```

## 3. Analyse Technique

### 3.1. Architecture Globale

```plantuml
@startuml
!theme aws-orange
skinparam componentStyle rectangle
skinparam wrapWidth 200

node "Infrastructure Cloud Gouvernementale" {
  cloud {
    node "GitLab\nCI/CD" as gitlab
    node "Container\nRegistry" as registry
    node "GitLab\nPages" as pages
  }
}

node "Environnement d'Exécution" {
  database "PostgreSQL 15.2" as db
  artifact "Application SIJ\n(eu.gcr.io/dpnm3-lab/sij:latest)" as app
}

gitlab --> registry : "Push des images Docker"
gitlab --> pages : "Déploiement de l'application"
registry --> app : "Fournit l'image conteneurisée"
pages --> app : "Héberge l'application web"
app --> db : "Connexion à la base de données"

note top of gitlab
  Pipeline automatisé avec GitLab CI:
  - Build de l'application
  - Analyse de qualité
  - Génération d'issues via gitlabbot
end note

note bottom of db
  Base de données PostgreSQL 15.2-alpine,
  probablement utilisée pour stocker:
  - Données statistiques
  - Informations de configuration
end note

@enduml
```

### 3.2. Modules et Composants

D'après l'analyse des fichiers fournis, l'application SIJ comporte les modules suivants :

```plantuml
@startuml
skinparam component {
  BackgroundColor #E6F3FF
  BorderColor #1E88E5
}
skinparam componentStyle uml2

package "Application SIJ" {
  component "Module Web Principal" as web
  component "Module Statistiques" as stats
  component "Module Budgétaire" as budget
  component "Module Légal" as legal
  component "Module Sécurité" as security
  component "Base de Données" as db
}

web --> stats : "Intègre"
web --> budget : "Intègre"
web --> legal : "Intègre"
web --> security : "Utilise"
web --> db : "Persiste les données"

stats ..> "Page /stats" : "Expose"
budget ..> "Page /budget" : "Expose"
legal ..> "Pages légales" : "Expose"
security ..> "Authentification/Authorization" : "Gère"

note right of web
  Le module web principal orchestre
  les autres modules et fournit
  l'interface utilisateur globale
end note

note bottom of db
  PostgreSQL 15.2-alpine:
  Stockage des données persistantes
  de l'application
end note

@enduml
```

### 3.3. Dépendances et Stack Technique

**Stack principale :**
- Backend : Non spécifié explicitement dans les fichiers fournis
- Base de données : PostgreSQL 15.2-alpine
- Conteneurisation : Docker
- CI/CD : GitLab CI avec Docker-in-Docker
- Langage de build : Gradle (JDK 16)

**Outils de qualité et monitoring :**
```plantuml
@startuml
title Outils de Qualité et Monitoring

package "Outils Publics" {
  [HTTP Monitoring] as http
  [SSL/TLS Analysis] as ssl
  [Third Party Audit] as third
  [Uptime Monitoring] as updown
  [Statistiques] as stats_tool
  [Budget Tracking] as budget_tool
  [Accessibilité] as ally
  [RGPD Compliance] as rgpd_tool
}

package "Outils Privés" {
  [Dependency Check] as depcheck
  [Lighthouse] as lh
  [SonarCloud] as sonar
  [Trivy (Security Scanning)] as trivy
}

http -[hidden]d-> ssl
ssl -[hidden]d-> third
third -[hidden]d-> updown
updown -[hidden]d-> stats_tool
depcheck -[hidden]d-> lh
lh -[hidden]d-> sonar
sonar -[hidden]d-> trivy

note right
  Ces outils sont configurés dans le fichier
  livraison-continue-kpi.yml pour assurer
  la qualité, la sécurité et la conformité
  de l'application SIJ.
end note

@enduml
```

### 3.4. Sécurité

La configuration du projet indique plusieurs mesures de sécurité :

1. **Scans de vulnérabilités** : Utilisation de Trivy pour scanner les images Docker
2. **Analyse des dépendances** : Outil dependency-check activé
3. **Analyse de code statique** : SonarCloud configuré
4. **Audit SSL/TLS** : TestSSL activé pour vérifier la configuration des certificats
5. **Conformité RGPD** : Déclaration spécifique présente dans l'application
6. **Accessibilité** : Déclaration d'accessibilité pour respecter les normes pour personnes handicapées

```plantuml
@startuml
!theme plain
skinparam monochrome true
skinparam defaultFontSize 13

rectangle "Stratégie de Sécurité SIJ" {
  (Périmètre d'analyse) as perimeter
  (Scans automatisés) as scans
  (Conformité) as compliance
  (Monitoring continu) as monitor
  
  perimeter --> scans : "Définit"
  scans --> compliance : "Alimente"
  compliance --> monitor : "Est vérifiée par"
}

perimeter : - Surface d'attaque de l'application web\n- Images Docker utilisées\n- Dépendances tierces
scans : - Trivy (sécurité des conteneurs)\n- Dependency-check (CVE dans les dépendances)\n- SonarCloud (qualité et vulnérabilités de code)
compliance : - Déclaration RGPD\n- Déclaration d'accessibilité\n- Analyse SSL/TLS (testssl)
monitor : - Uptime monitoring (updown.io)\n- Audit continu dans le pipeline CI/CD

note bottom
  La sécurité est intégrée dans le processus de développement\n
  via des scans automatisés dans le pipeline CI/CD et une\n
  conformité aux exigences institutionnelles françaises.
end note

@enduml
```

### 3.5. Dette Technique

D'après l'analyse des fichiers fournis, on peut identifier les éléments suivants concernant la dette technique :

1. **Documentation** : Le projet semble minimale (seulement 3 fichiers dans le dépôt analysé)
2. **Tests automatisés** : Aucune mention explicite de tests dans les configurations fournies
3. **Versioning** : Aucune stratégie de versioning définie dans les fichiers fournis
4. **Gestion des secrets** : Non spécifiée dans les configurations partagées
5. **Monitoring applicatif** : Limité aux outils externes, pas de monitoring interne détaillé visible

```plantuml
@startuml
title Évaluation de la Dette Technique Potentielle

skinparam defaultFontSize 13
skinparam defaultFontName Arial

rectangle "Domaines à Risque" {
  card "Documentation" as doc #FFCCCC
  card "Tests Automatisés" as tests #FFCCCC
  card "Gestion des Secrets" as secrets #FFCCCC
  card "Stratégie de Versioning" as version #FFCCCC
  card "Monitoring Applicatif" as monitor #FFCCCC
}

doc : Risque ÉLEVÉ\n- Peu de fichiers dans le dépôt\n- Documentation limitée visible
tests : Risque MOYEN\n- Aucune mention de tests unitaires/\nd'intégration dans la CI
secrets : Risque INCONNU\n- Non spécifié dans les\nconfigurations fournies
version : Risque MOYEN\n- Pas de stratégie de versioning\nexplicite visible
monitor : Risque FAIBLE\n- Outils de monitoring externes\nconfigurés, mais monitoring\ninterne non visible

note right of doc
  Cette évaluation est basée uniquement
  sur les fichiers fournis et ne représente
  pas nécessairement l'état réel complet
  du projet.
end note

@enduml
```

## 4. Processus CI/CD et Qualité

Le pipeline CI/CD est configuré via le fichier `.gitlab-ci.yml` et utilise un outil personnalisé appelé `gitlabbot-2.1.jar` pour générer des issues GitLab automatiquement.

```plantuml
@startuml
title Processus CI/CD du projet SIJ

start
:Push de code/\nCréation de tag;
:Pipeline GitLab CI déclenché;
:Utilisation de l'image\ngradle:jdk16;
:Exécution de gitlabbot-2.1.jar\n(generate-issues);
note right
  Commande:
  java -jar gitlabbot-2.1.jar 
  generate-issues -p ${CI_PROJECT_ID}
  -t ${CI_LABOMATIC} -m debug
end note
:Analyse des KPI via\nlivraison-continue-kpi.yml;
:Build des images Docker;
:Scan de sécurité (Trivy,\nDependency-check);
:Analyse de code (SonarCloud,\nLighthouse);
if (Tous les tests réussis?) then (oui)
  :Déploiement sur GitLab Pages;
  :Mise à jour des images dans le registry;
  stop
else (non)
  :Notification d'échec;
  :Création d'issues via gitlabbot;
  stop
endif

@enduml
```

**Matrice des Outils de Qualité :**

| Catégorie | Outil | Statut | Description |
|-----------|-------|--------|-------------|
| **Publics** | HTTP Monitoring | ? Activé | Surveillance de la disponibilité et performances HTTP |
| | SSL/TLS Analysis | ? Activé | Vérification de la configuration SSL/TLS |
| | Third Parties Audit | ? Activé | Analyse des dépendances externes |
| | Uptime Monitoring | ? Activé | Surveillance de la disponibilité via updown.io |
| | Statistiques | ? Activé | Suivi des métriques d'utilisation |
| | Budget | ? Activé | Suivi des aspects financiers |
| | Accessibilité | ? Activé | Vérification de la conformité d'accessibilité |
| | RGPD | ? Activé | Vérification de la conformité RGPD |
| **Privés** | 404 Check | ? Désactivé | Détection des pages non trouvées |
| | Dependency Check | ? Activé | Analyse des vulnérabilités dans les dépendances |
| | Lighthouse | ? Activé | Audit de performance, accessibilité et SEO |
| | SonarCloud | ? Activé | Analyse statique de code et qualité |
| | Trivy | ? Activé | Scan de sécurité des images Docker |

## 5. Conclusion et Perspectives

### Synthèse de l'Analyse
Le projet SIJ est une application web institutionnelle française développée selon les bonnes pratiques gouvernementales actuelles. Son architecture est principalement orientée vers la conformité légale (RGPD, accessibilité) et la transparence (budget, statistiques).

**Points forts identifiés :**
- Processus CI/CD robuste avec intégration continue
- Couverture complète des outils de qualité et de sécurité
- Architecture conteneurisée moderne
- Conformité aux exigences institutionnelles

**Axes d'amélioration potentiels :**
- Documentation plus complète du projet
- Stratégie de tests plus visible dans les configurations
- Gestion des secrets plus explicite
- Stratégie de versioning plus définie

```plantuml
@startuml
title Feuille de Route Recommandée

skinparam backgroundColor #FFF8E1
skinparam defaultFontSize 13

package "Court terme (1-3 mois)" #FFF3E0 {
  [améliorer la documentation] as doc1
  [mettre en place des tests unitaires] as test1
  [documenter la gestion des secrets] as secret1
}

package "Moyen terme (3-6 mois)" #E3F2FD {
  [définir une stratégie de versioning] as version1
  [améliorer le monitoring applicatif] as monitor1
  [automatiser les mises à jour de dépendances] as dep1
}

package "Long terme (6+ mois)" #E8F5E9 {
  [mise en place d'une architecture microservices] as micro
  [implémentation d'une API publique] as api
  [internationalisation de l'application] as i18n
}

doc1 -r-> test1
test1 -d-> secret1
secret1 -d-> version1
version1 -r-> monitor1
monitor1 -d-> dep1
dep1 -d-> micro
micro -r-> api
api -d-> i18n

note bottom
  Cette feuille de route est basée sur l'analyse
  des fichiers fournis et vise à renforcer
  la qualité, la maintenabilité et l'évolutivité
  du projet SIJ.
end note

@enduml
```

### Recommandations Finales

1. **Améliorer la documentation** : Documenter l'architecture, les choix techniques et les processus métier
2. **Renforcer la stratégie de tests** : Ajouter des tests unitaires, d'intégration et end-to-end
3. **Sécuriser la gestion des secrets** : Mettre en place une solution robuste pour gérer les secrets dans le pipeline CI/CD
4. **Structurer le versioning** : Adopter une stratégie de versioning sémantique et documentée
5. **Étendre le monitoring** : Ajouter du monitoring applicatif interne pour compléter les outils externes

Ce document, basé exclusivement sur l'analyse des fichiers fournis, présente une vue complète du projet SIJ, couvrant à la fois ses aspects fonctionnels et techniques, ainsi que des recommandations pour son amélioration continue.
````

</details>


---

### 📄 `si/sij.md` [6.501 octets]
<a id="si-sij-md"></a> [↩ Retour à l'arborescence](#tree-si-sij-md)

> **Chemin relatif** : `si/sij.md`  
> **Taille** : 6.501 octets  
> **Lignes** : 264  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (264 lignes) - Cliquer pour déplier</summary>

````markdown
﻿# Projet : sij

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\sij`

**Fichiers** : 3 fichiers non-binaires

## 📁 Arborescence des fichiers

├── **depot_pour_oracle19/**
│   └── <a id="tree-depot_pour_oracle19--gitkeep"></a>[.gitkeep](#depot_pour_oracle19--gitkeep) *(0 octets)*
├── <a id="tree--gitlab-ci-yml"></a>[.gitlab-ci.yml](#-gitlab-ci-yml) *(377 octets)*
└── <a id="tree-livraison-continue-kpi-yml"></a>[livraison-continue-kpi.yml](#livraison-continue-kpi-yml) *(1.193 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `.gitlab-ci.yml` [377 octets]
<a id="-gitlab-ci-yml"></a> [↩ Retour à l'arborescence](#tree--gitlab-ci-yml)

> **Chemin relatif** : `.gitlab-ci.yml`  
> **Taille** : 377 octets  
> **Lignes** : 22  
> **Type** : yaml

```yaml
image: docker:stable



services:
  - name: docker:dind


stages:
    - labomatic-it

labomatic:
    stage: labomatic-it
    image: gradle:jdk16

    script:
        - echo "== debut labomatic avec gitlabbot-2.1"
        - java -jar gitlabbot-2.1.jar generate-issues -p ${CI_PROJECT_ID} -t  ${CI_LABOMATIC}  -m debug
        - echo "== fin labomatic"
#    only:
#        - tag

```


---

### 📄 `depot_pour_oracle19/.gitkeep` [0 octets]
<a id="depot_pour_oracle19--gitkeep"></a> [↩ Retour à l'arborescence](#tree-depot_pour_oracle19--gitkeep)

> **Chemin relatif** : `depot_pour_oracle19/.gitkeep`  
> **Taille** : 0 octets  
> **Lignes** : 0  
> **Type** : text

```text

```


---

### 📄 `livraison-continue-kpi.yml` [1.193 octets]
<a id="livraison-continue-kpi-yml"></a> [↩ Retour à l'arborescence](#tree-livraison-continue-kpi-yml)

> **Chemin relatif** : `livraison-continue-kpi.yml`  
> **Taille** : 1.193 octets  
> **Lignes** : 41  
> **Type** : yaml

```yaml
tools: #OPTIONNEL
  # Public
  http: true
  testssl: true
  thirdparties: true
  updownio: true
  stats: true
  budget: true
  declaration-ally: true
  declaration-rgpd: true
  
  # Privé
  404-check: false
  404-check-depth: 2
  dependency-check: true
  lighthouse: true
  sonarcloud: true
  trivy: true
  
urls:
  - title: SIJ #OBLIGATOIRE
    gitUrl: ${gitUrl} #NE PAS MODIFIER
    projectId: ${projectId} #NE PAS MODIFIER
    #url: https://sij.e2.rie.gouv.fr
    url: https://snum.gitlab-pages.din.developpement-durable.gouv.fr/pnm3/produits/support/sij
    # urlLogin: ???
    #images: alpine:3.17.3, node:latest #OPTIONNEL
    images: eu.gcr.io/dpnm3-lab/sij:latest, postgres:15.2-alpine
    demarcheId: 3886 #OK
    category: web #OPTIONNEL NON OPERATIONNEL EN DEVELOPPEMENT
    sonarId: sij #OPTIONNEL
    tags: #OPTIONNEL NON OPERATIONNEL EN DEVELOPPEMENT
      - ecologie
      - gouvernement
    pages : #OPTIONNEL NON OPERATIONNEL EN DEVELOPPEMENT
      - stats: stats 
      - budget: budget
      - mentions-legales: mentions-legales
      - declaration-rgpd: declaration-rgpd
      - declaration-accessibilite: declaration-accessibilite

```


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

````

</details>


---

### 📄 `si/sireines.wiki.md` [29.075 octets]
<a id="si-sireines-wiki-md"></a> [↩ Retour à l'arborescence](#tree-si-sireines-wiki-md)

> **Chemin relatif** : `si/sireines.wiki.md`  
> **Taille** : 29.075 octets  
> **Lignes** : 852  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (852 lignes) - Cliquer pour déplier</summary>

`````markdown
﻿# Projet : sireines.wiki

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\sireines.wiki`

**Fichiers** : 12 fichiers non-binaires

## 📁 Arborescence des fichiers

├── **Déploiement/**
│   └── <a id="tree-Déploiement-Déploiement-de-l'applicatif-(Recette,-pré-production,-production-md"></a>[Déploiement-de-l'applicatif-(Recette,-pré-production,-production.md](#Déploiement-Déploiement-de-l'applicatif-(Recette,-pré-production,-production-md) *(834 octets)*
├── **Recette/**
│   ├── <a id="tree-Recette-ConnexionBDD_Docker-md"></a>[ConnexionBDD_Docker.md](#Recette-ConnexionBDD_Docker-md) *(184 octets)*
│   └── <a id="tree-Recette-LivraisonSurPosteDocker-md"></a>[LivraisonSurPosteDocker.md](#Recette-LivraisonSurPosteDocker-md) *(6.897 octets)*
├── **Sireines/**
│   ├── <a id="tree-Sireines-Cerbère-md"></a>[Cerbère.md](#Sireines-Cerbère-md) *(180 octets)*
│   ├── <a id="tree-Sireines-Version-md"></a>[Version.md](#Sireines-Version-md) *(54 octets)*
│   └── <a id="tree-Sireines-sites-md"></a>[sites.md](#Sireines-sites-md) *(180 octets)*
├── **Technique/**
│   └── <a id="tree-Technique-DeploiementApplicatif-md"></a>[DeploiementApplicatif.md](#Technique-DeploiementApplicatif-md) *(6.108 octets)*
├── **uploads/**
│   ├── **4a4c7ef224a2ba3717463838ce45e9c2/**
│   │   └── <a id="tree-uploads-4a4c7ef224a2ba3717463838ce45e9c2-style-css"></a>[style.css](#uploads-4a4c7ef224a2ba3717463838ce45e9c2-style-css) *(315 octets)*
│   ├── **5e9d06fc5d3772761a81dfe80aae3665/**
│   │   └── <a id="tree-uploads-5e9d06fc5d3772761a81dfe80aae3665-style-css"></a>[style.css](#uploads-5e9d06fc5d3772761a81dfe80aae3665-style-css) *(315 octets)*
│   └── **bab78fd9ac05d5ca7d72d75dbdf2d963/**
│       └── <a id="tree-uploads-bab78fd9ac05d5ca7d72d75dbdf2d963-style-css"></a>[style.css](#uploads-bab78fd9ac05d5ca7d72d75dbdf2d963-style-css) *(315 octets)*
├── <a id="tree-Home-md"></a>[Home.md](#Home-md) *(3.007 octets)*
└── <a id="tree-Reversing-md"></a>[Reversing.md](#Reversing-md) *(329 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `Déploiement/Déploiement-de-l'applicatif-(Recette,-pré-production,-production.md` [834 octets]
<a id="Déploiement-Déploiement-de-l'applicatif-(Recette,-pré-production,-production-md"></a> [↩ Retour à l'arborescence](#tree-Déploiement-Déploiement-de-l'applicatif-(Recette,-pré-production,-production-md)

> **Chemin relatif** : `Déploiement/Déploiement-de-l'applicatif-(Recette,-pré-production,-production.md`  
> **Taille** : 834 octets  
> **Lignes** : 31  
> **Type** : markdown

```markdown
Déploiement :

Se connecter avec 'Bastion'

puis utiliser un alias de connexion : sireinesrec, sireinesppr ou sireinesprod

cd /opt/app

copie du docker-compose.yml avec la date (ex :  docker-compose.yml.20250523)
ex: 
cp docker-compose.yml docker-compose.yml.20250523

effectuer un docker ps pour identifier le container sireines-app

![Capture](uploads/12738ffe6934641f1c4ed401955817a3/Capture.JPG)

docker rm -f sireines-app 

vi docker-compose.yml (Pour modifier la version à livrer)

docker compose up -d 

Pour le test de la recette aller sur :

http://sireines.recette.pnm3.eco4.cloud.e2.rie.gouv.fr/Accueil.do

![Capture2](uploads/dba83529ace31f5dc3448548f1e5f1d6/Capture2.JPG)

Effectuer quelques tests fonctionnels simples :

![Capture3](uploads/e282ab2b5a5e58e429f2fcc7f673edcf/Capture3.JPG)
```


---

### 📄 `Home.md` [3.007 octets]
<a id="Home-md"></a> [↩ Retour à l'arborescence](#tree-Home-md)

> **Chemin relatif** : `Home.md`  
> **Taille** : 3.007 octets  
> **Lignes** : 68  
> **Type** : markdown

```markdown
La mission des compétences scientifiques et techniques (DRI/AST4) tient à jour une base de données dénommée SIREINES qui recense toutes les demandes de qualification par les comités de domaine de ses agents. Elle suit l'évolution de ces données, coordonne leur évaluation par les comités de domaine, et tient les agents informés des suites de leurs de leurs demandes.

Sommaire :
* [Qui fait quoi](#quifaitquoi)
* [Historique](#Historique)
* [Accès au site](#Site)
* [Cerbère](#Cerbere)
* [Version](#Version)
* [Documentations](#Doc)


<a name="quifaitquoi"></a>
## Qui fait quoi

| Intervenants | Commentaires |
|--------------|--------------|
| MOA MTES | Zemour Pascal (Chargé de mission) - CGDD/DRI/AST4 Pascal.Zemour@developpement-durable.gouv.fr =\> Chef de projet opérationnel de l'application |
|  | Letrouit Vincent (Chef de bureau) - CGDD/DRI/AST4 Vincent.Letrouit@developpement-durable.gouv.fr =\> Sponsor des projets |
| MOE prestataire | Jusqu'en novembre 2021 : Klee Group |
|  | \- Matthieu Georges (Chef de projet) matthieu.georges@kleegroup.com |
|  | \- Olivier Venot (Directeur de projet) olivier.venot@kleegroup.com |


<a name="Historique"></a>
## Historique

| Date | Références | Type d'évolution | Fichier |
|------|------------|------------------|---------|
| 26/02/2020 | Mantis 0052083 | Évolution mineure des courriers | \[[sireines_mantis_0052083.pdf](uploads/431f99b1ec1a87bc71962a80758af481/sireines_mantis_0052083.pdf)\] |
| 15/09/2020 | Mantis 0056137 | Demande de mise à jour des courriers | \[[sireines_mantis_0056137.pdf](uploads/d67a07eca5a5a248db13b6ebc71e6a0b/sireines_mantis_0056137.pdf)\] |
| 22/10/2020 | Mantis 0056773 | Correction de courriers | \[[sireines_mantis_0056773.pdf](uploads/e855689ab130403e40ada37f2c93848f/sireines_mantis_0056773.pdf)\] |
| 03/05/2021 | Mantis 0059550 | Extractions=erreur eclipse | \[[sireines_mantis_0059550.pdf](uploads/dbf64e820c7296237e5c5eafbe9dca45/sireines_mantis_0059550.pdf)\] |
| 30/09/2021 | Mantis 0061626 | Anomalie dans livraison 2.5.6 | \[[sireines_mantis_0061626.pdf](uploads/ac13ef2303459e85a76ccba84ce9da96/sireines_mantis_0061626.pdf)\] |

<a name="Site"></a>
## Accès au site

[sites](Sireines/sites)

<a name="Cerbere"></a>
## Cerbère

[cerbère](Sireines/Cerbère)

<a name="Version"></a>
## Version

[version](Sireines/Version)

<a name="Doc"></a>
## Documentations

### Guide du chef de produit :
 * [Recette d'une livraison sur poste (Docker)](Recette/LivraisonSurPosteDocker)
 * Recette d'une livraison sur environnement IAAS
 * [Connexion base de données](Recette/ConnexionBDD_Docker)

### Fonctionnel :

### Technique :
  * [Document d'installation et d'exploitation (IAAS)](Technique/DocumentationInstallationEtExploitation)
    
### Reversing
  * [Application](Reversing/App)
  * [Base de données](Reversing/Database)

### Deploiement
  * [Procedure de déploiement applicatif ](Technique/DeploiementApplicatif)
```


---

### 📄 `Recette/ConnexionBDD_Docker.md` [184 octets]
<a id="Recette-ConnexionBDD_Docker-md"></a> [↩ Retour à l'arborescence](#tree-Recette-ConnexionBDD_Docker-md)

> **Chemin relatif** : `Recette/ConnexionBDD_Docker.md`  
> **Taille** : 184 octets  
> **Lignes** : 10  
> **Type** : markdown

```markdown
Se mettre sur le serveur de recette (sireinesrec)

Lancer Run pageant 
New Session (Load Bastion)


- /opt/app
- cat .env
- docker exec -it sireines-db bash
- psql -U sireines
```


---

### 📄 `Recette/LivraisonSurPosteDocker.md` [6.897 octets]
<a id="Recette-LivraisonSurPosteDocker-md"></a> [↩ Retour à l'arborescence](#tree-Recette-LivraisonSurPosteDocker-md)

> **Chemin relatif** : `Recette/LivraisonSurPosteDocker.md`  
> **Taille** : 6.897 octets  
> **Lignes** : 199  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (199 lignes) - Cliquer pour déplier</summary>

````markdown
<a name="HautdePage"></a>
# Document d'installation sur Poste de Travail (Docker)


Sommaire :

*[Pré-requis](#prerequis)


<a name="prerequis"></a>
## 0 - Pré-requis

Avoir installé sur son poste : 
* Docker Desktop Installer.exe (application Docker Desktop) (Logo Baleine) avec wsl-updatex64.msi

* L'application Visual code avec les extensions :
    * Dev Containers
    * Docker
    * French Language Pack for Visual Studio Code (*)
    * Markdown Preview Enhanced (*)
    * WSL
* L'application Prince (*) et ajouter dans les variables d'environnement dans le path :
    C:\Program Files (x86)\Prince\engine\bin

* L'interface de base de données Pgadmin 4 v8 (minimal)

(*) Non obligatoire

[Haut de Page](#HautdePage)

## 1 - Les conteneurs et les images

### 1.1 Vocabulaire

**Un conteneur** est une unité logicielle standard qui regroupe le code et toutes ses dépendances afin que l'application s'exécute rapidement et de manière fiable d'un environnement informatique à un autre. Une image de conteneur Docker est un package logiciel léger, autonome et exécutable qui comprend tout ce dont vous avez besoin pour exécuter une application : code, runtime, outils système, bibliothèques système et paramètres.

**Les images de conteneurs**
deviennent des conteneurs au moment de l'exécution et dans le cas des conteneurs Docker, les images deviennent des conteneurs lorsqu'elles s'exécutent sur Docker Engine (logo Baleine). 

### 1.2 Cas particulier  : Application Sireines
L'application Sireines comporte  trois conteneurs, trois images et un volume.

* Le conteneur de l'applicatif s'appelle **sireines_app_usine_container** et l'image associée s'appelle **sireines_app_usine_image**.

* Le conteneur de la base de données s'appelle **sireines_db_usine_container** et l'image associée s'appelle **postgres:14.1-alpine**.

* Un conteneur a été ajouté pour garder en mémoire les connexions à la base de données. Ce conteneur s'appelle **sireines_pgadmin_container** et l'image associée s'appelle **dpage/pgadmin4**.

La base de données est contenu dans un seul volume appelé : **sireines_db_sireines_vol**.
Les connexions sont sauvegardées dans le volume appelé : **sireines_pgadmin_sireines_vol**.

## 2 - Aller chercher le war dans gitlab

### 2.1 Les liens Gitlab

* **Lien Gitlab**

https://gitlab-forge.din.developpement-durable.gouv.fr/

* **Lien Gitlab du projet Sireines**

https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/produits/rh/sireines

* **Emplacement du war dans Gitlab**

deploy / package registry 

(https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/produits/rh/sireines/-/packages) puis cliquer sur le lien pour télécharger le war  (sireines-web-*.war).

### 2.2 Télécharger le fichier *.war et le déposer dans le répertoire de travail de votre poste

c:/sireines/sireines_pgadmin (Répertoire de travail)

### 2.3 Annotation

A noter que dans le fichier Dockerfile, la ligne 
    **COPY --chown=root:root sireines-web-*.war /tmp/ROOT.war**
permet de prendre tous les war commençant par **"sireines-web-"** et se terminant par **".war"**.

Lors d'une nouvelle livraison d'un war, il suffit de substituer l'ancien war par le nouveau war dans le répertoire de travail.

Dans ce cas précis, il n'y aura rien d'autre à changer et le fichier Dockerfile peut rester en l'état.

Toutes les sources se trouvent dans le répertoire partagé du service :

[M:\Produits numériques\Ressources humaines\Sireines\Docker\Archives](M:\Produits numériques\Ressources humaines\Sireines\Docker\Archives)
M: correspond au Dossier partagé [DPNM3]

On y trouvera les war et les dump de l'application.

<div style="page-break-after: always; visibility: hidden">\pagebreak</div>

## 3 - Installation de l'applicatif 

### 3.1 Prérequis
* Avoir récupérer le répertoire **[M:\Produits numériques\Ressources humaines\Sireines\Docker\sireines_pgadmin]**(M:\Produits numériques\Ressources humaines\Sireines\Docker\sireines_pgadmin)
M: correspond au Dossier partagé [DPNM3]
et le déposer sur le poste de travail **c:/sireines/sireines_pgadmin**

* Lancer l'application Docker Desktop (Logo Baleine) et s'assurer que les moteurs sont bien en exécution (Running)
![alt text](img/dockerDesktop.png)

### 3.2 Vérification de l'existence des volumes (Visual studio Code)

Se positionner dans le terminal du Visual Code dans le répertoire de travail:
![alt text](img/repertoire.PNG)

* Si le volume sireines_db_sireines_vol n'est pas n'existe pas faire :
    docker volume create sireines_db_sireines_vol
    
    ![alt text](images/creation_volume.png)


    et modifier **si besoin** les lignes 38 et 74 de docker-compose.yml concernant ce volume.
![alt text](<images/Volume Sireines pgadmin lignes 38_74.JPG>)


    Ce volume contiendra les données de la base de données.

* Si le volume sireines_pgadmin_sireines_vol n'existe pas faire :
docker volume create sireines_pgadmin_sireines_vol 

et modifier **si besoin** les lignes 66 et 76 de de docker-compose.yml concernant ce volume.
![alt text](<images/Volume Sreines pgadmin lignes 66-76.JPG>)


Au final, on devrait avoir :

![alt text](images/Volume.PNG)

Ces volumes sont persistants sur le poste de travail.

### 3.3 Si besoin supprimer l'applicatif

Remove sur le conteneur (sireines_app_usine_container) puis l'image(sireines_app_usine_image).

Dans l'application Visual code :
![alt text](images/remove_conteneur.PNG)
![alt text](images/remove_image.PNG)

**Ou** dans Docker Desktop :
![alt text](images/delete_docker.PNG)

**Ou** en ligne de commande Dos (cmd)
```docker rm -f sireines_app_usine_container```
```docker rmi -f sireines_app_usine_image```


### 3.4 Créer et démarrer tous les services 
 
**Lancer sans le VPN :** 
```docker-compose up -d```

  dans le répertoire c:/sireines/sireines_pgadmin

<div style="page-break-after: always; visibility: hidden">\pagebreak</div>

## 4 - Installation de la base de données

### 4.1 Prérequis
Vérifier dans le fichier .env, les arguments de la bdd du Docker
            POSTGRES_DB=postgres
            POSTGRES_HOST=db
            POSTGRES_PORT=5432
            POSTGRES_USER=postgres
            POSTGRES_PASSWORD=postgres
            POSTGRES_SCHEMA=postgres

### 4.2  Installation de la BDD avec pgAdmin et/ou ligne de commande :

1 - Add Server 
Renseigner Onglet General : Name XXXXX ;
Renseigner Onglet Connection :
    Host : localhost
    Port : 8888
    Maintenance Database :
    UserName :
    MotdePasse : 



2- Alimentation de la base via un dump






<div style="page-break-after: always; visibility: hidden">\pagebreak</div>
# Annexe(s) 

## Ouvrir un terminal dans l'application Visual code 

**Choisir "Command prompt" à la place de powershell (par défaut)**


![alt text](images/prompt_cmd.PNG)

Vous pourrez alors utiliser les commandes dos non reconnues par powershell
````

</details>


---

### 📄 `Reversing.md` [329 octets]
<a id="Reversing-md"></a> [↩ Retour à l'arborescence](#tree-Reversing-md)

> **Chemin relatif** : `Reversing.md`  
> **Taille** : 329 octets  
> **Lignes** : 6  
> **Type** : markdown

```markdown
# Documentation WarchoDevplace

Vous pouvez télécharger le fichier ZIP contenant tous les documents ici :  
[Télécharger documents.zip](https://gitlab.eco4.cloud.e2.rie.gouv.fr/snum/pnm3/produits/rh/ttc/-/raw/documentation/documentation.zip)

Une fois téléchargé, décompressez le fichier pour accéder aux documents.
```


---

### 📄 `Sireines/Cerbère.md` [180 octets]
<a id="Sireines-Cerbère-md"></a> [↩ Retour à l'arborescence](#tree-Sireines-Cerbère-md)

> **Chemin relatif** : `Sireines/Cerbère.md`  
> **Taille** : 180 octets  
> **Lignes** : 9  
> **Type** : markdown

```markdown
|Cerbère|Pré-production|Production|Recette|
| --- | --- | --- | --- |
|ID|546|546|564|

**Gestion de cerbere recette :**

https://cerbere.recette.e2.rie.gouv.fr/administration/


```


---

### 📄 `Sireines/sites.md` [180 octets]
<a id="Sireines-sites-md"></a> [↩ Retour à l'arborescence](#tree-Sireines-sites-md)

> **Chemin relatif** : `Sireines/sites.md`  
> **Taille** : 180 octets  
> **Lignes** : 5  
> **Type** : markdown

```markdown
Recette : http://sireines.recette.pnm3.eco4.cloud.e2.rie.gouv.fr/

Pré prod : https://sireines.preprod.e2.rie.gouv.fr/Accueil.do

prod : https://sireines.e2.rie.gouv.fr/Accueil.do
```


---

### 📄 `Sireines/Version.md` [54 octets]
<a id="Sireines-Version-md"></a> [↩ Retour à l'arborescence](#tree-Sireines-Version-md)

> **Chemin relatif** : `Sireines/Version.md`  
> **Taille** : 54 octets  
> **Lignes** : 1  
> **Type** : markdown

```markdown
Version en cours en production (12 mars 2024) : 2.5.11
```


---

### 📄 `Technique/DeploiementApplicatif.md` [6.108 octets]
<a id="Technique-DeploiementApplicatif-md"></a> [↩ Retour à l'arborescence](#tree-Technique-DeploiementApplicatif-md)

> **Chemin relatif** : `Technique/DeploiementApplicatif.md`  
> **Taille** : 6.108 octets  
> **Lignes** : 117  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (117 lignes) - Cliquer pour déplier</summary>

````markdown
---
css: ./style.css
---

# Procédure de déploiement de l'applicatif {.chapter}


- ## Deploiement applicatif

- ## Activer le VPN

- ## Activer Pageant

   - ### Lancer le bastion sur Pageant
          ssh debian@10.165.134.248

   - ### Connexion sur la bastion PNM3
       pour faire, faire ceci

       et aussi cela 

   - ### Modification du fichier docker compose avec la nouvelle version
   ```bash
     cd /opt/app
 docker ps                                            1 ↵
CONTAINER ID   IMAGE                                        COMMAND                  CREATED        STATUS       PORTS                                NAMES
c5a9345c57ef   eu.gcr.io/dpnm3-lab/sireines:2.5.14-LIVREE   "/scripts/entrypoint…"   2 months ago   Up 8 weeks   0.0.0.0:8080->8080/tcp               sireines-app
a85ba5be0b3d   postgres:15.6-alpine                         "docker-entrypoint.s…"   2 months ago   Up 8 weeks   0.0.0.0:5432->5432/tcp               sireines-db
b63a78dfbf9e   grafana/promtail:latest                      "/usr/bin/promtail -…"   5 months ago   Up 8 weeks   19080/tcp, 0.0.0.0:19080->9080/tcp   metrics-promtail
1c77901f8edf   prom/pushgateway                             "/bin/pushgateway"       5 months ago   Up 8 weeks   19091/tcp, 0.0.0.0:19091->9091/tcp   metrics-push
160ff64fdf50   prom/node-exporter:latest                    "/bin/node_exporter …"   5 months ago   Up 8 weeks   19100/tcp, 0.0.0.0:19100->9100/tcp   metrics-node
36346c5416b9   cmosley/docker_exporter                      "./docker_exporter"      5 months ago   Up 8 weeks   19417/tcp, 0.0.0.0:19417->9417/tcp   metrics-docker

- constater que sireines-app et sireines-db s'executent



     cp docker-compose.yml docker-compose.yml.20241212
     vi docker-compose.yml


```

- ## Arreter le conteneur applicatif
docker stop sireines-app                           
sireines-app

- ## Supprimer le conteneur applicatif
docker rm sireines-app                            
sireines-app


- ## Relancer le docker-compose qui a pour effet de relancer l'application
/opt/app » docker compose up -d                               127 ↵
[+] Running 16/16
 ✔ app Pulled                                                                           32.7s
   ✔ bd8f6a7501cc Already exists                                                         0.0s
   ✔ 44718e6d535d Already exists                                                         0.0s
   ✔ efe9738af0cb Already exists                                                         0.0s
   ✔ f37aabde37b8 Already exists                                                         0.0s
   ✔ b87fc504233c Already exists                                                         0.0s
   ✔ cc62143cb8cc Already exists                                                         0.0s
   ✔ 646a47c88e43 Already exists                                                         0.0s
   ✔ d65bec3def24 Already exists                                                         0.0s
   ✔ 9b7471aadf4c Already exists                                                         0.0s
   ✔ cb4999122126 Already exists                                                         0.0s
   ✔ 537eff314fa1 Pull complete                                                         19.4s
   ✔ 8b1693a28ca0 Pull complete                                                         19.8s
   ✔ c58195575909 Pull complete                                                         21.2s
   ✔ faa83b01ce1b Pull complete                                                         21.3s
   ✔ 4198d8a165e6 Pull complete                                                         21.4s
[+] Running 2/2
 ✔ Container sireines-db   Running                                                       0.0s
 ✔ Container sireines-app  Started   
     
- ## Verifier que les conteneurs sont actifs

 docker ps                                          126 ↵
CONTAINER ID   IMAGE                                        COMMAND                  CREATED          STATUS          PORTS                                NAMES
41e614549398   eu.gcr.io/dpnm3-lab/sireines:2.5.16-LIVREE   "/scripts/entrypoint…"   43 seconds ago   Up 42 seconds   0.0.0.0:8080->8080/tcp               sireines-app
a85ba5be0b3d   postgres:15.6-alpine                         "docker-entrypoint.s…"   2 months ago     Up 8 weeks      0.0.0.0:5432->5432/tcp               sireines-db
b63a78dfbf9e   grafana/promtail:latest                      "/usr/bin/promtail -…"   5 months ago     Up 8 weeks      19080/tcp, 0.0.0.0:19080->9080/tcp   metrics-promtail
1c77901f8edf   prom/pushgateway                             "/bin/pushgateway"       5 months ago     Up 8 weeks      19091/tcp, 0.0.0.0:19091->9091/tcp   metrics-push
160ff64fdf50   prom/node-exporter:latest                    "/bin/node_exporter …"   5 months ago     Up 8 weeks      19100/tcp, 0.0.0.0:19100->9100/tcp   metrics-node
36346c5416b9   cmosley/docker_exporter                      "./docker_exporter"      5 months ago     Up 8 weeks      19417/tcp, 0.0.0.0:19417->9417/tcp   metrics-docker
```

- ## Quitter les connexions bastion

- ## Vérifier que l'application est fonctionnelle sur le réseau du ministère

   - ### Recette :
         http://sireines.recette.pnm3.eco4.cloud.e2.rie.gouv.fr/

   - ### Pré prod :
         https://sireines.preprod.e2.rie.gouv.fr/Accueil.do

   - ### prod :
         https://sireines.e2.rie.gouv.fr/Accueil.do

- ## Effectuer les tests fonctionnels élémentaires

   - ### Courriers

   - ### Statistiques


- ## Avertir la maitrise d'ouvrage
 ```text
     Une fois la recette validée pour :
      - le constat de l'affichage de la nouvelle version
      - les tests fonctionnels propres aux évolutions
      - les tests élémentaires de base, 
     le deploiement de la prod peut intervenir. 
     Une fois la preprod validée par la maitrise d'ouvrage, le deploiement de la prod peut intervenir 
 ```
 
````

</details>


---

### 📄 `uploads/4a4c7ef224a2ba3717463838ce45e9c2/style.css` [315 octets]
<a id="uploads-4a4c7ef224a2ba3717463838ce45e9c2-style-css"></a> [↩ Retour à l'arborescence](#tree-uploads-4a4c7ef224a2ba3717463838ce45e9c2-style-css)

> **Chemin relatif** : `uploads/4a4c7ef224a2ba3717463838ce45e9c2/style.css`  
> **Taille** : 315 octets  
> **Lignes** : 18  
> **Type** : css

```css
<style>
.chapter {
    font-size: 24px;
    color: #2c3e50;
    border-bottom: 2px solid #3498db;
    padding-bottom: 10px;
    margin-top: 30px;
}

.subchapter {
    font-size: 20px;
    color: #34495e;
    margin-left: 20px;
    padding-left: 10px;
    border-left: 3px solid #2ecc71;
}
</style>

```


---

### 📄 `uploads/5e9d06fc5d3772761a81dfe80aae3665/style.css` [315 octets]
<a id="uploads-5e9d06fc5d3772761a81dfe80aae3665-style-css"></a> [↩ Retour à l'arborescence](#tree-uploads-5e9d06fc5d3772761a81dfe80aae3665-style-css)

> **Chemin relatif** : `uploads/5e9d06fc5d3772761a81dfe80aae3665/style.css`  
> **Taille** : 315 octets  
> **Lignes** : 18  
> **Type** : css

```css
<style>
.chapter {
    font-size: 24px;
    color: #2c3e50;
    border-bottom: 2px solid #3498db;
    padding-bottom: 10px;
    margin-top: 30px;
}

.subchapter {
    font-size: 20px;
    color: #34495e;
    margin-left: 20px;
    padding-left: 10px;
    border-left: 3px solid #2ecc71;
}
</style>

```


---

### 📄 `uploads/bab78fd9ac05d5ca7d72d75dbdf2d963/style.css` [315 octets]
<a id="uploads-bab78fd9ac05d5ca7d72d75dbdf2d963-style-css"></a> [↩ Retour à l'arborescence](#tree-uploads-bab78fd9ac05d5ca7d72d75dbdf2d963-style-css)

> **Chemin relatif** : `uploads/bab78fd9ac05d5ca7d72d75dbdf2d963/style.css`  
> **Taille** : 315 octets  
> **Lignes** : 18  
> **Type** : css

```css
<style>
.chapter {
    font-size: 24px;
    color: #2c3e50;
    border-bottom: 2px solid #3498db;
    padding-bottom: 10px;
    margin-top: 30px;
}

.subchapter {
    font-size: 20px;
    color: #34495e;
    margin-left: 20px;
    padding-left: 10px;
    border-left: 3px solid #2ecc71;
}
</style>

```


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

`````

</details>


---

### 📄 `si/sireines_analyse.md` [14.597 octets]
<a id="si-sireines_analyse-md"></a> [↩ Retour à l'arborescence](#tree-si-sireines_analyse-md)

> **Chemin relatif** : `si/sireines_analyse.md`  
> **Taille** : 14.597 octets  
> **Lignes** : 510  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (510 lignes) - Cliquer pour déplier</summary>

````markdown
Absolument  voici une **analyse complète, structurée et autoportée** de lapplication *SIREINES*, **strictement déduite** des fichiers fournis dans `sireines.md`.  
Ce document est au format **Markdown**, contient de nombreux **diagrammes PlantUML** (cas dusage, classes, séquence, états, composants, déploiement, dépendances, swimplanes), et distingue clairement les **aspects fonctionnels** et **techniques**, **sans supposition externe**.

> ? Ce document peut être rendu directement dans **VS Code** (extension *Markdown Preview Enhanced* + *PlantUML*), **Obsidian** (plugin *Excalidraw* ou *PlantUML*), ou tout outil supportant `mermaid`/`plantuml`.

---

# ?? Analyse complète de **SIREINES**  
*Plateforme métier de gestion de dossiers de qualification professionnelle*

---

## ?? Sommaire

1. [Vue densemble](#-vue-densemble)  
2. [Partie fonctionnelle](#-partie-fonctionnelle)  
   - 2.1 [Acteurs](#-acteurs)  
   - 2.2 [Cas dutilisation](#-cas-dutilisation)  
   - 2.3 [Règles métier](#-règles-métier)  
   - 2.4 [Workflows principaux](#-workflows-principaux)  
3. [Partie technique](#-partie-technique)  
   - 3.1 [Architecture globale](#-architecture-globale)  
   - 3.2 [Modules & dépendances](#-modules--dépendances)  
   - 3.3 [Sécurité](#-sécurité)  
   - 3.4 [Dette technique](#-dette-technique)  
4. [Annexes](#-annexes)  
   - 4.1 [Glossaire des entités](#-glossaire-des-entités)  
   - 4.2 [Schéma relationnel (extrait)](#-schéma-relationnel-extrait)

---

## ?? Vue densemble

### Objectif métier
SIREINES est une **plateforme de suivi de dossiers de qualification professionnelle**, notamment pour des agents (chercheurs, experts), avec :
- Saisie et gestion de **dossiers**,
- Attribution à des **rapporteurs**,
- Édition de **fiches de conclusion** et **remarques**,
- Production de **rapports statistiques** (ex. effectifs par structure, qualification, comité).

### Technologies majeures identifiées
- Backend : **Java**, **Struts**, **Vert.x Dynamo**
- Persistance : **JPA / Hibernate**, **PostgreSQL**
- Reporting : **Eclipse BIRT**, **Talend Reports**
- Build/Deploiement : **Maven**, **Docker**
- Frontend : **JSP**, **FreeMarker (`.ftl`)**, jQuery

---

## ????? Partie fonctionnelle

### ?? Acteurs

| Acteur | Description | Sources |
|--------|-------------|---------|
| **Agent** | Personne qualifiée (matricule, nom/prénom, corps/grade) | `agent_matricule`, `nom`, `prenom`, `corps_grade` |
| **Rapporteur** | Évalue le dossier (principal / secondaire) | `rapporteur`, `rapporteur_2`, `rapporteur_mail` |
| **Gestionnaire** | Suit le dossier (affectation, suivi_modif) | `gestionnaire`, `ges_id` |
| **Formateur** (booléen) | Indique si lagent est formateur | `formateur` (`si_formateur`) |
| **Administrateur référentiel** | Gère les référentiels : comités, macro-structures, mots-clés | `ComiteDomaineDetail.jsp`, `macroStructureRecherche.jsp`, `motCleNiveauDetail.jsp` |

```plantuml
@startuml
actor "Agent" as AGENT
actor "Rapporteur" as RAPP
actor "Gestionnaire" as GEST
actor "Administrateur\nréférentiel" as ADMIN

note right of AGENT
  - matricule
  - nom/prénom
  - corps/grade
  - mail_agent
end note

note right of RAPP
  - rapporteur / rapporteur_2
  - date_envoi_rapp
  - rapport_evaluateur_recu (bool)
end note

note right of GEST
  - suivi_modif
  - gestionnaire
end note

ADMIN --> GEST : peut être aussi
@enduml
```

---

### ?? Cas dutilisation

```plantuml
@startuml
left to right direction
actor Agent
actor Rapporteur
actor Gestionnaire
actor AdminRef as "Administrateur\nréférentiel"

rectangle "SIREINES" {
  Agent --> (Saisir dossier)
  Rapporteur --> (Évaluer dossier)
  Gestionnaire --> (Suivre dossier)
  AdminRef --> (Gérer référentiels)

  (Saisir dossier) --> (Soumettre dossier)
  (Soumettre dossier) --> (Attribuer rapporteurs)
  (Attribuer rapporteurs) --> (Évaluer dossier)
  (Évaluer dossier) --> (Rédiger fiche conclusion)
  (Rédiger fiche conclusion) --> (Valider qualification)

  (Gérer référentiels) .> (Saisir dossier) : <<include>>
  (Gérer référentiels) .> (Évaluer dossier) : <<include>>
}
@enduml
```

**Cas dusage clés (fichiers sources)** :
- `dossierFicheConclusion.jsp` ? Rédaction de la fiche de conclusion
- `02_qualifications_valides_par_services.rptdesign` ? Extraction par service
- `07b_population_qualifiee_macro_structure.rptdesign` ? Stats par macro-structure
- `motCleNiveauRecherche.jsp` ? Gestion des mots-clés thématiques

---

### ?? Règles métier

#### 1. **Structure hiérarchique obligatoire**
Chaque dossier est rattaché à :
- une `macro_structure` (**NOT NULL**, `design:nullability>NotNullable`)  
- une `structure` (**NULLABLE** ? `structure_hybride` possible ?)
- un `service_affectation` (**NULLABLE**)

? La macro-structure est **obligatoire**, les niveaux inférieurs sont optionnels.

#### 2. **Mots-clés**
- Jusquà **5 mots-clés thématiques** (`mot_cle_1` à `mot_cle_5`)
- + `mot_cle_sup` (supplémentaire, 80 caractères max)
- + `mot_cle_hors_thesaurus` (libre)
? Tous en `dimension`, pas de mesure ? **catégorisation pure**

#### 3. **Fiches de conclusion**
4 types stockés dans des colonnes distinctes :
| Colonne | Alias | Type |
|---------|-------|------|
| `fic_avis.contenu` | `fiche_conclusion_avis_evolution` | avis sur évolution |
| `fic_cproj.contenu` | `fiche_conclusion_conseil_parcours_professionnel` | conseil parcours |
| `fic_pind.contenu` | `fiche_conclusion_conseil_formation` | conseil formation |
| `fic_ccl.contenu` | `fiche_conclusion_commentaires` | commentaires libres |

? Tous de type `dimension`, `precision=4500` ? texte long.

#### 4. **Qualification & critères**
- `annee_qualif` : `measure`, `integer` ? **année de qualification**
- `si_comp_crit` : `measure`, `integer` ? **compétence critique ?**
- `si_formateur`, `si_trav_signif` : booléens (`-7` = `BOOLEAN` en JDBC)

```plantuml
@startuml
skinparam classAttributeIconSize 0

class Dossier {
  + dos_id
  + annee_qualif: int {measure}
  + si_comp_crit: bool {measure}
  + si_formateur: bool
  + si_trav_signif: bool
}

class FicheConclusion {
  + fic_id_avis
  + fic_id_cproj
  + fic_id_pind
  + fic_id_ccl
}

class MotCle {
  + mot_cle_1..5: string {dimension}
  + mot_cle_sup: string(80)
  + mot_cle_hors_thesaurus: string
}

Dossier *-- FicheConclusion
Dossier *-- MotCle

note right of Dossier::annee_qualif
  SELECT DISTINCT annee_qualif
  FROM dossier
  ? utilisé dans les rapports
end note
@enduml
```

---

### ?? Workflows principaux

#### Workflow : Cycle de vie dun dossier

```plantuml
@startuml
title Cycle de vie dun dossier

state "Création" as C
state "En attente\nrapporteurs" as A1
state "En cours\nd'évaluation" as E
state "En attente\nconclusion" as A2
state "Clôturé" as F

[*] --> C
C --> A1 : soumis
A1 --> E : rapporteurs attribués\n(date_envoi_pres/rapp)
E --> A2 : rapports reçus\n(rapport_evaluateur_recu = true)
A2 --> F : fiche conclusion validée

note right of E
  - Remarques (`remarques`)
  - Travaux significatifs (bool)
  - Formateur (bool)
end note
@enduml
```

#### Workflow : Extraction de données (BIRT/Talend)

```plantuml
@startuml
title Extraction BIRT via Report.java

participant "Controller" as CTRL
participant "Report.java" as RPT
participant "BIRT Engine" as BIRT
participant "Base de données" as DB

CTRL -> RPT : doExecute(modelFile, params)
RPT -> BIRT : openReportDesign()
RPT -> BIRT : createRunAndRenderTask()
RPT -> BIRT : task.setParameterValues(publisherData)
BIRT -> DB : exécute queryText (ex. SELECT ... FROM macro_structure)
DB --> BIRT : resultSet
BIRT --> RPT : génération PDF/Excel
RPT --> CTRL : File retourné
@enduml
```

? Ex. de requête extraite :
```sql
SELECT 
  mst_id, libelle
FROM macro_structure
```

---

## ?? Partie technique

### ??? Architecture globale (composants)

```plantuml
@startuml
package "Frontend" {
  [JSP/FreeMarker] as FRONT
  [jQuery] as JS
}

package "Backend" {
  [Struts Actions] as ACTIONS
  [Services\n(DossiersServices,\nReferentielsServices)] as SRV
  [DAO\n(DossierDAO,\nMacroStructureDAO)] as DAO
}

package "BIRT Reporting" {
  [Report.java] as BIRT_CTRL
  [*.rptdesign] as TEMPLATES
}

package "Persistance" {
  [PostgreSQL] as DB
  [JPA/Hibernate] as ORM
}

package "Build & Deploiement" {
  [Maven] as MVN
  [Docker] as DOCKER
}

FRONT --> ACTIONS
ACTIONS --> SRV
SRV --> DAO
DAO --> ORM
ORM --> DB

FRONT --> BIRT_CTRL : export rapport
BIRT_CTRL --> TEMPLATES
BIRT_CTRL --> DB : requêtes natives

MVN --> DAO : compile
MVN --> TEMPLATES : package
MVN --> DOCKER : build image
@enduml
```

---

### ?? Modules & dépendances (via `pom.xml` fragments)

Arborescence Maven :
```
sireines/
+-- sireines-database/
+-- sireines-deployment/
+-- sireines-doc/
+-- sireines-docker/
+-- sireines-talend/    ? reporting BIRT/Talend
+-- sireines-web/       ? cur applicatif (Struts + JPA)
```

#### Dépendances critiques (extraites)
- **BIRT Runtime** : utilisé via `Report.java`
  ```java
  import org.eclipse.birt.report.engine.api.*;
  birtEngine.openReportDesign(...);
  ```
- **Vert.x Dynamo** : gestion de collections/filtres
  ```java
  import io.vertigo.dynamo.collections.ListFilter;
  ```
- **Talend Reports** : fichiers `.rptdesign` ? pas de code Java, uniquement modèles

#### Couplage observé
- `sireines-web` dépend de `sireines-talend` (rapports inclus dans WAR)
- `sireines-talend` nécessite phase `initialize` pour résoudre dépendances (daprès `README.md` de `sireines-talend`)

? **Risque** : livraison bloquée si rapport non compilable.

---

### ?? Sécurité

#### Authentification
- Fichier `sireines-auth-config.xml` ? configuration authentifiée
- Présence de `cerbere-bouchon.xml` dans `sireines-docker/` ? **mode bouchon** pour dev
- Extrait de `cerbere-bouchon.xml` :
  ```xml
  <entite nom="KLEE"><entite nom="DIM"><entite nom="PASCAL" estUnService="1">
  ```

? **Cerbere** (SSO interne) utilisé en production, bouchonné en dev.

#### Données sensibles
- `agent_mail`, `rapporteur_mail` ? présents dans exports
- `remarques` (2000 caractères max) ? texte libre potentiellement sensible

? Aucun chiffrement visible en base.

---

### ?? Dette technique

| Type | Indice | Localisation |
|------|--------|--------------|
| **Techno obsolète** | Struts 2 (XML de config volumineux), JSP | `struts.xml` (17.766 octets), `*.jsp` |
| **Duplication** | `02_qualifications_valides_par_services.rptdesign` vs `CPII_ACAI_02` ? même nom, contenu différent | `sireines-talend/reports/` |
| **Config fragile** | Chemins de fichiers en dur dans `Report.java` (`modelFile.getAbsolutePath()`) | `Report.java` (2.081 octets) |
| **Absence de tests** | Aucun répertoire `test/` mentionné | Arborescence complète |
| **FreeMarker non uniforme** | `xhtml/`, `simple/`, `simple_read/`, `jquery/` ? 4 variantes | `template/` |

```plantuml
@startuml
title Dette technique (swimlanes)

|Équipe Dev|
Swimlane Dev {
  [Struts XML] --> [Maintenance lourde]
  [JSP + FreeMarker mélangés] --> [Risque de régression]
}

|Équipe Ops|
Swimlane Ops {
  [BIRT + Talend] --> [Compil. manuelle?]
  [Docker pgdata/appdata] --> [Persistance non versionnée]
}

|Métier|
Swimlane Métier {
  [Rapports copiés] --> [Drift fonctionnel]
  [Pas de tests] --> [Peur de livrer]
}
@enduml
```

---

## ?? Annexes

### ?? Glossaire des entités (extrait)

| Entité | Clé | Attributs principaux |
|--------|-----|----------------------|
| `Dossier` | `dos_id` | `annee_qualif`, `si_formateur`, `suivi_modif`, `date_recep_dossier` |
| `Rapporteur` | `rap_id` | `nom`, `prenom`, `mail` |
| `MacroStructure` | `mst_id` | `libelle` (250), **NOT NULL** |
| `Structure` | `str_id` | `libelle`, `mst_id` (FK) |
| `Remarques` | `dos_id` (FK) | `contenu` (2000) |
| `FicheConclusion` | `fic_id` | `contenu` (4500) × 4 types |

? Relations via `LEFT JOIN` dans requêtes (ex. `04_extraction_totale.rptdesign`).

---

### ??? Schéma relationnel (extrait, PlantUML)

```plantuml
@startuml
entity "dossier" as DOS {
  * dos_id
  --
  annee_qualif
  si_formateur
  si_trav_signif
  suivi_modif
  date_recep_dossier
  rap_id_principal
  rap_id_secondaire
  ges_id
  str_id
}

entity "rapporteur" as RAP {
  * rap_id
  --
  nom
  prenom
  mail
}

entity "gestionnaire" as GES {
  * ges_id
  --
  nom
  prenom
}

entity "structure" as STR {
  * str_id
  --
  libelle
  mst_id
}

entity "macro_structure" as MST {
  * mst_id
  --
  libelle <<PK>>
}

entity "remarques" as REM {
  * dos_id <<FK>>
  --
  contenu
}

entity "fiche_conclusion" as FIC {
  * fic_id
  --
  contenu
}

DOS }--o{ RAP : "rapporteur principal\n(rap_id_principal)"
DOS }--o{ RAP : "rapporteur secondaire\n(rap_id_secondaire)"
DOS }--|| GES
DOS ||--o{ STR
STR ||--|| MST
DOS ||--o{ REM
DOS }o--|| FIC : "fic_id_avis"
DOS }o--|| FIC : "fic_id_cproj"
DOS }o--|| FIC : "fic_id_pind"
DOS }o--|| FIC : "fic_id_ccl"

note right of MST::libelle
  NOT NULL
  precision = 250
end note
@enduml
```

---

## ? Conclusion

SIREINES est une application **métier mature**, centrée sur la **gestion documentaire de dossiers de qualification**, avec un **noyau fonctionnel stable** (dossiers ? rapporteurs ? fiches ? stats), mais une **base technique vieillissante** (Struts, JSP, BIRT) et une **dette structurelle** (rapports non versionnés, absence de tests).

?? **Recommandations** (hors scope, mais déductibles) :
1. **Extraire les rapports** en microservice dédié (ex. Spring Boot + JasperReports).
2. **Migrer le front** vers un SPA moderne (React/Vue) + API REST.
3. **Automatiser les tests** (Arquillian ou TestContainers pour BIRT).
4. **Centraliser les mots-clés** dans une table `mot_cle(dos_id, niveau, libelle)` au lieu de colonnes fixes.

---

> ?? Ce document est **autoporté** : copiez-collez-le dans un `.md`, installez lextension PlantUML, et il se rend immédiatement.  
> ?? Hervé, si vous souhaitez une version **PDF dédiée**, un **focus sur un module** (ex. BIRT), ou une **proposition de modernisation**, je peux générer cela immédiatement.

Souhaitez-vous que je produise aussi :
- Un **diagramme de déploiement Docker** ?
- Une **cartographie des points de maintenance critique** ?
- Une **spécification dAPI REST** pour décarboner le front ?
````

</details>


---

### 📄 `si/sireines_wiki.md` [55.677 octets]
<a id="si-sireines_wiki-md"></a> [↩ Retour à l'arborescence](#tree-si-sireines_wiki-md)

> **Chemin relatif** : `si/sireines_wiki.md`  
> **Taille** : 55.677 octets  
> **Lignes** : 1441  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (1441 lignes) - Cliquer pour déplier</summary>

`````markdown
﻿# Projet : sireines_wiki

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\sireines_wiki`

**Fichiers** : 14 fichiers non-binaires

## 📁 Arborescence des fichiers

├── <a id="tree-AccesAuSite-md"></a>[AccesAuSite.md](#AccesAuSite-md) *(3.007 octets)*
├── <a id="tree-Cerbere-md"></a>[Cerbere.md](#Cerbere-md) *(3.007 octets)*
├── <a id="tree-Delpoiement-md"></a>[Delpoiement.md](#Delpoiement-md) *(3.007 octets)*
├── <a id="tree-DeploiementApplicatif-md"></a>[DeploiementApplicatif.md](#DeploiementApplicatif-md) *(6.082 octets)*
├── <a id="tree-Documentation-md"></a>[Documentation.md](#Documentation-md) *(3.007 octets)*
├── <a id="tree-Fonctionnel-md"></a>[Fonctionnel.md](#Fonctionnel-md) *(3.007 octets)*
├── <a id="tree-GuideDuChefDeProduit-md"></a>[GuideDuChefDeProduit.md](#GuideDuChefDeProduit-md) *(3.007 octets)*
├── <a id="tree-Historique-md"></a>[Historique.md](#Historique-md) *(3.007 octets)*
├── <a id="tree-LivraisonSurPosteDocker-md"></a>[LivraisonSurPosteDocker.md](#LivraisonSurPosteDocker-md) *(7.095 octets)*
├── <a id="tree-QuiFaitQuoi-md"></a>[QuiFaitQuoi.md](#QuiFaitQuoi-md) *(2.980 octets)*
├── <a id="tree-Reversing-md"></a>[Reversing.md](#Reversing-md) *(3.007 octets)*
├── <a id="tree-Sites-md"></a>[Sites.md](#Sites-md) *(184 octets)*
├── <a id="tree-Technique-md"></a>[Technique.md](#Technique-md) *(3.007 octets)*
└── <a id="tree-Versions-md"></a>[Versions.md](#Versions-md) *(3.007 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `AccesAuSite.md` [3.007 octets]
<a id="AccesAuSite-md"></a> [↩ Retour à l'arborescence](#tree-AccesAuSite-md)

> **Chemin relatif** : `AccesAuSite.md`  
> **Taille** : 3.007 octets  
> **Lignes** : 68  
> **Type** : markdown

```markdown
La mission des compétences scientifiques et techniques (DRI/AST4) tient à jour une base de données dénommée SIREINES qui recense toutes les demandes de qualification par les comités de domaine de ses agents. Elle suit l'évolution de ces données, coordonne leur évaluation par les comités de domaine, et tient les agents informés des suites de leurs de leurs demandes.

Sommaire :
* [Qui fait quoi](#quifaitquoi)
* [Historique](#Historique)
* [Accès au site](#Site)
* [Cerbère](#Cerbere)
* [Version](#Version)
* [Documentations](#Doc)


<a name="quifaitquoi"></a>
## Qui fait quoi

| Intervenants | Commentaires |
|--------------|--------------|
| MOA MTES | Zemour Pascal (Chargé de mission) - CGDD/DRI/AST4 Pascal.Zemour@developpement-durable.gouv.fr =\> Chef de projet opérationnel de l'application |
|  | Letrouit Vincent (Chef de bureau) - CGDD/DRI/AST4 Vincent.Letrouit@developpement-durable.gouv.fr =\> Sponsor des projets |
| MOE prestataire | Jusqu'en novembre 2021 : Klee Group |
|  | \- Matthieu Georges (Chef de projet) matthieu.georges@kleegroup.com |
|  | \- Olivier Venot (Directeur de projet) olivier.venot@kleegroup.com |


<a name="Historique"></a>
## Historique

| Date | Références | Type d'évolution | Fichier |
|------|------------|------------------|---------|
| 26/02/2020 | Mantis 0052083 | Évolution mineure des courriers | \[[sireines_mantis_0052083.pdf](uploads/431f99b1ec1a87bc71962a80758af481/sireines_mantis_0052083.pdf)\] |
| 15/09/2020 | Mantis 0056137 | Demande de mise à jour des courriers | \[[sireines_mantis_0056137.pdf](uploads/d67a07eca5a5a248db13b6ebc71e6a0b/sireines_mantis_0056137.pdf)\] |
| 22/10/2020 | Mantis 0056773 | Correction de courriers | \[[sireines_mantis_0056773.pdf](uploads/e855689ab130403e40ada37f2c93848f/sireines_mantis_0056773.pdf)\] |
| 03/05/2021 | Mantis 0059550 | Extractions=erreur eclipse | \[[sireines_mantis_0059550.pdf](uploads/dbf64e820c7296237e5c5eafbe9dca45/sireines_mantis_0059550.pdf)\] |
| 30/09/2021 | Mantis 0061626 | Anomalie dans livraison 2.5.6 | \[[sireines_mantis_0061626.pdf](uploads/ac13ef2303459e85a76ccba84ce9da96/sireines_mantis_0061626.pdf)\] |

<a name="Site"></a>
## Accès au site

[sites](Sireines/sites)

<a name="Cerbere"></a>
## Cerbère

[cerbère](Sireines/Cerbère)

<a name="Version"></a>
## Version

[version](Sireines/Version)

<a name="Doc"></a>
## Documentations

### Guide du chef de produit :
 * [Recette d'une livraison sur poste (Docker)](Recette/LivraisonSurPosteDocker)
 * Recette d'une livraison sur environnement IAAS
 * [Connexion base de données](Recette/ConnexionBDD_Docker)

### Fonctionnel :

### Technique :
  * [Document d'installation et d'exploitation (IAAS)](Technique/DocumentationInstallationEtExploitation)
    
### Reversing
  * [Application](Reversing/App)
  * [Base de données](Reversing/Database)

### Deploiement
  * [Procedure de déploiement applicatif ](Technique/DeploiementApplicatif)
```


---

### 📄 `Cerbere.md` [3.007 octets]
<a id="Cerbere-md"></a> [↩ Retour à l'arborescence](#tree-Cerbere-md)

> **Chemin relatif** : `Cerbere.md`  
> **Taille** : 3.007 octets  
> **Lignes** : 68  
> **Type** : markdown

```markdown
La mission des compétences scientifiques et techniques (DRI/AST4) tient à jour une base de données dénommée SIREINES qui recense toutes les demandes de qualification par les comités de domaine de ses agents. Elle suit l'évolution de ces données, coordonne leur évaluation par les comités de domaine, et tient les agents informés des suites de leurs de leurs demandes.

Sommaire :
* [Qui fait quoi](#quifaitquoi)
* [Historique](#Historique)
* [Accès au site](#Site)
* [Cerbère](#Cerbere)
* [Version](#Version)
* [Documentations](#Doc)


<a name="quifaitquoi"></a>
## Qui fait quoi

| Intervenants | Commentaires |
|--------------|--------------|
| MOA MTES | Zemour Pascal (Chargé de mission) - CGDD/DRI/AST4 Pascal.Zemour@developpement-durable.gouv.fr =\> Chef de projet opérationnel de l'application |
|  | Letrouit Vincent (Chef de bureau) - CGDD/DRI/AST4 Vincent.Letrouit@developpement-durable.gouv.fr =\> Sponsor des projets |
| MOE prestataire | Jusqu'en novembre 2021 : Klee Group |
|  | \- Matthieu Georges (Chef de projet) matthieu.georges@kleegroup.com |
|  | \- Olivier Venot (Directeur de projet) olivier.venot@kleegroup.com |


<a name="Historique"></a>
## Historique

| Date | Références | Type d'évolution | Fichier |
|------|------------|------------------|---------|
| 26/02/2020 | Mantis 0052083 | Évolution mineure des courriers | \[[sireines_mantis_0052083.pdf](uploads/431f99b1ec1a87bc71962a80758af481/sireines_mantis_0052083.pdf)\] |
| 15/09/2020 | Mantis 0056137 | Demande de mise à jour des courriers | \[[sireines_mantis_0056137.pdf](uploads/d67a07eca5a5a248db13b6ebc71e6a0b/sireines_mantis_0056137.pdf)\] |
| 22/10/2020 | Mantis 0056773 | Correction de courriers | \[[sireines_mantis_0056773.pdf](uploads/e855689ab130403e40ada37f2c93848f/sireines_mantis_0056773.pdf)\] |
| 03/05/2021 | Mantis 0059550 | Extractions=erreur eclipse | \[[sireines_mantis_0059550.pdf](uploads/dbf64e820c7296237e5c5eafbe9dca45/sireines_mantis_0059550.pdf)\] |
| 30/09/2021 | Mantis 0061626 | Anomalie dans livraison 2.5.6 | \[[sireines_mantis_0061626.pdf](uploads/ac13ef2303459e85a76ccba84ce9da96/sireines_mantis_0061626.pdf)\] |

<a name="Site"></a>
## Accès au site

[sites](Sireines/sites)

<a name="Cerbere"></a>
## Cerbère

[cerbère](Sireines/Cerbère)

<a name="Version"></a>
## Version

[version](Sireines/Version)

<a name="Doc"></a>
## Documentations

### Guide du chef de produit :
 * [Recette d'une livraison sur poste (Docker)](Recette/LivraisonSurPosteDocker)
 * Recette d'une livraison sur environnement IAAS
 * [Connexion base de données](Recette/ConnexionBDD_Docker)

### Fonctionnel :

### Technique :
  * [Document d'installation et d'exploitation (IAAS)](Technique/DocumentationInstallationEtExploitation)
    
### Reversing
  * [Application](Reversing/App)
  * [Base de données](Reversing/Database)

### Deploiement
  * [Procedure de déploiement applicatif ](Technique/DeploiementApplicatif)
```


---

### 📄 `Delpoiement.md` [3.007 octets]
<a id="Delpoiement-md"></a> [↩ Retour à l'arborescence](#tree-Delpoiement-md)

> **Chemin relatif** : `Delpoiement.md`  
> **Taille** : 3.007 octets  
> **Lignes** : 68  
> **Type** : markdown

```markdown
La mission des compétences scientifiques et techniques (DRI/AST4) tient à jour une base de données dénommée SIREINES qui recense toutes les demandes de qualification par les comités de domaine de ses agents. Elle suit l'évolution de ces données, coordonne leur évaluation par les comités de domaine, et tient les agents informés des suites de leurs de leurs demandes.

Sommaire :
* [Qui fait quoi](#quifaitquoi)
* [Historique](#Historique)
* [Accès au site](#Site)
* [Cerbère](#Cerbere)
* [Version](#Version)
* [Documentations](#Doc)


<a name="quifaitquoi"></a>
## Qui fait quoi

| Intervenants | Commentaires |
|--------------|--------------|
| MOA MTES | Zemour Pascal (Chargé de mission) - CGDD/DRI/AST4 Pascal.Zemour@developpement-durable.gouv.fr =\> Chef de projet opérationnel de l'application |
|  | Letrouit Vincent (Chef de bureau) - CGDD/DRI/AST4 Vincent.Letrouit@developpement-durable.gouv.fr =\> Sponsor des projets |
| MOE prestataire | Jusqu'en novembre 2021 : Klee Group |
|  | \- Matthieu Georges (Chef de projet) matthieu.georges@kleegroup.com |
|  | \- Olivier Venot (Directeur de projet) olivier.venot@kleegroup.com |


<a name="Historique"></a>
## Historique

| Date | Références | Type d'évolution | Fichier |
|------|------------|------------------|---------|
| 26/02/2020 | Mantis 0052083 | Évolution mineure des courriers | \[[sireines_mantis_0052083.pdf](uploads/431f99b1ec1a87bc71962a80758af481/sireines_mantis_0052083.pdf)\] |
| 15/09/2020 | Mantis 0056137 | Demande de mise à jour des courriers | \[[sireines_mantis_0056137.pdf](uploads/d67a07eca5a5a248db13b6ebc71e6a0b/sireines_mantis_0056137.pdf)\] |
| 22/10/2020 | Mantis 0056773 | Correction de courriers | \[[sireines_mantis_0056773.pdf](uploads/e855689ab130403e40ada37f2c93848f/sireines_mantis_0056773.pdf)\] |
| 03/05/2021 | Mantis 0059550 | Extractions=erreur eclipse | \[[sireines_mantis_0059550.pdf](uploads/dbf64e820c7296237e5c5eafbe9dca45/sireines_mantis_0059550.pdf)\] |
| 30/09/2021 | Mantis 0061626 | Anomalie dans livraison 2.5.6 | \[[sireines_mantis_0061626.pdf](uploads/ac13ef2303459e85a76ccba84ce9da96/sireines_mantis_0061626.pdf)\] |

<a name="Site"></a>
## Accès au site

[sites](Sireines/sites)

<a name="Cerbere"></a>
## Cerbère

[cerbère](Sireines/Cerbère)

<a name="Version"></a>
## Version

[version](Sireines/Version)

<a name="Doc"></a>
## Documentations

### Guide du chef de produit :
 * [Recette d'une livraison sur poste (Docker)](Recette/LivraisonSurPosteDocker)
 * Recette d'une livraison sur environnement IAAS
 * [Connexion base de données](Recette/ConnexionBDD_Docker)

### Fonctionnel :

### Technique :
  * [Document d'installation et d'exploitation (IAAS)](Technique/DocumentationInstallationEtExploitation)
    
### Reversing
  * [Application](Reversing/App)
  * [Base de données](Reversing/Database)

### Deploiement
  * [Procedure de déploiement applicatif ](Technique/DeploiementApplicatif)
```


---

### 📄 `DeploiementApplicatif.md` [6.082 octets]
<a id="DeploiementApplicatif-md"></a> [↩ Retour à l'arborescence](#tree-DeploiementApplicatif-md)

> **Chemin relatif** : `DeploiementApplicatif.md`  
> **Taille** : 6.082 octets  
> **Lignes** : 115  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (115 lignes) - Cliquer pour déplier</summary>

````markdown


# Procédure de déploiement de l'applicatif {.chapter}


- ## Deploiement applicatif

- ## Activer le VPN

- ## Activer Pageant

   - ### Lancer le bastion sur Pageant
          ssh debian@10.165.134.248

   - ### Connexion sur la bastion PNM3
       pour faire, faire ceci

       et aussi cela 

   - ### Modification du fichier docker compose avec la nouvelle version
   ```bash
     cd /opt/app
 docker ps                                            1 ↵
CONTAINER ID   IMAGE                                        COMMAND                  CREATED        STATUS       PORTS                                NAMES
c5a9345c57ef   eu.gcr.io/dpnm3-lab/sireines:2.5.14-LIVREE   "/scripts/entrypoint…"   2 months ago   Up 8 weeks   0.0.0.0:8080->8080/tcp               sireines-app
a85ba5be0b3d   postgres:15.6-alpine                         "docker-entrypoint.s…"   2 months ago   Up 8 weeks   0.0.0.0:5432->5432/tcp               sireines-db
b63a78dfbf9e   grafana/promtail:latest                      "/usr/bin/promtail -…"   5 months ago   Up 8 weeks   19080/tcp, 0.0.0.0:19080->9080/tcp   metrics-promtail
1c77901f8edf   prom/pushgateway                             "/bin/pushgateway"       5 months ago   Up 8 weeks   19091/tcp, 0.0.0.0:19091->9091/tcp   metrics-push
160ff64fdf50   prom/node-exporter:latest                    "/bin/node_exporter …"   5 months ago   Up 8 weeks   19100/tcp, 0.0.0.0:19100->9100/tcp   metrics-node
36346c5416b9   cmosley/docker_exporter                      "./docker_exporter"      5 months ago   Up 8 weeks   19417/tcp, 0.0.0.0:19417->9417/tcp   metrics-docker

- constater que sireines-app et sireines-db s'executent



     cp docker-compose.yml docker-compose.yml.20241212
     vi docker-compose.yml


```

- ## Arreter le conteneur applicatif
docker stop sireines-app                           
sireines-app

- ## Supprimer le conteneur applicatif
docker rm sireines-app                            
sireines-app


- ## Relancer le docker-compose qui a pour effet de relancer l'application
/opt/app » docker compose up -d                               127 ↵
[+] Running 16/16
 ✔ app Pulled                                                                           32.7s
   ✔ bd8f6a7501cc Already exists                                                         0.0s
   ✔ 44718e6d535d Already exists                                                         0.0s
   ✔ efe9738af0cb Already exists                                                         0.0s
   ✔ f37aabde37b8 Already exists                                                         0.0s
   ✔ b87fc504233c Already exists                                                         0.0s
   ✔ cc62143cb8cc Already exists                                                         0.0s
   ✔ 646a47c88e43 Already exists                                                         0.0s
   ✔ d65bec3def24 Already exists                                                         0.0s
   ✔ 9b7471aadf4c Already exists                                                         0.0s
   ✔ cb4999122126 Already exists                                                         0.0s
   ✔ 537eff314fa1 Pull complete                                                         19.4s
   ✔ 8b1693a28ca0 Pull complete                                                         19.8s
   ✔ c58195575909 Pull complete                                                         21.2s
   ✔ faa83b01ce1b Pull complete                                                         21.3s
   ✔ 4198d8a165e6 Pull complete                                                         21.4s
[+] Running 2/2
 ✔ Container sireines-db   Running                                                       0.0s
 ✔ Container sireines-app  Started   
     
- ## Verifier que les conteneurs sont actifs

 docker ps                                          126 ↵
CONTAINER ID   IMAGE                                        COMMAND                  CREATED          STATUS          PORTS                                NAMES
41e614549398   eu.gcr.io/dpnm3-lab/sireines:2.5.16-LIVREE   "/scripts/entrypoint…"   43 seconds ago   Up 42 seconds   0.0.0.0:8080->8080/tcp               sireines-app
a85ba5be0b3d   postgres:15.6-alpine                         "docker-entrypoint.s…"   2 months ago     Up 8 weeks      0.0.0.0:5432->5432/tcp               sireines-db
b63a78dfbf9e   grafana/promtail:latest                      "/usr/bin/promtail -…"   5 months ago     Up 8 weeks      19080/tcp, 0.0.0.0:19080->9080/tcp   metrics-promtail
1c77901f8edf   prom/pushgateway                             "/bin/pushgateway"       5 months ago     Up 8 weeks      19091/tcp, 0.0.0.0:19091->9091/tcp   metrics-push
160ff64fdf50   prom/node-exporter:latest                    "/bin/node_exporter …"   5 months ago     Up 8 weeks      19100/tcp, 0.0.0.0:19100->9100/tcp   metrics-node
36346c5416b9   cmosley/docker_exporter                      "./docker_exporter"      5 months ago     Up 8 weeks      19417/tcp, 0.0.0.0:19417->9417/tcp   metrics-docker
```

- ## Quitter les connexions bastion

- ## Vérifier que l'application est fonctionnelle sur le réseau du ministère

   - ### Recette :
         http://sireines.recette.pnm3.eco4.cloud.e2.rie.gouv.fr/

   - ### Pré prod :
         https://sireines.preprod.e2.rie.gouv.fr/Accueil.do

   - ### prod :
         https://sireines.e2.rie.gouv.fr/Accueil.do

- ## Effectuer les tests fonctionnels élémentaires

   - ### Courriers

   - ### Statistiques


- ## Avertir la maitrise d'ouvrage
 ```text
     Une fois la recette validée pour :
      - le constat de l'affichage de la nouvelle version
      - les tests fonctionnels propres aux évolutions
      - les tests élémentaires de base, 
     le deploiement de la prod peut intervenir. 
     Une fois la preprod validée par la maitrise d'ouvrage, le deploiement de la prod peut intervenir 
 ```
 
````

</details>


---

### 📄 `Documentation.md` [3.007 octets]
<a id="Documentation-md"></a> [↩ Retour à l'arborescence](#tree-Documentation-md)

> **Chemin relatif** : `Documentation.md`  
> **Taille** : 3.007 octets  
> **Lignes** : 68  
> **Type** : markdown

```markdown
La mission des compétences scientifiques et techniques (DRI/AST4) tient à jour une base de données dénommée SIREINES qui recense toutes les demandes de qualification par les comités de domaine de ses agents. Elle suit l'évolution de ces données, coordonne leur évaluation par les comités de domaine, et tient les agents informés des suites de leurs de leurs demandes.

Sommaire :
* [Qui fait quoi](#quifaitquoi)
* [Historique](#Historique)
* [Accès au site](#Site)
* [Cerbère](#Cerbere)
* [Version](#Version)
* [Documentations](#Doc)


<a name="quifaitquoi"></a>
## Qui fait quoi

| Intervenants | Commentaires |
|--------------|--------------|
| MOA MTES | Zemour Pascal (Chargé de mission) - CGDD/DRI/AST4 Pascal.Zemour@developpement-durable.gouv.fr =\> Chef de projet opérationnel de l'application |
|  | Letrouit Vincent (Chef de bureau) - CGDD/DRI/AST4 Vincent.Letrouit@developpement-durable.gouv.fr =\> Sponsor des projets |
| MOE prestataire | Jusqu'en novembre 2021 : Klee Group |
|  | \- Matthieu Georges (Chef de projet) matthieu.georges@kleegroup.com |
|  | \- Olivier Venot (Directeur de projet) olivier.venot@kleegroup.com |


<a name="Historique"></a>
## Historique

| Date | Références | Type d'évolution | Fichier |
|------|------------|------------------|---------|
| 26/02/2020 | Mantis 0052083 | Évolution mineure des courriers | \[[sireines_mantis_0052083.pdf](uploads/431f99b1ec1a87bc71962a80758af481/sireines_mantis_0052083.pdf)\] |
| 15/09/2020 | Mantis 0056137 | Demande de mise à jour des courriers | \[[sireines_mantis_0056137.pdf](uploads/d67a07eca5a5a248db13b6ebc71e6a0b/sireines_mantis_0056137.pdf)\] |
| 22/10/2020 | Mantis 0056773 | Correction de courriers | \[[sireines_mantis_0056773.pdf](uploads/e855689ab130403e40ada37f2c93848f/sireines_mantis_0056773.pdf)\] |
| 03/05/2021 | Mantis 0059550 | Extractions=erreur eclipse | \[[sireines_mantis_0059550.pdf](uploads/dbf64e820c7296237e5c5eafbe9dca45/sireines_mantis_0059550.pdf)\] |
| 30/09/2021 | Mantis 0061626 | Anomalie dans livraison 2.5.6 | \[[sireines_mantis_0061626.pdf](uploads/ac13ef2303459e85a76ccba84ce9da96/sireines_mantis_0061626.pdf)\] |

<a name="Site"></a>
## Accès au site

[sites](Sireines/sites)

<a name="Cerbere"></a>
## Cerbère

[cerbère](Sireines/Cerbère)

<a name="Version"></a>
## Version

[version](Sireines/Version)

<a name="Doc"></a>
## Documentations

### Guide du chef de produit :
 * [Recette d'une livraison sur poste (Docker)](Recette/LivraisonSurPosteDocker)
 * Recette d'une livraison sur environnement IAAS
 * [Connexion base de données](Recette/ConnexionBDD_Docker)

### Fonctionnel :

### Technique :
  * [Document d'installation et d'exploitation (IAAS)](Technique/DocumentationInstallationEtExploitation)
    
### Reversing
  * [Application](Reversing/App)
  * [Base de données](Reversing/Database)

### Deploiement
  * [Procedure de déploiement applicatif ](Technique/DeploiementApplicatif)
```


---

### 📄 `Fonctionnel.md` [3.007 octets]
<a id="Fonctionnel-md"></a> [↩ Retour à l'arborescence](#tree-Fonctionnel-md)

> **Chemin relatif** : `Fonctionnel.md`  
> **Taille** : 3.007 octets  
> **Lignes** : 68  
> **Type** : markdown

```markdown
La mission des compétences scientifiques et techniques (DRI/AST4) tient à jour une base de données dénommée SIREINES qui recense toutes les demandes de qualification par les comités de domaine de ses agents. Elle suit l'évolution de ces données, coordonne leur évaluation par les comités de domaine, et tient les agents informés des suites de leurs de leurs demandes.

Sommaire :
* [Qui fait quoi](#quifaitquoi)
* [Historique](#Historique)
* [Accès au site](#Site)
* [Cerbère](#Cerbere)
* [Version](#Version)
* [Documentations](#Doc)


<a name="quifaitquoi"></a>
## Qui fait quoi

| Intervenants | Commentaires |
|--------------|--------------|
| MOA MTES | Zemour Pascal (Chargé de mission) - CGDD/DRI/AST4 Pascal.Zemour@developpement-durable.gouv.fr =\> Chef de projet opérationnel de l'application |
|  | Letrouit Vincent (Chef de bureau) - CGDD/DRI/AST4 Vincent.Letrouit@developpement-durable.gouv.fr =\> Sponsor des projets |
| MOE prestataire | Jusqu'en novembre 2021 : Klee Group |
|  | \- Matthieu Georges (Chef de projet) matthieu.georges@kleegroup.com |
|  | \- Olivier Venot (Directeur de projet) olivier.venot@kleegroup.com |


<a name="Historique"></a>
## Historique

| Date | Références | Type d'évolution | Fichier |
|------|------------|------------------|---------|
| 26/02/2020 | Mantis 0052083 | Évolution mineure des courriers | \[[sireines_mantis_0052083.pdf](uploads/431f99b1ec1a87bc71962a80758af481/sireines_mantis_0052083.pdf)\] |
| 15/09/2020 | Mantis 0056137 | Demande de mise à jour des courriers | \[[sireines_mantis_0056137.pdf](uploads/d67a07eca5a5a248db13b6ebc71e6a0b/sireines_mantis_0056137.pdf)\] |
| 22/10/2020 | Mantis 0056773 | Correction de courriers | \[[sireines_mantis_0056773.pdf](uploads/e855689ab130403e40ada37f2c93848f/sireines_mantis_0056773.pdf)\] |
| 03/05/2021 | Mantis 0059550 | Extractions=erreur eclipse | \[[sireines_mantis_0059550.pdf](uploads/dbf64e820c7296237e5c5eafbe9dca45/sireines_mantis_0059550.pdf)\] |
| 30/09/2021 | Mantis 0061626 | Anomalie dans livraison 2.5.6 | \[[sireines_mantis_0061626.pdf](uploads/ac13ef2303459e85a76ccba84ce9da96/sireines_mantis_0061626.pdf)\] |

<a name="Site"></a>
## Accès au site

[sites](Sireines/sites)

<a name="Cerbere"></a>
## Cerbère

[cerbère](Sireines/Cerbère)

<a name="Version"></a>
## Version

[version](Sireines/Version)

<a name="Doc"></a>
## Documentations

### Guide du chef de produit :
 * [Recette d'une livraison sur poste (Docker)](Recette/LivraisonSurPosteDocker)
 * Recette d'une livraison sur environnement IAAS
 * [Connexion base de données](Recette/ConnexionBDD_Docker)

### Fonctionnel :

### Technique :
  * [Document d'installation et d'exploitation (IAAS)](Technique/DocumentationInstallationEtExploitation)
    
### Reversing
  * [Application](Reversing/App)
  * [Base de données](Reversing/Database)

### Deploiement
  * [Procedure de déploiement applicatif ](Technique/DeploiementApplicatif)
```


---

### 📄 `GuideDuChefDeProduit.md` [3.007 octets]
<a id="GuideDuChefDeProduit-md"></a> [↩ Retour à l'arborescence](#tree-GuideDuChefDeProduit-md)

> **Chemin relatif** : `GuideDuChefDeProduit.md`  
> **Taille** : 3.007 octets  
> **Lignes** : 68  
> **Type** : markdown

```markdown
La mission des compétences scientifiques et techniques (DRI/AST4) tient à jour une base de données dénommée SIREINES qui recense toutes les demandes de qualification par les comités de domaine de ses agents. Elle suit l'évolution de ces données, coordonne leur évaluation par les comités de domaine, et tient les agents informés des suites de leurs de leurs demandes.

Sommaire :
* [Qui fait quoi](#quifaitquoi)
* [Historique](#Historique)
* [Accès au site](#Site)
* [Cerbère](#Cerbere)
* [Version](#Version)
* [Documentations](#Doc)


<a name="quifaitquoi"></a>
## Qui fait quoi

| Intervenants | Commentaires |
|--------------|--------------|
| MOA MTES | Zemour Pascal (Chargé de mission) - CGDD/DRI/AST4 Pascal.Zemour@developpement-durable.gouv.fr =\> Chef de projet opérationnel de l'application |
|  | Letrouit Vincent (Chef de bureau) - CGDD/DRI/AST4 Vincent.Letrouit@developpement-durable.gouv.fr =\> Sponsor des projets |
| MOE prestataire | Jusqu'en novembre 2021 : Klee Group |
|  | \- Matthieu Georges (Chef de projet) matthieu.georges@kleegroup.com |
|  | \- Olivier Venot (Directeur de projet) olivier.venot@kleegroup.com |


<a name="Historique"></a>
## Historique

| Date | Références | Type d'évolution | Fichier |
|------|------------|------------------|---------|
| 26/02/2020 | Mantis 0052083 | Évolution mineure des courriers | \[[sireines_mantis_0052083.pdf](uploads/431f99b1ec1a87bc71962a80758af481/sireines_mantis_0052083.pdf)\] |
| 15/09/2020 | Mantis 0056137 | Demande de mise à jour des courriers | \[[sireines_mantis_0056137.pdf](uploads/d67a07eca5a5a248db13b6ebc71e6a0b/sireines_mantis_0056137.pdf)\] |
| 22/10/2020 | Mantis 0056773 | Correction de courriers | \[[sireines_mantis_0056773.pdf](uploads/e855689ab130403e40ada37f2c93848f/sireines_mantis_0056773.pdf)\] |
| 03/05/2021 | Mantis 0059550 | Extractions=erreur eclipse | \[[sireines_mantis_0059550.pdf](uploads/dbf64e820c7296237e5c5eafbe9dca45/sireines_mantis_0059550.pdf)\] |
| 30/09/2021 | Mantis 0061626 | Anomalie dans livraison 2.5.6 | \[[sireines_mantis_0061626.pdf](uploads/ac13ef2303459e85a76ccba84ce9da96/sireines_mantis_0061626.pdf)\] |

<a name="Site"></a>
## Accès au site

[sites](Sireines/sites)

<a name="Cerbere"></a>
## Cerbère

[cerbère](Sireines/Cerbère)

<a name="Version"></a>
## Version

[version](Sireines/Version)

<a name="Doc"></a>
## Documentations

### Guide du chef de produit :
 * [Recette d'une livraison sur poste (Docker)](Recette/LivraisonSurPosteDocker)
 * Recette d'une livraison sur environnement IAAS
 * [Connexion base de données](Recette/ConnexionBDD_Docker)

### Fonctionnel :

### Technique :
  * [Document d'installation et d'exploitation (IAAS)](Technique/DocumentationInstallationEtExploitation)
    
### Reversing
  * [Application](Reversing/App)
  * [Base de données](Reversing/Database)

### Deploiement
  * [Procedure de déploiement applicatif ](Technique/DeploiementApplicatif)
```


---

### 📄 `Historique.md` [3.007 octets]
<a id="Historique-md"></a> [↩ Retour à l'arborescence](#tree-Historique-md)

> **Chemin relatif** : `Historique.md`  
> **Taille** : 3.007 octets  
> **Lignes** : 68  
> **Type** : markdown

```markdown
La mission des compétences scientifiques et techniques (DRI/AST4) tient à jour une base de données dénommée SIREINES qui recense toutes les demandes de qualification par les comités de domaine de ses agents. Elle suit l'évolution de ces données, coordonne leur évaluation par les comités de domaine, et tient les agents informés des suites de leurs de leurs demandes.

Sommaire :
* [Qui fait quoi](#quifaitquoi)
* [Historique](#Historique)
* [Accès au site](#Site)
* [Cerbère](#Cerbere)
* [Version](#Version)
* [Documentations](#Doc)


<a name="quifaitquoi"></a>
## Qui fait quoi

| Intervenants | Commentaires |
|--------------|--------------|
| MOA MTES | Zemour Pascal (Chargé de mission) - CGDD/DRI/AST4 Pascal.Zemour@developpement-durable.gouv.fr =\> Chef de projet opérationnel de l'application |
|  | Letrouit Vincent (Chef de bureau) - CGDD/DRI/AST4 Vincent.Letrouit@developpement-durable.gouv.fr =\> Sponsor des projets |
| MOE prestataire | Jusqu'en novembre 2021 : Klee Group |
|  | \- Matthieu Georges (Chef de projet) matthieu.georges@kleegroup.com |
|  | \- Olivier Venot (Directeur de projet) olivier.venot@kleegroup.com |


<a name="Historique"></a>
## Historique

| Date | Références | Type d'évolution | Fichier |
|------|------------|------------------|---------|
| 26/02/2020 | Mantis 0052083 | Évolution mineure des courriers | \[[sireines_mantis_0052083.pdf](uploads/431f99b1ec1a87bc71962a80758af481/sireines_mantis_0052083.pdf)\] |
| 15/09/2020 | Mantis 0056137 | Demande de mise à jour des courriers | \[[sireines_mantis_0056137.pdf](uploads/d67a07eca5a5a248db13b6ebc71e6a0b/sireines_mantis_0056137.pdf)\] |
| 22/10/2020 | Mantis 0056773 | Correction de courriers | \[[sireines_mantis_0056773.pdf](uploads/e855689ab130403e40ada37f2c93848f/sireines_mantis_0056773.pdf)\] |
| 03/05/2021 | Mantis 0059550 | Extractions=erreur eclipse | \[[sireines_mantis_0059550.pdf](uploads/dbf64e820c7296237e5c5eafbe9dca45/sireines_mantis_0059550.pdf)\] |
| 30/09/2021 | Mantis 0061626 | Anomalie dans livraison 2.5.6 | \[[sireines_mantis_0061626.pdf](uploads/ac13ef2303459e85a76ccba84ce9da96/sireines_mantis_0061626.pdf)\] |

<a name="Site"></a>
## Accès au site

[sites](Sireines/sites)

<a name="Cerbere"></a>
## Cerbère

[cerbère](Sireines/Cerbère)

<a name="Version"></a>
## Version

[version](Sireines/Version)

<a name="Doc"></a>
## Documentations

### Guide du chef de produit :
 * [Recette d'une livraison sur poste (Docker)](Recette/LivraisonSurPosteDocker)
 * Recette d'une livraison sur environnement IAAS
 * [Connexion base de données](Recette/ConnexionBDD_Docker)

### Fonctionnel :

### Technique :
  * [Document d'installation et d'exploitation (IAAS)](Technique/DocumentationInstallationEtExploitation)
    
### Reversing
  * [Application](Reversing/App)
  * [Base de données](Reversing/Database)

### Deploiement
  * [Procedure de déploiement applicatif ](Technique/DeploiementApplicatif)
```


---

### 📄 `LivraisonSurPosteDocker.md` [7.095 octets]
<a id="LivraisonSurPosteDocker-md"></a> [↩ Retour à l'arborescence](#tree-LivraisonSurPosteDocker-md)

> **Chemin relatif** : `LivraisonSurPosteDocker.md`  
> **Taille** : 7.095 octets  
> **Lignes** : 199  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (199 lignes) - Cliquer pour déplier</summary>

````markdown
<a name="HautdePage"></a>
# Document d'installation sur Poste de Travail (Docker)


Sommaire :

*[Pré-requis](#prerequis)


<a name="prerequis"></a>
## 0 - Pré-requis

Avoir installé sur son poste : 
* Docker Desktop Installer.exe (application Docker Desktop) (Logo Baleine) avec wsl-updatex64.msi

* L'application Visual code avec les extensions :
    * Dev Containers
    * Docker
    * French Language Pack for Visual Studio Code (*)
    * Markdown Preview Enhanced (*)
    * WSL
* L'application Prince (*) et ajouter dans les variables d'environnement dans le path :
    C:\Program Files (x86)\Prince\engine\bin

* L'interface de base de données Pgadmin 4 v8 (minimal)

(*) Non obligatoire

[Haut de Page](#HautdePage)

## 1 - Les conteneurs et les images

### 1.1 Vocabulaire

**Un conteneur** est une unité logicielle standard qui regroupe le code et toutes ses dépendances afin que l'application s'exécute rapidement et de manière fiable d'un environnement informatique à un autre. Une image de conteneur Docker est un package logiciel léger, autonome et exécutable qui comprend tout ce dont vous avez besoin pour exécuter une application : code, runtime, outils système, bibliothèques système et paramètres.

**Les images de conteneurs**
deviennent des conteneurs au moment de l'exécution et dans le cas des conteneurs Docker, les images deviennent des conteneurs lorsqu'elles s'exécutent sur Docker Engine (logo Baleine). 

### 1.2 Cas particulier  : Application Sireines
L'application Sireines comporte  trois conteneurs, trois images et un volume.

* Le conteneur de l'applicatif s'appelle **sireines_app_usine_container** et l'image associée s'appelle **sireines_app_usine_image**.

* Le conteneur de la base de données s'appelle **sireines_db_usine_container** et l'image associée s'appelle **postgres:14.1-alpine**.

* Un conteneur a été ajouté pour garder en mémoire les connexions à la base de données. Ce conteneur s'appelle **sireines_pgadmin_container** et l'image associée s'appelle **dpage/pgadmin4**.

La base de données est contenu dans un seul volume appelé : **sireines_db_sireines_vol**.
Les connexions sont sauvegardées dans le volume appelé : **sireines_pgadmin_sireines_vol**.

## 2 - Aller chercher le war dans gitlab

### 2.1 Les liens Gitlab

* **Lien Gitlab**

https://gitlab-forge.din.developpement-durable.gouv.fr/

* **Lien Gitlab du projet Sireines**

https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/produits/rh/sireines

* **Emplacement du war dans Gitlab**

deploy / package registry 

(https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/produits/rh/sireines/-/packages) puis cliquer sur le lien pour télécharger le war  (sireines-web-*.war).

### 2.2 Télécharger le fichier *.war et le déposer dans le répertoire de travail de votre poste

c:/sireines/sireines_pgadmin (Répertoire de travail)

### 2.3 Annotation

A noter que dans le fichier Dockerfile, la ligne 
    **COPY --chown=root:root sireines-web-*.war /tmp/ROOT.war**
permet de prendre tous les war commençant par **"sireines-web-"** et se terminant par **".war"**.

Lors d'une nouvelle livraison d'un war, il suffit de substituer l'ancien war par le nouveau war dans le répertoire de travail.

Dans ce cas précis, il n'y aura rien d'autre à changer et le fichier Dockerfile peut rester en l'état.

Toutes les sources se trouvent dans le répertoire partagé du service :

[M:\Produits numériques\Ressources humaines\Sireines\Docker\Archives](M:\Produits numériques\Ressources humaines\Sireines\Docker\Archives)
M: correspond au Dossier partagé [DPNM3]

On y trouvera les war et les dump de l'application.

<div style="page-break-after: always; visibility: hidden">\pagebreak</div>

## 3 - Installation de l'applicatif 

### 3.1 Prérequis
* Avoir récupérer le répertoire **[M:\Produits numériques\Ressources humaines\Sireines\Docker\sireines_pgadmin]**(M:\Produits numériques\Ressources humaines\Sireines\Docker\sireines_pgadmin)
M: correspond au Dossier partagé [DPNM3]
et le déposer sur le poste de travail **c:/sireines/sireines_pgadmin**

* Lancer l'application Docker Desktop (Logo Baleine) et s'assurer que les moteurs sont bien en exécution (Running)
![alt text](img/dockerDesktop.png)

### 3.2 Vérification de l'existence des volumes (Visual studio Code)

Se positionner dans le terminal du Visual Code dans le répertoire de travail:
![alt text](img/repertoire.PNG)

* Si le volume sireines_db_sireines_vol n'est pas n'existe pas faire :
    docker volume create sireines_db_sireines_vol
    
    ![alt text](images/creation_volume.png)


    et modifier **si besoin** les lignes 38 et 74 de docker-compose.yml concernant ce volume.
![alt text](<images/Volume Sireines pgadmin lignes 38_74.JPG>)


    Ce volume contiendra les données de la base de données.

* Si le volume sireines_pgadmin_sireines_vol n'existe pas faire :
docker volume create sireines_pgadmin_sireines_vol 

et modifier **si besoin** les lignes 66 et 76 de de docker-compose.yml concernant ce volume.
![alt text](<images/Volume Sreines pgadmin lignes 66-76.JPG>)


Au final, on devrait avoir :

![alt text](images/Volume.PNG)

Ces volumes sont persistants sur le poste de travail.

### 3.3 Si besoin supprimer l'applicatif

Remove sur le conteneur (sireines_app_usine_container) puis l'image(sireines_app_usine_image).

Dans l'application Visual code :
![alt text](images/remove_conteneur.PNG)
![alt text](images/remove_image.PNG)

**Ou** dans Docker Desktop :
![alt text](images/delete_docker.PNG)

**Ou** en ligne de commande Dos (cmd)
```docker rm -f sireines_app_usine_container```
```docker rmi -f sireines_app_usine_image```


### 3.4 Créer et démarrer tous les services 
 
**Lancer sans le VPN :** 
```docker-compose up -d```

  dans le répertoire c:/sireines/sireines_pgadmin

<div style="page-break-after: always; visibility: hidden">\pagebreak</div>

## 4 - Installation de la base de données

### 4.1 Prérequis
Vérifier dans le fichier .env, les arguments de la bdd du Docker
            POSTGRES_DB=postgres
            POSTGRES_HOST=db
            POSTGRES_PORT=5432
            POSTGRES_USER=postgres
            POSTGRES_PASSWORD=postgres
            POSTGRES_SCHEMA=postgres

### 4.2  Installation de la BDD avec pgAdmin et/ou ligne de commande :

1 - Add Server 
Renseigner Onglet General : Name XXXXX ;
Renseigner Onglet Connection :
    Host : localhost
    Port : 8888
    Maintenance Database :
    UserName :
    MotdePasse : 



2- Alimentation de la base via un dump






<div style="page-break-after: always; visibility: hidden">\pagebreak</div>
# Annexe(s) 

## Ouvrir un terminal dans l'application Visual code 

**Choisir "Command prompt" à la place de powershell (par défaut)**


![alt text](images/prompt_cmd.PNG)

Vous pourrez alors utiliser les commandes dos non reconnues par powershell
````

</details>


---

### 📄 `QuiFaitQuoi.md` [2.980 octets]
<a id="QuiFaitQuoi-md"></a> [↩ Retour à l'arborescence](#tree-QuiFaitQuoi-md)

> **Chemin relatif** : `QuiFaitQuoi.md`  
> **Taille** : 2.980 octets  
> **Lignes** : 68  
> **Type** : markdown

```markdown
La mission des compétences scientifiques et techniques (DRI/AST4) tient à jour une base de données dénommée SIREINES qui recense toutes les demandes de qualification par les comités de domaine de ses agents. Elle suit l'évolution de ces données, coordonne leur évaluation par les comités de domaine, et tient les agents informés des suites de leurs de leurs demandes.

Sommaire :
* [Qui fait quoi](#quifaitquoi)
* [Historique](#Historique)
* [Accès au site](#Site)
* [Cerbère](#Cerbere)
* [Version](#Version)
* [Documentations](#Doc)


<a name="quifaitquoi"></a>
## Qui fait quoi

| Intervenants | Commentaires |
|--------------|--------------|
| MOA MTES | Zemour Pascal (Chargé de mission) - CGDD/DRI/AST4 Pascal.Zemour@developpement-durable.gouv.fr =\> Chef de projet opérationnel de l'application |
|  | Letrouit Vincent (Chef de bureau) - CGDD/DRI/AST4 Vincent.Letrouit@developpement-durable.gouv.fr =\> Sponsor des projets |
| MOE prestataire | Jusqu'en novembre 2021 : Klee Group |
|  | \- Matthieu Georges (Chef de projet) matthieu.georges@kleegroup.com |
|  | \- Olivier Venot (Directeur de projet) olivier.venot@kleegroup.com |


<a name="Historique"></a>
## Historique

| Date | Références | Type d'évolution | Fichier |
|------|------------|------------------|---------|
| 26/02/2020 | Mantis 0052083 | Évolution mineure des courriers | \[[sireines_mantis_0052083.pdf](uploads/431f99b1ec1a87bc71962a80758af481/sireines_mantis_0052083.pdf)\] |
| 15/09/2020 | Mantis 0056137 | Demande de mise à jour des courriers | \[[sireines_mantis_0056137.pdf](uploads/d67a07eca5a5a248db13b6ebc71e6a0b/sireines_mantis_0056137.pdf)\] |
| 22/10/2020 | Mantis 0056773 | Correction de courriers | \[[sireines_mantis_0056773.pdf](uploads/e855689ab130403e40ada37f2c93848f/sireines_mantis_0056773.pdf)\] |
| 03/05/2021 | Mantis 0059550 | Extractions=erreur eclipse | \[[sireines_mantis_0059550.pdf](uploads/dbf64e820c7296237e5c5eafbe9dca45/sireines_mantis_0059550.pdf)\] |
| 30/09/2021 | Mantis 0061626 | Anomalie dans livraison 2.5.6 | \[[sireines_mantis_0061626.pdf](uploads/ac13ef2303459e85a76ccba84ce9da96/sireines_mantis_0061626.pdf)\] |

<a name="Site"></a>
## Accès au site

[sites](Sireines/sites)

<a name="Cerbere"></a>
## Cerbère

[cerbère](Sireines/Cerbère)

<a name="Version"></a>
## Version

[version](Sireines/Version)

<a name="Doc"></a>
## Documentations

### Guide du chef de produit :
 * [Recette d'une livraison sur poste (Docker)](Recette/LivraisonSurPosteDocker)
 * Recette d'une livraison sur environnement IAAS
 * [Connexion base de données](Recette/ConnexionBDD_Docker)

### Fonctionnel :

### Technique :
  * [Document d'installation et d'exploitation (IAAS)](Technique/DocumentationInstallationEtExploitation)
    
### Reversing
  * [Application](Reversing/App)
  * [Base de données](Reversing/Database)

### Deploiement
  * [Procedure de déploiement applicatif ](Technique/DeploiementApplicatif)
```


---

### 📄 `Reversing.md` [3.007 octets]
<a id="Reversing-md"></a> [↩ Retour à l'arborescence](#tree-Reversing-md)

> **Chemin relatif** : `Reversing.md`  
> **Taille** : 3.007 octets  
> **Lignes** : 68  
> **Type** : markdown

```markdown
La mission des compétences scientifiques et techniques (DRI/AST4) tient à jour une base de données dénommée SIREINES qui recense toutes les demandes de qualification par les comités de domaine de ses agents. Elle suit l'évolution de ces données, coordonne leur évaluation par les comités de domaine, et tient les agents informés des suites de leurs de leurs demandes.

Sommaire :
* [Qui fait quoi](#quifaitquoi)
* [Historique](#Historique)
* [Accès au site](#Site)
* [Cerbère](#Cerbere)
* [Version](#Version)
* [Documentations](#Doc)


<a name="quifaitquoi"></a>
## Qui fait quoi

| Intervenants | Commentaires |
|--------------|--------------|
| MOA MTES | Zemour Pascal (Chargé de mission) - CGDD/DRI/AST4 Pascal.Zemour@developpement-durable.gouv.fr =\> Chef de projet opérationnel de l'application |
|  | Letrouit Vincent (Chef de bureau) - CGDD/DRI/AST4 Vincent.Letrouit@developpement-durable.gouv.fr =\> Sponsor des projets |
| MOE prestataire | Jusqu'en novembre 2021 : Klee Group |
|  | \- Matthieu Georges (Chef de projet) matthieu.georges@kleegroup.com |
|  | \- Olivier Venot (Directeur de projet) olivier.venot@kleegroup.com |


<a name="Historique"></a>
## Historique

| Date | Références | Type d'évolution | Fichier |
|------|------------|------------------|---------|
| 26/02/2020 | Mantis 0052083 | Évolution mineure des courriers | \[[sireines_mantis_0052083.pdf](uploads/431f99b1ec1a87bc71962a80758af481/sireines_mantis_0052083.pdf)\] |
| 15/09/2020 | Mantis 0056137 | Demande de mise à jour des courriers | \[[sireines_mantis_0056137.pdf](uploads/d67a07eca5a5a248db13b6ebc71e6a0b/sireines_mantis_0056137.pdf)\] |
| 22/10/2020 | Mantis 0056773 | Correction de courriers | \[[sireines_mantis_0056773.pdf](uploads/e855689ab130403e40ada37f2c93848f/sireines_mantis_0056773.pdf)\] |
| 03/05/2021 | Mantis 0059550 | Extractions=erreur eclipse | \[[sireines_mantis_0059550.pdf](uploads/dbf64e820c7296237e5c5eafbe9dca45/sireines_mantis_0059550.pdf)\] |
| 30/09/2021 | Mantis 0061626 | Anomalie dans livraison 2.5.6 | \[[sireines_mantis_0061626.pdf](uploads/ac13ef2303459e85a76ccba84ce9da96/sireines_mantis_0061626.pdf)\] |

<a name="Site"></a>
## Accès au site

[sites](Sireines/sites)

<a name="Cerbere"></a>
## Cerbère

[cerbère](Sireines/Cerbère)

<a name="Version"></a>
## Version

[version](Sireines/Version)

<a name="Doc"></a>
## Documentations

### Guide du chef de produit :
 * [Recette d'une livraison sur poste (Docker)](Recette/LivraisonSurPosteDocker)
 * Recette d'une livraison sur environnement IAAS
 * [Connexion base de données](Recette/ConnexionBDD_Docker)

### Fonctionnel :

### Technique :
  * [Document d'installation et d'exploitation (IAAS)](Technique/DocumentationInstallationEtExploitation)
    
### Reversing
  * [Application](Reversing/App)
  * [Base de données](Reversing/Database)

### Deploiement
  * [Procedure de déploiement applicatif ](Technique/DeploiementApplicatif)
```


---

### 📄 `Sites.md` [184 octets]
<a id="Sites-md"></a> [↩ Retour à l'arborescence](#tree-Sites-md)

> **Chemin relatif** : `Sites.md`  
> **Taille** : 184 octets  
> **Lignes** : 5  
> **Type** : markdown

```markdown
Recette : http://sireines.recette.pnm3.eco4.cloud.e2.rie.gouv.fr/

Pré prod : https://sireines.preprod.e2.rie.gouv.fr/Accueil.do

prod : https://sireines.e2.rie.gouv.fr/Accueil.do
```


---

### 📄 `Technique.md` [3.007 octets]
<a id="Technique-md"></a> [↩ Retour à l'arborescence](#tree-Technique-md)

> **Chemin relatif** : `Technique.md`  
> **Taille** : 3.007 octets  
> **Lignes** : 68  
> **Type** : markdown

```markdown
La mission des compétences scientifiques et techniques (DRI/AST4) tient à jour une base de données dénommée SIREINES qui recense toutes les demandes de qualification par les comités de domaine de ses agents. Elle suit l'évolution de ces données, coordonne leur évaluation par les comités de domaine, et tient les agents informés des suites de leurs de leurs demandes.

Sommaire :
* [Qui fait quoi](#quifaitquoi)
* [Historique](#Historique)
* [Accès au site](#Site)
* [Cerbère](#Cerbere)
* [Version](#Version)
* [Documentations](#Doc)


<a name="quifaitquoi"></a>
## Qui fait quoi

| Intervenants | Commentaires |
|--------------|--------------|
| MOA MTES | Zemour Pascal (Chargé de mission) - CGDD/DRI/AST4 Pascal.Zemour@developpement-durable.gouv.fr =\> Chef de projet opérationnel de l'application |
|  | Letrouit Vincent (Chef de bureau) - CGDD/DRI/AST4 Vincent.Letrouit@developpement-durable.gouv.fr =\> Sponsor des projets |
| MOE prestataire | Jusqu'en novembre 2021 : Klee Group |
|  | \- Matthieu Georges (Chef de projet) matthieu.georges@kleegroup.com |
|  | \- Olivier Venot (Directeur de projet) olivier.venot@kleegroup.com |


<a name="Historique"></a>
## Historique

| Date | Références | Type d'évolution | Fichier |
|------|------------|------------------|---------|
| 26/02/2020 | Mantis 0052083 | Évolution mineure des courriers | \[[sireines_mantis_0052083.pdf](uploads/431f99b1ec1a87bc71962a80758af481/sireines_mantis_0052083.pdf)\] |
| 15/09/2020 | Mantis 0056137 | Demande de mise à jour des courriers | \[[sireines_mantis_0056137.pdf](uploads/d67a07eca5a5a248db13b6ebc71e6a0b/sireines_mantis_0056137.pdf)\] |
| 22/10/2020 | Mantis 0056773 | Correction de courriers | \[[sireines_mantis_0056773.pdf](uploads/e855689ab130403e40ada37f2c93848f/sireines_mantis_0056773.pdf)\] |
| 03/05/2021 | Mantis 0059550 | Extractions=erreur eclipse | \[[sireines_mantis_0059550.pdf](uploads/dbf64e820c7296237e5c5eafbe9dca45/sireines_mantis_0059550.pdf)\] |
| 30/09/2021 | Mantis 0061626 | Anomalie dans livraison 2.5.6 | \[[sireines_mantis_0061626.pdf](uploads/ac13ef2303459e85a76ccba84ce9da96/sireines_mantis_0061626.pdf)\] |

<a name="Site"></a>
## Accès au site

[sites](Sireines/sites)

<a name="Cerbere"></a>
## Cerbère

[cerbère](Sireines/Cerbère)

<a name="Version"></a>
## Version

[version](Sireines/Version)

<a name="Doc"></a>
## Documentations

### Guide du chef de produit :
 * [Recette d'une livraison sur poste (Docker)](Recette/LivraisonSurPosteDocker)
 * Recette d'une livraison sur environnement IAAS
 * [Connexion base de données](Recette/ConnexionBDD_Docker)

### Fonctionnel :

### Technique :
  * [Document d'installation et d'exploitation (IAAS)](Technique/DocumentationInstallationEtExploitation)
    
### Reversing
  * [Application](Reversing/App)
  * [Base de données](Reversing/Database)

### Deploiement
  * [Procedure de déploiement applicatif ](Technique/DeploiementApplicatif)
```


---

### 📄 `Versions.md` [3.007 octets]
<a id="Versions-md"></a> [↩ Retour à l'arborescence](#tree-Versions-md)

> **Chemin relatif** : `Versions.md`  
> **Taille** : 3.007 octets  
> **Lignes** : 68  
> **Type** : markdown

```markdown
La mission des compétences scientifiques et techniques (DRI/AST4) tient à jour une base de données dénommée SIREINES qui recense toutes les demandes de qualification par les comités de domaine de ses agents. Elle suit l'évolution de ces données, coordonne leur évaluation par les comités de domaine, et tient les agents informés des suites de leurs de leurs demandes.

Sommaire :
* [Qui fait quoi](#quifaitquoi)
* [Historique](#Historique)
* [Accès au site](#Site)
* [Cerbère](#Cerbere)
* [Version](#Version)
* [Documentations](#Doc)


<a name="quifaitquoi"></a>
## Qui fait quoi

| Intervenants | Commentaires |
|--------------|--------------|
| MOA MTES | Zemour Pascal (Chargé de mission) - CGDD/DRI/AST4 Pascal.Zemour@developpement-durable.gouv.fr =\> Chef de projet opérationnel de l'application |
|  | Letrouit Vincent (Chef de bureau) - CGDD/DRI/AST4 Vincent.Letrouit@developpement-durable.gouv.fr =\> Sponsor des projets |
| MOE prestataire | Jusqu'en novembre 2021 : Klee Group |
|  | \- Matthieu Georges (Chef de projet) matthieu.georges@kleegroup.com |
|  | \- Olivier Venot (Directeur de projet) olivier.venot@kleegroup.com |


<a name="Historique"></a>
## Historique

| Date | Références | Type d'évolution | Fichier |
|------|------------|------------------|---------|
| 26/02/2020 | Mantis 0052083 | Évolution mineure des courriers | \[[sireines_mantis_0052083.pdf](uploads/431f99b1ec1a87bc71962a80758af481/sireines_mantis_0052083.pdf)\] |
| 15/09/2020 | Mantis 0056137 | Demande de mise à jour des courriers | \[[sireines_mantis_0056137.pdf](uploads/d67a07eca5a5a248db13b6ebc71e6a0b/sireines_mantis_0056137.pdf)\] |
| 22/10/2020 | Mantis 0056773 | Correction de courriers | \[[sireines_mantis_0056773.pdf](uploads/e855689ab130403e40ada37f2c93848f/sireines_mantis_0056773.pdf)\] |
| 03/05/2021 | Mantis 0059550 | Extractions=erreur eclipse | \[[sireines_mantis_0059550.pdf](uploads/dbf64e820c7296237e5c5eafbe9dca45/sireines_mantis_0059550.pdf)\] |
| 30/09/2021 | Mantis 0061626 | Anomalie dans livraison 2.5.6 | \[[sireines_mantis_0061626.pdf](uploads/ac13ef2303459e85a76ccba84ce9da96/sireines_mantis_0061626.pdf)\] |

<a name="Site"></a>
## Accès au site

[sites](Sireines/sites)

<a name="Cerbere"></a>
## Cerbère

[cerbère](Sireines/Cerbère)

<a name="Version"></a>
## Version

[version](Sireines/Version)

<a name="Doc"></a>
## Documentations

### Guide du chef de produit :
 * [Recette d'une livraison sur poste (Docker)](Recette/LivraisonSurPosteDocker)
 * Recette d'une livraison sur environnement IAAS
 * [Connexion base de données](Recette/ConnexionBDD_Docker)

### Fonctionnel :

### Technique :
  * [Document d'installation et d'exploitation (IAAS)](Technique/DocumentationInstallationEtExploitation)
    
### Reversing
  * [Application](Reversing/App)
  * [Base de données](Reversing/Database)

### Deploiement
  * [Procedure de déploiement applicatif ](Technique/DeploiementApplicatif)
```


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

`````

</details>


---

### 📄 `si/siss.analysis.md` [16.677 octets]
<a id="si-siss-analysis-md"></a> [↩ Retour à l'arborescence](#tree-si-siss-analysis-md)

> **Chemin relatif** : `si/siss.analysis.md`  
> **Taille** : 16.677 octets  
> **Lignes** : 511  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (511 lignes) - Cliquer pour déplier</summary>

````markdown
# ?? Analyse complète du projet `siss`

> ? Basé uniquement sur les fichiers fournis  
> ??? Projet localisé : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\siss`  
> ?? Version actuelle : **6.4.0** (`VERSION`)

---

## ?? Table des matières

- [1. Vue densemble fonctionnelle](#1-vue-densemble-fonctionnelle)
  - [1.1 Objectif du système](#11-objectif-du-système)
  - [1.2 Acteurs](#12-acteurs)
  - [1.3 Cas dusage principaux](#13-cas-dusage-principaux)
  - [1.4 Workflow métier](#14-workflow-métier)
    - [Diagramme de séquence : Authentification SAML2 vs mode Test](#diagramme-de-séquence--authentification-saml2-vs-mode-test)
    - [Diagramme détats : Cycle de vie dun dossier social](#diagramme-détats--cycle-de-vie-dun-dossier-social)
    - [Diagramme de cas dusage (UML)](#diagramme-de-cas-dusage-uml)
- [2. Architecture technique](#2-architecture-technique)
  - [2.1 Vue C4  Contexte système](#21-vue-c4--contexte-système)
  - [2.2 Vue C4  Conteneurs](#22-vue-c4--conteneurs)
  - [2.3 Vue C4  Composants](#23-vue-c4--composants)
  - [2.4 Déploiement](#24-déploiement)
- [3. Configuration & Paramétrage](#3-configuration--paramétrage)
  - [3.1 Fichiers de configuration](#31-fichiers-de-configuration)
  - [3.2 Initialisation de la base de données](#32-initialisation-de-la-base-de-données)
  - [3.3 Génération de la clé de chiffrement](#33-génération-de-la-clé-de-chiffrement)
- [4. Sécurité](#4-sécurité)
  - [4.1 Authentification](#41-authentification)
  - [4.2 Chiffrement des données](#42-chiffrement-des-données)
  - [4.3 Gestion des droits (`access.properties`)](#43-gestion-des-droits-accessproperties)
  - [4.4 Proxy & isolation réseaux](#44-proxy--isolation-réseaux)
- [5. CI/CD & Livraison](#5-cicd--livraison)
  - [5.1 Pipeline GitLab CI](#51-pipeline-gitlab-ci)
  - [5.2 Stratégie de versioning & déploiement](#52-stratégie-de-versioning--déploiement)
- [6. Dette technique & points dattention](#6-dette-technique--points-dattention)
- [7. Annexes](#7-annexes)
  - [7.1 Arborescence complète](#71-arborescence-complète)
  - [7.2 Références PlantUML utilisées](#72-références-plantuml-utilisées)

---

## 1. Vue densemble fonctionnelle

### 1.1 Objectif du système

Le système **SISS** (nom interne non explicité, probablement *Système dInformation Social ou Statistique*, vu les champs `departement`, `mefiAppliAdc`, `ref_utilisateur.csv`) est une application web Java/Tomcat orientée :

- Gestion de **dossiers sociaux** (avec batch de nettoyage),
- Authentification centralisée (SSO SAML2) ou locale (mode `TEST`),
- Stockage sécurisé de pièces jointes (via AWS ou autre),
- Envoi de mails (SMTP ou API `Hedwige`),
- Synchro avec des référentiels (via CSV dinitialisation),
- Chiffrement sensible des données utilisateur.

> ? **Indice** : présence de `ref_utilisateur.csv`, `postalCode`, `departement`, `mefiAppliAdc=[SISS,ANAIS]` ? usage dans contexte ministériel (DIN/DD).  
> ?? Aucun domaine métier explicite nest fourni ? lanalyse reste **structurale & technique**.

---

### 1.2 Acteurs

| Acteur | Description | Mode dinteraction |
|--------|-------------|---------------------|
| **Utilisateur final** | Agent ou administrateur utilisant linterface web | Authentifié via SSO (SAML2) ou stub LDAP (mode `TEST`) |
| **Administrateur SI** | Responsable déploiement, configuration, maintenance | Via `application.properties`, `access.properties`, Docker, CI |
| **Système SSO** | Fournit lidentité (SAML2 IdP) | Metadata + certificats (sign/decrypt) |
| **PostgreSQL** | Base de données persistante | Initialisée avec schéma `siss` et données CSV |
| **Stockage PJ** | AWS S3 (ou similaire) | Clé daccès, bucket, région dans props |
| **API Hedwige / SMTP** | Envoi de notifications | Token OAuth2 (Hedwige) ou SMTP simple |

---

### 1.3 Cas dusage principaux

```plantuml
@startuml Cas d'usage SISS
left to right direction
actor Utilisateur as U
actor Admin as A

rectangle "SISS" {
  U --> (Se connecter)
  U --> (Consulter/modifier un dossier social)
  U --> (Déposer une pièce jointe)
  U --> (Recevoir une notification)

  A --> (Configurer l'application)
  A --> (Déployer une version)
  A --> (Gérer les utilisateurs)
  A --> (Chiffrer/déchiffrer les données)
}

(Se connecter) .> (Authentification SAML2) : inclut
(Se connecter) .> (Authentification locale) : inclut [mode TEST]
(Configurer l'application) .> (Éditer application.properties) : réalise
(Gérer les utilisateurs) .> (Mettre à jour ref_utilisateur.csv) : réalise
(Gérer les utilisateurs) .> (Éditer access.properties) : réalise
@enduml
```

---

### 1.4 Workflow métier

#### Diagramme de séquence : Authentification SAML2 vs mode Test

```plantuml
@startuml Authentification SISS
actor User
participant "SISS App" as App
participant "IdP (SAML2)" as IdP
participant "Stub LDAP" as Stub

alt Mode production (authentication.mode ? TEST)
  User -> App: GET /
  App -> IdP: Redirige vers IdP (SAML AuthnRequest)
  IdP --> User: Formulaire login
  User --> IdP: Identifiants
  IdP --> App: POST Assertion (SAMLResponse)
  App -> App: Vérifie signature, chiffre/déchiffre attributs
  App --> User: Session créée
else Mode test (authentication.mode = TEST)
  User -> App: POST /login (user/pw)
  App -> Stub: Lit bloc authentication.stubLdap.[user].*
  Stub --> App: Retourne attributs simulés
  App --> User: Session créée (sans réseau)
end
@enduml
```

#### Diagramme détats : Cycle de vie dun dossier social

Daprès les batchs présents :

- `siss.batch.finDelegation=0 15 0 * * *` ? exécution quotidienne à 00h15  
- `siss.batch.suppressionDossiersSociauxInactifs=0 30 0 * * *` ? à 00h30

```plantuml
@startuml Cycle dossier social
[*] --> Actif : Création / Mise à jour
Actif --> En délégué : Délégation activée
En délégué --> Actif : Fin de délégation (batch 00:15)
Actif --> Inactif : Pas de mise à jour > seuil
Inactif --> [*] : Suppression (batch 00:30)
@enduml
```

#### Diagramme de cas dusage (UML)

```plantuml
@startuml
left to right direction
actor "Utilisateur" as U
actor "Admin" as A

usecase "S'authentifier" as UC1
usecase "Gérer un dossier social" as UC2
usecase "Déposer une pièce jointe" as UC3
usecase "Recevoir une alerte" as UC4
usecase "Configurer SISS" as UC5
usecase "Déployer SISS" as UC6

U --> UC1
U --> UC2
U --> UC3
U --> UC4

A --> UC5
A --> UC6

UC1 .> UC5 : <<inclut>> Définir mode d'auth
UC3 .> UC5 : <<inclut>> Configurer stockage PJ
UC4 .> UC5 : <<inclut>> Configurer mail
@enduml
```

---

## 2. Architecture technique

### 2.1 Vue C4  Contexte système

```plantuml
@startuml C4-Context
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

Person(admin, "Administrateur SI", "Déploie, configure, maintient")
Person(user, "Utilisateur final", "Utilise l'application web")

System_Boundary(c1, "SISS") {
  System(siss, "SISS", "Application web Java/Tomcat pour gestion de dossiers sociaux")
}

System_Ext(sso, "SSO SAML2 IdP", "Authentification centrale (ex: Keycloak, CAS)")
System_Ext(postgres, "PostgreSQL", "Base de données")
System_Ext(aws, "Stockage PJ (AWS S3)", "Pièces jointes chiffrées")
System_Ext(mail, "Service Mail (Hedwige ou SMTP)", "Notifications")

Rel(user, siss, "Utilise via navigateur", "HTTPS")
Rel(siss, sso, "Échange SAML2", "HTTPS")
Rel(siss, postgres, "Lecture/écriture", "JDBC")
Rel(siss, aws, "Upload/download PJ", "HTTPS / SDK")
Rel(siss, mail, "Envoi notifications", "API / SMTP")

Rel(admin, siss, "Déploie/configure", "Docker, GitLab CI")
@enduml
```

---

### 2.2 Vue C4  Conteneurs

```plantuml
@startuml C4-Container
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

Person(user, "Utilisateur")

System_Boundary(c1, "SISS") {
  Container(app, "siss-app", "Tomcat 9 + Java 11", "Application Spring Boot (war)")
  ContainerDb(db, "siss-db", "PostgreSQL 13.19", "Données métier + référentiels")
}

Rel(user, app, "HTTPS", "Navigateur ? Tomcat")
Rel(app, db, "JDBC", "spring.datasource.*")
Rel(app, db, "Initialisation", "ref_utilisateur.csv")

Container_Ext(proxy, "Proxy (proxybl-m.edcs.fr)", "Contrôle sortant")
Rel(app, proxy, "Accès sortant (HTTP/HTTPS)", "JAVA_OPTS proxy")

Note right of app
  Montages :
  - /app/conf/application.properties
  - /app/conf/access.properties
  - /app/conf/init_referentiels/*.csv
  - /app/data (uploads)
  - /app/logs
end note
@enduml
```

---

### 2.3 Vue C4  Composants (dans `siss-app`)

```plantuml
@startuml C4-Component
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

Container_Boundary(app, "siss-app (Tomcat)") {
  Component(spring, "Spring Boot", "Framework applicatif")
  Component(security, "Auth SAML2 / Stub", "com.siss.server.security.impl.*")
  Component(mail, "MailServiceImpl", "com.siss.core.service.common.impl.MailServiceImpl")
  Component(batch, "Batchs métier", "suppressionDossiersInactifs, finDelegation")
  Component(crypto, "Chiffrement données", "siss.encryption.key")
  Component(storage, "PJ Stockage", "AWS SDK ou local")
}

Rel(spring, security, "Utilise")
Rel(spring, mail, "Appelle")
Rel(spring, batch, "Planifie (Cron)")
Rel(spring, crypto, "Chiffre/déchiffre les données sensibles")
Rel(spring, storage, "Gère les pièces jointes")

Note right of crypto
  Clé unique générée via :
  java -jar siss-generate-key.jar [cle]
end note
@enduml
```

---

### 2.4 Déploiement

Deux modes :

| Type | `docker-compose.dev.yml` | `docker-compose.run.yml` |
|------|---------------------------|---------------------------|
| Image | Buildée localement (`conf/dev/Dockerfile`) | Tirée depuis `eu.gcr.io/dpnm3-lab/siss:6.3.1` |
| Sources | Locales (`*.tar.bz2` dans `conf/dev/`) | Téléchargées via Nexus Silicom (`curl -u user:pwd`) |
| Usage | Développement / intégration | Recette, préprod, prod |

```plantuml
@startuml Déploiement SISS
node "Poste développeur" {
  artifact "conf/dev/*.tar.bz2" as sources
  artifact "Dockerfile (dev)" as df_dev
  artifact "docker-compose.dev.yml" as dc_dev
  [Docker Engine] as docker
  docker --> sources
  docker --> df_dev
  docker --> dc_dev
  docker -down-> [siss-app (dev)]
  docker -down-> [PostgreSQL (dev)]
}

node "Environnement cible (recette/prod)" {
  cloud "Registry GCR" {
    artifact "siss:6.3.1" as image_gcr
  }
  [Kubernetes / VM] as infra
  infra --> image_gcr
  infra --> "application.properties"
  infra --> "access.properties"
  infra --> "ref_utilisateur.csv"
  infra -down-> [siss-app (run)]
  infra -down-> [PostgreSQL (prod)]
}
@enduml
```

---

## 3. Configuration & Paramétrage

### 3.1 Fichiers de configuration

| Fichier | Rôle | Monté dans container ? |
|--------|------|------------------------|
| `application.properties` | Config principale (DB, SSO, mail, batch, crypto) | ? `/app/conf/application.properties` |
| `access.properties` | Droits par utilisateur/rôle | ? `/app/conf/access.properties` |
| `ref_utilisateur.csv` | Données initiales utilisateurs | ? `/app/conf/init_referentiels/ref_utilisateur.csv` |
| `license.properties` | Clé de licence (optionnel) | `/app/conf/license.properties` |

> ?? **À noter** : `.gitignore` exclut `application.properties` et `access.properties` ? **sensibles**.

---

### 3.2 Initialisation de la base de données

SQL fourni dans `README.md` :

```sql
ALTER ROLE ${POSTGRES_USER} LOGIN NOSUPERUSER INHERIT NOCREATEROLE NOREPLICATION PASSWORD '${POSTGRES_PASSWORD}';
CREATE SCHEMA siss AUTHORIZATION ${POSTGRES_USER};
```

? Le schéma `siss` est créé, et lutilisateur PostgreSQL est restreint (bonne pratique).

Les données initiales viennent de `ref_utilisateur.csv`.

> ? **Point manquant** : pas de script SQL complet fourni ? initialisation probable via import CSV côté app.

---

### 3.3 Génération de la clé de chiffrement

Commande **obligatoire** à linstallation :

```bash
docker exec -it siss-app \
  java -jar /app/siss/lib/version/siss-generate-key.jar "ma_phrase_secrete"
```

? Sortie = valeur pour `siss.encryption.key` dans `application.properties`.

?? **Avertissement** : changement de clé ? impossibilité de lire les données existantes.

---

## 4. Sécurité

### 4.1 Authentification

Trois modes détectables :

| Paramètre | Valeur | Description |
|----------|--------|-------------|
| `authentication.mode` | `TEST` | Mode stub LDAP (développement) |
| `authentication.mode` | *non précisé* | Probablement `SAML2` en production |
| Bloc `authentication.saml.*` | renseigné | Active SSO SAML2 |

- **Stub LDAP** : blocs répétables par utilisateur (`authentication.stubLdap.toto.*`)
- **SAML2** : nécessite :
  - `metadata.location`
  - Certificat de signature + clé privée
  - Certificat de déchiffrement + clé privée

---

### 4.2 Chiffrement des données

- `siss.encryption.key` : clé symétrique **obligatoire**
- Utilisé pour :
  - Données en base (ex: coordonnées, adresses ?)
  - Pièces jointes (stockées chiffrées)

? Fonctionne comme un **secret applicatif**, analogue à `Jasypt` ou `Spring Cloud Config Server` encrypt.

---

### 4.3 Gestion des droits (`access.properties`)

Fichier requis (exclu de Git) ? contient probablement :

- Rôles utilisateurs
- Permissions CRUD par entité
- ACL sur dossiers

Non visible dans les fichiers fournis ? hypothèse uniquement.

---

### 4.4 Proxy & isolation réseaux

- Proxy forcé : `proxybl-m.edcs.fr:3128`
- `NO_PROXY` pour services internes (`api.din.*`)
- Variables Java injectées :
  ```bash
  -Dhttp.proxyHost=...
  -Dhttps.proxyHost=...
  -Dhttp.nonProxyHosts=...
  ```

? Conforme aux contraintes réseau ministérielles.

---

## 5. CI/CD & Livraison

### 5.1 Pipeline GitLab CI

```plantuml
@startuml Pipeline CI
skinparam wrapWidth 200
skinparam sequenceMessageAlign center

[*] --> build_docker : VERSION modifié sur 'develop'
build_docker --> deploy_recette : merge sur 'recette'
deploy_recette --> deploy_preprod : merge sur 'preprod'
deploy_preprod --> deploy_prod : merge sur 'master'

note right of build_docker
  Utilise Kaniko ? build image
  Push sur $CI_REGISTRY_IMAGE:VERSION
end note

note right of deploy_recette
  Met à jour siss-infra/recette/vars/versions.yml
  via yaml-commit (GitOps)
end note
@enduml
```

? **GitOps pur** : déploiement = commit dans repo `siss-infra`.

---

### 5.2 Stratégie de versioning & déploiement

- Version stockée dans fichier `VERSION` (ex: `6.4.0`)
- CI déclenchée **uniquement si `VERSION` change**
- Image taguée avec `:VERSION` et `:latest`
- Déploiement = mise à jour dun fichier YAML dans `siss-infra`

? Bonne pratique : version explicite, immuable, traçable.

---

## 6. Dette technique & points dattention

| Risque | Localisation | Commentaire |
|--------|--------------|-------------|
| ?? Clé de chiffrement non versionnée | `application.properties` | Doit être injectée via secret manager (ex: Vault, GCP Secret Manager) |
| ??? Données initiales en CSV | `ref_utilisateur.csv` | Fragile ; pas de schéma ni validation |
| ?? Mode `TEST` activable en prod | `authentication.mode=TEST` | Danger si mal configuré ? contournement SSO |
| ?? Pas de tests automatisés visibles | Aucun `test/` | Risque élevé de régression |
| ?? Dockerfile dupliqué | `conf/dev/` vs `conf/run/` | Logique quasi identique ? factorisable (multi-stage ?) |
| ??? Pas de health-check | Aucun `HEALTHCHECK` dans Dockerfile | Difficile monitoring en production |
| ? Session HTTP non sécurisée | `server.servlet.session.cookie.secure=false` | À activer en HTTPS |

---

## 7. Annexes

### 7.1 Arborescence complète

```text
siss/
+-- conf/
¦   +-- dev/
¦   ¦   +-- Dockerfile
¦   ¦   +-- entrypoint.sh *(non fourni)*
¦   +-- run/
¦       +-- Dockerfile
¦       +-- entrypoint.sh *(non fourni)*
+-- .env.sample
+-- .gitignore
+-- .gitlab-ci.yml
+-- README.md
+-- VERSION
+-- application.sample.properties
+-- docker-compose.dev.yml
+-- docker-compose.run.yml
```

? Les `entrypoint.sh` ne sont pas fournis ? boîte noire (initialisation probable à louverture).

---

### 7.2 Références PlantUML utilisées

Pour rendre ces diagrammes :

- Extension **PlantUML** dans VS Code/Obsidian
- Serveur local ou online (ex: `@startuml ... @enduml`)
- Pour C4 : inclure `!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_XXX.puml`


````

</details>


---

### 📄 `si/siss.md` [35.518 octets]
<a id="si-siss-md"></a> [↩ Retour à l'arborescence](#tree-si-siss-md)

> **Chemin relatif** : `si/siss.md`  
> **Taille** : 35.518 octets  
> **Lignes** : 895  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (895 lignes) - Cliquer pour déplier</summary>

`````markdown
﻿# Projet : siss

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\siss`

**Fichiers** : 10 fichiers non-binaires

## 📁 Arborescence des fichiers

├── **conf/**
│   ├── **dev/**
│   │   └── <a id="tree-conf-dev-Dockerfile"></a>[Dockerfile](#conf-dev-Dockerfile) *(1.545 octets)*
│   └── **run/**
│       └── <a id="tree-conf-run-Dockerfile"></a>[Dockerfile](#conf-run-Dockerfile) *(1.931 octets)*
├── <a id="tree--env-sample"></a>[.env.sample](#-env-sample) *(820 octets)*
├── <a id="tree--gitignore"></a>[.gitignore](#-gitignore) *(96 octets)*
├── <a id="tree--gitlab-ci-yml"></a>[.gitlab-ci.yml](#-gitlab-ci-yml) *(3.875 octets)*
├── <a id="tree-README-md"></a>[README.md](#README-md) *(4.441 octets)*
├── <a id="tree-VERSION"></a>[VERSION](#VERSION) *(5 octets)*
├── <a id="tree-application-sample-properties"></a>[application.sample.properties](#application-sample-properties) *(11.928 octets)*
├── <a id="tree-docker-compose-dev-yml"></a>[docker-compose.dev.yml](#docker-compose-dev-yml) *(1.279 octets)*
└── <a id="tree-docker-compose-run-yml"></a>[docker-compose.run.yml](#docker-compose-run-yml) *(1.237 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `.env.sample` [820 octets]
<a id="-env-sample"></a> [↩ Retour à l'arborescence](#tree--env-sample)

> **Chemin relatif** : `.env.sample`  
> **Taille** : 820 octets  
> **Lignes** : 9  
> **Type** : text

```text
HTTP_PROXY="http://proxybl-m.edcs.fr:3128" # Proxy à utiliser, exemple : http://proxy.intra:8080
NO_PROXY="api.din.developpement-durable.gouv.fr, authentification.din.developpement-durable.gouv.fr" # Liste des domaines à ne pas passer par le proxy, exemple : localhost,

JAVA_OPTS="$JAVA_OPTS -Dspring.config.location=classpath:/application.properties,file:/app/conf/application.properties -Dhttp.proxyHost=proxybl-m.edcs.fr -Dhttp.proxyPort=3128 -Dhttps.proxyHost=proxybl-m.edcs.fr -Dhttps.proxyPort=3128 -Dhttp.nonProxyHosts='api.din.developpement-durable.gouv.fr'"
CATALINA_OPTS="$CATALINA_OPTS -Duser.timezone=Europe/Paris"

POSTGRES_USER= # Nom d'utilisateur de la base de données PostgreSQL
POSTGRES_PASSWORD= # Mot de passe de la base de données PostgreSQL
POSTGRES_DB= # Nom de la base de données PostgreSQL
```


---

### 📄 `.gitignore` [96 octets]
<a id="-gitignore"></a> [↩ Retour à l'arborescence](#tree--gitignore)

> **Chemin relatif** : `.gitignore`  
> **Taille** : 96 octets  
> **Lignes** : 9  
> **Type** : text

```text
application.properties
access.properties
logs-siss
logs-tomcat
data
pgdata
*.env
*.tar.bz2
*.csv
```


---

### 📄 `.gitlab-ci.yml` [3.875 octets]
<a id="-gitlab-ci-yml"></a> [↩ Retour à l'arborescence](#tree--gitlab-ci-yml)

> **Chemin relatif** : `.gitlab-ci.yml`  
> **Taille** : 3.875 octets  
> **Lignes** : 125  
> **Type** : yaml

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (125 lignes) - Cliquer pour déplier</summary>

```yaml
stages:                                                                                  
  - build_docker
  - deploy_recette
  - deploy_preprod
  - deploy_prod

.default-deploy: &default_deploy
  image:
    name: "varkal/yaml-commiter:1.0.0"
    entrypoint: [""]
  resource_group: infra-repo

.default-variables: &default_variables
  GIT_DEPTH: "0"
  INFRA_KEY: ".appVersion"
  INFRA_REPO_NAME: "siss-infra"

.default_before_script:
  before_script: &default_before_script
    # 1) Compute the version from VERSION file
    - VERSION="$(grep -Eo '^[vV]?[0-9]+\.[0-9]+\.[0-9]+' VERSION | head -n1)"
    - VERSION=":${VERSION}"
    # 2) Prepare key name from ".appVersion" -> "appVersion"
    - KEY_NAME="${INFRA_KEY#.}"
    # 3) Clone the infra repo and check current value
    - rm -rf "$INFRA_REPO_NAME"
    - git clone --depth 1 "https://ci:${GITLAB_TOKEN}@gitlab-forge.din.developpement-durable.gouv.fr/$CI_PROJECT_NAMESPACE/$INFRA_REPO_NAME.git"
    - |
      if grep -qE "^${KEY_NAME}:\s*['\"]?${VERSION}['\"]?\s*$" "${INFRA_REPO_NAME}/${VALUES_FILE}"; then
        echo "No change needed (${KEY_NAME} already ${VERSION}). Skipping commit."
        exit 0
      else
        echo "Will update ${KEY_NAME} to ${VERSION} in ${VALUES_FILE}"
      fi

.default_deploy_script:
  script: &default_deploy_script
    - |
      echo "Updating $INFRA_REPO_NAME with $VERSION";
      rm -rf "$INFRA_REPO_NAME";
      yaml-commit \
      --url "https://ci:${GITLAB_TOKEN}@gitlab-forge.din.developpement-durable.gouv.fr/$CI_PROJECT_NAMESPACE/$INFRA_REPO_NAME.git" \
      --name $INFRA_REPO_NAME \
      --key $INFRA_KEY \
      --value $VERSION \
      --file $VALUES_FILE \
      --user "$GITLAB_USER_NAME" \
      --email "$GITLAB_USER_EMAIL"

# ---------- BUILD on 'develop' when VERSION changes ----------
build_docker:
  stage: build_docker
  rules:
    - if: '$CI_COMMIT_BRANCH == "develop"'
      changes:
        - VERSION
  image:
    name: gcr.io/kaniko-project/executor:debug
    entrypoint: [""]
  before_script:
    - VERSION="$(grep -Eo '^[vV]?[0-9]+\.[0-9]+\.[0-9]+' VERSION | head -n1)"
    - echo "Building version:$VERSION"
  script:
    - |
      GOOGLE_APPLICATION_CREDENTIALS=$GCP_IMAGE_PUBLISHER_SA /kaniko/executor \
        --context $CI_PROJECT_DIR \
        --dockerfile $CI_PROJECT_DIR/conf/run/Dockerfile \
        --destination $CI_REGISTRY_IMAGE:$VERSION \
        --destination $CI_REGISTRY_IMAGE:latest \
        --build-arg SISS_VERSION=$VERSION \
        --build-arg SILICOM_USER="$SILICOM_USER" \
        --build-arg SILICOM_PASSWORD="$SILICOM_PASSWORD"
  tags:
    - gcp

# ---------- RECETTE (on merge into 'recette' and VERSION changed) ----------
deploy_recette:
  <<: *default_deploy
  stage: deploy_recette
  rules:
    - if: '$CI_COMMIT_BRANCH == "recette"'
      changes: [VERSION]
      when: on_success
  variables:
    <<: *default_variables
    VALUES_FILE: "recette/vars/versions.yml"
  before_script: *default_before_script
  script: *default_deploy_script
  resource_group: infra-repo
  tags:
    - gcp

# ---------- PREPROD (merge on 'preprod') ----------
deploy_preprod:
  <<: *default_deploy
  stage: deploy_preprod
  rules:
    - if: '$CI_COMMIT_BRANCH == "preprod"'
      changes: [VERSION]
      when: on_success
  variables:
    <<: *default_variables
    VALUES_FILE: "preprod/vars/versions.yml"
  before_script: *default_before_script
  script: *default_deploy_script
  resource_group: infra-repo
  tags:
    - gcp

# ---------- PROD (merge on 'master') -----------
deploy_prod:
  <<: *default_deploy
  stage: deploy_prod
  rules:
    - if: '$CI_COMMIT_BRANCH == "master"'
      changes: [VERSION]
      when: on_success
  variables:
    <<: *default_variables
    VALUES_FILE: "prod/vars/versions.yml"
  before_script: *default_before_script
  script: *default_deploy_script
  resource_group: infra-repo
  tags:
    - gcp
```

</details>


---

### 📄 `application.sample.properties` [11.928 octets]
<a id="application-sample-properties"></a> [↩ Retour à l'arborescence](#tree-application-sample-properties)

> **Chemin relatif** : `application.sample.properties`  
> **Taille** : 11.928 octets  
> **Lignes** : 195  
> **Type** : text

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (195 lignes) - Cliquer pour déplier</summary>

```text
##################################################################################################################
##################################################################################################################
#                                 PARAMETRES D'ENVIRONNEMENT SPECIFIQUES                                         #
##################################################################################################################
##################################################################################################################


##################################################################################################################
# Database                                                                                                       #
##################################################################################################################
spring.datasource.url=jdbc:postgresql://db:5432/siss
spring.datasource.username=
spring.datasource.password=
spring.jpa.show-sql=false


##################################################################################################################
# Authentification                                                                                               #
##################################################################################################################
# SSO by SAML2
authentication.mode=TEST
# location for metadata (url or path)
authentication.saml.metadata.location=
# location of certificate sign (path)
authentication.saml.sign.certificate.location=
# Private key for certificate sign (path)
authentication.saml.sign.private-key.location=
# location of certificate for decryption (path)
authentication.saml.decrypt.certificate.location=
# Private key for certificate for decryption (path)
authentication.saml.decrypt.private-key.location=


# BLOC À UTILISER ET À RÉPÉTER AUTANT DE FOIS QUE D'UTILISATEURS SOUHAITÉS POUR LE MODE D'AUTHENTIFICATION 'TEST'
#authentication.stubLdap.toto.dn=uid=toto,ou=people,ou=ro,o=silicom,c=fr
#authentication.stubLdap.toto.cn=cypress Ctr
#authentication.stubLdap.toto.sn=Ctr
#authentication.stubLdap.toto.givenName=cypressCtr
#authentication.stubLdap.toto.mail=toto@domain.com

#authentication.stubLdap.toto.telephoneNumber=+33 1 23 45 67 89
#authentication.stubLdap.toto.mobile=+33 6 23 45 67 89
#authentication.stubLdap.toto.mefiAppliAdc=[SISS,ANAIS]
#authentication.stubLdap.toto.personalTitle =Mme
#authentication.stubLdap.toto.postalAddress=SAINT-DENIS DE LA REUNION-VICTOIRE RUE DE LA VICTOIRE
#authentication.stubLdap.toto.postalCode=35700
#authentication.stubLdap.toto.localityName=Rennes
#authentication.stubLdap.toto.departement=35

##################################################################################################################
# PJ STOCKAGE                                                                                                    #
##################################################################################################################
siss.pj-stockage.mode=AWS
siss.aws.bucketname=
siss.aws.endpoint=
siss.aws.accessKey=
siss.aws.secretKey=
siss.aws.region=

##################################################################################################################
# Configuration du serveur de mail                                                                               #
##################################################################################################################
# Mode d'envoi de mail à utiliser, valeurs possibles : SMTP, HEDWIGE
service.mail.mode=HEDWIGE
# Expéditeur des mails
spring.mail.properties.mail.smtp.from=
# Serveur d'envoi de mail
spring.mail.host=
# Port du serveur d'envoi de mail
spring.mail.port=
# Nom du compte pour l'envoi de mail
spring.mail.username=
# Mot de passe du compte pour l'envoi de mail
spring.mail.password=
# Ce préfixe apparait en sujet des mails émis par l'application
service.mail.prefix=[SISS]
spring.mail.test-connection=false
spring.mail.properties.mail.smtp.socketFactory.class=javax.net.DefaultSocketFactory
# Adresse destinataire de l'ensemble des mails émis par l'application.
# Ce paramètre ne peut être utile qu'en recette, si on ne souhaite pas envoyer de mails aux utilisateurs non concernés par la recette.
service.mail.test-destinataire=
#Limitation de la taille des mails (en Ko). Si la valeur est nulle alors pas de limitation de taille
service.mail.taille-maximale-ko=
#Liste des domaines autorisés séparés par une virgule. Si la valeur est nulle alors pas de restriction de domaine
service.mail.domaines-autorises=

mail.hedwige.url="https://api.din.developpement-durable.gouv.fr/api/hedwige/1.1.0"
mail.hedwige.token.url="https://api.din.developpement-durable.gouv.fr/token"
mail.hedwige.token.clientId=
mail.hedwige.token.clientSecret=
# Pour les tests uniquement. Force l'utilisation d'une unique adresse e-mail.
#service.mail.test-destinataire=projet-siss@silicom.fr

##################################################################################################################
# CORS (Cross-Origin Resource Sharing)                                                                           #
##################################################################################################################
# Indiquer la ou les URL racines possibles (séparées par des virgules)
cors.allowedOrigins=


##################################################################################################################
# Traitements batchs                                                                                             #
##################################################################################################################
# Expression CRON indiquant quand le batch de fin de délégation doit être exécuté (00h15 par défaut)
siss.batch.finDelegation=0 15 0 * * *
# Expression CRON indiquant quand le batch de suppression des dossiers sociaux inactifs doit être exécuté (00h30 par défaut)
siss.batch.suppressionDossiersSociauxInactifs=0 30 0 * * *


##################################################################################################################
##################################################################################################################
#                                 PARAMETRES D'ENVIRONNEMENT SECONDAIRES                                         #
##################################################################################################################
##################################################################################################################


##################################################################################################################
# Dossier des fichiers contenant les libellés des champs                                                         #
##################################################################################################################
# emplacement des fichiers de traduction pour les messages et libellés côté backend
messages.basenames=file:
# Vide si aucune surcharge de libellés
# Sinon, contient le chemin vers le dossier contenant les fichiers de libellés. Ex : /var/opt/application/sss/siss/conf/i18n
messages.front.location=/app/conf/i18n

##################################################################################################################
# Configuration des fonctionnalités à activer                                                                    #
##################################################################################################################
siss.license.location=/app/conf/license.properties

############################################
# Gestion des droits des utilisateurs
############################################
siss.access.location=/app/conf/access.properties

##################################################################################################################
# Données pour initialiser les référentiels                                                                      #
##################################################################################################################
siss.csv.referentiels.dir=/app/conf/init_referentiels

##################################################################################################################
#                                                                                                                #
##################################################################################################################
spring.servlet.multipart.location=/app/data/siss_upload

##################################################################################################################
##################################################################################################################
#                                 PARAMETRES TECHNIQUES                                                          #
##################################################################################################################
##################################################################################################################


##################################################################################################################
# Configuration des logs                                                                                         #
##################################################################################################################
logging.file=/app/logs/siss.log
# Configuration de la taille maximale du fichier de log avant archivage
logging.file.max-size=10MB
# Configuration de la taille maximale d archives de log avant suppression
logging.file.total-size-cap=10MB
logging.level.root=WARN
logging.level.com.siss.server=INFO
logging.level.fr.minefi=INFO
logging.level.com.siss.core.service=INFO
# a decommenter pour debug authentification
# logging.level.com.siss.server.security.impl=DEBUG
logging.level.com.siss.core.service.common.impl.MailServiceImpl=INFO
logging.level.com.siss.server.service.synchro.portable.RestServiceImpl=INFO

# traces pour les états prédéfinis
logging.level.com.siss.core.service.statistiques.etats.impl=INFO

#########################
# FORMAT PJ ACCEPTES    #
#########################
# Vide pour aucune restriction sur le format des pj
# sinon format en minuscule (séparés par une virgule si plusieurs). Ex : docx,pdf,xls
siss.format_piece_jointe=

##################################################################################################################
# Session HTTP                                                                                                   #
##################################################################################################################
# pas de cookie "secure" si on veut pouvoir continuer à fonctionner en HTTP en local
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.secure=false
server.servlet.session.timeout=1h

##################################################################################################################
# Chiffrement des données                                                                                        #
# Paramètre auto-configuré lors de la 1ere installation                                                          #
# Une modification ultérieure de ce paramètre entraine une impossibilité pour l'application de déchiffrée        #
# les données en BDD et les pièces jointes                                                                       #
##################################################################################################################
siss.encryption.key=

```

</details>


---

### 📄 `conf/dev/Dockerfile` [1.545 octets]
<a id="conf-dev-Dockerfile"></a> [↩ Retour à l'arborescence](#tree-conf-dev-Dockerfile)

> **Chemin relatif** : `conf/dev/Dockerfile`  
> **Taille** : 1.545 octets  
> **Lignes** : 33  
> **Type** : dockerfile

```dockerfile
FROM tomcat:9.0.82-jdk11
ARG http_proxy
ARG https_proxy
ARG SISS_VERSION
ENV DEBIAN_FRONTEND=noninteractive

# Installation des dépendances
RUN apt update && apt install -y bzip2 locales
# Met à jour les locales
RUN sed -i -e 's/# fr_FR.UTF-8 UTF-8/fr_FR.UTF-8 UTF-8/' /etc/locale.gen && \
    dpkg-reconfigure --frontend=noninteractive locales && \
    update-locale LANG=fr_FR.UTF-8
ENV LANG=fr_FR.UTF-8
ENV LC_ALL=fr_FR.UTF-8
# Récupération des sources à jour depuis les fichiers locaux
COPY ./siss-conf-mtect-$SISS_VERSION.tar.bz2 /tmp/conf.tar.bz2
COPY ./siss-webapp-$SISS_VERSION.tar.bz2 /tmp/dist.tar.bz2
# Création des dossiers applicatifs
RUN mkdir -p /app /app/siss /app/conf /app/conf/init_referentiels
# Extraction des sources et du paramétrage
RUN tar -xjf /tmp/dist.tar.bz2 --strip-components=1 -C /app/siss
RUN tar -xjf /tmp/conf.tar.bz2 --strip-components=1 -C /app/conf siss.conf/
RUN tar -xvf /tmp/conf.tar.bz2 --strip-components=1 -C /app/conf/init_referentiels/ siss.init_referentiels/
# Mise à jour du chemin vers le .war dans le fichier de configuration de Tomcat
RUN sed -i '163i <Context path="" docBase="/app/siss/lib/version/siss.war"></Context>' /usr/local/tomcat/conf/server.xml
# Ajout du script d'initialisation
COPY --chown=root:root ./conf/dev/entrypoint.sh /scripts/entrypoint.sh
RUN chmod +x /scripts/entrypoint.sh
# Mise à jour de la timezone
RUN rm -rf /etc/localtime && \
    ln -s /usr/share/zoneinfo/Europe/Paris /etc/localtime
# Lancement du script d'initialisation
CMD ["/scripts/entrypoint.sh"]
```


---

### 📄 `conf/run/Dockerfile` [1.931 octets]
<a id="conf-run-Dockerfile"></a> [↩ Retour à l'arborescence](#tree-conf-run-Dockerfile)

> **Chemin relatif** : `conf/run/Dockerfile`  
> **Taille** : 1.931 octets  
> **Lignes** : 37  
> **Type** : dockerfile

```dockerfile
FROM tomcat:9.0.82-jdk11
ARG http_proxy
ARG https_proxy
ARG SILICOM_URL=https://nexus.sro.silicom.fr/repository/maven-releases/com/siss/siss-dist
ARG SISS_VERSION
ARG SILICOM_USER
ARG SILICOM_PASSWORD
ENV DEBIAN_FRONTEND=noninteractive

# Installation des dépendances
RUN apt-get update && apt-get install -y curl bzip2 locales
# Met à jour les locales
RUN sed -i -e 's/# fr_FR.UTF-8 UTF-8/fr_FR.UTF-8 UTF-8/' /etc/locale.gen && \
    dpkg-reconfigure --frontend=noninteractive locales && \
    update-locale LANG=fr_FR.UTF-8
# Définit les variables d'environnement pour la langue
ENV LANG=fr_FR.UTF-8
ENV LC_ALL=fr_FR.UTF-8
# Récupération des archives depuis le Nexus de Silicom
RUN curl -f -x "$http_proxy" -u $SILICOM_USER:$SILICOM_PASSWORD $SILICOM_URL/$SISS_VERSION/siss-dist-$SISS_VERSION-webapp.tar.bz2 --output /tmp/dist.tar.bz2
RUN curl -f -x "$http_proxy" -u $SILICOM_USER:$SILICOM_PASSWORD $SILICOM_URL/$SISS_VERSION/siss-dist-$SISS_VERSION-conf-MTECT.tar.bz2 --output /tmp/conf.tar.bz2
# Création des dossiers applicatifs
RUN mkdir -p /app /app/siss /app/conf /app/conf/init_referentiels
# Extraction des sources et du paramétrage
RUN tar -xjf /tmp/dist.tar.bz2 --strip-components=1 -C /app/siss
RUN tar -xjf /tmp/conf.tar.bz2 --strip-components=1 -C /app/conf siss.conf/
RUN tar -xvf /tmp/conf.tar.bz2 --strip-components=1 -C /app/conf/init_referentiels/ siss.init_referentiels/
# Mise à jour du chemin vers le .war dans le fichier de configuration de Tomcat
RUN sed -i '163i <Context path="" docBase="/app/siss/lib/version/siss.war"></Context>' /usr/local/tomcat/conf/server.xml
# Ajout du script d'initialisation
COPY --chown=root:root ./conf/run/entrypoint.sh /scripts/entrypoint.sh
RUN chmod +x /scripts/entrypoint.sh
# Mise à jour de la timezone
RUN rm -rf /etc/localtime && \
    ln -s /usr/share/zoneinfo/Europe/Paris /etc/localtime
# Lancement du script d'initialisation
CMD ["/scripts/entrypoint.sh"]
```


---

### 📄 `docker-compose.dev.yml` [1.279 octets]
<a id="docker-compose-dev-yml"></a> [↩ Retour à l'arborescence](#tree-docker-compose-dev-yml)

> **Chemin relatif** : `docker-compose.dev.yml`  
> **Taille** : 1.279 octets  
> **Lignes** : 38  
> **Type** : yaml

```yaml
services:
    app:
        image: siss:latest
        container_name: siss-app
        restart: unless-stopped
        build:
            dockerfile: ./conf/dev/Dockerfile
        environment:
            HTTP_PROXY: "${HTTP_PROXY}"
            HTTPS_PROXY: "${HTTP_PROXY}"
            https_proxy: "${HTTP_PROXY}"
            http_proxy: "${HTTP_PROXY}"
            NO_PROXY: "${NO_PROXY}"
            JAVA_OPTS: "${JAVA_OPTS}"
            CATALINA_OPTS: "${CATALINA_OPTS}"
        ports:
            - 8080:8080
        depends_on:
            - db
        volumes:
            - ./data:/app/data
            - ./logs-siss:/app/logs
            - ./application.properties:/app/conf/application.properties
            - ./access.properties:/app/conf/access.properties
            - ./logs-tomcat:/usr/local/tomcat/logs
            - ./ref_utilisateur.csv:/app/conf/init_referentiels/ref_utilisateur.csv
    db:
        image: postgres:13.19-alpine
        container_name: siss-db
        restart: unless-stopped
        environment:
            POSTGRES_DB: "${POSTGRES_DB}"
            POSTGRES_USER: "${POSTGRES_USER}"
            POSTGRES_PASSWORD: "${POSTGRES_PASSWORD}"
        ports:
            - 5432:5432
        volumes:
            - ./pgdata:/var/lib/postgresql/data
```


---

### 📄 `docker-compose.run.yml` [1.237 octets]
<a id="docker-compose-run-yml"></a> [↩ Retour à l'arborescence](#tree-docker-compose-run-yml)

> **Chemin relatif** : `docker-compose.run.yml`  
> **Taille** : 1.237 octets  
> **Lignes** : 36  
> **Type** : yaml

```yaml
services:
    app:
        image: eu.gcr.io/dpnm3-lab/siss:6.3.1
        container_name: siss-app
        restart: unless-stopped
        environment:
            HTTP_PROXY: "${HTTP_PROXY}"
            HTTPS_PROXY: "${HTTP_PROXY}"
            https_proxy: "${HTTP_PROXY}"
            http_proxy: "${HTTP_PROXY}"
            NO_PROXY: "${NO_PROXY}"
            JAVA_OPTS: "${JAVA_OPTS}"
            CATALINA_OPTS: "${CATALINA_OPTS}"
        ports:
            - 8080:8080
        depends_on:
            - db
        volumes:
            - ./data:/app/data
            - ./logs-siss:/app/logs
            - ./application.properties:/app/conf/application.properties
            - ./access.properties:/app/conf/access.properties
            - ./logs-tomcat:/usr/local/tomcat/logs
            - ./ref_utilisateur.csv:/app/conf/init_referentiels/ref_utilisateur.csv
    db:
        image: postgres:13.19-alpine
        container_name: siss-db
        restart: unless-stopped
        environment:
            POSTGRES_DB: "${POSTGRES_DB}"
            POSTGRES_USER: "${POSTGRES_USER}"
            POSTGRES_PASSWORD: "${POSTGRES_PASSWORD}"
        ports:
            - 5432:5432
        volumes:
            - ./pgdata:/var/lib/postgresql/data
```


---

### 📄 `README.md` [4.441 octets]
<a id="README-md"></a> [↩ Retour à l'arborescence](#tree-README-md)

> **Chemin relatif** : `README.md`  
> **Taille** : 4.441 octets  
> **Lignes** : 95  
> **Type** : markdown

````markdown
# Build locale de l'image

## Version actuelle

4.6.0

## Prélable

Récupérer les identifiants d'accès au Nexus de Silicom sur [Passbolt](https://passbolt.pnm3.e2.rie.gouv.fr/).

Récupérer le dernier numéro de version disponible sur le Nexus de Silicom.

## Image de run utilisant les sources Nexus

Pour builder en local l'image docker de run en utilisant comme source le Nexus de Silicom il faut utiliser la commande suivante :

```
docker build -t siss:latest --build-arg SILICOM_USER=xxxx --build-arg SILICOM_PASSWORD=yyyyy --build-arg SILICOM_URL=https://nexus.sro.silicom.fr/repository/maven-releases/com/siss/siss-dist --build-arg SISS_VERSION=X.Y.Z -f conf/run/Dockerfile .
```

où :

- xxxx est l'identifiant d'accès au Nexus Silicom
- yyyy est le mot de passe d'accès au Nexus SIlicom

## Image de dév utilisant les sources locales

Pour builder en local l'image docker de dév en utilisant des sources locales livrées par Silicom ou récupérées sur leur Nexus, il faut utiliser la commande suivante :

```
docker build -t siss:latest --build-arg SISS_VERSION=X.Y.Z -f conf/dev/Dockerfile .
```

Au préalable les sources au format **.tar.bz2** auront été déposées en local dans le dossier _conf/dev/_

## Build de l'image issue de la CI

La CI ministérielle liée à ce dépôt de code builde automatiquement une image lors d'une release, cette image peut être tirée par un utilisateur authentifié sous le nom **eu.gcr.io/dpnm3-lab/siss**.

# Paramétrage

Le bon fonctionnement de l'application dépend du renseignement correct et cohérent du fichier **application.properties** dont un exemple avec des valeurs par défaut est fourni à la racine de ce dépôt sous le nom **application.sample.properties**.

Il est également nécessaire de fournir un fichier **access.properties** (fourni en livraison) et monté sur le container applicatif.

Enfin un fichier **ref_utilisateur.csv** sert à initialiser le référentiel des utilisateurs en db.

## Clé de chiffrement

SISS manipulant des données sensibles, un chiffrement/déchiffrement des données a lieu lors des accès/écriture aux données, ce chiffrement est basé sur une clé qui doit être générée avec la commande suivante après avoir fait le choix d'une valeur en clair _cle-de-chiffrement_.

```
docker exec -it siss:latest java -jar /app/siss/lib/version/siss-generate-key.jar [cle-de-chiffrement]
```

Le résultat de cette commande est à renseigner dans **siss.encryption.key** du fichier _application.properties_.

## Configuration de comptes utilisateurs en test/intégration

Le mode de fonctionnement cible est basé sur l'utilisation d'un SSO pour l'authentification et les permissions mais il est possible, à des fins de test ou d'intégration, d'utiliser une authentification locale par login/mot de passe.

Pour cela il faut en premier lieu ajouter le bloc suivant dans le fichier **application.properties par utilisateur** à enregistrer :

```
authentication.stubLdap.[USER].dn=uid=[USER],ou=people,ou=ro,o=silicom,c=fr
authentication.stubLdap.[USER].cn=cypress Ctr
authentication.stubLdap.[USER].sn=Ctr
authentication.stubLdap.[USER].givenName=cypressCtr
authentication.stubLdap.[USER].mail=[USER]@domain.com

authentication.stubLdap.[USER].telephoneNumber=+33 1 23 45 67 89
authentication.stubLdap.[USER].mobile=+33 6 23 45 67 89
authentication.stubLdap.[USER].mefiAppliAdc=[SISS,ANAIS]
authentication.stubLdap.[USER].personalTitle =Mme
authentication.stubLdap.[USER].postalAddress=SAINT-DENIS DE LA REUNION-VICTOIRE RUE DE LA VICTOIRE
authentication.stubLdap.[USER].postalCode=35700
authentication.stubLdap.[USER].localityName=Rennes
authentication.stubLdap.[USER].departement=35
```

où **[USER]** est à remplacer par l'identifiant du user souhaité (éviter les caractères spéciaux, dont les '.' dans l'identifiant).

En deuxième lieu il faut aller éditer/ajouter les lignes correspondantes en db dans la table *ref_utilisateur*, en particulier la colonne **uti_login** qui contient l'identifiant utilisé pour la jointure avec la informations du bloc précédent.

[TODO] : expliquer comment alimenter les lignes de la table en db.


# Initialisation des données

Requêtes SQL à passer à l'initialisation de la base de données :

```
ALTER ROLE ${POSTGRES_USER} LOGIN NOSUPERUSER INHERIT NOCREATEROLE NOREPLICATION PASSWORD '${POSTGRES_PASSWORD}';
CREATE SCHEMA siss AUTHORIZATION ${POSTGRES_USER};
```
````


---

### 📄 `VERSION` [5 octets]
<a id="VERSION"></a> [↩ Retour à l'arborescence](#tree-VERSION)

> **Chemin relatif** : `VERSION`  
> **Taille** : 5 octets  
> **Lignes** : 1  
> **Type** : text

```text
6.4.0
```


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

`````

</details>


---

### 📄 `si/speddi.analysis.md` [14.731 octets]
<a id="si-speddi-analysis-md"></a> [↩ Retour à l'arborescence](#tree-si-speddi-analysis-md)

> **Chemin relatif** : `si/speddi.analysis.md`  
> **Taille** : 14.731 octets  
> **Lignes** : 453  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (453 lignes) - Cliquer pour déplier</summary>

````markdown
# ?? Analyse complète de lapplication `SPEDDI`

> *Ministère de la Transition écologique et de la Cohésion des territoires  SG/DNUM/PNM/PNM3*  
> *Document autoporté  Généré le 30 décembre 2025*

---

## ?? Sommaire

- [1. Vue densemble](#1-vue-densemble)
- [2. Analyse fonctionnelle](#2-analyse-fonctionnelle)
  - [2.1 Acteurs](#21-acteurs)
  - [2.2 Cas dusage principaux](#22-cas-dusage-principaux)
  - [2.3 Workflows](#23-workflows)
  - [2.4 Règles métier identifiées](#24-règles-métier-identifiées)
- [3. Analyse technique](#3-analyse-technique)
  - [3.1 Architecture globale](#31-architecture-globale)
  - [3.2 Modules & couches](#32-modules--couches)
  - [3.3 Dépendances](#33-dépendances)
  - [3.4 Sécurité](#34-sécurité)
  - [3.5 Dette technique & risques](#35-dette-technique--risques)
- [4. Annexes](#4-annexes)
  - [4.1 Référentiel de données](#41-référentiel-de-données)
  - [4.2 Configurations clés](#42-configurations-clés)

---

## 1. Vue densemble

**Nom** : `SPEDDI`  
**Type** : Application web PHP (monolithique MVC-like)  
**Domaine fonctionnel** : Gestion RH (agents, profils, mouvements, référentiels)  typiquement un système de gestion des effectifs ou de suivi des personnels.

**Points dentrée** :
- `src/index.php` ? redirection vers `/public/index.php`
- Point daccès authentifié via CAS (Cerbère)

**Stack technique visible** :
- Langage : PHP (legacy style, fichiers `.class.php`, pas de namespace)
- Framework maison (`src/lib/Framework/Dispatcher.class.php`, `Exception/*`)
- ORM/DAO maison (`src/classes/SPEDDI/integration/*Dao.class.php`)
- Logging : `apache-log4php-2.3.0` (version 2012)
- Authentification : `phpCAS` (via `src/lib/CAS/`)
- Génération PDF : `fpdf`
- CI/CD : GitLab CI + Docker

---

## 2. Analyse fonctionnelle

### 2.1 Acteurs

```plantuml
@startuml
actor "Agent RH" as RH
actor "Agent (utilisateur)" as AGENT
actor "Administrateur technique" as ADMIN

RH --> (Consulter / Modifier agents)
RH --> (Gérer les référentiels)
RH --> (Exporter des données)

AGENT --> (Consulter son profil)
AGENT --> (Consulter ses pièces jointes)

ADMIN --> (Gérer l'authentification)
ADMIN --> (Surveiller les logs)

note right of RH
Peut créer/modifier/supprimer
des agents, grades, catégories,
organismes, etc.
end note

note right of AGENT
Accès en lecture seule
à ses propres données.
end note
@enduml
```

> ? **Source** :  
> - `src/templates/SPEDDI/Visu*.php` ? vues de consultation  
> - `src/classes/SPEDDI/integration/*Dao.class.php` ? accès aux données  
> - `src/config/Menu.xml` (10.995 o) ? hiérarchie des menus :  
>   *Categorie, Grade, Organisme, Profil, TypeMouvement*

---

### 2.2 Cas dusage principaux

| ID | Nom | Acteur(s) | Description |
|----|------|-----------|-------------|
| CU-01 | Consulter un agent | RH, Agent | Affiche fiche complète (profil, affectation, PJ) via `VisuAgent.php` |
| CU-02 | Modifier un agent | RH | Workflow édition via `Edition.class.php` (9 674 o) |
| CU-03 | Exporter une liste | RH | Export CSV/PDF via `ExportAgent.php` ou `Export.php` |
| CU-04 | Gérer un référentiel | RH | Tables `Categorie`, `TypeGrade`, `Organisme`, etc. |
| CU-05 | Gérer les pièces jointes | RH | `VisuPiecesJointes.php` (6 334 o) |
| CU-06 | Authentification CAS | Tous | Via `cerbere.php` + `phpCAS` |

---

### 2.3 Workflows

#### ?? Workflow dauthentification CAS (Cerbère)

```plantuml
@startuml
title Authentification Cerbère (CAS)

actor Utilisateur
participant "index.php" as ENTRY
participant "connexion.php" as CONN
participant "phpCAS" as CAS
participant "Cerbère IDP" as IDP

Utilisateur -> ENTRY : GET /
ENTRY --> CONN : include connexion.php
CONN -> CAS : phpCAS::client(...)\nphpCAS::setCasServerCACert(...)\nphpCAS::forceAuthentication()
CAS -> IDP : Redirige vers\nhttps://authentification.din.developpement-durable.gouv.fr/cas/3/login
IDP --> CAS : Ticket + attributs (prenom, nom, email, roles)
CAS --> CONN : phpCAS::getUser(),\nphpCAS::getAttribute('memberOf')
CONN --> ENTRY : $_SESSION rempli (ex: User, Profil)
ENTRY --> Utilisateur : Accès à l'appli

note right
Attributs attendus :\n- surname\n- givenName\n- memberOf (rôles)\n? Mappés dans Structure.php/util.php
end note
@enduml
```

> ? **Sources** :  
> - `src/config/cerbere.php` : config CAS (host, port, cert)  
> - `src/lib/CAS/docs/examples/example_service.php`  
> - `src/classes/commun/Structure.php` (4 419 o) : probable gestion des droits  
> - `src/lib/CAS/CAS.php` (72 007 o) : implémentation complète

---

#### ?? Workflow dexport RH

```plantuml
@startuml
title Export RH (Agent ou liste)

actor RH
participant "Defaut.class.php" as CTRL
participant "Edition.class.php" as EDIT
participant "Util.class.php" as UTIL
database "BDD" as DB

RH -> CTRL : GET ?action=Export&id=Agent
CTRL -> EDIT : new Edition(); $this->Export()
EDIT --> CTRL : $Test = $this->_fRequete->getParam()
CTRL --> EDIT : setVue("../templates/SPEDDI/ExportAgent.php")
CTRL --> UTIL : util::GenerePDF() (via testPdf())
UTIL -> DB : requêtes via AgentDao
DB --> UTIL : résultats
UTIL --> RH : PDF/CSV généré

note right of UTIL
Fonction GenerePDF() dans util.php (14 784 o)\n? probablement utilise fpdf/
end note
@enduml
```

> ? **Sources** :  
> - `src/classes/SPEDDI/presentation/Edition.class.php` : méthode `Export()`  
> - `src/templates/SPEDDI/Export*.php`  
> - `src/lib/fpdf/` ? génération PDF  
> - `src/classes/commun/util.php`

---

### 2.4 Règles métier identifiées

#### ?? Règle de visibilité des données (profil vs RH)

Aucun algorithme complexe explicitement visible, mais la présence de :

- `src/classes/SPEDDI/integration/UtilisateurDao.class.php` (5 552 o)  
- `src/classes/SPEDDI/integration/AgentDao.class.php` (42 441 o ? **très volumineux**)  
- `src/templates/SPEDDI/VisuProfil.php` vs `VisuAgent.php`

 suggère une logique de **filtrage par profil** :

| Profil utilisateur | Peut voir | Peut modifier |
|--------------------|-----------|----------------|
| `Agent` | Seulement ses propres données (`VisuProfil.php`) | ? |
| `Gestionnaire RH` | Tous les agents + référentiels | ? agents, PJ, mouvements |
| `Admin` | Tous + configuration | ? tout |

> ?? **Absence de logique métier exposée dans les extraits** ? aucune formule, calcul conditionnel, ni algorithme complexe (ex. ancienneté, droits de mutation) nest visible dans les fragments.  
> ? Seules des **règles de routage et de droits daccès** sont observables.

---

## 3. Analyse technique

### 3.1 Architecture globale

```plantuml
@startuml
!theme plain
skinparam componentStyle rectangle
skinparam wrapWidth 200

[Client navigateur] -- HTTP --> [Web Server\n(Apache/Nginx)]

rectangle "SPEDDI (PHP)" {
  [index.php] --> [Dispatcher.class.php]
  [Dispatcher.class.php] --> [Controller: *.class.php\n(ex: Defaut, Edition)]
  [Controller] --> [DAO: *Dao.class.php\n(ex: AgentDao, PaysDao)]
  [DAO] --> [BDD PostgreSQL\n(via PDO ou pg_connect)]
  
  [Controller] --> [Vue: *.php\n(ex: VisuAgent.php)]
  [Vue] --> [Template commun\n(menu.php, footer.php)]
  
  [Tout code] --> [Logger: log4php]
  [Tout code] --> [Auth: phpCAS]
  [Util.php] --> [PDF: fpdf/]
}

[Logger: log4php] --> [Fichier: ../log/speddi.log]
[Auth: phpCAS] --> [IDP Cerbère]
@enduml
```

> ? **Sources** :  
> - `src/lib/Framework/Dispatcher.class.php` (3 372 o) ? routeur MVC  
> - `src/config/log4php-config.xml` ? logging vers `../log/speddi.log`  
> - `src/lib/CAS/` ? intégration CAS  
> - `docker-compose.yml` & `Dockerfile` ? conteneurisation PostgreSQL

---

### 3.2 Modules & couches

| Couche | Chemin | Fichiers clés | Rôle |
|--------|--------|---------------|------|
| **Présentation** | `src/templates/` | `SPEDDI/Visu*.php`, `commun/*.php` | Vues HTML, menus, layout |
| **Contrôle** | `src/classes/SPEDDI/presentation/` | `Defaut.class.php`, `Edition.class.php`, `AbstractBasicAction.php` | Actions utilisateur, workflow |
| **Métier / DAO** | `src/classes/SPEDDI/integration/` | `AgentDao.class.php` (1220 lignes), `PaysDao.class.php`, `UtilisateurDao.class.php` | Accès aux données |
| **Utilitaires** | `src/classes/commun/` | `util.php` (14 784 o), `Structure.php`, `debug.php` | Fonctions globales, PDF, debug |
| **Framework** | `src/lib/Framework/` | `Dispatcher.class.php`, `Exception/*.php` | Routage, gestion erreurs |
| **Sécurité** | `src/lib/CAS/` | `CAS.php`, `cerbere.php` | Authentification SSO |
| **Logging** | `src/lib/apache-log4php-2.3.0/` | `layouts/`, `appenders/`, `log4php-config.xml` | Journalisation |

---

### 3.3 Dépendances

#### ?? Dépendances explicites

```plantuml
@startuml
package "SPEDDI" {
  [Dispatcher] --> [log4php]
  [CAS Auth] --> [phpCAS]
  [Export PDF] --> [fpdf]
}

package "log4php 2.3.0" {
  [LoggerAppenderRollingFile]
  [LoggerLayoutPattern]
  [LoggerDOMConfigurator]
}

package "phpCAS" {
  [CAS_Client]
  [CAS_ProxyChain]
}

package "fpdf" {
  [FPDF]
}

[log4php] ..> "Apache License 2.0"
[phpCAS] ..> "Apache License 2.0"
[fpdf] ..> "MIT ?"
@enduml
```

> ? **Sources** :  
> - `src/lib/apache-log4php-2.3.0/LICENSE` (34 675 o)  
> - `src/lib/CAS/LICENSE` (11 357 o) ? Apache 2.0  
> - `src/lib/fpdf/` ? licence non précisée ici, mais généralement MIT

#### ?? Versions critiques

| Composant | Version | Date approx. | Risque |
|----------|---------|--------------|--------|
| `apache-log4php` | 2.3.0 | 2012 | ? **End-of-life**, vulnérabilités non corrigées |
| `phpCAS` | non spécifiée | =1.3.x | ?? À vérifier (dernière stable : 1.6.x en 2023) |
| PHP | non spécifié | probablement 5.67.4 | ? Compatibilité future |

> ?? **Preuve** :  
> - `src/lib/apache-log4php-2.3.0/site/changes-report.html` (60 912 o) ? dernière release **2012**  
> - `src/lib/apache-log4php-2.3.0/NOTICE` (274 o) ? Apache Software Foundation

---

### 3.4 Sécurité

#### ?? Points forts

- ? **Authentification centralisée** via Cerbère (CAS 3)  
- ? **Certificat IGC_A** utilisé (`src/config/cerbere.php`) ? chaîne de confiance État  
- ? **Pas de credentials en clair** dans les extraits

#### ?? Points faibles

| Problème | Localisation | Risque |
|---------|--------------|--------|
| **log4php obsolète** | `src/lib/apache-log4php-2.3.0/` | Vulnérabilités log4shell-like possibles (ex: injection via pattern layout) |
| **Redirection fixe post-CAS** | `cerbere.php`: `$applicationExitURL = "http://127.0.0.1:8080/"` | ? Hardcodé ? risque de SSRF / Open Redirect en prod |
| **Pas de CSP/HTTP headers** | `src/templates/commun/meta.php` (1 356 o) | Risque XSS non atténué |
| **Debug potentiellement actif** | `src/classes/commun/debug.php` (5 190 o) | Fuite dinfos si activé en production |

> ?? **Preuve** :  
> - `cerbere.php` contient une URL locale en dur  
> - `debug.php` existe ? vérifier sil est inclus via `util.php` ou `Structure.php`

---

### 3.5 Dette technique & risques

#### ?? Indice de dette (qualitatif)

| Catégorie | État | Commentaire |
|----------|------|-------------|
| **Modernisation** | ?? Critique | PHP legacy (`.class.php`, pas de PSR, pas de composer) |
| **Logging** | ?? Critique | log4php 2012 ? remplacer par Monolog |
| **Auth** | ?? Moyen | phpCAS OK, mais à mettre à jour |
| **Tests** | ?? Aucun | Aucun fichier `tests/` visible ? couverture 0% |
| **Doc** | ?? Bonne | Docs log4php/CAS embarquées, mais pas pour SPEDDI |

#### ?? Diagramme de dette (Swimlane)

```plantuml
@startuml
|Équipe Dev|
start
:Code legacy PHP\nPas de namespaces\nFichiers .class.php;
-> Réécrire en PSR-4;
:log4php obsolète;
-> Migrer vers Monolog 3+;

|Équipe Infra|
:Docker + GitLab CI;
-> OK, mais image custom\neu.gcr.io/dpnm3-lab/speddi:latest\n? à documenter;
:PostgreSQL 15.2;
-> OK;

|Équipe Sécurité|
:Cerbère OK;
:CSP / Headers manquants;
-> Ajouter dans meta.php;
:Hardcoded URL CAS;
-> Externaliser dans .env;

|Équipe Prod|
:Log file seul\n(../log/speddi.log);
-> Ajouter syslog / ELK;
:Pas de monitoring visible;
-> Intégrer healthcheck + metrics;

end
@enduml
```

---

## 4. Annexes

### 4.1 Référentiel de données

Extrait de `src/config/referentiel.xml` (2 190 o) :

```xml
<referentiel>
  <table nom="Type d'action" NomTable="t_type_action" nbcolonne="2">
    <colonne nomChamps="TACT_ID_TYPEACTION" type="int" modifiable="0" nom="Identifiant"/>
    <colonne nomChamps="TACT_LIB_TYPEACTION" type="text" modifiable="1" nom="Libelle"/>
  </table>
  <table nom="Type de maitrise d'ouvrage" NomTable="t_tmoa" nbcolonne="2">
    <colonne nomChamps="TMOA_ID_TYPEMOA" type="int" modifiable="0" nom="Identifiant"/>
    <colonne nomChamps="TMOA_LIB_TYPEMOA" type="text" modifiable="1" nom="Libelle"/>
  </table>
</referentiel>
```

? Modèle **clé-valeur simple** (ID + libellé), modifiable via IHM RH.

Autres tables identifiées :
- `t_categorie`
- `t_typegrade`
- `t_organisme`
- `t_pays`
- `t_zonegeographique`

---

### 4.2 Configurations clés

#### ?? `src/config/log4php-config.xml` (486 o)

```xml
<configuration xmlns="http://logging.apache.org/log4php/">
  <appender name="default" class="LoggerAppenderRollingFile">
    <layout class="LoggerLayoutPattern">
      <param name="conversionPattern" value="%date{d.m.Y H:i:s} %logger %X{User}%n %msg%n%n"/>
    </layout>
    <param name="file" value="../log/speddi.log"/>
    <param name="maxFileSize" value="1MB"/>
  </appender>
  <root>
    <appender_ref ref="default"/>
  </root>
</configuration>
```

? Rotation à 1 Mo, pattern avec `%X{User}` (MDC ? probablement `phpCAS::getUser()`).

#### ?? `src/config/cerbere.php` (272 o)

```php
<?php
$cas_host = "authentification.din.developpement-durable.gouv.fr";
$cas_port = 443;
$cas_context = "/cas/3";
$cas_chemin_igca = "../lib/CAS/cert/IGC_A.crt";
$applicationExitURL = "http://127.0.0.1:8080/";
?>
```

? **À corriger** : `$applicationExitURL` doit être dynamique (ex: `$_SERVER['HTTP_HOST']`).

---

## ? Conclusion

**SPEDDI** est une application RH mature, bien structurée en couches, avec une **forte dépendance à des composants obsolètes** (log4php 2012).  
Son architecture MVC maison est lisible, mais non maintenable à long terme sans modernisation.

### ?? Recommandations prioritaires

1. ?? **Remplacer log4php par Monolog** (PSR-3 compatible)  
2. ??? **Corriger `$applicationExitURL`** ? variable denvironnement  
3. ?? **Ajouter des tests unitaires** (PHPUnit ou Pest)  
4. ?? **Migrer vers Composer** + PSR-4  
5. ?? **Ajouter healthcheck + métriques** (ex: `/health`)

````

</details>


---

### 📄 `si/speddi.wiki.md` [43.151 octets]
<a id="si-speddi-wiki-md"></a> [↩ Retour à l'arborescence](#tree-si-speddi-wiki-md)

> **Chemin relatif** : `si/speddi.wiki.md`  
> **Taille** : 43.151 octets  
> **Lignes** : 1064  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (1064 lignes) - Cliquer pour déplier</summary>

````markdown
﻿# Projet : speddi.wiki

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\speddi.wiki`

**Fichiers** : 2 fichiers non-binaires

## 📁 Arborescence des fichiers

├── <a id="tree-A---home-md"></a>[A---home.md](#A---home-md) *(31.461 octets)*
└── <a id="tree-Speddi-Fiche-Applicative-md"></a>[Speddi-Fiche-Applicative.md](#Speddi-Fiche-Applicative-md) *(6.069 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `A---home.md` [31.461 octets]
<a id="A---home-md"></a> [↩ Retour à l'arborescence](#tree-A---home-md)

> **Chemin relatif** : `A---home.md`  
> **Taille** : 31.461 octets  
> **Lignes** : 542  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (542 lignes) - Cliquer pour déplier</summary>

```markdown
<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><b><span style='font-size:24.0pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
mso-font-kerning:18.0pt;mso-fareast-language:FR'><span class=msoIns><ins>Fiche
technique</ins></span><o:p></o:p></span></b></p>

<table class=MsoNormalTable border=0 cellpadding=0 style='mso-cellspacing:1.5pt;
 mso-yfti-tbllook:1184'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes'>
  <td style='background:lightgrey;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><b><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";color:black;mso-fareast-language:
  FR'>Base de connaissance</span></b><span style='font-size:12.0pt;font-family:
  "Times New Roman",serif;mso-fareast-font-family:"Times New Roman";color:black;
  mso-fareast-language:FR'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'><a
  href="http://sirh.redmine.ac.centre-serveur.i2/projects/psisy/wiki/Fiche_applicative">http://sirh.redmine.ac.centre-serveur.i2/projects/psisy/wiki/Fiche_applicative</a><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<div class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
text-align:center;line-height:normal'><span style='font-size:12.0pt;font-family:
"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";mso-fareast-language:
FR'>

<hr size=2 width="100%" align=center>

</span></div>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><a name=Périmètre-MCO></a><b><span
style='font-size:24.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-font-kerning:18.0pt;mso-fareast-language:FR'>Périmètre
MCO<o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Activités
reprises par la MCO ATOS : <o:p></o:p></span></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l3 level1 lfo1;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Déploiements<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l3 level1 lfo1;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Gestion des incidents<o:p></o:p></span></li>
</ul>

<div class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
text-align:center;line-height:normal'><span style='font-size:12.0pt;font-family:
"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";mso-fareast-language:
FR'>

<hr size=2 width="100%" align=center>

</span></div>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><a name=Documentation></a><b><span
style='font-size:24.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-font-kerning:18.0pt;mso-fareast-language:FR'>Documentation<o:p></o:p></span></b></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l0 level1 lfo2;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>La documentation est disponible
     dans <b>&quot;M:\PNM6\09 - Transfert SPEDDI&quot;</b><o:p></o:p></span></li>
</ul>

<div class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
text-align:center;line-height:normal'><span style='font-size:12.0pt;font-family:
"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";mso-fareast-language:
FR'>

<hr size=2 width="100%" align=center>

</span></div>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><a name=Accès-Identifiants-Application></a><b><span
style='font-size:24.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-font-kerning:18.0pt;mso-fareast-language:FR'>Accès :
Identifiants, Application...<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><a name=Identifiants-et-mots-de-passe></a><b><span
style='font-size:18.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Identifiants et mots de passe<o:p></o:p></span></b></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l6 level1 lfo3;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Des identifiants et mots de
     passe sont disponibles dans le <span class=SpellE><b>Keepass</b></span><b>
     Coffre de l'exploitation</b> (Atos).<o:p></o:p></span></li>
</ul>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><a name=Accès-application></a><b><span
style='font-size:18.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Accès application<o:p></o:p></span></b></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l5 level1 lfo4;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'><a
     href="https://sirh.projets.developpement-durable.gouv.fr/issues/18156#Liens-URL">Accès
     à l'application</a><o:p></o:p></span></li>
</ul>

<div class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
text-align:center;line-height:normal'><span style='font-size:12.0pt;font-family:
"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";mso-fareast-language:
FR'>

<hr size=2 width="100%" align=center>

</span></div>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><a name=Gestion-des-incidents></a><b><span
style='font-size:24.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-font-kerning:18.0pt;mso-fareast-language:FR'>Gestion des
incidents<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><a name=Criticité></a><b><span
style='font-size:18.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Criticité<o:p></o:p></span></b></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l2 level1 lfo5;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'><a
     href="https://sirh.projets.developpement-durable.gouv.fr/issues/18156#Criticit%C3%A9">Criticité</a><o:p></o:p></span></li>
</ul>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><a
name=Qui-prévenir-et-comment-en-cas-dincident></a><b><span style='font-size:
18.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
mso-fareast-language:FR'>Qui prévenir et comment en cas d'incident<o:p></o:p></span></b></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l4 level1 lfo6;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Si <b><span class=msoIns><ins>incident
     fonctionnel</ins></span></b> : <o:p></o:p></span></li>
 <ul type=circle>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;line-height:normal;mso-list:l4 level2 lfo6;tab-stops:list 72.0pt'><span
      style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
      "Times New Roman";mso-fareast-language:FR'>Solliciter la <b>société CGI
      dans <span class=SpellE>Redmine</span> SIRH</b><o:p></o:p></span></li>
 </ul>
</ul>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     line-height:normal;mso-list:l1 level1 lfo7;tab-stops:list 36.0pt'><span
     style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
     "Times New Roman";mso-fareast-language:FR'>Si <b><span class=msoIns><ins>incident
     technique</ins></span></b> (Exemples : Erreur 404, erreur 501, erreur de
     communication...) : <o:p></o:p></span></li>
 <ul type=circle>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;line-height:normal;mso-list:l1 level2 lfo7;tab-stops:list 72.0pt'><span
      style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
      "Times New Roman";mso-fareast-language:FR'>Solliciter le <b>Centre
      Serveur dans <span class=SpellE>Redmine</span> Portail Hébergement</b><o:p></o:p></span></li>
 </ul>
</ul>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><a
name=Emplacement-des-fichiers-de-logs></a><b><span style='font-size:18.0pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
mso-fareast-language:FR'>Emplacement des fichiers de logs<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Les fichiers
de logs se trouvent dans le <b>répertoire &quot;/logs/<span class=SpellE>prod</span>&quot;</b>.
Ce répertoire est accessible depuis le <b>FTP de SPEDDI</b> avec les
identifiants de production.<o:p></o:p></span></p>

<div class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
text-align:center;line-height:normal'><span style='font-size:12.0pt;font-family:
"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";mso-fareast-language:
FR'>

<hr size=2 width="100%" align=center>

</span></div>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><a
name=Fiche-dexploitation-Erreurs-connues></a><b><span style='font-size:24.0pt;
font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
mso-font-kerning:18.0pt;mso-fareast-language:FR'>Fiche d'exploitation / Erreurs
connues<o:p></o:p></span></b></p>

<table class=MsoNormalTable border=0 cellpadding=0 style='mso-cellspacing:1.5pt;
 mso-yfti-tbllook:1184'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td style='background:lightgrey;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><b><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";color:black;mso-fareast-language:
  FR'>Description</span></b><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";color:black;mso-fareast-language:
  FR'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Lien<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;mso-yfti-lastrow:yes'>
  <td style='padding:.75pt .75pt .75pt .75pt'></td>
  <td style='padding:.75pt .75pt .75pt .75pt'></td>
 </tr>
</table>

<div class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
text-align:center;line-height:normal'><span style='font-size:12.0pt;font-family:
"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";mso-fareast-language:
FR'>

<hr size=2 width="100%" align=center>

</span></div>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:1'><a
name=Procédure-de-déploiement-Application-SPE></a><b><span style='font-size:
24.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
mso-font-kerning:18.0pt;mso-fareast-language:FR'>Procédure de déploiement
Application SPEDDI<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Procédure de
déploiement de l'application Orchidée (Pas à pas)<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><a name=Pré-requis></a><span
class=SpellE><b><span style='font-size:18.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Pré-requis</span></b></span><b><span
style='font-size:18.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'><o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'><a
href="http://sirh.redmine.ac.centre-serveur.i2/projects/psisy/wiki/Wiki">Détails</a><o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:3'><a name=Outil></a><b><span
style='font-size:13.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Outil<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Avoir
télécharger <span class=SpellE>FileZilla</span> <span class=GramE>( logiciel</span>
FTP libre ) ou équivalent.<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:3'><a name=Configuration-du-FTP></a><b><span
style='font-size:13.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Configuration du FTP<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>1- Créer un
&quot;Nouveau site&quot; : SPEDDI<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>2- Remplir
l'onglet &quot;Général&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Hôte:
10.100.1.8<br>
Protocole: SFTP - SSH File Transfert Protocole <br>
Chiffrement : Connexion FTP simple (non sécurisée)<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Type d'<span
class=SpellE>audhentification</span> : Normale<br>
Identifiant : <span class=SpellE>root</span><br>
Mot de passe : *<b>*</b>**<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>3- Remplir
l'onglet &quot;Avancé&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Cocher la
case &quot;Ignorer le Proxy&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><a
name=Livraison-dune-nouvelle-version-de-lappl></a><b><span style='font-size:
18.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
mso-fareast-language:FR'>Livraison d'une nouvelle version de l'applicatif<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'><a
href="http://sirh.redmine.ac.centre-serveur.i2/projects/psisy/wiki/Wiki">Détails</a><o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:3'><a name=Mode-de-livraison></a><b><span
style='font-size:13.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Mode de livraison<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Par GITLAB<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:3'><a name=Liens-vers-Livraison></a><b><span
style='font-size:13.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Liens vers Livraison<o:p></o:p></span></b></p>

<table class=MsoNormalTable border=0 cellpadding=0 style='mso-cellspacing:1.5pt;
 mso-yfti-tbllook:1184'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td colspan=2 style='background:lightgrey;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><b><span style='font-size:12.0pt;
  font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
  color:black;mso-fareast-language:FR'>PIC - Plateforme Intégration Continue</span></b><span
  style='font-size:12.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
  "Times New Roman";color:black;mso-fareast-language:FR'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td style='background:lightgrey;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><b><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";color:black;mso-fareast-language:
  FR'>FORGE</span></b><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";color:black;mso-fareast-language:
  FR'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'><a
  href="https://forge.din.developpement-durable.gouv.fr/">https://forge.din.developpement-durable.gouv.fr/</a>
  <o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td style='background:lightgrey;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><b><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";color:black;mso-fareast-language:
  FR'>GIT</span></b><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";color:black;mso-fareast-language:
  FR'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'><a
  href="https://scm-forge.din.developpement-durable.gouv.fr/redmine/projects/speddi/repository/subversion-speddi/revisions">https://scm-forge.din.developpement-durable.gouv.fr/redmine/projects/speddi/repository/subversion-speddi/revisions</a><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td style='background:lightgrey;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><b><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";color:black;mso-fareast-language:
  FR'>Jenkins</span></b><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";color:black;mso-fareast-language:
  FR'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'><a
  href="https://forge.din.developpement-durable.gouv.fr/jenkins/login?from=%2Fjenkins%2F">https://forge.din.developpement-durable.gouv.fr/jenkins/login?from=%2Fjenkins%2F</a>
  <o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td style='background:lightgrey;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><b><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";color:black;mso-fareast-language:
  FR'>Nexus</span></b><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";color:black;mso-fareast-language:
  FR'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'><a
  href="https://forge.din.developpement-durable.gouv.fr/nexus/">https://forge.din.developpement-durable.gouv.fr/nexus/</a>
  <o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes'>
  <td style='background:lightgrey;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span class=SpellE><b><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";color:black;mso-fareast-language:
  FR'>Gitlab</span></b></span><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";color:black;mso-fareast-language:
  FR'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
  mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'><a
  href="https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/produits/rh/speddi">https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/produits/rh/speddi</a>
  <o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:3'><a name=Récupération-de-la-livraison></a><b><span
style='font-size:13.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Récupération de la livraison<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Le fichier à
récupérer doit être zipper et avoir un numéro de version (speddi_vX.Y.Z.zip)<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Le <span
class=SpellE>dézipper</span> en local.<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:3'><a name=Contenu-de-la-livraison></a><b><span
style='font-size:13.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Contenu de la livraison<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Le contenu
du zip doit avoir :<br>
- un lisez-moi.txt qui décrit les modifications apportées (N° de l'incident,
...), les manipulations à effectuer.<br>
- les fichiers modifiés<br>
- les requêtes nécessaires<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:2'><a
name=Mise-en-place-de-lapplicatif-sur-la-plat></a><b><span style='font-size:
18.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:"Times New Roman";
mso-fareast-language:FR'>Mise en place de l'applicatif sur la plateforme de
production<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'><a
href="http://sirh.redmine.ac.centre-serveur.i2/projects/psisy/wiki/Wiki">Détails</a><o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:3'><a name=Sur-la-base-de-données></a><b><span
style='font-size:13.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Sur la base de données<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>1- Se
connecter à la base <br>
<a href="http://10.100.1.8/phpmyadmin/">http://10.100.1.8/phpmyadmin/</a><br>
Login : <span class=SpellE>root</span><br>
<span class=SpellE>mdp</span> : *<b>**</b><br>
serveur :<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>2- Passer le
script SQL comme demandé<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:3'><a name=Sous-FileZilla></a><b><span
style='font-size:13.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Sous <span class=SpellE>FileZilla</span><o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Glisser le
fichier &quot;SYNCFULL&quot; dans le répertoire &quot;ACTIONS&quot; pour une
synchronisation totale.<br>
ou<br>
Glisser le fichier &quot;SYNCSPECIFIC&quot; dans le répertoire
&quot;ACTIONS&quot; pour une synchronisation partielle. ce fichier contient la
liste des seuls fichiers à modifier.<br>
Exemple :<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:10.0pt;font-family:"Courier New";mso-fareast-font-family:"Times New Roman";
mso-fareast-language:FR'>classes/<span class=SpellE>Mvc</span>/<span
class=SpellE>metier</span>/<span class=SpellE>EditionBo.class.php</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:3'><a name=Tester-la-nouvelle-version></a><b><span
style='font-size:13.5pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";mso-fareast-language:FR'>Tester la nouvelle version<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>URL de la <span
class=SpellE>prod</span> : <a href="http://10.100.1.8/speddi/public/">http://10.100.1.8/speddi/public/</a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:12.0pt;font-family:"Times New Roman",serif;
mso-fareast-font-family:"Times New Roman";mso-fareast-language:FR'>Fichiers <o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>
```

</details>


---

### 📄 `Speddi-Fiche-Applicative.md` [6.069 octets]
<a id="Speddi-Fiche-Applicative-md"></a> [↩ Retour à l'arborescence](#tree-Speddi-Fiche-Applicative-md)

> **Chemin relatif** : `Speddi-Fiche-Applicative.md`  
> **Taille** : 6.069 octets  
> **Lignes** : 328  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (328 lignes) - Cliquer pour déplier</summary>

```markdown
**<span dir="">Wiki</span>**

<table>
<tr>
<td>

**<span dir="">Wiki SPEDDI</span>**
</td>
<td>

<span dir="">http://sirh.redmine.ac.centre-serveur.i2/projects/psisy/wiki</span>
</td>
</tr>
</table>

**<span dir="">Contexte et statut</span>**

<table>
<tr>
<td>

**<span dir="">Application utilisée pour la gestion du suivi des agents à l'international (DAEI : Direction des Affaires Économique Internationales).<br>Elle permet la gestion du suivi des agents à l'international<br>Elle est utilisée par les Agents SG/DAEI/SPAG/SAG.<br>Elle a été développée par ATL4.</span>**
</td>
</tr>
</table>

**<span dir="">Criticité</span>**

**<span dir="">Période critique</span>**

<table>
<tr>
<td>

**<span dir="">Période critique : Moyenne</span>**
</td>
</tr>
</table>

<div>

---

</div>**<span dir="">Statut du SI :</span>**

**<span dir="">Versions</span>**

* <span dir="">Versions installées</span>

<table>
<tr>
<td>

**<span dir="">Environnement</span>**
</td>
<td>

**<span dir="">Version</span>**
</td>
<td>

**<span dir="">Date d'installation</span>**
</td>
</tr>
<tr>
<td>

<span dir="">Production</span>
</td>
<td>

**<span dir="">V1.0</span>**
</td>
<td>

<span dir="">30/11/2012</span>
</td>
</tr>
</table>


**<span dir="">Description technique</span>**

<table>
<tr>
<td>

**<span dir="">accès FTP en production serveur: 10.100.1.8 protocole: SFTP<br>PHP 5.3.3 Framework conçu et développé par le MTE<br>MySql 5.1.49<br>Apache LAMP : Apache 2.2, VM indépendante, Source placée sous « home » sans configuration de VHOST, accès FTP ou SSH<br>serveur de BDD de prod : :</span>** [**<span dir="">http://10.100.1.8/phpmyadmin/</span>**](http://10.100.1.8/phpmyadmin/)**<span dir=""><br>Nom de la BDD de prod :</span>** [**<span dir="">http://10.100.1.8/speddi/public/</span>**](http://10.100.1.8/speddi/public/)
</td>
</tr>
</table>

**<span dir="">Infra</span>**

<table>
<tr>
<td>

**<span dir="">Acces FTP production<br>Serveur : 10.100.1.8<br>login : root<br>Le passwd \*\*</span>**<span dir="">\*</span>
</td>
</tr>
</table>


 

**<span dir="">Hébergement</span>**

<span dir="">Préciser le type d'hébergement parmi : Nominal type acai, sec IAAS DOIP, extra dry (ex RGP, ORPA), , OSHIMAE, hébergement externe type ARMIN, ATE)</span>

**<span dir="">Préciser le VLAN :</span>**

**<span dir="">Machine(s) et OS : \
Serveur Linux</span>**

<span dir="">Machine(s) : physique si extra dry, vm si sec, so si nominal ?\
OS : nom et version</span>

**<span dir="">Stockage</span>**

<span dir="">Préciser ce qui est stocké en local / en espace partagé (SAN, FTP, etc)</span>

**<span dir="">Techno</span>**

<span dir="">Langage/framework : **PHP-Mysql**</span>

<span dir="">SGBD : serveur de BDD de prod : </span>[<span dir="">http://10.100.1.8/phpmyadmin/</span>](http://10.100.1.8/phpmyadmin/)<span dir="">\
Nom de la BDD de prod :</span>

<span dir="">Nom du serveur de base de données à renseigner dans les paramètres de \
l'application: db-mysql (pour une base MySQL)</span>

<span dir="">Composants divers :</span>

<span dir="">Version JAVA</span>

**<span dir="">Statut pic</span>**

<span dir="">(eg : utilisation de git)</span>

**<span dir="">Services</span>**

**<span dir="">Supervision</span>**

<span dir="">Oui supervision par le centre serveur</span>

**<span dir="">Gestion des incidents et problèmes</span>**

<span dir="">Non</span>

**<span dir="">Gestion des changements, des mep, déploiements</span>**

**<span dir="">Gestion de conf</span>**

**<span dir="">Gestion des opérations dont sauvegardes\
Centre serveurs</span>**

**<span dir="">Gestion des RFS</span>**

**<span dir="">Gestion de la sécurité</span>**

**<span dir="">Gestion des accès et comptes</span>**

**<span dir="">Indicateurs</span>**

**<span dir="">Acteurs</span>**

<table>
<tr>
<td>

<span dir="">Intervenants</span>
</td>
<td>

<span dir="">Commentaires</span>
</td>
</tr>
<tr>
<td>

<span dir="">MOE</span>
</td>
<td>

<span dir="">VODUNGBO Jeanne (Cheffe du pôle MOE) - </span><span dir="">jeanne.vodungbo@developpement-durable.gouv.fr</span>
</td>
</tr>
<tr>
<td>

</td>
<td>

<span dir="">- FAYOL Pascale (Cheffe de projet SIRH) - </span><span dir="">Pascale.Fayol@developpement-durable.gouv.fr</span>
</td>
</tr>
<tr>
<td>

</td>
<td>

<span dir="">- ASPERTI Dominique (Chargée de projet SIRH) - </span><span dir="">Dominique.Asperti@developpement-durable.gouv.fr</span>
</td>
</tr>
<tr>
<td>

</td>
<td>

<span dir="">- DROMZEE Thierry (Chargé de projet SIRH) - </span><span dir="">Thierry.Dromzee@developpement-durable.gouv.fr</span>
</td>
</tr>
<tr>
<td>

<span dir="">MOA - SG/DAEI/SPAG/SAG</span>
</td>
<td>

<span dir="">GAUTIER Sandrine (Cheffe du bureau stratégie et affaires générales) - </span><span dir="">sandrine.gautier@developpement-durable.gouv.fr</span>
</td>
</tr>
<tr>
<td>

<span dir="">MOA/AMO/Product Owner</span>
</td>
<td>

</td>
</tr>
<tr>
<td>

<span dir="">AMO</span>
</td>
<td>

</td>
</tr>
<tr>
<td>

<span dir="">Scrum Master si agile</span>
</td>
<td>

</td>
</tr>
<tr>
<td>

<span dir="">TMA</span>
</td>
<td>

</td>
</tr>
<tr>
<td>

<span dir="">Hébergement</span>
</td>
<td>

</td>
</tr>
<tr>
<td>

<span dir="">Administration</span>
</td>
<td>

</td>
</tr>
<tr>
<td>

<span dir="">Exploit / MCO</span>
</td>
<td>

</td>
</tr>
<tr>
<td>

<span dir="">Assistance</span>
</td>
<td>

</td>
</tr>
<tr>
<td>

<span dir="">Supervision</span>
</td>
<td>

</td>
</tr>
</table>

**<span dir="">Acquisitions</span>**

**<span dir="">Marchés mobilisés pour maintenance applicative, recette, exploitation</span>**

**<span dir="">Maintenance, support et licences matérielles, logicielles</span>**

**<span dir="">Liens / URL</span>**

**<span dir="">URL du site en production :</span>**

https://speddi.e2.rie.gouv.fr/

[(Ancienne URL  : <span dir="">http://10.100.1.8/speddi/public/</span>)](http://10.100.1.8/speddi/public/)

* <span dir="">fiche programme d'action annuelle correspondante</span>
* <span dir="">projet du portail hébergement</span>

<span dir="">Fichiers</span>

 
```

</details>


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

````

</details>


---

### 📄 `si/ttc.analysis.md` [12.604 octets]
<a id="si-ttc-analysis-md"></a> [↩ Retour à l'arborescence](#tree-si-ttc-analysis-md)

> **Chemin relatif** : `si/ttc.analysis.md`  
> **Taille** : 12.604 octets  
> **Lignes** : 426  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (426 lignes) - Cliquer pour déplier</summary>

````markdown
# 📋 Analyse détaillée de l’application TTC  
> *Temps de Travail Compensés — Ministère de la Transition écologique et de la Cohésion des territoires*

---

## 📚 Sommaire

- [1. Vue d’ensemble](#1-vue-densemble)
- [2. Modèle fonctionnel](#2-modèle-fonctionnel)
  - [2.1 Acteurs](#21-acteurs)
  - [2.2 Cas d’usage principaux](#22-cas-dusage-principaux)
  - [2.3 Workflow de saisie manuelle](#23-workflow-de-saisie-manuelle)
  - [2.4 Règles métier](#24-règles-métier)
    - [2.4.1 Calcul du temps compensé](#241-calcul-du-temps-compensé)
    - [2.4.2 Contrôle de demi-journées](#242-contrôle-de-demi-journées)
    - [2.4.3 Encodage des moyens de transport](#243-encodage-des-moyens-de-transport)
- [3. Architecture technique](#3-architecture-technique)
  - [3.1 Vue d’ensemble](#31-vue-densemble)
  - [3.2 Structure du code](#32-structure-du-code)
  - [3.3 Dépendances majeures](#33-dépendances-majeures)
  - [3.4 Sécurité](#34-sécurité)
  - [3.5 Dette technique](#35-dette-technique)
- [4. Annexes](#4-annexes)
  - [4.1 Exemple de workflow complet (PlantUML)](#41-exemple-de-workflow-complet-plantuml)
  - [4.2 Modèle entité-relation (schéma simplifié)](#42-modèle-entité-relation-schéma-simplifié)

---

## 1. Vue d’ensemble

L’application **TTC** permet aux agents de la **DNUM (Direction du Numérique)** de :
- Saisir des demandes de temps de travail compensé (TTC), généralement liées à des déplacements professionnels.
- Les soumettre à validation par un manager.
- Générer automatiquement un formulaire PDF pré-rempli.
- Consulter l’historique et l’état de leurs demandes.

Elle repose sur une architecture **LAMP-like** (Linux, Apache, MySQL, PHP) avec :
- Une interface web en PHP pur (pas de framework moderne),
- Une génération de PDF via **FPDF/FPDI**,
- Une base de données relationnelle (MySQL),
- Des fonctionnalités d’administration (référentiels : Corps, Grade, Modalité…),
- Une logique métier encapsulée dans des classes (Agent, Demande) et fonctions utilitaires.

---

## 2. Modèle fonctionnel

### 2.1 Acteurs

```plantuml
@startuml
actor "Agent" as AG
actor "Manager" as MG
actor "Administrateur" as ADM

AG --> (Saisir demande)
AG --> (Consulter ses demandes)
AG --> (Générer PDF)

MG --> (Valider / Refuser)
MG --> (Consulter ses agents)

ADM --> (Gérer référentiels)
ADM --> (Corps / Grade / Modalité / Profil)

note right of AG
  Peut être aussi manager
end note
@enduml
```

---

### 2.2 Cas d’usage principaux

| Cas d’usage | Acteur principal | Description |
|-------------|------------------|-------------|
| `Saisir une demande (manuel)` | Agent | Formulaire structuré avec trajets, cottage, motifs. |
| `Valider une demande` | Manager | Accès via `pgDemandeValidation.php`, avec commentaires. |
| `Générer PDF` | Agent / Manager | PDF modèle rempli via `impress.php` → `FPDI`. |
| `Consulter historique` | Agent / Manager | Tableau avec lien "PDF", statut, suppression possible. |
| `Gérer référentiels` | Administrateur | CRUD sur Corps/Grade/Modalité/Profil via `pgAdm*`. |

---

### 2.3 Workflow de saisie manuelle

```plantuml
@startuml
title Workflow de saisie manuelle d’une demande

state "Form 1 : Info générales" as F1 {
  [Lieu, motif]
}
state "Form 2 : Trajets" as F2 {
  [Aller/Retour\nLieux, dates, heures\nMoyens de transport]
}
state "Form 3 : Cottage" as F3 {
  [Départ/Retour\nType : Jour, Matin, Soir, Heure]
}
state "Form 4 : Récapitulatif" as F4 {
  [Récap + validation]
}
state "Fin : PDF" as PDF

[*] --> F1
F1 --> F2 : Suivant
F2 --> F3 : Suivant
F3 --> F4 : Suivant
F4 --> PDF : Valider
PDF --> [*]

note right of F2
  Les heures de mission (début/fin)
  sont conditionnelles :
  ex. si "maison" → champ obligatoire
end note
@enduml
```

---

### 2.4 Règles métier

#### 2.4.1 Calcul du temps compensé

Extrait de `FonctionDemande.php` et `pgDemandeRecapitulatifManuelle.php` :

- **Durée trajet** =  
  `TpsTransport(heureAllerDepart, heureAllerArrivee, heureRetourDepart, heureRetourArrivee)`

- **Jours travaillés** =  
  `calculJoursTravail(cottageDepartDate, cottageRetourDate, cottageType)`

- **Compensation** =  
  `convertirMinuteToHeure(TpsComp())`  
  → `TpsComp()` semble être une fonction métier non exposée intégralement, mais l’appel `ImpressPDF($idDemande)` dans `impress.php` déclenche un calcul *« sur 6 mois »* (voir commentaire).

> ⚠️ **Remarque** : le calcul exact de `TpsComp()` n’est **pas complètement visible** dans les extraits — c’est une zone de dette fonctionnelle à investiguer.

#### 2.4.2 Contrôle de demi-journées

Fonction `controleJourTravail($nbJour)` dans `FonctionDemande.php` :

```php
function controleJourTravail($nbJour) {
  $division = fmod($nbJour, 0.5);
  return ($division == 0);
}
```

→ Seules les valeurs multiples de `0.5` sont autorisées (→ demi-journées).

##### Tableau des cas valides

| `cottageType` | Valeur stockée | Libellé affiché | Jours |
|---------------|----------------|-----------------|-------|
| `0`           | `jour`         | journée         | 1.0   |
| `1`           | `matin`        | matin           | 0.5   |
| `2`           | `soir`         | soir            | 0.5   |
| `3`           | `heure`        | durée personnalisée | `cottageDuree` (HH:MM → converti) |

> ✅ Validation : `controleJourTravail()` appelé lors de la validation finale.

---

#### 2.4.3 Encodage des moyens de transport

Le moyen de transport est stocké dans un **entier binaire compact** :

- Aller : `departMoyen = TransportToBinaire($moyenTAV, $moyenTAT, $moyenTAA)`
- Retour : `retourMoyen = TransportToBinaire($moyenTRV, $moyenTRT, $moyenTRA)`

Extrait implicite (via logique d’affichage dans `impress.php`) :

| Bit (×100/10/1) | Moyen |
|------------------|--------|
| `100` | Avion/Bateau |
| `10`  | Train        |
| `1`   | Voiture      |

➡️ Exemple :  
- Train + Voiture = `10 + 1 = 11`  
- Avion seul = `100`

##### Algorithme déduit

```plantuml
@startuml
title Encodage binaire des moyens de transport

start
:Input\n(voiture?, train?, avion?);
if (voiture?) then (oui)
  :result += 1;
endif
if (train?) then (oui)
  :result += 10;
endif
if (avion?) then (oui)
  :result += 100;
endif
:result;
stop
@enduml
```

> ✅ Réciproque : `BinaireToTransport()` décode cet entier pour affichage.

---

## 3. Architecture technique

### 3.1 Vue d’ensemble

```plantuml
@startuml
package "Client (Navigateur)" {
  [HTML/CSS/JS]
}

package "Serveur Web (PHP)" {
  [index.php] --> [main.php]
  [main.php] --> [src/application/*.php]
  [main.php] --> [src/include/Fonction*.php]
  [src/impress.php] --> [FPDF/FPDI]
}

package "Base de données" {
  [MySQL]
}

[HTML/CSS/JS] --> [main.php] : HTTP POST/GET
[src/application/*.php] --> [MySQL] : PDO\n(read/write)
[src/impress.php] --> [Formulaire.pdf] : Template PDF
[FPDF/FPDI] --> [Agent] : PDF généré

note right
  Pas de framework\n
  Architecture MVC partielle :\n
  - Vue : pg*.php\n
  - Contrôleur : main.php + switch\n
  - Modèle : class.*.php
end note
@enduml
```

---

### 3.2 Structure du code

```
src/
├── application/       # Vues & contrôleurs (hybrides)
│   ├── pgDemande*.php  # Workflow demande
│   ├── pgAdm*.php      # Admin référentiels
│   └── pgAgent*.php    # Gestion agents
├── classes/
│   ├── class.Agent.php
│   └── class.Demande.php   # Attributs : compensation, cottage*, joursTravail...
├── include/
│   ├── FonctionApplication.php  # Utils (ex. an_fr_date)
│   ├── FonctionDemande.php      # Métier : TpsTransport(), controleJourTravail()
│   └── lib/
│       ├── fpdf/                # Génération PDF
│       └── fpdi/                # Superposition sur PDF existant
├── images/
└── PDF/
    └── Formulaire.pdf           # Template officiel (scanné/rempli)
```

---

### 3.3 Dépendances majeures

| Composant | Version/Rôle | Risque |
|-----------|--------------|--------|
| **FPDF 1.7+** | Génération PDF de base | ✅ Stable, mais ancien (v1.7 ~2011) |
| **FPDI 1.6+** | Import/overlay PDF | ✅ Compatible, mais non maintenu (déprécié) |
| **PDO MySQL** | Accès BDD | ✅ Sécurisé si param. corrects |
| **PHP ~5.6–7.2** | Inféré par syntaxe (`<?php`, pas de types) | ⚠️ Obsolete, non supporté |

> 🔍 Pas de gestionnaire de dépendances (Composer absent) → dépendances embarquées.

---

### 3.4 Sécurité

✅ Points positifs :
- Utilisation de `PDO` avec paramètres (ex. `fr_an_date($_SESSION[...])` → pas de concat SQL brute visible),
- Session PHP pour authentification (`$_SESSION['matricule']`),
- Filtres HTML (`stripslashes`, `htmlentities` dans affichages).

⚠️ Risques identifiés :
- **XSS possible** : `echo $motif` sans `htmlspecialchars()` partout (ex. `pgDemandeConsultation.php`),
- **CSRF absent** : aucun token dans les formulaires,
- **Gestion d’erreur exposée** : `die('Erreur : '.$e->getMessage())` → fuite BDD,
- **Pas de rate-limiting** sur login (non visible, mais probable absent).

---

### 3.5 Dette technique

| Type | Exemples concrets | Impact |
|------|-------------------|--------|
| **Architecture** | `main.php` avec `switch($_GET['page'])` → God Controller | 🔴 Faible maintenabilité, couplage fort |
| **Duplication** | Même logique de transport dans `pgDemandeComplement.php`, `pgDemandeSaisieManuelle.php`, `impress.php` | 🟠 Répétition, risque d’incohérence |
| **Magic values** | `100/10/1` pour transport, `0/1/2/3` pour cottageType | 🟠 Lisibilité faible |
| **Encodage** | Fichiers `.php` avec mélange HTML/PHP/logique | 🟠 Difficile à tester, à déboguer |
| **Obsolescence** | FPDF/FPDI non maintenus, PHP < 7.4 | 🔴 Vulnérabilités futures |

> 🔧 **Recommandation** : refactoriser en couche métier (ex. `TransportEncoder`, `CompensationCalculator`) + API REST + front séparé.

---

## 4. Annexes

### 4.1 Exemple de workflow complet (PlantUML)

```plantuml
@startuml
actor Agent
participant "main.php" as MAIN
participant "pgDemandeSaisieManuelle.php" as FORM
participant "class.Demande" as DEM
participant "FonctionDemande.php" as FN
participant "impress.php" as PDFGEN
participant "FPDI" as FPDFI

Agent -> MAIN : GET ?page=demandeSaisieManuelle
MAIN -> FORM : include
FORM --> Agent : HTML + formulaires

Agent -> MAIN : POST (étape 3/4)
MAIN -> FN : TransportToBinaire(...)
FN --> MAIN : 111

MAIN -> DEM : new Demande(..., departMoyen=111, ...)
DEM --> MAIN : instance

MAIN -> FN : calculJoursTravail(...)
FN --> MAIN : 1.5

MAIN -> FN : TpsComp()
FN --> MAIN : 2h15

MAIN -> FORM : render récap
FORM --> Agent : page validation

Agent -> MAIN : Valider
MAIN -> DEM : $maDemande->save()
DEM --> MAIN : INSERT

MAIN -> PDFGEN : GET impress.php?arg=123
PDFGEN -> DEM : lire(123)
DEM --> PDFGEN : données
PDFGEN -> FPDFI : useTemplate(Formulaire.pdf)
FPDFI --> PDFGEN : PDF stream
PDFGEN --> Agent : PDF
@enduml
```

---

### 4.2 Modèle entité-relation (schéma simplifié)

```plantuml
@startuml
entity "Agent" as AG {
  * matricule : VARCHAR
  --
  nom
  prenom
  corps
  affectation
  manager (matricule)
}

entity "Demande" as DEM {
  * idDemande : INT
  --
  matricule
  dateDemande
  lieu
  motif
  transportAllerDepartDate
  ...
  departMoyen : INT (0–111)
  retourMoyen : INT (0–111)
  daysWorked : FLOAT
  compensation : TIME
  cottageDepart : DATE
  cottageRetour : DATE
  cottageType : TINYINT (0–3)
  avis : ENUM('', 'Acceptée', 'Refusée')
  dateAvis
  motivation
}

AG ||--o{ DEM : "soumet"

note right of DEM
  departMoyen/retourMoyen : encodage binaire\n
  1=voiture, 10=train, 100=avion
end note

note bottom of DEM
  cottageType :\n
  0=journée (1.0),\n
  1=matin (0.5),\n
  2=soir (0.5),\n
  3=personnalisé
end note
@enduml
```

---

## ✅ Conclusion

L’application **TTC** est un système métier **opérationnel**, bien adapté à son contexte administratif, mais souffrant d’une dette technique importante due à :
- Une architecture monolithique vieillissante,
- Des dépendances non maintenues,
- Une logique métier dispersée.


````

</details>


---

### 📄 `si/vaccination.analysis.md` [0 octets]
<a id="si-vaccination-analysis-md"></a> [↩ Retour à l'arborescence](#tree-si-vaccination-analysis-md)

> **Chemin relatif** : `si/vaccination.analysis.md`  
> **Taille** : 0 octets  
> **Lignes** : 0  
> **Type** : markdown

```markdown

```


---

### 📄 `si/ze-services.md` [526.856 octets]
<a id="si-ze-services-md"></a> [↩ Retour à l'arborescence](#tree-si-ze-services-md)

> **Chemin relatif** : `si/ze-services.md`  
> **Taille** : 526.856 octets  
> **Lignes** : 13253  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (13253 lignes) - Cliquer pour déplier</summary>

````markdown
﻿# Projet : ze-services

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\ze-services`

**Fichiers** : 59 fichiers non-binaires

## 📁 Arborescence des fichiers

├── **src/**
│   ├── **main/**
│   │   ├── **java/**
│   │   │   └── **ze/**
│   │   │       ├── **absence/**
│   │   │       │   ├── <a id="tree-src-main-java-ze-absence-Absence-java"></a>[Absence.java](#src-main-java-ze-absence-Absence-java) *(2.941 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-absence-AbsenceDAO-java"></a>[AbsenceDAO.java](#src-main-java-ze-absence-AbsenceDAO-java) *(8.816 octets)*
│   │   │       │   └── <a id="tree-src-main-java-ze-absence-AbsenceEnum-java"></a>[AbsenceEnum.java](#src-main-java-ze-absence-AbsenceEnum-java) *(403 octets)*
│   │   │       ├── **affectation/**
│   │   │       │   ├── <a id="tree-src-main-java-ze-affectation-Affectation-java"></a>[Affectation.java](#src-main-java-ze-affectation-Affectation-java) *(1.888 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-affectation-AffectationDAO-java"></a>[AffectationDAO.java](#src-main-java-ze-affectation-AffectationDAO-java) *(4.797 octets)*
│   │   │       │   └── <a id="tree-src-main-java-ze-affectation-AffectationEnum-java"></a>[AffectationEnum.java](#src-main-java-ze-affectation-AffectationEnum-java) *(272 octets)*
│   │   │       ├── **agent/**
│   │   │       │   ├── <a id="tree-src-main-java-ze-agent-Agent-java"></a>[Agent.java](#src-main-java-ze-agent-Agent-java) *(33.980 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-agent-AgentDAO-java"></a>[AgentDAO.java](#src-main-java-ze-agent-AgentDAO-java) *(29.813 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-agent-AgentEnum-java"></a>[AgentEnum.java](#src-main-java-ze-agent-AgentEnum-java) *(2.980 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-agent-Poste-java"></a>[Poste.java](#src-main-java-ze-agent-Poste-java) *(1.584 octets)*
│   │   │       │   └── <a id="tree-src-main-java-ze-agent-PosteEnum-java"></a>[PosteEnum.java](#src-main-java-ze-agent-PosteEnum-java) *(188 octets)*
│   │   │       ├── **carriere/**
│   │   │       │   ├── <a id="tree-src-main-java-ze-carriere-Carriere-java"></a>[Carriere.java](#src-main-java-ze-carriere-Carriere-java) *(4.136 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-carriere-CarriereDAO-java"></a>[CarriereDAO.java](#src-main-java-ze-carriere-CarriereDAO-java) *(4.326 octets)*
│   │   │       │   └── <a id="tree-src-main-java-ze-carriere-CarriereEnum-java"></a>[CarriereEnum.java](#src-main-java-ze-carriere-CarriereEnum-java) *(357 octets)*
│   │   │       ├── **database/**
│   │   │       │   └── **utils/**
│   │   │       │       └── <a id="tree-src-main-java-ze-database-utils-DataBase-java"></a>[DataBase.java](#src-main-java-ze-database-utils-DataBase-java) *(3.789 octets)*
│   │   │       ├── **habilitation/**
│   │   │       │   ├── <a id="tree-src-main-java-ze-habilitation-Habilitation-java"></a>[Habilitation.java](#src-main-java-ze-habilitation-Habilitation-java) *(4.364 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-habilitation-HabilitationDAO-java"></a>[HabilitationDAO.java](#src-main-java-ze-habilitation-HabilitationDAO-java) *(4.473 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-habilitation-HabilitationEnum-java"></a>[HabilitationEnum.java](#src-main-java-ze-habilitation-HabilitationEnum-java) *(582 octets)*
│   │   │       │   └── <a id="tree-src-main-java-ze-habilitation-Profil-java"></a>[Profil.java](#src-main-java-ze-habilitation-Profil-java) *(2.553 octets)*
│   │   │       ├── **impl/**
│   │   │       │   ├── <a id="tree-src-main-java-ze-impl-Authorisation-java"></a>[Authorisation.java](#src-main-java-ze-impl-Authorisation-java) *(1.033 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-impl-CsvFileWriter-java"></a>[CsvFileWriter.java](#src-main-java-ze-impl-CsvFileWriter-java) *(82.453 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-impl-ErrorResponse-java"></a>[ErrorResponse.java](#src-main-java-ze-impl-ErrorResponse-java) *(744 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-impl-SendMail-java"></a>[SendMail.java](#src-main-java-ze-impl-SendMail-java) *(2.302 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-impl-SoapMessage-java"></a>[SoapMessage.java](#src-main-java-ze-impl-SoapMessage-java) *(3.348 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-impl-TrustAllCertificates-java"></a>[TrustAllCertificates.java](#src-main-java-ze-impl-TrustAllCertificates-java) *(1.266 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-impl-Utils-java"></a>[Utils.java](#src-main-java-ze-impl-Utils-java) *(4.352 octets)*
│   │   │       │   └── <a id="tree-src-main-java-ze-impl-WebServiceImpl-java"></a>[WebServiceImpl.java](#src-main-java-ze-impl-WebServiceImpl-java) *(68.282 octets)*
│   │   │       ├── **quotite/**
│   │   │       │   ├── <a id="tree-src-main-java-ze-quotite-Quotite-java"></a>[Quotite.java](#src-main-java-ze-quotite-Quotite-java) *(4.738 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-quotite-QuotiteDAO-java"></a>[QuotiteDAO.java](#src-main-java-ze-quotite-QuotiteDAO-java) *(5.419 octets)*
│   │   │       │   └── <a id="tree-src-main-java-ze-quotite-QuotiteEnum-java"></a>[QuotiteEnum.java](#src-main-java-ze-quotite-QuotiteEnum-java) *(378 octets)*
│   │   │       ├── **reglementaire/**
│   │   │       │   ├── <a id="tree-src-main-java-ze-reglementaire-Contractuel-java"></a>[Contractuel.java](#src-main-java-ze-reglementaire-Contractuel-java) *(5.009 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-reglementaire-ContractuelDAO-java"></a>[ContractuelDAO.java](#src-main-java-ze-reglementaire-ContractuelDAO-java) *(7.008 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-reglementaire-ContractuelEnum-java"></a>[ContractuelEnum.java](#src-main-java-ze-reglementaire-ContractuelEnum-java) *(540 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-reglementaire-Corps-java"></a>[Corps.java](#src-main-java-ze-reglementaire-Corps-java) *(9.574 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-reglementaire-CorpsDAO-java"></a>[CorpsDAO.java](#src-main-java-ze-reglementaire-CorpsDAO-java) *(7.711 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-reglementaire-CorpsEnum-java"></a>[CorpsEnum.java](#src-main-java-ze-reglementaire-CorpsEnum-java) *(913 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-reglementaire-Grade-java"></a>[Grade.java](#src-main-java-ze-reglementaire-Grade-java) *(9.611 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-reglementaire-GradeDAO-java"></a>[GradeDAO.java](#src-main-java-ze-reglementaire-GradeDAO-java) *(7.243 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-reglementaire-GradeEnum-java"></a>[GradeEnum.java](#src-main-java-ze-reglementaire-GradeEnum-java) *(912 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-reglementaire-Reglementaire-java"></a>[Reglementaire.java](#src-main-java-ze-reglementaire-Reglementaire-java) *(9.501 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-reglementaire-ReglementaireDAO-java"></a>[ReglementaireDAO.java](#src-main-java-ze-reglementaire-ReglementaireDAO-java) *(21.241 octets)*
│   │   │       │   └── <a id="tree-src-main-java-ze-reglementaire-ReglementaireEnum-java"></a>[ReglementaireEnum.java](#src-main-java-ze-reglementaire-ReglementaireEnum-java) *(575 octets)*
│   │   │       ├── **remuneration/**
│   │   │       │   ├── <a id="tree-src-main-java-ze-remuneration-Remuneration-java"></a>[Remuneration.java](#src-main-java-ze-remuneration-Remuneration-java) *(7.416 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-remuneration-RemunerationDAO-java"></a>[RemunerationDAO.java](#src-main-java-ze-remuneration-RemunerationDAO-java) *(9.390 octets)*
│   │   │       │   └── <a id="tree-src-main-java-ze-remuneration-RemunerationEnum-java"></a>[RemunerationEnum.java](#src-main-java-ze-remuneration-RemunerationEnum-java) *(1.118 octets)*
│   │   │       ├── **unitestructurelle/**
│   │   │       │   ├── <a id="tree-src-main-java-ze-unitestructurelle-ArbreUniteStructurelle-java"></a>[ArbreUniteStructurelle.java](#src-main-java-ze-unitestructurelle-ArbreUniteStructurelle-java) *(987 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-unitestructurelle-USEnum-java"></a>[USEnum.java](#src-main-java-ze-unitestructurelle-USEnum-java) *(773 octets)*
│   │   │       │   ├── <a id="tree-src-main-java-ze-unitestructurelle-UniteStructurelle-java"></a>[UniteStructurelle.java](#src-main-java-ze-unitestructurelle-UniteStructurelle-java) *(10.613 octets)*
│   │   │       │   └── <a id="tree-src-main-java-ze-unitestructurelle-UniteStructurelleDAO-java"></a>[UniteStructurelleDAO.java](#src-main-java-ze-unitestructurelle-UniteStructurelleDAO-java) *(19.431 octets)*
│   │   │       └── <a id="tree-src-main-java-ze-WebService-java"></a>[WebService.java](#src-main-java-ze-WebService-java) *(26.248 octets)*
│   │   └── **resources/**
│   │       ├── **OSGI-INF/**
│   │       │   └── **blueprint/**
│   │       │       └── <a id="tree-src-main-resources-OSGI-INF-blueprint-my-service-xml"></a>[my-service.xml](#src-main-resources-OSGI-INF-blueprint-my-service-xml) *(2.525 octets)*
│   │       └── <a id="tree-src-main-resources-ze_config-properties"></a>[ze_config.properties](#src-main-resources-ze_config-properties) *(642 octets)*
│   └── **test/**
│       └── **java/**
│           ├── <a id="tree-src-test-java-Grade-java"></a>[Grade.java](#src-test-java-Grade-java) *(5.870 octets)*
│           └── <a id="tree-src-test-java-UniteStructurelle-java"></a>[UniteStructurelle.java](#src-test-java-UniteStructurelle-java) *(14.675 octets)*
├── <a id="tree--gitignore"></a>[.gitignore](#-gitignore) *(6 octets)*
├── <a id="tree--gitlab-ci-yml"></a>[.gitlab-ci.yml](#-gitlab-ci-yml) *(388 octets)*
├── <a id="tree-README-md"></a>[README.md](#README-md) *(45 octets)*
├── <a id="tree-pom-xml"></a>[pom.xml](#pom-xml) *(6.048 octets)*
└── <a id="tree-settings-xml"></a>[settings.xml](#settings-xml) *(875 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `.gitignore` [6 octets]
<a id="-gitignore"></a> [↩ Retour à l'arborescence](#tree--gitignore)

> **Chemin relatif** : `.gitignore`  
> **Taille** : 6 octets  
> **Lignes** : 1  
> **Type** : text

```text
target
```


---

### 📄 `.gitlab-ci.yml` [388 octets]
<a id="-gitlab-ci-yml"></a> [↩ Retour à l'arborescence](#tree--gitlab-ci-yml)

> **Chemin relatif** : `.gitlab-ci.yml`  
> **Taille** : 388 octets  
> **Lignes** : 24  
> **Type** : yaml

```yaml
stages:
  - build_jar

cache:
  paths:
    - .m2/repository

build_jar:
  image:
    name: maven:3.6-adoptopenjdk-8
  stage: build_jar
  artifacts:
    name: "$CI_BUILD"
    paths:
      - $CI_PROJECT_DIR/target/zechange-services.jar
    when: always
    expire_in: 3 days
  script:
    - mvn deploy -s settings.xml -Dmaven.compiler.failOnError=false
  only:
    - tags
  tags:
    - gcp

```


---

### 📄 `pom.xml` [6.048 octets]
<a id="pom-xml"></a> [↩ Retour à l'arborescence](#tree-pom-xml)

> **Chemin relatif** : `pom.xml`  
> **Taille** : 6.048 octets  
> **Lignes** : 155  
> **Type** : xml

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (155 lignes) - Cliquer pour déplier</summary>

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>fr.gouv.e2.zechange</groupId>
    <artifactId>zechange-services</artifactId>
    <version>2.4.5</version>

    <packaging>jar</packaging>
    <name>ZE-Services</name>
    <description>Partie web-services de Zone d'Echange</description>

    <properties>
        <cxf.version>3.1.11</cxf.version>
        <osgi.version>6.0.0</osgi.version>
        <project.build.outputEncoding>UTF-8</project.build.outputEncoding>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
    </properties>

    <dependencies>
        <dependency>
            <groupId>org.apache.cxf</groupId>
            <artifactId>cxf-rt-frontend-jaxrs</artifactId>
            <version>${cxf.version}</version>
        </dependency>
        <dependency>
            <groupId>org.apache.servicemix.bundles</groupId>
            <artifactId>org.apache.servicemix.bundles.swagger-annotations</artifactId>
            <version>1.3.13_1</version>
        </dependency>
        <dependency>
            <groupId>org.apache.servicemix.bundles</groupId>
            <artifactId>org.apache.servicemix.bundles.swagger-jaxrs_2.11</artifactId>
            <version>1.3.12_2</version>
        </dependency>
        <dependency>
            <groupId>org.apache.cxf</groupId>
            <artifactId>cxf-rt-rs-service-description-swagger</artifactId>
            <version>${cxf.version}</version>
        </dependency>
        <dependency>
            <groupId>org.webjars</groupId>
            <artifactId>swagger-ui</artifactId>
            <version>2.2.5</version>
        </dependency>
        <dependency>
            <groupId>org.apache.cxf</groupId>
            <artifactId>cxf-rt-rs-security-cors</artifactId>
            <version>${cxf.version}</version>
        </dependency>
        <dependency>
            <groupId>com.fasterxml.jackson.core</groupId>
            <artifactId>jackson-annotations</artifactId>
            <version>2.8.7</version>
        </dependency>
        <dependency>
            <groupId>com.fasterxml.jackson.core</groupId>
            <artifactId>jackson-databind</artifactId>
            <version>2.8.7</version>
        </dependency>
        <dependency>
            <groupId>org.apache.httpcomponents</groupId>
            <artifactId>httpclient</artifactId>
            <version>4.5.3</version>
        </dependency>
        <dependency>
            <groupId>com.googlecode.json-simple</groupId>
            <artifactId>json-simple</artifactId>
            <version>1.1</version>
        </dependency>
        <dependency>
            <groupId>javax.mail</groupId>
            <artifactId>mail</artifactId>
            <version>1.4.4</version>
        </dependency>

        <dependency>
            <groupId>org.osgi</groupId>
            <artifactId>org.osgi.core</artifactId>
            <version>${osgi.version}</version>
            <scope>provided</scope>
        </dependency>

        <dependency>
            <groupId>org.apache.cxf</groupId>
            <artifactId>cxf-rt-frontend-jaxws</artifactId>
            <version>${cxf.version}</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>org.apache.cxf</groupId>
            <artifactId>cxf-rt-transports-http</artifactId>
            <version>${cxf.version}</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>org.apache.cxf</groupId>
            <artifactId>cxf-rt-transports-http-jetty</artifactId>
            <version>${cxf.version}</version>
            <scope>provided</scope>
        </dependency>
    </dependencies>

    <build>
        <finalName>${project.artifactId}</finalName>
        <plugins>
            <plugin>
                <groupId>org.apache.felix</groupId>
                <artifactId>maven-bundle-plugin</artifactId>
                <version>3.3.0</version>
                <extensions>true</extensions>
                <configuration>
                    <instructions>
                        <Bundle-SymbolicName>${project.artifactId}</Bundle-SymbolicName>
                        <Bundle-Version>${project.version}</Bundle-Version>
                        <Export-Package>RestWebservice.ZE;version=${project.version}</Export-Package>
                        <Import-Package>*, org.postgresql</Import-Package>
                    </instructions>
                    <encoding>${project.build.sourceEncoding}</encoding>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <configuration>
                    <source>1.8</source>
                    <target>1.8</target>
                    <encoding>${project.build.sourceEncoding}</encoding>
                    <maxmem>256M</maxmem>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-resources-plugin</artifactId>
                <configuration>
                    <encoding>UTF-8</encoding>
                </configuration>
            </plugin>
        </plugins>
    </build>

    <distributionManagement>
        <repository>
            <id>gitlab-maven</id>
            <url>${env.CI_SERVER_URL}/api/v4/projects/${env.CI_PROJECT_ID}/packages/maven</url>
        </repository>
        <snapshotRepository>
            <id>gitlab-maven</id>
            <url>${env.CI_SERVER_URL}/api/v4/projects/${env.CI_PROJECT_ID}/packages/maven</url>
        </snapshotRepository>
    </distributionManagement>

</project>

```

</details>


---

### 📄 `README.md` [45 octets]
<a id="README-md"></a> [↩ Retour à l'arborescence](#tree-README-md)

> **Chemin relatif** : `README.md`  
> **Taille** : 45 octets  
> **Lignes** : 2  
> **Type** : markdown

```markdown
mvn -f pom.xml -U -nsu clean install compile

```


---

### 📄 `settings.xml` [875 octets]
<a id="settings-xml"></a> [↩ Retour à l'arborescence](#tree-settings-xml)

> **Chemin relatif** : `settings.xml`  
> **Taille** : 875 octets  
> **Lignes** : 36  
> **Type** : xml

```xml
<settings xmlns="http://maven.apache.org/SETTINGS/1.0.0"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0
                      http://maven.apache.org/xsd/settings-1.0.0.xsd" >

	<servers>
		<server>
			<id>gitlab-maven</id>
			<configuration>
				<httpHeaders>
					<property>
						<name>Job-Token</name>
						<value>${env.CI_JOB_TOKEN}</value>
					</property>
				</httpHeaders>
			</configuration>
		</server>
	</servers>

	<profiles>
		<profile>
			<id>forge</id>
			<repositories>
				<repository>
					<id>gitlab-maven</id>
					<url>https://gitlab-forge.din.developpement-durable.gouv.fr/api/v4/projects/${env.CI_PROJECT_ID}/packages/maven</url>
				</repository>
			</repositories>
		</profile>
	</profiles>

	<activeProfiles>
		<activeProfile>forge</activeProfile>
	</activeProfiles>

</settings>
```


---

### 📄 `src/main/java/ze/absence/Absence.java` [2.941 octets]
<a id="src-main-java-ze-absence-Absence-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-absence-Absence-java)

> **Chemin relatif** : `src/main/java/ze/absence/Absence.java`  
> **Taille** : 2.941 octets  
> **Lignes** : 139  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (139 lignes) - Cliquer pour déplier</summary>

```java
package ze.absence;

import javax.xml.bind.annotation.XmlRootElement;
import javax.xml.bind.annotation.XmlType;

import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;

@XmlRootElement(name = "Absence")
@XmlType(
		name = "",
		propOrder = { "absMatcle", "absMotif", "absDebImpact", "absTemDeb", "absFinTranche", "absTemFin",
				"absTemoinAbsence",
				"absNbrJour", "absNumDroit", "absNumTranche", "absTemoinValid", "erreur" })
@JsonInclude(JsonInclude.Include.NON_DEFAULT)
public class Absence {

	private String absMatcle;

	private String absMotif;

	private String absDebImpact;

	private String absTemDeb;

	private String absFinTranche;

	private String absTemFin;

	private String absNbrJour;

	private String absNumDroit;

	private String absNumTranche;

	private String absTemoin;

	private String erreur;

	@JsonProperty("absence_conges_matricule_renoirh")
	public String getAbsMatcle() {
		return absMatcle;
	}

	public void setAbsMatcle(String absMatcle) {
		this.absMatcle = absMatcle;
	}

	@JsonProperty("absence_conges_motif")
	public String getAbsMotif() {
		return absMotif;
	}

	public void setAbsMotif(String absMotif) {
		this.absMotif = absMotif;
	}

	@JsonProperty("absence_conges_date_debut_impact_remuneration")
	public String getAbsDebImpact() {
		return absDebImpact;
	}

	public void setAbsDebImpact(String absDebImpact) {
		this.absDebImpact = absDebImpact;
	}

	@JsonProperty("absence_conges_temoin_debut_impact_remuneration")
	public String getAbsTemDeb() {
		return absTemDeb;
	}

	public void setAbsTemDeb(String absTemDeb) {
		this.absTemDeb = absTemDeb;
	}

	@JsonProperty("absence_conges_date_fin_tranche")
	public String getAbsFinTranche() {
		return absFinTranche;
	}

	public void setAbsFinTranche(String absFinTranche) {
		this.absFinTranche = absFinTranche;
	}

	@JsonProperty("absence_conges_temoin_absence")
	public String getAbsTemFin() {
		return absTemFin;
	}

	public void setAbsTemFin(String absTemFin) {
		this.absTemFin = absTemFin;
	}

	@JsonProperty("absence_conges_nombre_jours")
	public String getAbsNbrJour() {
		return absNbrJour;
	}

	public void setAbsNbrJour(String absNbrJour) {
		this.absNbrJour = absNbrJour;
	}

	@JsonProperty("absence_conges_numero_droit")
	public String getAbsNumDroit() {
		return absNumDroit;
	}

	public void setAbsNumDroit(String absNumDroit) {
		this.absNumDroit = absNumDroit;
	}

	@JsonProperty("absence_conges_numero_de_tranche")
	public String getAbsNumTranche() {
		return absNumTranche;
	}

	public void setAbsNumTranche(String absNumTranche) {
		this.absNumTranche = absNumTranche;
	}

	@JsonProperty("absence_conges_temoin_de_validite")
	public String getAbsTemoin() {
		return absTemoin;
	}

	public void setAbsTemoin(String absTemoin) {
		this.absTemoin = absTemoin;
	}

	public String getErreur() {
		return erreur;
	}

	public void setErreur(String erreur) {
		this.erreur = erreur;
	}

}

```

</details>


---

### 📄 `src/main/java/ze/absence/AbsenceDAO.java` [8.816 octets]
<a id="src-main-java-ze-absence-AbsenceDAO-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-absence-AbsenceDAO-java)

> **Chemin relatif** : `src/main/java/ze/absence/AbsenceDAO.java`  
> **Taille** : 8.816 octets  
> **Lignes** : 241  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (241 lignes) - Cliquer pour déplier</summary>

```java
package ze.absence;

import java.sql.Array;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.regex.Pattern;

import org.apache.commons.lang3.StringUtils;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import ze.agent.AgentDAO;
import ze.database.utils.DataBase;
import ze.impl.Utils;
import ze.remuneration.RemunerationDAO;

public class AbsenceDAO {

	private static final Utils UTILS = new Utils();

	private static final Logger LOG = LoggerFactory.getLogger(AbsenceDAO.class);

	private static final Pattern SPLIT_ID_PATTERN = Pattern.compile("[()']");

	private static final int HUIT = 8;

	private static final int SIX = 6;

	private static final int QUATRE = 4;

	/*
	 * Récupère la liste de grades associées aux paramètres de recherches fournis
	 */
	public List<Absence> getList(String recherche, String matricule, String numeroDroit, String temoinValidation,
			String motifAbsence,
			String exportDateEffet) {

		String[] rechercheNormalizedSplit = { "" };
		if (recherche != null) {
			// On retire les accents et on met en minuscule le texte de recherche
			rechercheNormalizedSplit = StringUtils.stripAccents(recherche.toLowerCase()).split(" ");
		}
		int rechercheLength = rechercheNormalizedSplit.length;

		StringBuilder req = createRequest(rechercheNormalizedSplit, rechercheLength, matricule, numeroDroit,
				motifAbsence, temoinValidation, exportDateEffet);

		String[] matcleArray = {};
		String[] droitArray = {};
		String[] motifArray = {};
		if (matricule != null) {
			matcleArray = SPLIT_ID_PATTERN.matcher(matricule).replaceAll("").split(",");
		}
		if (numeroDroit != null) {
			droitArray = SPLIT_ID_PATTERN.matcher(numeroDroit).replaceAll("").split(",");
		}
		if (motifAbsence != null) {
			motifArray = SPLIT_ID_PATTERN.matcher(motifAbsence).replaceAll("").split(",");
		}
		ArrayList<String> matcleList = new ArrayList<>(Arrays.asList(matcleArray));
		ArrayList<String> droitList = new ArrayList<>(Arrays.asList(droitArray));
		ArrayList<String> motifList = new ArrayList<>(Arrays.asList(motifArray));
		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		ArrayList<Absence> listAbsence = new ArrayList<>();
		try {
			con = DriverManager.getConnection(UTILS.getUrl(), UTILS.getUser(), UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			updateParam(rechercheLength, rechercheNormalizedSplit, matricule, numeroDroit, motifAbsence,
					temoinValidation, exportDateEffet, con, st);
			LOG.info("Requête: {}", st.toString());
			rs = st.executeQuery();
			while (rs.next()) {
				if (rs.getString(AbsenceEnum.ABSENCE_CONGES_NUMERO_DROIT.toString()) != null) {
					listAbsence.add(processRow(rs));
					matcleList.remove(rs.getString(AbsenceEnum.ABSENCE_CONGES_MATRICULE_RENOIRH.toString()));
					droitList.remove(rs.getString(AbsenceEnum.ABSENCE_CONGES_NUMERO_DROIT.toString()));
					motifList.remove(rs.getString(AbsenceEnum.ABSENCE_CONGES_MOTIF.toString()));
				}
			}
			for (String s : matcleList) {
				Absence abs = new Absence();
				abs.setAbsMatcle(s);
				abs.setErreur("404 : Matricule non trouvé");
				listAbsence.add(abs);
			}
			for (String s : droitList) {
				Absence abs = new Absence();
				abs.setAbsNumDroit(s);
				abs.setErreur("404 : Numéro de droit non trouvé");
				listAbsence.add(abs);
			}
			for (String s : motifList) {
				Absence abs = new Absence();
				abs.setAbsMotif(s);
				abs.setErreur("404 : Motif non trouvé");
				listAbsence.add(abs);
			}
			return listAbsence;
		} catch (SQLException e) {
			UTILS.erreurAccesBase(e);
		} catch (Exception e) {
			UTILS.erreurInnatendue(e);
		} finally {
			UTILS.closeConnexion(rs, st, con);
		}
		return listAbsence;
	}

	/*
	 * Création de la requête
	 */
	protected StringBuilder createRequest(String[] rechercheNormalizedSplit, int rechercheLength, String matricule,
			String numeroDroit, String motifAbsence, String temoinValidation, String exportDateEffet) {
		StringBuilder req = new StringBuilder();
		req.append(" SELECT absence_conges_matricule_renoirh, absence_conges_motif,")
				.append(" absence_conges_date_debut_impact_remuneration, absence_conges_temoin_debut_impact_remuneration,")
				.append(" absence_conges_date_fin_tranche, absence_conges_temoin_absence, absence_conges_nombre_jours,")
				.append(" absence_conges_numero_droit, absence_conges_numero_de_tranche, absence_conges_temoin_de_validite")
				.append(" FROM ABSENCES_CONGES")
				.append(" WHERE");

		// Prise en compte du champ recherche		
		Connection cnx = null;
		try {
			cnx = DriverManager.getConnection(AbsenceDAO.UTILS.getUrl(), AbsenceDAO.UTILS.getUser(),
					AbsenceDAO.UTILS.getPassword());
			req.append("(")
					.append(DataBase.getGoogleQuery(cnx, "ABSENCES_CONGES", rechercheNormalizedSplit))
					.append(")");
		} catch (final SQLException e) {
			AbsenceDAO.UTILS.erreurAccesBase(e);
		} catch (final Exception e) {
			AbsenceDAO.UTILS.erreurInnatendue(e);
		} finally {
			AbsenceDAO.UTILS.closeConnexion(null, null, cnx);
		}

		// Prise en compte du champ matricule
		if (matricule != null) {
			req.append(" AND absence_conges_matricule_renoirh = ANY(?)");
		}

		// Prise en compte du champ codeTG
		if (numeroDroit != null) {
			req.append(" AND absence_conges_numero_droit = ANY(?)");
		}

		// Prise en compte du champ temoinValidationPaye
		if (temoinValidation != null) {
			req.append(" AND absence_conges_temoin_de_validite = ?");
		}

		// Prise en compte du champ motifAbsence
		if (motifAbsence != null) {
			req.append(" AND absence_conges_motif = ANY(?)");
		}

		// Prise en compte du champ exportDateEffet
		if (exportDateEffet != null) {
			if (exportDateEffet.length() == HUIT) {
				req.append(
						" AND (to_char(absence_conges_date_fin_tranche, 'YYYYMMDD') >= ? OR to_char(absence_conges_date_debut_impact_remuneration, 'YYYYMMDD') >= ?)");
			} else if (exportDateEffet.length() == SIX) {
				req.append(
						" AND (to_char(absence_conges_date_fin_tranche, 'YYYYMM') >= ? OR to_char(absence_conges_date_debut_impact_remuneration, 'YYYYMM') >= ?)");
			} else if (exportDateEffet.length() == QUATRE) {
				req.append(
						" AND (to_char(absence_conges_date_fin_tranche, 'YYYY') >= ? OR to_char(absence_conges_date_debut_impact_remuneration, 'YYYY') >= ?)");
			} else {
				throw new IllegalStateException();
			}
		}
		return req;
	}

	/*
	 * Mise à jour des paramètres de la requête
	 */
	protected void updateParam(int rechercheLength, String[] rechercheNormalizedSplit, String matricule,
			String numeroDroit,
			String motifAbsence, String temoinValidation, String exportDateEffet, Connection con,
			PreparedStatement st) {
		try {
			int j = 0;
			if (matricule != null) {
				j++;
				Array a = con.createArrayOf("text", SPLIT_ID_PATTERN.matcher(matricule).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (numeroDroit != null) {
				j++;
				Array a = con.createArrayOf("text", SPLIT_ID_PATTERN.matcher(numeroDroit).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (temoinValidation != null) {
				j++;
				st.setString(j, temoinValidation);
			}
			if (motifAbsence != null) {
				j++;
				Array a = con.createArrayOf("text", SPLIT_ID_PATTERN.matcher(motifAbsence).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (exportDateEffet != null) {
				j++;
				st.setString(j, exportDateEffet);
				st.setString(j + 1, exportDateEffet);
			}
		} catch (SQLException e) {
			UTILS.erreurAccesBase(e);
		}

	}

	/*
	 * Récupère une rémunération complète
	 */
	protected Absence processRow(ResultSet rs) throws SQLException {
		Absence absence = new Absence();
		absence.setAbsMatcle(rs.getString(AbsenceEnum.ABSENCE_CONGES_MATRICULE_RENOIRH.toString()));
		absence.setAbsMotif(rs.getString(AbsenceEnum.ABSENCE_CONGES_MOTIF.toString()));
		absence.setAbsDebImpact(rs.getString(AbsenceEnum.ABSENCE_CONGES_DATE_DEBUT_IMPACT_REMUNERATION.toString()));
		absence.setAbsTemDeb(rs.getString(AbsenceEnum.ABSENCE_CONGES_TEMOIN_DEBUT_IMPACT_REMUNERATION.toString()));
		absence.setAbsFinTranche(rs.getString(AbsenceEnum.ABSENCE_CONGES_DATE_FIN_TRANCHE.toString()));
		absence.setAbsTemFin(rs.getString(AbsenceEnum.ABSENCE_CONGES_TEMOIN_ABSENCE.toString()));
		absence.setAbsNbrJour(rs.getString(AbsenceEnum.ABSENCE_CONGES_NOMBRE_JOURS.toString()));
		absence.setAbsNumDroit(rs.getString(AbsenceEnum.ABSENCE_CONGES_NUMERO_DROIT.toString()));
		absence.setAbsNumTranche(rs.getString(AbsenceEnum.ABSENCE_CONGES_NUMERO_DE_TRANCHE.toString()));
		absence.setAbsTemoin(rs.getString(AbsenceEnum.ABSENCE_CONGES_TEMOIN_DE_VALIDITE.toString()));
		return absence;
	}
}

```

</details>


---

### 📄 `src/main/java/ze/absence/AbsenceEnum.java` [403 octets]
<a id="src-main-java-ze-absence-AbsenceEnum-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-absence-AbsenceEnum-java)

> **Chemin relatif** : `src/main/java/ze/absence/AbsenceEnum.java`  
> **Taille** : 403 octets  
> **Lignes** : 16  
> **Type** : java

```java
package ze.absence;

public enum AbsenceEnum {

	ABSENCE_CONGES_MATRICULE_RENOIRH,
	ABSENCE_CONGES_MOTIF,
	ABSENCE_CONGES_DATE_DEBUT_IMPACT_REMUNERATION,
	ABSENCE_CONGES_TEMOIN_DEBUT_IMPACT_REMUNERATION,
	ABSENCE_CONGES_DATE_FIN_TRANCHE,
	ABSENCE_CONGES_TEMOIN_ABSENCE,
	ABSENCE_CONGES_NOMBRE_JOURS,
	ABSENCE_CONGES_NUMERO_DROIT,
	ABSENCE_CONGES_NUMERO_DE_TRANCHE,
	ABSENCE_CONGES_TEMOIN_DE_VALIDITE;
}

```


---

### 📄 `src/main/java/ze/affectation/Affectation.java` [1.888 octets]
<a id="src-main-java-ze-affectation-Affectation-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-affectation-Affectation-java)

> **Chemin relatif** : `src/main/java/ze/affectation/Affectation.java`  
> **Taille** : 1.888 octets  
> **Lignes** : 92  
> **Type** : java

```java
package ze.affectation;

import javax.xml.bind.annotation.XmlRootElement;
import javax.xml.bind.annotation.XmlType;

import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;

@XmlRootElement(name = "Affectation")
@XmlType(name = "", propOrder = { "matcle", "nom", "prenom", "dateEffet", "dateFin", "unite", "temoinValidite" })
@JsonInclude(JsonInclude.Include.NON_DEFAULT)
public class Affectation {

	private String matcle;

	private String nom;

	private String prenom;

	private String dateEffet;

	private String dateFin;

	private String unite;

	private String temoinValidite;

	@JsonProperty("affectation_administrative_matricule")
	public String getMatcle() {
		return matcle;
	}

	public void setMatcle(String matcle) {
		this.matcle = matcle;
	}

	@JsonProperty("affectation_administrative_nom")
	public String getNom() {
		return nom;
	}

	public void setNom(String nom) {
		this.nom = nom;
	}

	@JsonProperty("affectation_administrative_prenom")
	public String getPrenom() {
		return prenom;
	}

	public void setPrenom(String prenom) {
		this.prenom = prenom;
	}

	@JsonProperty("affectation_administrative_date_effet")
	public String getDateEffet() {
		return dateEffet;
	}

	public void setDateEffet(String dateEffet) {
		this.dateEffet = dateEffet;
	}

	@JsonProperty("affectation_administrative_date_fin")
	public String getDateFin() {
		return dateFin;
	}

	public void setDateFin(String dateFin) {
		this.dateFin = dateFin;
	}

	@JsonProperty("affectation_administrative_unite")
	public String getUnite() {
		return unite;
	}

	public void setUnite(String unite) {
		this.unite = unite;
	}

	@JsonProperty("affectation_administrative_temoin_validite")
	public String getTemoinValidite() {
		return temoinValidite;
	}

	public void setTemoinValidite(String temoinValidite) {
		this.temoinValidite = temoinValidite;
	}

}

```


---

### 📄 `src/main/java/ze/affectation/AffectationDAO.java` [4.797 octets]
<a id="src-main-java-ze-affectation-AffectationDAO-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-affectation-AffectationDAO-java)

> **Chemin relatif** : `src/main/java/ze/affectation/AffectationDAO.java`  
> **Taille** : 4.797 octets  
> **Lignes** : 138  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (138 lignes) - Cliquer pour déplier</summary>

```java
package ze.affectation;

import java.sql.Array;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;
import java.util.regex.Pattern;

import org.apache.commons.lang3.StringUtils;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import ze.agent.AgentDAO;
import ze.database.utils.DataBase;
import ze.impl.Utils;
import ze.impl.WebServiceImpl;

public class AffectationDAO {

	private static final Utils UTILS = new Utils();

	private static final Pattern SPLIT_ID_PATTERN = Pattern.compile("[()']");

	private static final Logger LOG = LoggerFactory.getLogger(AffectationDAO.class);

	/*
	 * Récupère une liste d'affectations
	 */
	public List<Affectation> getList(String recherche, String matricule,
			String temoinValidite, String exportDateEffetBorne) {

		StringBuilder req = new StringBuilder();
		req.append("SELECT affectation_matricule, affectation_nom, affectation_prenom, ")
				.append("affectation_date_effet_organisationnelle, ")
				.append("affectation_date_fin_organisationnelle, ")
				.append("affectation_unite_organisationnelle, affectation_temoin_validite")
				.append(" FROM AFFECTATION aff")
				.append(" INNER JOIN AGENT on agent_matricule_renoirh = affectation_matricule")
				.append(" WHERE 1=1 ");

		// Prise en compte du champ recherche
		if (recherche != null) {
			// On retire les accents et on met en minuscule le texte de recherche
			String rechercheNormalized = StringUtils.stripAccents(recherche.toLowerCase());
			String[] rechercheNormalizedSplit = rechercheNormalized.split(" ");

			Connection cnx = null;
			try {
				cnx = DriverManager.getConnection(AffectationDAO.UTILS.getUrl(), AffectationDAO.UTILS.getUser(),
						AffectationDAO.UTILS.getPassword());
				req.append("AND (")
						.append(DataBase.getGoogleQuery(cnx, "AFFECTATION", rechercheNormalizedSplit))
						.append(")");
			} catch (final SQLException e) {
				AffectationDAO.UTILS.erreurAccesBase(e);
			} catch (final Exception e) {
				AffectationDAO.UTILS.erreurInnatendue(e);
			} finally {
				AffectationDAO.UTILS.closeConnexion(null, null, cnx);
			}
		}

		// Prise en compte du champ matricule
		if (matricule != null) {
			req.append(" AND affectation_matricule = ANY(?)");
		}

		// Prise en compte du champ temoinValidite
		if (temoinValidite != null) {
			req.append(" AND affectation_temoin_validite = ?");
		}

		// Prise en compte du champ exportDateEffetBorne
		if (exportDateEffetBorne != null) {
			req.append(" AND (to_char(affectation_date_effet_organisationnelle, 'YYYYMMDD') >= ?");
			req.append(" OR to_char(affectation_date_fin_organisationnelle, 'YYYYMMDD') >= ?");
			req.append(" OR to_char(affectation_date_fin_organisationnelle, 'YYYYMMDD') = '00010101')");
		}

		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		ArrayList<Affectation> listAffectation = new ArrayList<>();
		try {
			con = DriverManager.getConnection(UTILS.getUrl(), UTILS.getUser(), UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			int j = 0;
			if (matricule != null) {
				j++;
				Array a = con.createArrayOf("text", SPLIT_ID_PATTERN.matcher(matricule).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (temoinValidite != null) {
				j++;
				st.setString(j, temoinValidite);
			}
			if (exportDateEffetBorne != null) {
				j++;
				st.setString(j, exportDateEffetBorne);
				j++;
				st.setString(j, exportDateEffetBorne);
			}
			LOG.info("{}", st.toString());
			rs = st.executeQuery();
			while (rs.next()) {
				listAffectation.add(processRow(rs));
			}
			return listAffectation;
		} catch (SQLException e) {
			UTILS.erreurAccesBase(e);
		} catch (Exception e) {
			UTILS.erreurInnatendue(e);
		} finally {
			UTILS.closeConnexion(rs, st, con);
		}
		return listAffectation;
	}

	/*
	 * Récupère une affectation complète
	 */
	protected Affectation processRow(ResultSet rs) throws SQLException {
		Affectation affectation = new Affectation();
		affectation.setMatcle(rs.getString(AffectationEnum.AFFECTATION_MATRICULE.toString()));
		affectation.setNom(rs.getString(AffectationEnum.AFFECTATION_NOM.toString()));
		affectation.setPrenom(rs.getString(AffectationEnum.AFFECTATION_PRENOM.toString()));
		affectation.setDateEffet(rs.getString(AffectationEnum.AFFECTATION_DATE_EFFET_ORGANISATIONNELLE.toString()));
		affectation.setDateFin(rs.getString(AffectationEnum.AFFECTATION_DATE_FIN_ORGANISATIONNELLE.toString()));
		affectation.setUnite(rs.getString(AffectationEnum.AFFECTATION_UNITE_ORGANISATIONNELLE.toString()));
		affectation.setTemoinValidite(rs.getString(AffectationEnum.AFFECTATION_TEMOIN_VALIDITE.toString()));
		return affectation;
	}
}

```

</details>


---

### 📄 `src/main/java/ze/affectation/AffectationEnum.java` [272 octets]
<a id="src-main-java-ze-affectation-AffectationEnum-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-affectation-AffectationEnum-java)

> **Chemin relatif** : `src/main/java/ze/affectation/AffectationEnum.java`  
> **Taille** : 272 octets  
> **Lignes** : 12  
> **Type** : java

```java
package ze.affectation;

public enum AffectationEnum {
	AFFECTATION_MATRICULE,
	AFFECTATION_NOM,
	AFFECTATION_PRENOM,
	AFFECTATION_DATE_EFFET_ORGANISATIONNELLE,
	AFFECTATION_DATE_FIN_ORGANISATIONNELLE,
	AFFECTATION_UNITE_ORGANISATIONNELLE,
	AFFECTATION_TEMOIN_VALIDITE;
}

```


---

### 📄 `src/main/java/ze/agent/Agent.java` [33.980 octets]
<a id="src-main-java-ze-agent-Agent-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-agent-Agent-java)

> **Chemin relatif** : `src/main/java/ze/agent/Agent.java`  
> **Taille** : 33.980 octets  
> **Lignes** : 1064  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (1064 lignes) - Cliquer pour déplier</summary>

```java
package ze.agent;

import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.annotation.JsonPropertyOrder;

import java.util.ArrayList;
import java.util.List;

import javax.xml.bind.annotation.XmlRootElement;
import javax.xml.bind.annotation.XmlType;

@XmlRootElement(name = "Agent")
@XmlType(
		name = "",
		propOrder = { "agtMatriculeRenoirh", "agtMatriculeRehucit", "agtTitreCivilite", "erreur",
				"agtNomUsuel", "agtPrenom", "agtNomPatronymique", "agtSexe", "agtAutresPrenoms",
				"agtDateNaissance", "agtAdresse", "agtEchelon", "agtDateEffetEchelon", "agtCategorieAdmin",
				"agtDateEffetCategorieAdmin", "agtGradeFonctionnel", "agtDateDebutGradeFonctionnel", "agtGradeOrigine",
				"agtDateEntreeGradeOrigine", "agtCorpsAccueil", "agtDateEntreeCorpsAccueil", "agtCorpsOrigine",
				"agtDateEntreeCorpsOrigine", "agtUniteNiveauServiceAffectation", "agtMailProfessionnel",
				"agtUniteStructurelleAffectation", "agtSituationFamilliale",
				"agtTypeContrat", "agtMotifCessationFonction", "agtDateSortieAdmin", "agtDateEntree",
				"agtPositionAdmin",
				"agtDateEffetPositionAdmin", "agtCodePoste", "agtLotGestion", "agtIdentificationResponsable",
				"agtIdentifiantInterne", "agtNomReglementation", "agtDateEffetStatut", "agtDateFinStatut", "agtStatut",
				"agtDateDebutCarriere", "agtDateFinCarriere", "agtStatutaireEffetClassement",
				"agtIdentitficationPreliquidationEchelon", "agtTemoinValiditeInformation", "agtQuotiteTravail",
				"agtModaliteService", "agtQuotiteService", "agtPourcHeurePresenceTempsPlein",
				"agtNumerateurRemuneration",
				"agtDenominateurRemuneration", "agtDateEffetQuotiteTravail", "agtDateFinQuotiteTravail",
				"agtTemoinSurcotisation", "agtTemoinValidite", "agtDateEffetAffectationOrga",
				"agtDateFinAffectationOrga",
				"agtUniteAffectationOrga", "search" })

@JsonPropertyOrder({
		"agent_matricule_renoirh", "agent_matricule_rehucit", "agent_civilite", "agent_nom_usuel",
		"agent_prenom", "agent_nom_patronymique", "agent_sexe", "agent_autres_prenoms", "agent_autre_nom",
		"agent_pays_de_nationalite",

		"agent_date_de_naissance", "agent_lieu_de_naissance", "agent_departement_de_naissance",
		"agent_pays_de_naissance",
		"agent_date_de_deces", "agent_lieu_de_deces",

		"agent_adresse", "agent_adresse_complement", "agent_adresse_code_postal",
		"agent_adresse_departement_code", "agent_adresse_departement_fr_metrop_libelle",
		"agent_adresse_departement_outre_mer_libelle", "agent_adresse_code_insee",
		"agent_adresse_lieu_dit", "agent_adresse_libelle_acheminement", "agent_mail_professionnel",

		"agent_position_administrative", "agent_position_administrative_date_effet", "agent_categorie_administrative",
		"agent_situation_familiale", "agent_lot_gestion", "agent_nom_reglementation",
		"agent_type_contrat",

		"agent_carriere_origine_corps", "agent_carriere_origine_corps_libelle",
		"agent_carriere_origine_corps_date_entree",
		"agent_carriere_origine_grade", "agent_carriere_origine_grade_libelle",
		"agent_carriere_origine_grade_date_entree", "agent_carriere_origine_echelon",

		"agent_carriere_emploi_fonctionnel_corps",
		"agent_carriere_emploi_fonctionnel_corps_libelle", "agent_carriere_emploi_fonctionnel_corps_date_entree",
		"agent_carriere_emploi_fonctionnel_grade", "agent_carriere_emploi_fonctionnel_grade_libelle",
		"agent_carriere_emploi_fonctionnel_grade_date_entree", "agent_carriere_emploi_fonctionnel_echelon",
		"agent_carriere_emploi_fonctionnel_echelon_date_effet",

		"agent_carriere_accueil_corps",
		"agent_carriere_accueil_corps_libelle", "agent_carriere_accueil_corps_date_entree",
		"agent_carriere_accueil_grade", "agent_carriere_accueil_grade_libelle",
		"agent_carriere_accueil_grade_date_entree", "agent_carriere_accueil_echelon",

		"agent_code_poste", "agent_poste_libelle", "agent_affectation_administrative",
		"agent_affectation_administrative_libelle_long", "agent_affectation_administrative_libelle_court",
		"agent_affectation_administrative_date_installation",
		"agent_affectation_administrative_date_fin_reelle", "agent_affectation_operationnelle",
		"agent_affectation_operationnelle_libelle_long", "agent_affectation_operationnelle_libelle_court",
		"agent_affectation_operationnelle_date_debut", "agent_affectation_operationnelle_date_fin",

		"agent_statut", "agent_statut_libelle", "agent_statut_date_effet", "agent_modalite_service",
		"agent_motif_cessation_fonction", "agent_date_sortie_administrative",
		"agent_matricule_renoirh_responsable", "agent_temoin_validite",
		"agent_contractuel_type_contrat", "agent_contractuel_nature_contrat", "agent_contractuel_date_debut" })

@JsonInclude(JsonInclude.Include.NON_DEFAULT)
public class Agent {

	private String agtMatriculeRenoirh;

	private String agtMatriculeRehucit;

	private String agtCivilite;

	private String agtNomUsuel;

	private String agtPrenom;

	private String agtNomPatronymique;

	private String agtSexe;

	private String agtAutresPrenoms;

	private String agtPaysNationalite;

	private String agtDateNaissance;

	private String agtLieuNaissance;

	private String agtDepartementNaissance;

	private String agtPaysNaissance;

	private String agtDateDeces;

	private String agtLieuDeces;

	private String agtAdresse;

	private String agtAdresseComplement;

	private String agtAdresseCodePostal;

	private String agtAdresseDepartementCode;

	private String agtAdresseDepartementFrMetropLibelle;

	private String agtAdresseDepartementOutreMerLibelle;

	private String agtAdresseCodeInsee;

	private String agtAdresseLieuDit;

	private String agtAdresseLibelleAcheminement;

	private String agtMailProfessionnel;

	private String agtPositionAdministrative;

	private String agtPositionAdministrativeDateEffet;

	private String agtCategorieAdministrative;

	private String agtSituationFamiliale;

	private String agtLotGestion;

	private String agtNomReglementation;

	private String agtCarriereOrigineCorps;

	private String agtCarriereOrigineCorpsLibelle;

	private String agtCarriereOrigineCorpsDateEntree;

	private String agtCarriereOrigineGrade;

	private String agtCarriereOrigineGradeLibelle;

	private String agtCarriereOrigineGradeDateEntree;

	private String agtCarriereOrigineEchelon;

	private String agtCarriereEmploiFonctionnelCorps;

	private String agtCarriereEmploiFonctionnelCorpsLibelle;

	private String agtCarriereEmploiFonctionnelCorpsDateEntree;

	private String agtCarriereEmploiFonctionnelGrade;

	private String agtCarriereEmploiFonctionnelGradeLibelle;

	private String agtCarriereEmploiFonctionnelGradeDateEntree;

	private String agtCarriereEmploiFonctionnelEchelon;

	private String agtCarriereEmploiFonctionnelEchelonDateEffet;

	private String agtCarriereAccueilCorps;

	private String agtCarriereAccueilCorpsLibelle;

	private String agtCarriereAccueilCorpsDateEntree;

	private String agtCarriereAccueilGrade;

	private String agtCarriereAccueilGradeLibelle;

	private String agtCarriereAccueilGradeDateEntree;

	private String agtCarriereAccueilEchelon;

	private String agtPoste;

	private String agtPosteLibelle;

	private String agtAffectationAdministrative;

	private String agtAffectationAdministrativeLibelleLong;

	private String agtAffectationAdministrativeLibelleCourt;

	private String agtAffectationAdministrativeDateInstallation;

	private String agtAffectationAdministrativeDateFinReelle;

	private String agtAffectationOperationnelle;

	private String agtAffectationOperationnelleLibelleLong;

	private String agtAffectationOperationnelleLibelleCourt;

	private String agtAffectationOperationnelleDateDebut;

	private String agtAffectationOperationnelleDateFin;

	private String agtStatut;

	private String agtStatutLibelle;

	private String agtStatutDateEffet;

	private String agtModaliteService;

	private String agtMotifCessationFonction;

	private String agtDateSortieAdministrative;

	private String agtMatriculeRenoirhResponsable;

	private String agtTemoinValidite;

	private String agtDateEntreeMinistere;

	private String agtContractuelNatureContrat;

	private String agtPartenaire;

	private String agtPese;

	private String agtCodeCorrespondadnt;

	private String agtContractuelDateDebut;

	private String agtContractuelDateFinReelle;

	private String agtContractuelDateFinPrevisionnelle;

	private String agtContractuelTypeContrat;

	private String agtContractuelTypeContratLibelle;

	private String agtContractuelPseudoGrade;

	private String agtContractuelPseudoGradeLibelle;

	private String agtContractuelNumContrat;

	private String agtContractuelNumAvenant;

	private List<Poste> postes = new ArrayList<>();

	private String erreur;

	@JsonProperty("agent_matricule_renoirh")
	public String getAgtMatriculeRenoirh() {
		return this.agtMatriculeRenoirh;
	}

	public void setAgtMatriculeRenoirh(String agtMatriculeRenoirh) {
		this.agtMatriculeRenoirh = agtMatriculeRenoirh;
	}

	@JsonProperty("agent_matricule_rehucit")
	public String getAgtMatriculeRehucit() {
		return this.agtMatriculeRehucit;
	}

	public void setAgtMatriculeRehucit(String agtMatriculeRehucit) {
		this.agtMatriculeRehucit = agtMatriculeRehucit;
	}

	@JsonProperty("agent_civilite")
	public String getAgtCivilite() {
		return this.agtCivilite;
	}

	public void setAgtCivilite(String agtCivilite) {
		this.agtCivilite = agtCivilite;
	}

	@JsonProperty("agent_nom_usuel")
	public String getAgtNomUsuel() {
		return this.agtNomUsuel;
	}

	public void setAgtNomUsuel(String agtNomUsuel) {
		this.agtNomUsuel = agtNomUsuel;
	}

	@JsonProperty("agent_prenom")
	public String getAgtPrenom() {
		return this.agtPrenom;
	}

	public void setAgtPrenom(String agtPrenom) {
		this.agtPrenom = agtPrenom;
	}

	@JsonProperty("agent_nom_patronymique")
	public String getAgtNomPatronymique() {
		return this.agtNomPatronymique;
	}

	public void setAgtNomPatronymique(String agtNomPatronymique) {
		this.agtNomPatronymique = agtNomPatronymique;
	}

	@JsonProperty("agent_sexe")
	public String getAgtSexe() {
		return this.agtSexe;
	}

	public void setAgtSexe(String agtSexe) {
		this.agtSexe = agtSexe;
	}

	@JsonProperty("agent_autres_prenoms")
	public String getAgtAutresPrenoms() {
		return this.agtAutresPrenoms;
	}

	public void setAgtAutresPrenoms(String agtAutresPrenoms) {
		this.agtAutresPrenoms = agtAutresPrenoms;
	}

	@JsonProperty("agent_pays_nationalite")
	public String getAgtPaysNationalite() {
		return this.agtPaysNationalite;
	}

	public void setAgtPaysNationalite(String agtPaysNationalite) {
		this.agtPaysNationalite = agtPaysNationalite;
	}

	@JsonProperty("agent_date_de_naissance")
	public String getAgtDateNaissance() {
		return this.agtDateNaissance;
	}

	public void setAgtDateNaissance(String agtDateNaissance) {
		this.agtDateNaissance = agtDateNaissance;
	}

	@JsonProperty("agent_lieu_de_naissance")
	public String getAgtLieuNaissance() {
		return this.agtLieuNaissance;
	}

	public void setAgtLieuNaissance(String agtLieuNaissance) {
		this.agtLieuNaissance = agtLieuNaissance;
	}

	@JsonProperty("agent_departement_de_naissance")
	public String getAgtDepartementNaissance() {
		return this.agtDepartementNaissance;
	}

	public void setAgtDepartementNaissance(String agtDepartementNaissance) {
		this.agtDepartementNaissance = agtDepartementNaissance;
	}

	@JsonProperty("agent_pays_de_naissance")
	public String getAgtPaysNaissance() {
		return this.agtPaysNaissance;
	}

	public void setAgtPaysNaissance(String agtPaysNaissance) {
		this.agtPaysNaissance = agtPaysNaissance;
	}

	@JsonProperty("agent_date_de_deces")
	public String getAgtDateDeces() {
		return this.agtDateDeces;
	}

	public void setAgtDateDeces(String agtDateDeces) {
		this.agtDateDeces = agtDateDeces;
	}

	@JsonProperty("agent_lieu_de_deces")
	public String getAgtLieuDeces() {
		return this.agtLieuDeces;
	}

	public void setAgtLieuDeces(String agtLieuDeces) {
		this.agtLieuDeces = agtLieuDeces;
	}

	@JsonProperty("agent_adresse")
	public String getAgtAdresse() {
		return this.agtAdresse;
	}

	public void setAgtAdresse(String agtAdresse) {
		this.agtAdresse = agtAdresse;
	}

	@JsonProperty("agent_adresse_complement")
	public String getAgtAdresseComplement() {
		return this.agtAdresseComplement;
	}

	public void setAgtAdresseComplement(String agtAdresseComplement) {
		this.agtAdresseComplement = agtAdresseComplement;
	}

	@JsonProperty("agent_adresse_code_postal")
	public String getAgtAdresseCodePostal() {
		return this.agtAdresseCodePostal;
	}

	public void setAgtAdresseCodePostal(String agtAdresseCodePostal) {
		this.agtAdresseCodePostal = agtAdresseCodePostal;
	}

	@JsonProperty("agent_adresse_departement_code")
	public String getAgtAdresseDepartementCode() {
		return this.agtAdresseDepartementCode;
	}

	public void setAgtAdresseDepartementCode(String agtAdresseDepartementCode) {
		this.agtAdresseDepartementCode = agtAdresseDepartementCode;
	}

	@JsonProperty("agent_adresse_code_insee")
	public String getAgtAdresseCodeInsee() {
		return this.agtAdresseCodeInsee;
	}

	public void setAgtAdresseCodeInsee(String agtAdresseCodeInsee) {
		this.agtAdresseCodeInsee = agtAdresseCodeInsee;
	}

	@JsonProperty("agent_adresse_lieu_dit")
	public String getAgtAdresseLieuDit() {
		return this.agtAdresseLieuDit;
	}

	public void setAgtAdresseLieuDit(String agtAdresseLieuDit) {
		this.agtAdresseLieuDit = agtAdresseLieuDit;
	}

	@JsonProperty("agent_adresse_libelle_acheminement")
	public String getAgtAdresseLibelleAcheminement() {
		return this.agtAdresseLibelleAcheminement;
	}

	public void setAgtAdresseLibelleAcheminement(String agtAdresseLibelleAcheminement) {
		this.agtAdresseLibelleAcheminement = agtAdresseLibelleAcheminement;
	}

	@JsonProperty("agent_mail_professionnel")
	public String getAgtMailProfessionnel() {
		return this.agtMailProfessionnel;
	}

	public void setAgtMailProfessionnel(String agtMailProfessionnel) {
		this.agtMailProfessionnel = agtMailProfessionnel;
	}

	@JsonProperty("agent_position_administrative")
	public String getAgtPositionAdministrative() {
		return this.agtPositionAdministrative;
	}

	public void setAgtPositionAdministrative(String agtPositionAdministrative) {
		this.agtPositionAdministrative = agtPositionAdministrative;
	}

	@JsonProperty("agent_position_administrative_date_effet")
	public String getAgtPositionAdministrativeDateEffet() {
		return this.agtPositionAdministrativeDateEffet;
	}

	public void setAgtPositionAdministrativeDateEffet(String agtPositionAdministrativeDateEffet) {
		this.agtPositionAdministrativeDateEffet = agtPositionAdministrativeDateEffet;
	}

	@JsonProperty("agent_categorie_administrative")
	public String getAgtCategorieAdministrative() {
		return this.agtCategorieAdministrative;
	}

	public void setAgtCategorieAdministrative(String agtCategorieAdministrative) {
		this.agtCategorieAdministrative = agtCategorieAdministrative;
	}

	@JsonProperty("agent_situation_familiale")
	public String getAgtSituationFamiliale() {
		return this.agtSituationFamiliale;
	}

	public void setAgtSituationFamiliale(String agtSituationFamiliale) {
		this.agtSituationFamiliale = agtSituationFamiliale;
	}

	@JsonProperty("agent_lot_gestion")
	public String getAgtLotGestion() {
		return this.agtLotGestion;
	}

	public void setAgtLotGestion(String agtLotGestion) {
		this.agtLotGestion = agtLotGestion;
	}

	@JsonProperty("agent_nom_reglementation")
	public String getAgtNomReglementation() {
		return this.agtNomReglementation;
	}

	public void setAgtNomReglementation(String agtNomReglementation) {
		this.agtNomReglementation = agtNomReglementation;
	}

	@JsonProperty("agent_carriere_origine_corps")
	public String getAgtCarriereOrigineCorps() {
		return this.agtCarriereOrigineCorps;
	}

	public void setAgtCarriereOrigineCorps(String agtCarriereOrigineCorps) {
		this.agtCarriereOrigineCorps = agtCarriereOrigineCorps;
	}

	@JsonProperty("agent_carriere_origine_corps_libelle")
	public String getAgtCarriereOrigineCorpsLibelle() {
		return this.agtCarriereOrigineCorpsLibelle;
	}

	public void setAgtCarriereOrigineCorpsLibelle(String agtCarriereOrigineCorpsLibelle) {
		this.agtCarriereOrigineCorpsLibelle = agtCarriereOrigineCorpsLibelle;
	}

	@JsonProperty("agent_carriere_origine_corps_date_entree")
	public String getAgtCarriereOrigineCorpsDateEntree() {
		return this.agtCarriereOrigineCorpsDateEntree;
	}

	public void setAgtCarriereOrigineCorpsDateEntree(String agtCarriereOrigineCorpsDateEntree) {
		this.agtCarriereOrigineCorpsDateEntree = agtCarriereOrigineCorpsDateEntree;
	}

	@JsonProperty("agent_carriere_origine_grade")
	public String getAgtCarriereOrigineGrade() {
		return this.agtCarriereOrigineGrade;
	}

	public void setAgtCarriereOrigineGrade(String agtCarriereOrigineGrade) {
		this.agtCarriereOrigineGrade = agtCarriereOrigineGrade;
	}

	@JsonProperty("agent_carriere_origine_grade_libelle")
	public String getAgtCarriereOrigineGradeLibelle() {
		return this.agtCarriereOrigineGradeLibelle;
	}

	public void setAgtCarriereOrigineGradeLibelle(String agtCarriereOrigineGradeLibelle) {
		this.agtCarriereOrigineGradeLibelle = agtCarriereOrigineGradeLibelle;
	}

	@JsonProperty("agent_carriere_origine_grade_date_entree")
	public String getAgtCarriereOrigineGradeDateEntree() {
		return this.agtCarriereOrigineGradeDateEntree;
	}

	public void setAgtCarriereOrigineGradeDateEntree(String agtCarriereOrigineGradeDateEntree) {
		this.agtCarriereOrigineGradeDateEntree = agtCarriereOrigineGradeDateEntree;
	}

	@JsonProperty("agent_carriere_origine_echelon")
	public String getAgtCarriereOrigineEchelon() {
		return this.agtCarriereOrigineEchelon;
	}

	public void setAgtCarriereOrigineEchelon(String agtCarriereOrigineEchelon) {
		this.agtCarriereOrigineEchelon = agtCarriereOrigineEchelon;
	}

	@JsonProperty("agent_carriere_emploi_fonctionnel_echelon")
	public String getAgtCarriereEmploiFonctionnelEchelon() {
		return this.agtCarriereEmploiFonctionnelEchelon;
	}

	public void setAgtCarriereEmploiFonctionnelEchelon(String agtCarriereEmploiFonctionnelEchelon) {
		this.agtCarriereEmploiFonctionnelEchelon = agtCarriereEmploiFonctionnelEchelon;
	}

	@JsonProperty("agent_carriere_emploi_fonctionnel_echelon_date_effet")
	public String getAgtCarriereEmploiFonctionnelEchelonDateEffet() {
		return this.agtCarriereEmploiFonctionnelEchelonDateEffet;
	}

	public void setAgtCarriereEmploiFonctionnelEchelonDateEffet(String agtCarriereEmploiFonctionnelEchelonDateEffet) {
		this.agtCarriereEmploiFonctionnelEchelonDateEffet = agtCarriereEmploiFonctionnelEchelonDateEffet;
	}

	@JsonProperty("agent_carriere_emploi_fonctionnel_corps")
	public String getAgtCarriereEmploiFonctionnelCorps() {
		return this.agtCarriereEmploiFonctionnelCorps;
	}

	public void setAgtCarriereEmploiFonctionnelCorps(String agtCarriereEmploiFonctionnelCorps) {
		this.agtCarriereEmploiFonctionnelCorps = agtCarriereEmploiFonctionnelCorps;
	}

	@JsonProperty("agent_carriere_emploi_fonctionnel_corps_libelle")
	public String getAgtCarriereEmploiFonctionnelCorpsLibelle() {
		return this.agtCarriereEmploiFonctionnelCorpsLibelle;
	}

	public void setAgtCarriereEmploiFonctionnelCorpsLibelle(String agtCarriereEmploiFonctionnelCorpsLibelle) {
		this.agtCarriereEmploiFonctionnelCorpsLibelle = agtCarriereEmploiFonctionnelCorpsLibelle;
	}

	@JsonProperty("agent_carriere_emploi_fonctionnel_corps_date_entree")
	public String getAgtCarriereEmploiFonctionnelCorpsDateEntree() {
		return this.agtCarriereEmploiFonctionnelCorpsDateEntree;
	}

	public void setAgtCarriereEmploiFonctionnelCorpsDateEntree(String agtCarriereEmploiFonctionnelCorpsDateEntree) {
		this.agtCarriereEmploiFonctionnelCorpsDateEntree = agtCarriereEmploiFonctionnelCorpsDateEntree;
	}

	@JsonProperty("agent_carriere_emploi_fonctionnel_grade")
	public String getAgtCarriereEmploiFonctionnelGrade() {
		return this.agtCarriereEmploiFonctionnelGrade;
	}

	public void setAgtCarriereEmploiFonctionnelGrade(String agtCarriereEmploiFonctionnelGrade) {
		this.agtCarriereEmploiFonctionnelGrade = agtCarriereEmploiFonctionnelGrade;
	}

	@JsonProperty("agent_carriere_emploi_fonctionnel_grade_libelle")
	public String getAgtCarriereEmploiFonctionnelGradeLibelle() {
		return this.agtCarriereEmploiFonctionnelGradeLibelle;
	}

	public void setAgtCarriereEmploiFonctionnelGradeLibelle(String agtCarriereEmploiFonctionnelGradeLibelle) {
		this.agtCarriereEmploiFonctionnelGradeLibelle = agtCarriereEmploiFonctionnelGradeLibelle;
	}

	@JsonProperty("agent_carriere_emploi_fonctionnel_grade_date_entree")
	public String getAgtCarriereEmploiFonctionnelGradeDateEntree() {
		return this.agtCarriereEmploiFonctionnelGradeDateEntree;
	}

	public void setAgtCarriereEmploiFonctionnelGradeDateEntree(String agtCarriereEmploiFonctionnelGradeDateEntree) {
		this.agtCarriereEmploiFonctionnelGradeDateEntree = agtCarriereEmploiFonctionnelGradeDateEntree;
	}

	@JsonProperty("agent_carriere_accueil_corps")
	public String getAgtCarriereAccueilCorps() {
		return this.agtCarriereAccueilCorps;
	}

	public void setAgtCarriereAccueilCorps(String agtCarriereAccueilCorps) {
		this.agtCarriereAccueilCorps = agtCarriereAccueilCorps;
	}

	@JsonProperty("agent_carriere_accueil_corps_libelle")
	public String getAgtCarriereAccueilCorpsLibelle() {
		return this.agtCarriereAccueilCorpsLibelle;
	}

	public void setAgtCarriereAccueilCorpsLibelle(String agtCarriereAccueilCorpsLibelle) {
		this.agtCarriereAccueilCorpsLibelle = agtCarriereAccueilCorpsLibelle;
	}

	@JsonProperty("agent_carriere_accueil_corps_date_entree")
	public String getAgtCarriereAccueilCorpsDateEntree() {
		return this.agtCarriereAccueilCorpsDateEntree;
	}

	public void setAgtCarriereAccueilCorpsDateEntree(String agtCarriereAccueilCorpsDateEntree) {
		this.agtCarriereAccueilCorpsDateEntree = agtCarriereAccueilCorpsDateEntree;
	}

	@JsonProperty("agent_carriere_accueil_grade")
	public String getAgtCarriereAccueilGrade() {
		return this.agtCarriereAccueilGrade;
	}

	public void setAgtCarriereAccueilGrade(String agtCarriereAccueilGrade) {
		this.agtCarriereAccueilGrade = agtCarriereAccueilGrade;
	}

	@JsonProperty("agent_carriere_accueil_grade_libelle")
	public String getAgtCarriereAccueilGradeLibelle() {
		return this.agtCarriereAccueilGradeLibelle;
	}

	public void setAgtCarriereAccueilGradeLibelle(String agtCarriereAccueilGradeLibelle) {
		this.agtCarriereAccueilGradeLibelle = agtCarriereAccueilGradeLibelle;
	}

	@JsonProperty("agent_carriere_accueil_grade_date_entree")
	public String getAgtCarriereAccueilGradeDateEntree() {
		return this.agtCarriereAccueilGradeDateEntree;
	}

	public void setAgtCarriereAccueilGradeDateEntree(String agtCarriereAccueilGradeDateEntree) {
		this.agtCarriereAccueilGradeDateEntree = agtCarriereAccueilGradeDateEntree;
	}

	@JsonProperty("agent_carriere_accueil_echelon")
	public String getAgtCarriereAccueilEchelon() {
		return this.agtCarriereAccueilEchelon;
	}

	public void setAgtCarriereAccueilEchelon(String agtCarriereAccueilEchelon) {
		this.agtCarriereAccueilEchelon = agtCarriereAccueilEchelon;
	}

	@JsonProperty("agent_poste")
	public String getAgtPoste() {
		return this.agtPoste;
	}

	public void setAgtPoste(String agtPoste) {
		this.agtPoste = agtPoste;
	}

	@JsonProperty("agent_poste_libelle")
	public String getAgtPosteLibelle() {
		return this.agtPosteLibelle;
	}

	public void setAgtPosteLibelle(String agtPosteLibelle) {
		this.agtPosteLibelle = agtPosteLibelle;
	}

	public void setAgtAffectationAdministrativeDateFinReelle(String agtAffectationAdministrativeDateFinReelle) {
		this.agtAffectationAdministrativeDateFinReelle = agtAffectationAdministrativeDateFinReelle;
	}

	@JsonProperty("agent_affectation_operationnelle_code")
	public String getAgtAffectationOperationnelle() {
		return this.agtAffectationOperationnelle;
	}

	public void setAgtAffectationOperationnelle(String agtAffectationOperationnelle) {
		this.agtAffectationOperationnelle = agtAffectationOperationnelle;
	}

	@JsonProperty("agent_affectation_operationnelle_date_debut")
	public String getAgtAffectationOperationnelleDateDebut() {
		return this.agtAffectationOperationnelleDateDebut;
	}

	public void setAgtAffectationOperationnelleDateDebut(String agtAffectationOperationnelleDateDebut) {
		this.agtAffectationOperationnelleDateDebut = agtAffectationOperationnelleDateDebut;
	}

	@JsonProperty("agent_affectation_operationnelle_date_fin")
	public String getAgtAffectationOperationnelleDateFin() {
		return this.agtAffectationOperationnelleDateFin;
	}

	public void setAgtAffectationOperationnelleDateFin(String agtAffectationOperationnelleDateFin) {
		this.agtAffectationOperationnelleDateFin = agtAffectationOperationnelleDateFin;
	}

	@JsonProperty("agent_statut")
	public String getAgtStatut() {
		return this.agtStatut;
	}

	public void setAgtStatut(String agtStatut) {
		this.agtStatut = agtStatut;
	}

	@JsonProperty("agent_statut_libelle")
	public String getAgtStatutLibelle() {
		return this.agtStatutLibelle;
	}

	public void setAgtStatutLibelle(String agtStatutLibelle) {
		this.agtStatutLibelle = agtStatutLibelle;
	}

	@JsonProperty("agent_statut_date_effet")
	public String getAgtStatutDateEffet() {
		return this.agtStatutDateEffet;
	}

	public void setAgtStatutDateEffet(String agtStatutDateEffet) {
		this.agtStatutDateEffet = agtStatutDateEffet;
	}

	@JsonProperty("agent_modalite_service")
	public String getAgtModaliteService() {
		return this.agtModaliteService;
	}

	public void setAgtModaliteService(String agtModaliteService) {
		this.agtModaliteService = agtModaliteService;
	}

	@JsonProperty("agent_motif_cessation_fonction")
	public String getAgtMotifCessationFonction() {
		return this.agtMotifCessationFonction;
	}

	public void setAgtMotifCessationFonction(String agtMotifCessationFonction) {
		this.agtMotifCessationFonction = agtMotifCessationFonction;
	}

	@JsonProperty("agent_date_sortie_administrative")
	public String getAgtDateSortieAdministrative() {
		return this.agtDateSortieAdministrative;
	}

	public void setAgtDateSortieAdministrative(String agtDateSortieAdministrative) {
		this.agtDateSortieAdministrative = agtDateSortieAdministrative;
	}

	@JsonProperty("agent_matricule_renoirh_responsable")
	public String getAgtMatriculeRenoirhResponsable() {
		return this.agtMatriculeRenoirhResponsable;
	}

	public void setAgtMatriculeRenoirhResponsable(String agtMatriculeRenoirhResponsable) {
		this.agtMatriculeRenoirhResponsable = agtMatriculeRenoirhResponsable;
	}

	@JsonProperty("agent_temoin_validite")
	public String getAgtTemoinValidite() {
		return this.agtTemoinValidite;
	}

	public void setAgtTemoinValidite(String agtTemoinValidite) {
		this.agtTemoinValidite = agtTemoinValidite;
	}

	@JsonProperty("agent_date_entree_ministere")
	public String getAgtDateEntreeMinistere() {
		return this.agtDateEntreeMinistere;
	}

	public void setAgtDateEntreeMinistere(String agtDateEntreeMinistere) {
		this.agtDateEntreeMinistere = agtDateEntreeMinistere;
	}

	@JsonProperty("agent_adresse_departement_fr_metrop_libelle")
	public String getAgtAdresseDepartementFrMetropLibelle() {
		return this.agtAdresseDepartementFrMetropLibelle;
	}

	public void setAgtAdresseDepartementFrMetropLibelle(String agtAdresseDepartementFrMetropLibelle) {
		this.agtAdresseDepartementFrMetropLibelle = agtAdresseDepartementFrMetropLibelle;
	}

	@JsonProperty("agent_adresse_departement_outre_mer_libelle")
	public String getAgtAdresseDepartementOutreMerLibelle() {
		return this.agtAdresseDepartementOutreMerLibelle;
	}

	public void setAgtAdresseDepartementOutreMerLibelle(String agtAdresseDepartementOutreMerLibelle) {
		this.agtAdresseDepartementOutreMerLibelle = agtAdresseDepartementOutreMerLibelle;
	}

	@JsonProperty("agent_affectation_administrative_code")
	public String getAgtAffectationAdministrative() {
		return this.agtAffectationAdministrative;
	}

	public void setAgtAffectationAdministrative(String agtAffectationAdministrative) {
		this.agtAffectationAdministrative = agtAffectationAdministrative;
	}

	@JsonProperty("agent_affectation_administrative_libelle_long")
	public String getAgtAffectationAdministrativeLibelleLong() {
		return this.agtAffectationAdministrativeLibelleLong;
	}

	public void setAgtAffectationAdministrativeLibelleLong(String agtAffectationAdministrativeLibelleLong) {
		this.agtAffectationAdministrativeLibelleLong = agtAffectationAdministrativeLibelleLong;
	}

	@JsonProperty("agent_affectation_administrative_libelle_court")
	public String getAgtAffectationAdministrativeLibelleCourt() {
		return this.agtAffectationAdministrativeLibelleCourt;
	}

	public void setAgtAffectationAdministrativeLibelleCourt(String agtAffectationAdministrativeLibelleCourt) {
		this.agtAffectationAdministrativeLibelleCourt = agtAffectationAdministrativeLibelleCourt;
	}

	@JsonProperty("agent_affectation_administrative_date_installation")
	public String getAgtAffectationAdministrativeDateInstallation() {
		return this.agtAffectationAdministrativeDateInstallation;
	}

	public void setAgtAffectationAdministrativeDateInstallation(String agtAffectationAdministrativeDateInstallation) {
		this.agtAffectationAdministrativeDateInstallation = agtAffectationAdministrativeDateInstallation;
	}

	@JsonProperty("agent_affectation_administrative_date_fin_reelle")
	public String getAgtAffectationAdministrativeDateFinReelle() {
		return this.agtAffectationAdministrativeDateFinReelle;
	}

	@JsonProperty("agent_affectation_operationnelle_libelle_long")
	public String getAgtAffectationOperationnelleLibelleLong() {
		return this.agtAffectationOperationnelleLibelleLong;
	}

	public void setAgtAffectationOperationnelleLibelleLong(String agtAffectationOperationnelleLibelleLong) {
		this.agtAffectationOperationnelleLibelleLong = agtAffectationOperationnelleLibelleLong;
	}

	@JsonProperty("agent_affectation_operationnelle_libelle_court")
	public String getAgtAffectationOperationnelleLibelleCourt() {
		return this.agtAffectationOperationnelleLibelleCourt;
	}

	public void setAgtAffectationOperationnelleLibelleCourt(String agtAffectationOperationnelleLibelleCourt) {
		this.agtAffectationOperationnelleLibelleCourt = agtAffectationOperationnelleLibelleCourt;
	}

	@JsonProperty("agent_contractuel_type_contrat")
	public String getAgtContractuelTypeContrat() {
		return this.agtContractuelTypeContrat;
	}

	public void setAgtContractuelTypeContrat(String agtContractuelTypeContrat) {
		this.agtContractuelTypeContrat = agtContractuelTypeContrat;
	}

	@JsonProperty("agent_contractuel_nature_contrat")
	public String getAgtContractuelNatureContrat() {
		return this.agtContractuelNatureContrat;
	}

	public void setAgtContractuelNatureContrat(String agtContractuelNatureContrat) {
		this.agtContractuelNatureContrat = agtContractuelNatureContrat;
	}

	@JsonProperty("agent_contractuel_date_debut")
	public String getAgtContractuelDateDebut() {
		return this.agtContractuelDateDebut;
	}

	public void setAgtContractuelDateDebut(String agtContractuelDateDebut) {
		this.agtContractuelDateDebut = agtContractuelDateDebut;
	}

	@JsonProperty("agent_axe_partenaire")
	public String getAgtPartenaire() {
		return this.agtPartenaire;
	}

	public void setAgtPartenaire(String agtPartenaire) {
		this.agtPartenaire = agtPartenaire;
	}

	@JsonProperty("agent_axe_pese")
	public String getAgtPese() {
		return this.agtPese;
	}

	public void setAgtPese(String agtPese) {
		this.agtPese = agtPese;
	}

	@JsonProperty("agent_axe_code_correspondant")
	public String getAgtCodeCorrespondadnt() {
		return this.agtCodeCorrespondadnt;
	}

	public void setAgtCodeCorrespondadnt(String agtCodeCorrespondadnt) {
		this.agtCodeCorrespondadnt = agtCodeCorrespondadnt;
	}

	@JsonProperty("agent_contractuel_date_fin_reelle")
	public String getAgtContractuelDateFinReelle() {
		return this.agtContractuelDateFinReelle;
	}

	public void setAgtContractuelDateFinReelle(String agtContractuelDateFinReelle) {
		this.agtContractuelDateFinReelle = agtContractuelDateFinReelle;
	}

	@JsonProperty("agent_contractuel_date_fin_previsionnelle")
	public String getAgtContractuelDateFinPrevisionnelle() {
		return this.agtContractuelDateFinPrevisionnelle;
	}

	public void setAgtContractuelDateFinPrevisionnelle(String agtContractuelDateFinPrevisionnelle) {
		this.agtContractuelDateFinPrevisionnelle = agtContractuelDateFinPrevisionnelle;
	}

	@JsonProperty("agent_contractuel_type_contrat_libelle")
	public String getAgtContractuelTypeContratLibelle() {
		return this.agtContractuelTypeContratLibelle;
	}

	public void setAgtContractuelTypeContratLibelle(String agtContractuelTypeContratLibelle) {
		this.agtContractuelTypeContratLibelle = agtContractuelTypeContratLibelle;
	}

	@JsonProperty("agent_contractuel_pseudo_grade")
	public String getAgtContractuelPseudoGrade() {
		return this.agtContractuelPseudoGrade;
	}

	public void setAgtContractuelPseudoGrade(String agtContractuelPseudoGrade) {
		this.agtContractuelPseudoGrade = agtContractuelPseudoGrade;
	}

	@JsonProperty("agent_contractuel_pseudo_grade_libelle")
	public String getAgtContractuelPseudoGradeLibelle() {
		return this.agtContractuelPseudoGradeLibelle;
	}

	public void setAgtContractuelPseudoGradeLibelle(String agtContractuelPseudoGradeLibelle) {
		this.agtContractuelPseudoGradeLibelle = agtContractuelPseudoGradeLibelle;
	}

	@JsonProperty("agent_contractuel_num_contrat")
	public String getAgtContractuelNumContrat() {
		return this.agtContractuelNumContrat;
	}

	public void setAgtContractuelNumContrat(String agtContractuelNumContrat) {
		this.agtContractuelNumContrat = agtContractuelNumContrat;
	}

	@JsonProperty("agent_contractuel_num_avenant")
	public String getAgtContractuelNumAvenant() {
		return this.agtContractuelNumAvenant;
	}

	public void setAgtContractuelNumAvenant(String agtContractuelNumAvenant) {
		this.agtContractuelNumAvenant = agtContractuelNumAvenant;
	}

	@JsonProperty("postes")
	public List<Poste> getPostes() {
		return this.postes;
	}

	public void setPostes(List<Poste> postes) {
		this.postes = postes;
	}

	public String getErreur() {
		return this.erreur;
	}

	public void setErreur(String erreur) {
		this.erreur = erreur;
	}

}

```

</details>


---

### 📄 `src/main/java/ze/agent/AgentDAO.java` [29.813 octets]
<a id="src-main-java-ze-agent-AgentDAO-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-agent-AgentDAO-java)

> **Chemin relatif** : `src/main/java/ze/agent/AgentDAO.java`  
> **Taille** : 29.813 octets  
> **Lignes** : 717  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (717 lignes) - Cliquer pour déplier</summary>

```java
package ze.agent;

import java.sql.Array;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.regex.Pattern;

import org.apache.commons.lang3.StringUtils;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import ze.database.utils.DataBase;
import ze.impl.Utils;

public class AgentDAO {

	private static final Utils UTILS = new Utils();

	private static final Pattern SPLIT_ID_PATTERN = Pattern.compile("[()']");

	private static final Logger LOG = LoggerFactory.getLogger(AgentDAO.class);

	private static final int HUIT = 8;

	private static final int SIX = 6;

	private static final int QUATRE = 4;

	/*
	 * Recupère une liste d'agents à partir d'une liste d'identifiants
	 */
	public List<Agent> findById(String id, boolean fullInformation) {

		final StringBuilder req = new StringBuilder();
		req.append("SELECT * FROM agent ")
				.append(" LEFT JOIN poste ON poste.matricule_renoirh=agent.agent_matricule_renoirh");

		if (id != null) {
			req.append(" WHERE agent_matricule_renoirh = ANY(?) OR agent_matricule_rehucit = ANY(?)");
		}

		List<Agent> listAgent = new ArrayList<>();
		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		try {
			con = DriverManager.getConnection(AgentDAO.UTILS.getUrl(), AgentDAO.UTILS.getUser(),
					AgentDAO.UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			AgentDAO.LOG.info(id);
			final String[] idAgt = AgentDAO.SPLIT_ID_PATTERN.matcher(id).replaceAll("").split(",");
			if (id != null) {
				final Array a = con.createArrayOf("text", idAgt);
				st.setArray(1, a);
				st.setArray(2, a);
			}
			AgentDAO.LOG.info("requête SQL:{}", st);
			rs = st.executeQuery();
			final ArrayList<String> listIdAgt = new ArrayList<>(Arrays.asList(idAgt));
			listAgent = this.getAgentList(rs, fullInformation, false);
			//supprimer les id trouvés
			for (final Agent agent : listAgent) {
				final String agtRenoirh = agent.getAgtMatriculeRenoirh();
				final String agtRehucit = agent.getAgtMatriculeRehucit();
				listIdAgt.remove(agtRenoirh);
				listIdAgt.remove(agtRehucit);
			}
			//créer des objets vides pour les id non trouvés
			for (final String s : listIdAgt) {
				final Agent g = new Agent();
				g.setAgtMatriculeRenoirh(s);
				g.setErreur("404 : Agent non trouvé");
				listAgent.add(g);
			}
			return listAgent;
		} catch (final SQLException e) {
			AgentDAO.UTILS.erreurAccesBase(e);
		} catch (final Exception e) {
			AgentDAO.UTILS.erreurInnatendue(e);
		} finally {
			AgentDAO.UTILS.closeConnexion(rs, st, con);
		}
		return listAgent;
	}

	/*
	 * Récupère la liste d'agents associées aux paramètres de recherches fournis
	 */
	public List<Agent> getList(String recherche, String affectationOperationnelle, String affectationAdministrative,
			String corps, String grade, String lotDeGestion, String partenaire, String pese, String codeCorrespondant,
			String dateNaissance, String codeRegroupementUOPoste) {

		final StringBuilder req = new StringBuilder();
		req.append(" SELECT * FROM AGENT")
				.append(" LEFT JOIN poste ON poste.matricule_renoirh=agent.agent_matricule_renoirh")
				.append(" LEFT JOIN UNITE_STRUCTURELLE ON agent_unite_structurelle_affectation = us_identifiant")
				.append(" LEFT JOIN CORPS ON agent_carriere_accueil_corps = reglementaire_code_corps")
				.append(" LEFT JOIN GRADE ON agent_carriere_emploi_fonctionnel_grade = reglementaire_code_grade")
				.append(" WHERE 1=1 ");

		// Prise en compte du champ recherche
		String rechercheNormalized;
		String[] rechercheNormalizedSplit = { "" };
		if (recherche != null) {
			// On retire les accents et on met en minuscule le texte de recherche
			rechercheNormalized = StringUtils.stripAccents(recherche.toLowerCase());
			rechercheNormalizedSplit = rechercheNormalized.split(" ");

			Connection cnx = null;
			try {
				cnx = DriverManager.getConnection(AgentDAO.UTILS.getUrl(), AgentDAO.UTILS.getUser(),
						AgentDAO.UTILS.getPassword());
				req.append("AND (")
						.append(DataBase.getGoogleQuery(cnx, "AGENT", rechercheNormalizedSplit))
						.append(")");
			} catch (final SQLException e) {
				AgentDAO.UTILS.erreurAccesBase(e);
			} catch (final Exception e) {
				AgentDAO.UTILS.erreurInnatendue(e);
			} finally {
				AgentDAO.UTILS.closeConnexion(null, null, cnx);
			}
		}
		// Prise en compte du champ corps
		if (corps != null) {
			req.append(" AND agent_carriere_accueil_corps = ANY(?)");
		}

		// Prise en compte du champ grade
		if (grade != null) {
			req.append(" AND agent_carriere_emploi_fonctionnel_grade = ANY(?)");
		}
		// Prise en compte du champ lotDeGestion
		if (lotDeGestion != null) {
			req.append(" AND agent_lot_gestion = ANY(?)");
		}

		// Prise en compte du champ affectationOperationnelle
		if (affectationOperationnelle != null) {
			final StringBuilder queryUnite = new StringBuilder();
			queryUnite.append("(WITH RECURSIVE RECURSION(UST_ID, UST_MERE) AS (")
					.append("SELECT UST_ID, UST_ID FROM UNITE_STRUCTURELLE_LIEN WHERE UST_ID = ANY(?)")
					.append(" UNION ALL SELECT L.UST_ID, R.UST_ID FROM UNITE_STRUCTURELLE_LIEN L")
					.append(" INNER JOIN Recursion R on R.UST_ID = L.UST_MERE) SELECT DISTINCT UST_ID FROM RECURSION)");

			req.append(" AND agent_unite_structurelle_affectation in ")
					.append(queryUnite.toString());
		}
		// Prise en compte du champ affectationAdministrative
		if (affectationAdministrative != null) {
			final StringBuilder queryUnite = new StringBuilder();
			queryUnite.append("(WITH RECURSIVE RECURSION(UST_ID, UST_MERE) AS (")
					.append("SELECT UST_ID, UST_ID FROM UNITE_STRUCTURELLE_LIEN WHERE UST_ID = ANY(?)")
					.append(" UNION ALL SELECT L.UST_ID, R.UST_ID FROM UNITE_STRUCTURELLE_LIEN L")
					.append(" INNER JOIN Recursion R on R.UST_ID = L.UST_MERE) SELECT DISTINCT UST_ID FROM RECURSION)");

			req.append(" AND agent_unite_structurelle_affectation in ")
					.append(queryUnite.toString());
		}
		if (partenaire != null) {
			req.append(" AND agent_partenaire= ANY(?)");
		}
		if (pese != null) {
			req.append(" AND agent_axe_pese= ANY(?)");
		}
		if (codeCorrespondant != null) {
			req.append(" AND agent_axe_code_corresp= ANY(?)");
		}

		// Prise en compte du champ dateNaissance
		if (dateNaissance != null) {
			if (dateNaissance.length() == AgentDAO.HUIT) {
				req.append(" AND to_char(agent_date_de_naissance, 'YYYYMMDD') = ?");
			} else if (dateNaissance.length() == AgentDAO.SIX) {
				req.append(" AND to_char(agent_date_de_naissance, 'YYYYMM') = ?");
			} else if (dateNaissance.length() == AgentDAO.QUATRE) {
				req.append(" AND to_char(agent_date_de_naissance, 'YYYY') = ?");
			} else {
				throw new IllegalStateException();
			}
		}
		if (codeRegroupementUOPoste != null) {
			req.append(" AND groupe_uo_poste= ANY(?)");
		}

		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		List<Agent> listAgent = new ArrayList<>();
		try {
			con = DriverManager.getConnection(AgentDAO.UTILS.getUrl(), AgentDAO.UTILS.getUser(),
					AgentDAO.UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			int j = 0;
			if (corps != null) {
				j++;
				final Array a = con.createArrayOf("text",
						AgentDAO.SPLIT_ID_PATTERN.matcher(corps).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (grade != null) {
				j++;
				final Array a = con.createArrayOf("text",
						AgentDAO.SPLIT_ID_PATTERN.matcher(grade).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (lotDeGestion != null) {
				j++;
				final Array a = con.createArrayOf("text",
						AgentDAO.SPLIT_ID_PATTERN.matcher(lotDeGestion).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (affectationOperationnelle != null) {
				j++;
				final Array a = con.createArrayOf("text",
						AgentDAO.SPLIT_ID_PATTERN.matcher(affectationOperationnelle).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (affectationAdministrative != null) {
				j++;
				final Array a = con.createArrayOf("text",
						AgentDAO.SPLIT_ID_PATTERN.matcher(affectationAdministrative).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (partenaire != null) {
				j++;
				final Array a = con.createArrayOf("text",
						AgentDAO.SPLIT_ID_PATTERN.matcher(partenaire).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (pese != null) {
				j++;
				final Array a = con.createArrayOf("text",
						AgentDAO.SPLIT_ID_PATTERN.matcher(pese).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (codeCorrespondant != null) {
				j++;
				final Array a = con.createArrayOf("text",
						AgentDAO.SPLIT_ID_PATTERN.matcher(codeCorrespondant).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (dateNaissance != null) {
				j++;
				st.setString(j, dateNaissance);
			}
			if (codeRegroupementUOPoste != null) {
				j++;
				final Array a = con.createArrayOf("text",
						AgentDAO.SPLIT_ID_PATTERN.matcher(codeRegroupementUOPoste).replaceAll("").split(","));
				st.setArray(j, a);
			}
			AgentDAO.LOG.info("Recuperer la liste des agents: {}", st);
			rs = st.executeQuery();
			listAgent = this.getAgentList(rs, true, false);
			return listAgent;
		} catch (

		final SQLException e) {
			AgentDAO.UTILS.erreurAccesBase(e);
		} catch (

		final Exception e) {
			AgentDAO.UTILS.erreurInnatendue(e);
		} finally {
			AgentDAO.UTILS.closeConnexion(rs, st, con);
		}
		return listAgent;
	}

	/*
	 * Récupère les statuts des agents associées aux paramètres de recherches fournis
	 */
	public List<Agent> getStatutList(String id, String statut, String dateEffet, String exportDateEffetBorne) {

		final StringBuilder req = new StringBuilder();
		req.append(" SELECT * FROM AGENT")
				.append(" LEFT JOIN poste ON poste.matricule_renoirh=agent.agent_matricule_renoirh")
				.append(" WHERE 1=1 ");

		// Prise en compte du champ statut
		if (statut != null) {
			req.append(" and agent_statut = ?");
		}

		if (id != null) {
			req.append(" AND");
			req.append(" agent_matricule_renoirh = ANY(?)");
		}

		if (dateEffet != null) {
			req.append(" AND");
			req.append(" to_char(agent_statut_date_effet, 'YYYYMMDD') >= ?");
		}

		if (exportDateEffetBorne != null) {
			req.append(" AND");
			req.append(
					" (to_char(agent_statut_date_effet, 'YYYYMMDD') >= ? )");
		}

		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		List<Agent> listAgent = new ArrayList<>();
		try {
			con = DriverManager.getConnection(AgentDAO.UTILS.getUrl(), AgentDAO.UTILS.getUser(),
					AgentDAO.UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			int j = 1;
			if (statut != null) {
				st.setString(j, statut);
				j++;
			}
			if (id != null) {
				final Array a = con.createArrayOf("text",
						AgentDAO.SPLIT_ID_PATTERN.matcher(id).replaceAll("").split(","));
				st.setArray(j, a);
				j++;
			}
			if (dateEffet != null) {
				st.setString(j, dateEffet);
				j++;
			}
			if (exportDateEffetBorne != null) {
				st.setString(j, exportDateEffetBorne);
				j++;
				st.setString(j, exportDateEffetBorne);
				j++;
			}
			AgentDAO.LOG.info("{}", st.toString());
			rs = st.executeQuery();
			listAgent = this.getAgentList(rs, false, true);
			return listAgent;
		} catch (final SQLException e) {
			AgentDAO.UTILS.erreurAccesBase(e);
		} catch (final Exception e) {
			AgentDAO.UTILS.erreurInnatendue(e);
		} finally {
			AgentDAO.UTILS.closeConnexion(rs, st, con);
		}
		return listAgent;
	}

	/*
	 * Récupère le nombre d'agents associées aux paramètres de recherches fournis
	 */
	public Map<String, Integer> getEffectif(String recherche, String uniteStructurelle, String corps,
			String grade, String dateNaissance, String exportDateEffet) {

		final StringBuilder req = new StringBuilder();
		req.append(" SELECT NBAGENTH, NBAGENTF FROM")
				.append(" (SELECT COUNT( DISTINCT agent_matricule_renoirh) AS NBAGENTH FROM AGENT");

		final StringBuilder where = new StringBuilder(" WHERE");

		// Prise en compte du champ recherche
		String rechercheNormalized;
		String[] rechercheNormalizedSplit = { "" };
		final int rechercheLength = 0;
		if (recherche != null) {
			// On retire les accents et on met en minuscule le texte de recherche
			rechercheNormalized = StringUtils.stripAccents(recherche.toLowerCase());
			rechercheNormalizedSplit = rechercheNormalized.split(" ");
		}

		Connection cnx = null;
		try {
			cnx = DriverManager.getConnection(AgentDAO.UTILS.getUrl(), AgentDAO.UTILS.getUser(),
					AgentDAO.UTILS.getPassword());
			where.append("(")
					.append(DataBase.getGoogleQuery(cnx, "AGENT", rechercheNormalizedSplit))
					.append(")");
		} catch (final SQLException e) {
			AgentDAO.UTILS.erreurAccesBase(e);
		} catch (final Exception e) {
			AgentDAO.UTILS.erreurInnatendue(e);
		} finally {
			AgentDAO.UTILS.closeConnexion(null, null, cnx);
		}
		// Prise en compte du champ corps
		if (corps != null) {
			where.append(" AND agent_corps_accueil = ANY(?)");
		}

		// Prise en compte du champ grade
		if (grade != null) {
			where.append(" AND agent_grade_fonctionelle = ANY(?)");
		}

		// Prise en compte du champ uniteStructurelle
		if (uniteStructurelle != null) {
			final StringBuilder queryUnite = new StringBuilder();
			queryUnite.append("(WITH RECURSIVE RECURSION(UST_ID, UST_MERE) AS (")
					.append("SELECT UST_ID, UST_ID FROM UNITE_STRUCTURELLE_LIEN WHERE UST_ID = ANY(?)")
					.append(" UNION ALL SELECT L.UST_ID, R.UST_ID FROM RECURSION R, UNITE_STRUCTURELLE_LIEN L")
					.append(" WHERE R.UST_ID = L.UST_MERE) SELECT DISTINCT UST_ID FROM RECURSION)");

			where.append(" AND agent_unite_structurelle_affectation in ")
					.append(queryUnite.toString());
		}

		// Prise en compte du champ dateNaissance
		if (dateNaissance != null) {
			if (dateNaissance.length() == AgentDAO.HUIT) {
				where.append(" AND to_char(agent_date_de_naissance, 'YYYYMMDD') = ?");
			} else if (dateNaissance.length() == AgentDAO.SIX) {
				where.append(
						" AND trim(to_char(extract(YEAR from agent_date_de_naissance), '9999')) = substring(?,1,4)");
				where.append(
						" AND trim(to_char(extract(MONTH from agent_date_de_naissance), '99')) = substring(?,5,2)");
			} else if (dateNaissance.length() == AgentDAO.QUATRE) {
				where.append(" AND trim(to_char(extract(YEAR from agent_date_de_naissance), '9999')) = ?");
			} else {
				throw new IllegalStateException();
			}

		}

		// Prise en compte du champ exportDateEffet
		if (exportDateEffet != null) {
			where.append(" AND to_char(agent_date_debut_carriere, 'YYYYMMDD') >= ?");
		}

		req.append(where.toString())
				.append(" AND agent_sexe = 'H') H")
				.append(" LEFT JOIN (SELECT COUNT( DISTINCT agent_matricule_renoirh) AS NBAGENTF FROM AGENT")
				.append(where.toString())
				.append(" AND agent_sexe = 'F') F ON TRUE");

		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		final HashMap<String, Integer> effectif = new HashMap<>();
		try {
			con = DriverManager.getConnection(AgentDAO.UTILS.getUrl(), AgentDAO.UTILS.getUser(),
					AgentDAO.UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			st = this.getEffectifPreparedStatement(st, rechercheLength, rechercheNormalizedSplit, corps, grade,
					uniteStructurelle, con, dateNaissance, exportDateEffet);
			rs = st.executeQuery();
			AgentDAO.LOG.info("{}", st.toString());
			while (rs.next()) {
				final int nbAgentH = rs.getInt("NBAGENTH");
				final int nbAgentF = rs.getInt("NBAGENTF");
				effectif.put("nbagentf", nbAgentF);
				effectif.put("nbagenth", nbAgentH);
				effectif.put("nbagent", nbAgentF + nbAgentH);
			}
			return effectif;
		} catch (final SQLException e) {
			AgentDAO.UTILS.erreurAccesBase(e);
		} catch (final Exception e) {
			AgentDAO.UTILS.erreurInnatendue(e);
		} finally {
			AgentDAO.UTILS.closeConnexion(rs, st, con);
		}
		return effectif;
	}

	private PreparedStatement getEffectifPreparedStatement(PreparedStatement st, int rechercheLength,
			String[] rechercheNormalizedSplit, String corps, String grade, String uniteStructurelle,
			Connection con, String dateNaissance, String exportDateEffet) {
		int j = rechercheLength;
		try {

			if (corps != null) {
				j++;
				final Array a = con.createArrayOf("text",
						AgentDAO.SPLIT_ID_PATTERN.matcher(corps).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (grade != null) {
				j++;
				final Array a = con.createArrayOf("text",
						AgentDAO.SPLIT_ID_PATTERN.matcher(grade).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (uniteStructurelle != null) {
				j++;
				final Array a = con.createArrayOf("text",
						AgentDAO.SPLIT_ID_PATTERN.matcher(uniteStructurelle).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (dateNaissance != null) {
				j++;
				st.setString(j, dateNaissance);
				if (dateNaissance.length() == AgentDAO.SIX) {
					j++;
					st.setString(j, dateNaissance);
				}
			}
			if (exportDateEffet != null) {
				j++;
				st.setString(j, exportDateEffet);
			}
			for (int i = 0; i < rechercheLength; i++) {
				j++;
				st.setString(j, rechercheNormalizedSplit[i]);
			}
			if (corps != null) {
				j++;
				final Array a = con.createArrayOf("text",
						AgentDAO.SPLIT_ID_PATTERN.matcher(corps).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (uniteStructurelle != null) {
				j++;
				final Array a = con.createArrayOf("text",
						AgentDAO.SPLIT_ID_PATTERN.matcher(uniteStructurelle).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (dateNaissance != null) {
				j++;
				st.setString(j, dateNaissance);
				if (dateNaissance.length() == AgentDAO.SIX) {
					j++;
					st.setString(j, dateNaissance);
				}
			}
		} catch (final SQLException e) {
			AgentDAO.UTILS.erreurAccesBase(e);
		}
		return st;
	}

	/*
	 * Récupère un agent complet
	 */
	protected Agent processRow(ResultSet rs) throws SQLException {
		final Agent agent = new Agent();
		agent.setAgtMatriculeRenoirh(rs.getString(AgentEnum.AGENT_MATRICULE_RENOIRH.toString()));
		agent.setAgtMatriculeRehucit(rs.getString(AgentEnum.AGENT_MATRICULE_REHUCIT.toString()));
		agent.setAgtCivilite(rs.getString(AgentEnum.AGENT_CIVILITE.toString()));
		agent.setAgtNomUsuel(rs.getString(AgentEnum.AGENT_NOM_USUEL.toString()));
		agent.setAgtPrenom(rs.getString(AgentEnum.AGENT_PRENOM.toString()));
		agent.setAgtNomPatronymique(rs.getString(AgentEnum.AGENT_NOM_PATRONYMIQUE.toString()));
		agent.setAgtSexe(rs.getString(AgentEnum.AGENT_SEXE.toString()));
		agent.setAgtAutresPrenoms(rs.getString(AgentEnum.AGENT_AUTRES_PRENOMS.toString()));
		agent.setAgtPaysNationalite(rs.getString(AgentEnum.AGENT_PAYS_DE_NATIONALITE.toString()));
		agent.setAgtDateNaissance(rs.getString(AgentEnum.AGENT_DATE_DE_NAISSANCE.toString()));
		agent.setAgtLieuNaissance(rs.getString(AgentEnum.AGENT_LIEU_DE_NAISSANCE.toString()));
		agent.setAgtDepartementNaissance(rs.getString(AgentEnum.AGENT_DEPARTEMENT_DE_NAISSANCE.toString()));
		agent.setAgtPaysNaissance(rs.getString(AgentEnum.AGENT_PAYS_DE_NAISSANCE.toString()));
		agent.setAgtDateDeces(rs.getString(AgentEnum.AGENT_DATE_DE_DECES.toString()));
		agent.setAgtLieuDeces(rs.getString(AgentEnum.AGENT_LIEU_DE_DECES.toString()));
		agent.setAgtAdresse(rs.getString(AgentEnum.AGENT_ADRESSE.toString()));
		agent.setAgtAdresseComplement(rs.getString(AgentEnum.AGENT_ADRESSE_COMPLEMENT.toString()));
		agent.setAgtAdresseCodePostal(rs.getString(AgentEnum.AGENT_ADRESSE_CODE_POSTAL.toString()));
		agent.setAgtAdresseDepartementCode(rs.getString(AgentEnum.AGENT_ADRESSE_DEPARTEMENT_CODE.toString()));
		agent.setAgtAdresseDepartementFrMetropLibelle(
				rs.getString(AgentEnum.AGENT_ADRESSE_DEPARTEMENT_FR_METROP_LIBELLE.toString()));
		agent.setAgtAdresseDepartementOutreMerLibelle(
				rs.getString(AgentEnum.AGENT_ADRESSE_DEPARTEMENT_OUTRE_MER_LIBELLE.toString()));
		agent.setAgtAdresseCodeInsee(rs.getString(AgentEnum.AGENT_ADRESSE_CODE_INSEE.toString()));
		agent.setAgtAdresseLieuDit(rs.getString(AgentEnum.AGENT_ADRESSE_LIEU_DIT.toString()));
		agent.setAgtAdresseLibelleAcheminement(rs.getString(AgentEnum.AGENT_ADRESSE_LIBELLE_ACHEMINEMENT.toString()));
		agent.setAgtMailProfessionnel(rs.getString(AgentEnum.AGENT_MAIL_PROFESSIONNEL.toString()));
		agent.setAgtPositionAdministrative(rs.getString(AgentEnum.AGENT_POSITION_ADMINISTRATIVE.toString()));
		agent.setAgtPositionAdministrativeDateEffet(
				rs.getString(AgentEnum.AGENT_POSITION_ADMINISTRATIVE_DATE_EFFET.toString()));
		agent.setAgtCategorieAdministrative(rs.getString(AgentEnum.AGENT_CATEGORIE_ADMINISTRATIVE.toString()));
		agent.setAgtSituationFamiliale(rs.getString(AgentEnum.AGENT_SITUATION_FAMILIALE.toString()));
		agent.setAgtLotGestion(rs.getString(AgentEnum.AGENT_LOT_GESTION.toString()));
		agent.setAgtNomReglementation(rs.getString(AgentEnum.AGENT_NOM_REGLEMENTATION.toString()));
		agent.setAgtCarriereOrigineCorps(rs.getString(AgentEnum.AGENT_CARRIERE_ORIGINE_CORPS.toString()));
		agent.setAgtCarriereOrigineCorpsLibelle(
				rs.getString(AgentEnum.AGENT_CARRIERE_ORIGINE_CORPS_LIBELLE.toString()));
		agent.setAgtCarriereOrigineCorpsDateEntree(
				rs.getString(AgentEnum.AGENT_CARRIERE_ORIGINE_CORPS_DATE_ENTREE.toString()));
		agent.setAgtCarriereOrigineGrade(rs.getString(AgentEnum.AGENT_CARRIERE_ORIGINE_GRADE.toString()));
		agent.setAgtCarriereOrigineGradeLibelle(
				rs.getString(AgentEnum.AGENT_CARRIERE_ORIGINE_GRADE_LIBELLE.toString()));
		agent.setAgtCarriereOrigineGradeDateEntree(
				rs.getString(AgentEnum.AGENT_CARRIERE_ORIGINE_GRADE_DATE_ENTREE.toString()));
		agent.setAgtCarriereOrigineEchelon(rs.getString(AgentEnum.AGENT_CARRIERE_ORIGINE_ECHELON.toString()));
		agent.setAgtCarriereEmploiFonctionnelCorps(
				rs.getString(AgentEnum.AGENT_CARRIERE_EMPLOI_FONCTIONNEL_CORPS.toString()));
		agent.setAgtCarriereEmploiFonctionnelCorpsLibelle(
				rs.getString(AgentEnum.AGENT_CARRIERE_EMPLOI_FONCTIONNEL_CORPS_LIBELLE.toString()));
		agent.setAgtCarriereEmploiFonctionnelCorpsDateEntree(
				rs.getString(AgentEnum.AGENT_CARRIERE_EMPLOI_FONCTIONNEL_CORPS_DATE_ENTREE.toString()));
		agent.setAgtCarriereEmploiFonctionnelGrade(
				rs.getString(AgentEnum.AGENT_CARRIERE_EMPLOI_FONCTIONNEL_GRADE.toString()));
		agent.setAgtCarriereEmploiFonctionnelGradeLibelle(
				rs.getString(AgentEnum.AGENT_CARRIERE_EMPLOI_FONCTIONNEL_GRADE_LIBELLE.toString()));
		agent.setAgtCarriereEmploiFonctionnelGradeDateEntree(
				rs.getString(AgentEnum.AGENT_CARRIERE_EMPLOI_FONCTIONNEL_GRADE_DATE_ENTREE.toString()));
		agent.setAgtCarriereEmploiFonctionnelEchelon(
				rs.getString(AgentEnum.AGENT_CARRIERE_EMPLOI_FONCTIONNEL_ECHELON.toString()));
		agent.setAgtCarriereEmploiFonctionnelEchelonDateEffet(
				rs.getString(AgentEnum.AGENT_CARRIERE_EMPLOI_FONCTIONNEL_ECHELON_DATE_EFFET.toString()));
		agent.setAgtCarriereAccueilCorps(rs.getString(AgentEnum.AGENT_CARRIERE_ACCUEIL_CORPS.toString()));
		agent.setAgtCarriereAccueilCorpsLibelle(
				rs.getString(AgentEnum.AGENT_CARRIERE_ACCUEIL_CORPS_LIBELLE.toString()));
		agent.setAgtCarriereAccueilCorpsDateEntree(
				rs.getString(AgentEnum.AGENT_CARRIERE_ACCUEIL_CORPS_DATE_ENTREE.toString()));
		agent.setAgtCarriereAccueilGrade(rs.getString(AgentEnum.AGENT_CARRIERE_ACCUEIL_GRADE.toString()));
		agent.setAgtCarriereAccueilGradeLibelle(
				rs.getString(AgentEnum.AGENT_CARRIERE_ACCUEIL_GRADE_LIBELLE.toString()));
		agent.setAgtCarriereAccueilGradeDateEntree(
				rs.getString(AgentEnum.AGENT_CARRIERE_ACCUEIL_GRADE_DATE_ENTREE.toString()));
		agent.setAgtCarriereAccueilEchelon(rs.getString(AgentEnum.AGENT_CARRIERE_ACCUEIL_ECHELON.toString()));
		agent.setAgtPoste(rs.getString(AgentEnum.AGENT_CODE_POSTE.toString()));
		agent.setAgtPosteLibelle(rs.getString(AgentEnum.AGENT_POSTE_LIBELLE.toString()));
		agent.setAgtAffectationAdministrative(rs.getString(AgentEnum.AGENT_AFFECTATION_ADMINISTRATIVE_CODE.toString()));
		agent.setAgtAffectationAdministrativeLibelleLong(
				rs.getString(AgentEnum.AGENT_AFFECTATION_ADMINISTRATIVE_LIBELLE_LONG.toString()));
		agent.setAgtAffectationAdministrativeLibelleCourt(
				rs.getString(AgentEnum.AGENT_AFFECTATION_ADMINISTRATIVE_LIBELLE_COURT.toString()));
		agent.setAgtAffectationAdministrativeDateInstallation(
				rs.getString(AgentEnum.AGENT_AFFECTATION_ADMINISTRATIVE_DATE_INSTALLATION.toString()));
		agent.setAgtAffectationAdministrativeDateFinReelle(
				rs.getString(AgentEnum.AGENT_AFFECTATION_ADMINISTRATIVE_DATE_FIN_REELLE.toString()));
		agent.setAgtAffectationOperationnelle(rs.getString(AgentEnum.AGENT_AFFECTATION_OPERATIONNELLE_CODE.toString()));
		agent.setAgtAffectationOperationnelleLibelleLong(
				rs.getString(AgentEnum.AGENT_AFFECTATION_OPERATIONNELLE_LIBELLE_LONG.toString()));
		agent.setAgtAffectationOperationnelleLibelleCourt(
				rs.getString(AgentEnum.AGENT_AFFECTATION_OPERATIONNELLE_LIBELLE_COURT.toString()));
		agent.setAgtAffectationOperationnelleDateDebut(
				rs.getString(AgentEnum.AGENT_AFFECTATION_OPERATIONNELLE_DATE_DEBUT.toString()));
		agent.setAgtAffectationOperationnelleDateFin(
				rs.getString(AgentEnum.AGENT_AFFECTATION_OPERATIONNELLE_DATE_FIN.toString()));
		agent.setAgtStatut(rs.getString(AgentEnum.AGENT_STATUT.toString()));
		agent.setAgtStatutLibelle(rs.getString(AgentEnum.AGENT_STATUT_LIBELLE.toString()));
		agent.setAgtStatutDateEffet(rs.getString(AgentEnum.AGENT_STATUT_DATE_EFFET.toString()));
		agent.setAgtModaliteService(rs.getString(AgentEnum.AGENT_MODALITE_SERVICE.toString()));
		agent.setAgtMotifCessationFonction(rs.getString(AgentEnum.AGENT_MOTIF_CESSATION_FONCTION.toString()));
		agent.setAgtDateSortieAdministrative(rs.getString(AgentEnum.AGENT_DATE_SORTIE_ADMINISTRATIVE.toString()));
		agent.setAgtMatriculeRenoirhResponsable(rs.getString(AgentEnum.AGENT_MATRICULE_RENOIRH_RESPONSABLE.toString()));
		agent.setAgtTemoinValidite(rs.getString(AgentEnum.AGENT_TEMOIN_VALIDITE.toString()));
		agent.setAgtDateEntreeMinistere(rs.getString(AgentEnum.AGENT_DATE_ENTREE_MINISTERE.toString()));
		agent.setAgtPartenaire(rs.getString(AgentEnum.AGENT_AXE_PARTENAIRE.toString()));
		agent.setAgtPese(rs.getString(AgentEnum.AGENT_AXE_PESE.toString()));
		agent.setAgtCodeCorrespondadnt(rs.getString(AgentEnum.AGENT_AXE_CODE_CORRESP.toString()));
		agent.setAgtContractuelDateDebut(rs.getString(AgentEnum.AGENT_CONTRACTUEL_DATE_DEBUT.toString()));
		agent.setAgtContractuelDateFinReelle(rs.getString(AgentEnum.AGENT_CONTRACTUEL_DATE_FIN_REELLE.toString()));
		agent.setAgtContractuelDateFinPrevisionnelle(
				rs.getString(AgentEnum.AGENT_CONTRACTUEL_DATE_FIN_PREVISIONNELLE.toString()));
		agent.setAgtContractuelTypeContrat(rs.getString(AgentEnum.AGENT_CONTRACTUEL_TYPE_CONTRAT.toString()));
		agent.setAgtContractuelTypeContratLibelle(
				rs.getString(AgentEnum.AGENT_CONTRACTUEL_TYPE_CONTRAT_LIBELLE.toString()));
		agent.setAgtContractuelPseudoGrade(rs.getString(AgentEnum.AGENT_CONTRACTUEL_PSEUDO_GRADE.toString()));
		agent.setAgtContractuelPseudoGradeLibelle(
				rs.getString(AgentEnum.AGENT_CONTRACTUEL_PSEUDO_GRADE_LIBELLE.toString()));
		agent.setAgtContractuelNumContrat(rs.getString(AgentEnum.AGENT_CONTRACTUEL_NUM_CONTRAT.toString()));
		agent.setAgtContractuelNumAvenant(rs.getString(AgentEnum.AGENT_CONTRACTUEL_NUM_AVENANT.toString()));
		return agent;
	}

	/*
	 * Récupère l'identite agent (partiel)
	 */
	protected Agent processIdentiteAgent(ResultSet rs) throws SQLException {
		final Agent agent = new Agent();
		agent.setAgtMatriculeRenoirh(rs.getString(AgentEnum.AGENT_MATRICULE_RENOIRH.toString()));
		agent.setAgtNomUsuel(rs.getString(AgentEnum.AGENT_NOM_USUEL.toString()));
		agent.setAgtPrenom(rs.getString(AgentEnum.AGENT_PRENOM.toString()));
		agent.setAgtSexe(rs.getString(AgentEnum.AGENT_SEXE.toString()));
		return agent;
	}

	/*
	 * Récupère les informations agents liés au statut (partiel)
	 */
	protected Agent processStatutAgent(ResultSet rs) throws SQLException {
		final Agent agent = new Agent();
		agent.setAgtMatriculeRenoirh(rs.getString(AgentEnum.AGENT_MATRICULE_RENOIRH.toString()));
		agent.setAgtStatut(rs.getString(AgentEnum.AGENT_STATUT.toString()));
		agent.setAgtStatutLibelle(rs.getString(AgentEnum.AGENT_STATUT_LIBELLE.toString()));
		agent.setAgtStatutDateEffet(rs.getString(AgentEnum.AGENT_STATUT_DATE_EFFET.toString()));
		return agent;
	}

	private Poste processPoste(ResultSet rs) throws SQLException {
		final Poste poste = new Poste();
		poste.setCodePoste(rs.getString(PosteEnum.CODE_POSTE.toString()));
		poste.setCodeUORattachement(rs.getString(PosteEnum.CODE_UO_RATTACHEMENT.toString()));
		poste.setDateDebutRattachementUO(rs.getString(PosteEnum.DATE_DEBUT_RATTACHEMENT_UO.toString()));
		poste.setDateFinValiditeUO(rs.getString(PosteEnum.DATE_FIN_VALIDITE_UO.toString()));
		poste.setIntitulePoste(rs.getString(PosteEnum.INTITULE_POSTE.toString()));
		poste.setGroupeUO(rs.getString(PosteEnum.GROUPE_UO_POSTE.toString()));
		return poste;
	}

	private List<Agent> getAgentList(ResultSet rs, boolean fullInformation, boolean statut) throws SQLException {
		final List<Agent> agentList = new ArrayList<>();
		String currentMatricule = "";
		Agent currentAgent = null;
		while (rs.next()) {
			currentMatricule = rs.getString(AgentEnum.AGENT_MATRICULE_RENOIRH.toString());
			final boolean newAgent = (currentAgent == null)
					|| (!currentAgent.getAgtMatriculeRenoirh().equals(currentMatricule));
			if (newAgent) {
				if (fullInformation) {
					currentAgent = this.processRow(rs);
				} else if (statut) {
					currentAgent = this.processStatutAgent(rs);
				} else {
					currentAgent = this.processIdentiteAgent(rs);
				}
				agentList.add(currentAgent);
			}
			currentAgent.getPostes().add(this.processPoste(rs));
		}
		return agentList;
	}
}

```

</details>


---

### 📄 `src/main/java/ze/agent/AgentEnum.java` [2.980 octets]
<a id="src-main-java-ze-agent-AgentEnum-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-agent-AgentEnum-java)

> **Chemin relatif** : `src/main/java/ze/agent/AgentEnum.java`  
> **Taille** : 2.980 octets  
> **Lignes** : 97  
> **Type** : java

```java
package ze.agent;

public enum AgentEnum {
	AGENT_MATRICULE_RENOIRH,
	AGENT_MATRICULE_REHUCIT,
	AGENT_CIVILITE,
	AGENT_NOM_USUEL,
	AGENT_PRENOM,
	AGENT_NOM_PATRONYMIQUE,
	AGENT_SEXE,
	AGENT_AUTRES_PRENOMS,
	AGENT_PAYS_DE_NATIONALITE,
	AGENT_DATE_DE_NAISSANCE,
	AGENT_LIEU_DE_NAISSANCE,
	AGENT_DEPARTEMENT_DE_NAISSANCE,
	AGENT_PAYS_DE_NAISSANCE,
	AGENT_DATE_DE_DECES,
	AGENT_LIEU_DE_DECES,
	AGENT_ADRESSE,
	AGENT_ADRESSE_COMPLEMENT,
	AGENT_ADRESSE_CODE_POSTAL,
	AGENT_ADRESSE_DEPARTEMENT_CODE,
	AGENT_ADRESSE_DEPARTEMENT_FR_METROP_LIBELLE,
	AGENT_ADRESSE_DEPARTEMENT_OUTRE_MER_LIBELLE,
	AGENT_ADRESSE_CODE_INSEE,
	AGENT_ADRESSE_LIEU_DIT,
	AGENT_ADRESSE_LIBELLE_ACHEMINEMENT,
	AGENT_MAIL_PROFESSIONNEL,
	AGENT_POSITION_ADMINISTRATIVE,
	AGENT_POSITION_ADMINISTRATIVE_DATE_EFFET,
	AGENT_CATEGORIE_ADMINISTRATIVE,
	AGENT_SITUATION_FAMILIALE,
	AGENT_LOT_GESTION,
	AGENT_NOM_REGLEMENTATION,
	AGENT_CARRIERE_ORIGINE_CORPS,
	AGENT_CARRIERE_ORIGINE_CORPS_LIBELLE,
	AGENT_CARRIERE_ORIGINE_CORPS_DATE_ENTREE,
	AGENT_CARRIERE_ORIGINE_GRADE,
	AGENT_CARRIERE_ORIGINE_GRADE_LIBELLE,
	AGENT_CARRIERE_ORIGINE_GRADE_DATE_ENTREE,
	AGENT_CARRIERE_ORIGINE_ECHELON,
	AGENT_CARRIERE_EMPLOI_FONCTIONNEL_CORPS,
	AGENT_CARRIERE_EMPLOI_FONCTIONNEL_CORPS_LIBELLE,
	AGENT_CARRIERE_EMPLOI_FONCTIONNEL_CORPS_DATE_ENTREE,
	AGENT_CARRIERE_EMPLOI_FONCTIONNEL_GRADE,
	AGENT_CARRIERE_EMPLOI_FONCTIONNEL_GRADE_LIBELLE,
	AGENT_CARRIERE_EMPLOI_FONCTIONNEL_GRADE_DATE_ENTREE,
	AGENT_CARRIERE_EMPLOI_FONCTIONNEL_ECHELON,
	AGENT_CARRIERE_EMPLOI_FONCTIONNEL_ECHELON_DATE_EFFET,
	AGENT_CARRIERE_ACCUEIL_CORPS,
	AGENT_CARRIERE_ACCUEIL_CORPS_LIBELLE,
	AGENT_CARRIERE_ACCUEIL_CORPS_DATE_ENTREE,
	AGENT_CARRIERE_ACCUEIL_GRADE,
	AGENT_CARRIERE_ACCUEIL_GRADE_LIBELLE,
	AGENT_CARRIERE_ACCUEIL_GRADE_DATE_ENTREE,
	AGENT_CARRIERE_ACCUEIL_ECHELON,
	AGENT_CODE_POSTE,
	AGENT_POSTE_LIBELLE,
	AGENT_AFFECTATION_ADMINISTRATIVE_CODE,
	AGENT_AFFECTATION_ADMINISTRATIVE_LIBELLE_LONG,
	AGENT_AFFECTATION_ADMINISTRATIVE_LIBELLE_COURT,
	AGENT_AFFECTATION_ADMINISTRATIVE_DATE_INSTALLATION,
	AGENT_AFFECTATION_ADMINISTRATIVE_DATE_FIN_REELLE,
	AGENT_AFFECTATION_OPERATIONNELLE_CODE,
	AGENT_AFFECTATION_OPERATIONNELLE_LIBELLE_LONG,
	AGENT_AFFECTATION_OPERATIONNELLE_LIBELLE_COURT,
	AGENT_AFFECTATION_OPERATIONNELLE_DATE_DEBUT,
	AGENT_AFFECTATION_OPERATIONNELLE_DATE_FIN,

	AGENT_STATUT,
	AGENT_STATUT_LIBELLE,
	AGENT_STATUT_DATE_EFFET,
	AGENT_MODALITE_SERVICE,

	AGENT_MOTIF_CESSATION_FONCTION,
	AGENT_DATE_SORTIE_ADMINISTRATIVE,

	AGENT_MATRICULE_RENOIRH_RESPONSABLE,
	AGENT_TEMOIN_VALIDITE,
	AGENT_DATE_ENTREE_MINISTERE,
	AGENT_CONTRACTUEL_NATURE_CONTRAT,

	AGENT_AXE_PARTENAIRE,
	AGENT_AXE_PESE,
	AGENT_AXE_CODE_CORRESP,

	AGENT_CONTRACTUEL_DATE_DEBUT,
	AGENT_CONTRACTUEL_DATE_FIN_REELLE,
	AGENT_CONTRACTUEL_DATE_FIN_PREVISIONNELLE,
	AGENT_CONTRACTUEL_TYPE_CONTRAT,
	AGENT_CONTRACTUEL_TYPE_CONTRAT_LIBELLE,
	AGENT_CONTRACTUEL_PSEUDO_GRADE,
	AGENT_CONTRACTUEL_PSEUDO_GRADE_LIBELLE,
	AGENT_CONTRACTUEL_NUM_CONTRAT,
	AGENT_CONTRACTUEL_NUM_AVENANT
}

```


---

### 📄 `src/main/java/ze/agent/Poste.java` [1.584 octets]
<a id="src-main-java-ze-agent-Poste-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-agent-Poste-java)

> **Chemin relatif** : `src/main/java/ze/agent/Poste.java`  
> **Taille** : 1.584 octets  
> **Lignes** : 74  
> **Type** : java

```java
package ze.agent;

import com.fasterxml.jackson.annotation.JsonProperty;

public class Poste {

	private String codePoste;

	private String intitulePoste;

	private String dateDebutRattachementUO;

	private String dateFinValiditeUO;

	private String codeUORattachement;

	private String groupeUO;

	@JsonProperty("code_poste")
	public String getCodePoste() {
		return this.codePoste;
	}

	public void setCodePoste(String codePoste) {
		this.codePoste = codePoste;
	}

	@JsonProperty("intitule_poste")
	public String getIntitulePoste() {
		return this.intitulePoste;
	}

	public void setIntitulePoste(String intitulePoste) {
		this.intitulePoste = intitulePoste;
	}

	@JsonProperty("date_debut_rattachement")
	public String getDateDebutRattachementUO() {
		return this.dateDebutRattachementUO;
	}

	public void setDateDebutRattachementUO(String dateDebutRattachementUO) {
		this.dateDebutRattachementUO = dateDebutRattachementUO;
	}

	@JsonProperty("date_fin_validite")
	public String getDateFinValiditeUO() {
		return this.dateFinValiditeUO;
	}

	public void setDateFinValiditeUO(String dateFinValiditeUO) {
		this.dateFinValiditeUO = dateFinValiditeUO;
	}

	@JsonProperty("code_uo_rattachement")
	public String getCodeUORattachement() {
		return this.codeUORattachement;
	}

	public void setCodeUORattachement(String codeUORattachement) {
		this.codeUORattachement = codeUORattachement;
	}

	@JsonProperty("agent_axe_code_regroupement_UO_poste")
	public String getGroupeUO() {
		return this.groupeUO;
	}

	public void setGroupeUO(String groupeUO) {
		this.groupeUO = groupeUO;
	}

}

```


---

### 📄 `src/main/java/ze/agent/PosteEnum.java` [188 octets]
<a id="src-main-java-ze-agent-PosteEnum-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-agent-PosteEnum-java)

> **Chemin relatif** : `src/main/java/ze/agent/PosteEnum.java`  
> **Taille** : 188 octets  
> **Lignes** : 12  
> **Type** : java

```java
package ze.agent;

public enum PosteEnum {
	CODE_POSTE,
	INTITULE_POSTE,
	MATRICULE_RENOIRH,
	DATE_DEBUT_RATTACHEMENT_UO,
	DATE_FIN_VALIDITE_UO,
	CODE_UO_RATTACHEMENT,
	GROUPE_UO_POSTE;
}

```


---

### 📄 `src/main/java/ze/carriere/Carriere.java` [4.136 octets]
<a id="src-main-java-ze-carriere-Carriere-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-carriere-Carriere-java)

> **Chemin relatif** : `src/main/java/ze/carriere/Carriere.java`  
> **Taille** : 4.136 octets  
> **Lignes** : 151  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (151 lignes) - Cliquer pour déplier</summary>

```java
package ze.carriere;

import javax.xml.bind.annotation.XmlRootElement;
import javax.xml.bind.annotation.XmlType;

import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;

@XmlRootElement(name = "Carriere")
@XmlType(
		name = "",
		propOrder = { "carriereMatricule", "agentNom", "agentPrenom", "agentDateNaissance", "carriereDateDebut",
				"carriereDateFin",
				"carriereGradeStatutaireDateEffetClassement", "carriereIdentifiantPreliquidationEchelon",
				"carriereTemoinValiditeInformation", "carriereStatutAgent" })
@JsonInclude(JsonInclude.Include.NON_DEFAULT)
public class Carriere {

	private String carriereMatricule;

	private String erreur;

	private String carriereNom;

	private String carrierePrenom;

	private String carriereDateNaissance;

	private String carriereDateDebut;

	private String carriereDateFin;

	private String carriereGradeStatutaireDateEffetClassement;

	private String carriereIdentifiantPreliquidationEchelon;

	private String carriereTemoinValiditeInformation;

	private String carriereStatutAgent;

	private String carriereCodeSpecialite;

	@JsonProperty("carriere_matricule")
	public String getCarriereMatricule() {
		return this.carriereMatricule;
	}

	public void setCarriereMatricule(String carriereMatricule) {
		this.carriereMatricule = carriereMatricule;
	}

	public String getErreur() {
		return this.erreur;
	}

	public void setErreur(String erreur) {
		this.erreur = erreur;
	}

	@JsonProperty("carriere_nom")
	public String getCarriereNom() {
		return this.carriereNom;
	}

	public void setCarriereNom(String agentNom) {
		this.carriereNom = agentNom;
	}

	@JsonProperty("carriere_prenom")
	public String getCarrierePrenom() {
		return this.carrierePrenom;
	}

	public void setCarrierePrenom(String agentPrenom) {
		this.carrierePrenom = agentPrenom;
	}

	@JsonProperty("carriere_date_de_naissance")
	public String getCarriereDateNaissance() {
		return this.carriereDateNaissance;
	}

	public void setCarriereDateNaissance(String agentDateNaissance) {
		this.carriereDateNaissance = agentDateNaissance;
	}

	@JsonProperty("carriere_date_debut")
	public String getCarriereDateDebut() {
		return this.carriereDateDebut;
	}

	public void setCarriereDateDebut(String carriereDateDebut) {
		this.carriereDateDebut = carriereDateDebut;
	}

	@JsonProperty("carriere_date_fin")
	public String getCarriereDateFin() {
		return this.carriereDateFin;
	}

	public void setCarriereDateFin(String carriereDateFin) {
		this.carriereDateFin = carriereDateFin;
	}

	@JsonProperty("carriere_grade_statutaire_date_effet_classement")
	public String getCarriereGradeStatutaireDateEffetClassement() {
		return this.carriereGradeStatutaireDateEffetClassement;
	}

	public void setCarriereGradeStatutaireDateEffetClassement(String carriereGradeStatutaireDateEffet) {
		this.carriereGradeStatutaireDateEffetClassement = carriereGradeStatutaireDateEffet;
	}

	@JsonProperty("carriere_identifiant_preliquidation_echelon")
	public String getCarriereIdentifiantPreliquidationEchelon() {
		return this.carriereIdentifiantPreliquidationEchelon;
	}

	public void setCarriereIdentifiantPreliquidationEchelon(String carriereIdentifiantPreliquidationEchelon) {
		this.carriereIdentifiantPreliquidationEchelon = carriereIdentifiantPreliquidationEchelon;
	}

	@JsonProperty("carriere_temoin_validite_information")
	public String getCarriereTemoinValiditeInformation() {
		return this.carriereTemoinValiditeInformation;
	}

	public void setCarriereTemoinValiditeInformation(String carriereTemoinValidite) {
		this.carriereTemoinValiditeInformation = carriereTemoinValidite;
	}

	@JsonProperty("carriere_statut_agent")
	public String getCarriereStatutAgent() {
		return this.carriereStatutAgent;
	}

	public void setCarriereStatutAgent(String carriereStatutAgent) {
		this.carriereStatutAgent = carriereStatutAgent;
	}

	@JsonProperty("carriere_specialite")
	public String getCarriereCodeSpecialite() {
		return this.carriereCodeSpecialite;
	}

	public void setCarriereCodeSpecialite(String carriereCodeSpecialite) {
		this.carriereCodeSpecialite = carriereCodeSpecialite;
	}

}

```

</details>


---

### 📄 `src/main/java/ze/carriere/CarriereDAO.java` [4.326 octets]
<a id="src-main-java-ze-carriere-CarriereDAO-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-carriere-CarriereDAO-java)

> **Chemin relatif** : `src/main/java/ze/carriere/CarriereDAO.java`  
> **Taille** : 4.326 octets  
> **Lignes** : 120  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (120 lignes) - Cliquer pour déplier</summary>

```java
package ze.carriere;

import java.sql.Array;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;
import java.util.regex.Pattern;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import ze.impl.Utils;

public class CarriereDAO {

	private static final Utils UTILS = new Utils();

	private static final Pattern SPLIT_ID_PATTERN = Pattern.compile("[()']");

	private static final Logger LOG = LoggerFactory.getLogger(CarriereDAO.class);

	/*
	 * Récupère la liste des quotites associées aux paramètres de recherches fournis
	 */
	public List<Carriere> getList(String matricule, String exportDateEffetBorne, String temoinValide) {

		final StringBuilder req = new StringBuilder();
		req.append(" SELECT carriere_matricule, carriere_nom, carriere_prenom, carriere_date_de_naissance")
				.append(", carriere_date_debut, carriere_date_fin, carriere_grade_statutaire_date_effet_classement ")
				.append(", carriere_identifiant_preliquidation_echelon, carriere_temoin_validite_information ")
				.append(", carriere_statut_agent, carriere_specialite ")
				.append(" FROM carriere")
				.append(" WHERE 1=1 ");

		// Prise en compte du champ matricule
		if (matricule != null) {
			req.append(" AND carriere_matricule = ANY(?)");
		}

		// Prise en compte du champ exportDateEffetBorne
		if (exportDateEffetBorne != null) {
			req.append(" AND (to_char(carriere_date_debut, 'YYYYMMDD') >= ?");
			req.append(" OR to_char(carriere_date_fin, 'YYYYMMDD') >= ?");
			req.append(" OR to_char(carriere_date_fin, 'YYYYMMDD') = '00010101')");
		}

		// Prise en compte du champ temoinValide
		if (temoinValide != null) {
			req.append(" AND carriere_temoin_validite_information = ?");
		}

		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		final ArrayList<Carriere> listAgent = new ArrayList<>();
		try {
			con = DriverManager.getConnection(CarriereDAO.UTILS.getUrl(), CarriereDAO.UTILS.getUser(),
					CarriereDAO.UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			int j = 0;
			if (matricule != null) {
				j++;
				final Array a = con.createArrayOf("text",
						CarriereDAO.SPLIT_ID_PATTERN.matcher(matricule).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (exportDateEffetBorne != null) {
				j++;
				st.setString(j, exportDateEffetBorne);
				j++;
				st.setString(j, exportDateEffetBorne);
			}
			if (temoinValide != null) {
				j++;
				st.setString(j, temoinValide);
			}
			CarriereDAO.LOG.info("{}", st);
			rs = st.executeQuery();
			while (rs.next()) {
				listAgent.add(this.processRow(rs));
			}
			return listAgent;
		} catch (final SQLException e) {
			CarriereDAO.UTILS.erreurAccesBase(e);
		} catch (final Exception e) {
			CarriereDAO.UTILS.erreurInnatendue(e);
		} finally {
			CarriereDAO.UTILS.closeConnexion(rs, st, con);
		}
		return listAgent;
	}

	/*
	 * Récupère un quotite complet
	 */
	protected Carriere processRow(ResultSet rs) throws SQLException {
		final Carriere carriere = new Carriere();
		carriere.setCarriereMatricule(rs.getString(CarriereEnum.CARRIERE_MATRICULE.toString()));
		carriere.setCarriereNom(rs.getString(CarriereEnum.CARRIERE_NOM.toString()));
		carriere.setCarrierePrenom(rs.getString(CarriereEnum.CARRIERE_PRENOM.toString()));
		carriere.setCarriereDateNaissance(rs.getString(CarriereEnum.CARRIERE_DATE_DE_NAISSANCE.toString()));
		carriere.setCarriereDateDebut(rs.getString(CarriereEnum.CARRIERE_DATE_DEBUT.toString()));
		carriere.setCarriereDateFin(rs.getString(CarriereEnum.CARRIERE_DATE_FIN.toString()));
		carriere.setCarriereGradeStatutaireDateEffetClassement(
				rs.getString(CarriereEnum.CARRIERE_GRADE_STATUTAIRE_DATE_EFFET_CLASSEMENT.toString()));
		carriere.setCarriereIdentifiantPreliquidationEchelon(
				rs.getString(CarriereEnum.CARRIERE_IDENTIFIANT_PRELIQUIDATION_ECHELON.toString()));
		carriere.setCarriereTemoinValiditeInformation(
				rs.getString(CarriereEnum.CARRIERE_TEMOIN_VALIDITE_INFORMATION.toString()));
		carriere.setCarriereStatutAgent(rs.getString(CarriereEnum.CARRIERE_STATUT_AGENT.toString()));
		carriere.setCarriereCodeSpecialite(rs.getString(CarriereEnum.CARRIERE_SPECIALITE.toString()));
		return carriere;
	}

}

```

</details>


---

### 📄 `src/main/java/ze/carriere/CarriereEnum.java` [357 octets]
<a id="src-main-java-ze-carriere-CarriereEnum-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-carriere-CarriereEnum-java)

> **Chemin relatif** : `src/main/java/ze/carriere/CarriereEnum.java`  
> **Taille** : 357 octets  
> **Lignes** : 16  
> **Type** : java

```java
package ze.carriere;

public enum CarriereEnum {
	CARRIERE_MATRICULE,
	CARRIERE_NOM,
	CARRIERE_PRENOM,
	CARRIERE_DATE_DE_NAISSANCE,
	CARRIERE_DATE_DEBUT,
	CARRIERE_DATE_FIN,
	CARRIERE_GRADE_STATUTAIRE_DATE_EFFET_CLASSEMENT,
	CARRIERE_IDENTIFIANT_PRELIQUIDATION_ECHELON,
	CARRIERE_TEMOIN_VALIDITE_INFORMATION,
	CARRIERE_STATUT_AGENT,
	CARRIERE_SPECIALITE,
}

```


---

### 📄 `src/main/java/ze/database/utils/DataBase.java` [3.789 octets]
<a id="src-main-java-ze-database-utils-DataBase-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-database-utils-DataBase-java)

> **Chemin relatif** : `src/main/java/ze/database/utils/DataBase.java`  
> **Taille** : 3.789 octets  
> **Lignes** : 130  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (130 lignes) - Cliquer pour déplier</summary>

```java
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ze.database.utils;

import java.sql.*;
import java.util.ArrayList;
import java.util.List;

import org.slf4j.*;

/**
 * @author sami
 */
public class DataBase {

	private static final org.slf4j.Logger LOG = LoggerFactory.getLogger(DataBase.class);

	/**
	 * @param tableName nom de la table
	 * @return les noms des colonnes d'une table
	 * @throws SQLException
	 * @throws ClassNotFoundException
	 */
	public static String[] getAllTextColumns(Connection cnx, String tableName)
			throws SQLException, ClassNotFoundException {
		final PreparedStatement st = cnx.prepareStatement("select * from " + tableName);
		final ResultSet rs = st.executeQuery();
		final ResultSetMetaData meta = rs.getMetaData();
		final int count = meta.getColumnCount();
		final List<String> colNames = new ArrayList<>();
		for (int i = 0; i < count; i++) {
			final int columnType = meta.getColumnType(i + 1);
			if (columnType == 12) {
				colNames.add(meta.getColumnName(i + 1));
			}
		}
		return colNames.toArray(new String[0]);
	}

	/**
	 * chercher chaque valeur d'une liste de valeurs dans les champs
	 *
	 * @param prefix nom de table ou alias
	 * @param colNames noms des colonnes à tester
	 * @param values valeurs cherchées dans les colonnes
	 * @return expression booléenne
	 */
	public static String getQueryEachColumnInValueSet(String prefix, String[] colNames, String[] values) {
		final StringBuilder valueSet = new StringBuilder("(");
		String separator = "";
		for (final String name : values) {
			valueSet.append(separator)
					.append("'")
					.append(name)
					.append("'");
			separator = ",";
		}
		valueSet.append(")");
		String operator = "";
		final StringBuilder queryBuilder = new StringBuilder("");
		for (final String name : colNames) {
			queryBuilder.append(operator)
					.append(prefix)
					.append(".")
					.append(name)
					.append(" IN ")
					.append(valueSet.toString());
			operator = " OR ";
		}
		return queryBuilder.toString();
	}

	/**
	 * @param prefix nom de table ou alias
	 * @param colNames noms des colonnes à tester
	 * @param values valeurs cherchées dans les colonnes
	 * @return expression booléenne (LIKE)
	 */
	public static String getQueryEachColumnLikeValue(String prefix, String[] colNames, String[] values) {
		if (values.length == 0) {
			return "";
		}

		String operator = "";
		final StringBuilder queryBuilder = new StringBuilder("(");

		for (final String value : values) {
			queryBuilder.append(operator).append("(").append(DataBase.queryForOneValueInAllColumns(value, colNames))
					.append(")");
			operator = " AND ";
		}

		queryBuilder.append(")");

		return queryBuilder.toString();
	}

	private static String queryForOneValueInAllColumns(String value, String[] colNames) {
		final StringBuilder queryBuilder = new StringBuilder();
		String operator = "";
		for (final String colName : colNames) {
			queryBuilder.append(operator)
					.append(" translate(lower(")
					.append(colName)
					.append("),'éèà','eea') ~ '")
					.append(value)
					.append("'");
			operator = " OR ";
		}
		return queryBuilder.toString();
	}

	/**
	 * @param cnx connexion à la base
	 * @param tableName nom de table
	 * @param values les valeurs cherchées
	 * @return expression booléenne
	 * @throws SQLException
	 * @throws ClassNotFoundException
	 */
	public static String getGoogleQuery(Connection cnx, String tableName, String[] values)
			throws SQLException, ClassNotFoundException {
		final String[] colNames = DataBase.getAllTextColumns(cnx, tableName);
		return DataBase.getQueryEachColumnLikeValue(tableName, colNames, values);
	}
}

```

</details>


---

### 📄 `src/main/java/ze/habilitation/Habilitation.java` [4.364 octets]
<a id="src-main-java-ze-habilitation-Habilitation-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-habilitation-Habilitation-java)

> **Chemin relatif** : `src/main/java/ze/habilitation/Habilitation.java`  
> **Taille** : 4.364 octets  
> **Lignes** : 147  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (147 lignes) - Cliquer pour déplier</summary>

```java
package ze.habilitation;

import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;

import java.util.ArrayList;
import java.util.List;

@JsonInclude(JsonInclude.Include.NON_NULL)
public class Habilitation {

	private String adresseMail;

	private String nomUtilisateur;

	private String prenomUtilisateur;

	private String matriculeRenoirh;

	private String agentAffectationAdministrative;

	private String agentAffectationAdministrativeLibelleLong;

	private String agentAffectationAdministrativeLibelleCourt;

	private String agentAffectationOperationnelle;

	private String agentAffectationOperationnelleLibelleLong;

	private String agentAffectationOperationnelleLibelleCourt;

	private List<Profil> habProfil = new ArrayList<>();

	@JsonProperty("adresse_mail")
	public String getAdresseMail() {
		return this.adresseMail;
	}

	public void setAdresseMail(String adresseMail) {
		this.adresseMail = adresseMail;
	}

	@JsonProperty("nom_utilisateur")
	public String getNomUtilisateur() {
		return this.nomUtilisateur;
	}

	public void setNomUtilisateur(String nomUtilisateur) {
		this.nomUtilisateur = nomUtilisateur;
	}

	@JsonProperty("prenom_utilisateur")
	public String getPrenomUtilisateur() {
		return this.prenomUtilisateur;
	}

	public void setPrenomUtilisateur(String prenomUtilisateur) {
		this.prenomUtilisateur = prenomUtilisateur;
	}

	@JsonProperty("matricule_renoirh")
	public String getMatriculeRenoirh() {
		return this.matriculeRenoirh;
	}

	public void setMatriculeRenoirh(String matriculeRenoirh) {
		this.matriculeRenoirh = matriculeRenoirh;
	}

	@JsonProperty("agent_affectation_administrative")
	public String getAgentAffectationAdministrative() {
		return this.agentAffectationAdministrative;
	}

	public void setAgentAffectationAdministrative(String agentAffectationAdministrative) {
		this.agentAffectationAdministrative = agentAffectationAdministrative;
	}

	@JsonProperty("agent_affectation_administrative_libelle_long")
	public String getAgentAffectationAdministrativeLibelleLong() {
		return this.agentAffectationAdministrativeLibelleLong;
	}

	public void setAgentAffectationAdministrativeLibelleLong(String agentAffectationAdministrativeLibelleLong) {
		this.agentAffectationAdministrativeLibelleLong = agentAffectationAdministrativeLibelleLong;
	}

	@JsonProperty("agent_affectation_administrative_libelle_court")
	public String getAgentAffectationAdministrativeLibelleCourt() {
		return this.agentAffectationAdministrativeLibelleCourt;
	}

	public void setAgentAffectationAdministrativeLibelleCourt(String agentAffectationAdministrativeLibelleCourt) {
		this.agentAffectationAdministrativeLibelleCourt = agentAffectationAdministrativeLibelleCourt;
	}

	@JsonProperty("agent_affectation_operationnelle")
	public String getAgentAffectationOperationnelle() {
		return this.agentAffectationOperationnelle;
	}

	public void setAgentAffectationOperationnelle(String agentAffectationOperationnelle) {
		this.agentAffectationOperationnelle = agentAffectationOperationnelle;
	}

	@JsonProperty("agent_affectation_operationnelle_libelle_long")
	public String getAgentAffectationOperationnelleLibelleLong() {
		return this.agentAffectationOperationnelleLibelleLong;
	}

	public void setAgentAffectationOperationnelleLibelleLong(String agentAffectationOperationnelleLibelleLong) {
		this.agentAffectationOperationnelleLibelleLong = agentAffectationOperationnelleLibelleLong;
	}

	@JsonProperty("agent_affectation_operationnelle_libelle_court")
	public String getAgentAffectationOperationnelleLibelleCourt() {
		return this.agentAffectationOperationnelleLibelleCourt;
	}

	public void setAgentAffectationOperationnelleLibelleCourt(String agentAffectationOperationnelleLibelleCourt) {
		this.agentAffectationOperationnelleLibelleCourt = agentAffectationOperationnelleLibelleCourt;
	}

	@JsonProperty("profil")
	public List<Profil> getHabProfil() {
		return this.habProfil;
	}

	public void setHabProfil(List<Profil> habProfil) {
		this.habProfil = habProfil;
	}

	@Override
	public boolean equals(Object obj) {
		if (!(obj instanceof Habilitation)) {
			return false;
		}
		final Habilitation habilitation = (Habilitation) obj;
		return this.matriculeRenoirh.contentEquals(habilitation.matriculeRenoirh);
	}

	@Override
	public int hashCode() {
		return this.matriculeRenoirh.length();
	}
}

```

</details>


---

### 📄 `src/main/java/ze/habilitation/HabilitationDAO.java` [4.473 octets]
<a id="src-main-java-ze-habilitation-HabilitationDAO-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-habilitation-HabilitationDAO-java)

> **Chemin relatif** : `src/main/java/ze/habilitation/HabilitationDAO.java`  
> **Taille** : 4.473 octets  
> **Lignes** : 102  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (102 lignes) - Cliquer pour déplier</summary>

```java
package ze.habilitation;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import ze.impl.Utils;

public class HabilitationDAO {

	private static final Utils UTILS = new Utils();

	private static final Logger LOG = LoggerFactory.getLogger(HabilitationDAO.class);

	public Habilitation getHabilitation(String adresseMail) {

		final StringBuilder req = new StringBuilder("select * from habilitation")
				.append(" join profil on habilitation.matricule_renoirh=profil.matricule_renoirh")
				.append(" where upper(adresse_mail)=upper(?)");

		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		Habilitation habilitation = null;
		try {
			con = DriverManager.getConnection(HabilitationDAO.UTILS.getUrl(), HabilitationDAO.UTILS.getUser(),
					HabilitationDAO.UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			st.setString(1, adresseMail);
			HabilitationDAO.LOG.info("Recuperer la liste des profils: {}", st);
			rs = st.executeQuery();
			final List<Profil> profils = new ArrayList<>();
			while (rs.next()) {
				if (habilitation == null) {
					habilitation = this.processHabilitationRow(rs);
				}
				profils.add(this.processProfilRow(rs));
			}
			if (habilitation != null) {
				habilitation.setHabProfil(profils);
			}
		} catch (final SQLException ex) {
			HabilitationDAO.UTILS.erreurAccesBase(ex);
		} finally {
			HabilitationDAO.UTILS.closeConnexion(rs, st, con);
		}
		return habilitation;
	}

	private Habilitation processHabilitationRow(ResultSet rs) throws SQLException {
		final Habilitation habilitation = new Habilitation();
		habilitation.setAdresseMail(rs.getString(HabilitationEnum.ADRESSE_MAIL.toString()));
		habilitation.setNomUtilisateur(rs.getString(HabilitationEnum.NOM_UTILISATEUR.toString()));
		habilitation.setPrenomUtilisateur(rs.getString(HabilitationEnum.PRENOM_UTILISATEUR.toString()));
		habilitation.setMatriculeRenoirh(rs.getString(HabilitationEnum.MATRICULE_RENOIRH.toString()));
		habilitation.setAgentAffectationAdministrative(
				rs.getString(HabilitationEnum.AGENT_AFFECTATION_ADMINISTRATIVE.toString()));
		habilitation.setAgentAffectationAdministrativeLibelleLong(
				rs.getString(HabilitationEnum.AGENT_AFFECTATION_ADMINISTRATIVE_LIBELLE_LONG.toString()));
		habilitation.setAgentAffectationAdministrativeLibelleCourt(
				rs.getString(HabilitationEnum.AGENT_AFFECTATION_ADMINISTRATIVE_LIBELLE_COURT.toString()));
		habilitation.setAgentAffectationOperationnelle(
				rs.getString(HabilitationEnum.AGENT_AFFECTATION_OPERATIONNELLE.toString()));
		habilitation.setAgentAffectationOperationnelleLibelleLong(
				rs.getString(HabilitationEnum.AGENT_AFFECTATION_OPERATIONNELLE_LIBELLE_LONG.toString()));
		habilitation.setAgentAffectationOperationnelleLibelleCourt(
				rs.getString(HabilitationEnum.AGENT_AFFECTATION_OPERATIONNELLE_LIBELLE_COURT.toString()));
		return habilitation;
	}

	private Profil processProfilRow(ResultSet rs) throws SQLException {
		final Profil profil = new Profil();
		profil.setModeleRole(rs.getString(HabilitationEnum.MODELE_DE_ROLE.toString()));
		profil.setIntituleModeleRole(rs.getString(HabilitationEnum.INTITULE_MODELE_ROLE.toString()));
		profil.setHabAxe(rs.getString(HabilitationEnum.HAB_AXE.toString()));
		profil.setHabAxeCorp(this.splitStringOrNull(rs.getString(HabilitationEnum.HAB_AXE_CORP.toString())));
		profil.setHabAxeCorresp(this.splitStringOrNull(rs.getString(HabilitationEnum.HAB_AXE_CORRESP.toString())));
		profil.setHabAxeGrpUoPoste(
				this.splitStringOrNull(rs.getString(HabilitationEnum.HAB_AXE_GRP_UO_POSTE.toString())));
		profil.setHabAxeLdg(this.splitStringOrNull(rs.getString(HabilitationEnum.HAB_AXE_LDG.toString())));
		profil.setHabAxePart(this.splitStringOrNull(rs.getString(HabilitationEnum.HAB_AXE_PART.toString())));
		profil.setHabAxePese(this.splitStringOrNull(rs.getString(HabilitationEnum.HAB_AXE_PESE.toString())));
		profil.setHabAxeUsAdm(this.splitStringOrNull(rs.getString(HabilitationEnum.HAB_AXE_US_ADM.toString())));
		profil.setHabAxeUsOper(this.splitStringOrNull(rs.getString(HabilitationEnum.HAB_AXE_US_OPER.toString())));
		return profil;
	}

	private String[] splitStringOrNull(String string) {
		if (string == null) {
			return new String[0];
		}
		return string.split(",");
	}
}

```

</details>


---

### 📄 `src/main/java/ze/habilitation/HabilitationEnum.java` [582 octets]
<a id="src-main-java-ze-habilitation-HabilitationEnum-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-habilitation-HabilitationEnum-java)

> **Chemin relatif** : `src/main/java/ze/habilitation/HabilitationEnum.java`  
> **Taille** : 582 octets  
> **Lignes** : 27  
> **Type** : java

```java
package ze.habilitation;

public enum HabilitationEnum {
	ADRESSE_MAIL,
	NOM_UTILISATEUR,
	PRENOM_UTILISATEUR,
	MATRICULE_RENOIRH,
	AGENT_AFFECTATION_ADMINISTRATIVE,
	AGENT_AFFECTATION_ADMINISTRATIVE_LIBELLE_LONG,
	AGENT_AFFECTATION_ADMINISTRATIVE_LIBELLE_COURT,
	AGENT_AFFECTATION_OPERATIONNELLE,
	AGENT_AFFECTATION_OPERATIONNELLE_LIBELLE_LONG,
	AGENT_AFFECTATION_OPERATIONNELLE_LIBELLE_COURT,

	MODELE_DE_ROLE,
	INTITULE_MODELE_ROLE,
	HAB_AXE,
	HAB_AXE_US_OPER,
	HAB_AXE_PESE,
	HAB_AXE_US_ADM,
	HAB_AXE_PART,
	HAB_AXE_CORP,
	HAB_AXE_GRP_UO_POSTE,
	HAB_AXE_LDG,
	HAB_AXE_CORRESP
}

```


---

### 📄 `src/main/java/ze/habilitation/Profil.java` [2.553 octets]
<a id="src-main-java-ze-habilitation-Profil-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-habilitation-Profil-java)

> **Chemin relatif** : `src/main/java/ze/habilitation/Profil.java`  
> **Taille** : 2.553 octets  
> **Lignes** : 129  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (129 lignes) - Cliquer pour déplier</summary>

```java
package ze.habilitation;

import com.fasterxml.jackson.annotation.JsonProperty;

public class Profil {

	private String modeleRole;

	private String intituleModeleRole;

	private String habAxe;

	private String[] habAxeUsOper;

	private String[] habAxePese;

	private String[] habAxeUsAdm;

	private String[] habAxePart;

	private String[] habAxeCorp;

	private String[] habAxeGrpUoPoste;

	private String[] habAxeLdg;

	private String[] habAxeCorresp;

	@JsonProperty("modele_role")
	public String getModeleRole() {
		return this.modeleRole;
	}

	public void setModeleRole(String modeleRole) {
		this.modeleRole = modeleRole;
	}

	@JsonProperty("intitule_modele_role")
	public String getIntituleModeleRole() {
		return this.intituleModeleRole;
	}

	public void setIntituleModeleRole(String intituleModeleRole) {
		this.intituleModeleRole = intituleModeleRole;
	}

	@JsonProperty("hab_axe")
	public String getHabAxe() {
		return this.habAxe;
	}

	public void setHabAxe(String habAxe) {
		this.habAxe = habAxe;
	}

	@JsonProperty("hab_axe_us_oper")
	public String[] getHabAxeUsOper() {
		return this.habAxeUsOper;
	}

	public void setHabAxeUsOper(String[] habAxeUsOper) {
		this.habAxeUsOper = habAxeUsOper;
	}

	@JsonProperty("hab_axe_pese")
	public String[] getHabAxePese() {
		return this.habAxePese;
	}

	public void setHabAxePese(String[] habAxePese) {
		this.habAxePese = habAxePese;
	}

	@JsonProperty("hab_axe_us_adm")
	public String[] getHabAxeUsAdm() {
		return this.habAxeUsAdm;
	}

	public void setHabAxeUsAdm(String[] habAxeUsAdm) {
		this.habAxeUsAdm = habAxeUsAdm;
	}

	@JsonProperty("hab_axe_part")
	public String[] getHabAxePart() {
		return this.habAxePart;
	}

	public void setHabAxePart(String[] habAxePart) {
		this.habAxePart = habAxePart;
	}

	@JsonProperty("hab_axe_corp")
	public String[] getHabAxeCorp() {
		return this.habAxeCorp;
	}

	public void setHabAxeCorp(String[] habAxeCorp) {
		this.habAxeCorp = habAxeCorp;
	}

	@JsonProperty("hab_axe_grp_uo_poste")
	public String[] getHabAxeGrpUoPoste() {
		return this.habAxeGrpUoPoste;
	}

	public void setHabAxeGrpUoPoste(String[] habAxeGrpUoPoste) {
		this.habAxeGrpUoPoste = habAxeGrpUoPoste;
	}

	@JsonProperty("hab_axe_ldg")
	public String[] getHabAxeLdg() {
		return this.habAxeLdg;
	}

	public void setHabAxeLdg(String[] habAxeLdg) {
		this.habAxeLdg = habAxeLdg;
	}

	@JsonProperty("hab_axe_corresp")
	public String[] getHabAxeCorresp() {
		return this.habAxeCorresp;
	}

	public void setHabAxeCorresp(String[] habAxeCorresp) {
		this.habAxeCorresp = habAxeCorresp;
	}

}

```

</details>


---

### 📄 `src/main/java/ze/impl/Authorisation.java` [1.033 octets]
<a id="src-main-java-ze-impl-Authorisation-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-impl-Authorisation-java)

> **Chemin relatif** : `src/main/java/ze/impl/Authorisation.java`  
> **Taille** : 1.033 octets  
> **Lignes** : 38  
> **Type** : java

```java
package ze.impl;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

public class Authorisation {

	private static final Utils UTILS = new Utils();

	// Vérifie si l'application est autorisé à utiliser le webservice
	public boolean isApplicationAuthorized(String applicationName, String webServiceName) {
		StringBuilder req = new StringBuilder();
		req.append("select count(*) from app_auth where app = ?")
				.append("and service = ?");

		int count = 0;
		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		try {
			con = DriverManager.getConnection(UTILS.getUrl(), UTILS.getUser(), UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			st.setString(1, applicationName);
			st.setString(2, webServiceName);
			rs = st.executeQuery();
			rs.next();
			count = rs.getInt(1);
		} catch (Exception e) {
			UTILS.erreurAccesBase(e);
		} finally {
			UTILS.closeConnexion(rs, st, con);
		}
		return count != 0;
	}
}

```


---

### 📄 `src/main/java/ze/impl/CsvFileWriter.java` [82.453 octets]
<a id="src-main-java-ze-impl-CsvFileWriter-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-impl-CsvFileWriter-java)

> **Chemin relatif** : `src/main/java/ze/impl/CsvFileWriter.java`  
> **Taille** : 82.453 octets  
> **Lignes** : 1299  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (1299 lignes) - Cliquer pour déplier</summary>

```java
package ze.impl;

import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.time.LocalDate;
import java.time.LocalTime;
import java.util.Arrays;
import java.util.List;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import ze.absence.Absence;
import ze.absence.AbsenceEnum;
import ze.affectation.Affectation;
import ze.affectation.AffectationEnum;
import ze.agent.Agent;
import ze.agent.AgentEnum;
import ze.carriere.Carriere;
import ze.habilitation.Habilitation;
import ze.habilitation.Profil;
import ze.quotite.Quotite;
import ze.reglementaire.Contractuel;
import ze.reglementaire.Corps;
import ze.reglementaire.Grade;
import ze.remuneration.Remuneration;
import ze.remuneration.RemunerationEnum;
import ze.unitestructurelle.UniteStructurelle;

public class CsvFileWriter {

	private static final Logger LOG = LoggerFactory.getLogger(CsvFileWriter.class);

	private static final String SEPARATOR = ";";

	private static final char NEW_LINE = '\n';

	private static final char QUOTE = '\"';

	private static final char DIRECTORY_DELIMITER = '/';

	private static final String FILE_US = "listUS";

	private static final String FILE_AGENT = "listAgent";

	private static final String FILE_REMUNERATION = "listRemuneration";

	private static final String FILE_ABSENCE = "listAbsence";

	private static final String FILE_AFFECTATION = "listAffectation";

	private static final String FILE_QUOTITE = "listQuotite";

	private static final String FILE_CARRIERE = "listCarriere";

	private static final String FILE_CORPS = "listCorps";

	private static final String FILE_GRADE = "listGrade";

	private static final String FILE_PSEUDO_GRADE = "listPseudoGrade";

	private static final String FILE_HABILITATION = "listHabilitation";

	private static final String IOEXCEPTION = "IOException : Erreur lors de la création du fichier : {}";

	private static final Utils UTILS = new Utils();

	private CsvFileWriter() {
		throw new IllegalStateException("Utility class");
	}

	/**
	 * @param applicationName nom de l'application pour laquelle on crée le fichier
	 * @param baseName nom du service appelé
	 * @return fichier à utiliser
	 */
	private static File createFile(String applicationName, String baseName) {

		final int p = applicationName.indexOf('-');
		final String rootFolder = applicationName.substring(0, p);
		final String envFolder = applicationName.substring(p + 1);
		final File pathFile = new File(
				CsvFileWriter.UTILS.getAsynchfolder() + CsvFileWriter.DIRECTORY_DELIMITER + rootFolder
						+ CsvFileWriter.DIRECTORY_DELIMITER + envFolder);
		if (!pathFile.exists() && !pathFile.mkdirs()) {
			CsvFileWriter.LOG.error("La création de dossier n'a pas pu aboutir");
		}
		final LocalDate date = LocalDate.now();
		final LocalTime time = LocalTime.now();
		final String fullName = new StringBuilder(pathFile.getAbsolutePath()).append(CsvFileWriter.DIRECTORY_DELIMITER)
				.append(baseName).append("_")
				.append(date.getYear()).append("_")
				.append(date.getMonthValue())
				.append("_")
				.append(date.getDayOfMonth()).append("_").append(time.getHour()).append("_").append(time.getMinute())
				.append("_").append(time.getSecond()).toString();
		File f = new File(new StringBuilder().append(fullName).append(".csv").toString());
		int i = 1;
		while (f.exists()) {
			f = new File(new StringBuilder(pathFile.getAbsolutePath()).append(fullName).append("_").append(i)
					.append(".csv").toString());
			i++;
		}

		CsvFileWriter.LOG.info("Fichier créé: {}", f.getAbsolutePath());
		return f;
	}

	public static File writeUSCsvFile(String applicationName, List<UniteStructurelle> list) {

		final File f = CsvFileWriter.createFile(applicationName, CsvFileWriter.FILE_US);
		try {
			if (!f.createNewFile()) {
				throw new IOException();
			}
		} catch (final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}
		try (FileWriter fwriter = new FileWriter(f)) {
			// Ligne Header
			final StringBuilder header = new StringBuilder();
			header.append("us_identifiant").append(CsvFileWriter.SEPARATOR).append("us_libelle_long")
					.append(CsvFileWriter.SEPARATOR).append("us_libelle_court")
					.append(CsvFileWriter.SEPARATOR).append("us_date_creation").append(CsvFileWriter.SEPARATOR)
					.append("us_date_fermeture").append(CsvFileWriter.SEPARATOR)
					.append("us_nature").append(CsvFileWriter.SEPARATOR).append("us_type_us")
					.append(CsvFileWriter.SEPARATOR).append("us_code_ministere")
					.append(CsvFileWriter.SEPARATOR).append("us_numero_voie").append(CsvFileWriter.SEPARATOR)
					.append("us_voie_bis_ter").append(CsvFileWriter.SEPARATOR)
					.append("us_libelle_voie").append(CsvFileWriter.SEPARATOR).append("us_complement_agent")
					.append(CsvFileWriter.SEPARATOR).append("us_code_postal")
					.append(CsvFileWriter.SEPARATOR).append("us_code_insee").append(CsvFileWriter.SEPARATOR)
					.append("us_commune").append(CsvFileWriter.SEPARATOR)
					.append("us_departement").append(CsvFileWriter.SEPARATOR).append("us_pays")
					.append(CsvFileWriter.SEPARATOR).append("us_bureau_distributeur")
					.append(CsvFileWriter.SEPARATOR).append("us_niveau").append(CsvFileWriter.SEPARATOR)
					.append("us_mere").append(CsvFileWriter.SEPARATOR)
					.append("us_type_arborescence").append(CsvFileWriter.SEPARATOR).append("us_date_debut_rattachement")
					.append(CsvFileWriter.SEPARATOR).append("us_date_fin_rattachement")
					.append(CsvFileWriter.SEPARATOR).append("us_type_organisation").append(CsvFileWriter.SEPARATOR)
					.append("us_unite_organisationnelle").append(CsvFileWriter.SEPARATOR)
					.append("us_libelle_court_uo").append(CsvFileWriter.SEPARATOR).append("us_structure_uo")
					.append(CsvFileWriter.SEPARATOR).append("us_date_effet")
					.append(CsvFileWriter.SEPARATOR).append("us_date_fin").append(CsvFileWriter.SEPARATOR)
					.append("us_nom_responsable_uo").append(CsvFileWriter.SEPARATOR)
					.append("us_niveau_direction").append(CsvFileWriter.SEPARATOR).append("us_niveau_service")
					.append(CsvFileWriter.SEPARATOR).append("us_niveau_unite_structurelle")
					.append(CsvFileWriter.SEPARATOR).append("nudoss").append(CsvFileWriter.SEPARATOR).append("us_actif")
					.append(CsvFileWriter.SEPARATOR)
					.append("us_nombre_agents").append(CsvFileWriter.SEPARATOR).append("us_nombre_agents_masculins")
					.append(CsvFileWriter.SEPARATOR)
					.append("us_nombre_agents_feminins").append(CsvFileWriter.SEPARATOR).append("us_avec_agent")
					.append(CsvFileWriter.NEW_LINE);
			fwriter.write(header.toString());
			// Ajout des lignes dans le csv
			for (final UniteStructurelle us : list) {
				final StringBuilder csv = new StringBuilder();
				csv.append(CsvFileWriter.QUOTE).append(us.getUsIdentifiant()).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsLibelleLong())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsLibelleCourt())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsDateCreation())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsDateFermeture())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsNature())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsTypeUs())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsCodeMinistere())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsNumeroVoie())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsVoieBisTer())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsLibelleVoie())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsComplementAgent())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsCodePostal())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsCodeInsee())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsCommune())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsDepartement())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsPays())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsBureauDistributeur())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsNiveau())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsMere())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsTypeArborescence())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsDateDebutRattachement())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsDateFinRattachement())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsTypeOrganisation())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsUniteOrganisationnelle())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsLibelleCourtUo())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsStructureUo())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsDateEffet())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsDateFin())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsNomResponsableUo())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsNiveauDirection())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsNiveauService())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getUsNiveauUniteStructurelle()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(us.getNudoss())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(String.valueOf(us.isUsActif())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(String.valueOf(us.getUsNombreAgent())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(String.valueOf(us.getUsNombreAgentH())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(String.valueOf(us.getUsNombreAgentF())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(String.valueOf(us.isUsAvecAgent())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.NEW_LINE);
				fwriter.append(csv);
			}
		} catch (final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}
		return f;
	}

	public static File writeAgentCsvFile(String applicationName, List<Agent> list) {

		final File f = CsvFileWriter.createFile(applicationName, CsvFileWriter.FILE_AGENT);
		try {
			if (!f.createNewFile()) {
				throw new IOException();
			}
		} catch (final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}
		try (final FileWriter fwriter = new FileWriter(f)) {
			// Ligne Header
			final String[] colNames = {
					AgentEnum.AGENT_MATRICULE_RENOIRH.toString().toLowerCase(),
					AgentEnum.AGENT_MATRICULE_REHUCIT.toString().toLowerCase(),
					AgentEnum.AGENT_CIVILITE.toString().toLowerCase(),
					AgentEnum.AGENT_NOM_USUEL.toString().toLowerCase(),
					AgentEnum.AGENT_PRENOM.toString().toLowerCase(),
					AgentEnum.AGENT_NOM_PATRONYMIQUE.toString().toLowerCase(),
					AgentEnum.AGENT_SEXE.toString().toLowerCase(),
					AgentEnum.AGENT_AUTRES_PRENOMS.toString().toLowerCase(),
					AgentEnum.AGENT_PAYS_DE_NATIONALITE.toString().toLowerCase(),
					AgentEnum.AGENT_DATE_DE_NAISSANCE.toString().toLowerCase(),
					AgentEnum.AGENT_LIEU_DE_NAISSANCE.toString().toLowerCase(),
					AgentEnum.AGENT_DEPARTEMENT_DE_NAISSANCE.toString().toLowerCase(),
					AgentEnum.AGENT_PAYS_DE_NAISSANCE.toString().toLowerCase(),
					AgentEnum.AGENT_DATE_DE_DECES.toString().toLowerCase(),
					AgentEnum.AGENT_LIEU_DE_DECES.toString().toLowerCase(),
					AgentEnum.AGENT_ADRESSE.toString().toLowerCase(),
					AgentEnum.AGENT_ADRESSE_COMPLEMENT.toString().toLowerCase(),
					AgentEnum.AGENT_ADRESSE_CODE_POSTAL.toString().toLowerCase(),
					AgentEnum.AGENT_ADRESSE_DEPARTEMENT_CODE.toString().toLowerCase(),
					AgentEnum.AGENT_ADRESSE_DEPARTEMENT_FR_METROP_LIBELLE.toString().toLowerCase(),
					AgentEnum.AGENT_ADRESSE_DEPARTEMENT_OUTRE_MER_LIBELLE.toString().toLowerCase(),
					AgentEnum.AGENT_ADRESSE_CODE_INSEE.toString().toLowerCase(),
					AgentEnum.AGENT_ADRESSE_LIEU_DIT.toString().toLowerCase(),
					AgentEnum.AGENT_ADRESSE_LIBELLE_ACHEMINEMENT.toString().toLowerCase(),
					AgentEnum.AGENT_MAIL_PROFESSIONNEL.toString().toLowerCase(),
					AgentEnum.AGENT_POSITION_ADMINISTRATIVE.toString().toLowerCase(),
					AgentEnum.AGENT_POSITION_ADMINISTRATIVE_DATE_EFFET.toString().toLowerCase(),
					AgentEnum.AGENT_CATEGORIE_ADMINISTRATIVE.toString().toLowerCase(),
					AgentEnum.AGENT_SITUATION_FAMILIALE.toString().toLowerCase(),
					AgentEnum.AGENT_LOT_GESTION.toString().toLowerCase(),
					AgentEnum.AGENT_NOM_REGLEMENTATION.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_ORIGINE_CORPS.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_ORIGINE_CORPS_LIBELLE.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_ORIGINE_CORPS_DATE_ENTREE.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_ORIGINE_GRADE.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_ORIGINE_GRADE_LIBELLE.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_ORIGINE_GRADE_DATE_ENTREE.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_ORIGINE_ECHELON.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_EMPLOI_FONCTIONNEL_CORPS.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_EMPLOI_FONCTIONNEL_CORPS_LIBELLE.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_EMPLOI_FONCTIONNEL_CORPS_DATE_ENTREE.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_EMPLOI_FONCTIONNEL_GRADE.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_EMPLOI_FONCTIONNEL_GRADE_LIBELLE.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_EMPLOI_FONCTIONNEL_GRADE_DATE_ENTREE.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_EMPLOI_FONCTIONNEL_ECHELON.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_EMPLOI_FONCTIONNEL_ECHELON_DATE_EFFET.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_ACCUEIL_CORPS.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_ACCUEIL_CORPS_LIBELLE.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_ACCUEIL_CORPS_DATE_ENTREE.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_ACCUEIL_GRADE.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_ACCUEIL_GRADE_LIBELLE.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_ACCUEIL_GRADE_DATE_ENTREE.toString().toLowerCase(),
					AgentEnum.AGENT_CARRIERE_ACCUEIL_ECHELON.toString().toLowerCase(),
					AgentEnum.AGENT_CODE_POSTE.toString().toLowerCase(),
					AgentEnum.AGENT_POSTE_LIBELLE.toString().toLowerCase(),
					AgentEnum.AGENT_AFFECTATION_ADMINISTRATIVE_CODE.toString().toLowerCase(),
					AgentEnum.AGENT_AFFECTATION_ADMINISTRATIVE_LIBELLE_LONG.toString().toLowerCase(),
					AgentEnum.AGENT_AFFECTATION_ADMINISTRATIVE_LIBELLE_COURT.toString().toLowerCase(),
					AgentEnum.AGENT_AFFECTATION_ADMINISTRATIVE_DATE_INSTALLATION.toString().toLowerCase(),
					AgentEnum.AGENT_AFFECTATION_ADMINISTRATIVE_DATE_FIN_REELLE.toString().toLowerCase(),
					AgentEnum.AGENT_AFFECTATION_OPERATIONNELLE_CODE.toString().toLowerCase(),
					AgentEnum.AGENT_AFFECTATION_OPERATIONNELLE_LIBELLE_LONG.toString().toLowerCase(),
					AgentEnum.AGENT_AFFECTATION_OPERATIONNELLE_LIBELLE_COURT.toString().toLowerCase(),
					AgentEnum.AGENT_AFFECTATION_OPERATIONNELLE_DATE_DEBUT.toString().toLowerCase(),
					AgentEnum.AGENT_AFFECTATION_OPERATIONNELLE_DATE_FIN.toString().toLowerCase(),
					AgentEnum.AGENT_STATUT.toString().toLowerCase(),
					AgentEnum.AGENT_STATUT_LIBELLE.toString().toLowerCase(),
					AgentEnum.AGENT_STATUT_DATE_EFFET.toString().toLowerCase(),
					AgentEnum.AGENT_MODALITE_SERVICE.toString().toLowerCase(),
					AgentEnum.AGENT_MOTIF_CESSATION_FONCTION.toString().toLowerCase(),
					AgentEnum.AGENT_DATE_SORTIE_ADMINISTRATIVE.toString().toLowerCase(),
					AgentEnum.AGENT_MATRICULE_RENOIRH_RESPONSABLE.toString().toLowerCase(),
					AgentEnum.AGENT_TEMOIN_VALIDITE.toString().toLowerCase(),
					AgentEnum.AGENT_DATE_ENTREE_MINISTERE.toString().toLowerCase(),
					AgentEnum.AGENT_CONTRACTUEL_TYPE_CONTRAT.toString().toLowerCase(),
					AgentEnum.AGENT_CONTRACTUEL_NATURE_CONTRAT.toString().toLowerCase(),
					AgentEnum.AGENT_CONTRACTUEL_DATE_DEBUT.toString().toLowerCase(),
					AgentEnum.AGENT_AXE_PARTENAIRE.toString().toLowerCase(),
					AgentEnum.AGENT_AXE_PESE.toString().toLowerCase(),
					AgentEnum.AGENT_AXE_CODE_CORRESP.toString().toLowerCase() };
			final String line = String.join(CsvFileWriter.SEPARATOR, colNames);
			final StringBuilder header = new StringBuilder(line).append(CsvFileWriter.NEW_LINE);
			fwriter.write(header.toString());
			// Ajout des lignes dans le csv
			for (final Agent agent : list) {
				final StringBuilder csv = new StringBuilder();
				csv.append(CsvFileWriter.QUOTE).append(agent.getAgtMatriculeRenoirh()).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtMatriculeRehucit())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCivilite())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtNomUsuel())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtPrenom())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtNomPatronymique())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtSexe())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtAutresPrenoms())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtPaysNationalite())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtDateNaissance())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtLieuNaissance())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtDepartementNaissance()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtPaysNaissance())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtDateDeces())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtLieuDeces())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtAdresse())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtAdresseComplement())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtAdresseCodePostal())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtAdresseDepartementCode()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtAdresseDepartementFrMetropLibelle()))
						.append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtAdresseDepartementOutreMerLibelle()))
						.append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtAdresseCodeInsee())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtAdresseLieuDit())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtAdresseLibelleAcheminement()))
						.append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtMailProfessionnel())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtPositionAdministrative()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR)
						.append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtPositionAdministrativeDateEffet()))
						.append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCategorieAdministrative()))
						.append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtSituationFamiliale())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtLotGestion()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtNomReglementation()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR)
						.append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtTemoinValidite()))
						.append(CsvFileWriter.checkString(agent.getAgtCarriereOrigineCorps()))
						.append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCarriereOrigineCorpsLibelle()))
						.append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCarriereOrigineCorpsDateEntree()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCarriereOrigineGrade()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCarriereOrigineGradeLibelle()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCarriereOrigineGradeDateEntree()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCarriereOrigineEchelon()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCarriereEmploiFonctionnelCorps()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCarriereEmploiFonctionnelCorpsLibelle()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCarriereEmploiFonctionnelCorpsDateEntree()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCarriereEmploiFonctionnelGrade()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCarriereEmploiFonctionnelGradeLibelle()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCarriereEmploiFonctionnelGradeDateEntree()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCarriereEmploiFonctionnelEchelon()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCarriereEmploiFonctionnelEchelonDateEffet()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCarriereAccueilCorps()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCarriereAccueilCorpsLibelle()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCarriereAccueilCorpsDateEntree()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCarriereAccueilGrade()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCarriereAccueilGradeLibelle()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCarriereAccueilGradeDateEntree()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCarriereAccueilEchelon()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtPoste()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtPosteLibelle()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtAffectationAdministrative()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtAffectationAdministrativeLibelleLong()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtAffectationAdministrativeLibelleCourt()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtAffectationAdministrativeDateInstallation()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtAffectationAdministrativeDateFinReelle()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtAffectationOperationnelle()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtAffectationOperationnelleLibelleLong()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtAffectationOperationnelleLibelleCourt()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtAffectationOperationnelleDateDebut()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtAffectationOperationnelleDateFin()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtStatut()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtStatutLibelle()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtStatutDateEffet()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtModaliteService()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtMotifCessationFonction()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtDateSortieAdministrative()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtMatriculeRenoirhResponsable()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtTemoinValidite()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtDateEntreeMinistere()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtContractuelTypeContrat()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtContractuelNatureContrat()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR)
						.append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtContractuelDateDebut()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR)
						.append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtPartenaire()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR)
						.append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtPese()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR)
						.append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(agent.getAgtCodeCorrespondadnt()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.NEW_LINE);
				fwriter.append(csv);
			}
		} catch (

		final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}
		return f;
	}

	public static File writeRemunerationCsvFile(String applicationName, List<Remuneration> list) {

		final File f = CsvFileWriter.createFile(applicationName, CsvFileWriter.FILE_REMUNERATION);
		try {
			if (!f.createNewFile()) {
				throw new IOException();
			}
		} catch (final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}
		try (FileWriter fwriter = new FileWriter(f)) {
			// Ligne Header
			final StringBuilder header = new StringBuilder();
			header.append(RemunerationEnum.REMUNERATION_MATRICULE_AGENT_RENOIRH).append(CsvFileWriter.SEPARATOR)
					//.append(RemunerationEnum.REMUNERATION_DATE_DEBUT_SAISIE_MOIS_PAYE)
					//.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_DATE_FIN_SAISIE_MOIS_PAYE)
					//.append(CsvFileWriter.SEPARATOR)
					//.append(RemunerationEnum.REMUNERATION_DATE_EXTREME_MISE_EN_PAYE_DGFIP)
					//.append(CsvFileWriter.SEPARATOR)
					.append(RemunerationEnum.REMUNERATION_CODE_TRESORERIE_GENERALE)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_NUMERO_DE_DOSSIER)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_DOSSIER_DE_PAIE_PRINCIPAL)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_DATE_DEBUT_AFFECTATION_TG)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_DATE_FIN_DOSSIER_PRINCIPAL)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_IDENTIFIANT_INTERNE)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_NOM_REGLEMENTATION)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_MATRICULE)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_DATE_EFFET_PRISE_EN_CHARGE)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_DATE_FIN_ZONE_COMMUNE)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_CODE_TG)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_NUMERO_DOSSIER)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_CODE_ADMINISTRATION)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_CODE_CORRESPONDANT)
					.append(CsvFileWriter.SEPARATOR)
					.append(RemunerationEnum.REMUNERATION_DEPARTEMENT_SERVICE_GESTIONNAIRE)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_CODE_REGIME)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_CODE_TG_SPECIFIQUE)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_DOSSIER_SPECIFIQUE)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_DATE_EFFET_REGIME)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_DATE_FIN_REGIME)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_ANNEE_MISE_EN_PAYE)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_MOIS_MISE_EN_PAYE)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_TEMOIN_VALIDATION_PAYE)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_TEMOIN_ANNULATION_PAYE)
					.append(CsvFileWriter.SEPARATOR).append(RemunerationEnum.REMUNERATION_DATE_EFFET_PECUNIERE)
					.append(CsvFileWriter.NEW_LINE);
			fwriter.write(header.toString());
			// Ajout des lignes dans le csv
			for (final Remuneration rem : list) {
				final StringBuilder csv = new StringBuilder();
				csv.append(CsvFileWriter.QUOTE).append(rem.getRemMatcleRen()).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						//.append(CsvFileWriter.checkString(rem.getRemDebPaye())).append(CsvFileWriter.QUOTE)
						//.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						//.append(CsvFileWriter.checkString(rem.getRemFinPaye())).append(CsvFileWriter.QUOTE)
						//.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						//.append(CsvFileWriter.checkString(rem.getRemDatExtPaye())).append(CsvFileWriter.QUOTE)
						//.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemCodeTG())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemNumDos())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemDosPaie())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemDebAffect())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemFinDos())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemIdInterne())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemNomRegle())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemMatcle())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemEffetCharge())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemFinZone())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemCodeTGPreliq())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemNumDosPreliq())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemAdmin())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemCorres())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemDepSer())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemRegime())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemTGSpec())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemDosSpec())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemEffetReg())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemFinReg())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemAnnPaie())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemMoisPaie())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemValid())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemAnnul())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(rem.getRemEffetPec())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.NEW_LINE);
				fwriter.append(csv);
			}
		} catch (final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}
		return f;
	}

	public static File writeAbsenceCsvFile(String applicationName, List<Absence> list) {

		final File f = CsvFileWriter.createFile(applicationName, CsvFileWriter.FILE_ABSENCE);
		try {
			if (!f.createNewFile()) {
				throw new IOException();
			}
		} catch (final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}
		try (FileWriter fwriter = new FileWriter(f)) {
			// Ligne Header
			final StringBuilder header = new StringBuilder();
			header.append(AbsenceEnum.ABSENCE_CONGES_MATRICULE_RENOIRH)
					.append(CsvFileWriter.SEPARATOR).append(AbsenceEnum.ABSENCE_CONGES_MOTIF)
					.append(CsvFileWriter.SEPARATOR).append(AbsenceEnum.ABSENCE_CONGES_DATE_DEBUT_IMPACT_REMUNERATION)
					.append(CsvFileWriter.SEPARATOR).append(AbsenceEnum.ABSENCE_CONGES_TEMOIN_DEBUT_IMPACT_REMUNERATION)
					.append(CsvFileWriter.SEPARATOR).append(AbsenceEnum.ABSENCE_CONGES_DATE_FIN_TRANCHE)
					.append(CsvFileWriter.SEPARATOR).append(AbsenceEnum.ABSENCE_CONGES_TEMOIN_ABSENCE)
					.append(CsvFileWriter.SEPARATOR).append(AbsenceEnum.ABSENCE_CONGES_NOMBRE_JOURS)
					.append(CsvFileWriter.SEPARATOR).append(AbsenceEnum.ABSENCE_CONGES_NUMERO_DROIT)
					.append(CsvFileWriter.SEPARATOR).append(AbsenceEnum.ABSENCE_CONGES_NUMERO_DE_TRANCHE)
					.append(CsvFileWriter.SEPARATOR).append(AbsenceEnum.ABSENCE_CONGES_TEMOIN_DE_VALIDITE)
					.append(CsvFileWriter.NEW_LINE);
			fwriter.write(header.toString());
			// Ajout des lignes dans le csv
			for (final Absence abs : list) {
				final StringBuilder csv = new StringBuilder();
				csv.append(CsvFileWriter.QUOTE).append(abs.getAbsMatcle()).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(abs.getAbsMotif())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(abs.getAbsDebImpact())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(abs.getAbsTemDeb())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(abs.getAbsFinTranche())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(abs.getAbsTemFin())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(abs.getAbsNbrJour())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(abs.getAbsNumDroit())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(abs.getAbsNumTranche())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(abs.getAbsTemoin())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.NEW_LINE);
				fwriter.append(csv);
			}
		} catch (final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}
		return f;
	}

	protected static String checkString(String string) {
		if (string == null) {
			return "";
		} else {
			return string;
		}
	}

	public static File writeAffectationCsvFile(String applicationName, List<Affectation> list) {

		final File f = CsvFileWriter.createFile(applicationName, CsvFileWriter.FILE_AFFECTATION);
		try {
			if (!f.createNewFile()) {
				throw new IOException();
			}
		} catch (final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}
		try (FileWriter fwriter = new FileWriter(f)) {
			// Ligne Header
			final String[] colNames = {
					AffectationEnum.AFFECTATION_MATRICULE.toString().toLowerCase(),
					AffectationEnum.AFFECTATION_NOM.toString().toLowerCase(),
					AffectationEnum.AFFECTATION_PRENOM.toString().toLowerCase(),
					AffectationEnum.AFFECTATION_DATE_EFFET_ORGANISATIONNELLE.toString().toLowerCase(),
					AffectationEnum.AFFECTATION_DATE_FIN_ORGANISATIONNELLE.toString().toLowerCase(),
					AffectationEnum.AFFECTATION_UNITE_ORGANISATIONNELLE.toString().toLowerCase(),
					AffectationEnum.AFFECTATION_TEMOIN_VALIDITE.toString().toLowerCase() };
			final String line = String.join(CsvFileWriter.SEPARATOR, colNames);
			final StringBuilder header = new StringBuilder(line).append(CsvFileWriter.NEW_LINE);
			fwriter.write(header.toString());
			// Ajout des lignes dans le csv
			for (final Affectation aff : list) {
				final StringBuilder csv = new StringBuilder();
				csv.append(CsvFileWriter.QUOTE).append(aff.getMatcle()).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(aff.getNom())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(aff.getPrenom())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(aff.getDateEffet())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(aff.getDateFin())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(aff.getUnite())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(aff.getTemoinValidite())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.NEW_LINE);
				fwriter.append(csv);
			}
		} catch (final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}
		return f;
	}

	public static File writeQuotiteCsvFile(String applicationName, List<Quotite> list) {

		final File f = CsvFileWriter.createFile(applicationName, CsvFileWriter.FILE_QUOTITE);
		try {
			if (!f.createNewFile()) {
				throw new IOException();
			}
		} catch (final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}
		try (FileWriter fwriter = new FileWriter(f)) {
			// Ligne Header
			final StringBuilder header = new StringBuilder();
			header.append("quotite_matricule").append(CsvFileWriter.SEPARATOR).append("quotite_nom")
					.append(CsvFileWriter.SEPARATOR).append("quotite_prenom")
					.append(CsvFileWriter.SEPARATOR).append("quotite_travail").append(CsvFileWriter.SEPARATOR)
					.append("quotite_modalite_service").append(CsvFileWriter.SEPARATOR)
					.append("quotite_service").append(CsvFileWriter.SEPARATOR)
					.append("quotite_pourc_H_de_presence_sur_temps_plein").append(CsvFileWriter.SEPARATOR)
					.append("quotite_numerateur_fraction_remuneration")
					.append(CsvFileWriter.SEPARATOR).append("quotite_denominateur_fraction_remuneration")
					.append(CsvFileWriter.SEPARATOR).append("quotite_effet_travail").append(CsvFileWriter.SEPARATOR)
					.append("quotite_fin_travail").append(CsvFileWriter.SEPARATOR)
					.append("quotite_temoin_surcotisation").append(CsvFileWriter.SEPARATOR)
					.append("quotite_temoin_validite").append(CsvFileWriter.NEW_LINE);
			fwriter.write(header.toString());
			// Ajout des lignes dans le csv
			for (final Quotite q : list) {
				final StringBuilder csv = new StringBuilder();
				csv.append(CsvFileWriter.QUOTE).append(q.getQuotiteMatricule()).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(q.getQuotiteNom())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(q.getQuotitePrenom())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(q.getQuotiteTravail())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(q.getQuotiteModaliteService())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(q.getQuotiteService())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(q.getQuotitePourcHeurePresenceTempsPlein()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(q.getQuotiteNumerateurRemuneration()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(q.getQuotiteDenominateurRemuneration()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(q.getQuotiteDateEffetQuotiteTravail()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(q.getQuotiteDateFinQuotiteTravail()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(q.getQuotiteTemoinSurcotisation()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(q.getQuotiteTemoinValidite())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.NEW_LINE);
				fwriter.append(csv);
			}
		} catch (final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}
		return f;
	}

	public static File writeCarriereCsvFile(String applicationName, List<Carriere> list) {

		final File f = CsvFileWriter.createFile(applicationName, CsvFileWriter.FILE_CARRIERE);
		try {
			if (!f.createNewFile()) {
				throw new IOException();
			}
		} catch (final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}
		try (FileWriter fwriter = new FileWriter(f)) {
			// Ligne Header
			final StringBuilder header = new StringBuilder();
			header.append("carriere_matricule").append(CsvFileWriter.SEPARATOR).append("carriere_nom")
					.append(CsvFileWriter.SEPARATOR).append("carriere_prenom")
					.append(CsvFileWriter.SEPARATOR).append("carriere_date_de_naissance")
					.append(CsvFileWriter.SEPARATOR).append("carriere_date_debut").append(CsvFileWriter.SEPARATOR)
					.append("carriere_date_fin").append(CsvFileWriter.SEPARATOR)
					.append("carriere_grade_statutaire_date_effet_classement").append(CsvFileWriter.SEPARATOR)
					.append("carriere_identifiant_preliquidation_echelon")
					.append(CsvFileWriter.SEPARATOR).append("carriere_temoin_validite").append(CsvFileWriter.SEPARATOR)
					.append("carriere_statut_agent")
					.append(CsvFileWriter.SEPARATOR)
					.append("carriere_specialite")
					.append(CsvFileWriter.NEW_LINE);
			fwriter.write(header.toString());
			// Ajout des lignes dans le csv
			for (final Carriere c : list) {
				final StringBuilder csv = new StringBuilder();
				csv.append(CsvFileWriter.QUOTE).append(c.getCarriereMatricule()).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR)
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.checkString(c.getCarriereNom()))
						.append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(c.getCarrierePrenom())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(c.getCarriereDateNaissance())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(c.getCarriereDateDebut())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(c.getCarriereDateFin())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(c.getCarriereGradeStatutaireDateEffetClassement()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(c.getCarriereIdentifiantPreliquidationEchelon()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(c.getCarriereTemoinValiditeInformation()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(c.getCarriereStatutAgent())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(c.getCarriereCodeSpecialite())).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.NEW_LINE);
				fwriter.append(csv);
			}
		} catch (final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}
		return f;
	}

	public static File writeCorpsCsvFile(String applicationName, List<Corps> list) {

		final File f = CsvFileWriter.createFile(applicationName, CsvFileWriter.FILE_CORPS);
		try {
			if (!f.createNewFile()) {
				throw new IOException();
			}
		} catch (final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}
		try (FileWriter fwriter = new FileWriter(f)) {
			// Ligne Header
			final StringBuilder header = new StringBuilder();
			header.append(CsvFileWriter.SEPARATOR).append("reglementaire_code_corps")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_corps_libelle_long")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_corps_libelle_agrege")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_corps_libelle_complementaire")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_corps_date_debut_validite")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_corps_date_fin_validite")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_corps_ouvert")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_corps_avec_agents")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_corps_nb_agents")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_corps_nb_agents_masculins")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_corps_nb_agents_feminins")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_corps_accueil_nb_agents")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_corps_accueil_nb_agents_masculins")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_corps_accueil_nb_agents_feminins")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_corps_origine_nb_agents")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_corps_origine_nb_agents_masculins")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_corps_origine_nb_agents_feminins")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_corps_emplois_fonctionnels_nb_agents")
					.append(CsvFileWriter.SEPARATOR)
					.append("reglementaire_corps_emplois_fonctionnels_nb_agents_masculins")
					.append(CsvFileWriter.SEPARATOR)
					.append("reglementaire_corps_emplois_fonctionnels_nb_agents_feminins")
					.append(CsvFileWriter.NEW_LINE);
			fwriter.write(header.toString());
			// Ajout des lignes dans le csv
			for (final Corps corps : list) {
				final StringBuilder csv = new StringBuilder();
				csv.append(CsvFileWriter.QUOTE).append(corps.getReglementaireCodeCorps())
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(corps.getReglementaireCorpsLibelleLong()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(corps.getReglementaireCorpsLibelleAgrege()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(corps.getReglementaireCorpsLibelleComplementaire()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(corps.getReglementaireCorpsDateDebutValidite()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(corps.getReglementaireCorpsDateFinValidite()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(String.valueOf(corps.getReglementaireCorpsOuvert())))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(String.valueOf(corps.getReglementaireCorpsAvecAgents())))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(corps.getReglementaireCorpsNbAgents()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(corps.getReglementaireCorpsNbAgentsMasculins()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(corps.getReglementaireCorpsNbAgentsFeminins()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(corps.getReglementaireCorpsAccueilNbAgents()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(corps.getReglementaireCorpsAccueilNbAgentsMasculins()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(corps.getReglementaireCorpsAccueilNbAgentsFeminins()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(corps.getReglementaireCorpsOrigineNbAgents()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(corps.getReglementaireCorpsOrigineNbAgentsMasculins()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(corps.getReglementaireCorpsOrigineNbAgentsFeminins()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(corps.getReglementaireCorpsEmploisFonctionnelsNbAgents()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter
								.checkString(corps.getReglementaireCorpsEmploisFonctionnelsNbAgentsMasculins()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter
								.checkString(corps.getReglementaireCorpsEmploisFonctionnelsNbAgentsFeminins()))
						.append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.NEW_LINE);
				fwriter.append(csv);
			}
		} catch (final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}
		return f;
	}

	public static File writeGradeCsvFile(String applicationName, List<Grade> list) {

		final File f = CsvFileWriter.createFile(applicationName, CsvFileWriter.FILE_GRADE);
		try {
			if (!f.createNewFile()) {
				throw new IOException();
			}
		} catch (final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}
		try (FileWriter fwriter = new FileWriter(f)) {
			// Ligne Header
			final StringBuilder header = new StringBuilder();
			header.append(CsvFileWriter.SEPARATOR).append("reglementaire_code_grade")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_grade_libelle_long")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_grade_libelle_agrege")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_grade_libelle_complementaire")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_grade_date_debut_validite")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_grade_date_fin_validite")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_grade_ouvert")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_grade_avec_agents")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_grade_nb_agents")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_grade_nb_agents_masculins")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_grade_nb_agents_feminins")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_grade_accueil_nb_agents")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_grade_accueil_nb_agents_masculins")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_grade_accueil_nb_agents_feminins")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_grade_origine_nb_agents")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_grade_origine_nb_agents_masculins")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_grade_origine_nb_agents_feminins")
					.append(CsvFileWriter.SEPARATOR).append("reglementaire_grade_emplois_fonctionnels_nb_agents")
					.append(CsvFileWriter.SEPARATOR)
					.append("reglementaire_grade_emplois_fonctionnels_nb_agents_masculins")
					.append(CsvFileWriter.SEPARATOR)
					.append("reglementaire_grade_emplois_fonctionnels_nb_agents_feminins")
					.append(CsvFileWriter.NEW_LINE);
			fwriter.write(header.toString());
			// Ajout des lignes dans le csv
			for (final Grade grade : list) {
				final StringBuilder csv = new StringBuilder();
				csv.append(CsvFileWriter.QUOTE).append(grade.getReglementaireCodeGrade())
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(grade.getReglementaireGradeLibelleLong()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(grade.getReglementaireGradeLibelleAgrege()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(grade.getReglementaireGradeLibelleComplementaire()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(grade.getReglementaireGradeDateDebutValidite()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(grade.getReglementaireGradeDateFinValidite()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(String.valueOf(grade.getReglementaireGradeOuvert())))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(String.valueOf(grade.getReglementaireGradeAvecAgents())))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(grade.getReglementaireGradeNbAgents()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(grade.getReglementaireGradeNbAgentsMasculins()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(grade.getReglementaireGradeNbAgentsFeminins()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(grade.getReglementaireGradeAccueilNbAgents()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(grade.getReglementaireGradeAccueilNbAgentsMasculins()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(grade.getReglementaireGradeAccueilNbAgentsFeminins()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(grade.getReglementaireGradeOrigineNbAgents()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(grade.getReglementaireGradeOrigineNbAgentsMasculins()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(grade.getReglementaireGradeOrigineNbAgentsFeminins()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(grade.getReglementaireGradeEmploisFonctionnelsNbAgents()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter
								.checkString(grade.getReglementaireGradeEmploisFonctionnelsNbAgentsMasculins()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter
								.checkString(grade.getReglementaireGradeEmploisFonctionnelsNbAgentsFeminins()))
						.append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.NEW_LINE);
				fwriter.append(csv);
			}
		} catch (final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}

		return f;
	}

	public static File writePseudoGradeCsvFile(String applicationName, List<Contractuel> list) {

		final File f = CsvFileWriter.createFile(applicationName, CsvFileWriter.FILE_PSEUDO_GRADE);
		try {
			if (!f.createNewFile()) {
				throw new IOException();
			}
		} catch (final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}
		try (FileWriter fwriter = new FileWriter(f)) {
			// Ligne Header
			final String line = String.join(CsvFileWriter.SEPARATOR, new String[] { "reglementaire_code_pseudo_grade",
					"reglementaire_pseudo_grade_libelle_long",
					"reglementaire_pseudo_grade_libelle_agrege",
					"reglementaire_pseudo_grade_libelle_complementaire",
					"reglementaire_pseudo_grade_date_debut_validite",
					"reglementaire_pseudo_grade_date_fin_validite",
					"reglementaire_pseudo_grade_ouvert",
					"reglementaire_pseudo_grade_avec_agents",
					"reglementaire_pseudo_grade_nb_agents",
					"reglementaire_pseudo_grade_nb_agents_masculins",
					"reglementaire_pseudo_grade_nb_agents_feminins" });

			final StringBuilder header = new StringBuilder(line).append(CsvFileWriter.NEW_LINE);
			fwriter.write(header.toString());
			// Ajout des lignes dans le csv
			for (final Contractuel contractuel : list) {
				final StringBuilder csv = new StringBuilder();
				csv.append(CsvFileWriter.QUOTE).append(contractuel.getReglementaireCodePseudoGrade())
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(contractuel.getReglementairePseudoGradeLibelle()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(contractuel.getReglementaireCodePseudoGradeLibelleAgrege()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter
								.checkString(contractuel.getReglementaireCodePseudoGradeLibelleComplementaire()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(contractuel.getReglementairePseudoGradeDateDebutValidite()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(contractuel.getReglementairePseudoGradeDateFinValidite()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter
								.checkString(String.valueOf(contractuel.getReglementairePseudoGradeOuvert())))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter
								.checkString(String.valueOf(contractuel.getReglementairePseudoGradeAvecAgents())))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(contractuel.getReglementairePseudoGradeNbAgents()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(contractuel.getReglementairePseudoGradeNbAgentsMasculins()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(contractuel.getReglementairePseudoGradeNbAgentsFeminins()))
						.append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.NEW_LINE);
				fwriter.append(csv);
			}
		} catch (final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}

		return f;
	}

	public static File writeHabilitationCsvFile(String applicationName, List<Habilitation> list) {

		final File f = CsvFileWriter.createFile(applicationName, CsvFileWriter.FILE_HABILITATION);
		try {
			if (!f.createNewFile()) {
				throw new IOException();
			}
		} catch (final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}
		try (final FileWriter fwriter = new FileWriter(f)) {
			// Ligne Header
			final String line = String.join(CsvFileWriter.SEPARATOR, new String[] { "adresse_mail",

					"nom_utilisateur", "prenom_utilisateur", "matricule_renoirh", "agent_affectation_administrative",
					"agent_affectation_administrative_libelle_long", "agent_affectation_administrative_libelle_court",
					"agent_affectation_operationnelle", "agent_affectation_operationnelle_libelle_long",
					"agent_operationnelle_administrative_libelle_court",
					"modele_de_role", "intitule_mode_role", "hab_axe_us_oper", "hab_axe_pese", "hab_axe_us_adm",
					"hab_axe_part", "hab_axe_corp", "hab_axe_grp_uo_poste", "hab_axe_ldg", "hab_axe_corresp"
			});

			final StringBuilder header = new StringBuilder(line).append(CsvFileWriter.NEW_LINE);
			fwriter.write(header.toString());
			// Ajout des lignes dans le csv
			for (final Habilitation habilitation : list) {
				final StringBuilder csvh = new StringBuilder();
				csvh.append(CsvFileWriter.QUOTE).append(habilitation.getAdresseMail())
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(habilitation.getNomUtilisateur()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(habilitation.getPrenomUtilisateur()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(habilitation.getMatriculeRenoirh()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(habilitation.getAgentAffectationAdministrative()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(habilitation.getAgentAffectationAdministrativeLibelleLong()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(habilitation.getAgentAffectationAdministrativeLibelleCourt()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(habilitation.getAgentAffectationOperationnelle()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(habilitation.getAgentAffectationOperationnelleLibelleLong()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.checkString(habilitation.getAgentAffectationOperationnelleLibelleCourt()))
						.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
						.append(CsvFileWriter.QUOTE);
				for (final Profil profil : habilitation.getHabProfil()) {
					final StringBuilder csv = new StringBuilder(csvh);
					csv.append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE).append(profil.getModeleRole())
							.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
							.append(CsvFileWriter.checkString(profil.getModeleRole()))
							.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
							.append(CsvFileWriter.checkString(profil.getIntituleModeleRole()))
							.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
							.append(CsvFileWriter.checkString(profil.getIntituleModeleRole()))
							.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
							.append(CsvFileWriter.checkString(Arrays.toString(profil.getHabAxeUsOper())))
							.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
							.append(CsvFileWriter.checkString(Arrays.toString(profil.getHabAxePese())))
							.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
							.append(CsvFileWriter.checkString(Arrays.toString(profil.getHabAxeUsAdm())))
							.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
							.append(CsvFileWriter.checkString(Arrays.toString(profil.getHabAxePart())))
							.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
							.append(CsvFileWriter.checkString(Arrays.toString(profil.getHabAxeCorp())))
							.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
							.append(CsvFileWriter.checkString(Arrays.toString(profil.getHabAxeGrpUoPoste())))
							.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
							.append(CsvFileWriter.checkString(Arrays.toString(profil.getHabAxeLdg())))
							.append(CsvFileWriter.QUOTE).append(CsvFileWriter.SEPARATOR).append(CsvFileWriter.QUOTE)
							.append(CsvFileWriter.checkString(Arrays.toString(profil.getHabAxeCorresp())))
							.append(CsvFileWriter.QUOTE).append(CsvFileWriter.NEW_LINE);
					fwriter.append(csv);
				}

			}
		} catch (final IOException e) {
			CsvFileWriter.LOG.error(CsvFileWriter.IOEXCEPTION, f.getPath(), e);
			SendMail.envoyerMailSMTP(CsvFileWriter.UTILS.getServerSmtp(), CsvFileWriter.UTILS.getMailSender(),
					CsvFileWriter.UTILS.getMailReceiver(), "",
					CsvFileWriter.UTILS.getSubject(), CsvFileWriter.UTILS.getLogFile());
			return null;
		}

		return f;
	}
}

```

</details>


---

### 📄 `src/main/java/ze/impl/ErrorResponse.java` [744 octets]
<a id="src-main-java-ze-impl-ErrorResponse-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-impl-ErrorResponse-java)

> **Chemin relatif** : `src/main/java/ze/impl/ErrorResponse.java`  
> **Taille** : 744 octets  
> **Lignes** : 48  
> **Type** : java

```java
package ze.impl;

import javax.ws.rs.core.Response;

public class ErrorResponse {

	private String code;

	private String message;

	private Response.Status status;

	public ErrorResponse() {
		this.code = "200";
		this.message = "";
		this.status = Response.Status.OK;
	}

	public ErrorResponse(String code, String message) {
		this.code = code;
		this.message = message;
	}

	public String getCode() {
		return code;
	}

	public void setCode(String code) {
		this.code = code;
	}

	public String getMessage() {
		return message;
	}

	public void setMessage(String message) {
		this.message = message;
	}

	public Response.Status getStatus() {
		return status;
	}

	public void setStatus(Response.Status status) {
		this.status = status;
	}
}

```


---

### 📄 `src/main/java/ze/impl/SendMail.java` [2.302 octets]
<a id="src-main-java-ze-impl-SendMail-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-impl-SendMail-java)

> **Chemin relatif** : `src/main/java/ze/impl/SendMail.java`  
> **Taille** : 2.302 octets  
> **Lignes** : 75  
> **Type** : java

```java
package ze.impl;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.time.LocalDate;
import java.util.Date;
import java.util.Properties;

import javax.activation.DataHandler;
import javax.activation.DataSource;
import javax.activation.FileDataSource;
import javax.mail.BodyPart;
import javax.mail.Message;
import javax.mail.Multipart;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeBodyPart;
import javax.mail.internet.MimeMessage;
import javax.mail.internet.MimeMultipart;

public class SendMail {

	private static final Logger LOG = LoggerFactory.getLogger(SendMail.class);

	private SendMail() {
		throw new IllegalStateException("Utility class");
	}

	public static boolean envoyerMailSMTP(String serveur, String sender, String receiver, String msg, String subject,
			String logfile) {

		boolean result = false;
		try {
			Properties prop = System.getProperties();
			prop.put("mail.smtp.host", serveur);
			Session session = Session.getDefaultInstance(prop, null);
			Message message = new MimeMessage(session);
			message.setFrom(new InternetAddress(sender));

			String[] receivers = receiver.split(",");
			InternetAddress[] internetAddresses = new InternetAddress[receivers.length];
			for (int i = 0; i < receivers.length; i++) {
				internetAddresses[i] = new InternetAddress(receivers[i]);
			}
			Multipart multipart = new MimeMultipart();

			// creation partie principale du message
			BodyPart messageBodyPart = new MimeBodyPart();
			messageBodyPart.setText(msg);
			multipart.addBodyPart(messageBodyPart);

			// creation et ajout de la piece jointe
			messageBodyPart = new MimeBodyPart();
			DataSource source = new FileDataSource(logfile);
			messageBodyPart.setDataHandler(new DataHandler(source));
			messageBodyPart.setFileName("logZE_" + LocalDate.now() + ".log");
			multipart.addBodyPart(messageBodyPart);

			// ajout des éléments au mail
			message.setRecipients(Message.RecipientType.TO, internetAddresses);
			message.setSubject(subject);
			message.setContent(multipart);
			message.setSentDate(new Date());

			Transport.send(message);
			result = true;
		} catch (Exception e) {
			LOG.error("Erreur lors de l'envoi du mail : \n", e);
		}
		return result;
	}
}

```


---

### 📄 `src/main/java/ze/impl/SoapMessage.java` [3.348 octets]
<a id="src-main-java-ze-impl-SoapMessage-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-impl-SoapMessage-java)

> **Chemin relatif** : `src/main/java/ze/impl/SoapMessage.java`  
> **Taille** : 3.348 octets  
> **Lignes** : 96  
> **Type** : java

```java
package ze.impl;

import java.net.URL;

import javax.net.ssl.HttpsURLConnection;
import javax.net.ssl.SSLContext;
import javax.net.ssl.TrustManager;
import javax.xml.soap.MessageFactory;
import javax.xml.soap.SOAPBody;
import javax.xml.soap.SOAPConnection;
import javax.xml.soap.SOAPConnectionFactory;
import javax.xml.soap.SOAPElement;
import javax.xml.soap.SOAPEnvelope;
import javax.xml.soap.SOAPException;
import javax.xml.soap.SOAPMessage;
import javax.xml.soap.SOAPPart;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class SoapMessage {

	private static final Logger LOG = LoggerFactory.getLogger(SoapMessage.class);

	private static final Utils UTILS = new Utils();

	public void createSoapEnvelope(SOAPMessage soapMessage, String type, String id) throws SOAPException {
		SOAPPart soapPart = soapMessage.getSOAPPart();

		String myNamespace = UTILS.getNamespace();
		String myNamespaceURI = UTILS.getUricerbere();

		// SOAP Envelope
		SOAPEnvelope envelope = soapPart.getEnvelope();
		envelope.addNamespaceDeclaration(myNamespace, myNamespaceURI);

		// SOAP Body
		SOAPBody soapBody = envelope.getBody();
		SOAPElement root = null;
		if ("identite".equals(type)) {
			root = soapBody.addChildElement("IdentiteDemande", myNamespace);
		} else if ("autorisation".equals(type)) {
			root = soapBody.addChildElement("AutorisationsDemande", myNamespace);
		} else {
			throw new IllegalStateException();
		}
		SOAPElement application = root.addChildElement("application", myNamespace);
		application.setAttribute("id", UTILS.getIdcerbere());
		application.setAttribute("cle", UTILS.getClecerbere());
		SOAPElement identifiant = root.addChildElement("identifiant", myNamespace);
		identifiant.addTextNode(id);
	}

	public static SOAPMessage callSoapWebService(String soapEndpointUrl, String type, String id) {
		try {
			SSLContext sslContext = SSLContext.getInstance("TLSv1.2");
			TrustManager[] trustAll = new TrustManager[] { new TrustAllCertificates() };
			sslContext.init(null, trustAll, new java.security.SecureRandom());
			// Set trust all certificates context to HttpsURLConnection
			HttpsURLConnection.setDefaultSSLSocketFactory(sslContext.getSocketFactory());
			// Open HTTPS connection
			URL url = new URL(soapEndpointUrl);
			HttpsURLConnection httpsConnection = (HttpsURLConnection) url.openConnection();
			// Trust all hosts
			httpsConnection.setHostnameVerifier(new TrustAllHosts());
			// Connect
			httpsConnection.connect();
			// Create SOAP Connection
			SOAPConnectionFactory soapConnectionFactory = SOAPConnectionFactory.newInstance();
			SOAPConnection soapConnection = soapConnectionFactory.createConnection();

			// Send SOAP Message to SOAP Server
			SOAPMessage soapResponse = soapConnection.call(createSOAPRequest(type, id), soapEndpointUrl);

			soapConnection.close();
			httpsConnection.disconnect();

			return soapResponse;
		} catch (Exception e) {
			LOG.error("Erreur lors de l'appel au web service cerbere : ", e);
			return null;
		}
	}

	private static SOAPMessage createSOAPRequest(String type, String id) throws SOAPException {
		MessageFactory messageFactory = MessageFactory.newInstance();
		SOAPMessage soapMessage = messageFactory.createMessage();

		new SoapMessage().createSoapEnvelope(soapMessage, type, id);

		soapMessage.saveChanges();

		return soapMessage;
	}
}

```


---

### 📄 `src/main/java/ze/impl/TrustAllCertificates.java` [1.266 octets]
<a id="src-main-java-ze-impl-TrustAllCertificates-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-impl-TrustAllCertificates-java)

> **Chemin relatif** : `src/main/java/ze/impl/TrustAllCertificates.java`  
> **Taille** : 1.266 octets  
> **Lignes** : 48  
> **Type** : java

```java
package ze.impl;

import java.security.cert.CertificateException;

import javax.net.ssl.HostnameVerifier;
import javax.net.ssl.SSLSession;
import javax.net.ssl.X509TrustManager;
import javax.security.cert.X509Certificate;

class TrustAllCertificates implements X509TrustManager {

	public void checkClientTrusted(X509Certificate[] certs, String authType) {
		// Nothing
	}

	public void checkServerTrusted(X509Certificate[] certs, String authType) {
		// Nothing
	}

	public X509Certificate[] getAcceptedIssuers1() {
		X509Certificate[] x = {};
		return x;
	}

	@Override
	public void checkClientTrusted(java.security.cert.X509Certificate[] arg0, String arg1) throws CertificateException {
		throw new CertificateException("Unsupported operation");
	}

	@Override
	public void checkServerTrusted(java.security.cert.X509Certificate[] arg0, String arg1) throws CertificateException {
		throw new CertificateException("Unsupported operation");
	}

	@Override
	public java.security.cert.X509Certificate[] getAcceptedIssuers() {
		java.security.cert.X509Certificate[] x = {};
		return x;
	}
}

class TrustAllHosts implements HostnameVerifier {

	public boolean verify(String hostname, SSLSession session) {
		return hostname.equalsIgnoreCase(session.getPeerHost());
	}
}

```


---

### 📄 `src/main/java/ze/impl/Utils.java` [4.352 octets]
<a id="src-main-java-ze-impl-Utils-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-impl-Utils-java)

> **Chemin relatif** : `src/main/java/ze/impl/Utils.java`  
> **Taille** : 4.352 octets  
> **Lignes** : 176  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (176 lignes) - Cliquer pour déplier</summary>

```java
package ze.impl;

import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Properties;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class Utils {

	private String url;

	private String user;

	private String password;

	private String mailSender;

	private String mailReceiver;

	private String serverSmtp;

	private String logFile;

	private String endPoint;

	private String subject;

	private String namespace;

	private String uricerbere;

	private String idcerbere;

	private String clecerbere;

	private String asynchfolder;

	private static final Logger LOG = LoggerFactory.getLogger(Utils.class);

	public Utils() {
		super();
		final Properties configFile = new Properties();
		try {
			Utils.LOG.info("fichier properties existe:" + new File("/zechange/ze_config.properties").exists());
			configFile.load(new FileInputStream("/zechange/ze_config.properties"));
			this.url = configFile.getProperty("url");
			this.user = configFile.getProperty("user");
			this.password = configFile.getProperty("password");
			this.mailSender = configFile.getProperty("mailsender");
			this.mailReceiver = configFile.getProperty("mailreceiver");
			this.serverSmtp = configFile.getProperty("serversmtp");
			this.logFile = configFile.getProperty("logfile");
			this.endPoint = configFile.getProperty("endpointurl");
			this.subject = configFile.getProperty("subject");
			this.namespace = configFile.getProperty("namespace");
			this.uricerbere = configFile.getProperty("uricerbere");
			this.idcerbere = configFile.getProperty("idcerbere");
			this.clecerbere = configFile.getProperty("clecerbere");
			this.asynchfolder = configFile.getProperty("asynchfolder");

			Utils.LOG.info(this.toString());
		} catch (final IOException e) {
			Utils.LOG.error("Erreur lors de la lecture du fichier config.properties  : \n", e);
		}
	}

	public void closeConnexion(ResultSet rs, PreparedStatement st, Connection con) {
		try {
			if (rs != null) {
				rs.close();
			}
			if (st != null) {
				st.close();
			}
			if (con != null) {
				con.close();
			}

		} catch (final SQLException ex) {
			this.erreurFermetureBase(ex);
		}
	}

	public void erreurAccesBase(Exception e) {
		Utils.LOG.error("Erreur lors de l'accès à la base de données  :{} \n", e);
		SendMail.envoyerMailSMTP(this.serverSmtp, this.mailSender, this.mailReceiver, "",
				this.subject, this.logFile);
	}

	public void erreurFermetureBase(Exception e) {
		Utils.LOG.error("Erreur lors de la fermeture de la connexion à la base de données  :{} \n", e);
		SendMail.envoyerMailSMTP(this.serverSmtp, this.mailSender, this.mailReceiver, "",
				this.subject, this.logFile);
	}

	public void erreurInnatendue(Exception e) {
		Utils.LOG.error("Erreur Java inattendue  :{} \n", e);
		SendMail.envoyerMailSMTP(this.serverSmtp, this.mailSender, this.mailReceiver, "",
				this.subject, this.logFile);
	}

	public String getUrl() {
		return this.url;
	}

	public String getUser() {
		return this.user;
	}

	public String getPassword() {
		return this.password;
	}

	public String getMailSender() {
		return this.mailSender;
	}

	public String getMailReceiver() {
		return this.mailReceiver;
	}

	public String getServerSmtp() {
		return this.serverSmtp;
	}

	public String getLogFile() {
		return this.logFile;
	}

	public String getEndPoint() {
		return this.endPoint;
	}

	public String getSubject() {
		return this.subject;
	}

	public String getNamespace() {
		return this.namespace;
	}

	public String getUricerbere() {
		return this.uricerbere;
	}

	public String getIdcerbere() {
		return this.idcerbere;
	}

	public String getClecerbere() {
		return this.clecerbere;
	}

	public String getAsynchfolder() {
		return this.asynchfolder;
	}

	@Override
	public String toString() {
		return "Utils [url=" + this.url + ", user=" + this.user + ", mailSender=" + this.mailSender
				+ ", mailReceiver=" + this.mailReceiver + ", serverSmtp=" + this.serverSmtp + ", logFile="
				+ this.logFile
				+ ", endPoint=" + this.endPoint + ", subject=" + this.subject + ", namespace=" + this.namespace
				+ ", uricerbere="
				+ this.uricerbere + ", idcerbere=" + this.idcerbere + ", clecerbere=" + this.clecerbere + "]";
	}

}

```

</details>


---

### 📄 `src/main/java/ze/impl/WebServiceImpl.java` [68.282 octets]
<a id="src-main-java-ze-impl-WebServiceImpl-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-impl-WebServiceImpl-java)

> **Chemin relatif** : `src/main/java/ze/impl/WebServiceImpl.java`  
> **Taille** : 68.282 octets  
> **Lignes** : 1411  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (1411 lignes) - Cliquer pour déplier</summary>

```java
package ze.impl;

import java.io.File;
import java.util.List;
import java.util.Map;
import java.util.regex.Pattern;

import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.Response;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import ze.WebService;
import ze.absence.Absence;
import ze.absence.AbsenceDAO;
import ze.affectation.Affectation;
import ze.affectation.AffectationDAO;
import ze.agent.Agent;
import ze.agent.AgentDAO;
import ze.carriere.Carriere;
import ze.carriere.CarriereDAO;
import ze.habilitation.Habilitation;
import ze.habilitation.HabilitationDAO;
import ze.quotite.Quotite;
import ze.quotite.QuotiteDAO;
import ze.reglementaire.Contractuel;
import ze.reglementaire.ContractuelDAO;
import ze.reglementaire.Corps;
import ze.reglementaire.CorpsDAO;
import ze.reglementaire.Grade;
import ze.reglementaire.GradeDAO;
import ze.remuneration.Remuneration;
import ze.remuneration.RemunerationDAO;
import ze.unitestructurelle.ArbreUniteStructurelle;
import ze.unitestructurelle.UniteStructurelle;
import ze.unitestructurelle.UniteStructurelleDAO;

public class WebServiceImpl implements WebService {

	private static final Logger LOG = LoggerFactory.getLogger(WebServiceImpl.class);

	private final UniteStructurelleDAO uniteStructurelleDAO = new UniteStructurelleDAO();

	private final AgentDAO agentDAO = new AgentDAO();

	private final CarriereDAO carriereDAO = new CarriereDAO();

	private final QuotiteDAO quotiteDAO = new QuotiteDAO();

	private final RemunerationDAO remunerationDAO = new RemunerationDAO();

	private final AbsenceDAO absenceDAO = new AbsenceDAO();

	private final AffectationDAO affectationDAO = new AffectationDAO();

	private final HabilitationDAO habilitationDAO = new HabilitationDAO();

	private final CorpsDAO corpsDAO = new CorpsDAO();

	private final GradeDAO gradeDAO = new GradeDAO();

	private final ContractuelDAO contractuelDAO = new ContractuelDAO();

	private static Authorisation auth = new Authorisation();

	// Pattern pour la liste de niveau => ('x','x', ...)
	private static final Pattern PATTERN_NIVEAU = Pattern.compile("^(\\(('0[0-9]?')(,'0[0-9]?'){0,}\\)){0,1}#{0,1}$");

	// Pattern pour la liste d'id => ('x','x', ...)
	private static final Pattern PATTERN_ID = Pattern.compile("^\\(('[^']*')(,'[^']*'){0,}\\)$");

	// Pattern pour la date de naissance => 'AAAAMMJJ' ou 'AAAAMM' ou 'AAAA'
	private static final Pattern PATTERN_DAT_NAI = Pattern
			.compile("^[0-9]{4}(((0[1-9])|(1[0-2]))((0[1-9])|([1-2][0-9])|(3[0-1])){0,1}){0,1}$");

	// Pattern pour une date fixe => 'AAAAMMJJ'
	private static final Pattern PATTERN_DAT = Pattern
			.compile("^[0-9]{4}(((0[1-9])|(1[0-2]))((0[1-9])|([1-2][0-9])|(3[0-1])))$");

	private static final int MAX_GENERATION = 20;

	private static final String TYPE_US = "identifiant d'US";

	private static final String TYPE_AGENT = "matricule d'agent";

	private static final String TYPE_CORPS = "identifiant de corps";

	private static final String RACINE = "racine";

	private static final String RACINE_MSG = "Le paramètre racine doit être de la forme TOP ou ('x','x',...) avec x un identifiant d'US";

	private static final String NB_GENERATION_MSG = "Le nombre de générations doit être un entier positif inférieur à 20";

	@Override
	public Response getUniteStructurelle(String id, String header) {
		WebServiceImpl.LOG.info("Appel au web service de recherche d'unites structurelles");

		// Vérification de l'authorisation de l'application à utiliser le web service
		final ErrorResponse err = WebServiceImpl.testAutorisation(header,
				Thread.currentThread().getStackTrace()[1].getMethodName());
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		}
		// Vérification du pattern id
		WebServiceImpl.testId(id, WebServiceImpl.TYPE_US, err);
		final List<UniteStructurelle> listUnite = this.uniteStructurelleDAO.findByMinist(id);
		// Vérification de la présence de résultats
		WebServiceImpl.testResultat(listUnite, err);

		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		} else {
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès ({} éléments)",
					listUnite.size());
			return Response.ok(listUnite, MediaType.APPLICATION_JSON).build();
		}
	}

	@Override
	public Response getAgent(String id, String header) {
		WebServiceImpl.LOG.info("Appel au web service de recherche d'agent");

		// Vérification de l'authorisation de l'application à utiliser le web service
		final ErrorResponse err = WebServiceImpl.testAutorisation(header,
				Thread.currentThread().getStackTrace()[1].getMethodName());
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		}
		// Vérification du pattern id
		WebServiceImpl.testId(id, WebServiceImpl.TYPE_AGENT, err);
		final List<Agent> listAgent = this.agentDAO.findById(id, true);
		// Vérification de la présence de résultats
		WebServiceImpl.testResultat(listAgent, err);

		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		} else {
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès + ({} éléments)",
					listAgent.size());
			return Response.ok(listAgent, MediaType.APPLICATION_JSON).build();
		}
	}

	@Override
	public Response getHabilitation(String id, String header) {
		WebServiceImpl.LOG.info("Appel au web service de recherche de profils");

		// Vérification de l'authorisation de l'application à utiliser le web service
		final ErrorResponse err = WebServiceImpl.testAutorisation(header,
				Thread.currentThread().getStackTrace()[1].getMethodName());
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		}

		final Habilitation hab = this.habilitationDAO.getHabilitation(id);
		if (hab == null || hab.getAdresseMail() == null) {
			WebServiceImpl.LOG
					.warn("NOT FOUND : Aucun résultat n'a été trouvé pour la recherche sur l'adresse mail : {}", id);
			final ErrorResponse error = new ErrorResponse("404",
					"Aucun profil n'est rattaché à l'adresse mail renseignée : " + id);
			return Response.status(Response.Status.NOT_FOUND).entity(error).build();
		} else if (hab.getHabProfil().isEmpty()) {
			WebServiceImpl.LOG
					.warn("NOT FOUND : Aucun Profil attaché à cet adresse mail : {}", id);
			final ErrorResponse error = new ErrorResponse("404",
					"Aucun profil n'est rattaché à l'adresse mail renseignée : " + id);
			return Response.status(Response.Status.NOT_FOUND).entity(error).build();
		} else {
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès");
			return Response.ok(hab, MediaType.APPLICATION_JSON).build();
		}
	}

	@Override
	public Response getListUniteStructurelles(String recherche, String racine, String nbGenerations, String niveau,
			String actif, String avecAgent, String fichier, String header) {
		WebServiceImpl.LOG.info("Appel au web service de liste d'unites structurelles");

		// Vérification de l'authorisation de l'application à utiliser le web service
		final ErrorResponse err = WebServiceImpl.testAutorisation(header,
				Thread.currentThread().getStackTrace()[1].getMethodName());
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		}
		// Vérification de la syntaxe du paramètre racine
		if (racine != null && !"TOP".equals(racine)) {
			WebServiceImpl.testParam(racine, WebServiceImpl.PATTERN_ID, WebServiceImpl.RACINE, err,
					WebServiceImpl.RACINE_MSG);
		}

		// Vérification du paramètre nbGénérations
		int nbGen = 0;
		if (nbGenerations != null) {
			try {
				nbGen = Integer.parseInt(nbGenerations);
				if (nbGen < 0 || nbGen > WebServiceImpl.MAX_GENERATION) {
					WebServiceImpl.LOG.warn("BAD REQUEST : Erreur sur le paramètre nbGenerations : {}", nbGen);
					final ErrorResponse error = new ErrorResponse("400", WebServiceImpl.NB_GENERATION_MSG);
					return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
				}
			} catch (final NumberFormatException e) {
				WebServiceImpl.LOG.warn("BAD REQUEST : Erreur sur le paramètre nbGenerations : {}", nbGen);
				final ErrorResponse error = new ErrorResponse("400", WebServiceImpl.NB_GENERATION_MSG);
				return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
			}
		} else {
			// Initialisation du nbre de générations au nbre max théorique
			nbGen = WebServiceImpl.MAX_GENERATION;
		}
		// Vérification de la présence du paramètre nbGenerations
		if (racine == null && nbGenerations != null) {
			WebServiceImpl.LOG.warn(
					"BAD REQUEST : Le paramètre racine est requis lorsque le nombre de générations est renseigné");
			final ErrorResponse error = new ErrorResponse("400",
					"La racine est requise lorsque le nombre de générations est renseigné");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}
		// Vérification de la syntaxe du paramètre niveau
		if (niveau != null && !WebServiceImpl.PATTERN_NIVEAU.matcher(niveau).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre niveau : {}", niveau);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre niveau doit être de la forme ('x','x',...) ou ('x','x',...)# ou # avec x dans [01,02,...,09]");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		final List<UniteStructurelle> listUS = this.uniteStructurelleDAO.getList(recherche, racine, nbGen, niveau,
				actif, avecAgent, fichier);

		// On crée le fichier csv associé à la recherche
		if ("true".equals(fichier)) {
			final String applicationName = WebServiceImpl.extractCertName(header);
			final File f = CsvFileWriter.writeUSCsvFile(applicationName, listUS);
			if (f == null) {
				WebServiceImpl.LOG.warn("SERVER ERROR : Erreur lors de la génération du fichier csv");
				final ErrorResponse error = new ErrorResponse("500", "Erreur interne du serveur");
				return Response.status(Response.Status.INTERNAL_SERVER_ERROR).entity(error).build();
			}
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès ({} éléments)",
					listUS.size());
			return Response.ok("Fichier créé : " + f.getPath()).build();
		}
		WebServiceImpl.testResultat(listUS, err);
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		} else {
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès({} éléments)",
					listUS.size());
			return Response.ok(listUS, MediaType.APPLICATION_JSON).build();
		}
	}

	@Override
	public Response getListAgents(String recherche, String affectationOperationnelle, String affectationAdministrative,
			String corps, String grade, String lotDeGestion, String partenaire, String pese, String codeCorrespondant,
			String dateNaissance, String codeRegroupementUOPoste, String fichier, String header) {
		WebServiceImpl.LOG.info("Appel au web service de liste d'agents");

		// Vérification de l'authorisation de l'application à utiliser le web service
		final ErrorResponse err = WebServiceImpl.testAutorisation(header,
				Thread.currentThread().getStackTrace()[1].getMethodName());
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		}
		// Vérification de la syntaxe du paramètre corps
		if (corps != null && !WebServiceImpl.PATTERN_ID.matcher(corps).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre corps : {}", corps);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre corps doit être de la forme ('x','x',...) avec x un identifiant de corps");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre grade
		if (grade != null && !WebServiceImpl.PATTERN_ID.matcher(grade).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre grade : {}", grade);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre grade doit être de la forme ('x','x',...) avec x un identifiant de grade");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}
		// Vérification de la syntaxe du paramètre grade
		if (lotDeGestion != null && !WebServiceImpl.PATTERN_ID.matcher(lotDeGestion).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre lotDeGestion : {}", lotDeGestion);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre grade doit être de la forme ('x','x',...) avec x un identifiant de lotDeGestion");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre affectationOperationnelle
		if (affectationOperationnelle != null && !WebServiceImpl.PATTERN_ID.matcher(affectationOperationnelle).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre affectationOperationnelle : {}",
					affectationOperationnelle);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre affectationOperationnelle doit être de la forme ('x','x',...) avec x un identifiant d'US");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}
		// Vérification de la syntaxe du paramètre affectationAdministrative
		if (affectationAdministrative != null && !WebServiceImpl.PATTERN_ID.matcher(affectationAdministrative).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre affectationAdministrative : {}",
					affectationAdministrative);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre affectationAdministrative doit être de la forme ('x','x',...) avec x un identifiant d'US");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre partenaire
		if (partenaire != null && !WebServiceImpl.PATTERN_ID.matcher(partenaire).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre partenaire : {}",
					partenaire);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre partenaire doit être de la forme ('x','x',...) avec x un partenaire");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre PESE
		if (pese != null && !WebServiceImpl.PATTERN_ID.matcher(pese).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre PESE : {}",
					pese);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre pese doit être de la forme ('x','x',...) avec x un PESE");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre codeCorrespondant
		if (codeCorrespondant != null && !WebServiceImpl.PATTERN_ID.matcher(codeCorrespondant).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre code_correspondant : {}",
					codeCorrespondant);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre code_correspondant doit être de la forme ('x','x',...) avec x un code Correspondant");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}
		// Vérification de la syntaxe du paramètre dateNaissance
		if (dateNaissance != null && !WebServiceImpl.PATTERN_DAT_NAI.matcher(dateNaissance).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre dateNaissance : {}",
					dateNaissance);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre dateNaissance doit être de la forme AAAA ou AAAAMM ou AAAAMMJJ");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}
		// Vérification de la syntaxe du paramètre codeRegroupementUOPoste
		if (codeRegroupementUOPoste != null
				&& !WebServiceImpl.PATTERN_ID.matcher(codeRegroupementUOPoste).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre codeRegroupementUOPoste : {}",
					codeRegroupementUOPoste);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre codeRegroupementUOPoste doit être de la forme ('x','x',...) avec x un code US");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		final List<Agent> listAgent = this.agentDAO.getList(recherche, affectationOperationnelle,
				affectationAdministrative, corps, grade, lotDeGestion, partenaire, pese, codeCorrespondant,
				dateNaissance, codeRegroupementUOPoste);

		// On crée le fichier csv associé à la recherche
		if ("true".equals(fichier)) {
			final String applicationName = WebServiceImpl.extractCertName(header);
			final File f = CsvFileWriter.writeAgentCsvFile(applicationName, listAgent);
			if (f == null) {
				WebServiceImpl.LOG.warn("SERVER ERROR : Erreur lors de la génération du fichier csv");
				final ErrorResponse error = new ErrorResponse("500", "Erreur interne du serveur");
				return Response.status(Response.Status.INTERNAL_SERVER_ERROR).entity(error).build();
			}
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès({} éléments)",
					listAgent.size());
			return Response.ok("Fichier créé : " + f.getPath()).build();
		}

		WebServiceImpl.testResultat(listAgent, err);
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		} else {
			return WebServiceImpl.getResponse(listAgent);
		}
	}

	@Override
	public Response getListRemunerations(String recherche, String matricule, String codeTG, String temoinAnnulation,
			String temoinValidationPaye, String exportDateFin, String exportDateEffet, String fichier, String header) {
		WebServiceImpl.LOG.info("Appel au web service de liste de rémunérations");

		// Vérification de l'authorisation de l'application à utiliser le web service
		final ErrorResponse err = WebServiceImpl.testAutorisation(header,
				Thread.currentThread().getStackTrace()[1].getMethodName());
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		}
		// Vérification de la syntaxe du paramètre matricule
		if (matricule != null && !WebServiceImpl.PATTERN_ID.matcher(matricule).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre matricule : {}", matricule);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre matricule doit être de la forme ('x','x',...) avec x un matricule");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre codeTG
		if (codeTG != null && !WebServiceImpl.PATTERN_ID.matcher(codeTG).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre codeTG : {}", codeTG);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre codeTG doit être de la forme ('x','x',...) avec x un code TG");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Verification de la syntaxe du paramètre temoinValidation
		try {
			if (temoinValidationPaye != null) {
				final int tem = Integer.parseInt(temoinValidationPaye);
				if (tem < 1 || tem > 3) {
					WebServiceImpl.LOG.warn(
							"BAD REQUEST : Erreur de syntaxe sur le paramètre temoinValidationPaye : {}",
							temoinValidationPaye);
					final ErrorResponse error = new ErrorResponse("400",
							"Le paramètre temoinValidationPaye doit être un entier compris entre 1 et 3");
					return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
				}
			}
		} catch (final NumberFormatException e) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre temoinValidationPaye : {}",
					temoinValidationPaye);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre temoinValidationPaye doit être un entier comrpis entre 1 et 3");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre exportDateFin
		if (exportDateFin != null && !WebServiceImpl.PATTERN_DAT_NAI.matcher(exportDateFin).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre exportDateFin : {}",
					exportDateFin);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre exportDateFin doit être de la forme AAAA ou AAAAMM ou AAAAMMJJ");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre exportDateEffet
		if (exportDateEffet != null && !WebServiceImpl.PATTERN_DAT_NAI.matcher(exportDateEffet).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre exportDateEffet : {}",
					exportDateEffet);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre exportDateEffet doit être de la forme AAAA ou AAAAMM ou AAAAMMJJ");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		final List<Remuneration> listRemuneration = this.remunerationDAO.getList(recherche, matricule, codeTG,
				temoinAnnulation, temoinValidationPaye, exportDateFin, exportDateEffet);

		// On crée le fichier csv associé à la recherche
		if ("true".equals(fichier)) {
			final String applicationName = WebServiceImpl.extractCertName(header);
			final File f = CsvFileWriter.writeRemunerationCsvFile(applicationName, listRemuneration);
			if (f == null) {
				WebServiceImpl.LOG.warn("SERVER ERROR : Erreur lors de la génération du fichier csv");
				final ErrorResponse error = new ErrorResponse("500", "Erreur interne du serveur");
				return Response.status(Response.Status.INTERNAL_SERVER_ERROR).entity(error).build();
			}
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès({} éléments)",
					listRemuneration.size());
			return Response.ok("Fichier créé : " + f.getPath()).build();
		}

		WebServiceImpl.testResultat(listRemuneration, err);
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		} else {
			return WebServiceImpl.getResponse(listRemuneration);
		}
	}

	@Override
	public Response getListAbsences(String recherche, String matricule, String numeroDroit,
			String temoinValidation, String motifAbsence, String exportDateEffet, String fichier, String header) {
		WebServiceImpl.LOG.info("Appel au web service de liste des absences");

		// Vérification de l'authorisation de l'application à utiliser le web service
		final ErrorResponse err = WebServiceImpl.testAutorisation(header,
				Thread.currentThread().getStackTrace()[1].getMethodName());
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		}
		// Vérification de la syntaxe du paramètre matricule
		if (matricule != null && !WebServiceImpl.PATTERN_ID.matcher(matricule).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre matricule : {}", matricule);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre matricule doit être de la forme ('x','x',...) avec x un matricule");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre numeroDroit
		if (numeroDroit != null && !WebServiceImpl.PATTERN_ID.matcher(numeroDroit).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre numeroDroit : {}", numeroDroit);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre numeroDroit doit être de la forme ('x','x',...) avec x un numero de droit");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre motifAbsence
		if (motifAbsence != null && !WebServiceImpl.PATTERN_ID.matcher(motifAbsence).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre motifAbsence : {}", motifAbsence);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre motifAbsence doit être de la forme ('x','x',...) avec x un motif d'absence");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre exportDateEffet
		if (exportDateEffet != null && !WebServiceImpl.PATTERN_DAT_NAI.matcher(exportDateEffet).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre exportDateEffet : {}",
					exportDateEffet);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre exportDateEffet doit être de la forme AAAA ou AAAAMM ou AAAAMMJJ");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Verification de la syntaxe du paramètre temoinValidation
		try {
			if (temoinValidation != null) {
				final int tem = Integer.parseInt(temoinValidation);
				if (tem < 1 || tem > 3) {
					WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre temoinValidation : {}",
							temoinValidation);
					final ErrorResponse error = new ErrorResponse("400",
							"Le paramètre temoinValidation doit être un entier compris entre 1 et 3");
					return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
				}
			}
		} catch (final NumberFormatException e) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre temoinValidation : {}",
					temoinValidation);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre temoinValidation doit être un entier comrpis entre 1 et 3");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		final List<Absence> listAbsence = this.absenceDAO.getList(recherche, matricule, numeroDroit, temoinValidation,
				motifAbsence, exportDateEffet);

		// On crée le fichier csv associé à la recherche
		if ("true".equals(fichier)) {
			final String applicationName = WebServiceImpl.extractCertName(header);
			final File f = CsvFileWriter.writeAbsenceCsvFile(applicationName, listAbsence);
			if (f == null) {
				WebServiceImpl.LOG.warn("SERVER ERROR : Erreur lors de la génération du fichier csv");
				final ErrorResponse error = new ErrorResponse("500", "Erreur interne du serveur");
				return Response.status(Response.Status.INTERNAL_SERVER_ERROR).entity(error).build();
			}
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès({} éléments)",
					listAbsence.size());
			return Response.ok("Fichier créé : " + f.getPath()).build();
		}

		WebServiceImpl.testResultat(listAbsence, err);
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		} else {
			return WebServiceImpl.getResponse(listAbsence);
		}
	}

	@Override
	public Response getListAffectations(String recherche, String matricule, String temoinValidite,
			String exportDateEffetBorne, String fichier, String header) {
		WebServiceImpl.LOG.info("Appel au web service de liste d'affectations");

		// Vérification de l'authorisation de l'application à utiliser le web service
		final ErrorResponse err = WebServiceImpl.testAutorisation(header,
				Thread.currentThread().getStackTrace()[1].getMethodName());
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		}
		// Vérification de la syntaxe du paramètre matricule
		if (matricule != null && !WebServiceImpl.PATTERN_ID.matcher(matricule).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre matricule : {}", matricule);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre matricule doit être de la forme ('x','x',...) avec x un matricule");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Verification de la syntaxe du paramètre temoinValidation
		try {
			if (temoinValidite != null) {
				final int tem = Integer.parseInt(temoinValidite);
				if (tem < 1 || tem > 3) {
					WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre temoinValidite : {}",
							temoinValidite);
					final ErrorResponse error = new ErrorResponse("400",
							"Le paramètre temoinValidite doit être un entier compris entre 1 et 3");
					return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
				}
			}
		} catch (final NumberFormatException e) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre temoinValidite : {}",
					temoinValidite);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre temoinValidite doit être un entier comrpis entre 1 et 3");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre exportDateEffet
		if (exportDateEffetBorne != null && !WebServiceImpl.PATTERN_DAT.matcher(exportDateEffetBorne).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre export_date_effet_borne : {}",
					exportDateEffetBorne);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre export_date_effet_borne doit être de la forme AAAAMMJJ");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		final List<Affectation> listAffectation = this.affectationDAO.getList(recherche, matricule, temoinValidite,
				exportDateEffetBorne);

		// On crée le fichier csv associé à la recherche
		if ("true".equals(fichier)) {
			final String applicationName = WebServiceImpl.extractCertName(header);
			final File f = CsvFileWriter.writeAffectationCsvFile(applicationName, listAffectation);
			if (f == null) {
				WebServiceImpl.LOG.warn("SERVER ERROR : Erreur lors de la génération du fichier csv");
				final ErrorResponse error = new ErrorResponse("500", "Erreur interne du serveur");
				return Response.status(Response.Status.INTERNAL_SERVER_ERROR).entity(error).build();
			}
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès({} éléments)",
					listAffectation.size());
			return Response.ok("Fichier créé : " + f.getPath()).build();
		}

		WebServiceImpl.testResultat(listAffectation, err);
		WebServiceImpl.LOG.info("APRES TEST");
		if (err.getStatus() != Response.Status.OK) {
			WebServiceImpl.LOG.info("BAD");
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		} else {
			WebServiceImpl.LOG.info("GOOD");
			return WebServiceImpl.getResponse(listAffectation);
		}
	}

	@Override
	public Response getArboUniteStructurelles(String racine, String nbGenerations, String niveau, String actif,
			String avecAgent, String header) {
		WebServiceImpl.LOG.info("Appel au web service de branche d'unites structurelles");

		// Vérification de l'authorisation de l'application à utiliser le web service
		final ErrorResponse err = WebServiceImpl.testAutorisation(header,
				Thread.currentThread().getStackTrace()[1].getMethodName());
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		}

		if (racine == null) {
			WebServiceImpl.LOG.warn("BAD REQUEST :Le paramètre racine est obligatoire");
			final ErrorResponse error = new ErrorResponse("400", "La racine est un paramètre obligatoire");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}
		// Vérification de la syntaxe du paramètre racine
		if (!"TOP".equals(racine) && !WebServiceImpl.PATTERN_ID.matcher(racine).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre racine : {}", racine);
			final ErrorResponse error = new ErrorResponse("400",
					WebServiceImpl.RACINE_MSG);
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}
		// Vérification du paramètre nbGénérations
		int nbGen = 0;
		if (nbGenerations != null) {
			try {
				nbGen = Integer.parseInt(nbGenerations);
				if (nbGen < 0 || nbGen > WebServiceImpl.MAX_GENERATION) {
					WebServiceImpl.LOG.warn("BAD REQUEST : Erreur sur le paramètre nbGenerations : {}", nbGen);
					final ErrorResponse error = new ErrorResponse("400",
							WebServiceImpl.NB_GENERATION_MSG);
					return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
				}
			} catch (final NumberFormatException e) {
				WebServiceImpl.LOG.warn("BAD REQUEST : Erreur sur le paramètre nbGenerations : {}", nbGen);
				final ErrorResponse error = new ErrorResponse("400",
						WebServiceImpl.NB_GENERATION_MSG);
				return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
			}
		} else {
			// Initialisation du nbre de générations au nbre max théorique
			nbGen = WebServiceImpl.MAX_GENERATION;
		}
		// Vérification de la syntaxe du paramètre niveau
		if (niveau != null && !WebServiceImpl.PATTERN_NIVEAU.matcher(niveau).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre niveau : {}", niveau);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre niveau doit être de la forme ('x','x',...) ou ('x','x',...)# ou # avec x dans [01,02,...,09]");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		final List<ArbreUniteStructurelle> arbreUS = this.uniteStructurelleDAO.getArbo(racine, nbGen, niveau, actif,
				avecAgent);
		WebServiceImpl.testResultat(arbreUS, err);
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		} else {
			return WebServiceImpl.getResponse(arbreUS);
		}
	}

	@Override
	public Response getEffectifAgents(String recherche, String uniteStructurelle, String corps, String grade,
			String dateNaissance,
			String exportDateEffet, String header) {
		WebServiceImpl.LOG.info("Appel au web service des agents effectifs");

		// Vérification de l'authorisation de l'application à utiliser le web service
		final ErrorResponse err = WebServiceImpl.testAutorisation(header,
				Thread.currentThread().getStackTrace()[1].getMethodName());
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		}

		// Vérification de la syntaxe du paramètre corps
		if (corps != null && !WebServiceImpl.PATTERN_ID.matcher(corps).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre corps : {}", corps);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre corps doit être de la forme ('x','x',...) avec x un identifiant de corps");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre grade
		if (grade != null && !WebServiceImpl.PATTERN_ID.matcher(grade).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre grade : {}", grade);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre grade doit être de la forme ('x','x',...) avec x un identifiant de grade");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre uniteStructurelle
		if (uniteStructurelle != null && !WebServiceImpl.PATTERN_ID.matcher(uniteStructurelle).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre uniteStructurelle : {}",
					uniteStructurelle);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre uniteStructurelle doit être de la forme ('x','x',...) avec x un identifiant d'US");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre dateNaissance
		if (dateNaissance != null && !WebServiceImpl.PATTERN_DAT_NAI.matcher(dateNaissance).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre dateNaissance : {}",
					dateNaissance);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre dateNaissance doit être de la forme AAAA ou AAAAMM ou AAAAMMJJ");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre exportDateEffet
		if (exportDateEffet != null && !WebServiceImpl.PATTERN_DAT.matcher(exportDateEffet).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre export_date_effet : {}",
					exportDateEffet);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre export_date_effet doit être de la forme AAAAMMJJ");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		final Map<String, Integer> effectif = this.agentDAO.getEffectif(recherche, uniteStructurelle, corps, grade,
				dateNaissance, exportDateEffet);
		WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès");
		return Response.ok(effectif, MediaType.APPLICATION_JSON).build();
	}

	/*
	 * Récupération du nom de l'application
	 */
	private static String extractCertName(String header) {
		if (header != null) {
			return header.split(",")[0].substring(3);
		} else {
			return null;
		}
	}

	/*
	 * Test des autorisations de l'application consommatrice
	 */
	private static ErrorResponse testAutorisation(String header, String method) {
		final String certName = WebServiceImpl.extractCertName(header);
		final ErrorResponse error = new ErrorResponse();
		if (!WebServiceImpl.auth.isApplicationAuthorized(certName, method)) {
			WebServiceImpl.LOG.warn("UNAUTHORIZED : L'application {} n'est pas habilitée à utiliser ce WebService {}",
					certName, method);
			error.setCode("401");
			error.setMessage("L'application " + certName + " n'est pas habilitée à utiliser ce WebService ");
			error.setStatus(Response.Status.UNAUTHORIZED);
		}
		return error;
	}

	/*
	 * Test sur un paramètre de type id
	 */
	private static void testId(String id, String type, ErrorResponse err) {
		if (err.getStatus() == Response.Status.OK && !WebServiceImpl.PATTERN_ID.matcher(id).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre id : {}", id);
			err.setCode("400");
			err.setMessage("Le paramètre id doit être de la forme ('x','x',...) avec x un " + type);
			err.setStatus(Response.Status.BAD_REQUEST);
		}
	}

	/*
	 * Test sur la syntaxe d'un paramètre
	 */
	private static void testParam(String param, Pattern patern, String type, ErrorResponse err, String msg) {
		if (err.getStatus() == Response.Status.OK && !patern.matcher(param).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre {}", type);
			err.setCode("400");
			err.setMessage(msg);
			err.setStatus(Response.Status.BAD_REQUEST);
		}
	}

	/*
	 * Test sur la présence de résultats
	 */
	private static void testResultat(List<?> list, ErrorResponse err) {
		if (err.getStatus() == Response.Status.OK && (list == null || list.isEmpty())) {
			WebServiceImpl.LOG.warn("NOT FOUND : Aucun résultat n'a été trouvé pour la recherche");
			err.setCode("404");
			err.setMessage("Aucun résultat n'a été trouvée pour la recherche");
			err.setStatus(Response.Status.NOT_FOUND);
		}
	}

	/*
	 * Récupere la réponse à envoyer à l'application consomatrice
	 */
	private static Response getResponse(List<?> list) {
		WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès({} éléments)", list.size());
		return Response.ok(list, MediaType.APPLICATION_JSON).build();
	}

	@Override
	public Response getIdentiteAgent(String id, String fichier, String header) {
		WebServiceImpl.LOG.info("Appel au web service de recherche des identités d'agent");

		// Vérification de l'authorisation de l'application à utiliser le web service
		final ErrorResponse err = WebServiceImpl.testAutorisation(header,
				Thread.currentThread().getStackTrace()[1].getMethodName());
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		}
		// Vérification du pattern id
		if (id != null) {
			WebServiceImpl.testId(id, WebServiceImpl.TYPE_AGENT, err);
		}
		final List<Agent> listAgent = this.agentDAO.findById(id, false);

		// On crée le fichier csv associé à la recherche
		if ("true".equals(fichier)) {
			final String applicationName = WebServiceImpl.extractCertName(header);
			final File f = CsvFileWriter.writeAgentCsvFile(applicationName, listAgent);
			if (f == null) {
				WebServiceImpl.LOG.warn("SERVER ERROR : Erreur lors de la génération du fichier csv");
				final ErrorResponse error = new ErrorResponse("500", "Erreur interne du serveur");
				return Response.status(Response.Status.INTERNAL_SERVER_ERROR).entity(error).build();
			}
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès ({} éléments)",
					listAgent.size());
			return Response.ok("Fichier créé : " + f.getPath()).build();
		}

		// Vérification de la présence de résultats
		WebServiceImpl.testResultat(listAgent, err);

		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		} else {
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès + ({} éléments)",
					listAgent.size());
			return Response.ok(listAgent, MediaType.APPLICATION_JSON).build();
		}
	}

	@Override
	public Response getStatut(String id, String statut, String dateEffet, String exportDateEffetBorne,
			String header) {
		WebServiceImpl.LOG.info("Appel au web service des statuts des agents");

		// Vérification de l'authorisation de l'application à utiliser le web service
		final ErrorResponse err = WebServiceImpl.testAutorisation(header,
				Thread.currentThread().getStackTrace()[1].getMethodName());
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		}
		// Vérification de la syntaxe du paramètre dateEffet
		if (dateEffet != null && !WebServiceImpl.PATTERN_DAT.matcher(dateEffet).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre dateEffet : {}", dateEffet);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre dateEffet doit être de la forme AAAAMMJJ");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre exportDateEffetBorne
		if (exportDateEffetBorne != null && !WebServiceImpl.PATTERN_DAT.matcher(exportDateEffetBorne).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre export_date_effet_borne : {}",
					exportDateEffetBorne);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre export_date_effet_borne doit être de la forme AAAAMMJJ");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		final List<Agent> listAgent = this.agentDAO.getStatutList(id, statut, dateEffet, exportDateEffetBorne);

		WebServiceImpl.testResultat(listAgent, err);
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		} else {
			return WebServiceImpl.getResponse(listAgent);
		}
	}

	@Override
	public Response getQuotite(String recherche, String matricule, String exportDateEffetBorne, String temoinValide,
			String fichier, String header) {

		WebServiceImpl.LOG.info("Appel au web service des quotités");

		// Vérification de l'authorisation de l'application à utiliser le web service
		final ErrorResponse err = WebServiceImpl.testAutorisation(header,
				Thread.currentThread().getStackTrace()[1].getMethodName());
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		}
		// Vérification du pattern id
		if (matricule != null) {
			WebServiceImpl.testId(matricule, WebServiceImpl.TYPE_AGENT, err);
		}
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		}

		// Vérification de la syntaxe du paramètre exportDateEffetBorne
		if (exportDateEffetBorne != null && !WebServiceImpl.PATTERN_DAT.matcher(exportDateEffetBorne).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre export_date_effet_borne : {}",
					exportDateEffetBorne);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre export_date_effet_borne doit être de la forme AAAAMMJJ");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		//Vérification du pattern temoinValide
		if (temoinValide != null && "1".compareTo(temoinValide) != 0 && "2".compareTo(temoinValide) != 0
				&& "3".compareTo(temoinValide) != 0) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre temoinValide : {}", temoinValide);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre temoinValide peut prendre uniquement les valeur 1, 2 ou 3");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		final List<Quotite> listQuotite = this.quotiteDAO.getList(recherche, matricule, exportDateEffetBorne,
				temoinValide);

		// On crée le fichier csv associé à la recherche
		if ("true".equals(fichier)) {
			final String applicationName = WebServiceImpl.extractCertName(header);
			final File f = CsvFileWriter.writeQuotiteCsvFile(applicationName, listQuotite);
			if (f == null) {
				WebServiceImpl.LOG.warn("SERVER ERROR : Erreur lors de la génération du fichier csv");
				final ErrorResponse error = new ErrorResponse("500", "Erreur interne du serveur");
				return Response.status(Response.Status.INTERNAL_SERVER_ERROR).entity(error).build();
			}
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès ({} éléments)",
					listQuotite.size());
			return Response.ok("Fichier créé : " + f.getPath()).build();
		}

		WebServiceImpl.testResultat(listQuotite, err);
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		} else {
			return WebServiceImpl.getResponse(listQuotite);
		}
	}

	@Override
	public Response getCarriere(String matricule, String exportDateEffetBorne, String temoinValide, String fichier,
			String header) {

		WebServiceImpl.LOG.info("Appel au web service des carrières");

		// Vérification de l'authorisation de l'application à utiliser le web service
		final ErrorResponse err = WebServiceImpl.testAutorisation(header,
				Thread.currentThread().getStackTrace()[1].getMethodName());
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		}
		// Vérification du pattern id
		if (matricule != null) {
			WebServiceImpl.testId(matricule, WebServiceImpl.TYPE_AGENT, err);
		}

		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		}

		// Vérification de la syntaxe du paramètre exportDateEffetBorne
		if (exportDateEffetBorne != null && !WebServiceImpl.PATTERN_DAT.matcher(exportDateEffetBorne).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre export_date_effet_borne : {}",
					exportDateEffetBorne);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre export_date_effet_borne doit être de la forme AAAAMMJJ");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		//Vérification du pattern temoinValide
		if (temoinValide != null && "1".compareTo(temoinValide) != 0 && "2".compareTo(temoinValide) != 0
				&& "3".compareTo(temoinValide) != 0) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre temoinValide : {}", temoinValide);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre temoinValide peut prendre uniquement les valeur 1, 2 ou 3");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		final List<Carriere> listCarriere = this.carriereDAO.getList(matricule, exportDateEffetBorne, temoinValide);

		// On crée le fichier csv associé à la recherche
		if ("true".equals(fichier)) {
			final String applicationName = WebServiceImpl.extractCertName(header);
			final File f = CsvFileWriter.writeCarriereCsvFile(applicationName, listCarriere);
			if (f == null) {
				WebServiceImpl.LOG.warn("SERVER ERROR : Erreur lors de la génération du fichier csv");
				final ErrorResponse error = new ErrorResponse("500", "Erreur interne du serveur");
				return Response.status(Response.Status.INTERNAL_SERVER_ERROR).entity(error).build();
			}
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès ({} éléments)",
					listCarriere.size());
			return Response.ok("Fichier créé : " + f.getPath()).build();
		}

		WebServiceImpl.testResultat(listCarriere, err);
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		} else {
			return WebServiceImpl.getResponse(listCarriere);
		}
	}

	@Override
	public Response getCorpsById(String id, String fichier, String header) {
		WebServiceImpl.LOG.info("Appel au web service de recherche de corps");

		// Vérification de l'authorisation de l'application à utiliser le web service
		final ErrorResponse err = WebServiceImpl.testAutorisation(header,
				Thread.currentThread().getStackTrace()[1].getMethodName());
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		}
		// Vérification de la syntaxe du paramètre fichier
		if (fichier != null && ("true".equals(fichier) || "false".equals(fichier))) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre fichier : {}", fichier);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre fichier doit avoir la valeur true ou false");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}
		// Vérification du pattern id
		WebServiceImpl.testId(id, WebServiceImpl.TYPE_CORPS, err);
		final List<Corps> listCorps = this.corpsDAO.getCorpsById(id);

		// On crée le fichier csv associé à la recherche
		if ("true".equals(fichier)) {
			final String applicationName = WebServiceImpl.extractCertName(header);
			final File f = CsvFileWriter.writeCorpsCsvFile(applicationName, listCorps);
			if (f == null) {
				WebServiceImpl.LOG.warn("SERVER ERROR : Erreur lors de la génération du fichier csv");
				final ErrorResponse error = new ErrorResponse("500", "Erreur interne du serveur");
				return Response.status(Response.Status.INTERNAL_SERVER_ERROR).entity(error).build();
			}
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès({} éléments)",
					listCorps.size());
			return Response.ok("Fichier créé : " + f.getPath()).build();
		}
		// Vérification de la présence de résultats
		WebServiceImpl.testResultat(listCorps, err);

		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		} else {
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès ({} éléments)",
					listCorps.size());
			return Response.ok(listCorps, MediaType.APPLICATION_JSON).build();
		}
	}

	@Override
	public Response getCorpsList(String recherche, String corps, String ouvert, String avecAgent,
			String fichier, String header) {
		WebServiceImpl.LOG.info("Appel au web service de liste de corps");

		// Vérification de l'authorisation de l'application à utiliser le web service
		final ErrorResponse err = WebServiceImpl.testAutorisation(header,
				Thread.currentThread().getStackTrace()[1].getMethodName());
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		}
		// Vérification de la syntaxe du paramètre ministere
		if (corps != null && !WebServiceImpl.PATTERN_ID.matcher(corps).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre code ministere : {}", corps);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre code ministere doit être de la forme ('x','x',...) avec x un code ministere");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre actif
		if (ouvert != null && !"true".equals(ouvert) && !"false".equals(ouvert)) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre actif : {}", ouvert);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre actif doit avoir la valeur true ou false");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre avecAgent
		if (avecAgent != null && !"true".equals(avecAgent) && !"false".equals(avecAgent)) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre avecAgent : {}", avecAgent);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre avecAgent doit avoir la valeur true ou false");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre fichier
		if (fichier != null && !"true".equals(fichier) && !"false".equals(fichier)) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre fichier : {}", fichier);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre fichier doit avoir la valeur true ou false");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		final List<Corps> listCorps = this.corpsDAO.getCorpsList(recherche, corps,
				ouvert, avecAgent, fichier);

		// On crée le fichier csv associé à la recherche
		if ("true".equals(fichier)) {
			final String applicationName = WebServiceImpl.extractCertName(header);
			final File f = CsvFileWriter.writeCorpsCsvFile(applicationName, listCorps);
			if (f == null) {
				WebServiceImpl.LOG.warn("SERVER ERROR : Erreur lors de la génération du fichier csv");
				final ErrorResponse error = new ErrorResponse("500", "Erreur interne du serveur");
				return Response.status(Response.Status.INTERNAL_SERVER_ERROR).entity(error).build();
			}
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès({} éléments)",
					listCorps.size());
			return Response.ok("Fichier créé : " + f.getPath()).build();
		}

		WebServiceImpl.testResultat(listCorps, err);
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		} else {
			return WebServiceImpl.getResponse(listCorps);
		}
	}

	@Override
	public Response getGradeById(String id, String fichier, String header) {
		WebServiceImpl.LOG.info("Appel au web service de recherche de grade");

		// Vérification de l'authorisation de l'application à utiliser le web service
		final ErrorResponse err = WebServiceImpl.testAutorisation(header,
				Thread.currentThread().getStackTrace()[1].getMethodName());
		// Vérification de la syntaxe du paramètre fichier
		if (fichier != null && ("true".equals(fichier) || "false".equals(fichier))) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre fichier : {}", fichier);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre fichier doit avoir la valeur true ou false");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}
		// Vérification du pattern id
		WebServiceImpl.testId(id, WebServiceImpl.TYPE_CORPS, err);
		final List<Grade> listGrade = this.gradeDAO.getGradeById(id);

		// On crée le fichier csv associé à la recherche
		if ("true".equals(fichier)) {
			final String applicationName = WebServiceImpl.extractCertName(header);
			final File f = CsvFileWriter.writeGradeCsvFile(applicationName, listGrade);
			if (f == null) {
				WebServiceImpl.LOG.warn("SERVER ERROR : Erreur lors de la génération du fichier csv");
				final ErrorResponse error = new ErrorResponse("500", "Erreur interne du serveur");
				return Response.status(Response.Status.INTERNAL_SERVER_ERROR).entity(error).build();
			}
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès({} éléments)",
					listGrade.size());
			return Response.ok("Fichier créé : " + f.getPath()).build();
		}
		// Vérification de la présence de résultats
		WebServiceImpl.testResultat(listGrade, err);

		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		} else {
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès ({} éléments)",
					listGrade.size());
			return Response.ok(listGrade, MediaType.APPLICATION_JSON).build();
		}
	}

	@Override
	public Response getGradeList(String recherche, String grade, String ouvert, String avecAgent, String fichier,
			String header) {
		WebServiceImpl.LOG.info("Appel au web service de liste de grade");

		// Vérification de l'authorisation de l'application à utiliser le web service
		final ErrorResponse err = WebServiceImpl.testAutorisation(header,
				Thread.currentThread().getStackTrace()[1].getMethodName());
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		}
		// Vérification de la syntaxe du paramètre ministere
		if (grade != null && !WebServiceImpl.PATTERN_ID.matcher(grade).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre corps : {}", grade);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre corps doit être de la forme ('x','x',...) avec x un corps");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre actif
		if (ouvert != null && !"true".equals(ouvert) && !"false".equals(ouvert)) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre actif : {}", ouvert);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre actif doit avoir la valeur true ou false");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre actif
		if (avecAgent != null && !"true".equals(avecAgent) && !"false".equals(avecAgent)) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre avecAgent : {}", avecAgent);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre avecAgent doit avoir la valeur true ou false");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre fichier
		if (fichier != null && !"true".equals(fichier) && !"false".equals(fichier)) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre fichier : {}", fichier);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre fichier doit avoir la valeur true ou false");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		final List<Grade> listGrade = this.gradeDAO.getGradeList(recherche, grade, ouvert,
				avecAgent);
		WebServiceImpl.LOG.info("fichier demandé: {}", fichier);
		// On crée le fichier csv associé à la recherche
		if ("true".equals(fichier)) {
			final String applicationName = WebServiceImpl.extractCertName(header);
			final File f = CsvFileWriter.writeGradeCsvFile(applicationName, listGrade);
			if (f == null) {
				WebServiceImpl.LOG.warn("SERVER ERROR : Erreur lors de la génération du fichier csv");
				final ErrorResponse error = new ErrorResponse("500", "Erreur interne du serveur");
				return Response.status(Response.Status.INTERNAL_SERVER_ERROR).entity(error).build();
			}
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès({} éléments)",
					listGrade.size());
			return Response.ok("Fichier créé : " + f.getPath()).build();
		}

		WebServiceImpl.testResultat(listGrade, err);
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		} else {
			return WebServiceImpl.getResponse(listGrade);
		}
	}

	@Override
	public Response getContractuelById(String id, String fichier, String header) {
		// Vérification de l'authorisation de l'application à utiliser le web service
		final ErrorResponse err = WebServiceImpl.testAutorisation(header,
				Thread.currentThread().getStackTrace()[1].getMethodName());
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		}
		// Vérification de la syntaxe du paramètre fichier
		if (fichier != null && ("true".equals(fichier) || "false".equals(fichier))) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre fichier : {}", fichier);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre fichier doit avoir la valeur true ou false");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}
		// Vérification du pattern id
		WebServiceImpl.testId(id, WebServiceImpl.TYPE_CORPS, err);
		final List<Contractuel> listPseudoGrade = this.contractuelDAO.getGradeById(id);

		// On crée le fichier csv associé à la recherche
		if ("true".equals(fichier)) {
			final String applicationName = WebServiceImpl.extractCertName(header);
			final File f = CsvFileWriter.writePseudoGradeCsvFile(applicationName, listPseudoGrade);
			if (f == null) {
				WebServiceImpl.LOG.warn("SERVER ERROR : Erreur lors de la génération du fichier csv");
				final ErrorResponse error = new ErrorResponse("500", "Erreur interne du serveur");
				return Response.status(Response.Status.INTERNAL_SERVER_ERROR).entity(error).build();
			}
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès({} éléments)",
					listPseudoGrade.size());
			return Response.ok("Fichier créé : " + f.getPath()).build();
		}
		// Vérification de la présence de résultats
		WebServiceImpl.testResultat(listPseudoGrade, err);

		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		} else {
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès ({} éléments)",
					listPseudoGrade.size());
			return Response.ok(listPseudoGrade, MediaType.APPLICATION_JSON).build();
		}
	}

	@Override
	public Response getContractuelList(String recherche, String pseudoGrade, String ouvert, String avecAgent,
			String fichier,
			String header) {

		WebServiceImpl.LOG.info("Appel au web service de liste de pseudo-grade");

		// Vérification de l'authorisation de l'application à utiliser le web service
		final ErrorResponse err = WebServiceImpl.testAutorisation(header,
				Thread.currentThread().getStackTrace()[1].getMethodName());
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		}
		// Vérification de la syntaxe du paramètre ministere
		if (pseudoGrade != null && !WebServiceImpl.PATTERN_ID.matcher(pseudoGrade).find()) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre corps : {}", pseudoGrade);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre corps doit être de la forme ('x','x',...) avec x un corps");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre actif
		if (ouvert != null && !"true".equals(ouvert) && !"false".equals(ouvert)) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre actif : {}", ouvert);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre actif doit avoir la valeur true ou false");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre actif
		if (avecAgent != null && !"true".equals(avecAgent) && !"false".equals(avecAgent)) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre avecAgent : {}", avecAgent);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre avecAgent doit avoir la valeur true ou false");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		// Vérification de la syntaxe du paramètre fichier
		if (fichier != null && !"true".equals(fichier) && !"false".equals(fichier)) {
			WebServiceImpl.LOG.warn("BAD REQUEST : Erreur de syntaxe sur le paramètre fichier : {}", fichier);
			final ErrorResponse error = new ErrorResponse("400",
					"Le paramètre fichier doit avoir la valeur true ou false");
			return Response.status(Response.Status.BAD_REQUEST).entity(error).build();
		}

		final List<Contractuel> listPseudoGrade = this.contractuelDAO.getPseudoGradeList(recherche, pseudoGrade, ouvert,
				avecAgent);
		WebServiceImpl.LOG.info("fichier demandé: {}", fichier);
		// On crée le fichier csv associé à la recherche
		if ("true".equals(fichier)) {
			final String applicationName = WebServiceImpl.extractCertName(header);
			final File f = CsvFileWriter.writePseudoGradeCsvFile(applicationName, listPseudoGrade);
			if (f == null) {
				WebServiceImpl.LOG.warn("SERVER ERROR : Erreur lors de la génération du fichier csv");
				final ErrorResponse error = new ErrorResponse("500", "Erreur interne du serveur");
				return Response.status(Response.Status.INTERNAL_SERVER_ERROR).entity(error).build();
			}
			WebServiceImpl.LOG.info("STATUS 200 : Résultat du web service obtenu avec succès({} éléments)",
					listPseudoGrade.size());
			return Response.ok("Fichier créé : " + f.getPath()).build();
		}

		WebServiceImpl.testResultat(listPseudoGrade, err);
		if (err.getStatus() != Response.Status.OK) {
			return Response.status(err.getStatus()).type(MediaType.APPLICATION_JSON_TYPE).entity(err)
					.build();
		} else {
			return WebServiceImpl.getResponse(listPseudoGrade);
		}
	}
}

```

</details>


---

### 📄 `src/main/java/ze/quotite/Quotite.java` [4.738 octets]
<a id="src-main-java-ze-quotite-Quotite-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-quotite-Quotite-java)

> **Chemin relatif** : `src/main/java/ze/quotite/Quotite.java`  
> **Taille** : 4.738 octets  
> **Lignes** : 174  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (174 lignes) - Cliquer pour déplier</summary>

```java
package ze.quotite;

import javax.xml.bind.annotation.XmlRootElement;
import javax.xml.bind.annotation.XmlType;

import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;

@XmlRootElement(name = "Quotite")
@XmlType(
		name = "",
		propOrder = { "quotiteMatricule", "quotiteNom", "quotitePrenom", "quotiteTravail", "quotiteModaliteService",
				"quotiteService",
				"quotitePourcHeurePresenceTempsPlein", "quotiteNumerateurRemuneration",
				"quotiteDenominateurRemuneration", "quotiteDateEffetQuotiteTravail",
				"quotiteDateEffetQuotiteTravail", "quotiteTemoinSurcotisation", "quotiteTemoinValidite" })
@JsonInclude(JsonInclude.Include.NON_DEFAULT)
public class Quotite {

	private String quotiteMatricule;

	private String erreur;

	private String quotiteNom;

	private String quotitePrenom;

	private String quotiteTravail;

	private String quotiteModaliteService;

	private String quotiteService;

	private String quotitePourcHeurePresenceTempsPlein;

	private String quotiteNumerateurRemuneration;

	private String quotiteDenominateurRemuneration;

	private String quotiteDateEffetQuotiteTravail;

	private String quotiteDateFinQuotiteTravail;

	private String quotiteTemoinSurcotisation;

	private String quotiteTemoinValidite;

	@JsonProperty("quotite_matricule")
	public String getQuotiteMatricule() {
		return quotiteMatricule;
	}

	public void setQuotiteMatricule(String quotiteMatricule) {
		this.quotiteMatricule = quotiteMatricule;
	}

	public String getErreur() {
		return erreur;
	}

	public void setErreur(String erreur) {
		this.erreur = erreur;
	}

	@JsonProperty("quotite_nom")
	public String getQuotiteNom() {
		return quotiteNom;
	}

	public void setQuotiteNom(String nom) {
		this.quotiteNom = nom;
	}

	@JsonProperty("quotite_prenom")
	public String getQuotitePrenom() {
		return quotitePrenom;
	}

	public void setQuotitePrenom(String prenom) {
		this.quotitePrenom = prenom;
	}

	@JsonProperty("quotite_travail")
	public String getQuotiteTravail() {
		return quotiteTravail;
	}

	public void setQuotiteTravail(String quotiteTravail) {
		this.quotiteTravail = quotiteTravail;
	}

	@JsonProperty("quotite_modalite_service")
	public String getQuotiteModaliteService() {
		return quotiteModaliteService;
	}

	public void setQuotiteModaliteService(String quotiteModaliteService) {
		this.quotiteModaliteService = quotiteModaliteService;
	}

	@JsonProperty("quotite_service")
	public String getQuotiteService() {
		return quotiteService;
	}

	public void setQuotiteService(String quotiteService) {
		this.quotiteService = quotiteService;
	}

	@JsonProperty("quotite_pourc_H_de_presence_sur_temps_plein ")
	public String getQuotitePourcHeurePresenceTempsPlein() {
		return quotitePourcHeurePresenceTempsPlein;
	}

	public void setQuotitePourcHeurePresenceTempsPlein(String quotitePourcHeurePresenceTempsPlein) {
		this.quotitePourcHeurePresenceTempsPlein = quotitePourcHeurePresenceTempsPlein;
	}

	@JsonProperty("quotite_numerateur_fraction_remuneration")
	public String getQuotiteNumerateurRemuneration() {
		return quotiteNumerateurRemuneration;
	}

	public void setQuotiteNumerateurRemuneration(String quotiteNumerateurRemuneration) {
		this.quotiteNumerateurRemuneration = quotiteNumerateurRemuneration;
	}

	@JsonProperty("quotite_denominateur_fraction_remuneration")
	public String getQuotiteDenominateurRemuneration() {
		return quotiteDenominateurRemuneration;
	}

	public void setQuotiteDenominateurRemuneration(String quotiteDenominateurRemuneration) {
		this.quotiteDenominateurRemuneration = quotiteDenominateurRemuneration;
	}

	@JsonProperty("quotite_effet_travail")
	public String getQuotiteDateEffetQuotiteTravail() {
		return quotiteDateEffetQuotiteTravail;
	}

	public void setQuotiteDateEffetQuotiteTravail(String quotiteDateEffetQuotiteTravail) {
		this.quotiteDateEffetQuotiteTravail = quotiteDateEffetQuotiteTravail;
	}

	@JsonProperty("quotite_fin_travail")
	public String getQuotiteDateFinQuotiteTravail() {
		return quotiteDateFinQuotiteTravail;
	}

	public void setQuotiteDateFinQuotiteTravail(String quotiteDateFinQuotiteTravail) {
		this.quotiteDateFinQuotiteTravail = quotiteDateFinQuotiteTravail;
	}

	@JsonProperty("quotite_temoin_surcotisation")
	public String getQuotiteTemoinSurcotisation() {
		return quotiteTemoinSurcotisation;
	}

	public void setQuotiteTemoinSurcotisation(String quotiteTemoinSurcotisation) {
		this.quotiteTemoinSurcotisation = quotiteTemoinSurcotisation;
	}

	@JsonProperty("quotite_temoin_validite")
	public String getQuotiteTemoinValidite() {
		return quotiteTemoinValidite;
	}

	public void setQuotiteTemoinValidite(String quotiteTemoinValidite) {
		this.quotiteTemoinValidite = quotiteTemoinValidite;
	}

}

```

</details>


---

### 📄 `src/main/java/ze/quotite/QuotiteDAO.java` [5.419 octets]
<a id="src-main-java-ze-quotite-QuotiteDAO-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-quotite-QuotiteDAO-java)

> **Chemin relatif** : `src/main/java/ze/quotite/QuotiteDAO.java`  
> **Taille** : 5.419 octets  
> **Lignes** : 149  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (149 lignes) - Cliquer pour déplier</summary>

```java
package ze.quotite;

import java.sql.Array;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;
import java.util.regex.Pattern;

import org.apache.commons.lang3.StringUtils;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import ze.agent.AgentDAO;
import ze.database.utils.DataBase;
import ze.impl.Utils;
import ze.remuneration.RemunerationDAO;

public class QuotiteDAO {

	private static final Utils UTILS = new Utils();

	private static final Pattern SPLIT_ID_PATTERN = Pattern.compile("[()']");

	private static final Logger LOG = LoggerFactory.getLogger(QuotiteDAO.class);

	/*
	 * Récupère la liste des quotites associées aux paramètres de recherches fournis
	 */
	public List<Quotite> getList(String recherche, String matricule, String exportDateEffetBorne, String temoinValide) {

		StringBuilder req = new StringBuilder();
		req.append(" SELECT quotite_matricule, agent_nom_usuel, agent_prenom")
				.append(", quotite_travail, quotite_modalite_service, quotite_service ")
				.append(", quotite_pourc_heure_presence_tmp_plein, quotite_numerateur_remuneration, quotite_denominateur_remuneration ")
				.append(", quotite_effet_travail, quotite_fin_travail, quotite_temoin_surcotisation, quotite_temoin_validite ")
				.append(" FROM quotite")
				.append(" INNER JOIN agent ON quotite_matricule = agent_matricule_renoirh")
				.append(" WHERE");

		// Prise en compte du champ recherche
		String rechercheNormalized;
		String[] rechercheNormalizedSplit = { "" };
		if (recherche != null) {
			// On retire les accents et on met en minuscule le texte de recherche
			rechercheNormalized = StringUtils.stripAccents(recherche.toLowerCase());
			rechercheNormalizedSplit = rechercheNormalized.split(" ");
		}
		int rechercheLength = rechercheNormalizedSplit.length;
		Connection cnx = null;
		try {
			cnx = DriverManager.getConnection(UTILS.getUrl(), UTILS.getUser(),
					UTILS.getPassword());
			req.append("(")
					.append(DataBase.getGoogleQuery(cnx, "quotite", rechercheNormalizedSplit))
					.append(")");
		} catch (final SQLException e) {
			UTILS.erreurAccesBase(e);
		} catch (final Exception e) {
			UTILS.erreurInnatendue(e);
		} finally {
			UTILS.closeConnexion(null, null, cnx);
		}

		// Prise en compte du champ matricule
		if (matricule != null) {
			req.append(" AND quotite_matricule = ANY(?)");
		}

		// Prise en compte du champ exportDateEffetBorne
		if (exportDateEffetBorne != null) {
			req.append(" AND (to_char(quotite_effet_travail, 'YYYYMMDD') >= ?");
			req.append(" OR to_char(quotite_fin_travail, 'YYYYMMDD') >= ?");
			req.append(" OR to_char(quotite_fin_travail, 'YYYYMMDD') = '00010101')");
		}

		// Prise en compte du champ temoinValide
		if (temoinValide != null) {
			req.append(" AND quotite_temoin_validite = ?");
		}

		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		ArrayList<Quotite> listAgent = new ArrayList<>();
		try {
			con = DriverManager.getConnection(UTILS.getUrl(), UTILS.getUser(), UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			int j = 0;

			if (matricule != null) {
				j++;
				Array a = con.createArrayOf("text", SPLIT_ID_PATTERN.matcher(matricule).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (exportDateEffetBorne != null) {
				j++;
				st.setString(j, exportDateEffetBorne);
				j++;
				st.setString(j, exportDateEffetBorne);
			}
			if (temoinValide != null) {
				j++;
				st.setString(j, temoinValide);
			}
			LOG.info("{}", st.toString());
			rs = st.executeQuery();
			while (rs.next()) {
				listAgent.add(processRow(rs));
			}
			return listAgent;
		} catch (SQLException e) {
			UTILS.erreurAccesBase(e);
		} catch (Exception e) {
			UTILS.erreurInnatendue(e);
		} finally {
			UTILS.closeConnexion(rs, st, con);
		}
		return listAgent;
	}

	/*
	 * Récupère un quotite complet
	 */
	protected Quotite processRow(ResultSet rs) throws SQLException {
		Quotite quotite = new Quotite();
		quotite.setQuotiteMatricule(rs.getString(QuotiteEnum.QUOTITE_MATRICULE.toString()));
		quotite.setQuotiteNom(rs.getString(QuotiteEnum.AGENT_NOM_USUEL.toString()));
		quotite.setQuotitePrenom(rs.getString(QuotiteEnum.AGENT_PRENOM.toString()));
		quotite.setQuotiteTravail(rs.getString(QuotiteEnum.QUOTITE_TRAVAIL.toString()));
		quotite.setQuotiteModaliteService(rs.getString(QuotiteEnum.QUOTITE_MODALITE_SERVICE.toString()));
		quotite.setQuotiteService(rs.getString(QuotiteEnum.QUOTITE_SERVICE.toString()));
		quotite.setQuotitePourcHeurePresenceTempsPlein(
				rs.getString(QuotiteEnum.QUOTITE_POURC_HEURE_PRESENCE_TMP_PLEIN.toString()));
		quotite.setQuotiteNumerateurRemuneration(rs.getString(QuotiteEnum.QUOTITE_NUMERATEUR_REMUNERATION.toString()));
		quotite.setQuotiteDenominateurRemuneration(
				rs.getString(QuotiteEnum.QUOTITE_DENOMINATEUR_REMUNERATION.toString()));
		quotite.setQuotiteDateEffetQuotiteTravail(rs.getString(QuotiteEnum.QUOTITE_EFFET_TRAVAIL.toString()));
		quotite.setQuotiteDateFinQuotiteTravail(rs.getString(QuotiteEnum.QUOTITE_FIN_TRAVAIL.toString()));
		quotite.setQuotiteTemoinSurcotisation(rs.getString(QuotiteEnum.QUOTITE_TEMOIN_SURCOTISATION.toString()));
		quotite.setQuotiteTemoinValidite(rs.getString(QuotiteEnum.QUOTITE_TEMOIN_VALIDITE.toString()));
		return quotite;
	}

}

```

</details>


---

### 📄 `src/main/java/ze/quotite/QuotiteEnum.java` [378 octets]
<a id="src-main-java-ze-quotite-QuotiteEnum-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-quotite-QuotiteEnum-java)

> **Chemin relatif** : `src/main/java/ze/quotite/QuotiteEnum.java`  
> **Taille** : 378 octets  
> **Lignes** : 18  
> **Type** : java

```java
package ze.quotite;

public enum QuotiteEnum {
	QUOTITE_MATRICULE,
	AGENT_NOM_USUEL,
	AGENT_PRENOM,
	QUOTITE_TRAVAIL,
	QUOTITE_MODALITE_SERVICE,
	QUOTITE_SERVICE,
	QUOTITE_POURC_HEURE_PRESENCE_TMP_PLEIN,
	QUOTITE_NUMERATEUR_REMUNERATION,
	QUOTITE_DENOMINATEUR_REMUNERATION,
	QUOTITE_EFFET_TRAVAIL,
	QUOTITE_FIN_TRAVAIL,
	QUOTITE_TEMOIN_SURCOTISATION,
	QUOTITE_TEMOIN_VALIDITE
}

```


---

### 📄 `src/main/java/ze/reglementaire/Contractuel.java` [5.009 octets]
<a id="src-main-java-ze-reglementaire-Contractuel-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-reglementaire-Contractuel-java)

> **Chemin relatif** : `src/main/java/ze/reglementaire/Contractuel.java`  
> **Taille** : 5.009 octets  
> **Lignes** : 145  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (145 lignes) - Cliquer pour déplier</summary>

```java
package ze.reglementaire;

import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;

@JsonInclude(JsonInclude.Include.NON_NULL)
public class Contractuel {

	private String reglementaireCodePseudoGrade;

	private String reglementairePseudoGradeLibelle;

	private String reglementairePseudoGradeLibelleAgrege;

	private String reglementairePseudoGradeLibelleComplementaire;

	private String reglementairePseudoGradeDateDebutValidite;

	private String reglementairePseudoGradeDateFinValidite;

	private Boolean reglementairePseudoGradeOuvert;

	private Boolean reglementairePseudoGradeAvecAgents;

	private String reglementairePseudoGradeNbAgents;

	private String reglementairePseudoGradeNbAgentsMasculins;

	private String reglementairePseudoGradeNbAgentsFeminins;

	private String erreur;

	@JsonProperty("reglementaire_code_pseudo_grade")
	public String getReglementaireCodePseudoGrade() {
		return this.reglementaireCodePseudoGrade;
	}

	public void setReglementaireCodePseudoGrade(String reglementaireCodePseudoGrade) {
		this.reglementaireCodePseudoGrade = reglementaireCodePseudoGrade;
	}

	@JsonProperty("reglementaire_pseudo_grade_libelle_long")
	public String getReglementairePseudoGradeLibelle() {
		return this.reglementairePseudoGradeLibelle;
	}

	public void setReglementaireCodePseudoGradeLibelle(String reglementairePseudoGradeLibelle) {
		this.reglementairePseudoGradeLibelle = reglementairePseudoGradeLibelle;
	}

	@JsonProperty("reglementaire_pseudo_grade_libelle_agrege")
	public String getReglementaireCodePseudoGradeLibelleAgrege() {
		return this.reglementairePseudoGradeLibelleAgrege;
	}

	public void setReglementairePseudoGradeLibelleAgrege(String reglementairePseudoGradeLibelleAgrege) {
		this.reglementairePseudoGradeLibelleAgrege = reglementairePseudoGradeLibelleAgrege;
	}

	@JsonProperty("reglementaire_pseudo_grade_libelle_complementaire")
	public String getReglementaireCodePseudoGradeLibelleComplementaire() {
		return this.reglementairePseudoGradeLibelleComplementaire;
	}

	public void
			setReglementairePseudoGradeLibelleComplementaire(
					String reglementairePseudoGradeLibelleComplementaire) {
		this.reglementairePseudoGradeLibelleComplementaire = reglementairePseudoGradeLibelleComplementaire;
	}

	@JsonProperty("reglementaire_pseudo_grade_date_debut_validite")
	public String getReglementairePseudoGradeDateDebutValidite() {
		return this.reglementairePseudoGradeDateDebutValidite;
	}

	public void
			setReglementairePseudoGradeDateDebutValidite(String reglementairePseudoGradeDateDebutValidite) {
		this.reglementairePseudoGradeDateDebutValidite = reglementairePseudoGradeDateDebutValidite;
	}

	@JsonProperty("reglementaire_pseudo_grades_date_fin_validite")
	public String getReglementairePseudoGradeDateFinValidite() {
		return this.reglementairePseudoGradeDateFinValidite;
	}

	public void setReglementairePseudoGradeDateFinValidite(String reglementairePseudoGradeDateFinValidite) {
		this.reglementairePseudoGradeDateFinValidite = reglementairePseudoGradeDateFinValidite;
	}

	@JsonProperty("reglementaire_code_pseudo_grades_ouvert")
	public Boolean getReglementairePseudoGradeOuvert() {
		return this.reglementairePseudoGradeOuvert;
	}

	public void setReglementairePseudoGradeOuvert(Boolean reglementairePseudoGradeOuvert) {
		this.reglementairePseudoGradeOuvert = reglementairePseudoGradeOuvert;
	}

	@JsonProperty("reglementaire_pseudo_grades_avec_agents")
	public Boolean getReglementairePseudoGradeAvecAgents() {
		return this.reglementairePseudoGradeAvecAgents;
	}

	public void setReglementairePseudoGradeAvecAgents(Boolean reglementairePseudoGradeAvecAgents) {
		this.reglementairePseudoGradeAvecAgents = reglementairePseudoGradeAvecAgents;
	}

	@JsonProperty("reglementaire_pseudo_grades_nb_agents")
	public String getReglementairePseudoGradeNbAgents() {
		return this.reglementairePseudoGradeNbAgents;
	}

	public void setReglementairePseudoGradeNbAgents(String reglementairePseudoGradeNbAgents) {
		this.reglementairePseudoGradeNbAgents = reglementairePseudoGradeNbAgents;
	}

	@JsonProperty("reglementaire_pseudo_grades_nb_agents_masculins")
	public String getReglementairePseudoGradeNbAgentsMasculins() {
		return this.reglementairePseudoGradeNbAgentsMasculins;
	}

	public void
			setReglementairePseudoGradeNbAgentsMasculins(String reglementairePseudoGradeNbAgentsMasculins) {
		this.reglementairePseudoGradeNbAgentsMasculins = reglementairePseudoGradeNbAgentsMasculins;
	}

	@JsonProperty("reglementaire_pseudo_grades_nb_agents_feminins")
	public String getReglementairePseudoGradeNbAgentsFeminins() {
		return this.reglementairePseudoGradeNbAgentsFeminins;
	}

	public void setReglementairePseudoGradeNbAgentsFeminins(String reglementairePseudoGradeNbAgentsFeminins) {
		this.reglementairePseudoGradeNbAgentsFeminins = reglementairePseudoGradeNbAgentsFeminins;
	}

	public String getErreur() {
		return this.erreur;
	}

	public void setErreur(String erreur) {
		this.erreur = erreur;
	}

}

```

</details>


---

### 📄 `src/main/java/ze/reglementaire/ContractuelDAO.java` [7.008 octets]
<a id="src-main-java-ze-reglementaire-ContractuelDAO-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-reglementaire-ContractuelDAO-java)

> **Chemin relatif** : `src/main/java/ze/reglementaire/ContractuelDAO.java`  
> **Taille** : 7.008 octets  
> **Lignes** : 193  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (193 lignes) - Cliquer pour déplier</summary>

```java
package ze.reglementaire;

import java.sql.Array;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.text.ParseException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.regex.Pattern;

import org.apache.commons.lang3.StringUtils;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import ze.database.utils.DataBase;
import ze.impl.Utils;

public class ContractuelDAO {

	private static final Utils UTILS = new Utils();

	private static final Pattern SPLIT_ID_PATTERN = Pattern.compile("[()']");

	private static final Logger LOG = LoggerFactory.getLogger(ContractuelDAO.class);

	/*
	 * Récupère les informations des grades avec une liste id
	 */
	public List<Contractuel> getGradeById(String idContractuel) {

		final StringBuilder req = new StringBuilder();

		req.append(
				"SELECT * FROM CONTRACTUEL WHERE reglementaire_code_pseudo_grade = ANY(?)");

		final List<Contractuel> listContractuel = new ArrayList<>();
		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		try {
			con = DriverManager.getConnection(ContractuelDAO.UTILS.getUrl(), ContractuelDAO.UTILS.getUser(),
					ContractuelDAO.UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			final String[] idPseudoGrade = ContractuelDAO.SPLIT_ID_PATTERN.matcher(idContractuel).replaceAll("")
					.split(",");
			final Array a = con.createArrayOf("text", idPseudoGrade);
			st.setArray(1, a);
			ContractuelDAO.LOG.info("Liste de pseudo-grades par id: {}", st);
			rs = st.executeQuery();
			final List<String> listIdPseudoGra = new ArrayList<>(Arrays.asList(idPseudoGrade));
			while (rs.next()) {
				listContractuel.add(this.processContractuel(rs));
				final String PseudoGraID = rs.getString(ContractuelEnum.REGLEMENTAIRE_CODE_PSEUDO_GRADE.toString());
				listIdPseudoGra.remove(PseudoGraID);
			}
			for (final String s : listIdPseudoGra) {
				final Contractuel c = new Contractuel();
				c.setReglementaireCodePseudoGrade(s);
				c.setErreur("404 : Pseudo-Grade non trouvé");
				listContractuel.add(c);
			}
			return listContractuel;
		} catch (final SQLException e) {
			ContractuelDAO.UTILS.erreurAccesBase(e);
		} catch (final Exception e) {
			ContractuelDAO.UTILS.erreurInnatendue(e);
		} finally {
			ContractuelDAO.UTILS.closeConnexion(rs, st, con);
		}
		return listContractuel;
	}

	/*
	 * Récupère la liste de grades associées aux paramètres de recherches fournis
	 */
	public List<Contractuel> getPseudoGradeList(String recherche, String corps, String ouvert, String avecAgent) {

		final List<Contractuel> listGrade = new ArrayList<>();

		final StringBuilder req = new StringBuilder();
		req.append("SELECT * FROM CONTRACTUEL WHERE 1=1 ");

		// Prise en compte du champ recherche
		String rechercheNormalized;
		String[] rechercheNormalizedSplit = { "" };
		if (recherche != null) {
			// On retire les accents et on met en minuscule le texte de recherche
			rechercheNormalized = StringUtils.stripAccents(recherche.toLowerCase());
			rechercheNormalizedSplit = rechercheNormalized.split(" ");
		}

		Connection cnx = null;
		try {
			if (recherche != null) {
				cnx = DriverManager.getConnection(ContractuelDAO.UTILS.getUrl(), ContractuelDAO.UTILS.getUser(),
						ContractuelDAO.UTILS.getPassword());
				final String subQuery = DataBase.getGoogleQuery(cnx, "CONTRACTUEL", rechercheNormalizedSplit);
				req.append(" AND ")
						.append(subQuery);
			}
		} catch (final Exception e) {
			ContractuelDAO.LOG.warn("erreur de lancement de la recherche");
		} finally {
			ContractuelDAO.UTILS.closeConnexion(null, null, cnx);
		}

		if (corps != null) {
			req.append(" AND reglementaire_code_pseudo_grade = ANY(?)");
		}

		// Prise en compte du champ actif
		if (ouvert != null) {
			final boolean isOuvert = Boolean.parseBoolean(ouvert);
			req.append(" AND reglementaire_pseudo_grade_ouvert = ")
					.append(isOuvert);
		}

		// Prise en compte du champ avecAgent
		if (avecAgent != null) {
			final boolean withAgent = Boolean.parseBoolean(avecAgent);
			req.append(" AND reglementaire_pseudo_grade_avec_agents = ")
					.append(withAgent);

		}

		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		try {
			con = DriverManager.getConnection(ContractuelDAO.UTILS.getUrl(), ContractuelDAO.UTILS.getUser(),
					ContractuelDAO.UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			int j = 0;
			if (corps != null) {
				j++;
				final Array a = con.createArrayOf("text",
						ContractuelDAO.SPLIT_ID_PATTERN.matcher(corps).replaceAll("").split(","));
				st.setArray(j, a);
			}
			ContractuelDAO.LOG.info("SQL:{}", st);
			rs = st.executeQuery();
			while (rs.next()) {
				listGrade.add(this.processContractuel(rs));
			}
			ContractuelDAO.LOG.info("Liste de pseudo-grades par id: {} ", st);
			return listGrade;
		} catch (final SQLException e) {
			ContractuelDAO.UTILS.erreurAccesBase(e);
		} catch (final Exception e) {
			ContractuelDAO.UTILS.erreurInnatendue(e);
		} finally {
			ContractuelDAO.UTILS.closeConnexion(rs, st, con);
		}
		return listGrade;
	}

	protected Contractuel processContractuel(ResultSet rs) throws SQLException, ParseException {
		final Contractuel contractuel = new Contractuel();
		contractuel.setReglementaireCodePseudoGrade(
				rs.getString(ContractuelEnum.REGLEMENTAIRE_CODE_PSEUDO_GRADE.toString()));
		contractuel
				.setReglementaireCodePseudoGradeLibelle(
						rs.getString(ContractuelEnum.REGLEMENTAIRE_PSEUDO_GRADE_LIBELLE_LONG.toString()));
		contractuel.setReglementairePseudoGradeLibelleAgrege(
				rs.getString(ContractuelEnum.REGLEMENTAIRE_PSEUDO_GRADE_LIBELLE_AGREGE.toString()));
		contractuel.setReglementairePseudoGradeLibelleComplementaire(
				rs.getString(ContractuelEnum.REGLEMENTAIRE_PSEUDO_GRADE_LIBELLE_COMPLEMENTAIRE.toString()));
		contractuel.setReglementairePseudoGradeDateDebutValidite(
				rs.getString(ContractuelEnum.REGLEMENTAIRE_PSEUDO_GRADE_DATE_DEBUT_VALIDITE.toString()));
		contractuel.setReglementairePseudoGradeDateFinValidite(
				rs.getString(ContractuelEnum.REGLEMENTAIRE_PSEUDO_GRADE_DATE_FIN_VALIDITE.toString()));
		contractuel.setReglementairePseudoGradeOuvert(
				rs.getBoolean(ContractuelEnum.REGLEMENTAIRE_PSEUDO_GRADE_OUVERT.toString()));
		contractuel
				.setReglementairePseudoGradeAvecAgents(
						rs.getBoolean(ContractuelEnum.REGLEMENTAIRE_PSEUDO_GRADE_AVEC_AGENTS.toString()));
		contractuel
				.setReglementairePseudoGradeNbAgents(
						rs.getString(ContractuelEnum.REGLEMENTAIRE_PSEUDO_GRADE_NB_AGENTS.toString()));
		contractuel.setReglementairePseudoGradeNbAgentsMasculins(
				rs.getString(ContractuelEnum.REGLEMENTAIRE_PSEUDO_GRADE_NB_AGENTS_MASCULINS.toString()));
		contractuel.setReglementairePseudoGradeNbAgentsFeminins(
				rs.getString(ContractuelEnum.REGLEMENTAIRE_PSEUDO_GRADE_NB_AGENTS_FEMININS.toString()));

		return contractuel;
	}

}

```

</details>


---

### 📄 `src/main/java/ze/reglementaire/ContractuelEnum.java` [540 octets]
<a id="src-main-java-ze-reglementaire-ContractuelEnum-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-reglementaire-ContractuelEnum-java)

> **Chemin relatif** : `src/main/java/ze/reglementaire/ContractuelEnum.java`  
> **Taille** : 540 octets  
> **Lignes** : 17  
> **Type** : java

```java
package ze.reglementaire;

public enum ContractuelEnum {
	REGLEMENTAIRE_CODE_PSEUDO_GRADE,
	REGLEMENTAIRE_PSEUDO_GRADE_LIBELLE_LONG,
	REGLEMENTAIRE_PSEUDO_GRADE_LIBELLE_AGREGE,
	REGLEMENTAIRE_PSEUDO_GRADE_LIBELLE_COMPLEMENTAIRE,
	REGLEMENTAIRE_PSEUDO_GRADE_DATE_DEBUT_VALIDITE,
	REGLEMENTAIRE_PSEUDO_GRADE_DATE_FIN_VALIDITE,
	REGLEMENTAIRE_PSEUDO_GRADE_OUVERT,
	REGLEMENTAIRE_PSEUDO_GRADE_AVEC_AGENTS,
	REGLEMENTAIRE_PSEUDO_GRADE_NB_AGENTS,
	REGLEMENTAIRE_PSEUDO_GRADE_NB_AGENTS_MASCULINS,
	REGLEMENTAIRE_PSEUDO_GRADE_NB_AGENTS_FEMININS

}

```


---

### 📄 `src/main/java/ze/reglementaire/Corps.java` [9.574 octets]
<a id="src-main-java-ze-reglementaire-Corps-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-reglementaire-Corps-java)

> **Chemin relatif** : `src/main/java/ze/reglementaire/Corps.java`  
> **Taille** : 9.574 octets  
> **Lignes** : 262  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (262 lignes) - Cliquer pour déplier</summary>

```java
package ze.reglementaire;

import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;

import javax.xml.bind.annotation.XmlRootElement;
import javax.xml.bind.annotation.XmlType;

@XmlRootElement(name = "Corps")
@XmlType(
		name = "",
		propOrder = { "reglementaireCodeCorps", "reglementaireCorpsLibelleLong",
				"reglementaireCorpsLibelleAgrege", "reglementaireCorpsLibelleComplementaire",
				"reglementaireCorpsDateDebutValidite", "reglementaireCorpsDateFinValidite", "reglementaireCorpsOuvert",
				"reglementaireCorpsAvecAgents", "reglementaireCorpsNbAgents", "reglementaireCorpsNbAgentsMasculins",
				"reglementaireCorpsNbAgentsFeminins",
				"reglementaireCorpsAccueilNbAgents", "reglementaireCorpsAccueilNbAgentsMasculins",
				"reglementaireCorpsAccueilNbAgentsFeminins",
				"reglementaireCorpsOrigineNbAgents", "reglementaireCorpsOrigineNbAgentsMasculins",
				"reglementaireCorpsOrigineNbAgentsFeminins",
				"reglementaireCorpsEmploisFonctionnelsNbAgents",
				"reglementaireCorpsEmploisFonctionnelsNbAgentsMasculins",
				"reglementaireCorpsEmploisFonctionnelsNbAgentsFeminins" })
@JsonInclude(JsonInclude.Include.NON_NULL)
public class Corps {

	//Corps
	private String reglementaireCodeCorps;

	private String reglementaireCorpsLibelleLong;

	private String reglementaireCorpsLibelleAgrege;

	private String reglementaireCorpsLibelleComplementaire;

	private String reglementaireCorpsDateDebutValidite;

	private String reglementaireCorpsDateFinValidite;

	private Boolean reglementaireCorpsOuvert;

	private Boolean reglementaireCorpsAvecAgents;

	private String reglementaireCorpsNbAgents;

	private String reglementaireCorpsNbAgentsMasculins;

	private String reglementaireCorpsNbAgentsFeminins;

	private String reglementaireCorpsAccueilNbAgents;

	private String reglementaireCorpsAccueilNbAgentsMasculins;

	private String reglementaireCorpsAccueilNbAgentsFeminins;

	private String reglementaireCorpsOrigineNbAgents;

	private String reglementaireCorpsOrigineNbAgentsMasculins;

	private String reglementaireCorpsOrigineNbAgentsFeminins;

	private String reglementaireCorpsEmploisFonctionnelsNbAgents;

	private String reglementaireCorpsEmploisFonctionnelsNbAgentsMasculins;

	private String reglementaireCorpsEmploisFonctionnelsNbAgentsFeminins;

	private String erreur;

	@JsonProperty("reglementaire_code_corps")
	public String getReglementaireCodeCorps() {
		return reglementaireCodeCorps;
	}

	public void setReglementaireCodeCorps(String reglementaireCodeCorps) {
		this.reglementaireCodeCorps = reglementaireCodeCorps;
	}

	@JsonProperty("reglementaire_corps_libelle_long")
	public String getReglementaireCorpsLibelleLong() {
		return reglementaireCorpsLibelleLong;
	}

	public void setReglementaireCorpsLibelleLong(String reglementaireCorpsLibelleLong) {
		this.reglementaireCorpsLibelleLong = reglementaireCorpsLibelleLong;
	}

	@JsonProperty("reglementaire_corps_libelle_agrege")
	public String getReglementaireCorpsLibelleAgrege() {
		return reglementaireCorpsLibelleAgrege;
	}

	public void setReglementaireCorpsLibelleAgrege(String reglementaireCorpsLibelleAgrege) {
		this.reglementaireCorpsLibelleAgrege = reglementaireCorpsLibelleAgrege;
	}

	@JsonProperty("reglementaire_corps_libelle_complementaire")
	public String getReglementaireCorpsLibelleComplementaire() {
		return reglementaireCorpsLibelleComplementaire;
	}

	public void setReglementaireCorpsLibelleComplementaire(String reglementaireCorpsLibelleComplementaire) {
		this.reglementaireCorpsLibelleComplementaire = reglementaireCorpsLibelleComplementaire;
	}

	@JsonProperty("reglementaire_corps_date_debut_validite")
	public String getReglementaireCorpsDateDebutValidite() {
		return reglementaireCorpsDateDebutValidite;
	}

	public void setReglementaireCorpsDateDebutValidite(String reglementaireCorpsDateDebutValidite) {
		this.reglementaireCorpsDateDebutValidite = reglementaireCorpsDateDebutValidite;
	}

	@JsonProperty("reglementaire_corps_date_fin_validite")
	public String getReglementaireCorpsDateFinValidite() {
		return reglementaireCorpsDateFinValidite;
	}

	public void setReglementaireCorpsDateFinValidite(String reglementaireCorpsDateFinValidite) {
		this.reglementaireCorpsDateFinValidite = reglementaireCorpsDateFinValidite;
	}

	@JsonProperty("reglementaire_corps_ouvert")
	public Boolean getReglementaireCorpsOuvert() {
		return reglementaireCorpsOuvert;
	}

	public void setReglementaireCorpsOuvert(Boolean reglementaireCorpsOuvert) {
		this.reglementaireCorpsOuvert = reglementaireCorpsOuvert;
	}

	@JsonProperty("reglementaire_corps_avec_agents")
	public Boolean getReglementaireCorpsAvecAgents() {
		return reglementaireCorpsAvecAgents;
	}

	public void setReglementaireCorpsAvecAgents(Boolean reglementaireCorpsAvecAgents) {
		this.reglementaireCorpsAvecAgents = reglementaireCorpsAvecAgents;
	}

	@JsonProperty("reglementaire_corps_nb_agents")
	public String getReglementaireCorpsNbAgents() {
		return reglementaireCorpsNbAgents;
	}

	public void setReglementaireCorpsNbAgents(String reglementaireCorpsNbAgents) {
		this.reglementaireCorpsNbAgents = reglementaireCorpsNbAgents;
	}

	@JsonProperty("reglementaire_corps_nb_agents_masculins")
	public String getReglementaireCorpsNbAgentsMasculins() {
		return reglementaireCorpsNbAgentsMasculins;
	}

	public void setReglementaireCorpsNbAgentsMasculins(String reglementaireCorpsNbAgentsMasculins) {
		this.reglementaireCorpsNbAgentsMasculins = reglementaireCorpsNbAgentsMasculins;
	}

	@JsonProperty("reglementaire_corps_nb_agents_feminins")
	public String getReglementaireCorpsNbAgentsFeminins() {
		return reglementaireCorpsNbAgentsFeminins;
	}

	public void setReglementaireCorpsNbAgentsFeminins(String reglementaireCorpsNbAgentsFeminins) {
		this.reglementaireCorpsNbAgentsFeminins = reglementaireCorpsNbAgentsFeminins;
	}

	@JsonProperty("reglementaire_corps_accueil_nb_agents")
	public String getReglementaireCorpsAccueilNbAgents() {
		return reglementaireCorpsAccueilNbAgents;
	}

	public void setReglementaireCorpsAccueilNbAgents(String reglementaireCorpsAccueilNbAgents) {
		this.reglementaireCorpsAccueilNbAgents = reglementaireCorpsAccueilNbAgents;
	}

	@JsonProperty("reglementaire_corps_accueil_nb_agents_masculins")
	public String getReglementaireCorpsAccueilNbAgentsMasculins() {
		return reglementaireCorpsAccueilNbAgentsMasculins;
	}

	public void setReglementaireCorpsAccueilNbAgentsMasculins(String reglementaireCorpsAccueilNbAgentsMasculins) {
		this.reglementaireCorpsAccueilNbAgentsMasculins = reglementaireCorpsAccueilNbAgentsMasculins;
	}

	@JsonProperty("reglementaire_corps_accueil_nb_agents_feminins")
	public String getReglementaireCorpsAccueilNbAgentsFeminins() {
		return reglementaireCorpsAccueilNbAgentsFeminins;
	}

	public void setReglementaireCorpsAccueilNbAgentsFeminins(String reglementaireCorpsAccueilNbAgentsFeminins) {
		this.reglementaireCorpsAccueilNbAgentsFeminins = reglementaireCorpsAccueilNbAgentsFeminins;
	}

	@JsonProperty("reglementaire_corps_origine_nb_agents")
	public String getReglementaireCorpsOrigineNbAgents() {
		return reglementaireCorpsOrigineNbAgents;
	}

	public void setReglementaireCorpsOrigineNbAgents(String reglementaireCorpsOrigineNbAgents) {
		this.reglementaireCorpsOrigineNbAgents = reglementaireCorpsOrigineNbAgents;
	}

	@JsonProperty("reglementaire_corps_origine_nb_agents_masculins")
	public String getReglementaireCorpsOrigineNbAgentsMasculins() {
		return reglementaireCorpsOrigineNbAgentsMasculins;
	}

	public void setReglementaireCorpsOrigineNbAgentsMasculins(String reglementaireCorpsOrigineNbAgentsMasculins) {
		this.reglementaireCorpsOrigineNbAgentsMasculins = reglementaireCorpsOrigineNbAgentsMasculins;
	}

	@JsonProperty("reglementaire_corps_origine_nb_agents_feminins")
	public String getReglementaireCorpsOrigineNbAgentsFeminins() {
		return reglementaireCorpsOrigineNbAgentsFeminins;
	}

	public void setReglementaireCorpsOrigineNbAgentsFeminins(String reglementaireCorpsOrigineNbAgentsFeminins) {
		this.reglementaireCorpsOrigineNbAgentsFeminins = reglementaireCorpsOrigineNbAgentsFeminins;
	}

	@JsonProperty("reglementaire_corps_emplois_fonctionnels_nb_agents")
	public String getReglementaireCorpsEmploisFonctionnelsNbAgents() {
		return reglementaireCorpsEmploisFonctionnelsNbAgents;
	}

	public void setReglementaireCorpsEmploisFonctionnelsNbAgents(String reglementaireCorpsFonctionnelNbAgents) {
		this.reglementaireCorpsEmploisFonctionnelsNbAgents = reglementaireCorpsFonctionnelNbAgents;
	}

	@JsonProperty("reglementaire_corps_emplois_fonctionnels_nb_agents_masculins")
	public String getReglementaireCorpsEmploisFonctionnelsNbAgentsMasculins() {
		return reglementaireCorpsEmploisFonctionnelsNbAgentsMasculins;
	}

	public void
			setReglementaireCorpsEmploisFonctionnelsNbAgentsMasculins(
					String reglementaireCorpsFonctionnelNbAgentsMasculins) {
		this.reglementaireCorpsEmploisFonctionnelsNbAgentsMasculins = reglementaireCorpsFonctionnelNbAgentsMasculins;
	}

	@JsonProperty("reglementaire_corps_emplois_fonctionnels_nb_agents_feminins")
	public String getReglementaireCorpsEmploisFonctionnelsNbAgentsFeminins() {
		return reglementaireCorpsEmploisFonctionnelsNbAgentsFeminins;
	}

	public void setReglementaireCorpsEmploisFonctionnelsNbAgentsFeminins(
			String reglementaireCorpsFonctionnelNbAgentsFeminins) {
		this.reglementaireCorpsEmploisFonctionnelsNbAgentsFeminins = reglementaireCorpsFonctionnelNbAgentsFeminins;
	}

	public String getErreur() {
		return erreur;
	}

	public void setErreur(String erreur) {
		this.erreur = erreur;
	}

}

```

</details>


---

### 📄 `src/main/java/ze/reglementaire/CorpsDAO.java` [7.711 octets]
<a id="src-main-java-ze-reglementaire-CorpsDAO-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-reglementaire-CorpsDAO-java)

> **Chemin relatif** : `src/main/java/ze/reglementaire/CorpsDAO.java`  
> **Taille** : 7.711 octets  
> **Lignes** : 208  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (208 lignes) - Cliquer pour déplier</summary>

```java
package ze.reglementaire;

import java.sql.Array;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.text.ParseException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.regex.Pattern;

import org.apache.commons.lang3.StringUtils;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import ze.database.utils.DataBase;
import ze.impl.Utils;

public class CorpsDAO {

	private static final Utils UTILS = new Utils();

	private static final Pattern SPLIT_ID_PATTERN = Pattern.compile("[()']");

	private static final Logger LOG = LoggerFactory.getLogger(CorpsDAO.class);

	/*
	 * Récupère les informations des corps avec une liste id
	 */
	public List<Corps> getCorpsById(String idCorps) {

		final StringBuilder req = new StringBuilder();

		req.append("SELECT * FROM CORPS WHERE reglementaire_code_corps = ANY(?) ");

		final List<Corps> listCorps = new ArrayList<>();
		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		try {
			con = DriverManager.getConnection(CorpsDAO.UTILS.getUrl(), CorpsDAO.UTILS.getUser(),
					CorpsDAO.UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			final String[] idCor = CorpsDAO.SPLIT_ID_PATTERN.matcher(idCorps).replaceAll("").split(",");
			final Array a = con.createArrayOf("text", idCor);
			st.setArray(1, a);
			rs = st.executeQuery();
			final ArrayList<String> listIdCor = new ArrayList<>(Arrays.asList(idCor));
			while (rs.next()) {
				listCorps.add(this.processCorps(rs));
				final String corID = rs.getString(CorpsEnum.REGLEMENTAIRE_CODE_CORPS.toString());
				listIdCor.remove(corID);
			}
			for (final String s : listIdCor) {
				final Corps corps = new Corps();
				corps.setReglementaireCodeCorps(s);
				corps.setErreur("404 : Corps non trouvé");
				listCorps.add(corps);
			}
		} catch (final SQLException e) {
			CorpsDAO.UTILS.erreurAccesBase(e);
		} catch (final Exception e) {
			CorpsDAO.UTILS.erreurInnatendue(e);
		} finally {
			CorpsDAO.UTILS.closeConnexion(rs, st, con);
		}
		return listCorps;
	}

	/**
	 * Récupère la liste des corps associées aux paramètres de
	 * recherches fournis
	 *
	 * @param recherche
	 * @param corps codes des corps à retourner
	 * @param ouvert si on doit retourner les corps ouvert on non-ouvert. sinon tous
	 * @param avecAgent
	 * @return
	 */
	public List<Corps> getCorpsList(String recherche, String corps, String ouvert,
			String avecAgent, String fichier) {

		final List<Corps> list = new ArrayList<>();

		final StringBuilder req = new StringBuilder();
		req.append("SELECT * FROM CORPS WHERE 1=1 ");

		// Prise en compte du champ recherche
		String rechercheNormalized;
		String[] rechercheNormalizedSplit = { "" };

		if (recherche != null) {
			// On retire les accents et on met en minuscule le texte de recherche
			rechercheNormalized = StringUtils.stripAccents(recherche.toLowerCase());
			rechercheNormalizedSplit = rechercheNormalized.split(" ");
		}
		Connection cnx = null;
		try {
			if (recherche != null) {
				cnx = DriverManager.getConnection(CorpsDAO.UTILS.getUrl(), CorpsDAO.UTILS.getUser(),
						CorpsDAO.UTILS.getPassword());
				final String subQuery = DataBase.getGoogleQuery(cnx, "CORPS", rechercheNormalizedSplit);
				req.append(" AND ").append(subQuery);
			}
		} catch (final Exception e) {
			LOG.warn("erreur de lancement de la recherche");
		} finally {
			CorpsDAO.UTILS.closeConnexion(null, null, cnx);
		}

		// Prise en compte du champ corps
		if (corps != null) {
			req.append(" AND reglementaire_code_corps = ANY(?)");
		}

		// Prise en compte du champ actif
		if (ouvert != null) {
			final boolean isOuvert = Boolean.parseBoolean(ouvert);
			req.append(" AND reglementaire_corps_ouvert = ").append(isOuvert);
		}

		// Prise en compte du champ avecAgent
		if (avecAgent != null) {
			final boolean withAgent = Boolean.parseBoolean(avecAgent);
			req.append(" AND reglementaire_corps_avec_agents=")
					.append(withAgent);

		}

		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		try {
			con = DriverManager.getConnection(CorpsDAO.UTILS.getUrl(), CorpsDAO.UTILS.getUser(),
					CorpsDAO.UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			int j = 0;
			if (corps != null) {
				j++;
				final Array a = con.createArrayOf("text",
						CorpsDAO.SPLIT_ID_PATTERN.matcher(corps).replaceAll("").split(","));
				st.setArray(j, a);
			}
			LOG.info("Liste de corps: {}", st);
			rs = st.executeQuery();
			while (rs.next()) {
				final Corps c = this.processCorps(rs);
				list.add(c);
			}
			return list;
		} catch (final SQLException e) {
			CorpsDAO.UTILS.erreurAccesBase(e);
		} catch (final Exception e) {
			CorpsDAO.UTILS.erreurInnatendue(e);
		} finally {
			CorpsDAO.UTILS.closeConnexion(rs, st, con);
		}
		return list;
	}

	/*
	 * Récupère le corps
	 */
	protected Corps processCorps(ResultSet rs) throws SQLException, ParseException {
		final Corps corps = new Corps();
		corps.setReglementaireCodeCorps(rs.getString(CorpsEnum.REGLEMENTAIRE_CODE_CORPS.toString()));

		corps.setReglementaireCorpsLibelleLong(rs.getString(CorpsEnum.REGLEMENTAIRE_CORPS_LIBELLE_LONG.toString()));
		corps.setReglementaireCorpsLibelleAgrege(rs.getString(CorpsEnum.REGLEMENTAIRE_CORPS_LIBELLE_AGREGE.toString()));
		corps.setReglementaireCorpsLibelleComplementaire(
				rs.getString(CorpsEnum.REGLEMENTAIRE_CORPS_LIBELLE_COMPLEMENTAIRE.toString()));
		corps.setReglementaireCorpsDateDebutValidite(
				rs.getString(CorpsEnum.REGLEMENTAIRE_CORPS_DATE_DEBUT_VALIDITE.toString()));
		corps.setReglementaireCorpsDateFinValidite(
				rs.getString(CorpsEnum.REGLEMENTAIRE_CORPS_DATE_FIN_VALIDITE.toString()));
		corps.setReglementaireCorpsOuvert(rs.getBoolean(CorpsEnum.REGLEMENTAIRE_CORPS_OUVERT.toString()));
		corps.setReglementaireCorpsAvecAgents(rs.getBoolean(CorpsEnum.REGLEMENTAIRE_CORPS_AVEC_AGENTS.toString()));
		corps.setReglementaireCorpsNbAgents(rs.getString(CorpsEnum.REGLEMENTAIRE_CORPS_NB_AGENTS.toString()));
		corps.setReglementaireCorpsNbAgentsMasculins(
				rs.getString(CorpsEnum.REGLEMENTAIRE_CORPS_NB_AGENTS_MASCULINS.toString()));
		corps.setReglementaireCorpsNbAgentsFeminins(
				rs.getString(CorpsEnum.REGLEMENTAIRE_CORPS_NB_AGENTS_FEMININS.toString()));
		corps.setReglementaireCorpsAccueilNbAgents(
				rs.getString(CorpsEnum.REGLEMENTAIRE_CORPS_ACCUEIL_NB_AGENTS.toString()));
		corps.setReglementaireCorpsAccueilNbAgentsMasculins(
				rs.getString(CorpsEnum.REGLEMENTAIRE_CORPS_ACCUEIL_NB_AGENTS_MASCULINS.toString()));
		corps.setReglementaireCorpsAccueilNbAgentsFeminins(
				rs.getString(CorpsEnum.REGLEMENTAIRE_CORPS_ACCUEIL_NB_AGENTS_FEMININS.toString()));
		corps.setReglementaireCorpsOrigineNbAgents(
				rs.getString(CorpsEnum.REGLEMENTAIRE_CORPS_ORIGINE_NB_AGENTS.toString()));
		corps.setReglementaireCorpsOrigineNbAgentsMasculins(
				rs.getString(CorpsEnum.REGLEMENTAIRE_CORPS_ORIGINE_NB_AGENTS_MASCULINS.toString()));
		corps.setReglementaireCorpsOrigineNbAgentsFeminins(
				rs.getString(CorpsEnum.REGLEMENTAIRE_CORPS_ORIGINE_NB_AGENTS_FEMININS.toString()));
		corps.setReglementaireCorpsEmploisFonctionnelsNbAgents(
				rs.getString(CorpsEnum.REGLEMENTAIRE_CORPS_EMPLOIS_FONCTIONNELS_NB_AGENTS.toString()));
		corps.setReglementaireCorpsEmploisFonctionnelsNbAgentsMasculins(
				rs.getString(CorpsEnum.REGLEMENTAIRE_CORPS_EMPLOIS_FONCTIONNELS_NB_AGENTS_MASCULINS.toString()));
		corps.setReglementaireCorpsEmploisFonctionnelsNbAgentsFeminins(
				rs.getString(CorpsEnum.REGLEMENTAIRE_CORPS_EMPLOIS_FONCTIONNELS_NB_AGENTS_FEMININS.toString()));
		return corps;
	}

}

```

</details>


---

### 📄 `src/main/java/ze/reglementaire/CorpsEnum.java` [913 octets]
<a id="src-main-java-ze-reglementaire-CorpsEnum-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-reglementaire-CorpsEnum-java)

> **Chemin relatif** : `src/main/java/ze/reglementaire/CorpsEnum.java`  
> **Taille** : 913 octets  
> **Lignes** : 26  
> **Type** : java

```java
package ze.reglementaire;

public enum CorpsEnum {
	REGLEMENTAIRE_CODE_CORPS,
	REGLEMENTAIRE_CORPS_LIBELLE_LONG,
	REGLEMENTAIRE_CORPS_LIBELLE_AGREGE,
	REGLEMENTAIRE_CORPS_LIBELLE_COMPLEMENTAIRE,
	REGLEMENTAIRE_CORPS_DATE_DEBUT_VALIDITE,
	REGLEMENTAIRE_CORPS_DATE_FIN_VALIDITE,
	REGLEMENTAIRE_CORPS_OUVERT,
	REGLEMENTAIRE_CORPS_AVEC_AGENTS,
	REGLEMENTAIRE_CORPS_NB_AGENTS,
	REGLEMENTAIRE_CORPS_NB_AGENTS_MASCULINS,
	REGLEMENTAIRE_CORPS_NB_AGENTS_FEMININS,
	REGLEMENTAIRE_CORPS_ACCUEIL_NB_AGENTS,
	REGLEMENTAIRE_CORPS_ACCUEIL_NB_AGENTS_MASCULINS,
	REGLEMENTAIRE_CORPS_ACCUEIL_NB_AGENTS_FEMININS,
	REGLEMENTAIRE_CORPS_ORIGINE_NB_AGENTS,
	REGLEMENTAIRE_CORPS_ORIGINE_NB_AGENTS_MASCULINS,
	REGLEMENTAIRE_CORPS_ORIGINE_NB_AGENTS_FEMININS,
	REGLEMENTAIRE_CORPS_EMPLOIS_FONCTIONNELS_NB_AGENTS,
	REGLEMENTAIRE_CORPS_EMPLOIS_FONCTIONNELS_NB_AGENTS_MASCULINS,
	REGLEMENTAIRE_CORPS_EMPLOIS_FONCTIONNELS_NB_AGENTS_FEMININS

}

```


---

### 📄 `src/main/java/ze/reglementaire/Grade.java` [9.611 octets]
<a id="src-main-java-ze-reglementaire-Grade-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-reglementaire-Grade-java)

> **Chemin relatif** : `src/main/java/ze/reglementaire/Grade.java`  
> **Taille** : 9.611 octets  
> **Lignes** : 260  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (260 lignes) - Cliquer pour déplier</summary>

```java
package ze.reglementaire;

import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;

import javax.xml.bind.annotation.XmlRootElement;
import javax.xml.bind.annotation.XmlType;

@XmlRootElement(name = "Grade")
@XmlType(
		name = "",
		propOrder = { "reglementaireCodeGrade", "reglementaireGradeLibelleLong",
				"reglementaireGradeLibelleAgrege", "reglementaireGradeLibelleComplementaire",
				"reglementaireGradeDateDebutValidite", "reglementaireGradeDateFinValidite", "reglementaireGradeOuvert",
				"reglementaireGradeAvecAgents", "reglementaireGradeNbAgents", "reglementaireGradeNbAgentsMasculins",
				"reglementaireGradeNbAgentsFeminins",
				"reglementaireGradeAccueilNbAgents", "reglementaireGradeAccueilNbAgentsMasculins",
				"reglementaireGradeAccueilNbAgentsFeminins",
				"reglementaireCorpsOrigineNbAgents", "reglementaireGradeOrigineNbAgentsMasculins",
				"reglementaireGradeOriugineNbAgentsFeminins",
				"reglementaireGradeEmploisFonctionnelsNbAgents",
				"reglementaireGradeEmploisFonctionnelsNbAgentsMasculins",
				"reglementaireGradeEmploisFonctionnelsNbAgentsFeminins" })
@JsonInclude(JsonInclude.Include.NON_NULL)
public class Grade {

	private String reglementaireCodeGrade;

	private String reglementaireGradeLibelleLong;

	private String reglementaireGradeLibelleAgrege;

	private String reglementaireGradeLibelleComplementaire;

	private String reglementaireGradeDateDebutValidite;

	private String reglementaireGradeDateFinValidite;

	private Boolean reglementaireGradeOuvert;

	private Boolean reglementaireGradeAvecAgents;

	private String reglementaireGradeNbAgents;

	private String reglementaireGradeNbAgentsMasculins;

	private String reglementaireGradeNbAgentsFeminins;

	private String reglementaireGradeAccueilNbAgents;

	private String reglementaireGradeAccueilNbAgentsMasculins;

	private String reglementaireGradeAccueilNbAgentsFeminins;

	private String reglementaireGradeOrigineNbAgents;

	private String reglementaireGradeOrigineNbAgentsMasculins;

	private String reglementaireGradeOrigineNbAgentsFeminins;

	private String reglementaireGradeEmploisFonctionnelsNbAgents;

	private String reglementaireGradeEmploisFonctionnelsNbAgentsMasculins;

	private String reglementaireGradeEmploisFonctionnelsNbAgentsFeminins;

	private String erreur;

	@JsonProperty("reglementaire_code_grade")
	public String getReglementaireCodeGrade() {
		return reglementaireCodeGrade;
	}

	public void setReglementaireCodeGrade(String reglementaireCodeGrade) {
		this.reglementaireCodeGrade = reglementaireCodeGrade;
	}

	@JsonProperty("reglementaire_grade_libelle_long")
	public String getReglementaireGradeLibelleLong() {
		return reglementaireGradeLibelleLong;
	}

	public void setReglementaireGradeLibelleLong(String reglementaireGradeLibelleLong) {
		this.reglementaireGradeLibelleLong = reglementaireGradeLibelleLong;
	}

	@JsonProperty("reglementaire_grade_libelle_agrege")
	public String getReglementaireGradeLibelleAgrege() {
		return reglementaireGradeLibelleAgrege;
	}

	public void setReglementaireGradeLibelleAgrege(String reglementaireGradeLibelleAgrege) {
		this.reglementaireGradeLibelleAgrege = reglementaireGradeLibelleAgrege;
	}

	@JsonProperty("reglementaire_grade_libelle_complementaire")
	public String getReglementaireGradeLibelleComplementaire() {
		return reglementaireGradeLibelleComplementaire;
	}

	public void setReglementaireGradeLibelleComplementaire(String reglementaireGradeLibelleComplementaire) {
		this.reglementaireGradeLibelleComplementaire = reglementaireGradeLibelleComplementaire;
	}

	@JsonProperty("reglementaire_grade_date_debut_validite")
	public String getReglementaireGradeDateDebutValidite() {
		return reglementaireGradeDateDebutValidite;
	}

	public void setReglementaireGradeDateDebutValidite(String reglementaireGradeDateDebutValidite) {
		this.reglementaireGradeDateDebutValidite = reglementaireGradeDateDebutValidite;
	}

	@JsonProperty("reglementaire_grade_date_fin_validite")
	public String getReglementaireGradeDateFinValidite() {
		return reglementaireGradeDateFinValidite;
	}

	public void setReglementaireGradeDateFinValidite(String reglementaireGradeDateFinValidite) {
		this.reglementaireGradeDateFinValidite = reglementaireGradeDateFinValidite;
	}

	@JsonProperty("reglementaire_grade_ouvert")
	public Boolean getReglementaireGradeOuvert() {
		return reglementaireGradeOuvert;
	}

	public void setReglementaireGradeOuvert(Boolean reglementaireGradeOuvert) {
		this.reglementaireGradeOuvert = reglementaireGradeOuvert;
	}

	@JsonProperty("reglementaire_grade_avec_agents")
	public Boolean getReglementaireGradeAvecAgents() {
		return reglementaireGradeAvecAgents;
	}

	public void setReglementaireGradeAvecAgents(Boolean reglementaireGradeAvecAgents) {
		this.reglementaireGradeAvecAgents = reglementaireGradeAvecAgents;
	}

	@JsonProperty("reglementaire_grade_nb_agents")
	public String getReglementaireGradeNbAgents() {
		return reglementaireGradeNbAgents;
	}

	public void setReglementaireGradeNbAgents(String reglementaireGradeNbAgents) {
		this.reglementaireGradeNbAgents = reglementaireGradeNbAgents;
	}

	@JsonProperty("reglementaire_grade_nb_agents_masculins")
	public String getReglementaireGradeNbAgentsMasculins() {
		return reglementaireGradeNbAgentsMasculins;
	}

	public void setReglementaireGradeNbAgentsMasculins(String reglementaireGradeNbAgentsMasculins) {
		this.reglementaireGradeNbAgentsMasculins = reglementaireGradeNbAgentsMasculins;
	}

	@JsonProperty("reglementaire_grade_nb_agents_feminins")
	public String getReglementaireGradeNbAgentsFeminins() {
		return reglementaireGradeNbAgentsFeminins;
	}

	public void setReglementaireGradeNbAgentsFeminins(String reglementaireGradeNbAgentsFeminins) {
		this.reglementaireGradeNbAgentsFeminins = reglementaireGradeNbAgentsFeminins;
	}

	@JsonProperty("reglementaire_grade_accueil_nb_agents")
	public String getReglementaireGradeAccueilNbAgents() {
		return reglementaireGradeAccueilNbAgents;
	}

	public void setReglementaireGradeAccueilNbAgents(String reglementaireGradeAccueilNbAgents) {
		this.reglementaireGradeAccueilNbAgents = reglementaireGradeAccueilNbAgents;
	}

	@JsonProperty("reglementaire_grade_accueil_nb_agents_masculins")
	public String getReglementaireGradeAccueilNbAgentsMasculins() {
		return reglementaireGradeAccueilNbAgentsMasculins;
	}

	public void setReglementaireGradeAccueilNbAgentsMasculins(String reglementaireGradeAccueilNbAgentsMasculins) {
		this.reglementaireGradeAccueilNbAgentsMasculins = reglementaireGradeAccueilNbAgentsMasculins;
	}

	@JsonProperty("reglementaire_grade_accueil_nb_agents_feminins")
	public String getReglementaireGradeAccueilNbAgentsFeminins() {
		return reglementaireGradeAccueilNbAgentsFeminins;
	}

	public void setReglementaireGradeAccueilNbAgentsFeminins(String reglementaireGradeAccueilNbAgentsFeminins) {
		this.reglementaireGradeAccueilNbAgentsFeminins = reglementaireGradeAccueilNbAgentsFeminins;
	}

	@JsonProperty("reglementaire_grade_origine_nb_agents")
	public String getReglementaireGradeOrigineNbAgents() {
		return reglementaireGradeOrigineNbAgents;
	}

	public void setReglementaireGradeOrigineNbAgents(String reglementaireGradeOrigineNbAgents) {
		this.reglementaireGradeOrigineNbAgents = reglementaireGradeOrigineNbAgents;
	}

	@JsonProperty("reglementaire_grade_origine_nb_agents_masculins")
	public String getReglementaireGradeOrigineNbAgentsMasculins() {
		return reglementaireGradeOrigineNbAgentsMasculins;
	}

	public void setReglementaireGradeOrigineNbAgentsMasculins(String reglementaireGradeOrigineNbAgentsMasculins) {
		this.reglementaireGradeOrigineNbAgentsMasculins = reglementaireGradeOrigineNbAgentsMasculins;
	}

	@JsonProperty("reglementaire_grade_origine_nb_agents_feminins")
	public String getReglementaireGradeOrigineNbAgentsFeminins() {
		return reglementaireGradeOrigineNbAgentsFeminins;
	}

	public void setReglementaireGradeOrigineNbAgentsFeminins(String reglementaireGradeOriugineNbAgentsFeminins) {
		this.reglementaireGradeOrigineNbAgentsFeminins = reglementaireGradeOriugineNbAgentsFeminins;
	}

	@JsonProperty("reglementaire_grade_emplois_fonctionnels_nb_agents")
	public String getReglementaireGradeEmploisFonctionnelsNbAgents() {
		return reglementaireGradeEmploisFonctionnelsNbAgents;
	}

	public void setReglementaireGradeEmploisFonctionnelsNbAgents(String reglementaireGradeEmploisFonctionnelsNbAgents) {
		this.reglementaireGradeEmploisFonctionnelsNbAgents = reglementaireGradeEmploisFonctionnelsNbAgents;
	}

	@JsonProperty("reglementaire_grade_emplois_fonctionnels_nb_agents_masculins")
	public String getReglementaireGradeEmploisFonctionnelsNbAgentsMasculins() {
		return reglementaireGradeEmploisFonctionnelsNbAgentsMasculins;
	}

	public void setReglementaireGradeEmploisFonctionnelsNbAgentsMasculins(
			String reglementaireGradeEmploisFonctionnelsNbAgentsMasculins) {
		this.reglementaireGradeEmploisFonctionnelsNbAgentsMasculins = reglementaireGradeEmploisFonctionnelsNbAgentsMasculins;
	}

	@JsonProperty("reglementaire_grade_emplois_fonctionnels_nb_agents_feminins")
	public String getReglementaireGradeEmploisFonctionnelsNbAgentsFeminins() {
		return reglementaireGradeEmploisFonctionnelsNbAgentsFeminins;
	}

	public void setReglementaireGradeEmploisFonctionnelsNbAgentsFeminins(
			String reglementaireGradeEmploisFonctionnelsNbAgentsFeminins) {
		this.reglementaireGradeEmploisFonctionnelsNbAgentsFeminins = reglementaireGradeEmploisFonctionnelsNbAgentsFeminins;
	}

	public String getErreur() {
		return erreur;
	}

	public void setErreur(String erreur) {
		this.erreur = erreur;
	}

}

```

</details>


---

### 📄 `src/main/java/ze/reglementaire/GradeDAO.java` [7.243 octets]
<a id="src-main-java-ze-reglementaire-GradeDAO-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-reglementaire-GradeDAO-java)

> **Chemin relatif** : `src/main/java/ze/reglementaire/GradeDAO.java`  
> **Taille** : 7.243 octets  
> **Lignes** : 198  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (198 lignes) - Cliquer pour déplier</summary>

```java
package ze.reglementaire;

import java.sql.Array;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.text.ParseException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.regex.Pattern;

import org.apache.commons.lang3.StringUtils;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import ze.database.utils.DataBase;
import ze.impl.Utils;

public class GradeDAO {

	private static final Utils UTILS = new Utils();

	private static final Pattern SPLIT_ID_PATTERN = Pattern.compile("[()']");

	private static final Logger LOG = LoggerFactory.getLogger(GradeDAO.class);

	/*
	 * Récupère les informations des grades avec une liste id
	 */
	public List<Grade> getGradeById(String idGrade) {

		StringBuilder req = new StringBuilder();

		req.append(
				"SELECT * FROM GRADE WHERE reglementaire_code_grade = ANY(?)");

		List<Grade> listGrade = new ArrayList<>();
		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		try {
			con = DriverManager.getConnection(UTILS.getUrl(), UTILS.getUser(), UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			String[] idGra = SPLIT_ID_PATTERN.matcher(idGrade).replaceAll("").split(",");
			Array a = con.createArrayOf("text", idGra);
			st.setArray(1, a);
			LOG.info("Liste de grades par id: ", st.toString());
			rs = st.executeQuery();
			List<String> listIdGra = new ArrayList<>(Arrays.asList(idGra));
			while (rs.next()) {
				listGrade.add(processGrade(rs));
				String GraID = rs.getString(GradeEnum.REGLEMENTAIRE_CODE_GRADE.toString());
				listIdGra.remove(GraID);
			}
			for (String s : listIdGra) {
				Grade g = new Grade();
				g.setReglementaireCodeGrade(s);
				g.setErreur("404 : Grade non trouvé");
				listGrade.add(g);
			}
			return listGrade;
		} catch (SQLException e) {
			UTILS.erreurAccesBase(e);
		} catch (Exception e) {
			UTILS.erreurInnatendue(e);
		} finally {
			UTILS.closeConnexion(rs, st, con);
		}
		return listGrade;
	}

	/*
	 * Récupère la liste de grades associées aux paramètres de recherches fournis
	 */
	public List<Grade> getGradeList(String recherche, String corps, String ouvert, String avecAgent) {

		List<Grade> listGrade = new ArrayList<>();

		StringBuilder req = new StringBuilder();
		req.append("SELECT * FROM GRADE WHERE 1=1 ");

		// Prise en compte du champ recherche
		String rechercheNormalized;
		String[] rechercheNormalizedSplit = { "" };
		if (recherche != null) {
			// On retire les accents et on met en minuscule le texte de recherche
			rechercheNormalized = StringUtils.stripAccents(recherche.toLowerCase());
			rechercheNormalizedSplit = rechercheNormalized.split(" ");

			Connection cnx = null;
			try {
				cnx = DriverManager.getConnection(UTILS.getUrl(), UTILS.getUser(), UTILS.getPassword());
				String subQuery = DataBase.getGoogleQuery(cnx, "GRADE", rechercheNormalizedSplit);
				req.append(" AND ")
						.append(subQuery);

			} catch (Exception e) {
				LOG.warn("erreur de lancement de la recherche");
			} finally {
				UTILS.closeConnexion(null, null, cnx);
			}
		}
		if (corps != null) {
			req.append(" AND reglementaire_code_grade = ANY(?)");
		}

		// Prise en compte du champ actif
		if (ouvert != null) {
			boolean isOuvert = Boolean.parseBoolean(ouvert);
			req.append(" AND reglementaire_grade_ouvert = ")
					.append(isOuvert);
		}

		// Prise en compte du champ avecAgent
		if (avecAgent != null) {
			boolean withAgent = Boolean.parseBoolean(avecAgent);
			req.append(" AND reglementaire_grade_avec_agents = ")
					.append(withAgent);

		}

		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		try {
			con = DriverManager.getConnection(UTILS.getUrl(), UTILS.getUser(), UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			int j = 0;
			if (corps != null) {
				j++;
				Array a = con.createArrayOf("text", SPLIT_ID_PATTERN.matcher(corps).replaceAll("").split(","));
				st.setArray(j, a);
			}
			LOG.info(st.toString());
			rs = st.executeQuery();
			while (rs.next()) {
				listGrade.add(processGrade(rs));
			}
			LOG.info("Liste de grades par id: ", st.toString());
			return listGrade;
		} catch (SQLException e) {
			UTILS.erreurAccesBase(e);
		} catch (Exception e) {
			UTILS.erreurInnatendue(e);
		} finally {
			UTILS.closeConnexion(rs, st, con);
		}
		return listGrade;
	}

	/*
	 * Récupère le grade
	 */
	protected Grade processGrade(ResultSet rs) throws SQLException, ParseException {
		Grade grade = new Grade();
		grade.setReglementaireCodeGrade(rs.getString(GradeEnum.REGLEMENTAIRE_CODE_GRADE.toString()));
		grade.setReglementaireGradeLibelleLong(rs.getString(GradeEnum.REGLEMENTAIRE_GRADE_LIBELLE_LONG.toString()));
		grade.setReglementaireGradeLibelleAgrege(rs.getString(GradeEnum.REGLEMENTAIRE_GRADE_LIBELLE_AGREGE.toString()));
		grade.setReglementaireGradeLibelleComplementaire(
				rs.getString(GradeEnum.REGLEMENTAIRE_GRADE_LIBELLE_COMPLEMENTAIRE.toString()));
		grade.setReglementaireGradeDateDebutValidite(
				rs.getString(GradeEnum.REGLEMENTAIRE_GRADE_DATE_DEBUT_VALIDITE.toString()));
		grade.setReglementaireGradeDateFinValidite(
				rs.getString(GradeEnum.REGLEMENTAIRE_GRADE_DATE_FIN_VALIDITE.toString()));
		grade.setReglementaireGradeOuvert(rs.getBoolean(GradeEnum.REGLEMENTAIRE_GRADE_OUVERT.toString()));
		grade.setReglementaireGradeAvecAgents(rs.getBoolean(GradeEnum.REGLEMENTAIRE_GRADE_AVEC_AGENTS.toString()));
		grade.setReglementaireGradeNbAgents(rs.getString(GradeEnum.REGLEMENTAIRE_GRADE_NB_AGENTS.toString()));
		grade.setReglementaireGradeNbAgentsMasculins(
				rs.getString(GradeEnum.REGLEMENTAIRE_GRADE_NB_AGENTS_MASCULINS.toString()));
		grade.setReglementaireGradeNbAgentsFeminins(
				rs.getString(GradeEnum.REGLEMENTAIRE_GRADE_NB_AGENTS_FEMININS.toString()));
		grade.setReglementaireGradeAccueilNbAgents(
				rs.getString(GradeEnum.REGLEMENTAIRE_GRADE_ACCUEIL_NB_AGENTS.toString()));
		grade.setReglementaireGradeAccueilNbAgentsMasculins(
				rs.getString(GradeEnum.REGLEMENTAIRE_GRADE_ACCUEIL_NB_AGENTS_MASCULINS.toString()));
		grade.setReglementaireGradeAccueilNbAgentsFeminins(
				rs.getString(GradeEnum.REGLEMENTAIRE_GRADE_ACCUEIL_NB_AGENTS_FEMININS.toString()));
		grade.setReglementaireGradeOrigineNbAgents(
				rs.getString(GradeEnum.REGLEMENTAIRE_GRADE_ORIGINE_NB_AGENTS.toString()));
		grade.setReglementaireGradeOrigineNbAgentsMasculins(
				rs.getString(GradeEnum.REGLEMENTAIRE_GRADE_ORIGINE_NB_AGENTS_MASCULINS.toString()));
		grade.setReglementaireGradeOrigineNbAgentsFeminins(
				rs.getString(GradeEnum.REGLEMENTAIRE_GRADE_ORIGINE_NB_AGENTS_FEMININS.toString()));
		grade.setReglementaireGradeEmploisFonctionnelsNbAgents(
				rs.getString(GradeEnum.REGLEMENTAIRE_GRADE_EMPLOIS_FONCTIONNELS_NB_AGENTS.toString()));
		grade.setReglementaireGradeEmploisFonctionnelsNbAgentsMasculins(
				rs.getString(GradeEnum.REGLEMENTAIRE_GRADE_EMPLOIS_FONCTIONNELS_NB_AGENTS_MASCULINS.toString()));
		grade.setReglementaireGradeEmploisFonctionnelsNbAgentsFeminins(
				rs.getString(GradeEnum.REGLEMENTAIRE_GRADE_EMPLOIS_FONCTIONNELS_NB_AGENTS_FEMININS.toString()));

		return grade;
	}

}

```

</details>


---

### 📄 `src/main/java/ze/reglementaire/GradeEnum.java` [912 octets]
<a id="src-main-java-ze-reglementaire-GradeEnum-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-reglementaire-GradeEnum-java)

> **Chemin relatif** : `src/main/java/ze/reglementaire/GradeEnum.java`  
> **Taille** : 912 octets  
> **Lignes** : 25  
> **Type** : java

```java
package ze.reglementaire;

public enum GradeEnum {
	REGLEMENTAIRE_CODE_GRADE,
	REGLEMENTAIRE_GRADE_LIBELLE_LONG,
	REGLEMENTAIRE_GRADE_LIBELLE_AGREGE,
	REGLEMENTAIRE_GRADE_LIBELLE_COMPLEMENTAIRE,
	REGLEMENTAIRE_GRADE_DATE_DEBUT_VALIDITE,
	REGLEMENTAIRE_GRADE_DATE_FIN_VALIDITE,
	REGLEMENTAIRE_GRADE_OUVERT,
	REGLEMENTAIRE_GRADE_AVEC_AGENTS,
	REGLEMENTAIRE_GRADE_NB_AGENTS,
	REGLEMENTAIRE_GRADE_NB_AGENTS_MASCULINS,
	REGLEMENTAIRE_GRADE_NB_AGENTS_FEMININS,
	REGLEMENTAIRE_GRADE_ACCUEIL_NB_AGENTS,
	REGLEMENTAIRE_GRADE_ACCUEIL_NB_AGENTS_MASCULINS,
	REGLEMENTAIRE_GRADE_ACCUEIL_NB_AGENTS_FEMININS,
	REGLEMENTAIRE_GRADE_ORIGINE_NB_AGENTS,
	REGLEMENTAIRE_GRADE_ORIGINE_NB_AGENTS_MASCULINS,
	REGLEMENTAIRE_GRADE_ORIGINE_NB_AGENTS_FEMININS,
	REGLEMENTAIRE_GRADE_EMPLOIS_FONCTIONNELS_NB_AGENTS,
	REGLEMENTAIRE_GRADE_EMPLOIS_FONCTIONNELS_NB_AGENTS_MASCULINS,
	REGLEMENTAIRE_GRADE_EMPLOIS_FONCTIONNELS_NB_AGENTS_FEMININS
}

```


---

### 📄 `src/main/java/ze/reglementaire/Reglementaire.java` [9.501 octets]
<a id="src-main-java-ze-reglementaire-Reglementaire-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-reglementaire-Reglementaire-java)

> **Chemin relatif** : `src/main/java/ze/reglementaire/Reglementaire.java`  
> **Taille** : 9.501 octets  
> **Lignes** : 302  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (302 lignes) - Cliquer pour déplier</summary>

```java
package ze.reglementaire;

import javax.xml.bind.annotation.XmlRootElement;
import javax.xml.bind.annotation.XmlType;

import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;

@XmlRootElement(name = "Reglementaire")
@XmlType(
		name = "",
		propOrder = { "reglementaireCorpsIdentifiant", "reglementaireCorpsLibelleLong",
				"reglementaireCorpsLibelleCourt",
				"reglementaireCodeMinistere", "reglementaireCorpsCategorieAdmin", "reglementaireCorpsDateDebut",
				"reglementaireCorpsDateFin", "reglementaireCorpsActif", "reglementaireCorpsAvecAgents",
				"reglementaireCorpsNbAgentH", "reglementaireCorpsNbAgentF", "reglementaireCorpsNbAgent",
				"reglementaireGradeIdentifiant", "reglementaireGradeRepertoire", "reglementaireGradeLibelleLong",
				"reglementaireGradeLibelleCourt", "reglementaireGradeDateDebut", "reglementaireGradeDateFin",
				"reglementaireGradeActif", "reglementaireGradeAvecAgents", "reglementaireGradeNbAgentH",
				"reglementaireGradeNbAgentF",
				"reglementaireGradeNbAgent" })
@JsonInclude(JsonInclude.Include.NON_NULL)
public class Reglementaire {

	private String erreur;

	//Corps
	private String reglementaireCorpsIdentifiant;

	private String reglementaireCorpsLibelleLong;

	private String reglementaireCorpsLibelleCourt;

	private String reglementaireCodeMinistere;

	private String reglementaireCorpsCategorieAdmin;

	private String reglementaireCorpsDateDebut;

	private String reglementaireCorpsDateFin;

	private String reglementaireCorpsActif;

	private String reglementaireCorpsAvecAgents;

	private String reglementaireCorpsNbAgentH;

	private String reglementaireCorpsNbAgentF;

	private String reglementaireCorpsNbAgent;

	//Grade
	private String reglementaireGradeIdentifiant;

	private String reglementaireGradeRepertoire;

	private String reglementaireGradeLibelleLong;

	private String reglementaireGradeLibelleCourt;

	private String reglementaireGradeCorps;

	private String reglementaireGradeDateDebut;

	private String reglementaireGradeDateFin;

	private String reglementaireGradeActif;

	private String reglementaireGradeAvecAgents;

	private String reglementaireGradeNbAgentH;

	private String reglementaireGradeNbAgentF;

	private String reglementaireGradeNbAgent;

	public String getErreur() {
		return erreur;
	}

	@JsonProperty("reglementaire_corps_identifiant")
	public String getReglementaireCorpsIdentifiant() {
		return reglementaireCorpsIdentifiant;
	}

	@JsonProperty("reglementaire_corps_libelle_long")
	public String getReglementaireCorpsLibelleLong() {
		return reglementaireCorpsLibelleLong;
	}

	@JsonProperty("reglementaire_corps_libelle_court")
	public String getReglementaireCorpsLibelleCourt() {
		return reglementaireCorpsLibelleCourt;
	}

	@JsonProperty("reglementaire_code_Ministere")
	public String getReglementaireCodeMinistere() {
		return reglementaireCodeMinistere;
	}

	@JsonProperty("reglementaire_corps_categorie_administrative")
	public String getReglementaireCorpsCategorieAdmin() {
		return reglementaireCorpsCategorieAdmin;
	}

	@JsonProperty("reglementaire_corps_date_debut_validite")
	public String getReglementaireCorpsDateDebut() {
		return reglementaireCorpsDateDebut;
	}

	@JsonProperty("reglementaire_corps_date_fin_validite")
	public String getReglementaireCorpsDateFin() {
		return reglementaireCorpsDateFin;
	}

	@JsonProperty("reglementaire_corps_actif")
	public String getReglementaireCorpsActif() {
		return reglementaireCorpsActif;
	}

	@JsonProperty("reglementaire_corps_avec_agents")
	public String getReglementaireCorpsAvecAgents() {
		return reglementaireCorpsAvecAgents;
	}

	@JsonProperty("reglementaire_corps_nb_agents_masculins")
	public String getReglementaireCorpsNbAgentH() {
		return reglementaireCorpsNbAgentH;
	}

	@JsonProperty("reglementaire_corps_nb_agents_feminins")
	public String getReglementaireCorpsNbAgentF() {
		return reglementaireCorpsNbAgentF;
	}

	@JsonProperty("reglementaire_corps_nb_agents")
	public String getReglementaireCorpsNbAgent() {
		return reglementaireCorpsNbAgent;
	}

	@JsonProperty("reglementaire_code_grade")
	public String getReglementaireGradeIdentifiant() {
		return reglementaireGradeIdentifiant;
	}

	@JsonProperty("reglementaire_repertoire_grade")
	public String getReglementaireGradeRepertoire() {
		return reglementaireGradeRepertoire;
	}

	@JsonProperty("reglementaire_grade_detachement_libelle_long")
	public String getReglementaireGradeLibelleLong() {
		return reglementaireGradeLibelleLong;
	}

	@JsonProperty("reglementaire_grade_detachement_libelle_court")
	public String getReglementaireGradeLibelleCourt() {
		return reglementaireGradeLibelleCourt;
	}

	@JsonProperty("reglementaire_corps_rattachement")
	public String getReglementaireGradeCorps() {
		return reglementaireGradeCorps;
	}

	@JsonProperty("reglementaire_grade_date_debut_validite")
	public String getReglementaireGradeDateDebut() {
		return reglementaireGradeDateDebut;
	}

	@JsonProperty("reglementaire_grade_date_fin_validite")
	public String getReglementaireGradeDateFin() {
		return reglementaireGradeDateFin;
	}

	@JsonProperty("reglementaire_grade_actif")
	public String getReglementaireGradeActif() {
		return reglementaireGradeActif;
	}

	@JsonProperty("reglementaire_grade_avec_agents")
	public String getReglementaireGradeAvecAgents() {
		return reglementaireGradeAvecAgents;
	}

	@JsonProperty("reglementaire_grade_nb_agents_masculins")
	public String getReglementaireGradeNbAgentH() {
		return reglementaireGradeNbAgentH;
	}

	@JsonProperty("reglementaire_grade_nb_agent_feminins")
	public String getReglementaireGradeNbAgentF() {
		return reglementaireGradeNbAgentF;
	}

	@JsonProperty("reglementaire_grade_nb_agents")
	public String getReglementaireGradeNbAgent() {
		return reglementaireGradeNbAgent;
	}

	public void setErreur(String erreur) {
		this.erreur = erreur;
	}

	public void setReglementaireCorpsIdentifiant(String reglementaireCorpsIdentifiant) {
		this.reglementaireCorpsIdentifiant = reglementaireCorpsIdentifiant;
	}

	public void setReglementaireCorpsLibelleLong(String reglementaireCorpsLibelleLong) {
		this.reglementaireCorpsLibelleLong = reglementaireCorpsLibelleLong;
	}

	public void setReglementaireCorpsLibelleCourt(String reglementaireCorpsLibelleCourt) {
		this.reglementaireCorpsLibelleCourt = reglementaireCorpsLibelleCourt;
	}

	public void setReglementaireCodeMinistere(String reglementaireCodeMinistere) {
		this.reglementaireCodeMinistere = reglementaireCodeMinistere;
	}

	public void setReglementaireCorpsCategorieAdmin(String reglementaireCorpsCategorieAdmin) {
		this.reglementaireCorpsCategorieAdmin = reglementaireCorpsCategorieAdmin;
	}

	public void setReglementareCorpsDateDebut(String reglementareCorpsDateDebut) {
		this.reglementaireCorpsDateDebut = reglementareCorpsDateDebut;
	}

	public void setReglementaireCorpsDateFin(String reglementaireCorpsDateFin) {
		this.reglementaireCorpsDateFin = reglementaireCorpsDateFin;
	}

	public void setReglementaireCorpsActif(String reglementaireCorpsActif) {
		this.reglementaireCorpsActif = reglementaireCorpsActif;
	}

	public void setReglementaireCorpsAvecAgents(String reglementaireCorpsAvecAgents) {
		this.reglementaireCorpsAvecAgents = reglementaireCorpsAvecAgents;
	}

	public void setReglementaireCorpsNbAgentH(String reglementaireCorpsNbAgentH) {
		this.reglementaireCorpsNbAgentH = reglementaireCorpsNbAgentH;
	}

	public void setReglementaireCorpsNbAgentF(String reglementaireCorpsNbAgentF) {
		this.reglementaireCorpsNbAgentF = reglementaireCorpsNbAgentF;
	}

	public void setReglementaireCorpsNbAgent(String reglementaireCorpsNbAgent) {
		this.reglementaireCorpsNbAgent = reglementaireCorpsNbAgent;
	}

	public void setReglementaireGradeIdentifiant(String reglementaireGradeIdentifiant) {
		this.reglementaireGradeIdentifiant = reglementaireGradeIdentifiant;
	}

	public void setReglementaireGradeRepertoire(String reglementaireGradeRepertoire) {
		this.reglementaireGradeRepertoire = reglementaireGradeRepertoire;
	}

	public void setReglementaireGradeLibelleLong(String reglementaireGradeLibelleLong) {
		this.reglementaireGradeLibelleLong = reglementaireGradeLibelleLong;
	}

	public void setReglementaireGradeLibelleCourt(String reglementaireGradeLibelleCourt) {
		this.reglementaireGradeLibelleCourt = reglementaireGradeLibelleCourt;
	}

	public void setReglementareGradeDateDebut(String reglementareGradeDateDebut) {
		this.reglementaireGradeDateDebut = reglementareGradeDateDebut;
	}

	public void setReglementaireGradeDateFin(String reglementaireGradeDateFin) {
		this.reglementaireGradeDateFin = reglementaireGradeDateFin;
	}

	public void setReglementaireGradeActif(String reglementaireGradeActif) {
		this.reglementaireGradeActif = reglementaireGradeActif;
	}

	public void setReglementaireGradeAvecAgents(String reglementaireGradeAvecAgents) {
		this.reglementaireGradeAvecAgents = reglementaireGradeAvecAgents;
	}

	public void setReglementaireGradeNbAgentH(String reglementaireGradeNbAgentH) {
		this.reglementaireGradeNbAgentH = reglementaireGradeNbAgentH;
	}

	public void setReglementaireGradeNbAgentF(String reglementaireGradeNbAgentF) {
		this.reglementaireGradeNbAgentF = reglementaireGradeNbAgentF;
	}

	public void setReglementaireGradeNbAgent(String reglementaireGradeNbAgent) {
		this.reglementaireGradeNbAgent = reglementaireGradeNbAgent;
	}

	public void setReglementaireGradeCorps(String reglementaireGradeCorps) {
		this.reglementaireGradeCorps = reglementaireGradeCorps;
	}

}

```

</details>


---

### 📄 `src/main/java/ze/reglementaire/ReglementaireDAO.java` [21.241 octets]
<a id="src-main-java-ze-reglementaire-ReglementaireDAO-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-reglementaire-ReglementaireDAO-java)

> **Chemin relatif** : `src/main/java/ze/reglementaire/ReglementaireDAO.java`  
> **Taille** : 21.241 octets  
> **Lignes** : 425  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (425 lignes) - Cliquer pour déplier</summary>

```java
package ze.reglementaire;

import java.sql.Array;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.text.ParseException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.regex.Pattern;

import org.apache.commons.lang3.StringUtils;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import ze.impl.Utils;
import ze.unitestructurelle.UniteStructurelleDAO;

public class ReglementaireDAO {

	private static final Utils UTILS = new Utils();

	private static final Pattern SPLIT_ID_PATTERN = Pattern.compile("[()']");

	private static final Logger LOG = LoggerFactory.getLogger(ReglementaireDAO.class);

	/*
	 * Récupère les informations des corps avec une liste id
	 */
	public List<Reglementaire> getCorpsById(String idCorps) {

		StringBuilder req = new StringBuilder();

		req.append(
				"SELECT * from (SELECT distinct on (reg.REG_CORPS_IDENTIFIANT) reg.REG_CORPS_IDENTIFIANT, REG_CORPS_LIBELLE_LONG, REG_CORPS_LIBELLE_COURT, REG_CORPS_CODE_MINISTERE, REG_CORPS_CATEGORIE_ADMIN, REG_CORPS_DATE_DEBUT, REG_CORPS_DATE_FIN")
				.append(", REG_CORPS_DATE_FIN isnull or REG_CORPS_DATE_FIN > current_date as REG_CORPS_ACTIF")
				.append(", REG_CORPS_NBAGENTH, REG_CORPS_NBAGENTF FROM REGLEMENTAIRE reg")
				.append(" LEFT JOIN (Select reg.reg_corps_identifiant, count(distinct agent_matricule_renoirh) AS REG_CORPS_NBAGENTH FROM REGLEMENTAIRE reg LEFT JOIN (Select agent.agent_matricule_renoirh, AGENT.agent_carriere_accueil_corps FROM AGENT WHERE AGENT_SEXE = 'H'and (agent_carriere_active_date_fin is null or agent_carriere_active_date_fin < '02/04/2019')) H ON reg.reg_corps_identifiant = agent_carriere_accueil_corps")
				.append(" GROUP BY reg_corps_identifiant) corpsH on reg.reg_corps_identifiant = corpsH.reg_corps_identifiant")
				.append(" LEFT JOIN (Select reg.reg_corps_identifiant, count(distinct agent_matricule_renoirh) AS REG_CORPS_NBAGENTF FROM REGLEMENTAIRE reg LEFT JOIN (Select agent.agent_matricule_renoirh, AGENT.agent_carriere_accueil_corps FROM AGENT WHERE AGENT_SEXE = 'F'and (agent_carriere_active_date_fin is null or agent_carriere_active_date_fin < '02/04/2019')) F ON reg.reg_corps_identifiant = agent_carriere_accueil_corps")
				.append(" GROUP BY reg_corps_identifiant) corpsF on reg.reg_corps_identifiant = corpsF.reg_corps_identifiant ) req")
				.append(" WHERE reg_corps_identifiant = ANY(?) ");

		ArrayList<Reglementaire> listReglementaire = new ArrayList<>();
		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		try {
			con = DriverManager.getConnection(UTILS.getUrl(), UTILS.getUser(), UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			String[] idCor = SPLIT_ID_PATTERN.matcher(idCorps).replaceAll("").split(",");
			Array a = con.createArrayOf("text", idCor);
			st.setArray(1, a);
			rs = st.executeQuery();
			ArrayList<String> listIdCor = new ArrayList<>(Arrays.asList(idCor));
			while (rs.next()) {
				listReglementaire.add(processCorps(rs));
				String corID = rs.getString(ReglementaireEnum.REG_CORPS_IDENTIFIANT.toString());
				listIdCor.remove(corID);
			}
			for (String s : listIdCor) {
				Reglementaire g = new Reglementaire();
				g.setReglementaireGradeIdentifiant(s);
				g.setErreur("404 : Corps non trouvé");
				listReglementaire.add(g);
			}
			return listReglementaire;
		} catch (SQLException e) {
			UTILS.erreurAccesBase(e);
		} catch (Exception e) {
			UTILS.erreurInnatendue(e);
		} finally {
			UTILS.closeConnexion(rs, st, con);
		}
		return listReglementaire;
	}

	/*
	 * Récupère la liste des corps associées aux paramètres de
	 * recherches fournis
	 */
	public List<Reglementaire> getCorpsList(String recherche, String ministere, String categorie, String actif,
			String avecAgent) {

		ArrayList<Reglementaire> list = new ArrayList<>();

		StringBuilder req = new StringBuilder();
		req.append(
				"SELECT * from (SELECT distinct on (reg.REG_CORPS_IDENTIFIANT) reg.REG_CORPS_IDENTIFIANT, REG_CORPS_LIBELLE_LONG, REG_CORPS_LIBELLE_COURT, REG_CORPS_CODE_MINISTERE, REG_CORPS_CATEGORIE_ADMIN, REG_CORPS_DATE_DEBUT, REG_CORPS_DATE_FIN")
				.append(", REG_CORPS_DATE_FIN isnull or REG_CORPS_DATE_FIN > current_date as REG_CORPS_ACTIF")
				.append(", REG_CORPS_NBAGENTH, REG_CORPS_NBAGENTF, search FROM REGLEMENTAIRE reg")
				.append(" LEFT JOIN (Select reg.reg_corps_identifiant, count(distinct agent_matricule_renoirh) AS REG_CORPS_NBAGENTH FROM REGLEMENTAIRE reg LEFT JOIN (Select agent.agent_matricule_renoirh, AGENT.agent_carriere_accueil_corps FROM AGENT WHERE AGENT_SEXE = 'H'and (agent_carriere_active_date_fin is null or agent_carriere_active_date_fin < '02/04/2019')) H ON reg.reg_corps_identifiant = agent_carriere_accueil_corps")
				.append(" GROUP BY reg_corps_identifiant) corpsH on reg.reg_corps_identifiant = corpsH.reg_corps_identifiant")
				.append(" LEFT JOIN (Select reg.reg_corps_identifiant, count(distinct agent_matricule_renoirh) AS REG_CORPS_NBAGENTF FROM REGLEMENTAIRE reg LEFT JOIN (Select agent.agent_matricule_renoirh, AGENT.agent_carriere_accueil_corps FROM AGENT WHERE AGENT_SEXE = 'F'and (agent_carriere_active_date_fin is null or agent_carriere_active_date_fin < '02/04/2019')) F ON reg.reg_corps_identifiant = agent_carriere_accueil_corps")
				.append(" GROUP BY reg_corps_identifiant) corpsF on reg.reg_corps_identifiant = corpsF.reg_corps_identifiant ) req")
				.append(" WHERE 1=1 ");

		// Prise en compte du champ recherche
		String rechercheNormalized;
		String[] rechercheNormalizedSplit = { "" };
		if (recherche != null) {
			// On retire les accents et on met en minuscule le texte de recherche
			rechercheNormalized = StringUtils.stripAccents(recherche.toLowerCase());
			rechercheNormalizedSplit = rechercheNormalized.split(" ");
		}

		int rechercheLength = rechercheNormalizedSplit.length;
		req.append("and search ~ ?");
		for (int i = 1; i < rechercheLength; i++) {
			req.append(" and search ~ ?");
		}

		// Prise en compte du champ minist
		if (ministere != null) {
			req.append(" AND REG_CORPS_CODE_MINISTERE = ANY(?)");
		}

		// Prise en compte du champ categorie
		if (categorie != null) {
			req.append(" AND REG_CORPS_CATEGORIE_ADMIN = ANY(?)");
		}

		// Prise en compte du champ actif
		if (actif != null) {
			boolean isActif = Boolean.parseBoolean(actif);
			req.append(" AND REG_CORPS_ACTIF = ").append(isActif);
		}

		// Prise en compte du champ avecAgent
		if (avecAgent != null) {
			boolean withAgent = Boolean.parseBoolean(avecAgent);
			if (withAgent) {
				req.append(" AND (REG_CORPS_NBAGENTH > 0 OR REG_CORPS_NBAGENTF > 0)");
			} else {
				req.append(" AND REG_CORPS_NBAGENTH = 0 AND REG_CORPS_NBAGENTF = 0");
			}

		}

		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		try {
			con = DriverManager.getConnection(UTILS.getUrl(), UTILS.getUser(), UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			int j = rechercheLength;
			for (int i = 0; i < rechercheLength; i++) {
				st.setString(i + 1, rechercheNormalizedSplit[i]);
			}
			if (ministere != null) {
				j++;
				Array a = con.createArrayOf("text", SPLIT_ID_PATTERN.matcher(ministere).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (categorie != null) {
				j++;
				Array a = con.createArrayOf("text", SPLIT_ID_PATTERN.matcher(categorie).replaceAll("").split(","));
				st.setArray(j, a);
			}
			rs = st.executeQuery();
			while (rs.next()) {
				Reglementaire corps = processCorps(rs);
				list.add(corps);
			}
			return list;
		} catch (SQLException e) {
			UTILS.erreurAccesBase(e);
		} catch (Exception e) {
			UTILS.erreurInnatendue(e);
		} finally {
			UTILS.closeConnexion(rs, st, con);
		}
		return list;
	}

	/*
	 * Récupère les informations des grades avec une liste id
	 */
	public List<Reglementaire> getGradeById(String idGrade) {

		StringBuilder req = new StringBuilder();

		req.append(
				"SELECT * from (SELECT reg.REG_CORPS_IDENTIFIANT, reg.REG_GRADE_CODE, REG_GRADE_REPERTOIRE, REG_GRADE_LIBELLE_LONG, REG_GRADE_LIBELLE_COURT, REG_GRADE_DATE_DEBUT, REG_GRADE_DATE_FIN")
				.append(", REG_GRADE_DATE_FIN isnull or REG_GRADE_DATE_FIN > current_date as REG_GRADE_ACTIF")
				.append(", REG_GRADE_NBAGENTH, REG_GRADE_NBAGENTF FROM REGLEMENTAIRE reg")
				.append(" LEFT JOIN (Select reg.reg_grade_code, count(distinct agent_matricule_renoirh) AS REG_GRADE_NBAGENTH FROM REGLEMENTAIRE reg LEFT JOIN (Select agent.agent_matricule_renoirh, AGENT.agent_carriere_emploi_fonctionnel_grade FROM AGENT WHERE AGENT_SEXE = 'H' and (agent_carriere_active_date_fin is null or agent_carriere_active_date_fin < '02/04/2019')) H ON reg.reg_grade_code = agent_carriere_emploi_fonctionnel_grade")
				.append(" GROUP BY reg_grade_code) H on reg.reg_grade_code = H.reg_grade_code")
				.append(" LEFT JOIN (Select reg.reg_grade_code, count(distinct agent_matricule_renoirh) AS REG_GRADE_NBAGENTF FROM REGLEMENTAIRE reg LEFT JOIN (Select agent.agent_matricule_renoirh, AGENT.agent_carriere_emploi_fonctionnel_grade FROM AGENT WHERE AGENT_SEXE = 'F'and (agent_carriere_active_date_fin is null or agent_carriere_active_date_fin < '02/04/2019')) F ON reg.reg_grade_code = agent_carriere_emploi_fonctionnel_grade")
				.append(" GROUP BY reg_grade_code) F on reg.reg_grade_code = F.reg_grade_code ) req")
				.append(" WHERE reg_grade_code = ANY(?) ");

		ArrayList<Reglementaire> listReglementaire = new ArrayList<>();
		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		try {
			con = DriverManager.getConnection(UTILS.getUrl(), UTILS.getUser(), UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			String[] idGra = SPLIT_ID_PATTERN.matcher(idGrade).replaceAll("").split(",");
			Array a = con.createArrayOf("text", idGra);
			st.setArray(1, a);
			rs = st.executeQuery();
			ArrayList<String> listIdGra = new ArrayList<>(Arrays.asList(idGra));
			while (rs.next()) {
				listReglementaire.add(processGrade(rs));
				String GraID = rs.getString(ReglementaireEnum.REG_GRADE_CODE.toString());
				listIdGra.remove(GraID);
			}
			for (String s : listIdGra) {
				Reglementaire g = new Reglementaire();
				g.setReglementaireGradeIdentifiant(s);
				g.setErreur("404 : Grade non trouvé");
				listReglementaire.add(g);
			}
			return listReglementaire;
		} catch (SQLException e) {
			UTILS.erreurAccesBase(e);
		} catch (Exception e) {
			UTILS.erreurInnatendue(e);
		} finally {
			UTILS.closeConnexion(rs, st, con);
		}
		return listReglementaire;
	}

	/*
	 * Récupère la liste de grades associées aux paramètres de recherches fournis
	 */
	public List<Reglementaire> getGradeList(String recherche, String corps, String actif, String avecAgent) {

		ArrayList<Reglementaire> listGrade = new ArrayList<>();

		StringBuilder req = new StringBuilder();
		req.append(
				"select * from (SELECT reg.REG_CORPS_IDENTIFIANT, reg.REG_GRADE_CODE, REG_GRADE_REPERTOIRE, REG_GRADE_LIBELLE_LONG, REG_GRADE_LIBELLE_COURT, REG_GRADE_DATE_DEBUT, REG_GRADE_DATE_FIN")
				.append(", REG_GRADE_DATE_FIN isnull or REG_GRADE_DATE_FIN > current_date as REG_GRADE_ACTIF")
				.append(", REG_GRADE_NBAGENTH, REG_GRADE_NBAGENTF, search FROM REGLEMENTAIRE reg")
				.append(" LEFT JOIN (Select reg.reg_grade_code, count(distinct agent_matricule_renoirh) AS REG_GRADE_NBAGENTH FROM REGLEMENTAIRE reg LEFT JOIN (Select agent.agent_matricule_renoirh, AGENT.agent_carriere_emploi_fonctionnel_grade FROM AGENT WHERE AGENT_SEXE = 'H' and (agent_carriere_active_date_fin is null or agent_carriere_active_date_fin < '02/04/2019')) H ON reg.reg_grade_code = agent_carriere_emploi_fonctionnel_grade")
				.append(" GROUP BY reg_grade_code) H on reg.reg_grade_code = H.reg_grade_code")
				.append(" LEFT JOIN (Select reg.reg_grade_code, count(distinct agent_matricule_renoirh) AS REG_GRADE_NBAGENTF FROM REGLEMENTAIRE reg LEFT JOIN (Select agent.agent_matricule_renoirh, AGENT.agent_carriere_emploi_fonctionnel_grade FROM AGENT WHERE AGENT_SEXE = 'F'and (agent_carriere_active_date_fin is null or agent_carriere_active_date_fin < '02/04/2019')) F ON reg.reg_grade_code = agent_carriere_emploi_fonctionnel_grade")
				.append(" GROUP BY reg_grade_code) F on reg.reg_grade_code = F.reg_grade_code ) as result")
				.append(" WHERE");

		// Prise en compte du champ recherche
		String rechercheNormalized;
		String[] rechercheNormalizedSplit = { "" };
		if (recherche != null) {
			// On retire les accents et on met en minuscule le texte de recherche
			rechercheNormalized = StringUtils.stripAccents(recherche.toLowerCase());
			rechercheNormalizedSplit = rechercheNormalized.split(" ");
		}

		int rechercheLength = rechercheNormalizedSplit.length;
		req.append(" search ~ ?");
		for (int i = 1; i < rechercheLength; i++) {
			req.append(" and search ~ ?");
		}

		if (corps != null) {
			req.append(" AND REG_CORPS_IDENTIFIANT = ANY(?)");
		}

		// Prise en compte du champ actif
		if (actif != null) {
			boolean isActif = Boolean.parseBoolean(actif);
			req.append(" AND REG_GRADE_ACTIF = ")
					.append(isActif);
		}

		// Prise en compte du champ avecAgent
		if (avecAgent != null) {
			boolean withAgent = Boolean.parseBoolean(avecAgent);
			if (withAgent) {
				req.append(" AND (REG_GRADE_NBAGENTH > 0 OR REG_GRADE_NBAGENTF > 0)");
			} else {
				req.append(" AND REG_GRADE_NBAGENTH = 0 AND REG_GRADE_NBAGENTF = 0");
			}

		}

		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		try {
			con = DriverManager.getConnection(UTILS.getUrl(), UTILS.getUser(), UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			int j = rechercheLength;
			for (int i = 0; i < rechercheLength; i++) {
				st.setString(i + 1, rechercheNormalizedSplit[i]);
			}
			if (corps != null) {
				j++;
				Array a = con.createArrayOf("text", SPLIT_ID_PATTERN.matcher(corps).replaceAll("").split(","));
				st.setArray(j, a);
			}
			LOG.info(st.toString());
			rs = st.executeQuery();
			while (rs.next()) {
				listGrade.add(processGrade(rs));
			}
			LOG.info("{}", listGrade.size());
			return listGrade;
		} catch (SQLException e) {
			UTILS.erreurAccesBase(e);
		} catch (Exception e) {
			UTILS.erreurInnatendue(e);
		} finally {
			UTILS.closeConnexion(rs, st, con);
		}
		return listGrade;
	}

	/*
	 * Récupère un reglementaire complet
	 */
	protected Reglementaire processRow(ResultSet rs) throws SQLException, ParseException {
		Reglementaire reglementaire = new Reglementaire();
		reglementaire
				.setReglementaireCorpsIdentifiant(rs.getString(ReglementaireEnum.REG_CORPS_IDENTIFIANT.toString()));
		reglementaire
				.setReglementaireCorpsLibelleLong(rs.getString(ReglementaireEnum.REG_CORPS_LIBELLE_LONG.toString()));
		reglementaire
				.setReglementaireCorpsLibelleCourt(rs.getString(ReglementaireEnum.REG_CORPS_LIBELLE_COURT.toString()));
		reglementaire
				.setReglementaireCodeMinistere(rs.getString(ReglementaireEnum.REG_CORPS_CODE_MINISTERE.toString()));
		reglementaire.setReglementaireCorpsCategorieAdmin(
				rs.getString(ReglementaireEnum.REG_CORPS_CATEGORIE_ADMIN.toString()));
		reglementaire.setReglementareCorpsDateDebut(rs.getString(ReglementaireEnum.REG_CORPS_DATE_DEBUT.toString()));
		reglementaire.setReglementaireCorpsDateFin(rs.getString(ReglementaireEnum.REG_CORPS_DATE_FIN.toString()));
		reglementaire.setReglementaireCorpsActif(
				Boolean.toString(rs.getBoolean(ReglementaireEnum.REG_CORPS_ACTIF.toString())));
		int corpsNbAgentH = rs.getInt(ReglementaireEnum.REG_CORPS_NBAGENTH.toString());
		int corpsNbAgentF = rs.getInt(ReglementaireEnum.REG_CORPS_NBAGENTF.toString());
		int corpsNbAgent = corpsNbAgentH + corpsNbAgentF;
		boolean corpsAvecAgent = corpsNbAgent != 0;
		reglementaire.setReglementaireCorpsAvecAgents(Boolean.toString(corpsAvecAgent));
		reglementaire.setReglementaireCorpsNbAgentH(Integer.toString(corpsNbAgentH));
		reglementaire.setReglementaireCorpsNbAgentF(Integer.toString(corpsNbAgentF));
		reglementaire.setReglementaireCorpsNbAgent(Integer.toString(corpsNbAgent));
		reglementaire.setReglementaireGradeIdentifiant(rs.getString(ReglementaireEnum.REG_GRADE_CODE.toString()));
		reglementaire.setReglementaireGradeRepertoire(rs.getString(ReglementaireEnum.REG_GRADE_REPERTOIRE.toString()));
		reglementaire
				.setReglementaireGradeLibelleLong(rs.getString(ReglementaireEnum.REG_GRADE_LIBELLE_LONG.toString()));
		reglementaire
				.setReglementaireGradeLibelleCourt(rs.getString(ReglementaireEnum.REG_GRADE_LIBELLE_COURT.toString()));
		reglementaire.setReglementaireGradeCorps(rs.getString(ReglementaireEnum.REG_CORPS_IDENTIFIANT.toString()));
		reglementaire.setReglementareGradeDateDebut(rs.getString(ReglementaireEnum.REG_GRADE_DATE_DEBUT.toString()));
		reglementaire.setReglementaireGradeDateFin(rs.getString(ReglementaireEnum.REG_GRADE_DATE_FIN.toString()));
		reglementaire.setReglementaireGradeActif(
				Boolean.toString(rs.getBoolean(ReglementaireEnum.REG_GRADE_ACTIF.toString())));
		int gradeNbAgentH = rs.getInt(ReglementaireEnum.REG_CORPS_NBAGENTH.toString());
		int gradeNbAgentF = rs.getInt(ReglementaireEnum.REG_CORPS_NBAGENTF.toString());
		int gradeNbAgent = gradeNbAgentH + gradeNbAgentF;
		boolean gradeAvecAgent = gradeNbAgent != 0;
		reglementaire.setReglementaireGradeAvecAgents(Boolean.toString(gradeAvecAgent));
		reglementaire.setReglementaireGradeNbAgentH(Integer.toString(gradeNbAgentH));
		reglementaire.setReglementaireGradeNbAgentF(Integer.toString(gradeNbAgentF));
		reglementaire.setReglementaireGradeNbAgent(Integer.toString(gradeNbAgent));
		return reglementaire;
	}

	/*
	 * Récupère la partie corps d'un reglementaire
	 */
	protected Reglementaire processCorps(ResultSet rs) throws SQLException, ParseException {
		Reglementaire reglementaire = new Reglementaire();
		reglementaire
				.setReglementaireCorpsIdentifiant(rs.getString(ReglementaireEnum.REG_CORPS_IDENTIFIANT.toString()));
		reglementaire
				.setReglementaireCorpsLibelleLong(rs.getString(ReglementaireEnum.REG_CORPS_LIBELLE_LONG.toString()));
		reglementaire
				.setReglementaireCorpsLibelleCourt(rs.getString(ReglementaireEnum.REG_CORPS_LIBELLE_COURT.toString()));
		reglementaire
				.setReglementaireCodeMinistere(rs.getString(ReglementaireEnum.REG_CORPS_CODE_MINISTERE.toString()));
		reglementaire.setReglementaireCorpsCategorieAdmin(
				rs.getString(ReglementaireEnum.REG_CORPS_CATEGORIE_ADMIN.toString()));
		reglementaire.setReglementareCorpsDateDebut(rs.getString(ReglementaireEnum.REG_CORPS_DATE_DEBUT.toString()));
		reglementaire.setReglementaireCorpsDateFin(rs.getString(ReglementaireEnum.REG_CORPS_DATE_FIN.toString()));
		reglementaire.setReglementaireCorpsActif(
				Boolean.toString(rs.getBoolean(ReglementaireEnum.REG_CORPS_ACTIF.toString())));
		int corpsNbAgentH = rs.getInt(ReglementaireEnum.REG_CORPS_NBAGENTH.toString());
		int corpsNbAgentF = rs.getInt(ReglementaireEnum.REG_CORPS_NBAGENTF.toString());
		int corpsNbAgent = corpsNbAgentH + corpsNbAgentF;
		boolean corpsAvecAgent = corpsNbAgent != 0;
		reglementaire.setReglementaireCorpsAvecAgents(Boolean.toString(corpsAvecAgent));
		reglementaire.setReglementaireCorpsNbAgentH(Integer.toString(corpsNbAgentH));
		reglementaire.setReglementaireCorpsNbAgentF(Integer.toString(corpsNbAgentF));
		reglementaire.setReglementaireCorpsNbAgent(Integer.toString(corpsNbAgent));
		return reglementaire;
	}

	/*
	 * Récupère la partie grade d'un reglementaire
	 */
	protected Reglementaire processGrade(ResultSet rs) throws SQLException, ParseException {
		Reglementaire reglementaire = new Reglementaire();
		reglementaire.setReglementaireGradeIdentifiant(rs.getString(ReglementaireEnum.REG_GRADE_CODE.toString()));
		reglementaire.setReglementaireGradeRepertoire(rs.getString(ReglementaireEnum.REG_GRADE_REPERTOIRE.toString()));
		reglementaire
				.setReglementaireGradeLibelleLong(rs.getString(ReglementaireEnum.REG_GRADE_LIBELLE_LONG.toString()));
		reglementaire
				.setReglementaireGradeLibelleCourt(rs.getString(ReglementaireEnum.REG_GRADE_LIBELLE_COURT.toString()));
		reglementaire.setReglementaireGradeCorps(rs.getString(ReglementaireEnum.REG_CORPS_IDENTIFIANT.toString()));
		reglementaire.setReglementareGradeDateDebut(rs.getString(ReglementaireEnum.REG_GRADE_DATE_DEBUT.toString()));
		reglementaire.setReglementaireGradeDateFin(rs.getString(ReglementaireEnum.REG_GRADE_DATE_FIN.toString()));
		reglementaire.setReglementaireGradeActif(
				Boolean.toString(rs.getBoolean(ReglementaireEnum.REG_GRADE_ACTIF.toString())));
		String s = Integer.toString(rs.getInt(ReglementaireEnum.REG_GRADE_NBAGENTH.toString()));
		int gradeNbAgentH = rs.getInt(ReglementaireEnum.REG_GRADE_NBAGENTH.toString());
		int gradeNbAgentF = rs.getInt(ReglementaireEnum.REG_GRADE_NBAGENTF.toString());
		int gradeNbAgent = gradeNbAgentH + gradeNbAgentF;
		boolean gradeAvecAgent = gradeNbAgent != 0;
		reglementaire.setReglementaireGradeAvecAgents(Boolean.toString(gradeAvecAgent));
		reglementaire.setReglementaireGradeNbAgentH(Integer.toString(gradeNbAgentH));
		reglementaire.setReglementaireGradeNbAgentF(Integer.toString(gradeNbAgentF));
		reglementaire.setReglementaireGradeNbAgent(Integer.toString(gradeNbAgent));
		return reglementaire;
	}

}

```

</details>


---

### 📄 `src/main/java/ze/reglementaire/ReglementaireEnum.java` [575 octets]
<a id="src-main-java-ze-reglementaire-ReglementaireEnum-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-reglementaire-ReglementaireEnum-java)

> **Chemin relatif** : `src/main/java/ze/reglementaire/ReglementaireEnum.java`  
> **Taille** : 575 octets  
> **Lignes** : 29  
> **Type** : java

```java
package ze.reglementaire;

public enum ReglementaireEnum {
	REG_CORPS_IDENTIFIANT,
	REG_CORPS_LIBELLE_LONG,
	REG_CORPS_LIBELLE_COURT,
	REG_CORPS_CODE_MINISTERE,
	REG_CORPS_CATEGORIE_ADMIN,
	REG_CORPS_DATE_DEBUT,
	REG_CORPS_DATE_FIN,
	REG_CORPS_ACTIF,
	REG_CORPS_AVECAGENT,
	REG_CORPS_NBAGENT,
	REG_CORPS_NBAGENTH,
	REG_CORPS_NBAGENTF,
	REG_GRADE_CODE,
	REG_GRADE_REPERTOIRE,
	REG_GRADE_LIBELLE_LONG,
	REG_GRADE_LIBELLE_COURT,
	REG_GRADE_DATE_DEBUT,
	REG_GRADE_DATE_FIN,
	REG_GRADE_ACTIF,
	REG_GRADE_AVECAGENT,
	REG_GRADE_NBAGENT,
	REG_GRADE_NBAGENTH,
	REG_GRADE_NBAGENTF;

}

```


---

### 📄 `src/main/java/ze/remuneration/Remuneration.java` [7.416 octets]
<a id="src-main-java-ze-remuneration-Remuneration-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-remuneration-Remuneration-java)

> **Chemin relatif** : `src/main/java/ze/remuneration/Remuneration.java`  
> **Taille** : 7.416 octets  
> **Lignes** : 324  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (324 lignes) - Cliquer pour déplier</summary>

```java
package ze.remuneration;

import javax.xml.bind.annotation.XmlRootElement;
import javax.xml.bind.annotation.XmlType;

import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;

@XmlRootElement(name = "Remuneration")
@XmlType(
		name = "",
		propOrder = { "remMatcleRen", "remDebPaye", "remFinPaye", "remDatExtPaye", "remCodeTG", "remNumDos",
				"remDosPaie", "remDosPaie", "remDebAffect", "remFinDos", "remIdInterne", "remNomRegle", "remMatcle",
				"remEffetCharge", "remFinZone", "remCodeTGPreliq", "remNumDosPreliq", "remAdmin", "remCorres",
				"remDepSer",
				"remRegime", "remTGSpec", "remDosSpec", "remEffetReg", "remFinReg", "remAnnPaie", "remMoisPaie",
				"remValid",
				"remAnnul", "remEffetPec" })
@JsonInclude(JsonInclude.Include.NON_DEFAULT)
public class Remuneration {

	private String remMatcleRen;

	// private String remDebPaye;
	// private String remFinPaye;
	// private String remDatExtPaye;
	private String remCodeTG;

	private String remNumDos;

	private String remDosPaie;

	private String remDebAffect;

	private String remFinDos;

	private String remIdInterne;

	private String remNomRegle;

	private String remMatcle;

	private String remEffetCharge;

	private String remFinZone;

	private String remCodeTGPreliq;

	private String remNumDosPreliq;

	private String remAdmin;

	private String remCorres;

	private String remDepSer;

	private String remRegime;

	private String remTGSpec;

	private String remDosSpec;

	private String remEffetReg;

	private String remFinReg;

	private String remAnnPaie;

	private String remMoisPaie;

	private String remValid;

	private String remAnnul;

	private String remEffetPec;

	@JsonProperty("remuneration_matricule_agent_renoirh")
	public String getRemMatcleRen() {
		return remMatcleRen;
	}

	public void setRemMatcleRen(String remMatcleRen) {
		this.remMatcleRen = remMatcleRen;
	}

	/*
	 * @JsonProperty("remuneration_date_debut_saisie_mois_paye") public String
	 * getRemDebPaye() { return remDebPaye; } public void setRemDebPaye(String
	 * remDebPaye) { this.remDebPaye = remDebPaye; }
	 * @JsonProperty("remuneration_date_fin_saisie_mois_paye") public String
	 * getRemFinPaye() { return remFinPaye; } public void setRemFinPaye(String
	 * remFinPaye) { this.remFinPaye = remFinPaye; }
	 * @JsonProperty("remuneration_date_extreme_mise_en_paye_dgfip") public String
	 * getRemDatExtPaye() { return remDatExtPaye; } public void
	 * setRemDatExtPaye(String remDatExtPaye) { this.remDatExtPaye = remDatExtPaye;
	 * }
	 */
	@JsonProperty("remuneration_code_tresorerie_generale")
	public String getRemCodeTG() {
		return remCodeTG;
	}

	public void setRemCodeTG(String remCodeTG) {
		this.remCodeTG = remCodeTG;
	}

	@JsonProperty("remuneration_numero_de_dossier")
	public String getRemNumDos() {
		return remNumDos;
	}

	public void setRemNumDos(String remNumDos) {
		this.remNumDos = remNumDos;
	}

	@JsonProperty("remuneration_dossier_de_paie_principal")
	public String getRemDosPaie() {
		return remDosPaie;
	}

	public void setRemDosPaie(String remDosPaie) {
		this.remDosPaie = remDosPaie;
	}

	@JsonProperty("remuneration_date_debut_affectation_tg")
	public String getRemDebAffect() {
		return remDebAffect;
	}

	public void setRemDebAffect(String remDebAffect) {
		this.remDebAffect = remDebAffect;
	}

	@JsonProperty("remuneration_date_fin_dossier_principal")
	public String getRemFinDos() {
		return remFinDos;
	}

	public void setRemFinDos(String remFinDos) {
		this.remFinDos = remFinDos;
	}

	@JsonProperty("remuneration_identifiant_interne")
	public String getRemIdInterne() {
		return remIdInterne;
	}

	public void setRemIdInterne(String remIdInterne) {
		this.remIdInterne = remIdInterne;
	}

	@JsonProperty("remuneration_nom_reglementation")
	public String getRemNomRegle() {
		return remNomRegle;
	}

	public void setRemNomRegle(String remNomRegle) {
		this.remNomRegle = remNomRegle;
	}

	@JsonProperty("remuneration_matricule")
	public String getRemMatcle() {
		return remMatcle;
	}

	public void setRemMatcle(String remMatcle) {
		this.remMatcle = remMatcle;
	}

	@JsonProperty("remuneration_date_effet_prise_en_charge")
	public String getRemEffetCharge() {
		return remEffetCharge;
	}

	public void setRemEffetCharge(String remEffetCharge) {
		this.remEffetCharge = remEffetCharge;
	}

	@JsonProperty("remuneration_date_fin_zone_commune")
	public String getRemFinZone() {
		return remFinZone;
	}

	public void setRemFinZone(String remFinZone) {
		this.remFinZone = remFinZone;
	}

	@JsonProperty("remuneration_code_tg")
	public String getRemCodeTGPreliq() {
		return remCodeTGPreliq;
	}

	public void setRemCodeTGPreliq(String remCodeTGPreliq) {
		this.remCodeTGPreliq = remCodeTGPreliq;
	}

	@JsonProperty("remuneration_numero_dossier")
	public String getRemNumDosPreliq() {
		return remNumDosPreliq;
	}

	public void setRemNumDosPreliq(String remNumDosPreliq) {
		this.remNumDosPreliq = remNumDosPreliq;
	}

	@JsonProperty("remuneration_code_administration")
	public String getRemAdmin() {
		return remAdmin;
	}

	public void setRemAdmin(String remAdmin) {
		this.remAdmin = remAdmin;
	}

	@JsonProperty("remuneration_code_correspondant")
	public String getRemCorres() {
		return remCorres;
	}

	public void setRemCorres(String remCorres) {
		this.remCorres = remCorres;
	}

	@JsonProperty("remuneration_departement_service_gestionnaire")
	public String getRemDepSer() {
		return remDepSer;
	}

	public void setRemDepSer(String remDepSer) {
		this.remDepSer = remDepSer;
	}

	@JsonProperty("remuneration_code_regime")
	public String getRemRegime() {
		return remRegime;
	}

	public void setRemRegime(String remRegime) {
		this.remRegime = remRegime;
	}

	@JsonProperty("remuneration_code_tg_specifique")
	public String getRemTGSpec() {
		return remTGSpec;
	}

	public void setRemTGSpec(String remTGSpec) {
		this.remTGSpec = remTGSpec;
	}

	@JsonProperty("remuneration_dossier_specifique")
	public String getRemDosSpec() {
		return remDosSpec;
	}

	public void setRemDosSpec(String remDosSpec) {
		this.remDosSpec = remDosSpec;
	}

	@JsonProperty("remuneration_date_effet_regime")
	public String getRemEffetReg() {
		return remEffetReg;
	}

	public void setRemEffetReg(String remEffetReg) {
		this.remEffetReg = remEffetReg;
	}

	@JsonProperty("remuneration_date_fin_regime")
	public String getRemFinReg() {
		return remFinReg;
	}

	public void setRemFinReg(String remFinReg) {
		this.remFinReg = remFinReg;
	}

	@JsonProperty("remuneration_annee_mise_en_paye")
	public String getRemAnnPaie() {
		return remAnnPaie;
	}

	public void setRemAnnPaie(String remAnnPaie) {
		this.remAnnPaie = remAnnPaie;
	}

	@JsonProperty("remuneration_mois_mise_en_paye")
	public String getRemMoisPaie() {
		return remMoisPaie;
	}

	public void setRemMoisPaie(String remMoisPaie) {
		this.remMoisPaie = remMoisPaie;
	}

	@JsonProperty("remuneration_temoin_validation_paye")
	public String getRemValid() {
		return remValid;
	}

	public void setRemValid(String remValid) {
		this.remValid = remValid;
	}

	@JsonProperty("remuneration_temoin_annulation_paye")
	public String getRemAnnul() {
		return remAnnul;
	}

	public void setRemAnnul(String remAnnul) {
		this.remAnnul = remAnnul;
	}

	@JsonProperty("remuneration_date_effet_pecuniere")
	public String getRemEffetPec() {
		return remEffetPec;
	}

	public void setRemEffetPec(String remEffetPec) {
		this.remEffetPec = remEffetPec;
	}

}

```

</details>


---

### 📄 `src/main/java/ze/remuneration/RemunerationDAO.java` [9.390 octets]
<a id="src-main-java-ze-remuneration-RemunerationDAO-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-remuneration-RemunerationDAO-java)

> **Chemin relatif** : `src/main/java/ze/remuneration/RemunerationDAO.java`  
> **Taille** : 9.390 octets  
> **Lignes** : 228  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (228 lignes) - Cliquer pour déplier</summary>

```java
package ze.remuneration;

import java.sql.Array;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;
import java.util.regex.Pattern;

import org.apache.commons.lang3.StringUtils;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import ze.agent.AgentDAO;
import ze.database.utils.DataBase;
import ze.impl.Utils;

public class RemunerationDAO {

	private static final Utils UTILS = new Utils();

	private static final Pattern SPLIT_ID_PATTERN = Pattern.compile("[()']");

	private static final Logger LOG = LoggerFactory.getLogger(RemunerationDAO.class);

	private static final int HUIT = 8;

	private static final int SIX = 6;

	private static final int QUATRE = 4;

	/*
	 * Récupère la liste de grades associées aux paramètres de recherches fournis
	 */
	public List<Remuneration> getList(String recherche, String matricule, String codeTG, String temoinAnnulation,
			String temoinValidationPaye, String exportDateFin, String exportDateEffet) {

		String[] rechercheNormalizedSplit = { "" };
		if (recherche != null) {
			// On retire les accents et on met en minuscule le texte de recherche
			rechercheNormalizedSplit = StringUtils.stripAccents(recherche.toLowerCase()).split(" ");
		}
		int rechercheLength = rechercheNormalizedSplit.length;

		StringBuilder req = createRequest(rechercheNormalizedSplit, rechercheLength, matricule, codeTG,
				temoinAnnulation, temoinValidationPaye, exportDateFin, exportDateEffet);

		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		List<Remuneration> listRemuneration = new ArrayList<>();
		try {
			con = DriverManager.getConnection(UTILS.getUrl(), UTILS.getUser(), UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			updateParam(rechercheLength, rechercheNormalizedSplit, matricule, codeTG, temoinValidationPaye,
					exportDateFin, exportDateEffet, con, st);
			LOG.info("{}", st.toString());
			rs = st.executeQuery();
			while (rs.next()) {
				listRemuneration.add(processRow(rs));
			}
			return listRemuneration;
		} catch (SQLException e) {
			UTILS.erreurAccesBase(e);
		} catch (Exception e) {
			UTILS.erreurInnatendue(e);
		} finally {
			UTILS.closeConnexion(rs, st, con);
		}
		return listRemuneration;
	}

	/*
	 * Création de la requête
	 */
	protected StringBuilder createRequest(String[] rechercheNormalizedSplit, int rechercheLength, String matricule,
			String codeTG, String temoinAnnulation, String temoinValidationPaye, String exportDateFin,
			String exportDateEffet) {
		StringBuilder req = new StringBuilder();
		req.append(" SELECT * FROM REMUNERATION WHERE 1=1 ");

		if (rechercheLength != 0) {
			Connection cnx = null;
			try {
				cnx = DriverManager.getConnection(RemunerationDAO.UTILS.getUrl(), RemunerationDAO.UTILS.getUser(),
						RemunerationDAO.UTILS.getPassword());
				req.append("AND (")
						.append(DataBase.getGoogleQuery(cnx, "REMUNERATION", rechercheNormalizedSplit))
						.append(")");
			} catch (final SQLException e) {
				RemunerationDAO.UTILS.erreurAccesBase(e);
			} catch (final Exception e) {
				RemunerationDAO.UTILS.erreurInnatendue(e);
			} finally {
				RemunerationDAO.UTILS.closeConnexion(null, null, cnx);
			}
		}
		// Prise en compte du champ matricule
		if (matricule != null) {
			req.append(" AND remuneration_matricule_agent_renoirh = ANY(?)");
		}

		// Prise en compte du champ codeTG
		if (codeTG != null) {
			req.append(" AND remuneration_code_tg_specifique = ANY(?)");
		}

		// Prise en compte du champ temoinAnnulation
		if (temoinAnnulation != null) {
			if ("A".equals(temoinAnnulation)) {
				req.append(" AND remuneration_temoin_annulation_paye = 'A'");
			} else {
				req.append(" AND remuneration_temoin_annulation_paye <> 'A'");
			}
		}

		// Prise en compte du champ temoinValidationPaye
		if (temoinValidationPaye != null) {
			req.append(" AND remuneration_temoin_validation_paye = ?");
		}

		// Prise en compte du champ exportDateFin
		if (exportDateFin != null) {
			if (exportDateFin.length() == HUIT) {
				req.append(" AND to_char(remuneration_date_fin_regime, 'YYYYMMDD') = ?");
			} else if (exportDateFin.length() == SIX) {
				req.append(" AND to_char(remuneration_date_fin_regime, 'YYYYMM') = ?");
			} else if (exportDateFin.length() == QUATRE) {
				req.append(" AND to_char(remuneration_date_fin_regime, 'YYYY') = ?");
			} else {
				throw new IllegalStateException();
			}
		}

		// Prise en compte du champ exportDateEffet
		if (exportDateEffet != null) {
			if (exportDateEffet.length() == HUIT) {
				req.append(" AND to_char(remuneration_date_fin_regime, 'YYYYMMDD') = ?");
			} else if (exportDateEffet.length() == SIX) {
				req.append(" AND to_char(remuneration_date_fin_regime, 'YYYYMM') = ?");
			} else if (exportDateEffet.length() == QUATRE) {
				req.append(" AND to_char(remuneration_date_fin_regime, 'YYYY') = ?");
			} else {
				throw new IllegalStateException();
			}
		}
		return req;
	}

	/*
	 * Mise à jour des paramètres de la requête
	 */
	protected void updateParam(int rechercheLength, String[] rechercheNormalizedSplit, String matricule, String codeTG,
			String temoinValidationPaye, String exportDateFin, String exportDateEffet, Connection con,
			PreparedStatement st) {
		try {
			int j = 0;
			if (matricule != null) {
				j++;
				Array a = con.createArrayOf("text", SPLIT_ID_PATTERN.matcher(matricule).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (codeTG != null) {
				j++;
				Array a = con.createArrayOf("text", SPLIT_ID_PATTERN.matcher(codeTG).replaceAll("").split(","));
				st.setArray(j, a);
			}
			if (temoinValidationPaye != null) {
				j++;
				st.setString(j, temoinValidationPaye);
			}
			if (exportDateFin != null) {
				j++;
				st.setString(j, exportDateFin);
			}
			if (exportDateEffet != null) {
				j++;
				st.setString(j, exportDateEffet);
			}
		} catch (SQLException e) {
			UTILS.erreurAccesBase(e);
		}

	}

	/*
	 * Récupère une rémunération complète
	 */
	protected Remuneration processRow(ResultSet rs) throws SQLException {
		Remuneration remuneration = new Remuneration();
		remuneration.setRemMatcleRen(rs.getString(RemunerationEnum.REMUNERATION_MATRICULE_AGENT_RENOIRH.toString()));
		// remuneration.setRemDebPaye(rs.getString(RemunerationEnum.REMUNERATION_DATE_DEBUT_SAISIE_MOIS_PAYE.toString()));
		// remuneration.setRemFinPaye(rs.getString(RemunerationEnum.REMUNERATION_DATE_FIN_SAISIE_MOIS_PAYE.toString()));
		// remuneration.setRemDatExtPaye(rs.getString(RemunerationEnum.REMUNERATION_DATE_EXTREME_MISE_EN_PAYE_DGFIP.toString()));
		remuneration.setRemCodeTG(rs.getString(RemunerationEnum.REMUNERATION_CODE_TRESORERIE_GENERALE.toString()));
		remuneration.setRemNumDos(rs.getString(RemunerationEnum.REMUNERATION_NUMERO_DE_DOSSIER.toString()));
		remuneration.setRemDosPaie(rs.getString(RemunerationEnum.REMUNERATION_DOSSIER_DE_PAIE_PRINCIPAL.toString()));
		remuneration.setRemDebAffect(rs.getString(RemunerationEnum.REMUNERATION_DATE_DEBUT_AFFECTATION_TG.toString()));
		remuneration.setRemFinDos(rs.getString(RemunerationEnum.REMUNERATION_DATE_FIN_DOSSIER_PRINCIPAL.toString()));
		remuneration.setRemIdInterne(rs.getString(RemunerationEnum.REMUNERATION_IDENTIFIANT_INTERNE.toString()));
		remuneration.setRemNomRegle(rs.getString(RemunerationEnum.REMUNERATION_NOM_REGLEMENTATION.toString()));
		remuneration.setRemMatcle(rs.getString(RemunerationEnum.REMUNERATION_MATRICULE.toString()));
		remuneration
				.setRemEffetCharge(rs.getString(RemunerationEnum.REMUNERATION_DATE_EFFET_PRISE_EN_CHARGE.toString()));
		remuneration.setRemFinZone(rs.getString(RemunerationEnum.REMUNERATION_DATE_FIN_ZONE_COMMUNE.toString()));
		remuneration.setRemCodeTGPreliq(rs.getString(RemunerationEnum.REMUNERATION_CODE_TG.toString()));
		remuneration.setRemNumDosPreliq(rs.getString(RemunerationEnum.REMUNERATION_NUMERO_DOSSIER.toString()));
		remuneration.setRemAdmin(rs.getString(RemunerationEnum.REMUNERATION_CODE_ADMINISTRATION.toString()));
		remuneration.setRemCorres(rs.getString(RemunerationEnum.REMUNERATION_CODE_CORRESPONDANT.toString()));
		remuneration
				.setRemDepSer(rs.getString(RemunerationEnum.REMUNERATION_DEPARTEMENT_SERVICE_GESTIONNAIRE.toString()));
		remuneration.setRemRegime(rs.getString(RemunerationEnum.REMUNERATION_CODE_REGIME.toString()));
		remuneration.setRemTGSpec(rs.getString(RemunerationEnum.REMUNERATION_CODE_TG_SPECIFIQUE.toString()));
		remuneration.setRemDosSpec(rs.getString(RemunerationEnum.REMUNERATION_DOSSIER_SPECIFIQUE.toString()));
		remuneration.setRemEffetReg(rs.getString(RemunerationEnum.REMUNERATION_DATE_EFFET_REGIME.toString()));
		remuneration.setRemFinReg(rs.getString(RemunerationEnum.REMUNERATION_DATE_FIN_REGIME.toString()));
		remuneration.setRemAnnPaie(rs.getString(RemunerationEnum.REMUNERATION_ANNEE_MISE_EN_PAYE.toString()));
		remuneration.setRemMoisPaie(rs.getString(RemunerationEnum.REMUNERATION_MOIS_MISE_EN_PAYE.toString()));
		remuneration.setRemValid(rs.getString(RemunerationEnum.REMUNERATION_TEMOIN_VALIDATION_PAYE.toString()));
		remuneration.setRemAnnul(rs.getString(RemunerationEnum.REMUNERATION_TEMOIN_ANNULATION_PAYE.toString()));
		remuneration.setRemEffetPec(rs.getString(RemunerationEnum.REMUNERATION_DATE_EFFET_PECUNIERE.toString()));
		return remuneration;
	}
}

```

</details>


---

### 📄 `src/main/java/ze/remuneration/RemunerationEnum.java` [1.118 octets]
<a id="src-main-java-ze-remuneration-RemunerationEnum-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-remuneration-RemunerationEnum-java)

> **Chemin relatif** : `src/main/java/ze/remuneration/RemunerationEnum.java`  
> **Taille** : 1.118 octets  
> **Lignes** : 36  
> **Type** : java

```java
package ze.remuneration;

public enum RemunerationEnum {

	REMUNERATION_MATRICULE_AGENT_RENOIRH,
	// REMUNERATION_DATE_DEBUT_SAISIE_MOIS_PAYE,
	// REMUNERATION_DATE_FIN_SAISIE_MOIS_PAYE,
	// REMUNERATION_DATE_EXTREME_MISE_EN_PAYE_DGFIP,
	REMUNERATION_CODE_TRESORERIE_GENERALE,
	REMUNERATION_NUMERO_DE_DOSSIER,
	REMUNERATION_DOSSIER_DE_PAIE_PRINCIPAL,
	REMUNERATION_DATE_DEBUT_AFFECTATION_TG,
	REMUNERATION_DATE_FIN_DOSSIER_PRINCIPAL,
	REMUNERATION_IDENTIFIANT_INTERNE,
	REMUNERATION_NOM_REGLEMENTATION,
	REMUNERATION_MATRICULE,
	REMUNERATION_DATE_EFFET_PRISE_EN_CHARGE,
	REMUNERATION_DATE_FIN_ZONE_COMMUNE,
	REMUNERATION_CODE_TG,
	REMUNERATION_NUMERO_DOSSIER,
	REMUNERATION_CODE_ADMINISTRATION,
	REMUNERATION_CODE_CORRESPONDANT,
	REMUNERATION_DEPARTEMENT_SERVICE_GESTIONNAIRE,
	REMUNERATION_CODE_REGIME,
	REMUNERATION_CODE_TG_SPECIFIQUE,
	REMUNERATION_DOSSIER_SPECIFIQUE,
	REMUNERATION_DATE_EFFET_REGIME,
	REMUNERATION_DATE_FIN_REGIME,
	REMUNERATION_ANNEE_MISE_EN_PAYE,
	REMUNERATION_MOIS_MISE_EN_PAYE,
	REMUNERATION_TEMOIN_VALIDATION_PAYE,
	REMUNERATION_TEMOIN_ANNULATION_PAYE,
	REMUNERATION_DATE_EFFET_PECUNIERE;

}

```


---

### 📄 `src/main/java/ze/unitestructurelle/ArbreUniteStructurelle.java` [987 octets]
<a id="src-main-java-ze-unitestructurelle-ArbreUniteStructurelle-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-unitestructurelle-ArbreUniteStructurelle-java)

> **Chemin relatif** : `src/main/java/ze/unitestructurelle/ArbreUniteStructurelle.java`  
> **Taille** : 987 octets  
> **Lignes** : 43  
> **Type** : java

```java
package ze.unitestructurelle;

import java.util.ArrayList;
import java.util.List;

import javax.xml.bind.annotation.XmlRootElement;
import javax.xml.bind.annotation.XmlType;

import com.fasterxml.jackson.annotation.JsonInclude;

@XmlRootElement(name = "ArbreUniteStructurelle")
@XmlType(name = "", propOrder = { "us", "filles" })
@JsonInclude(JsonInclude.Include.NON_NULL)
public class ArbreUniteStructurelle {

	private UniteStructurelle us;

	private List<ArbreUniteStructurelle> filles = new ArrayList<>();

	public ArbreUniteStructurelle addFille(UniteStructurelle fille) {
		ArbreUniteStructurelle enfant = new ArbreUniteStructurelle();
		enfant.setUs(fille);
		filles.add(enfant);
		return enfant;
	}

	public List<ArbreUniteStructurelle> getFilles() {
		return filles;
	}

	public void setFilles(List<ArbreUniteStructurelle> filles) {
		this.filles = filles;
	}

	public UniteStructurelle getUs() {
		return us;
	}

	public void setUs(UniteStructurelle us) {
		this.us = us;
	}
}

```


---

### 📄 `src/main/java/ze/unitestructurelle/UniteStructurelle.java` [10.613 octets]
<a id="src-main-java-ze-unitestructurelle-UniteStructurelle-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-unitestructurelle-UniteStructurelle-java)

> **Chemin relatif** : `src/main/java/ze/unitestructurelle/UniteStructurelle.java`  
> **Taille** : 10.613 octets  
> **Lignes** : 474  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (474 lignes) - Cliquer pour déplier</summary>

```java
package ze.unitestructurelle;

import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;

import javax.xml.bind.annotation.XmlRootElement;
import javax.xml.bind.annotation.XmlType;

@XmlRootElement(name = "UniteStructurelle")
@XmlType(
		name = "",
		propOrder = { "usIdentifiant", "erreur", "usLibelleLong", "usLibelleCourt", "usDateCreation", "usDateFermeture",
				"usNature", "usTypeUs", "usCodeMinistere", "usNumeroVoie",
				"usVoieBisTer", "usLibelleVoie", "usComplementAgent", "usCodePostal", "usCodeInsee", "usCommune",
				"usDepartement", "usPays", "usBureauDistributeur",
				"usNiveau", "usMere", "usTypeArborescence", "usDateDebutRattachement", "usDateFinRattachement",
				"usTypeOrganisation", "usUniteOrganisationnelle",
				"usLibelleCourtUo", "usStructureUo", "usDateEffet", "usDateFin", "usNomResponsableUo",
				"usNiveauDirection", "usNiveauService", "usNiveauUniteStructurelle",
				"nudoss", "usActif" })
@JsonInclude(JsonInclude.Include.NON_DEFAULT)
public class UniteStructurelle {

	private String usIdentifiant;

	private String erreur;

	private String usLibelleLong;

	private String usLibelleCourt;

	private String usDateCreation;

	private String usDateFermeture;

	private String usNature;

	private String usTypeUs;

	private String usTypeLibelle;

	private String usCodeMinistere;

	private String usNumeroVoie;

	private String usVoieBisTer;

	private String usLibelleVoie;

	private String usComplementAgent;

	private String usCodePostal;

	private String usCodeInsee;

	private String usCommune;

	private String usDepartement;

	private String usPays;

	private String usBureauDistributeur;

	private String usNiveau;

	private String usMere;

	private String usTypeArborescence;

	private String usDateDebutRattachement;

	private String usDateFinRattachement;

	private String usTypeOrganisation;

	private String usUniteOrganisationnelle;

	private String usLibelleCourtUo;

	private String usStructureUo;

	private String usDateEffet;

	private String usDateFin;

	private String usNomResponsableUo;

	private String usNiveauDirection;

	private String usNiveauService;

	private String usNiveauUniteStructurelle;

	private String nudoss;

	private boolean usActif;

	private int usNombreAgent;

	private int usNombreAgentH;

	private int usNombreAgentF;

	private boolean usAvecAgent;

	@JsonProperty("us_identifiant")
	public String getUsIdentifiant() {
		return this.usIdentifiant;
	}

	public String getErreur() {
		return this.erreur;
	}

	public void setErreur(String erreur) {
		this.erreur = erreur;
	}

	public void setUsIdentifiant(String usIdentifiant) {
		this.usIdentifiant = usIdentifiant;
	}

	@JsonProperty("us_libelle_long")
	public String getUsLibelleLong() {
		return this.usLibelleLong;
	}

	public void setUsLibelleLong(String usLibelleLong) {
		this.usLibelleLong = usLibelleLong;
	}

	@JsonProperty("us_libelle_court")
	public String getUsLibelleCourt() {
		return this.usLibelleCourt;
	}

	public void setUsLibelleCourt(String usLibelleCourt) {
		this.usLibelleCourt = usLibelleCourt;
	}

	@JsonProperty("us_date_creation")
	public String getUsDateCreation() {
		return this.usDateCreation;
	}

	public void setUsDateCreation(String usDateCreation) {
		this.usDateCreation = usDateCreation;
	}

	@JsonProperty("us_date_fermeture")
	public String getUsDateFermeture() {
		return this.usDateFermeture;
	}

	public void setUsDateFermeture(String usDateFermeture) {
		this.usDateFermeture = usDateFermeture;
	}

	@JsonProperty("us_Nature")
	public String getUsNature() {
		return this.usNature;
	}

	public void setUsNature(String usNature) {
		this.usNature = usNature;
	}

	@JsonProperty("us_type")
	public String getUsTypeUs() {
		return this.usTypeUs;
	}

	public void setUsTypeUs(String usTypeUs) {
		this.usTypeUs = usTypeUs;
	}

	@JsonProperty("us_code_Ministere")
	public String getUsCodeMinistere() {
		return this.usCodeMinistere;
	}

	public void setUsCodeMinistere(String usCodeMinistere) {
		this.usCodeMinistere = usCodeMinistere;
	}

	@JsonProperty("us_numero_voie")
	public String getUsNumeroVoie() {
		return this.usNumeroVoie;
	}

	public void setUsNumeroVoie(String usNumeroVoie) {
		this.usNumeroVoie = usNumeroVoie;
	}

	@JsonProperty("us_voie_bis_ter")
	public String getUsVoieBisTer() {
		return this.usVoieBisTer;
	}

	public void setUsVoieBisTer(String usVoieBisTer) {
		this.usVoieBisTer = usVoieBisTer;
	}

	@JsonProperty("us_libelle_voie")
	public String getUsLibelleVoie() {
		return this.usLibelleVoie;
	}

	public void setUsLibelleVoie(String usLibelleVoie) {
		this.usLibelleVoie = usLibelleVoie;
	}

	@JsonProperty("us_complement_agent")
	public String getUsComplementAgent() {
		return this.usComplementAgent;
	}

	public void setUsComplementAgent(String usComplementAgent) {
		this.usComplementAgent = usComplementAgent;
	}

	@JsonProperty("us_code_postal")
	public String getUsCodePostal() {
		return this.usCodePostal;
	}

	public void setUsCodePostal(String usCodePostal) {
		this.usCodePostal = usCodePostal;
	}

	@JsonProperty("us_code_insee")
	public String getUsCodeInsee() {
		return this.usCodeInsee;
	}

	public void setUsCodeInsee(String usCodeInsee) {
		this.usCodeInsee = usCodeInsee;
	}

	@JsonProperty("us_commune")
	public String getUsCommune() {
		return this.usCommune;
	}

	public void setUsCommune(String usCommune) {
		this.usCommune = usCommune;
	}

	@JsonProperty("us_departement")
	public String getUsDepartement() {
		return this.usDepartement;
	}

	public void setUsDepartement(String usDepartement) {
		this.usDepartement = usDepartement;
	}

	@JsonProperty("us_pays")
	public String getUsPays() {
		return this.usPays;
	}

	public void setUsPays(String usPays) {
		this.usPays = usPays;
	}

	@JsonProperty("us_bureau_distributeur")
	public String getUsBureauDistributeur() {
		return this.usBureauDistributeur;
	}

	public void setUsBureauDistributeur(String usBureauDistributeur) {
		this.usBureauDistributeur = usBureauDistributeur;
	}

	@JsonProperty("us_niveau")
	public String getUsNiveau() {
		return this.usNiveau;
	}

	public void setUsNiveau(String usNiveau) {
		this.usNiveau = usNiveau;
	}

	@JsonProperty("us_mere")
	public String getUsMere() {
		return this.usMere;
	}

	public void setUsMere(String usMere) {
		this.usMere = usMere;
	}

	@JsonProperty("us_type_arborescence")
	public String getUsTypeArborescence() {
		return this.usTypeArborescence;
	}

	public void setUsTypeArborescence(String usTypeArborescence) {
		this.usTypeArborescence = usTypeArborescence;
	}

	@JsonProperty("us_date_debut_rattachement")
	public String getUsDateDebutRattachement() {
		return this.usDateDebutRattachement;
	}

	public void setUsDateDebutRattachement(String usDateDebutRattachement) {
		this.usDateDebutRattachement = usDateDebutRattachement;
	}

	@JsonProperty("us_date_fin_rattachement")
	public String getUsDateFinRattachement() {
		return this.usDateFinRattachement;
	}

	public void setUsDateFinRattachement(String usDateFinRattachement) {
		this.usDateFinRattachement = usDateFinRattachement;
	}

	@JsonProperty("us_type_organisation")
	public String getUsTypeOrganisation() {
		return this.usTypeOrganisation;
	}

	public void setUsTypeOrganisation(String usTypeOrganisation) {
		this.usTypeOrganisation = usTypeOrganisation;
	}

	@JsonProperty("us_unite_organisationnelle")
	public String getUsUniteOrganisationnelle() {
		return this.usUniteOrganisationnelle;
	}

	public void setUsUniteOrganisationnelle(String usUniteOrganisationnelle) {
		this.usUniteOrganisationnelle = usUniteOrganisationnelle;
	}

	@JsonProperty("us_libelle_court_uo")
	public String getUsLibelleCourtUo() {
		return this.usLibelleCourtUo;
	}

	public void setUsLibelleCourtUo(String usLibelleCourtUo) {
		this.usLibelleCourtUo = usLibelleCourtUo;
	}

	@JsonProperty("us_structure_uo")
	public String getUsStructureUo() {
		return this.usStructureUo;
	}

	public void setUsStructureUo(String usStructureUo) {
		this.usStructureUo = usStructureUo;
	}

	@JsonProperty("us_date_effet")
	public String getUsDateEffet() {
		return this.usDateEffet;
	}

	public void setUsDateEffet(String usDateEffet) {
		this.usDateEffet = usDateEffet;
	}

	@JsonProperty("us_date_fin")
	public String getUsDateFin() {
		return this.usDateFin;
	}

	public void setUsDateFin(String usDateFin) {
		this.usDateFin = usDateFin;
	}

	@JsonProperty("us_nom_responsable_uo")
	public String getUsNomResponsableUo() {
		return this.usNomResponsableUo;
	}

	public void setUsNomResponsableUo(String usNomResponsableUo) {
		this.usNomResponsableUo = usNomResponsableUo;
	}

	@JsonProperty("us_niveau_direction")
	public String getUsNiveauDirection() {
		return this.usNiveauDirection;
	}

	public void setUsNiveauDirection(String usNiveauDirection) {
		this.usNiveauDirection = usNiveauDirection;
	}

	@JsonProperty("us_niveau_service")
	public String getUsNiveauService() {
		return this.usNiveauService;
	}

	public void setUsNiveauService(String usNiveauService) {
		this.usNiveauService = usNiveauService;
	}

	@JsonProperty("us_niveau_unite_structurelle")
	public String getUsNiveauUniteStructurelle() {
		return this.usNiveauUniteStructurelle;
	}

	public void setUsNiveauUniteStructurelle(String usNiveauUniteStructurelle) {
		this.usNiveauUniteStructurelle = usNiveauUniteStructurelle;
	}

	public String getNudoss() {
		return this.nudoss;
	}

	public void setNudoss(String nudoss) {
		this.nudoss = nudoss;
	}

	@JsonProperty("us_actif")
	public boolean isUsActif() {
		return this.usActif;
	}

	public void setUsActif(boolean usActif) {
		this.usActif = usActif;
	}

	@JsonProperty("us_nombre_agents")
	public int getUsNombreAgent() {
		return this.usNombreAgent;
	}

	public void setUsNombreAgent(int usNombreAgent) {
		this.usNombreAgent = usNombreAgent;
	}

	@JsonProperty("us_nombre_agents_masculins")
	public int getUsNombreAgentH() {
		return this.usNombreAgentH;
	}

	public void setUsNombreAgentH(int usNombreAgentH) {
		this.usNombreAgentH = usNombreAgentH;
	}

	@JsonProperty("us_nombre_agents_feminins")
	public int getUsNombreAgentF() {
		return this.usNombreAgentF;
	}

	public void setUsNombreAgentF(int usNombreAgentF) {
		this.usNombreAgentF = usNombreAgentF;
	}

	@JsonProperty("us_avec_agent")
	public boolean isUsAvecAgent() {
		return this.usAvecAgent;
	}

	public void setUsAvecAgent(boolean usAvecAgent) {
		this.usAvecAgent = usAvecAgent;
	}

	@JsonProperty("us_type_libelle")
	public String getUsTypeLibelle() {
		return this.usTypeLibelle;
	}

	public void setUsTypeLibelle(String usTypeLibelle) {
		this.usTypeLibelle = usTypeLibelle;
	}

}

```

</details>


---

### 📄 `src/main/java/ze/unitestructurelle/UniteStructurelleDAO.java` [19.431 octets]
<a id="src-main-java-ze-unitestructurelle-UniteStructurelleDAO-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-unitestructurelle-UniteStructurelleDAO-java)

> **Chemin relatif** : `src/main/java/ze/unitestructurelle/UniteStructurelleDAO.java`  
> **Taille** : 19.431 octets  
> **Lignes** : 522  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (522 lignes) - Cliquer pour déplier</summary>

```java
package ze.unitestructurelle;

import java.sql.Array;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.regex.Pattern;

import org.apache.commons.lang3.StringUtils;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import ze.impl.Utils;

public class UniteStructurelleDAO {

	private static final Utils UTILS = new Utils();

	private static final Pattern SPLIT_ID_PATTERN = Pattern.compile("[()']");

	private static final Logger LOG = LoggerFactory.getLogger(UniteStructurelleDAO.class);

	/*
	 * Recupère une unité structurelle à partir d'un code ministère
	 */
	public List<UniteStructurelle> findByMinist(String minist) {

		final StringBuilder req = new StringBuilder();
		req.append(
				"SELECT u.*, UST_MERE, UST_DDERAT, UST_DFIRAT, UST_NBAGENTH, UST_NBAGENTF, UST_NBAGENT FROM UNITE_STRUCTURELLE u")
				.append(" LEFT JOIN UNITE_STRUCTURELLE_LIEN l ON l.UST_ID = u.us_identifiant")
				.append(" LEFT JOIN EFFECTIF_UNITE e on e.UST_ID = u.us_identifiant")
				.append(" WHERE u.us_identifiant = ANY(?)");

		final ArrayList<UniteStructurelle> listUnite = new ArrayList<>();

		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		try {
			con = DriverManager.getConnection(UniteStructurelleDAO.UTILS.getUrl(), UniteStructurelleDAO.UTILS.getUser(),
					UniteStructurelleDAO.UTILS.getPassword());
			st = con.prepareStatement(req.toString());
			final String[] idMin = UniteStructurelleDAO.SPLIT_ID_PATTERN.matcher(minist).replaceAll("").split(",");
			final Array a = con.createArrayOf("text", idMin);
			st.setArray(1, a);
			rs = st.executeQuery();

			final ArrayList<String> listIdMin = new ArrayList<>(Arrays.asList(idMin));
			while (rs.next()) {
				listUnite.add(this.processRow(rs));
				final String id = rs.getString(USEnum.US_IDENTIFIANT.toString());
				listIdMin.remove(id);
			}
			for (final String s : listIdMin) {
				final UniteStructurelle u = new UniteStructurelle();
				u.setUsIdentifiant(s);
				u.setErreur("404 : Unité Struturelle non trouvée");
				listUnite.add(u);
			}
			return listUnite;
		} catch (final SQLException e) {
			UniteStructurelleDAO.UTILS.erreurAccesBase(e);
		} catch (final Exception e) {
			UniteStructurelleDAO.UTILS.erreurInnatendue(e);
		} finally {
			UniteStructurelleDAO.UTILS.closeConnexion(rs, st, con);
		}
		return listUnite;
	}

	/*
	 * Récupère la liste d'unités structurelles associées aux paramètres de
	 * recherches fournis
	 */
	public List<UniteStructurelle> getList(String recherche, String racine, int nbGenerations, String niveau,
			String actif, String avecAgent, String fichier) {

		final ArrayList<UniteStructurelle> list = new ArrayList<>();

		// Récupération des identifiants d'US de l'arborescence voulue
		final StringBuilder firstQuery = this.getFirstQuery(racine, nbGenerations);

		// Prise en compte du champ recherche
		String rechercheNormalized;
		String[] rechercheNormalizedSplit = { "" };
		if (recherche != null) {
			// On retire les accents et on met en minuscule le texte de recherche
			rechercheNormalized = StringUtils.stripAccents(recherche.toLowerCase());
			rechercheNormalizedSplit = rechercheNormalized.split(" ");
		}
		final int rechercheLength = rechercheNormalizedSplit.length;

		final StringBuilder req = this.getRequestList(fichier, rechercheLength, niveau, actif,
				firstQuery, nbGenerations, avecAgent);

		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		try {
			con = DriverManager.getConnection(UniteStructurelleDAO.UTILS.getUrl(), UniteStructurelleDAO.UTILS.getUser(),
					UniteStructurelleDAO.UTILS.getPassword());
			final StringBuilder request = new StringBuilder();
			request.append(firstQuery)
					.append(req);
			st = con.prepareStatement(request.toString());
			int j = 0;
			if (racine != null && !"TOP".equals(racine)) {
				final Array a = con.createArrayOf("text",
						UniteStructurelleDAO.SPLIT_ID_PATTERN.matcher(racine).replaceAll("").split(","));
				st.setArray(1, a);
				j++;
			}
			for (int i = 0; i < rechercheLength; i++) {
				st.setString(i + j + 1, rechercheNormalizedSplit[i]);
			}
			j = j + rechercheLength;
			if (niveau != null && !"#".equals(niveau)) {
				j++;
				if (niveau.contains("#")) {
					niveau = niveau.substring(0, niveau.length() - 1);
				}
				final Array a = con.createArrayOf("text",
						UniteStructurelleDAO.SPLIT_ID_PATTERN.matcher(niveau).replaceAll("").split(","));
				st.setArray(j, a);
			}
			rs = st.executeQuery();
			while (rs.next()) {
				list.add(this.processUSList(rs));
			}
			return list;
		} catch (final SQLException e) {
			UniteStructurelleDAO.UTILS.erreurAccesBase(e);
		} catch (final Exception e) {
			UniteStructurelleDAO.UTILS.erreurInnatendue(e);
		} finally {
			UniteStructurelleDAO.UTILS.closeConnexion(rs, st, con);
		}
		return list;
	}

	/*
	 * Récupère la liste d'unités structurelles associées aux paramètres de
	 * recherches fournis
	 */
	public List<ArbreUniteStructurelle> getArbo(String racine, int nbGenerations, String niveau, String actif,
			String avecAgent) {
		final ArrayList<ArbreUniteStructurelle> arbre = new ArrayList<>();
		final ArrayList<ArbreUniteStructurelle> noeudsCourants = new ArrayList<>();
		final ArrayList<ArbreUniteStructurelle> noeudsFilles = new ArrayList<>();

		final StringBuilder beginReq = new StringBuilder();
		beginReq.append(
				" SELECT u.us_identifiant, us_libelle_long, us_libelle_court, us_actif, us_niveau, UST_MERE, UST_NBAGENTH, UST_NBAGENTF, UST_NBAGENT FROM UNITE_STRUCTURELLE u")
				.append(" LEFT JOIN UNITE_STRUCTURELLE_LIEN l ON u.us_identifiant=l.UST_ID")
				.append(" LEFT JOIN EFFECTIF_UNITE e on e.UST_ID = u.us_identifiant");
		final StringBuilder where = new StringBuilder();
		where.append(" WHERE u.us_identifiant ");
		// Prise en compte du champ racine
		if ("TOP".equals(racine)) {
			where.append(
					"IN (SELECT UST_ID FROM UNITE_STRUCTURELLE_LIEN WHERE UST_MERE IS NULL OR TRIM(UST_MERE) = '')");
		} else {
			where.append("= ANY(?)");
		}
		final StringBuilder endReq = new StringBuilder();
		// Prise en compte du champ niveau
		if (niveau != null) {
			if ("#".equals(niveau)) {
				endReq.append(" AND us_niveau is null");
			} else {
				endReq.append(" AND (us_niveau = ANY(?)");
				if (niveau.contains("#")) {
					endReq.append(" OR us_niveau is null");
					niveau = niveau.substring(0, niveau.length() - 1);
				}
				endReq.append(')');
			}
		}
		// Prise en compte du champ actif
		if (actif != null) {
			final boolean isActif = Boolean.parseBoolean(actif);
			endReq.append(" AND u.us_actif=")
					.append(isActif);
		}
		// Clause GroupBy
		endReq.append(" GROUP BY U.us_identifiant, UST_MERE, UST_NBAGENTH, UST_NBAGENTF, UST_NBAGENT");
		// Prise en compte du champ avecAgent
		if (avecAgent != null) {
			final boolean withAgent = Boolean.parseBoolean(avecAgent);
			if (withAgent) {
				endReq.append(" HAVING UST_NBAGENT > 0");
			} else {
				endReq.append(" HAVING UST_NBAGENT = 0");
			}
		}
		Connection con = null;
		PreparedStatement st = null;
		ResultSet rs = null;
		try {
			con = DriverManager.getConnection(UniteStructurelleDAO.UTILS.getUrl(), UniteStructurelleDAO.UTILS.getUser(),
					UniteStructurelleDAO.UTILS.getPassword());
			st = con.prepareStatement(beginReq.toString() + where.toString() + endReq.toString());
			int j = 1;
			if (!"TOP".equals(racine)) {
				final Array a = con.createArrayOf("text",
						UniteStructurelleDAO.SPLIT_ID_PATTERN.matcher(racine).replaceAll("").split(","));
				st.setArray(j, a);
				j++;
			}
			this.setArrayNiveau(j, niveau, st, con);
			rs = st.executeQuery();
			int compteurGen = 0;
			while (rs.next() && compteurGen <= nbGenerations) {
				UniteStructurelle uniteCourante;
				uniteCourante = this.processUSList(rs);
				// Cas de la première génération (ou génération racine)
				StringBuilder request;
				if (compteurGen == 0) {
					request = this.updateResultSetFirstGen(uniteCourante, arbre, noeudsCourants, rs.isLast(), beginReq,
							endReq);
				} else {
					request = this.updateResultSetNextGen(noeudsCourants, uniteCourante, noeudsFilles, rs.isLast(),
							beginReq,
							endReq);
				}
				if (request != null) {
					st = con.prepareStatement(request.toString());
					this.setArrayNiveau(1, niveau, st, con);
					rs = st.executeQuery();
					UniteStructurelleDAO.LOG.info("requête SQL:{}", st);
					compteurGen++;
				}
			}
			return arbre;
		} catch (final SQLException e) {
			UniteStructurelleDAO.UTILS.erreurAccesBase(e);
		} catch (final Exception e) {
			UniteStructurelleDAO.UTILS.erreurInnatendue(e);
		} finally {
			UniteStructurelleDAO.UTILS.closeConnexion(rs, st, con);
		}
		return arbre;
	}

	/*
	 * Récupère le début de la requête dans le cas ou une racine est renseignée
	 */
	protected StringBuilder getFirstQuery(String racine, int nbGenerations) {
		final StringBuilder firstQuery = new StringBuilder();
		if (racine != null) {
			firstQuery.append("WITH query AS (SELECT u.us_identifiant");
			for (int i = 1; i < nbGenerations + 1; i++) {
				firstQuery.append(", l")
						.append(i)
						.append(".UST_ID AS gen")
						.append(i);
			}
			firstQuery.append(" FROM UNITE_STRUCTURELLE u");
			for (int i = 1; i < nbGenerations + 1; i++) {
				if (i == 1) {
					firstQuery.append(" LEFT JOIN unite_structurelle_lien l")
							.append(i)
							.append(" on u.us_identifiant=l")
							.append(i)
							.append(".UST_MERE");
				} else {
					firstQuery.append(" LEFT JOIN unite_structurelle_lien l")
							.append(i)
							.append(" on l")
							.append(i - 1)
							.append(".UST_ID=l")
							.append(i)
							.append(".UST_MERE");
				}
			}

			// Racines de toute l'arborescence
			if ("TOP".equals(racine)) {
				final String racinesMeres = "(SELECT UST_ID FROM UNITE_STRUCTURELLE_LIEN WHERE UST_MERE IS NULL OR TRIM(UST_MERE) = '')";
				firstQuery.append(" WHERE u.us_identifiant in ")
						.append(racinesMeres)
						.append(')');
			} else {
				firstQuery.append(" WHERE u.us_identifiant = ANY(?))");
			}
		}
		return firstQuery;
	}

	/*
	 * Construction de la requête de recherche d'unités structurelles sous forme de
	 * liste
	 */
	protected StringBuilder getRequestList(String fichier, int rechercheLength,
			String niveau, String actif, StringBuilder firstQuery, int nbGenerations, String avecAgent) {
		final StringBuilder req = new StringBuilder();

		req.append(
				" SELECT U.*, UST_MERE, UST_DDERAT, UST_DFIRAT, UST_NBAGENTH, UST_NBAGENTF, UST_NBAGENT FROM UNITE_STRUCTURELLE u");

		req.append(" LEFT JOIN UNITE_STRUCTURELLE_LIEN l ON u.us_identifiant=l.UST_ID")
				.append(" LEFT JOIN EFFECTIF_UNITE e on e.UST_ID = u.us_identifiant");

		req.append(" WHERE search ~ ?");
		for (int i = 1; i < rechercheLength; i++) {
			req.append(" and search ~ ?");
		}

		// Prise en compte du champ niveau
		if (niveau != null) {
			if ("#".equals(niveau)) {
				req.append(" AND us_niveau is null");
			} else {
				req.append(" AND (us_niveau = ANY(?)");
				if (niveau.contains("#")) {
					req.append(" OR us_niveau is null");
				}
				req.append(')');
			}
		}

		// Prise en compte du champ actif
		if (actif != null) {
			final boolean isActif = Boolean.parseBoolean(actif);
			req.append(" AND u.us_actif=")
					.append(isActif);
		}

		// Prise en compte de l'arborescence voulue
		if (!"".equals(firstQuery.toString())) {
			req.append(" AND u.us_identifiant in ")
					.append("(SELECT DISTINCT us_identifiant FROM query WHERE us_identifiant is not null");
			for (int i = 1; i < nbGenerations + 1; i++) {
				req.append(" UNION SELECT DISTINCT gen")
						.append(i)
						.append(" FROM query WHERE gen")
						.append(i)
						.append(" is not null");
			}
			req.append(')');
		}

		// Clause GroupBy
		req.append(
				" GROUP BY U.us_identifiant, UST_MERE, UST_DDERAT, UST_DFIRAT, UST_NBAGENTH, UST_NBAGENTF, UST_NBAGENT");

		// Prise en compte du champ avecAgent
		if (avecAgent != null) {
			final boolean withAgent = Boolean.parseBoolean(avecAgent);
			if (withAgent) {
				req.append(" HAVING UST_NBAGENT > 0");
			} else {
				req.append(" HAVING UST_NBAGENT = 0");
			}
		}
		return req;
	}

	/*
	 * Récupération de la liste des US filles des racines
	 */
	protected StringBuilder updateResultSetFirstGen(UniteStructurelle uniteCourante,
			ArrayList<ArbreUniteStructurelle> arbre,
			ArrayList<ArbreUniteStructurelle> noeudsCourants, boolean isLast, StringBuilder beginReq,
			StringBuilder endReq) {
		final ArbreUniteStructurelle arbreCourant = new ArbreUniteStructurelle();
		arbreCourant.setUs(uniteCourante);
		arbre.add(arbreCourant);
		noeudsCourants.add(arbreCourant);
		final StringBuilder where = new StringBuilder();
		if (isLast) {
			// Clause Where pour récupérer les filles de la racines
			where.append(" WHERE l.UST_MERE in (");
			for (final ArbreUniteStructurelle a : noeudsCourants) {
				where.append('\'')
						.append(a.getUs().getUsIdentifiant())
						.append("', ");
			}
			where.deleteCharAt(where.length() - 1);
			where.deleteCharAt(where.length() - 1);
			where.append(')');

			final StringBuilder request = new StringBuilder();
			request.append(beginReq)
					.append(where)
					.append(endReq);
			return request;
		}
		return null;
	}

	/*
	 * Récupération de la liste des US filles de la génération précédente
	 */
	protected StringBuilder updateResultSetNextGen(ArrayList<ArbreUniteStructurelle> noeudsCourants,
			UniteStructurelle uniteCourante,
			ArrayList<ArbreUniteStructurelle> noeudsFilles, boolean isLast, StringBuilder beginReq,
			StringBuilder endReq) {
		for (final ArbreUniteStructurelle noeud : noeudsCourants) {
			if (noeud.getUs().getUsIdentifiant().equals(uniteCourante.getUsMere())) {
				noeudsFilles.add(noeud.addFille(uniteCourante));
				break;
			}
		}

		if (isLast) {
			// Clause Where pour récupérer la prochaine générations d'US
			final StringBuilder where = new StringBuilder();
			where.append(" WHERE l.UST_MERE in (");
			for (final ArbreUniteStructurelle a : noeudsFilles) {
				where.append('\'')
						.append(a.getUs().getUsIdentifiant())
						.append("', ");
			}
			where.deleteCharAt(where.length() - 1);
			where.deleteCharAt(where.length() - 1);
			where.append(')');

			// La liste des noeuds courants devient la génération suivantes d'US
			noeudsCourants.clear();
			for (final ArbreUniteStructurelle a : noeudsFilles) {
				noeudsCourants.add(a);
			}
			noeudsFilles.clear();
			final StringBuilder request = new StringBuilder();
			// On récupère la génération suivante
			request.append(beginReq)
					.append(where)
					.append(endReq);
			return request;
		}
		return null;
	}

	/*
	 * Met à jour le PrepareStatement pour le paramètre niveau
	 */
	protected void setArrayNiveau(int param, String niveau, PreparedStatement st, Connection con) {
		try {
			if (niveau != null && !"#".equals(niveau)) {
				final Array a = con.createArrayOf("text",
						UniteStructurelleDAO.SPLIT_ID_PATTERN.matcher(niveau).replaceAll("").split(","));
				st.setArray(param, a);
			}
		} catch (final SQLException e) {
			UniteStructurelleDAO.UTILS.erreurAccesBase(e);
		}
	}

	/*
	 * Récupère une unité structurelle complète
	 */
	protected UniteStructurelle processRow(ResultSet rs) throws SQLException {
		final UniteStructurelle unite = new UniteStructurelle();
		unite.setUsIdentifiant(rs.getString(USEnum.US_IDENTIFIANT.toString()));
		unite.setUsLibelleLong(rs.getString(USEnum.US_LIBELLE_LONG.toString()));
		unite.setUsLibelleCourt(rs.getString(USEnum.US_LIBELLE_COURT.toString()));
		unite.setUsDateCreation(rs.getString(USEnum.US_DATE_CREATION.toString()));
		unite.setUsDateFermeture(rs.getString(USEnum.US_DATE_FERMETURE.toString()));
		unite.setUsNature(rs.getString(USEnum.US_NATURE.toString()));
		unite.setUsTypeUs(rs.getString(USEnum.US_TYPE.toString()));
		unite.setUsTypeLibelle(rs.getString(USEnum.US_TYPE_LIBELLE.toString()));
		unite.setUsCodeMinistere(rs.getString(USEnum.US_CODE_MINISTERE.toString()));
		unite.setUsNumeroVoie(rs.getString(USEnum.US_NUMERO_VOIE.toString()));
		unite.setUsVoieBisTer(rs.getString(USEnum.US_VOIE_BIS_TER.toString()));
		unite.setUsLibelleVoie(rs.getString(USEnum.US_LIBELLE_VOIE.toString()));
		unite.setUsComplementAgent(rs.getString(USEnum.US_COMPLEMENT_AGENT.toString()));
		unite.setUsCodePostal(rs.getString(USEnum.US_CODE_POSTAL.toString()));
		unite.setUsCodeInsee(rs.getString(USEnum.US_CODE_INSEE.toString()));
		unite.setUsCommune(rs.getString(USEnum.US_COMMUNE.toString()));
		unite.setUsDepartement(rs.getString(USEnum.US_DEPARTEMENT.toString()));
		unite.setUsPays(rs.getString(USEnum.US_PAYS.toString()));
		unite.setUsBureauDistributeur(rs.getString(USEnum.US_BUREAU_DISTRIBUTEUR.toString()));
		unite.setUsNiveau(rs.getString(USEnum.US_NIVEAU.toString()));
		unite.setUsMere(rs.getString(USEnum.UST_MERE.toString()));
		unite.setUsTypeArborescence(rs.getString(USEnum.US_TYPE_ARBORESCENCE.toString()));
		unite.setUsDateDebutRattachement(rs.getString(USEnum.US_DATE_DEBUT_RATTACHEMENT.toString()));
		unite.setUsDateFinRattachement(rs.getString(USEnum.US_DATE_FIN_RATTACHEMENT.toString()));
		unite.setUsTypeOrganisation(rs.getString(USEnum.US_TYPE_ORGANISATION.toString()));
		unite.setUsUniteOrganisationnelle(rs.getString(USEnum.US_UNITE_ORGANISATIONNELLE.toString()));
		unite.setUsLibelleCourtUo(rs.getString(USEnum.US_LIBELLE_COURT_UO.toString()));
		unite.setUsStructureUo(rs.getString(USEnum.US_STRUCTURE_UO.toString()));
		unite.setUsDateEffet(rs.getString(USEnum.US_DATE_EFFET.toString()));
		unite.setUsDateFin(rs.getString(USEnum.US_DATE_FIN.toString()));
		unite.setUsNomResponsableUo(rs.getString(USEnum.US_NOM_RESPONSABLE_UO.toString()));
		unite.setUsNiveauDirection(rs.getString(USEnum.US_NIVEAU_DIRECTION.toString()));
		unite.setUsNiveauService(rs.getString(USEnum.US_NIVEAU_SERVICE.toString()));
		unite.setUsNiveauUniteStructurelle(rs.getString(USEnum.US_NIVEAU_UNITE_STRUCTURELLE.toString()));
		unite.setUsActif(rs.getBoolean(USEnum.US_ACTIF.toString()));
		unite.setUsNombreAgent(rs.getInt(USEnum.UST_NBAGENT.toString()));
		unite.setUsNombreAgentH(rs.getInt(USEnum.UST_NBAGENTH.toString()));
		unite.setUsNombreAgentF(rs.getInt(USEnum.UST_NBAGENTF.toString()));
		unite.setUsAvecAgent(unite.getUsNombreAgent() != 0);
		return unite;
	}

	/*
	 * Récupère une unité structurelle partielle (recherche liste/arbo d'US)
	 */
	protected UniteStructurelle processUSList(ResultSet rs) throws SQLException {
		final UniteStructurelle unite = new UniteStructurelle();
		unite.setUsIdentifiant(rs.getString(USEnum.US_IDENTIFIANT.toString()));
		unite.setUsLibelleLong(rs.getString(USEnum.US_LIBELLE_LONG.toString()));
		unite.setUsLibelleCourt(rs.getString(USEnum.US_LIBELLE_COURT.toString()));
		unite.setUsNiveau(rs.getString(USEnum.US_NIVEAU.toString()));
		unite.setUsMere(rs.getString(USEnum.UST_MERE.toString()));
		unite.setUsActif(rs.getBoolean(USEnum.US_ACTIF.toString()));
		unite.setUsNombreAgent(rs.getInt(USEnum.UST_NBAGENT.toString()));
		unite.setUsNombreAgentH(rs.getInt(USEnum.UST_NBAGENTH.toString()));
		unite.setUsNombreAgentF(rs.getInt(USEnum.UST_NBAGENTF.toString()));
		unite.setUsAvecAgent(unite.getUsNombreAgent() != 0);

		return unite;
	}
}

```

</details>


---

### 📄 `src/main/java/ze/unitestructurelle/USEnum.java` [773 octets]
<a id="src-main-java-ze-unitestructurelle-USEnum-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-unitestructurelle-USEnum-java)

> **Chemin relatif** : `src/main/java/ze/unitestructurelle/USEnum.java`  
> **Taille** : 773 octets  
> **Lignes** : 45  
> **Type** : java

```java
package ze.unitestructurelle;

public enum USEnum {
	US_IDENTIFIANT,
	US_LIBELLE_LONG,
	US_LIBELLE_COURT,
	US_DATE_CREATION,
	US_DATE_FERMETURE,
	US_NATURE,
	US_TYPE,
	US_TYPE_LIBELLE,
	US_CODE_MINISTERE,
	US_NUMERO_VOIE,
	US_VOIE_BIS_TER,
	US_LIBELLE_VOIE,
	US_COMPLEMENT_AGENT,
	US_CODE_POSTAL,
	US_CODE_INSEE,
	US_COMMUNE,
	US_DEPARTEMENT,
	US_PAYS,
	US_BUREAU_DISTRIBUTEUR,
	US_NIVEAU,
	UST_MERE,
	US_TYPE_ARBORESCENCE,
	US_DATE_DEBUT_RATTACHEMENT,
	US_DATE_FIN_RATTACHEMENT,
	US_TYPE_ORGANISATION,
	US_UNITE_ORGANISATIONNELLE,
	US_LIBELLE_COURT_UO,
	US_STRUCTURE_UO,
	US_DATE_EFFET,
	US_DATE_FIN,
	US_NOM_RESPONSABLE_UO,
	US_NIVEAU_DIRECTION,
	US_NIVEAU_SERVICE,
	US_NIVEAU_UNITE_STRUCTURELLE,
	NUDOSS,
	US_ACTIF,
	UST_NBAGENT,
	UST_NBAGENTH,
	UST_NBAGENTF,
	SEARCH
}

```


---

### 📄 `src/main/java/ze/WebService.java` [26.248 octets]
<a id="src-main-java-ze-WebService-java"></a> [↩ Retour à l'arborescence](#tree-src-main-java-ze-WebService-java)

> **Chemin relatif** : `src/main/java/ze/WebService.java`  
> **Taille** : 26.248 octets  
> **Lignes** : 515  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (515 lignes) - Cliquer pour déplier</summary>

```java
package ze;

import java.util.ArrayList;

import javax.ws.rs.GET;
import javax.ws.rs.HeaderParam;
import javax.ws.rs.Path;
import javax.ws.rs.PathParam;
import javax.ws.rs.Produces;
import javax.ws.rs.QueryParam;
import javax.ws.rs.core.Response;

import org.apache.cxf.rs.security.cors.CrossOriginResourceSharing;

import io.swagger.annotations.Api;
import io.swagger.annotations.ApiOperation;
import io.swagger.annotations.ApiParam;
import io.swagger.annotations.ApiResponse;
import io.swagger.annotations.ApiResponses;
import ze.agent.Agent;
import ze.carriere.Carriere;
import ze.habilitation.Habilitation;
import ze.quotite.Quotite;
import ze.reglementaire.Contractuel;
import ze.reglementaire.Corps;
import ze.reglementaire.Grade;
import ze.unitestructurelle.ArbreUniteStructurelle;
import ze.unitestructurelle.UniteStructurelle;

@Api(value = "ZE/2.4.5")
@Path("/")
public interface WebService {

	@CrossOriginResourceSharing(allowAllOrigins = true, allowCredentials = true)
	@GET
	@Path("/US/{id}/")
	@Produces("application/json; charset=UTF-8")
	@ApiOperation(value = "Récupère les détails d'une ou plusieurs unités structurelles à partir d'une liste d'id")
	@ApiResponses(
			value = {
					@ApiResponse(
							code = 200,
							message = "Liste d'Unite Structurelle récupérée avec succès",
							response = UniteStructurelle.class),
					@ApiResponse(
							code = 404,
							message = "Aucune unité structurelle ne correspond à la liste d'id fournie"),
					@ApiResponse(code = 400, message = "Erreur sur le paramètre de recherche") })
	Response getUniteStructurelle(
			@ApiParam(
					value = "Liste d'identifiants d'US sous forme ('x','x',...) avec x un identifiant d'US") @PathParam("id") String id,
			@HeaderParam("SSL_CLIENT_S_DN") String header);

	@GET
	@Path("/Agent/{id}/")
	@Produces("application/json; charset=UTF-8")
	@ApiOperation(value = "Récupère les détails d'un ou plusieurs agents à partir d'une liste de matricules")
	@ApiResponses(
			value = {
					@ApiResponse(code = 200, message = "Liste d'agents récupérée avec succès", response = Agent.class),
					@ApiResponse(code = 404, message = "Aucun agent ne correspond à la liste de matricules fournie"),
					@ApiResponse(code = 400, message = "Erreur sur le paramètre de recherche") })
	Response getAgent(
			@ApiParam(
					value = "Liste de matricule d'agents sous forme ('x','x',...) avec x un matricule d'agent") @PathParam("id") String id,
			@HeaderParam("SSL_CLIENT_S_DN") String header);

	@GET
	@Path("/Identite_Agent/")
	@Produces("application/json; charset=UTF-8")
	@ApiOperation(
			value = "Récupère les information spécifique d'un ou plusieurs agents à partir d'une liste de matricules")
	@ApiResponses(
			value = {
					@ApiResponse(code = 200, message = "Liste d'agents récupérée avec succès", response = Agent.class),
					@ApiResponse(code = 404, message = "Aucun agent ne correspond à la liste de matricules fournie"),
					@ApiResponse(code = 400, message = "Erreur sur le paramètre de recherche") })
	Response getIdentiteAgent(
			@ApiParam(
					value = "Liste de matricule d'agents sous forme ('x','x',...) avec x un matricule d'agent") @QueryParam("id") String id,
			@ApiParam(
					value = "Défini le type de rendu (true => fichier csv / false => JSON)") @QueryParam("fichier") String fichier,
			@HeaderParam("SSL_CLIENT_S_DN") String header);

	@GET
	@Path("/Statut/list/")
	@Produces("application/json; charset=UTF-8")
	@ApiOperation(
			value = "Récupère les information sur les stauts d'un ou plusieurs agents à partir d'une liste de matricules")
	@ApiResponses(
			value = {
					@ApiResponse(code = 200, message = "Liste d'agents récupérée avec succès", response = Agent.class),
					@ApiResponse(code = 404, message = "Aucun agent ne correspond à la liste de matricules fournie"),
					@ApiResponse(code = 400, message = "Erreur sur le paramètre de recherche") })
	Response getStatut(
			@ApiParam(
					value = "Liste de matricule d'agents sous forme ('x','x',...) avec x un matricule d'agent") @QueryParam("id") String id,
			@ApiParam(value = "Statut en vigueur") @QueryParam("statut") String statut,
			@ApiParam(value = "Date début au format AAAAMMJJ") @QueryParam("dateEffet") String dateEffet,
			@ApiParam(
					value = "Date effet export borne  au format AAAAMMJJ") @QueryParam("export_date_effet_borne") String exportDateEffetBorne,
			@HeaderParam("SSL_CLIENT_S_DN") String header);

	@GET
	@Path("/Habilitation/{id}/")
	@Produces("application/json; charset=UTF-8")
	@ApiOperation(value = "Récupère les profils actifs d'un agent à partir d'une liste d'adresses mail")
	@ApiResponses(
			value = {
					@ApiResponse(
							code = 200,
							message = "Liste de profil récupérée avec succès",
							response = Habilitation.class),
					@ApiResponse(code = 404, message = "Aucun profil ne correspond à la liste de mails fournie"),
					@ApiResponse(code = 400, message = "Erreur sur le paramètre de recherche") })
	Response getHabilitation(
			@ApiParam(value = "Adresse mail de l'agent dont on souhaite voir les profils") @PathParam("id") String id,
			@HeaderParam("SSL_CLIENT_S_DN") String header);

	@GET
	@Path("/US/list")
	@Produces({ "application/json; charset=UTF-8", "application/csv" })

	@ApiOperation(
			value = "Récupère la liste d'unités structurelles correspondant aux paramètres de recherche",
			response = ArrayList.class)
	@ApiResponses(
			value = {
					@ApiResponse(
							code = 200,
							message = "Liste d'unités structurelles récupérée avec succès",
							response = ArrayList.class),
					@ApiResponse(code = 404, message = "Aucun résultat associé aux paramètres de la recherche"),
					@ApiResponse(code = 400, message = "Erreur sur un ou plusieurs paramètres de la requête") })
	Response getListUniteStructurelles(
			@ApiParam(
					value = "Filtre sur toutes les US contenant ce paramètre dans l'un de leurs champs") @QueryParam("recherche") String recherche,
			@ApiParam(value = "Filtre sur la racine de l'arborescence voulue") @QueryParam("racine") String racine,
			@ApiParam(
					value = "Filtre sur le nombre de générations voulu (entier positif < 20)") @QueryParam("nbGenerations") String nbGenerations,
			@ApiParam(
					value = "Filtre sur les niveau d'US voulus sous forme ('x','x',...) avec x un niveau entre 01 et 09") @QueryParam("niveau") String niveau,
			@ApiParam(value = "Filtre sur l'état d'activité de l'US (true/false)") @QueryParam("actif") String actif,
			@ApiParam(
					value = "Filtre sur la présence d'agents au sein de l'US (true/false)") @QueryParam("avecAgent") String avecAgent,
			@ApiParam(
					value = "Défini le type de rendu (true => fichier csv / false => JSON)") @QueryParam("fichier") String fichier,
			@HeaderParam("SSL_CLIENT_S_DN") String header);

	@GET
	@Path("/Agent/list")
	@Produces("application/json; charset=UTF-8")
	@ApiOperation(
			value = "Récupère la liste d'agents correspondant aux paramètres de recherche",
			response = ArrayList.class)
	@ApiResponses(
			value = {
					@ApiResponse(
							code = 200,
							message = "Liste d'agent récupérée avec succès",
							response = ArrayList.class),
					@ApiResponse(code = 404, message = "Aucun résultat associé aux paramètres de la recherche"),
					@ApiResponse(code = 400, message = "Erreur sur un ou plusieurs paramètres de la requête") })
	Response getListAgents(
			@ApiParam(
					value = "Filtre sur tous les agents contenant ce paramètre dans l'un de leurs champs") @QueryParam("recherche") String recherche,
			@ApiParam(
					value = "Filtre sur l'affectation opérationnelle de l'agent est rattaché sous forme ('x','x',...) avec x un identifiant d'US") @QueryParam("affectationOperationnelle") String affectationOperationnelle,
			@ApiParam(
					value = "Filtre sur l'affectation administrative de l'agent est rattaché sous forme ('x','x',...) avec x un identifiant d'US") @QueryParam("affectationAdministrative") String affectationAdministrative,
			@ApiParam(
					value = "Filtre sur les corps de rattachement des grade sous forme ('x','x',...) avec x un identifiant de corps") @QueryParam("corps") String corps,
			@ApiParam(
					value = "Filtre sur les grades sous forme ('x','x',...) avec x un identifiant de grade") @QueryParam("grade") String grade,
			@ApiParam(
					value = "Filtre sur les lots de gestion sous forme ('x','x',...) avec x un identifiant de lot de gestion") @QueryParam("lotDeGestion") String lotDeGestion,
			@ApiParam(
					value = "Filtre sur les codes partenaire sous forme ('x','x',...) avec x un code partenaire") @QueryParam("partenaire") String partenaire,
			@ApiParam(
					value = "Filtre sur les PESE sous forme ('x','x',...) avec x un PESE ") @QueryParam("pese") String pese,
			@ApiParam(
					value = "Filtre sur les codes correspondant sous forme ('x','x',...) avec x un code correspondant de service gestionnaire pour la rémunération") @QueryParam("code_correspondant") String codeCorrespondant,
			@ApiParam(
					value = "Filtre sur la date de naissance de l'agent sous forme AAAA ou AAAAMM ou AAAAMMJJ") @QueryParam("dateNaissance") String dateNaissance,
			@ApiParam(
					value = "Filtre sur le code regroupement d'UO sous forme ('x','x',...) avec x un identifiant d'US") @QueryParam("CodeRegroupementUOPoste") String codeRegroupementUOPoste,
			@ApiParam(
					value = "Défini le type de rendu (true => fichier csv / false => JSON)") @QueryParam("fichier") String fichier,
			@HeaderParam("SSL_CLIENT_S_DN") String header);

	@GET
	@Path("/Remuneration/list")
	@Produces("application/json; charset=UTF-8")
	@ApiOperation(
			value = "Récupère la liste des rémunérations correspondant aux paramètres de recherche",
			response = ArrayList.class)
	@ApiResponses(
			value = {
					@ApiResponse(
							code = 200,
							message = "Liste de rémunérations récupérée avec succès",
							response = ArrayList.class),
					@ApiResponse(code = 404, message = "Aucun résultat associé aux paramètres de la recherche"),
					@ApiResponse(code = 400, message = "Erreur sur un ou plusieurs paramètres de la requête") })
	Response getListRemunerations(
			@ApiParam(
					value = "Filtre sur toutes les rémunérations contenant ce paramètre dans l'un de leurs champs") @QueryParam("recherche") String recherche,
			@ApiParam(
					value = "Filtre sur les matricules auquelles les rémunérations sont rattachés sous forme ('x','x',...) avec x un matricule") @QueryParam("matricule") String matricule,
			@ApiParam(
					value = "Filtre sur les codes TG sous forme ('x','x',...) avec x un code TG") @QueryParam("codeTG") String codeTG,
			@ApiParam(
					value = "Filtre sur le témoin d'annulation") @QueryParam("temoinAnnulation") String temoinAnnulation,
			@ApiParam(
					value = "Filtre sur le témoin de validation de paye") @QueryParam("temoinValidationPaye") String temoinValidationPaye,
			@ApiParam(
					value = "Filtre sur la date de fin du régime de rémunération sous forme AAAA ou AAAAMM ou AAAAMMJJ") @QueryParam("export_date_fin") String exportDateFin,
			@ApiParam(
					value = "Filtre sur la date d'effet du régime de rémunération sous forme AAAA ou AAAAMM ou AAAAMMJJ") @QueryParam("export_date_effet") String exportDateEffet,
			@ApiParam(
					value = "Défini le type de rendu (true => fichier csv / false => JSON)") @QueryParam("fichier") String fichier,
			@HeaderParam("SSL_CLIENT_S_DN") String header);

	@GET
	@Path("/Conges/list")
	@Produces("application/json; charset=UTF-8")
	@ApiOperation(
			value = "Récupère la liste des absences correspondant aux paramètres de recherche",
			response = ArrayList.class)
	@ApiResponses(
			value = {
					@ApiResponse(
							code = 200,
							message = "Liste d'absences récupérée avec succès",
							response = ArrayList.class),
					@ApiResponse(code = 404, message = "Aucun résultat associé aux paramètres de la recherche"),
					@ApiResponse(code = 400, message = "Erreur sur un ou plusieurs paramètres de la requête") })
	Response getListAbsences(
			@ApiParam(
					value = "Filtre sur toutes les absences contenant ce paramètre dans l'un de leurs champs") @QueryParam("recherche") String recherche,
			@ApiParam(
					value = "Filtre sur les matricules auquelles les absences sont rattachés sous forme ('x','x',...) avec x un matricule") @QueryParam("matricule") String matricule,
			@ApiParam(
					value = "Filtre sur les numéros de droit sous forme ('x','x',...) avec x un numéro de droit") @QueryParam("numeroDroit") String numeroDroit,
			@ApiParam(
					value = "Filtre sur le témoin de validation") @QueryParam("temoinValidation") String temoinValidation,
			@ApiParam(
					value = "Filtre sur les motifs d'absence sous forme ('x','x',...) avec x un motif d'absence") @QueryParam("liste_motifs_absence") String motifAbsence,
			@ApiParam(
					value = "Filtre sur la date d'effet de l'absence sous forme AAAA ou AAAAMM ou AAAAMMJJ") @QueryParam("export_date_effet_borne") String exportDateEffet,
			@ApiParam(
					value = "Défini le type de rendu (true => fichier csv / false => JSON)") @QueryParam("fichier") String fichier,
			@HeaderParam("SSL_CLIENT_S_DN") String header);

	@GET
	@Path("/Affectation/list")
	@Produces("application/json; charset=UTF-8")
	@ApiOperation(
			value = "Récupère la liste des affectations correspondant aux paramètres de recherche",
			response = ArrayList.class)
	@ApiResponses(
			value = {
					@ApiResponse(
							code = 200,
							message = "Liste d'affectations récupérée avec succès",
							response = ArrayList.class),
					@ApiResponse(code = 404, message = "Aucun résultat associé aux paramètres de la recherche"),
					@ApiResponse(code = 400, message = "Erreur sur un ou plusieurs paramètres de la requête") })
	Response getListAffectations(
			@ApiParam(
					value = "Filtre sur toutes les affectations contenant ce paramètre dans l'un de leurs champs") @QueryParam("recherche") String recherche,
			@ApiParam(
					value = "Filtre sur les matricules auquelles les affectations sont rattachés sous forme ('x','x',...) avec x un matricule") @QueryParam("matricule") String matricule,
			@ApiParam(
					value = "Filtre sur le témoin de validité") @QueryParam("temoin_validite") String temoinValidation,
			@ApiParam(
					value = "Filtre sur la date d'export des données sous forme AAAAMMJJ") @QueryParam("export_date_effet_borne") String exportDateEffet,
			@ApiParam(
					value = "Défini le type de rendu (true => fichier csv / false => JSON)") @QueryParam("fichier") String fichier,
			@HeaderParam("SSL_CLIENT_S_DN") String header);

	@GET
	@Path("/US/arbo")
	@Produces("application/json; charset=UTF-8")
	@ApiOperation(
			value = "Récupère l'arbre d'unités structurelles correspondant aux paramètres de recherche",
			response = ArbreUniteStructurelle.class)
	@ApiResponses(
			value = {
					@ApiResponse(
							code = 200,
							message = "Arbre d'unités structurelles récupérée avec succès",
							response = ArbreUniteStructurelle.class),
					@ApiResponse(code = 404, message = "Aucun résultat associé aux paramètres de la recherche"),
					@ApiResponse(code = 400, message = "Erreur sur un ou plusieurs paramètres de la requête") })
	Response getArboUniteStructurelles(
			@ApiParam(value = "Filtre sur la racine de l'arborescence voulue") @QueryParam("racine") String racine,
			@ApiParam(
					value = "Filtre sur le nombre de générations voulu (entier positif < 20)") @QueryParam("nbGenerations") String nbGenerations,
			@ApiParam(
					value = "Filtre sur les niveau d'US voulus sous forme ('x','x',...) avec x un niveau entre 01 et 09") @QueryParam("niveau") String niveau,
			@ApiParam(value = "Filtre sur l'état d'activité de l'US (true/false)") @QueryParam("actif") String actif,
			@ApiParam(
					value = "Filtre sur la présence d'agents au sein de l'US (true/false)") @QueryParam("avecAgent") String avecAgent,
			@HeaderParam("SSL_CLIENT_S_DN") String header);

	@GET
	@Path("/Agent/effectif")
	@Produces("application/json; charset=UTF-8")
	@ApiOperation(
			value = "Récupère le nombre d'agents correspondant aux paramètres de recherche",
			response = Integer.class)
	@ApiResponses(
			value = {
					@ApiResponse(
							code = 200,
							message = "Décompte d'agent effectué avec succès",
							response = Integer.class),
					@ApiResponse(code = 400, message = "Erreur sur un ou plusieurs paramètres de la requête") })
	Response getEffectifAgents(
			@ApiParam(
					value = "Filtre sur tous les agents contenant ce paramètre dans l'un de leurs champs") @QueryParam("recherche") String recherche,
			@ApiParam(
					value = "Filtre sur les unités structurelles auquelles l'agent est rattaché sous forme ('x','x',...) avec x un identifiant d'US") @QueryParam("uniteStructurelle") String uniteStructurelle,
			@ApiParam(
					value = "Filtre sur les corps de rattachement des grade sous forme ('x','x',...) avec x un identifiant de corps") @QueryParam("corps") String corps,
			@ApiParam(
					value = "Filtre sur les grades sous forme ('x','x',...) avec x un identifiant de grade") @QueryParam("grade") String grade,
			@ApiParam(
					value = "Filtre sur la date de naissance de l'agent sous forme AAAA ou AAAAMM ou AAAAMMJJ") @QueryParam("dateNaissance") String dateNaissance,
			@ApiParam(
					value = "Filtre sur les dates d'effet. Sous la forme AAAAMMJJ") @QueryParam("export_date_effet") String exportDateEffet,
			@HeaderParam("SSL_CLIENT_S_DN") String header);

	@GET
	@Path("/Quotite/list")
	@Produces("application/json; charset=UTF-8")
	@ApiOperation(value = "Récupère les quotités correspondant aux paramètres de recherche", response = Quotite.class)
	@ApiResponses(
			value = {
					@ApiResponse(
							code = 200,
							message = "Liste des quotités effectuée avec succès",
							response = Quotite.class),
					@ApiResponse(code = 400, message = "Erreur sur un ou plusieurs paramètres de la requête") })
	Response getQuotite(
			@ApiParam(
					value = "Filtre sur toutes les quotités contenant ce paramètre dans l'un de leurs champs") @QueryParam("recherche") String recherche,
			@ApiParam(
					value = "Filtre sur les matricules des agents sous forme ('x','x',...) avec x le matricule RenoiRH") @QueryParam("matricule") String matricule,
			@ApiParam(
					value = "Filtre sur les date d'effet et de fin. Sous la forme AAAAMMJJ") @QueryParam("export_date_effet_borne") String exportDateEffetBorne,
			@ApiParam(
					value = "Filtre sur Le témon de validite. Sous la forme 1, 2 ou 3") @QueryParam("temoinValide") String temoinValide,
			@ApiParam(
					value = "Défini le type de rendu (true => fichier csv / false => JSON)") @QueryParam("fichier") String fichier,
			@HeaderParam("SSL_CLIENT_S_DN") String header);

	@GET
	@Path("/Carriere/list")
	@Produces("application/json; charset=UTF-8")
	@ApiOperation(
			value = "Récupère les carrières correspondante aux paramètres de recherche",
			response = Carriere.class)
	@ApiResponses(
			value = {
					@ApiResponse(
							code = 200,
							message = "Liste des carrières effectuée avec succès",
							response = Carriere.class),
					@ApiResponse(code = 400, message = "Erreur sur un ou plusieurs paramètres de la requête") })
	Response getCarriere(
			@ApiParam(
					value = "Filtre sur les matricules des agents sous forme ('x','x',...) avec x le matricule RenoiRH") @QueryParam("matricule") String matricule,
			@ApiParam(
					value = "Filtre sur les date d'effet et de fin. Sous la forme AAAAMMJJ") @QueryParam("export_date_effet_borne") String exportDateEffetBorne,
			@ApiParam(
					value = "Filtre sur Le témon de validite. Sous la forme 1, 2 ou 3") @QueryParam("temoinValide") String temoinValide,
			@ApiParam(
					value = "Défini le type de rendu (true => fichier csv / false => JSON)") @QueryParam("fichier") String fichier,
			@HeaderParam("SSL_CLIENT_S_DN") String header);

	@GET
	@Path("/Reglementaire/Corps/{id}")
	@Produces("application/json; charset=UTF-8")
	@ApiOperation(value = "Récupère les informations des corps", response = Corps.class)
	@ApiResponses(
			value = {
					@ApiResponse(
							code = 200,
							message = "Liste de corps récupérée avec succès",
							response = Corps.class),
					@ApiResponse(code = 404, message = "Aucun corps ne correspond à la liste d'identifiant fournie"),
					@ApiResponse(code = 400, message = "Erreur sur le paramètre de recherche") })
	Response getCorpsById(
			@ApiParam(
					value = "Liste d'identifiants de crops sous forme ('x','x',...) avec x un identifiant de corps") @PathParam("id") String id,
			@ApiParam(
					value = "Défini le type de rendu (true => fichier csv / false => JSON)") @QueryParam("fichier") String fichier,
			@HeaderParam("SSL_CLIENT_S_DN") String header);

	@GET
	@Path("/Reglementaire/Corps/list")
	@Produces("application/json; charset=UTF-8")
	@ApiOperation(
			value = "Récupère les corps correspondante aux paramètres de recherche",
			response = Corps.class)
	@ApiResponses(
			value = {
					@ApiResponse(
							code = 200,
							message = "Liste des corps effectuée avec succès",
							response = Corps.class),
					@ApiResponse(code = 400, message = "Erreur sur un ou plusieurs paramètres de la requête") })
	Response getCorpsList(
			@ApiParam(
					value = "Filtre sur toutes les corps contenant ce paramètre dans l'un de leurs champs") @QueryParam("recherche") String recherche,
			@ApiParam(
					value = "Filtre sur les codes Corps sous forme ('x','x',...)") @QueryParam("Corps") String Corps,

			@ApiParam(value = "Filtre sur l'état d'activité du corps (true/false)") @QueryParam("ouvert") String ouvert,
			@ApiParam(
					value = "Filtre sur la présence d'agents au sein du corps (true/false)") @QueryParam("avecAgent") String avecAgent,
			@ApiParam(
					value = "Défini le type de rendu (true => fichier csv / false => JSON)") @QueryParam("fichier") String fichier,
			@HeaderParam("SSL_CLIENT_S_DN") String header);

	@GET
	@Path("/Reglementaire/Grade/{id}")
	@Produces("application/json; charset=UTF-8")
	@ApiOperation(value = "Récupère les informations des grades", response = Grade.class)
	@ApiResponses(
			value = {
					@ApiResponse(
							code = 200,
							message = "Liste de corps récupérée avec succès",
							response = Grade.class),
					@ApiResponse(code = 404, message = "Aucun corps ne correspond à la liste d'identifiant fournie"),
					@ApiResponse(code = 400, message = "Erreur sur le paramètre de recherche") })
	Response getGradeById(
			@ApiParam(
					value = "Liste d'identifiants de grade sous forme ('x','x',...) avec x un identifiant de grade") @PathParam("id") String id,
			@ApiParam(
					value = "Défini le type de rendu (true => fichier csv / false => JSON)") @QueryParam("fichier") String fichier,
			@HeaderParam("SSL_CLIENT_S_DN") String header);

	@GET
	@Path("/Reglementaire/Grade/list")
	@Produces("application/json; charset=UTF-8")
	@ApiOperation(
			value = "Récupère les grades correspondante aux paramètres de recherche",
			response = Grade.class)
	@ApiResponses(
			value = {
					@ApiResponse(
							code = 200,
							message = "Liste des grades effectuée avec succès",
							response = Grade.class),
					@ApiResponse(code = 400, message = "Erreur sur un ou plusieurs paramètres de la requête") })
	Response getGradeList(
			@ApiParam(
					value = "Filtre sur toutes les grades contenant ce paramètre dans l'un de leurs champs") @QueryParam("recherche") String recherche,
			@ApiParam(
					value = "Filtre sur les corps de rattachement sous forme ('x','x',...)") @QueryParam("grade") String grade,
			@ApiParam(value = "Filtre sur l'état d'activité du grade (true/false)") @QueryParam("ouvert") String ouvert,
			@ApiParam(
					value = "Filtre sur la présence d'agents possedant ce grade (true/false)") @QueryParam("avecAgent") String avecAgent,
			@ApiParam(
					value = "Défini le type de rendu (true => fichier csv / false => JSON)") @QueryParam("fichier") String fichier,
			@HeaderParam("SSL_CLIENT_S_DN") String header);

	@GET
	@Path("/Reglementaire/Contractuel/{id}")
	@Produces("application/json;charset=UTF-8")
	@ApiOperation(value = "Récupère les pseudo-corps sous forme de liste.", response = Contractuel.class)
	@ApiResponses(
			value = {
					@ApiResponse(
							code = 200,
							message = "Liste des pseudo-corps effectuée avec succès",
							response = Contractuel.class),
					@ApiResponse(code = 400, message = "Erreur sur un ou plusieurs paramètres de la requête") })
	Response getContractuelById(@ApiParam(
			value = "Liste d'identifiants de pseudo-corps sous forme ('x','x',...) avec x un identifiant de grade") @PathParam("id") String id,
			@ApiParam(
					value = "Défini le type de rendu (true => fichier csv / false => JSON)") @QueryParam("fichier") String fichier,
			@HeaderParam("SSL_CLIENT_S_DN") String header);

	@GET
	@Path("/Reglementaire/Contractuel/list")
	@Produces("application/json; charset=UTF-8")
	@ApiOperation(
			value = "Récupère les pseudo-corps correspondante aux paramètres de recherche",
			response = Contractuel.class)
	@ApiResponses(
			value = {
					@ApiResponse(
							code = 200,
							message = "Liste des pseudo-corps effectuée avec succès",
							response = Contractuel.class),
					@ApiResponse(code = 400, message = "Erreur sur un ou plusieurs paramètres de la requête") })
	Response getContractuelList(
			@ApiParam(
					value = "Filtre sur toutes les pseudo-corps contenant ce paramètre dans l'un de leurs champs") @QueryParam("recherche") String recherche,
			@ApiParam(
					value = "Filtre sur les corps de rattachement sous forme ('x','x',...)") @QueryParam("pseudo-corps") String grade,
			@ApiParam(
					value = "Filtre sur l'état d'activité du pseudo-corps (true/false)") @QueryParam("ouvert") String ouvert,
			@ApiParam(
					value = "Filtre sur la présence d'agents possedant ce pseudo-corps (true/false)") @QueryParam("avecAgent") String avecAgent,
			@ApiParam(
					value = "Défini le type de rendu (true => fichier csv / false => JSON)") @QueryParam("fichier") String fichier,
			@HeaderParam("SSL_CLIENT_S_DN") String header);
}

```

</details>


---

### 📄 `src/main/resources/OSGI-INF/blueprint/my-service.xml` [2.525 octets]
<a id="src-main-resources-OSGI-INF-blueprint-my-service-xml"></a> [↩ Retour à l'arborescence](#tree-src-main-resources-OSGI-INF-blueprint-my-service-xml)

> **Chemin relatif** : `src/main/resources/OSGI-INF/blueprint/my-service.xml`  
> **Taille** : 2.525 octets  
> **Lignes** : 46  
> **Type** : xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!-- Licensed to the Apache Software Foundation (ASF) under one or more contributor 
	license agreements. See the NOTICE file distributed with this work for additional 
	information regarding copyright ownership. The ASF licenses this file to 
	You under the Apache License, Version 2.0 (the "License"); you may not use 
	this file except in compliance with the License. You may obtain a copy of 
	the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required 
	by applicable law or agreed to in writing, software distributed under the 
	License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS 
	OF ANY KIND, either express or implied. See the License for the specific 
	language governing permissions and limitations under the License. -->

<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cm="http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.0.0"
	xmlns:jaxws="http://cxf.apache.org/blueprint/jaxws" xmlns:jaxrs="http://cxf.apache.org/blueprint/jaxrs"
	xmlns:cxf="http://cxf.apache.org/blueprint/core"
	xsi:schemaLocation="http://www.osgi.org/xmlns/blueprint/v1.0.0 http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd http://cxf.apache.org/blueprint/jaxws http://cxf.apache.org/schemas/blueprint/jaxws.xsd http://cxf.apache.org/blueprint/jaxrs http://cxf.apache.org/schemas/blueprint/jaxrs.xsd  http://cxf.apache.org/blueprint/core http://cxf.apache.org/schemas/blueprint/core.xsd">

	<jaxrs:server address="/ZE/2.4.5" id="someRestService">
		<jaxrs:serviceBeans>
			<ref component-id="WebServiceImpl" />
		</jaxrs:serviceBeans>
		<jaxrs:providers>
			<bean class="com.fasterxml.jackson.jaxrs.json.JacksonJsonProvider" />
			<bean
				class="org.apache.cxf.rs.security.cors.CrossOriginResourceSharingFilter" />
		</jaxrs:providers>
		<jaxrs:features>
			<ref component-id="swaggerFeature" />
		</jaxrs:features>
	</jaxrs:server>

	<bean id="WebServiceImpl" class="ze.impl.WebServiceImpl" />

	<bean id="swaggerFeature" class="org.apache.cxf.jaxrs.swagger.Swagger2Feature">
		<property name="resourcePackage"
			value="RestWebservice.ZE" />
		<property name="basePath" value="/cxf/ZE/2.4.5" />
		<property name="prettyPrint" value="true" />
		<property name="description" value="Zone d'Echange" />
		<property name="title" value="WebService Zone d'Echange"/>
		<property name="version" value="2.4.5" />
		<property name="scan" value="false" />
	</bean>
</blueprint>

```


---

### 📄 `src/main/resources/ze_config.properties` [642 octets]
<a id="src-main-resources-ze_config-properties"></a> [↩ Retour à l'arborescence](#tree-src-main-resources-ze_config-properties)

> **Chemin relatif** : `src/main/resources/ze_config.properties`  
> **Taille** : 642 octets  
> **Lignes** : 14  
> **Type** : text

```text
url=jdbc:postgresql://localhost:5432/base_metier_2_4_2beta
user=postgres
password=postgres
mailsender=robot-soclerh.csac@developpement-durable.gouv.fr
mailreceiver=mathieu.scala@kleegroup.com
subject=[Zone d'échange - Env dev] Incident web services
serversmtp=localdelivery.klee.lan.net
logfile=/zechange/Runtime_ESBSE/container/log/ZEweb.log
namespace=op
uricerbere=http://cerbere.application.i2/schemas/cerbere-services/1.0
endpointurl=https://authentification.recette.e2.rie.gouv.fr/authSAML/services/soap
idcerbere=468
clecerbere=786716a412b62bb7a3f3d0e2446900411a66f7201344239859b2b56067286f1d5549b6c92831a691
asynchfolder=/mnt/wsechange
```


---

### 📄 `src/test/java/Grade.java` [5.870 octets]
<a id="src-test-java-Grade-java"></a> [↩ Retour à l'arborescence](#tree-src-test-java-Grade-java)

> **Chemin relatif** : `src/test/java/Grade.java`  
> **Taille** : 5.870 octets  
> **Lignes** : 154  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (154 lignes) - Cliquer pour déplier</summary>

```java
//import static org.junit.Assert.*;
//
//import java.io.IOException;
//
//import org.apache.http.HttpEntity;
//import org.apache.http.HttpResponse;
//import org.apache.http.client.ClientProtocolException;
//import org.apache.http.client.HttpClient;
//import org.apache.http.client.methods.HttpGet;
//import org.apache.http.impl.client.HttpClientBuilder;
//import org.apache.http.util.EntityUtils;
//import org.json.simple.JSONArray;
//import org.json.simple.JSONObject;
//import org.json.simple.parser.JSONParser;
//import org.json.simple.parser.ParseException;
//import org.junit.Test;
//
//public class Grade {
//
//	/*
//	 * Test sur un identifiant de grade inconnu
//	 */
//	@Test
//	public void testUnknownId() {
//		HttpClient client = HttpClientBuilder.create().build();
//		HttpGet request = new HttpGet("http://localhost/cxf/POC_ZE/Grade/('sqdf')");
//		try {
//			HttpResponse response = client.execute(request);
//			HttpEntity entity = response.getEntity();
//			String json = EntityUtils.toString(entity);
//			JSONParser parser = new JSONParser();
//			JSONObject obj = (JSONObject) parser.parse(json);
//			assertEquals("Le code de retour n'est pas celui attendu", "404", obj.get("code"));
//			assertEquals("Le message de retour n'est pas celui attendu",
//					"Aucun grade n'a été trouvée parmi les identifiants renseignés : ('sqdf')",
//					obj.get("message"));
//		} catch (ClientProtocolException e) {
//			fail("ClientProtocolException");
//		} catch (IOException e) {
//			fail("IOException");
//		} catch (ParseException e) {
//			fail("Le retour du serveur n'a pas pu être parsé en json");
//		}
//	}
//
//	/*
//	 * Test sur une mauvaise syntaxe d'identifiants de grade
//	 */
//	@Test
//	public void testBadSyntaxId() {
//		HttpClient client = HttpClientBuilder.create().build();
//		HttpGet request = new HttpGet("http://localhost/cxf/POC_ZE/Grade/0001");
//		try {
//			HttpResponse response = client.execute(request);
//			HttpEntity entity = response.getEntity();
//			String json = EntityUtils.toString(entity);
//			JSONParser parser = new JSONParser();
//			JSONObject obj = (JSONObject) parser.parse(json);
//			assertEquals("Le code de retour n'est pas celui attendu", "400", obj.get("code"));
//			assertEquals("Le message de retour n'est pas celui attendu",
//					"Le paramètre id doit être de la forme ('x','x',...) avec x un identifiant de grade",
//					obj.get("message"));
//		} catch (ClientProtocolException e) {
//			fail("ClientProtocolException");
//		} catch (IOException e) {
//			fail("IOException");
//		} catch (ParseException e) {
//			fail("Le retour du serveur n'a pas pu être parsé en json");
//		}
//	}
//
//	/*
//	 * Test sur un identifiant de grade connu
//	 */
//	@Test
//	public void testGoodId() {
//		HttpClient client = HttpClientBuilder.create().build();
//		HttpGet request = new HttpGet("http://localhost/cxf/POC_ZE/Grade/('0001')");
//		try {
//			HttpResponse response = client.execute(request);
//			HttpEntity entity = response.getEntity();
//			String json = EntityUtils.toString(entity);
//			JSONParser parser = new JSONParser();
//			JSONArray array = (JSONArray) parser.parse(json);
//			JSONObject obj = (JSONObject) array.get(0);
//			assertEquals("0001", obj.get("cdcode"));
//			assertEquals(true, obj.get("actif"));
//			assertEquals("lieutenant", obj.get("libabr"));
//			assertEquals("lieutenant", obj.get("liblon"));
//			assertEquals("00", obj.get("a_car_coaoas"));
//			assertEquals("IM3", obj.get("macgra"));
//		} catch (ClientProtocolException e) {
//			fail("ClientProtocolException");
//		} catch (IOException e) {
//			fail("IOException");
//		} catch (ParseException e) {
//			fail("Le retour du serveur n'a pas pu être parsé en json");
//		}
//	}
//	
//	/*
//	 * Test sur une mauvaise syntaxe du paramètre corps
//	 */
//	@Test
//	public void testBadSyntaxNiveauList() {
//		HttpClient client = HttpClientBuilder.create().build();
//		HttpGet request = new HttpGet("http://localhost/cxf/POC_ZE/Grade/list?corps=06");
//		try {
//			HttpResponse response = client.execute(request);
//			HttpEntity entity = response.getEntity();
//			String json = EntityUtils.toString(entity);
//			JSONParser parser = new JSONParser();
//			JSONObject obj = (JSONObject) parser.parse(json);
//			assertEquals("Le code de retour n'est pas celui attendu", "400", obj.get("code"));
//			assertEquals("Le message de retour n'est pas celui attendu",
//					"Le paramètre corps doit être de la forme ('x','x',...) avec x un identifiant de corps",
//					obj.get("message"));
//		} catch (ClientProtocolException e) {
//			fail("ClientProtocolException");
//		} catch (IOException e) {
//			fail("IOException");
//		} catch (ParseException e) {
//			fail("Le retour du serveur n'a pas pu être parsé en json");
//		}
//	}
//	
//	/*
//	 * Test sur des paramètres de recherches qui ne donnent aucun résultat
//	 */
//	@Test
//	public void testNoResultList() {
//		HttpClient client = HttpClientBuilder.create().build();
//		HttpGet request = new HttpGet("http://localhost/cxf/POC_ZE/Grade/list?recherche=azertyuiop");
//		try {
//			HttpResponse response = client.execute(request);
//			HttpEntity entity = response.getEntity();
//			String json = EntityUtils.toString(entity);
//			JSONParser parser = new JSONParser();
//			JSONObject obj = (JSONObject) parser.parse(json);
//			assertEquals("Le code de retour n'est pas celui attendu", "404", obj.get("code"));
//			assertEquals("Le message de retour n'est pas celui attendu",
//					"Aucun grade ne correspond aux paramètres de la recherche",
//					obj.get("message"));
//		} catch (ClientProtocolException e) {
//			fail("ClientProtocolException");
//		} catch (IOException e) {
//			fail("IOException");
//		} catch (ParseException e) {
//			fail("Le retour du serveur n'a pas pu être parsé en json");
//		}
//	}
//	
//}

```

</details>


---

### 📄 `src/test/java/UniteStructurelle.java` [14.675 octets]
<a id="src-test-java-UniteStructurelle-java"></a> [↩ Retour à l'arborescence](#tree-src-test-java-UniteStructurelle-java)

> **Chemin relatif** : `src/test/java/UniteStructurelle.java`  
> **Taille** : 14.675 octets  
> **Lignes** : 368  
> **Type** : java

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (368 lignes) - Cliquer pour déplier</summary>

```java
//import static org.junit.Assert.*;
//
//import java.io.IOException;
//
//import org.apache.http.HttpEntity;
//import org.apache.http.HttpResponse;
//import org.apache.http.client.ClientProtocolException;
//import org.apache.http.client.HttpClient;
//import org.apache.http.client.methods.HttpGet;
//import org.apache.http.impl.client.HttpClientBuilder;
//import org.apache.http.util.EntityUtils;
//import org.json.simple.JSONArray;
//import org.json.simple.JSONObject;
//import org.json.simple.parser.JSONParser;
//import org.json.simple.parser.ParseException;
//import org.junit.Test;
//
//public class UniteStructurelle {
//
//	/*
//	 * Test sur un identifiant d'US inconnu
//	 */
//	@Test
//	public void testUnknownId() {
//		HttpClient client = HttpClientBuilder.create().build();
//		HttpGet request = new HttpGet("http://localhost/cxf/POC_ZE/US/('sqdf')");
//		try {
//			HttpResponse response = client.execute(request);
//			HttpEntity entity = response.getEntity();
//			String json = EntityUtils.toString(entity);
//			JSONParser parser = new JSONParser();
//			JSONObject obj = (JSONObject) parser.parse(json);
//			assertEquals("Le code de retour n'est pas celui attendu", "404", obj.get("code"));
//			assertEquals("Le message de retour n'est pas celui attendu",
//					"Aucune unité structurelle n'a été trouvée parmi les identifiants d'US : ('sqdf')",
//					obj.get("message"));
//		} catch (ClientProtocolException e) {
//			fail("ClientProtocolException");
//		} catch (IOException e) {
//			fail("IOException");
//		} catch (ParseException e) {
//			fail("Le retour du serveur n'a pas pu être parsé en json");
//		}
//	}
//
//	/*
//	 * Test sur une mauvaise syntaxe d'identifiants d'US
//	 */
//	@Test
//	public void testBadSyntaxId() {
//		HttpClient client = HttpClientBuilder.create().build();
//		HttpGet request = new HttpGet("http://localhost/cxf/POC_ZE/US/348C");
//		try {
//			HttpResponse response = client.execute(request);
//			HttpEntity entity = response.getEntity();
//			String json = EntityUtils.toString(entity);
//			JSONParser parser = new JSONParser();
//			JSONObject obj = (JSONObject) parser.parse(json);
//			assertEquals("Le code de retour n'est pas celui attendu", "400", obj.get("code"));
//			assertEquals("Le message de retour n'est pas celui attendu",
//					"Le paramètre id doit être de la forme ('x','x',...) avec x un identifiant d'US",
//					obj.get("message"));
//		} catch (ClientProtocolException e) {
//			fail("ClientProtocolException");
//		} catch (IOException e) {
//			fail("IOException");
//		} catch (ParseException e) {
//			fail("Le retour du serveur n'a pas pu être parsé en json");
//		}
//	}
//
//	/*
//	 * Test sur un identifiant d'US connu
//	 */
//	@Test
//	public void testGoodId() {
//		HttpClient client = HttpClientBuilder.create().build();
//		HttpGet request = new HttpGet("http://localhost/cxf/POC_ZE/US/('348C')");
//		try {
//			HttpResponse response = client.execute(request);
//			HttpEntity entity = response.getEntity();
//			String json = EntityUtils.toString(entity);
//			JSONParser parser = new JSONParser();
//			JSONArray array = (JSONArray) parser.parse(json);
//			JSONObject obj = (JSONObject) array.get(0);
//			assertEquals("348C", obj.get("minist"));
//			assertEquals(true, obj.get("actif"));
//			assertEquals("CS 60539                        ", obj.get("adres1"));
//			assertEquals("86020", obj.get("codpos"));
//			assertEquals("2016-01-01", obj.get("dcreat"));
//			assertEquals("2999-12-31", obj.get("dferme"));
//			assertEquals(" ", obj.get("extnum"));
//			assertEquals("RUE ARTHUR RANC           ", obj.get("libvoi"));
//			assertEquals("                          ", obj.get("locali"));
//			assertEquals("D.R.E.A.L. DE LA NOUVELLE-AQUITAINE", obj.get("nom"));
//			assertEquals("15  ", obj.get("numvoi"));
//			assertEquals("FRA", obj.get("pays"));
//			assertEquals("03", obj.get("niveau"));
//		} catch (ClientProtocolException e) {
//			fail("ClientProtocolException");
//		} catch (IOException e) {
//			fail("IOException");
//		} catch (ParseException e) {
//			fail("Le retour du serveur n'a pas pu être parsé en json");
//		}
//	}
//	
//	/*
//	 * Test sur un nbre de génération en dehors de la plage [0-20]
//	 */
//	@Test
//	public void testGenOutofBoundList() {
//		HttpClient client = HttpClientBuilder.create().build();
//		HttpGet request = new HttpGet("http://localhost/cxf/POC_ZE/US/list?racine=348C&nbGenerations=21");
//		try {
//			HttpResponse response = client.execute(request);
//			HttpEntity entity = response.getEntity();
//			String json = EntityUtils.toString(entity);
//			JSONParser parser = new JSONParser();
//			JSONObject obj = (JSONObject) parser.parse(json);
//			assertEquals("Le code de retour n'est pas celui attendu", "400", obj.get("code"));
//			assertEquals("Le message de retour n'est pas celui attendu",
//					"Le nombre de générations doit être un entier positif inférieur à 20",
//					obj.get("message"));
//		} catch (ClientProtocolException e) {
//			fail("ClientProtocolException");
//		} catch (IOException e) {
//			fail("IOException");
//		} catch (ParseException e) {
//			fail("Le retour du serveur n'a pas pu être parsé en json");
//		}
//	}
//	
//	/*
//	 * Test sur un nbre de génération non entier
//	 */
//	@Test
//	public void testGenNotIntegerList() {
//		HttpClient client = HttpClientBuilder.create().build();
//		HttpGet request = new HttpGet("http://localhost/cxf/POC_ZE/US/list?racine=348C&nbGenerations=sdf");
//		try {
//			HttpResponse response = client.execute(request);
//			HttpEntity entity = response.getEntity();
//			String json = EntityUtils.toString(entity);
//			JSONParser parser = new JSONParser();
//			JSONObject obj = (JSONObject) parser.parse(json);
//			assertEquals("Le code de retour n'est pas celui attendu", "400", obj.get("code"));
//			assertEquals("Le message de retour n'est pas celui attendu",
//					"Le nombre de générations doit être un entier positif inférieur à 20",
//					obj.get("message"));
//		} catch (ClientProtocolException e) {
//			fail("ClientProtocolException");
//		} catch (IOException e) {
//			fail("IOException");
//		} catch (ParseException e) {
//			fail("Le retour du serveur n'a pas pu être parsé en json");
//		}
//	}
//	
//	/*
//	 * Test sur un nbre de génération non null et une racine nulle
//	 */
//	@Test
//	public void testGenAndNoRacineList() {
//		HttpClient client = HttpClientBuilder.create().build();
//		HttpGet request = new HttpGet("http://localhost/cxf/POC_ZE/US/list?nbGenerations=4");
//		try {
//			HttpResponse response = client.execute(request);
//			HttpEntity entity = response.getEntity();
//			String json = EntityUtils.toString(entity);
//			JSONParser parser = new JSONParser();
//			JSONObject obj = (JSONObject) parser.parse(json);
//			assertEquals("Le code de retour n'est pas celui attendu", "400", obj.get("code"));
//			assertEquals("Le message de retour n'est pas celui attendu",
//					"La racine est requise lorsque le nombre de générations est renseigné",
//					obj.get("message"));
//		} catch (ClientProtocolException e) {
//			fail("ClientProtocolException");
//		} catch (IOException e) {
//			fail("IOException");
//		} catch (ParseException e) {
//			fail("Le retour du serveur n'a pas pu être parsé en json");
//		}
//	}
//	
//	/*
//	 * Test sur une mauvaise syntaxe du paramètre niveau
//	 */
//	@Test
//	public void testBadSyntaxNiveauList() {
//		HttpClient client = HttpClientBuilder.create().build();
//		HttpGet request = new HttpGet("http://localhost/cxf/POC_ZE/US/list?niveau=06");
//		try {
//			HttpResponse response = client.execute(request);
//			HttpEntity entity = response.getEntity();
//			String json = EntityUtils.toString(entity);
//			JSONParser parser = new JSONParser();
//			JSONObject obj = (JSONObject) parser.parse(json);
//			assertEquals("Le code de retour n'est pas celui attendu", "400", obj.get("code"));
//			assertEquals("Le message de retour n'est pas celui attendu",
//					"Le paramètre niveau doit être de la forme ('x','x',...) avec x dans [01,02,...,09]",
//					obj.get("message"));
//		} catch (ClientProtocolException e) {
//			fail("ClientProtocolException");
//		} catch (IOException e) {
//			fail("IOException");
//		} catch (ParseException e) {
//			fail("Le retour du serveur n'a pas pu être parsé en json");
//		}
//	}
//	
//	/*
//	 * Test sur des paramètres de recherches qui ne donnent aucun résultat
//	 */
//	@Test
//	public void testNoResultList() {
//		HttpClient client = HttpClientBuilder.create().build();
//		HttpGet request = new HttpGet("http://localhost/cxf/POC_ZE/US/list?recherche=azertyuiop");
//		try {
//			HttpResponse response = client.execute(request);
//			HttpEntity entity = response.getEntity();
//			String json = EntityUtils.toString(entity);
//			JSONParser parser = new JSONParser();
//			JSONObject obj = (JSONObject) parser.parse(json);
//			assertEquals("Le code de retour n'est pas celui attendu", "404", obj.get("code"));
//			assertEquals("Le message de retour n'est pas celui attendu",
//					"Aucune unite structurelle ne correspond aux paramètres de la recherche",
//					obj.get("message"));
//		} catch (ClientProtocolException e) {
//			fail("ClientProtocolException");
//		} catch (IOException e) {
//			fail("IOException");
//		} catch (ParseException e) {
//			fail("Le retour du serveur n'a pas pu être parsé en json");
//		}
//	}
//	
//	/*
//	 * Test sur un nbre de génération en dehors de la plage [0-20]
//	 */
//	@Test
//	public void testGenOutofBoundArbo() {
//		HttpClient client = HttpClientBuilder.create().build();
//		HttpGet request = new HttpGet("http://localhost/cxf/POC_ZE/US/arbo?racine=348C&nbGenerations=21");
//		try {
//			HttpResponse response = client.execute(request);
//			HttpEntity entity = response.getEntity();
//			String json = EntityUtils.toString(entity);
//			JSONParser parser = new JSONParser();
//			JSONObject obj = (JSONObject) parser.parse(json);
//			assertEquals("Le code de retour n'est pas celui attendu", "400", obj.get("code"));
//			assertEquals("Le message de retour n'est pas celui attendu",
//					"Le nombre de générations doit être un entier positif inférieur à 20",
//					obj.get("message"));
//		} catch (ClientProtocolException e) {
//			fail("ClientProtocolException");
//		} catch (IOException e) {
//			fail("IOException");
//		} catch (ParseException e) {
//			fail("Le retour du serveur n'a pas pu être parsé en json");
//		}
//	}
//	
//	/*
//	 * Test sur un nbre de génération non entier
//	 */
//	@Test
//	public void testGenNotIntegerArbo() {
//		HttpClient client = HttpClientBuilder.create().build();
//		HttpGet request = new HttpGet("http://localhost/cxf/POC_ZE/US/arbo?racine=348C&nbGenerations=sdf");
//		try {
//			HttpResponse response = client.execute(request);
//			HttpEntity entity = response.getEntity();
//			String json = EntityUtils.toString(entity);
//			JSONParser parser = new JSONParser();
//			JSONObject obj = (JSONObject) parser.parse(json);
//			assertEquals("Le code de retour n'est pas celui attendu", "400", obj.get("code"));
//			assertEquals("Le message de retour n'est pas celui attendu",
//					"Le nombre de générations doit être un entier positif inférieur à 20",
//					obj.get("message"));
//		} catch (ClientProtocolException e) {
//			fail("ClientProtocolException");
//		} catch (IOException e) {
//			fail("IOException");
//		} catch (ParseException e) {
//			fail("Le retour du serveur n'a pas pu être parsé en json");
//		}
//	}
//	
//	/*
//	 * Test sur une racine nulle
//	 */
//	@Test
//	public void testGenAndNoRacineArbo() {
//		HttpClient client = HttpClientBuilder.create().build();
//		HttpGet request = new HttpGet("http://localhost/cxf/POC_ZE/US/arbo?nbGenerations=4");
//		try {
//			HttpResponse response = client.execute(request);
//			HttpEntity entity = response.getEntity();
//			String json = EntityUtils.toString(entity);
//			JSONParser parser = new JSONParser();
//			JSONObject obj = (JSONObject) parser.parse(json);
//			assertEquals("Le code de retour n'est pas celui attendu", "400", obj.get("code"));
//			assertEquals("Le message de retour n'est pas celui attendu",
//					"La racine est un paramètre obligatoire",
//					obj.get("message"));
//		} catch (ClientProtocolException e) {
//			fail("ClientProtocolException");
//		} catch (IOException e) {
//			fail("IOException");
//		} catch (ParseException e) {
//			fail("Le retour du serveur n'a pas pu être parsé en json");
//		}
//	}
//	
//	/*
//	 * Test sur une mauvaise syntaxe du paramètre niveau
//	 */
//	@Test
//	public void testBadSyntaxNiveauArbo() {
//		HttpClient client = HttpClientBuilder.create().build();
//		HttpGet request = new HttpGet("http://localhost/cxf/POC_ZE/US/arbo?racine=MI&niveau=06");
//		try {
//			HttpResponse response = client.execute(request);
//			HttpEntity entity = response.getEntity();
//			String json = EntityUtils.toString(entity);
//			JSONParser parser = new JSONParser();
//			JSONObject obj = (JSONObject) parser.parse(json);
//			assertEquals("Le code de retour n'est pas celui attendu", "400", obj.get("code"));
//			assertEquals("Le message de retour n'est pas celui attendu",
//					"Le paramètre niveau doit être de la forme ('x','x',...) avec x dans [01,02,...,09]",
//					obj.get("message"));
//		} catch (ClientProtocolException e) {
//			fail("ClientProtocolException");
//		} catch (IOException e) {
//			fail("IOException");
//		} catch (ParseException e) {
//			fail("Le retour du serveur n'a pas pu être parsé en json");
//		}
//	}
//	
//	/*
//	 * Test sur des paramètres de recherches qui ne donnent aucun résultat
//	 */
//	@Test
//	public void testNoResultArbo() {
//		HttpClient client = HttpClientBuilder.create().build();
//		HttpGet request = new HttpGet("http://localhost/cxf/POC_ZE/US/arbo?racine=qsdf");
//		try {
//			HttpResponse response = client.execute(request);
//			HttpEntity entity = response.getEntity();
//			String json = EntityUtils.toString(entity);
//			JSONParser parser = new JSONParser();
//			JSONObject obj = (JSONObject) parser.parse(json);
//			assertEquals("Le code de retour n'est pas celui attendu", "404", obj.get("code"));
//			assertEquals("Le message de retour n'est pas celui attendu",
//					"Aucune unite structurelle ne correspond aux paramètres de la recherche",
//					obj.get("message"));
//		} catch (ClientProtocolException e) {
//			fail("ClientProtocolException");
//		} catch (IOException e) {
//			fail("IOException");
//		} catch (ParseException e) {
//			fail("Le retour du serveur n'a pas pu être parsé en json");
//		}
//	}
//}

```

</details>


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

````

</details>


---

### 📄 `si/zone_echange.analysis.md` [16.959 octets]
<a id="si-zone_echange-analysis-md"></a> [↩ Retour à l'arborescence](#tree-si-zone_echange-analysis-md)

> **Chemin relatif** : `si/zone_echange.analysis.md`  
> **Taille** : 16.959 octets  
> **Lignes** : 475  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (475 lignes) - Cliquer pour déplier</summary>

````markdown
# ?? Analyse complète de lapplication `zechange-talend`

> ?? **Objectif** : Produire une documentation exhaustive  *fonctionnelle* et *technique*  basée **exclusivement** sur le contenu du fichier fourni (`zone_echange.md`).  
> ? Autoportée (compatible VS Code, Obsidian avec plugin PlantUML), structurée, illustrée.

---

## ?? Sommaire

- [1. Vue densemble fonctionnelle](#1-vue-densemble-fonctionnelle)
  - [1.1 Domaine métier](#11-domaine-métier)
  - [1.2 Acteurs](#12-acteurs)
  - [1.3 Cas dusage principaux](#13-cas-dusage-principaux)
  - [1.4 Règles métier identifiées](#14-règles-métier-identifiées)
  - [1.5 Workflows & Ordonnancement](#15-workflows--ordonnancement)
- [2. Architecture technique](#2-architecture-technique)
  - [2.1 Vue densemble (composants)](#21-vue-densemble-composants)
  - [2.2 Organisation du code (structure Talend)](#22-organisation-du-code-structure-talend)
  - [2.3 Dépendances communes](#23-dépendances-communes)
  - [2.4 Profils Maven & Packaging](#24-profils-maven--packaging)
  - [2.5 Sécurité](#25-sécurité)
  - [2.6 Dette technique](#26-dette-technique)
- [3. Annexes](#3-annexes)
  - [3.1 Référentiels métier par unité structurelle](#31-référentiels-métier-par-unité-structurelle)
  - [3.2 Exemple complet : `alimentation_unite_structurelle_launcher`](#32-exemple-complet--alimentation_unite_structurelle_launcher)

---

## 1. Vue densemble fonctionnelle

### 1.1 Domaine métier

Lapplication **`zechange`** gère un **système dalimentation de données RH** (ressources humaines), probablement pour une administration publique (noms de codes comme `ze00`, `zefj`, `zey1`, `zey2`, `ze0f`, `zef7`, `zd4f`, `zeFL`, `zeF9` suggèrent des **zones géographiques ou typologies dunités**  cohérent avec `UNITE_STRUCTURELLE`).

Les données concernent :
- les **agents** (statut, affectation, carrière, grade, corps, quotité),
- les **unités structurelles** (structures organisationnelles : services, directions),
- les **habilitations / autorisations** (accès applicatifs, profils),
- les **référentiels** (modèles de rôle, regroupements LDG/CCO),
- la **rémunération** et les **contractuels**.

? **Preuve** : présence répétée de dossiers :
```text
AGENT/
UNITE_STRUCTURELLE/
HABILITATION/
GRADE/
CORPS/
QUOTITE/
REMUNERATION/
AFFECTATION/
CONTRACTUEL/
REFERENTIELS/
```

---

### 1.2 Acteurs

| Acteur | Rôle | Justification |
|--------|------|----------------|
| ????? **Administrateur RH** | Lance les jobs dalimentation, gère les contextes (Dev/TEST), supervise les logs | Fichiers `.properties` dans `contexts/`, fichiers `*_launcher_*.pom.xml`, scripts `.bat` |
| ??? **Système source** (BDD Tampon) | Fournit les données à ingérer (`Tampon_host`, `Tampon_database`) | Fichiers `TEST.properties`, `Dev.properties` : `Tampon_host=cp2i-bdd-tampon`, `Tampon_database=O9ISO15` |
| ?? **Service REST** | Expose des endpoints (`restauthalim`, `restalimbase`, `restalimreferentiels`) | Présence de `pom.xml` sous `rest*`, dépendances `spring-web`, `spring-webmvc` |
| ?? **Ordonnanceur** (ex. Talend CI, Jenkins) | Déclenche les jobs via Maven (`mvn clean package`) | Profil Maven `signature`, plugin `maven-assembly-plugin`, `signer-maven-plugin` |

```plantuml
@startuml
actor "Administrateur RH" as admin
actor "Système source (BDD Tampon)" as source
actor "Ordonnanceur CI" as ci
rectangle "Application zechange" {
  [Job d'alimentation] as job
  [Service REST] as rest
}
admin --> job : lance manuellement (bat/sh)
source --> job : alimente (JDBC)
ci --> job : déclenche (mvn package)
job --> rest : alimente via API ?
rest --> job : orchestre ?
@enduml
```

---

### 1.3 Cas dusage principaux

| Cas dusage | Description | Exemple(s) de job |
|-------------|-------------|-------------------|
| **Alim. unités structurelles** | Import des unités (hiérarchie, liens) depuis source | `alimentation_unite_structurelle_*.pom.xml`, `alimentation_unite_structurelle_lien_*.pom.xml` |
| **Alim. agents** | Import des agents + affectations/postes | `alimentation_agent_search`, `alimentation_poste`, `alimentation_effectif_post_agent` |
| **Alim. référentiels** | Modèles de rôle, regroupements (LDG/CCO), grades, corps | `alimentation_modeles_de_role_renoirh`, `alimentation_regroupement_ldg`, `alimentation_grade_zd01` |
| **Gestion des habilitations** | Profils, autorisations applicatives | `alimentation_habilitation`, `alimentation_profil`, `alimentation_authorisation_application` |
| **Troncature** | Vidage préalable des tables | `truncate_all`, `truncate_referentiels` |
| **Exposition REST** | API pour déclenchement ou consultation | `restalimbase_*`, `restauthalim_*`, `restalimreferentiels` |

```plantuml
@startuml
left to right direction
actor "Admin RH" as admin
usecase "Alim. unités structurelles" as uc_us
usecase "Alim. agents" as uc_ag
usecase "Alim. habilitations" as uc_hab
usecase "Tronquer tables" as uc_trunc
usecase "Appeler API REST" as uc_rest

admin --> uc_us
admin --> uc_ag
admin --> uc_hab
admin --> uc_trunc
admin --> uc_rest
@enduml
```

---

### 1.4 Règles métier identifiées

#### ?? R1 : Structure hiérarchique des unités
- Une unité (`UNITE_STRUCTURELLE`) peut avoir des **liens** (parent/enfant) ? job `alimentation_unite_structurelle_lien`.
- Certaines unités ont des **variantes par zone** (`ze00`, `zefj`, `zey1`, `zey2`, `ze0f`, `zef7`, `zd4f`, `zeFL`, `zeF9`), suggérant des **implémentations spécifiques** (ex. traitement de codes locaux).

#### ?? R2 : Cycle dalimentation
1. `truncate_all` ou `truncate_referentiels`
2. `alimentation_referentiels` (dépendances)
3. `alimentation_unite_structurelle_*`
4. `alimentation_agent_*`
5. `alimentation_grade_*`, `alimentation_corps_*`, etc.
6. `alimentation_habilitation_*`

? **Preuve** : présence de jobs `*_launcher` (ex. `alimentation_unite_structurelle_launcher`)  probablement des **orchestrateurs** (jobs parents appelant dautres jobs).

#### ?? R3 : Contextes dexécution
- Chaque job utilise un **contexte** (`Dev`, `TEST`, `Default`) défini dans `contexts/*.properties`.
- Le contexte fixe la BDD cible (`Tampon_database`, `Tampon_host`, `Tampon_login`).
- Exemple `Dev.properties` :
  ```properties
  Tampon_database=O9ISO15
  Tampon_host=cp2i-bdd-tampon
  Tampon_login=S_REHUCIT
  ```

#### ?? R4 : Journalisation
- Tous les jobs utilisent `log4j.xml` ? log centralisé (`logfile=C:\\KLEE\\Travail\\Logs\\logfile.log`).

---

### 1.5 Workflows & Ordonnancement

#### Workflow typique dalimentation complète

```plantuml
@startuml
title Workflow d'alimentation complète

[*] --> Troncature
Troncature --> Referentiels
Referentiels --> UnitesStructurelles
UnitesStructurelles --> Agents
Agents --> GradesEtCorps
GradesEtCorps --> Habilitations
Habilitations --> [*]

note right of UnitesStructurelles
  Plusieurs variantes :
  - alimentation_unite_structurelle_ze00
  - ... zefj, zey1, zey2, etc.
end note
@enduml
```

#### Job `alimentation_unite_structurelle_launcher` : orchestrateur

? **Preuve** :  
- Nom : `*_launcher_*` est cohérent avec un patron Talend « launcher » (job qui appelle dautres jobs).
- `pom.xml` référencé ? déclenchable via Maven.
- Présence de `jobInfo_template.properties` ? métadonnées dexécution.

---

## 2. Architecture technique

### 2.1 Vue densemble (composants)

```plantuml
@startuml
package "zechange-talend" {
  [Maven (build)] --> [Jobs Talend]
  [Jobs Talend] --> [BDD Tampon]
  [Jobs Talend] --> [BDD Cible ?]
  [Services REST] --> [Jobs Talend]
  [CI/CD] --> [Maven]
}

component "BDD Tampon\n(cp2i-bdd-tampon / O9ISO15)" as db_tampon
component "BDD Cible ?" as db_cible

[Jobs Talend] --> db_tampon : lecture (JDBC)
[Jobs Talend] --> db_cible : écriture ?

[Services REST] ..> [Jobs Talend] : déclenchement ?
@enduml
```

---

### 2.2 Organisation du code (structure Talend)

Larborescence suit strictement la structure générée par **Talend Open Studio for Data Integration** (ou Talend CI Builder) :

```
zechange-talend/
+-- poms/
    +-- jobs/
        +-- process/        # Jobs batch (ETL)
        ¦   +-- AGENT/
        ¦   +-- UNITE_STRUCTURELLE/
        ¦   +-- HABILITATION/
        ¦   +-- restalimbase_2.4/
        ¦   +-- ...
        +-- services/       # Services exposés (ex: SOAP/REST)
            +-- alimentationunitestructurelle_0.1/
            +-- testtalendservice_0.1/
```

Chaque job contient :
- `pom.xml` (build Maven)
- `src/main/assemblies/assembly.xml` (packaging)
- `src/main/ext-resources/` (configs, log4j, contexts)
- `src/main/templates/` (scripts `.bat`, `.sh`, `.ps1`, `jobInfo.properties`)
- parfois `src/main/bundle-resources/META-INF/MANIFEST.MF` (OSGi)

---

### 2.3 Dépendances communes (extrait des `pom.xml`)

| Groupe | Artéfact | Version | Rôle |
|--------|----------|---------|------|
| `org.talend.libraries` | `crypto-utils` | `6.0.0-SNAPSHOT` | Chiffrement (pwd, tokens) |
| `org.talend.libraries` | `advancedPersistentLookupLib-1.2` | `6.0.0` | Lookup persistant (cache BDD) |
| `log4j` | `log4j` | `1.2.17` | Journalisation (legacy) |
| `org.slf4j` | `slf4j-log4j12`, `slf4j-api` | `1.7.25` | Binding SLF4J ? Log4j |
| `org.example.zechange.code` | `routines` | `7.3.1` | Code métier custom (fonctions Talend) |
| `org.dom4j` | `dom4j` | `2.1.1` | Manipulation XML |
| `com.fasterxml.jackson.core` | `jackson-databind` | implicite | JSON (dans `MANIFEST.MF` REST) |
| `org.springframework` | `spring-web`, `spring-context` | `5.1.4.RELEASE` | Services REST |

> ?? **Note** : Jackson et Spring apparaissent uniquement dans les `MANIFEST.MF` des jobs REST (`restauthalim_2.1`, `restalimbase_*`, `restalimreferentiels`).

---

### 2.4 Profils Maven & Packaging

Structure canonique dans les `pom.xml` :  
? **Preuve** : extraits répétés dans +20 `pom.xml`.

```xml
<profiles>
  <profile><id>include-log4j</id>...</profile>
  <profile><id>include-xmlMappings</id>...</profile>
  <profile><id>include-running-xmlMappings</id>...</profile>
  <profile><id>include-rules</id>...</profile>
  <profile><id>include-microservice-configs</id>...</profile>
  <profile><id>include-microservice-running-configs</id>...</profile>
  <profile><id>signature</id>...</profile>
</profiles>
```

#### Diagramme des profils et ressources incluses

```plantuml
@startuml
class "Profil Maven" {
  + id: String
  + activeByDefault: boolean
  + properties: Map
}

ProfilMaven "include-log4j" --> "log4j.resources.dir"
ProfilMaven "include-xmlMappings" --> "xmlMappings.resources.dir"
ProfilMaven "include-running-xmlMappings" --> "xmlMappings.running.dir"
ProfilMaven "include-rules" --> "rules.resources.dir"
ProfilMaven "include-microservice-configs" --> "microservice.configs.dir"
ProfilMaven "include-microservice-running-configs" --> "microservice.running.configs.dir"

note right
  Tous ces dossiers sont sous :
  - src/main/ext-resources/
  - src/main/resources/
end note
@enduml
```

Le packaging repose sur `maven-assembly-plugin` + `assembly.xml` :

```xml
<plugin>
  <artifactId>maven-assembly-plugin</artifactId>
  <executions>
    <execution>
      <phase>package</phase>
      <goals><goal>single</goal></goals>
      <configuration>
        <descriptors><descriptor>src/main/assemblies/assembly.xml</descriptor></descriptors>
      </configuration>
    </execution>
  </executions>
</plugin>
```

---

### 2.5 Sécurité

#### ?? Observations :
- Dépendance `crypto-utils` ? probable gestion de **mots de passe chiffrés** dans les contextes.
- Dépendances `opensaml-*` (**OpenSAML 3.3.0**) dans certains `pom.xml` (ex. `restauthalim_0.1/pom.xml`) ? **authentification SAML** (SSO).
- Logs contiennent des chemins Windows (`C:\\KLEE\\...`) ? accès local restreint ?
- Profil `signature` + plugin `signer-maven-plugin` ? **signature des artefacts** (intégrité).

#### Chaîne de sécurité (hypothèse minimale)

```plantuml
@startuml
actor Utilisateur
component "IdP SAML" as idp
component "Service REST (zechange)" as rest

Utilisateur --> idp : s'authentifie
idp --> rest : Assertion SAML
rest --> "Job Talend" : déclenche avec contexte sécurisé
@enduml
```

> ?? **Limitation** : pas de fichier de config SAML visible ? seule la présence des libs est certaine.

---

### 2.6 Dette technique

| Type | Description | Preuve |
|------|-------------|--------|
| ?? **Log4j 1.x** | `log4j:log4j:1.2.17` + `slf4j-log4j12` ? version **EOL**, vulnérable (CVE-2021-44228 *non applicable*, mais autres CVE existent) | Présent dans tous les `pom.xml` |
| ?? **Duplication massive** | Même structure pour chaque variante (`ze00`, `zefj`, ) ? risque de dérive | 10+ `alimentation_unite_structurelle_*_{code}.pom.xml` |
| ?? **Hardcodage de contextes** | Chemin de log : `C:\\KLEE\\Travail\\Logs\\logfile.log` | `TEST.properties`, `Dev.properties` |
| ??? **Version mismatch Talend** | `routines:7.3.1` mais `crypto-utils:6.0.0-SNAPSHOT` ? versions Talend 6.x vs 7.x | Cohérence incertaine |
| ??? **Propriétés Maven redondantes** | `talend.job.name`, `talend.job.id`, `talend.job.folder` dupliquées partout | Ex: `alimentation_unite_structurelle_search_0.1/pom.xml` |

#### Diagramme de dette technique (priorisation)

```plantuml
@startuml
skinparam defaultTextAlignment center

rectangle "Log4j 1.x\n(CVE risquées)" as log4j #ff6666
rectangle "Duplication code\n(ze00, zefj, ...)" as dup #ffaa66
rectangle "Contextes hardcodés\n(C:\\KLEE\\...)" as hard #ffff66
rectangle "Version mismatch\n(Talend 6.x vs 7.x)" as ver #ccccff

log4j --> dup : Bloquant
dup --> hard : Élevé
hard --> ver : Moyen
@enduml
```

---

## 3. Annexes

### 3.1 Référentiels métier par unité structurelle

| Code | Hypothèse (basée sur convention de nommage) |
|------|---------------------------------------------|
| `ze00` | Unité par défaut / générique |
| `zefj` | Zone FJ (ex: France-Jeunes ?) |
| `zey1`, `zey2` | Zones Y1, Y2 (géographiques ?) |
| `ze0f` | Zone 0F (spécifique ?) |
| `zef7` | Zone F7 |
| `zd4f` | Zone D4F |
| `zeFL` | Zone FL (ex: Finistère ?) |
| `zeF9` | Zone F9 |

? **Preuve** : `alimentation_unite_structurelle_ze00_0.1/pom.xml`, `..._zefj_0.1/pom.xml`, etc.

---

### 3.2 Exemple complet : `alimentation_unite_structurelle_launcher`

#### ?? Structure

```
alimentation_unite_structurelle_launcher_0.1/
+-- pom.xml                     # 11.445 octets / 299 lignes
+-- src/
¦   +-- main/
¦   ¦   +-- assemblies/
¦   ¦   ¦   +-- assembly.xml   # 10.803 octets
¦   ¦   +-- ext-resources/
¦   ¦   ¦   +-- zechange/
¦   ¦   ¦       +-- alimentation_unite_structurelle_launcher_0_1/
¦   ¦   ¦           +-- contexts/
¦   ¦   ¦               +-- Dev.properties   # Tampon_*
¦   ¦   ¦               +-- TEST.properties  # Tampon_*
¦   ¦   +-- resources/         # contexts/ aussi ici ? (copie ?)
¦   ¦   +-- templates/
¦   ¦       +-- Job_run_template.bat  # 712 octets
¦   ¦       +-- jobInfo_template.properties
```

#### ?? `Dev.properties`

```properties
#this is context properties
#Thu Nov 25 06:50:50 CET 2021
Tampon_database=O9ISO15
Tampon_host=cp2i-bdd-tampon
Tampon_login=S_REHUCIT
# ? mot de passe absent ? probablement chiffré via crypto-utils
```

#### ?? Script `Job_run_template.bat`

```bat
%~d0
cd %~dp0
java -Dtalend.component.manager.m2.repository="%cd%/../lib" -Xms256M -Xmx1024M -cp ...
```

? Exécution locale, classpath relatif.

#### ?? `pom.xml`  Métadonnées clés

```xml
<talend.job.name>ALIMENTATION_UNITE_STRUCTURELLE_LAUNCHER</talend.job.name>
<talend.job.id>_nqR8MK9KEeeHQKbkHnd3Cw</talend.job.id>
<talend.job.folder>unite_structurelle/</talend.job.folder>
<talend.job.context>Dev</talend.job.context>
```

? Identifiant unique global (`_nqR8MK9K...`) ? traçabilité CI/CD.

#### ?? Dépendances

```xml
<dependency>
  <groupId>org.talend.libraries</groupId>
  <artifactId>crypto-utils</artifactId>
  <version>6.0.0-SNAPSHOT</version>
</dependency>
<dependency>
  <groupId>org.example.zechange.code</groupId>
  <artifactId>routines</artifactId>
  <version>7.3.1</version>
</dependency>
```

? Accès à routines métier custom + chiffrement.

---

## ? Conclusion

Lapplication **`zechange`** est un **système dintégration de données RH**, construit avec **Talend**, fortement **modulaire** et **contextualisé**, destiné à alimenter une cible à partir dune base tampon.

**Points forts** :
- Bonne structuration par domaine métier (`AGENT`, `UNITE_STRUCTURELLE`, ),
- Support CI/CD via Maven + signatures,
- Séparation claire configuration/code.

**Risques** :
- Log4j 1.x ? action corrective urgente,
- Duplication des jobs par zone ? refactoriser via paramétrage,
- Contextes hardcodés ? externaliser (ex: variables denvironnement).


````

</details>


---

### 📄 `si/zone_echange.wiki.md` [148.561 octets]
<a id="si-zone_echange-wiki-md"></a> [↩ Retour à l'arborescence](#tree-si-zone_echange-wiki-md)

> **Chemin relatif** : `si/zone_echange.wiki.md`  
> **Taille** : 148.561 octets  
> **Lignes** : 2702  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (2702 lignes) - Cliquer pour déplier</summary>

`````markdown
﻿# Projet : zone_echange.wiki

**Chemin** : `G:\WarchoLife\WarchoDevplace\Gitlab_Git\zone_echange.wiki`

**Fichiers** : 19 fichiers non-binaires

## 📁 Arborescence des fichiers

├── **home/**
│   ├── **Alimentation-de-la-base-métier/**
│   │   ├── <a id="tree-home-Alimentation-de-la-base-métier-Alimentation-des-absences-et-congés-md"></a>[Alimentation-des-absences-et-congés.md](#home-Alimentation-de-la-base-métier-Alimentation-des-absences-et-congés-md) *(5.135 octets)*
│   │   ├── <a id="tree-home-Alimentation-de-la-base-métier-Alimentation-des-affectations-md"></a>[Alimentation-des-affectations.md](#home-Alimentation-de-la-base-métier-Alimentation-des-affectations-md) *(1.803 octets)*
│   │   ├── <a id="tree-home-Alimentation-de-la-base-métier-Alimentation-des-agents-md"></a>[Alimentation-des-agents.md](#home-Alimentation-de-la-base-métier-Alimentation-des-agents-md) *(25.255 octets)*
│   │   ├── <a id="tree-home-Alimentation-de-la-base-métier-Alimentation-des-carrières-md"></a>[Alimentation-des-carrières.md](#home-Alimentation-de-la-base-métier-Alimentation-des-carrières-md) *(2.626 octets)*
│   │   ├── <a id="tree-home-Alimentation-de-la-base-métier-Alimentation-des-contractuels-md"></a>[Alimentation-des-contractuels.md](#home-Alimentation-de-la-base-métier-Alimentation-des-contractuels-md) *(3.950 octets)*
│   │   ├── <a id="tree-home-Alimentation-de-la-base-métier-Alimentation-des-corps-md"></a>[Alimentation-des-corps.md](#home-Alimentation-de-la-base-métier-Alimentation-des-corps-md) *(10.435 octets)*
│   │   ├── <a id="tree-home-Alimentation-de-la-base-métier-Alimentation-des-grades-md"></a>[Alimentation-des-grades.md](#home-Alimentation-de-la-base-métier-Alimentation-des-grades-md) *(10.301 octets)*
│   │   ├── <a id="tree-home-Alimentation-de-la-base-métier-Alimentation-des-habilitations-md"></a>[Alimentation-des-habilitations.md](#home-Alimentation-de-la-base-métier-Alimentation-des-habilitations-md) *(7.048 octets)*
│   │   ├── <a id="tree-home-Alimentation-de-la-base-métier-Alimentation-des-postes-md"></a>[Alimentation-des-postes.md](#home-Alimentation-de-la-base-métier-Alimentation-des-postes-md) *(1.812 octets)*
│   │   ├── <a id="tree-home-Alimentation-de-la-base-métier-Alimentation-des-quotités-md"></a>[Alimentation-des-quotités.md](#home-Alimentation-de-la-base-métier-Alimentation-des-quotités-md) *(3.432 octets)*
│   │   ├── <a id="tree-home-Alimentation-de-la-base-métier-Alimentation-des-rémunérations-md"></a>[Alimentation-des-rémunérations.md](#home-Alimentation-de-la-base-métier-Alimentation-des-rémunérations-md) *(6.115 octets)*
│   │   ├── <a id="tree-home-Alimentation-de-la-base-métier-Alimentation-des-unités-structurelles-md"></a>[Alimentation-des-unités-structurelles.md](#home-Alimentation-de-la-base-métier-Alimentation-des-unités-structurelles-md) *(22.067 octets)*
│   │   └── <a id="tree-home-Alimentation-de-la-base-métier-Alimentation-effectif-post-agent-md"></a>[Alimentation-effectif-post-agent.md](#home-Alimentation-de-la-base-métier-Alimentation-effectif-post-agent-md) *(2.842 octets)*
│   ├── <a id="tree-home-Alimentation-de-la-base-métier-md"></a>[Alimentation-de-la-base-métier.md](#home-Alimentation-de-la-base-métier-md) *(17.707 octets)*
│   ├── <a id="tree-home-Alimentation-des-autorisations-md"></a>[Alimentation-des-autorisations.md](#home-Alimentation-des-autorisations-md) *(2.139 octets)*
│   ├── <a id="tree-home-Alimentation-du-référentiel-md"></a>[Alimentation-du-référentiel.md](#home-Alimentation-du-référentiel-md) *(1.316 octets)*
│   ├── <a id="tree-home-Environnements-md"></a>[Environnements.md](#home-Environnements-md) *(3.065 octets)*
│   └── <a id="tree-home-Webservice-Zone-d'Echange-md"></a>[Webservice-Zone-d'Echange.md](#home-Webservice-Zone-d'Echange-md) *(597 octets)*
└── <a id="tree-home-md"></a>[home.md](#home-md) *(1.691 octets)*

---

## 📄 Contenu des fichiers


---

### 📄 `home/Alimentation-de-la-base-métier/Alimentation-des-absences-et-congés.md` [5.135 octets]
<a id="home-Alimentation-de-la-base-métier-Alimentation-des-absences-et-congés-md"></a> [↩ Retour à l'arborescence](#tree-home-Alimentation-de-la-base-métier-Alimentation-des-absences-et-congés-md)

> **Chemin relatif** : `home/Alimentation-de-la-base-métier/Alimentation-des-absences-et-congés.md`  
> **Taille** : 5.135 octets  
> **Lignes** : 46  
> **Type** : markdown

````markdown
[[_TOC_]]

# Jobs Talend (dev/2.4.4 )

## ABSENCES_CONGES_LAUNCHER
### Input (soclerh) `row1`

```sql
select
	zy00.matcle absence_conges_matricule_renoirh,
	motabs absence_conges_motif,
	datdeb absence_conges_date_debut_impact_remuneration,
	temdeb absence_conges_temoin_debut_impact_remuneration,
	datfin absence_conges_date_fin_tranche,
	temfin absence_conges_temoin_absence,
	nbrjou absence_conges_nombre_jours,
	numdro absence_conges_numero_droit,
	numtra absence_conges_numero_de_tranche,
	salzyda.valide absence_conges_temoin_de_validite
from
	salzy00 zy00
left join salzyda on
	salzyda.nudoss = zy00.nudoss
```
### Output (base_metier)
#### Table `absences_conges`

| Name                                            | Type           | Expression                                                                                                                    | isNullable |
|-------------------------------------------------|----------------|-------------------------------------------------------------------------------------------------------------------------------|------------|
| absence_conges_matricule_renoirh                | String         | row1.absence_conges_matricule_renoirh                                                                                         | true       |
| absence_conges_motif                            | String         | row1.absence_conges_motif                                                                                                     | true       |
| absence_conges_date_debut_impact_remuneration   | java.util.Date | row1.absence_conges_date_debut_impact_remuneration                                                                            | true       |
| absence_conges_temoin_debut_impact_remuneration | String         | "".equals(row1.absence_conges_temoin_debut_impact_remuneration) ? null : row1.absence_conges_temoin_debut_impact_remuneration | true       |
| absence_conges_date_fin_tranche                 | java.util.Date | row1.absence_conges_date_fin_tranche                                                                                          | true       |
| absence_conges_temoin_absence                   | String         | "".equals(row1.absence_conges_temoin_absence) ? null : row1.absence_conges_temoin_absence                                     | true       |
| absence_conges_nombre_jours                     | BigDecimal     | row1.absence_conges_nombre_jours                                                                                              | true       |
| absence_conges_numero_droit                     | String         | "".equals(row1.absence_conges_numero_droit) ? null : row1.absence_conges_numero_droit                                         | true       |
| absence_conges_numero_de_tranche                | String         | "".equals(row1.absence_conges_numero_de_tranche) ? null : row1.absence_conges_numero_de_tranche                               | true       |
| absence_conges_temoin_de_validite               | String         | row1.absence_conges_temoin_de_validite                                                                                        | true       |
| search                                          | String         | Var.search                                                                                                                    | true       |

#### Variables `Var`

| Name   | Type   | Expression                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | isNullable |
|--------|--------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
| search | String | TalendString.removeAccents(StringHandling.DOWNCASE( StringHandling.TRIM(row1.absence_conges_matricule_renoirh) + StringHandling.TRIM(row1.absence_conges_motif) + StringHandling.TRIM(row1.absence_conges_temoin_debut_impact_remuneration) + StringHandling.TRIM(row1.absence_conges_temoin_absence) + StringHandling.TO_CHAR(row1.absence_conges_nombre_jours) + StringHandling.TRIM(row1.absence_conges_numero_droit) + StringHandling.TRIM(row1.absence_conges_numero_de_tranche) + StringHandling.TRIM(row1.absence_conges_temoin_de_validite) )) | false      |
````


---

### 📄 `home/Alimentation-de-la-base-métier/Alimentation-des-affectations.md` [1.803 octets]
<a id="home-Alimentation-de-la-base-métier-Alimentation-des-affectations-md"></a> [↩ Retour à l'arborescence](#tree-home-Alimentation-de-la-base-métier-Alimentation-des-affectations-md)

> **Chemin relatif** : `home/Alimentation-de-la-base-métier/Alimentation-des-affectations.md`  
> **Taille** : 1.803 octets  
> **Lignes** : 38  
> **Type** : markdown

````markdown
[[_TOC_]]

# Jobs Talend (dev/2.4.4 )

## ALIMENTATION_AFFECTATION_LAUNCHER
### Input (soclerh) `row1`

```sql
select
	matcle affectation_matricule,
	nomuse affectation_nom,
	prenom affectation_prenom,
	zy3c.dtef00 affectation_date_effet_organisationnelle,
	zy3c.dten00 affectation_date_fin_organisationnelle,
	zy3c.idou00 affectation_unite_organisationnelle,
	zy3c.valide affectation_temoin_validite
from
	salzy00 zy00
left join salzy3c zy3c on
	zy3c.nudoss = zy00.nudoss
order by
	zy00.nudoss
```

### Output (base_metier)
#### Table `affectation`

| Name                                     | Type           | Expression                                                    | isNullable |
|------------------------------------------|----------------|---------------------------------------------------------------|------------|
| affectation_matricule                    | String         | StringHandling.TRIM(row1.affectation_matricule)               | true       |
| affectation_nom                          | String         | row1.affectation_nom                                          | true       |
| affectation_prenom                       | String         | row1.affectation_prenom                                       | true       |
| affectation_date_effet_organisationnelle | java.util.Date | row1.affectation_date_effet_organisationnelle                 | true       |
| affectation_date_fin_organisationnelle   | java.util.Date | row1.affectation_date_fin_organisationnelle                   | true       |
| affectation_unite_organisationnelle      | String         | StringHandling.TRIM(row1.affectation_unite_organisationnelle) | true       |
| affectation_temoin_validite              | String         | row1.affectation_temoin_validite                              | true       |


````


---

### 📄 `home/Alimentation-de-la-base-métier/Alimentation-des-agents.md` [25.255 octets]
<a id="home-Alimentation-de-la-base-métier-Alimentation-des-agents-md"></a> [↩ Retour à l'arborescence](#tree-home-Alimentation-de-la-base-métier-Alimentation-des-agents-md)

> **Chemin relatif** : `home/Alimentation-de-la-base-métier/Alimentation-des-agents.md`  
> **Taille** : 25.255 octets  
> **Lignes** : 377  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (377 lignes) - Cliquer pour déplier</summary>

````markdown
[[_TOC_]]  

# Jobs Talend (dev/2.4.4 )

## ALIMENTATION_AGENT_LAUNCHER
### Input (soclerh) `row1`
```sql
select
	salzy00.matcle agent_matricule_renoirh,
	idntid agent_matricule_rehucit,
	case
		when salzy00.qualit = '1' then 'M'
		when salzy00.qualit = '2' then 'Mme'
	end as agent_civilite,
	nomuse agent_nom_usuel,
	prenom agent_prenom,
	nompat agent_nom_patronymique,
	case
		when salzy10.sexemp = '1' then 'H'
		when salzy00.qualit = '2' then 'F'
	end as agent_sexe,
	salzy00.preno2 agent_autres_prenoms,
	natemp agent_pays_de_nationalite,
	datnai agent_date_de_naissance,
	vilnai agent_lieu_de_naissance,
	depnai agent_departement_de_naissance,
	paynai agent_pays_de_naissance,
	datdec agent_date_de_deces,
	ardece agent_lieu_de_deces,
	qaddprincipal.zonadb || ' ' || qaddprincipal.zonadd agent_adresse,
	substring(qaddprincipal.cdpost
from
	1 for 2) agent_adresse_departement_code,
	qaddprincipal.cdpost agent_adresse_code_postal,
	salzy4i.adusml agent_mail_professionnel,
	q34.IDOU00 agent_unite_structurelle_affectation,
	q9.sitcod agent_position_administrative,
	q9.dateff agent_position_administrative_date_effet,
	salzy18.sitfam agent_situation_familiale,
	salzy6l.idlotp agent_lot_gestion,
	salzy00.soccle agent_nom_reglementation,
	q20.corps agent_carriere_origine_corps,
	zqq.liblon agent_carriere_origine_corps_libelle,
	q20.datcor agent_carriere_origine_corps_date_entree,
	q24.adecod agent_carriere_origine_grade,
	zqrr.liblon agent_carriere_origine_grade_libelle,
	q24.datgra agent_carriere_origine_grade_date_entree,
	q25.echelo agent_carriere_origine_echelon,
	q21.corps agent_carriere_emploi_fonctionnel_corps,
	zqmm.liblon agent_carriere_emploi_fonctionnel_corps_libelle,
	q21.datcor agent_carriere_emploi_fonctionnel_corps_date_entree,
	q23.adecod agent_carriere_emploi_fonctionnel_grade,
	zqmm.liblon agent_carriere_emploi_fonctionnel_grade_libelle,
	q23.dateff agent_carriere_emploi_fonctionnel_grade_date_entree,
	q26.echelo agent_carriere_emploi_fonctionnel_echelon,
	q30.corps agent_carriere_accueil_corps,
	zq30.liblon agent_carriere_accueil_corps_libelle,
	q30.datcor agent_carriere_accueil_corps_date_entree,
	q31.adecod agent_carriere_accueil_grade,
	zq31.liblon agent_carriere_accueil_grade_libelle,
	q31.datgra agent_carriere_accueil_grade_date_entree,
	q32.echelo agent_carriere_accueil_echelon,
	q34.idps00 agent_code_poste,
	qrr50.lbpslg agent_poste_libelle,
	q33.idou00 agent_affectation_administrative_code,
	qrr51.lboulg agent_affectation_administrative_libelle_long,
	qrr51.lboush agent_affectation_administrative_libelle_court,
	q33.dtef00 agent_affectation_administrative_date_installation,
	q33.dten00 agent_affectation_administrative_date_fin_reelle,
	q34.idou00 agent_affectation_operationnelle_code,
	qrr52.lboulg agent_affectation_operationnelle_libelle_long,
	qrr52.lboush agent_affectation_operationnelle_libelle_court,
	q34.dtef00 agent_affectation_operationnelle_date_debut,
	q34.dten00 agent_affectation_operationnelle_date_fin,
	q53.statut agent_statut,
	qrr53.liblon agent_statut_libelle,
	q35.dateff agent_statut_date_effet,
	q54.valide agent_temoin_validite,
	q54.datent agent_date_entree_ministere,
	qpart.part agent_partenaire,
	substring(salzy00.matcle
from
	1 for 3) agent_pese,
	qcco.cco agent_code_corresp,
	YCO.datcon as agent_contractuel_date_debut,
	YCO.datfin as agent_contractuel_date_fin_reelle,
	YCO.datpre as agent_contractuel_date_fin_previsionnelle,
	YCO.typcon as agent_contractuel_type_contrat,
	ZD_UIP.liblon as agent_contractuel_type_contrat_libelle,
	YCO.psgrne as agent_contractuel_pseudo_grade,
	ZD_DJO.liblon as agent_contractuel_pseudo_grade_libelle,
	YCO.numdel as agent_contractuel_num_contrat,
	YCO.numave as agent_contractuel_num_avenant
from
	salzy00
left join salzy10 on
	salzy10.nudoss = salzy00.nudoss
left join(
	select
		nudoss,
		max(datxxx)as d
	from
		salzycb
	group by
		nudoss) q1 on
	q1.nudoss = salzy00.nudoss
left join salzycb on
	salzy00.nudoss = salzycb.nudoss
	and q1.d = salzycb.datxxx

--agent_adresse_code_postal
left join (select nudoss,
  max(datdeb) as debut from salzy0f group by nudoss) qadd on salzy00.nudoss=qadd.nudoss 
left join (select datdeb,nudoss,cdpost,zonadb,zonadd from salzy0f where  typadd='TA01' ) qaddprincipal on salzy00.nudoss=qaddprincipal.nudoss and qadd.debut=qaddprincipal.datdeb
--agent_mail_professionnel
left join (select nudoss,
 max(dtef00)as d from salzy4i group by nudoss) q17 on q17.nudoss=salzy00.nudoss
left join salzy4i on salzy00.nudoss=salzy4i.nudoss and salzy4i.dtef00=q17.d
--position admin et date effet
left join (select nudoss,sitcod,dateff from salzypo where  to_char(current_timestamp,
 'YYYYMMDD')between to_char(salzypo.Dateff,'YYYYMMDD')and to_char(salzypo.datxxx,
 'YYYYMMDD')) q9 on q9.nudoss=salzy00.nudoss
--left join (select nudoss,sitcod from salzypo ) q90 on q90.nudoss=salzy00.nudoss
--agent_situation_familiale
left join (select nudoss,
 max(datxxx) as d from salzy18 group by nudoss)q6 on q6.nudoss=salzy00.nudoss
left join salzy18 on q6.d=salzy18.datxxx and salzy00.nudoss=salzy18.nudoss

left join (select nudoss,
 max(dateff) as d from salzyde group by nudoss) q0 on q0.nudoss=salzy00.nudoss
left join salzyde on salzy00.nudoss=salzyde.nudoss and salzyde.dateff=q0.d
left join (select nudoss,
 max(dten00) as d from salzy3b group by nudoss) q5 on q5.nudoss=salzy00.nudoss
left join salzy3b on salzy3b.nudoss=salzy00.nudoss and salzy3b.dten00=q5.d
left join (select nudoss,
 max(datxxx) as d from salzyfl group by nudoss) q8 on q8.nudoss=salzy00.nudoss
left join salzyfl on salzyfl.nudoss=salzy00.nudoss and q8.d=salzyfl.datxxx
left join (select salzyfl.nudoss,
  max(datxxx) as d from salzyfl group by nudoss)q10 on q10.nudoss=salzyfl.nudoss
left join zd00 on salzyfl.statut=zd00.cdcode 
--corps origine libelle
left join (select nudoss,corps from salzygr where  to_char(current_timestamp,
 'YYYYMMDD')between to_char(salzygr.Dateff,'YYYYMMDD')and to_char(salzygr.datfin,
 'YYYYMMDD') and codcar='O')q40 on q40.nudoss=salzy00.nudoss
left join zd00 zq on q40.corps=zq.cdcode and zq.cdstco='HJV'
left join (select nudoss, liblon from zd01) as zqq on zqq.nudoss=zq.nudoss
--origine grade libelle
left join (select nudoss,adecod from salzygr where  to_char(current_timestamp,
 'YYYYMMDD')between to_char(salzygr.Dateff,'YYYYMMDD')and to_char(salzygr.datfin,
 'YYYYMMDD') and codcar='O')q41 on q41.nudoss=salzy00.nudoss
left join (select nudoss, cdcode,
 cdstco from zd00)as zqr on q41.adecod=zqr.cdcode and zqr.cdstco='HJB'
left join (select nudoss, liblon from zd01) as zqrr on zqr.nudoss=zqrr.nudoss
--emploi fonctionnel libelle
left join (select nudoss,corps from salzygr where  to_char(current_timestamp,
 'YYYYMMDD')between to_char(salzygr.Dateff,'YYYYMMDD')and to_char(salzygr.datfin,
 'YYYYMMDD') and codcar='A' and corps like 'E%')q42 on q42.nudoss=salzy00.nudoss
left join (select nudoss, cdcode,
 cdstco from zd00)as zqm on q42.corps=zqm.cdcode and zqm.cdstco='HJV'
left join (select nudoss, liblon from zd01) as zqmm on zqm.nudoss=zqmm.nudoss 
--lot de gestion
left join (select nudoss,
 max(dten00) as d from salzy6l group by nudoss)as q on salzy00.nudoss=q.nudoss
left join salzy6l on salzy00.nudoss=salzy6l.nudoss and q.d=salzy6l.dten00
-- corps origine
left join(select salzygr.nudoss, corps,
 datcor from salzygr  where codcar='O' and to_char(current_timestamp,
 'YYYYMMDD')between to_char(salzygr.DATeff,'YYYYMMDD')and to_char(salzygr.DATfin,
 'YYYYMMDD')) q20 on q20.nudoss=salzy00.nudoss

--emploi accueil corps
left join (select nudoss, corps,datcor  from salzygr where to_char(current_timestamp,
 'YYYYMMDD')between to_char(salzygr.DATeff,'YYYYMMDD')and to_char(salzygr.DATfin,
 'YYYYMMDD') and codcar='A' and CORPS LIKE 'G%' )q30 on q30.nudoss=salzy00.nudoss
 left join (select nudoss,cdcode from zd00)as q030 on q030.cdcode=q30.corps
 left join (select nudoss, liblon from zd01) as zq30 on zq30.nudoss=q030.nudoss
--emploi fonctionnel corps
left join (select nudoss, corps,datcor  from salzygr where to_char(current_timestamp,
 'YYYYMMDD')between to_char(salzygr.DATeff,'YYYYMMDD')and to_char(salzygr.DATfin,
 'YYYYMMDD') and codcar='A' and CORPS LIKE 'E%' )q21 on q21.nudoss=salzy00.nudoss
--emploi fonctionnel grade
left join (select nudoss, adecod,datgra,dateff  from salzygr where to_char(current_timestamp,
 'YYYYMMDD')between to_char(salzygr.DATeff,'YYYYMMDD')and to_char(salzygr.DATfin,
 'YYYYMMDD') and codcar='A' and ADECOD LIKE 'E%')q23 on q23.nudoss=salzy00.nudoss
--carriere origine grade
left join (select nudoss, adecod,datgra  from salzygr where to_char(current_timestamp,
 'YYYYMMDD')between to_char(salzygr.DATeff,'YYYYMMDD')and to_char(salzygr.DATfin,
 'YYYYMMDD') and codcar='O' )q24 on q24.nudoss=salzy00.nudoss
--carriere accueil grade
left join (select nudoss, adecod,datgra  from salzygr where to_char(current_timestamp,
 'YYYYMMDD')between to_char(salzygr.DATeff,'YYYYMMDD')and to_char(salzygr.DATfin,
 'YYYYMMDD') and codcar='A' AND CORPS like 'G%')q31 on q31.nudoss=salzy00.nudoss
 left join(select cdcode,nudoss from zd00)as q031 on q031.cdcode=q31.adecod
 left join (select liblon,nudoss from zd01)as zq31 on zq31.nudoss=q031.nudoss
--carriere origine echelon
left join (select nudoss, echelo from salzygr where to_char(current_timestamp,
 'YYYYMMDD')between to_char(salzygr.DATeff,'YYYYMMDD')and to_char(salzygr.DATfin,
 'YYYYMMDD')and codcar='O' )as q25 on q25.nudoss=salzy00.nudoss
--carriere accueil echelon
left join (select nudoss, echelo from salzygr where to_char(current_timestamp,
 'YYYYMMDD')between to_char(salzygr.DATeff,'YYYYMMDD')and to_char(salzygr.DATfin,
 'YYYYMMDD')and codcar='A' and CORPS LIKE 'G%')as q32 on q32.nudoss=salzy00.nudoss
--emploi fonctionnel echelon
left join (select nudoss, echelo from salzygr where to_char(current_timestamp,
 'YYYYMMDD')between to_char(salzygr.DATeff,'YYYYMMDD')and to_char(salzygr.DATfin,
 'YYYYMMDD')and codcar='A' and ADECOD LIKE 'E%')as q26 on q26.nudoss=salzy00.nudoss
--affectation administrative
left join (select nudoss, IDOU00,dten00, dtef00 from salzy3c where to_char(current_timestamp,
 'YYYYMMDD')between to_char(salzy3c.DTef00,'YYYYMMDD')and to_char(salzy3c.DTen00,
 'YYYYMMDD')  and tytrst='ADM')as q33 on q33.nudoss=salzy00.nudoss
--agent_affectation_administrative_libelle_long et court
left join(select nudoss, idou00 from ze00)as qr51 on  qr51.idou00=q33.idou00
left join (select nudoss,lboulg,lboush from ze01)as qrr51 on qrr51.nudoss=qr51.nudoss
--affectation operationnelle et code_poste
left join (select nudoss, idps00,IDOU00,dten00,
  dtef00 from salzy3b where to_char(current_timestamp,'YYYYMMDD')between to_char(salzy3b.DTef00,
 'YYYYMMDD')and to_char(salzy3b.DTen00,'YYYYMMDD'))q34 on q34.nudoss=salzy00.nudoss
--statut date effet
left join (select nudoss, dateff from salzyfl where to_char(current_timestamp,
 'YYYYMMDD')between to_char(salzyfl.Dateff,'YYYYMMDD')and to_char(salzyfl.datxxx,
 'YYYYMMDD'))q35 on q35.nudoss=salzy00.nudoss
-- libelle agent poste
left join (select nudoss,idps00 from salzy3b where to_char(current_timestamp,
 'YYYYMMDD')between to_char(salzy3b.dtef00,'YYYYMMDD')and to_char(salzy3b.dten00,
 'YYYYMMDD'))as q50 on salzy00.nudoss=q50.nudoss
left join(select nudoss, idps00 from za00)as qr50 on  qr50.idps00=q50.idps00
left join (select nudoss,lbpslg from za01)as qrr50 on qrr50.nudoss=qr50.nudoss
--agent_affectation_operationnelle_libelle_long court
left join (select nudoss,idou00 from salzy3b where to_char(current_timestamp,
 'yyyymmdd')between to_char(salzy3b.dtef00,'yyyymmdd')and to_char(salzy3b.dten00,
 'yyyymmdd'))as q52 on salzy00.nudoss=q52.nudoss
left join(select nudoss, idou00 from ze00)as qr52 on  qr52.idou00=q52.idou00
left join (select nudoss,lboulg,lboush from ze01)as qrr52 on qrr52.nudoss=qr52.nudoss 
--agent_statut_libelle
left join (select nudoss,statut from salzyfl where to_char(current_timestamp,
 'yyyymmdd')between to_char(salzyfl.dateff,'yyyymmdd')and to_char(salzyfl.datxxx,
 'yyyymmdd'))as q53 on salzy00.nudoss=q53.nudoss
left join(select nudoss, cdcode,
 cdstco from zd00)as qr53 on  qr53.cdcode=q53.statut and qr53.cdstco='HJ8'
left join (select nudoss,liblon from zd01)as qrr53 on qrr53.nudoss=qr53.nudoss
--agent temoin validite
left join (select nudoss,valide,datent from salzyes where to_char(current_timestamp,
 'yyyymmdd')between to_char(salzyes.datent,'yyyymmdd')and to_char(salzyes.datsor,
 'yyyymmdd')) as q54  on salzy00.nudoss=q54.nudoss
--axe partenaire
left join(SELECT salzy9u.extc21 part,
 matcle 
 FROM salzy00 JOIN salzy9u ON salzy00.nudoss = salzy9u.nudoss)as qpart on 
 qpart.matcle=salzy00.matcle
--axe
left join(SELECT salzyf9.sgapfi cco,
 salzy00.matcle FROM salzyf9 JOIN salzy00 ON salzy00.nudoss = salzyf9.nudoss
AND salzyf9.datdeb<=current_date AND salzyf9.datfin>current_date
AND salzyf9.dpprin = '1')as qcco on qcco.matcle=salzy00.matcle

--Jointure ZYCO : le contrat--

left outer join (select C.nudoss, C.datcon, C.datfin, C.datpre, C.typcon, C.cgjbco, C.modgst, C.modrem, C.psgrne, C.numdel, C.numave 
from SALZYCO C
inner join(select max(datcon) max_date_contrat, zyco.nudoss from salzy00  join salzyco zyco 
on zyco.nudoss=salzy00.nudoss  
where zyco.datfin>current_date and zyco.datcon<current_date
 group by zyco.nudoss) last_cont on c.nudoss=last_cont.nudoss and c.datcon=last_cont.max_date_contrat)YCO on YCO.nudoss=salzY00.nudoss

--Jointure ZD00 et ZD01 : 'UIP' type contrat--

left outer join (select D0.nudoss, D0.cdcode, D0.cdstco, D1.liblon from ZD00 D0, ZD01 D1 where D0.nudoss=D1.nudoss and D0.cdstco='UIP')ZD_UIP on ZD_UIP.cdcode=YCO.typcon

--Jointure ZD00 et ZD01 : 'DJO' pseudo grade NNE--

left outer join (
select
	D0.nudoss,
	D0.cdcode,
	D0.cdstco,
	D1.liblon
from
	ZD00 D0,
	ZD01 D1
where
	D0.nudoss = D1.nudoss
	and D0.cdstco = 'DJO')ZD_DJO on
ZD_DJO.cdcode = YCO.psgrne
```

#### Précisions 
Ces colonnes sont renommées dans le code Java :  

| Colonne (sql) | Colonne (java) |
| ------ | ------ |
| agent_partenaire | agent_axe_partenaire |
| agent_pese | agent_axe_pese |
| agent_code_corresp | agent_axe_code_corresp |


### Output (base_metier)
#### Table `agent`

| Name                                                | Type           | Expression                                               | isNullable |
|-----------------------------------------------------|----------------|----------------------------------------------------------|------------|
| agent_matricule_renoirh                             | String         | row1.agent_matricule_renoirh                             | true       |
| agent_matricule_rehucit                             | String         | row1.agent_matricule_rehucit                             | true       |
| agent_civilite                                      | String         | row1.agent_civilite                                      | true       |
| agent_nom_usuel                                     | String         | row1.agent_nom_usuel                                     | true       |
| agent_prenom                                        | String         | row1.agent_prenom                                        | true       |
| agent_nom_patronymique                              | String         | row1.agent_nom_patronymique                              | true       |
| agent_sexe                                          | String         | row1.agent_sexe                                          | true       |
| agent_autres_prenoms                                | String         | row1.agent_autres_prenoms                                | true       |
| agent_pays_de_nationalite                           | String         | row1.agent_pays_de_nationalite                           | true       |
| agent_date_de_naissance                             | java.util.Date | row1.agent_date_de_naissance                             | true       |
| agent_lieu_de_naissance                             | String         | row1.agent_lieu_de_naissance                             | true       |
| agent_departement_de_naissance                      | String         | row1.agent_departement_de_naissance                      | true       |
| agent_pays_de_naissance                             | String         | row1.agent_pays_de_naissance                             | true       |
| agent_date_de_deces                                 | java.util.Date | row1.agent_date_de_deces                                 | true       |
| agent_lieu_de_deces                                 | String         | row1.agent_lieu_de_deces                                 | true       |
| agent_adresse                                       | String         | row1.agent_adresse                                       | true       |
| agent_adresse_departement_code                      | String         | row1.agent_adresse_departement_code                      | true       |
| agent_adresse_code_postal                           | String         | row1.agent_adresse_code_postal                           | true       |
| agent_mail_professionnel                            | String         | row1.agent_mail_professionnel                            | true       |
| agent_unite_structurelle_affectation                | String         | row1.agent_unite_structurelle_affectation                | true       |
| agent_position_administrative                       | String         | row1.agent_position_administrative                       | true       |
| agent_position_administrative_date_effet            | java.util.Date | row1.agent_position_administrative_date_effet            | true       |
| agent_situation_familiale                           | String         | row1.agent_situation_familiale                           | true       |
| agent_lot_gestion                                   | String         | row1.agent_lot_gestion                                   | true       |
| agent_nom_reglementation                            | String         | row1.agent_nom_reglementation                            | true       |
| agent_carriere_origine_corps                        | String         | row1.agent_carriere_origine_corps                        | true       |
| agent_carriere_origine_corps_libelle                | String         | row1.agent_carriere_origine_corps_libelle                | true       |
| agent_carriere_origine_corps_date_entree            | java.util.Date | row1.agent_carriere_origine_corps_date_entree            | true       |
| agent_carriere_origine_grade                        | String         | row1.agent_carriere_origine_grade                        | true       |
| agent_carriere_origine_grade_libelle                | String         | row1.agent_carriere_origine_grade_libelle                | true       |
| agent_carriere_origine_grade_date_entree            | java.util.Date | row1.agent_carriere_origine_grade_date_entree            | true       |
| agent_carriere_origine_echelon                      | String         | row1.agent_carriere_origine_echelon                      | true       |
| agent_carriere_emploi_fonctionnel_corps             | String         | row1.agent_carriere_emploi_fonctionnel_corps             | true       |
| agent_carriere_emploi_fonctionnel_corps_libelle     | String         | row1.agent_carriere_emploi_fonctionnel_corps_libelle     | true       |
| agent_carriere_emploi_fonctionnel_corps_date_entree | java.util.Date | row1.agent_carriere_emploi_fonctionnel_corps_date_entree | true       |
| agent_carriere_emploi_fonctionnel_grade             | String         | row1.agent_carriere_emploi_fonctionnel_grade             | true       |
| agent_carriere_emploi_fonctionnel_grade_libelle     | String         | row1.agent_carriere_emploi_fonctionnel_grade_libelle     | true       |
| agent_carriere_emploi_fonctionnel_grade_date_entree | java.util.Date | row1.agent_carriere_emploi_fonctionnel_grade_date_entree | true       |
| agent_carriere_emploi_fonctionnel_echelon           | String         | row1.agent_carriere_emploi_fonctionnel_echelon           | true       |
| agent_carriere_accueil_corps                        | String         | row1.agent_carriere_accueil_corps                        | true       |
| agent_carriere_accueil_corps_libelle                | String         | row1.agent_carriere_accueil_corps_libelle                | true       |
| agent_carriere_accueil_corps_date_entree            | java.util.Date | row1.agent_carriere_accueil_corps_date_entree            | true       |
| agent_carriere_accueil_grade                        | String         | row1.agent_carriere_accueil_grade                        | true       |
| agent_carriere_accueil_grade_libelle                | String         | row1.agent_carriere_accueil_grade_libelle                | true       |
| agent_carriere_accueil_grade_date_entree            | java.util.Date | row1.agent_carriere_accueil_grade_date_entree            | true       |
| agent_carriere_accueil_echelon                      | String         | row1.agent_carriere_accueil_echelon                      | true       |
| agent_code_poste                                    | String         | row1.agent_code_poste                                    | true       |
| agent_poste_libelle                                 | String         | row1.agent_poste_libelle                                 | true       |
| agent_affectation_administrative_code               | String         | row1.agent_affectation_administrative_code               | true       |
| agent_affectation_administrative_libelle_long       | String         | row1.agent_affectation_administrative_libelle_long       | true       |
| agent_affectation_administrative_libelle_court      | String         | row1.agent_affectation_administrative_libelle_court      | true       |
| agent_affectation_administrative_date_installation  | java.util.Date | row1.agent_affectation_administrative_date_installation  | true       |
| agent_affectation_administrative_date_fin_reelle    | java.util.Date | row1.agent_affectation_administrative_date_fin_reelle    | true       |
| agent_affectation_operationnelle_code               | String         | row1.agent_affectation_operationnelle_code               | true       |
| agent_affectation_operationnelle_libelle_long       | String         | row1.agent_affectation_operationnelle_libelle_long       | true       |
| agent_affectation_operationnelle_libelle_court      | String         | row1.agent_affectation_operationnelle_libelle_court      | true       |
| agent_affectation_operationnelle_date_debut         | java.util.Date | row1.agent_affectation_operationnelle_date_debut         | true       |
| agent_affectation_operationnelle_date_fin           | java.util.Date | row1.agent_affectation_operationnelle_date_fin           | true       |
| agent_statut                                        | String         | row1.agent_statut                                        | true       |
| agent_statut_libelle                                | String         | row1.agent_statut_libelle                                | true       |
| agent_statut_date_effet                             | java.util.Date | row1.agent_statut_date_effet                             | true       |
| agent_temoin_validite                               | String         | row1.agent_temoin_validite                               | true       |
| agent_date_entree_ministere                         | java.util.Date | row1.agent_date_entree_ministere                         | true       |
| agent_axe_partenaire                                | String         | row1.agent_axe_partenaire                                | true       |
| agent_axe_pese                                      | String         | row1.agent_axe_pese                                      | true       |
| agent_axe_code_corresp                              | String         | row1.agent_axe_code_corresp                              | true       |
| agent_contractuel_date_debut                        | java.util.Date | row1.agent_contractuel_date_debut                        | true       |
| agent_contractuel_date_fin_reelle                   | java.util.Date | row1.agent_contractuel_date_fin_reelle                   | true       |
| agent_contractuel_date_fin_previsionnelle           | java.util.Date | row1.agent_contractuel_date_fin_previsionnelle           | true       |
| agent_contractuel_type_contrat                      | String         | row1.agent_contractuel_type_contrat                      | true       |
| agent_contractuel_type_contrat_libelle              | String         | row1.agent_contractuel_type_contrat_libelle              | true       |
| agent_contractuel_pseudo_grade                      | String         | row1.agent_contractuel_pseudo_grade                      | true       |
| agent_contractuel_pseudo_grade_libelle              | String         | row1.agent_contractuel_pseudo_grade_libelle              | true       |
| agent_contractuel_num_contrat                       | String         | row1.agent_contractuel_num_contrat                       | true       |
| agent_contractuel_num_avenant                       | String         | row1.agent_contractuel_num_avenant                       | true       |


````

</details>


---

### 📄 `home/Alimentation-de-la-base-métier/Alimentation-des-carrières.md` [2.626 octets]
<a id="home-Alimentation-de-la-base-métier-Alimentation-des-carrières-md"></a> [↩ Retour à l'arborescence](#tree-home-Alimentation-de-la-base-métier-Alimentation-des-carrières-md)

> **Chemin relatif** : `home/Alimentation-de-la-base-métier/Alimentation-des-carrières.md`  
> **Taille** : 2.626 octets  
> **Lignes** : 50  
> **Type** : markdown

````markdown
[[_TOC_]]

# Jobs Talend (dev/2.4.4 )

## ALIMENTATION_CARRIERE_LAUNCHER
### Input (soclerh) `row1`

```sql
select
	zy00.matcle carriere_matricule,
	zy00.nomuse carriere_nom,
	zy00.prenom carriere_prenom,
	zy10.datnai carriere_date_de_naissance,
	zygs.dateff carriere_date_debut,
	zygs.datfin carriere_date_fin,
	zygs.adecod carriere_grade_statutaire_date_effet_classement,
	zygs.echplq carriere_identifiant_preliquidation_echelon,
	zygs.valide carriere_temoin_validite_information,
	zyfl.statut carriere_statut_agent,
	zygs.specia carriere_specialite
from
	salzygs zygs
left join salzy00 zy00 on
	zy00.nudoss = zygs.nudoss
left join salzy10 zy10 on
	zy00.nudoss = zy10.nudoss
left join salzyfl zyfl on
	zyfl.nudoss = zy00.nudoss
	and zygs.dateff >= zyfl.dateff
	and zygs.dateff<zyfl.datxxx
```

### Output (base_metier)
#### Table `carriere`

| Name                                            | Type           | Expression                                           | isNullable |
|-------------------------------------------------|----------------|------------------------------------------------------|------------|
| carriere_matricule                              | String         | row1.carriere_matricule                              | true       |
| carriere_nom                                    | String         | row1.carriere_nom                                    | true       |
| carriere_prenom                                 | String         | row1.carriere_prenom                                 | true       |
| carriere_date_de_naissance                      | java.util.Date | row1.carriere_date_de_naissance                      | true       |
| carriere_date_debut                             | java.util.Date | row1.carriere_date_debut                             | true       |
| carriere_date_fin                               | java.util.Date | row1.carriere_date_fin                               | true       |
| carriere_grade_statutaire_date_effet_classement | String         | row1.carriere_grade_statutaire_date_effet_classement | true       |
| carriere_identifiant_preliquidation_echelon     | String         | row1.carriere_identifiant_preliquidation_echelon     | true       |
| carriere_temoin_validite_information            | String         | row1.carriere_temoin_validite_information            | true       |
| carriere_statut_agent                           | String         | row1.carriere_statut_agent                           | true       |
| carriere_specialite                             | String         | row1.carriere_specialite                             | true       |


````


---

### 📄 `home/Alimentation-de-la-base-métier/Alimentation-des-contractuels.md` [3.950 octets]
<a id="home-Alimentation-de-la-base-métier-Alimentation-des-contractuels-md"></a> [↩ Retour à l'arborescence](#tree-home-Alimentation-de-la-base-métier-Alimentation-des-contractuels-md)

> **Chemin relatif** : `home/Alimentation-de-la-base-métier/Alimentation-des-contractuels.md`  
> **Taille** : 3.950 octets  
> **Lignes** : 72  
> **Type** : markdown

````markdown
[[_TOC_]]

# Jobs Talend (dev/2.4.4 )

## ALIMENTATION_CONTRACTUEL_LAUNCHER
### Input (soclerh) `row1`

```sql
select
	ZD00.CDCODE reglementaire_code_pseudo_grade,
	ZD01.LIBLON reglementaire_pseudo_grade_libelle_long,
	zd01.libabr reglementaire_pseudo_grade_libelle_agrege,
	ZD01.LBCMP1 reglementaire_pseudo_grade_libelle_complementaire,
	ZD00.DTDVA reglementaire_pseudo_grade_date_debut_validite,
	ZD00.DTFVA reglementaire_pseudo_grade_date_fin_validite,
	case
		when (to_char(zd00.dtfva,
		'YYYYMMAA')) > (to_char(current_timestamp,
		'YYYYMMAA'))
		or (zd00.dtfva = null) then true
		else false
	end as reglementaire_grade_ouvert,
	q.total reglementaire_grade_nb_agents ,
	nbHommes reglementaire_pseudo_grade_nb_agents_masculins,
	nbFemmes reglementaire_pseudo_grade_nb_agents_feminins
from
	zd00
inner join (
	select
		zyco.psgrne c,
		--nombre global
		sum(case when to_char(current_timestamp, 'YYYYMMDD') between to_char(zyco.datcon, 'YYYYMMDD') and to_char(zyco.datfin, 'YYYYMMDD')then 1 else 0 end) as total,
		sum(case when sexemp = '1' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zyco.datcon, 'YYYYMMDD') and to_char(zyco.datfin, 'YYYYMMDD'))then 1 else 0 end)as nbHommes,
		sum(case when sexemp = '2' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zyco.datcon, 'YYYYMMDD') and to_char(zyco.datfin, 'YYYYMMDD'))then 1 else 0 end)as nbFemmes
	from
		salzyco zyco
	left join salzy10 zy10 on
		zyco.nudoss = zy10.nudoss
	group by
		zyco.psgrne) q on
	zd00.CDCODE = q.c
left join zd01 on
	zd00.nudoss = zd01.nudoss
where
	ZD00.CDSTCO = 'DJO'
```

#### Précisions 
 - q.total reglementaire_grade_nb_agents : reglementaire_pseudo_grade_nb_agents

### Output (base_metier)
#### Table `contractuel`

| Name                                              | Type           | Expression                                             | isNullable |
|---------------------------------------------------|----------------|--------------------------------------------------------|------------|
| reglementaire_code_pseudo_grade                   | String         | row1.reglementaire_code_pseudo_grade                   | true       |
| reglementaire_pseudo_grade_libelle_long           | String         | row1.reglementaire_pseudo_grade_libelle_long           | true       |
| reglementaire_pseudo_grade_libelle_agrege         | String         | row1.reglementaire_pseudo_grade_libelle_agrege         | true       |
| reglementaire_pseudo_grade_libelle_complementaire | String         | row1.reglementaire_pseudo_grade_libelle_complementaire | true       |
| reglementaire_pseudo_grade_date_debut_validite    | java.util.Date | row1.reglementaire_pseudo_grade_date_debut_validite    | true       |
| reglementaire_pseudo_grade_date_fin_validite      | java.util.Date | row1.reglementaire_pseudo_grade_date_fin_validite      | true       |
| reglementaire_pseudo_grade_ouvert                 | Boolean        | row1.reglementaire_pseudo_grade_ouvert                 | true       |
| reglementaire_pseudo_grade_avec_agents            | Boolean        | Var.reglementaire_grade_avec_agents                    | true       |
| reglementaire_pseudo_grade_nb_agents              | Integer        | row1.reglementaire_pseudo_grade_nb_agents              | true       |
| reglementaire_pseudo_grade_nb_agents_masculins    | Integer        | row1.reglementaire_pseudo_grade_nb_agents_masculins    | true       |
| reglementaire_pseudo_grade_nb_agents_feminins     | Integer        | row1.reglementaire_pseudo_grade_nb_agents_feminins     | true       |

#### Variables `Var`

| Name                            | Type    | Expression                                                  | isNullable |
|---------------------------------|---------|-------------------------------------------------------------|------------|
| reglementaire_grade_avec_agents | boolean | row1.reglementaire_pseudo_grade_nb_agents >0 ? true : false | false      |
````


---

### 📄 `home/Alimentation-de-la-base-métier/Alimentation-des-corps.md` [10.435 octets]
<a id="home-Alimentation-de-la-base-métier-Alimentation-des-corps-md"></a> [↩ Retour à l'arborescence](#tree-home-Alimentation-de-la-base-métier-Alimentation-des-corps-md)

> **Chemin relatif** : `home/Alimentation-de-la-base-métier/Alimentation-des-corps.md`  
> **Taille** : 10.435 octets  
> **Lignes** : 155  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (155 lignes) - Cliquer pour déplier</summary>

````markdown
[[_TOC_]]

# Jobs Talend (dev/2.4.4 )

## ALIMENTATION_CORPS_LAUNCHER
### Input (soclerh) `row1`

```sql
select
	ZD00.CDCODE reglementaire_code_corps,
	ZD01.LIBLON reglegmentaire_corps_libelle_long,
	zd01.libabr reglementaire_corps_libelle_agrege,
	ZD01.LBCMP1 reglementaire_corps_libelle_complementaire,
	ZD00.DTDVA reglementaire_corps_date_debut_validite,
	ZD00.DTFVA reglementaire_corps_date_fin_validite,
	case
		when (to_char(zd00.dtfva,
		'YYYYMMAA')) > (to_char(current_timestamp,
		'YYYYMMAA'))
		or (zd00.dtfva = null) then true
		else false
	end as reglementaire_corps_ouvert,
	q.total reglementaire_corps_nb_agents ,
	nbHommes reglementaire_corps_nb_agents_masculins,
	nbFemmes reglementaire_corps_nb_agents_feminins,
	totalfonctionnel reglementaire_corps_emplois_fonctionnels_nb_agents,
	nbFonctionnelHommes reglementaire_corps_emplois_fonctionnels_nb_agents_masculins,
	nbFonctionnelFemmes reglementaire_corps_emplois_fonctionnels_nb_agents_feminins,
	totalOrigine reglementaire_corps_origine_nb_agents,
	nbOrigineHommes reglementaire_corps_origine_nb_agents_masculins,
	nbOrigineFemmes reglementaire_corps_origine_nb_agents_feminins,
	totalAccueil reglementaire_corps_accueil_nb_agents,
	nbAccueilHommes reglementaire_corps_accueil_nb_agents_masculins,
	nbAccueilFemmes reglementaire_corps_accueil_nb_agents_feminins
from
	zd00
inner join (
	select
		zygr.corps c,
		--nombre global
		sum(case when to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD')then 1 else 0 end) as total,
		sum(case when sexemp = '1' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD'))then 1 else 0 end)as nbHommes,
		sum(case when sexemp = '2' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD'))then 1 else 0 end)as nbFemmes,
		--nombre  emploi fonctionnel
		sum(case when zygr.codcar = 'A' and zygr.corps like 'E%' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD')) then 1 else 0 end) as totalfonctionnel,
		sum(case when sexemp = '1' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD') and zygr.codcar = 'A' and zygr.corps like 'E%')then 1 else 0 end)as nbFonctionnelHommes,
		sum(case when sexemp = '2' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD')and zygr.codcar = 'A' and zygr.corps like 'E%')then 1 else 0 end)as nbFonctionnelFemmes,
		--nombre corps origine
		sum(case when zygr.codcar = 'O' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD')) then 1 else 0 end) as totalOrigine,
		sum(case when sexemp = '1' and zygr.codcar = 'O' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD') )then 1 else 0 end)as nbOrigineHommes,
		sum(case when sexemp = '2' and zygr.codcar = 'O' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD'))then 1 else 0 end)as nbOrigineFemmes,
		--nombre corps d'accueil
		sum(case when zygr.codcar = 'A' and zygr.corps like 'G%' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD')) then 1 else 0 end) as totalAccueil,
		sum(case when sexemp = '1' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD') and zygr.codcar = 'A' and zygr.corps like 'G%')then 1 else 0 end)as nbAccueilHommes,
		sum(case when sexemp = '2' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD')and zygr.codcar = 'A' and zygr.corps like 'G%')then 1 else 0 end)as nbAccueilFemmes
	from
		salzygr zygr
	left join salzy10 zy10 on
		zygr.nudoss = zy10.nudoss
	group by
		zygr.corps) q on
	zd00.CDCODE = q.c
left join zd01 on
	zd00.nudoss = zd01.nudoss
where
	ZD00.CDSTCO = 'HJV'

UNION

select
	ZD00.CDCODE reglementaire_code_corps,
	ZD01.LIBLON reglementaire_corps_libelle_long,
	zd01.libabr reglementaire_corps_libelle_agrege,
	ZD01.LBCMP1 reglementaire_corps_libelle_complementaire,
	ZD00.DTDVA reglementaire_corps_date_debut_validite,
	ZD00.DTFVA reglementaire_corps_date_fin_validite,
	case
		when (to_char(zd00.dtfva,
		'YYYYMMAA')) > (to_char(current_timestamp,
		'YYYYMMAA'))
		or (zd00.dtfva = null) then true
		else false
	end as reglementaire_corps_ouvert,
	q.total reglementaire_corps_nb_agents ,
	nbHommes reglementaire_corps_nb_agents_masculins,
	nbFemmes reglementaire_corps_nb_agents_feminins,
	null as reglementaire_corps_emplois_fonctionnels_nb_agents,
	null as reglementaire_corps_emplois_fonctionnels_nb_agents_masculins,
	null as reglementaire_corps_emplois_fonctionnels_nb_agents_feminins,
	null as reglementaire_corps_origine_nb_agents,
	null as reglementaire_corps_origine_nb_agents_masculins,
	null as reglementaire_corps_origine_nb_agents_feminins,
	null as reglementaire_corps_accueil_nb_agents,
	null as reglementaire_corps_accueil_nb_agents_masculins,
	null as reglementaire_corps_accueil_nb_agents_feminins
from
	zd00
inner join (
	select
		zyco.typcon c,
		--nombre global
		sum(case when to_char(current_timestamp, 'YYYYMMDD') between to_char(zyco.datcon, 'YYYYMMDD') and to_char(zyco.datfin, 'YYYYMMDD')then 1 else 0 end) as total,
		sum(case when sexemp = '1' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zyco.datcon, 'YYYYMMDD') and to_char(zyco.datfin, 'YYYYMMDD'))then 1 else 0 end)as nbHommes,
		sum(case when sexemp = '2' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zyco.datcon, 'YYYYMMDD') and to_char(zyco.datfin, 'YYYYMMDD'))then 1 else 0 end)as nbFemmes
	from
		salzyco zyco
	left join salzy10 zy10 on
		zyco.nudoss = zy10.nudoss
	join zd00 on
		zd00.cdcode = zyco.typcon
	join zd01 on
		zd00.nudoss = zd01.nudoss
	group by
		zyco.typcon) q on
	zd00.CDCODE = q.c
left join zd01 on
	zd00.nudoss = zd01.nudoss
where
	ZD00.CDSTCO = 'UIP'
```

#### Précisions 
 - ZD01.LIBLON `reglegmentaire_corps_libelle_long` à modifier en `reglementaire_corps_libelle_long` (cf. [ticket 57](https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/produits/rh/zone-echange/refonte-ze-talend/-/issues/57))

### Output (base_metier)
#### Table `corps`

| Name                                                         | Type           | Expression                                                        | isNullable |
|--------------------------------------------------------------|----------------|-------------------------------------------------------------------|------------|
| reglementaire_code_corps                                     | String         | row1.reglementaire_code_corps                                     | true       |
| reglementaire_corps_libelle_long                             | String         | row1.reglementaire_corps_libelle_long                             | true       |
| reglementaire_corps_libelle_agrege                           | String         | row1.reglementaire_corps_libelle_agrege                           | true       |
| reglementaire_corps_libelle_complementaire                   | String         | row1.reglementaire_corps_libelle_complementaire                   | true       |
| reglementaire_corps_date_debut_validite                      | java.util.Date | row1.reglementaire_corps_date_debut_validite                      | true       |
| reglementaire_corps_date_fin_validite                        | java.util.Date | row1.reglementaire_corps_date_fin_validite                        | true       |
| reglementaire_corps_ouvert                                   | Boolean        | row1.reglementaire_corps_ouvert                                   | true       |
| reglementaire_corps_avec_agents                              | Boolean        | Var.avec_agents                                                   | true       |
| reglementaire_corps_nb_agents                                | Integer        | row1.reglementaire_corps_nb_agents                                | true       |
| reglementaire_corps_nb_agents_masculins                      | Integer        | row1.reglementaire_corps_nb_agents_masculins                      | true       |
| reglementaire_corps_nb_agents_feminins                       | Integer        | row1.reglementaire_corps_nb_agents_feminins                       | true       |
| reglementaire_corps_accueil_nb_agents                        | Integer        | row1.reglementaire_corps_accueil_nb_agents                        | true       |
| reglementaire_corps_accueil_nb_agents_masculins              | Integer        | row1.reglementaire_corps_accueil_nb_agents_masculins              | true       |
| reglementaire_corps_accueil_nb_agents_feminins               | Integer        | row1.reglementaire_corps_accueil_nb_agents_feminins               | true       |
| reglementaire_corps_origine_nb_agents                        | Integer        | row1.reglementaire_corps_origine_nb_agents                        | true       |
| reglementaire_corps_origine_nb_agents_masculins              | Integer        | row1.reglementaire_corps_origine_nb_agents_masculins              | true       |
| reglementaire_corps_origine_nb_agents_feminins               | Integer        | row1.reglementaire_corps_origine_nb_agents_feminins               | true       |
| reglementaire_corps_emplois_fonctionnels_nb_agents           | Integer        | row1.reglementaire_corps_emplois_fonctionnels_nb_agents           | true       |
| reglementaire_corps_emplois_fonctionnels_nb_agents_masculins | Integer        | row1.reglementaire_corps_emplois_fonctionnels_nb_agents_masculins | true       |
| reglementaire_corps_emplois_fonctionnels_nb_agents_feminins  | Integer        | row1.reglementaire_corps_emplois_fonctionnels_nb_agents_feminins  | true       |

#### Variables `Var`

| Name        | Type    | Expression                                           | isNullable |
|-------------|---------|------------------------------------------------------|------------|
| avec_agents | boolean | row1.reglementaire_corps_nb_agents >0 ? true : false | false      |
````

</details>


---

### 📄 `home/Alimentation-de-la-base-métier/Alimentation-des-grades.md` [10.301 octets]
<a id="home-Alimentation-de-la-base-métier-Alimentation-des-grades-md"></a> [↩ Retour à l'arborescence](#tree-home-Alimentation-de-la-base-métier-Alimentation-des-grades-md)

> **Chemin relatif** : `home/Alimentation-de-la-base-métier/Alimentation-des-grades.md`  
> **Taille** : 10.301 octets  
> **Lignes** : 154  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (154 lignes) - Cliquer pour déplier</summary>

````markdown
[[_TOC_]]

# Jobs Talend (dev/2.4.4 )

## ALIMENTATION_GRADE_LAUNCHER
### Input (soclerh) `row1`

```sql
select
	ZD00.CDCODE reglementaire_code_grade,
	ZD01.LIBLON reglementaire_grade_libelle_long,
	zd01.libabr reglementaire_grade_libelle_agrege,
	ZD01.LBCMP1 reglementaire_grade_libelle_complementaire,
	ZD00.DTDVA reglementaire_grade_date_debut_validite,
	ZD00.DTFVA reglementaire_grade_date_fin_validite,
	case
		when (to_char(zd00.dtfva,
		'YYYYMMAA')) > (to_char(current_timestamp,
		'YYYYMMAA'))
		or (zd00.dtfva = null) then true
		else false
	end as reglementaire_grade_ouvert,
	q.total reglementaire_grade_nb_agents ,
	nbHommes reglementaire_grade_nb_agents_masculins,
	nbFemmes reglementaire_grade_nb_agents_feminins,
	totalfonctionnel reglementaire_grade_emplois_fonctionnels_nb_agents,
	nbFonctionnelHommes reglementaire_grade_emplois_fonctionnels_nb_agents_masculins,
	nbFonctionnelFemmes reglementaire_grade_emplois_fonctionnels_nb_agents_feminins,
	totalOrigine reglementaire_grade_origine_nb_agents,
	nbOrigineHommes reglementaire_grade_origine_nb_agents_masculins,
	nbOrigineFemmes reglementaire_grade_origine_nb_agents_feminins,
	totalAccueil reglementaire_grade_accueil_nb_agents,
	nbAccueilHommes reglementaire_grade_accueil_nb_agents_masculins,
	nbAccueilFemmes reglementaire_grade_accueil_nb_agents_feminins
from
	zd00
inner join (
	select
		zygr.adecod c,
		--nombre global
		sum(case when to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD')then 1 else 0 end) as total,
		sum(case when sexemp = '1' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD'))then 1 else 0 end)as nbHommes,
		sum(case when sexemp = '2' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD'))then 1 else 0 end)as nbFemmes,
		--nombre  emploi fonctionnel
		sum(case when zygr.codcar = 'A' and zygr.corps like 'E%' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD')) then 1 else 0 end) as totalfonctionnel,
		sum(case when sexemp = '1' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD') and zygr.codcar = 'A' and zygr.corps like 'E%')then 1 else 0 end)as nbFonctionnelHommes,
		sum(case when sexemp = '2' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD')and zygr.codcar = 'A' and zygr.corps like 'E%')then 1 else 0 end)as nbFonctionnelFemmes,
		--nombre grade origine
		sum(case when zygr.codcar = 'O' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD')) then 1 else 0 end) as totalOrigine,
		sum(case when sexemp = '1' and zygr.codcar = 'O' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD') )then 1 else 0 end)as nbOrigineHommes,
		sum(case when sexemp = '2' and zygr.codcar = 'O' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD'))then 1 else 0 end)as nbOrigineFemmes,
		--nombre grade d'accueil
		sum(case when zygr.codcar = 'A' and zygr.corps like 'G%' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD')) then 1 else 0 end) as totalAccueil,
		sum(case when sexemp = '1' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD') and zygr.codcar = 'A' and zygr.corps like 'G%')then 1 else 0 end)as nbAccueilHommes,
		sum(case when sexemp = '2' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zygr.dateff, 'YYYYMMDD') and to_char(zygr.datfin, 'YYYYMMDD')and zygr.codcar = 'A' and zygr.corps like 'G%')then 1 else 0 end)as nbAccueilFemmes
	from
		salzygr zygr
	left join salzy10 zy10 on
		zygr.nudoss = zy10.nudoss
	group by
		zygr.adecod) q on
	zd00.CDCODE = q.c
left join zd01 on
	zd00.nudoss = zd01.nudoss
where
	ZD00.CDSTCO = 'HJB'

UNION

select
	ZD00.CDCODE reglementaire_code_grade,
	ZD01.LIBLON reglementaire_grade_libelle_long,
	zd01.libabr reglementaire_grade_libelle_agrege,
	ZD01.LBCMP1 reglementaire_grade_libelle_complementaire,
	ZD00.DTDVA reglementaire_grade_date_debut_validite,
	ZD00.DTFVA reglementaire_grade_date_fin_validite,
	case
		when (to_char(zd00.dtfva,
		'YYYYMMAA')) > (to_char(current_timestamp,
		'YYYYMMAA'))
		or (zd00.dtfva = null) then true
		else false
	end as reglementaire_grade_ouvert,
	q.total reglementaire_grade_nb_agents ,
	nbHommes reglementaire_grade_nb_agents_masculins,
	nbFemmes reglementaire_grade_nb_agents_feminins,
	0 as reglementaire_grade_emplois_fonctionnels_nb_agents,
	0 as reglementaire_grade_emplois_fonctionnels_nb_agents_masculins,
	0 as reglementaire_grade_emplois_fonctionnels_nb_agents_feminins,
	0 as reglementaire_grade_origine_nb_agents,
	0 as reglementaire_grade_origine_nb_agents_masculins,
	0 as reglementaire_grade_origine_nb_agents_feminins,
	0 as reglementaire_grade_accueil_nb_agents,
	0 as reglementaire_grade_accueil_nb_agents_masculins,
	0 as reglementaire_grade_accueil_nb_agents_feminins
from
	zd00
left join (
	select
		zyco.typcon c,
		--nombre global
		sum(case when to_char(current_timestamp, 'YYYYMMDD') between to_char(zyco.datcon, 'YYYYMMDD') and to_char(zyco.datfin, 'YYYYMMDD')then 1 else 0 end) as total,
		sum(case when sexemp = '1' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zyco.datcon, 'YYYYMMDD') and to_char(zyco.datfin, 'YYYYMMDD'))then 1 else 0 end)as nbHommes,
		sum(case when sexemp = '2' and (to_char(current_timestamp, 'YYYYMMDD') between to_char(zyco.datcon, 'YYYYMMDD') and to_char(zyco.datfin, 'YYYYMMDD'))then 1 else 0 end)as nbFemmes
	from
		salzyco zyco
	left join salzy10 zy10 on
		zyco.nudoss = zy10.nudoss
	join zd00 on
		zd00.cdcode = zyco.typcon
	join zd01 on
		zd00.nudoss = zd01.nudoss
	group by
		zyco.typcon) q on
	zd00.CDCODE = q.c
left join zd01 on
	zd00.nudoss = zd01.nudoss
where
	ZD00.CDSTCO = 'DJO'
```

### Output (base_metier)
#### Table `grade`

| Name                                                         | Type           | Expression                                                        | isNullable |
|--------------------------------------------------------------|----------------|-------------------------------------------------------------------|------------|
| reglementaire_code_grade                                     | String         | row1.reglementaire_code_grade                                     | true       |
| reglementaire_grade_libelle_long                             | String         | row1.reglementaire_grade_libelle_long                             | true       |
| reglementaire_grade_libelle_agrege                           | String         | row1.reglementaire_grade_libelle_agrege                           | true       |
| reglementaire_grade_libelle_complementaire                   | String         | row1.reglementaire_grade_libelle_complementaire                   | true       |
| reglementaire_grade_date_debut_validite                      | java.util.Date | row1.reglementaire_grade_date_debut_validite                      | true       |
| reglementaire_grade_date_fin_validite                        | java.util.Date | row1.reglementaire_grade_date_fin_validite                        | true       |
| reglementaire_grade_ouvert                                   | Boolean        | row1.reglementaire_grade_ouvert                                   | true       |
| reglementaire_grade_avec_agents                              | Boolean        | Var.reglementaire_grade_avec_agents                               | true       |
| reglementaire_grade_nb_agents                                | Integer        | row1.reglementaire_grade_nb_agents                                | true       |
| reglementaire_grade_nb_agents_masculins                      | Integer        | row1.reglementaire_grade_nb_agents_masculins                      | true       |
| reglementaire_grade_nb_agents_feminins                       | Integer        | row1.reglementaire_grade_nb_agents_feminins                       | true       |
| reglementaire_grade_accueil_nb_agents                        | Integer        | row1.reglementaire_grade_accueils_nb_agents                       | true       |
| reglementaire_grade_accueil_nb_agents_masculins              | Integer        | row1.reglementaire_grade_accueils_nb_agents_masculins             | true       |
| reglementaire_grade_accueil_nb_agents_feminins               | Integer        | row1.reglementaire_grade_accueils_nb_agents_feminins              | true       |
| reglementaire_grade_origine_nb_agents                        | Integer        | row1.reglementaire_grade_origine_nb_agents                        | true       |
| reglementaire_grade_origine_nb_agents_masculins              | Integer        | row1.reglementaire_grade_origine_nb_agents_masculins              | true       |
| reglementaire_grade_origine_nb_agents_feminins               | Integer        | row1.reglementaire_grade_origine_nb_agents_feminins               | true       |
| reglementaire_grade_emplois_fonctionnels_nb_agents           | Integer        | row1.reglementaire_grade_emplois_fonctionnels_nb_agents           | true       |
| reglementaire_grade_emplois_fonctionnels_nb_agents_masculins | Integer        | row1.reglementaire_grade_emplois_fonctionnels_nb_agents_masculins | true       |
| reglementaire_grade_emplois_fonctionnels_nb_agents_feminins  | Integer        | row1.reglementaire_grade_emplois_fonctionnels_nb_agents_feminins  | true       |

#### Variables `Var`

| Name                            | Type    | Expression                                                                         | isNullable |
|---------------------------------|---------|------------------------------------------------------------------------------------|------------|
| reglementaire_grade_avec_agents | boolean | row1.reglementaire_grade_nb_agents !=null && row1.reglementaire_grade_nb_agents >0 | false      |


````

</details>


---

### 📄 `home/Alimentation-de-la-base-métier/Alimentation-des-habilitations.md` [7.048 octets]
<a id="home-Alimentation-de-la-base-métier-Alimentation-des-habilitations-md"></a> [↩ Retour à l'arborescence](#tree-home-Alimentation-de-la-base-métier-Alimentation-des-habilitations-md)

> **Chemin relatif** : `home/Alimentation-de-la-base-métier/Alimentation-des-habilitations.md`  
> **Taille** : 7.048 octets  
> **Lignes** : 222  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (222 lignes) - Cliquer pour déplier</summary>

````markdown
[[_TOC_]]

# Jobs Talend (dev/2.4.4 )

## ALIMENTATION_HABILITATION_LAUNCHER

### ALIMENTATION_HABILITATION

#### Input (soclerh) `row1`

```sql
select
	zy4i.adusml adresse_mail,
	zy00.nomuse nom_utilisateur,
	zy00.prenom prenom_utilisateur,
	zy00.matcle matricule_renoirh,
	qaadmin.agent_affectation_administrative,
	qaadmin.agent_affectation_administrative_libelle_long,
	qaadmin.agent_affectation_administrative_libelle_court,
	qaoper.agent_affectation_operationnelle,
	qaoper.agent_affectation_operationnelle_libelle_long,
	qaoper.agent_affectation_operationnelle_libelle_court
from
	salzy00 zy00
left join salzy4i zy4i on
	zy00.nudoss = zy4i.nudoss
	--affectation administrative
left join(
	select
		zy00.nudoss,
		zy00.matcle matricule_renoirh,
		sub_zy3c.idou00 agent_affectation_administrative,
		ze01.lboulg agent_affectation_administrative_libelle_long,
		ze01.lboush agent_affectation_administrative_libelle_court
	from
		salzy00 zy00
	left join (
		select
			nudoss,
			dtef00,
			dten00,
			idou00
		from
			salzy3c zy3c
		where
			zy3c.dtef00<current_date
			and zy3c.dten00>current_date
			and tytrst = 'ADM')
as sub_zy3c on
		sub_zy3c.nudoss = zy00.nudoss
	left join ze00 ze00 on
		sub_zy3c.idou00 = ze00.idou00
	left join ze01 ze01 on
		ze00.nudoss = ze01.nudoss) as qaadmin on
	qaadmin.matricule_renoirh = zy00.matcle
left join (
	select
		zy00.matcle matricule_renoirh,
		sub_zy3b.idou00 agent_affectation_operationnelle,
		ze01.lboulg agent_affectation_operationnelle_libelle_long,
		ze01.lboush agent_affectation_operationnelle_libelle_court
	from
		salzy00 zy00
	left join salzy4i zy4i on
		zy00.nudoss = zy4i.nudoss
	left join (
		select
			distinct nudoss,
			dtef00,
			dten00,
			idou00
		from
			salzy3b zy3b
		group by
			nudoss,
			dtef00,
			dten00,
			idou00
		having
			max(zy3b.dtef00)<current_date
				and max(zy3b.dten00)>current_date)as sub_zy3b on
		sub_zy3b.nudoss = zy4i.nudoss
	left join ze00 ze00 on
		sub_zy3b.idou00 = ze00.idou00
	left join ze01 ze01 on
		ze00.nudoss = ze01.nudoss)as qaoper on
	qaoper.matricule_renoirh = zy00.matcle
```
#### Output (base_metier)
##### Table `habilitation`

| Name                                           | Type   | Expression                                          | isNullable |
|------------------------------------------------|--------|-----------------------------------------------------|------------|
| adresse_mail                                   | String | row1.adresse_mail                                   | true       |
| nom_utilisateur                                | String | row1.nom_utilisateur                                | true       |
| prenom_utilisateur                             | String | row1.prenom_utilisateur                             | true       |
| matricule_renoirh                              | String | row1.matricule_renoirh                              | true       |
| agent_affectation_administrative               | String | row1.agent_affectation_administrative               | true       |
| agent_affectation_administrative_libelle_long  | String | row1.agent_affectation_administrative_libelle_long  | true       |
| agent_affectation_administrative_libelle_court | String | row1.agent_affectation_administrative_libelle_court | true       |
| agent_affectation_operationnelle               | String | row1.agent_affectation_operationnelle               | true       |
| agent_affectation_operationnelle_libelle_long  | String | row1.agent_affectation_operationnelle_libelle_long  | true       |
| agent_affectation_operationnelle_libelle_court | String | row1.agent_affectation_operationnelle_libelle_court | true       |


### ALIMENTATION_PROFIL
#### Input (soclerh) `row1`

```sql
select
	zy00.matcle matricule_renoirh,
	zyxu.rolmod modele_de_role,
	modeles_de_role_renoirh.modele_de_role_libelle intitule_modele_role,
	modeles_de_role_renoirh.axe_role hab_axe,
	case
		modeles_de_role_renoirh.axe_role
when 'hab_axe_us_oper' then string_agg(zyxu.rolval,
		',' )
	end as hab_axe_us_oper,
	case
		modeles_de_role_renoirh.axe_role
when 'hab_axe_pese' then string_agg(zyxu.rolval,
		',' )
	end as hab_axe_pese,
	case
		modeles_de_role_renoirh.axe_role
when 'hab_axe_us_adm' then string_agg(zyxu.rolval,
		',' )
	end as hab_axe_us_adm,
	case
		modeles_de_role_renoirh.axe_role
when 'hab_axe_part' then string_agg(zyxu.rolval,
		',' )
	end as hab_axe_part ,
	case
		modeles_de_role_renoirh.axe_role
when 'hab_axe_corp' then string_agg(zyxu.rolval,
		',' )
	end as hab_axe_corp ,
	case
		modeles_de_role_renoirh.axe_role
when 'hab_axe_grp_uo_poste' then string_agg(zyxu.rolval,
		',' )
	end as hab_axe_grp_uo_poste,
	case
		when modeles_de_role_renoirh.axe_role = 'hab_axe_ldg'
		and decode_valeur_de_role <> 'copie' then string_agg(
(
		select
			string_agg(ldg.code_lot,
			',')
		from
			regroupement_ldg ldg
		where
			ldg.code_regroupement_ldg = zyxu.rolval),
		',')
		else case
			when modeles_de_role_renoirh.axe_role = 'hab_axe_ldg'
			and decode_valeur_de_role = 'copie' then string_agg(zyxu.rolval,
			',' )
		end
	end as hab_axe_ldg,

case
	when modeles_de_role_renoirh.axe_role = 'hab_axe_corresp'
	and decode_valeur_de_role <> 'copie' then string_agg(
(
	select
		string_agg(cco.code_services_gestionnaires,
		',')
	from
		regroupement_code_corresp cco
	where
		zyxu.rolval = cco.code_regroupement),
	',' )
	else case
		when modeles_de_role_renoirh.axe_role = 'hab_axe_corresp'
		and decode_valeur_de_role = 'copie' then string_agg(zyxu.rolval,
		',' )
	end
end as hab_axe_corresp
from
salzy00 zy00
left join (
select
	*
from
	salzyxu
where
	salzyxu.dten00 >= current_date ) as zyxu on
zy00.nudoss = zyxu.nudoss
join modeles_de_role_renoirh on
modeles_de_role_renoirh.modele_de_role = zyxu.rolmod
group by
zy00.matcle,
zy00.nudoss,
zyxu.rolmod,
modeles_de_role_renoirh.axe_de_valeur_de_role,
modeles_de_role_renoirh.modele_de_role_libelle,
modeles_de_role_renoirh.axe_role,
decode_valeur_de_role
```

#### Output (base_metier)
##### Table `profil`

| Name                 | Type   | Expression                | isNullable |
|----------------------|--------|---------------------------|------------|
| matricule_renoirh    | String | row1.matricule_renoirh    | true       |
| modele_de_role       | String | row1.modele_de_role       | true       |
| intitule_modele_role | String | row1.intitule_modele_role | true       |
| hab_axe              | String | row1.hab_axe              | true       |
| hab_axe_us_oper      | String | row1.hab_axe_us_oper      | true       |
| hab_axe_pese         | String | row1.hab_axe_pese         | true       |
| hab_axe_us_adm       | String | row1.hab_axe_us_adm       | true       |
| hab_axe_part         | String | row1.hab_axe_part         | true       |
| hab_axe_corp         | String | row1.hab_axe_corp         | true       |
| hab_axe_grp_uo_poste | String | row1.hab_axe_grp_uo_poste | true       |
| hab_axe_ldg          | String | row1.hab_axe_ldg          | true       |
| hab_axe_corresp      | String | row1.hab_axe_corresp      | true       |


````

</details>


---

### 📄 `home/Alimentation-de-la-base-métier/Alimentation-des-postes.md` [1.812 octets]
<a id="home-Alimentation-de-la-base-métier-Alimentation-des-postes-md"></a> [↩ Retour à l'arborescence](#tree-home-Alimentation-de-la-base-métier-Alimentation-des-postes-md)

> **Chemin relatif** : `home/Alimentation-de-la-base-métier/Alimentation-des-postes.md`  
> **Taille** : 1.812 octets  
> **Lignes** : 63  
> **Type** : markdown

````markdown
[[_TOC_]]

# Jobs Talend (dev/2.4.4 )

## ALIMENTATION_POSTE
### Input (soclerh) `row1`

```sql
select
	zy3b.idps00 code_poste,
	qposte.lbpslg intitule_poste,
	zy00.matcle matricule_renoirh,
	qposte.dtef00 date_debut_rattachement_uo,
	qposte.datxxx date_fin_validite_uo,
	qposte.idou00 code_uo_rattachement,
	qgrp.extc20 groupe_uo_poste
from
	salzy00 zy00
join salzy3b zy3b on
	zy00.nudoss = zy3b.nudoss
	and zy3b.dtef00 <= current_date
	and 
 zy3b.dten00>current_date
join(
	select
		za00.idps00,
		za01.lbpslg,
		za2b.idou00,
		za2b.datxxx,
		za2b.dtef00
	from
		za00
	join za01 on
		za01.nudoss = za00.nudoss
	join za2b on
		za2b.nudoss = za00.nudoss
		and za2b.dtef00 <= current_date
		and za2b.datxxx>CURRENT_DATE ) as qposte on
	qposte.idps00 = zy3b.idps00
left join (
	select
		ze9u.extc20,
		ze00.idou00
	from
		ze9u
	join ze00 on
		ze00.nudoss = ze9u.nudoss)as qgrp on
	qgrp.idou00 = qposte.idou00
```

### Output (base_metier)
#### Table `poste`

| Name                       | Type           | Expression                      | isNullable |
|----------------------------|----------------|---------------------------------|------------|
| code_poste                 | String         | row1.code_poste                 | true       |
| intitule_poste             | String         | row1.intitule_poste             | true       |
| matricule_renoirh          | String         | row1.matricule_renoirh          | true       |
| date_debut_rattachement_uo | java.util.Date | row1.date_debut_rattachement_uo | true       |
| date_fin_validite_uo       | java.util.Date | row1.date_fin_validite_uo       | true       |
| code_uo_rattachement       | String         | row1.code_uo_rattachement       | true       |
| groupe_uo_poste            | String         | row1.groupe_uo_poste            | true       |

````


---

### 📄 `home/Alimentation-de-la-base-métier/Alimentation-des-quotités.md` [3.432 octets]
<a id="home-Alimentation-de-la-base-métier-Alimentation-des-quotités-md"></a> [↩ Retour à l'arborescence](#tree-home-Alimentation-de-la-base-métier-Alimentation-des-quotités-md)

> **Chemin relatif** : `home/Alimentation-de-la-base-métier/Alimentation-des-quotités.md`  
> **Taille** : 3.432 octets  
> **Lignes** : 54  
> **Type** : markdown

````markdown
[[_TOC_]]

# Jobs Talend (dev/2.4.4 )

## ALIMENTATION_QUOTITE_LAUNCHER
### Input (soclerh) `row1`

```sql
select
	y00.MATCLE,
	y00.nomuse,
	y00.prenom,
	ytl.tyjbsr,
	ytl.codtra,
	ytl.codinc,
	ytl.rtsthr,
	ytl.numera,
	ytl.denomi,
	ytl.dateff,
	ytl.datxxx,
	ytl.surcot,
	ytl.valide
from
	salzy00 y00
left join salzytl ytl on
	ytl.nudoss = y00.nudoss
```

### Output (base_metier)
#### Table `quotite`

| Name                                   | Type           | Expression                         | isNullable |
|----------------------------------------|----------------|------------------------------------|------------|
| search                                 | String         | Var.Search                         | true       |
| quotite_matricule                      | String         | StringHandling.TRIM(row1.matcle)   | true       |
| quotite_travail                        | String         | StringHandling.TRIM (row1.tyjbsr)  | true       |
| quotite_modalite_service               | String         | StringHandling.TRIM(row1.codtra)   | true       |
| quotite_service                        | String         | StringHandling.TRIM (row1.codinc ) | true       |
| quotite_pourc_heure_presence_tmp_plein | BigDecimal     | row1.rtsthr                        | true       |
| quotite_numerateur_remuneration        | BigDecimal     | row1.numera                        | true       |
| quotite_denominateur_remuneration      | BigDecimal     | row1.denomi                        | true       |
| quotite_effet_travail                  | java.util.Date | row1.dateff                        | true       |
| quotite_fin_travail                    | java.util.Date | row1.datxxx                        | true       |
| quotite_temoin_surcotisation           | String         | Var.temoin_surcotisation           | true       |
| quotite_temoin_validite                | String         | row1.valide                        | true       |
| quotite_nom                            | String         | row1.nomuse                        | true       |
| quotite_prenom                         | String         | row1.prenom                        | true       |

#### Variables `Var`

| Name                 | Type   | Expression                                                                                                                                                                                                                                                             | isNullable |
|----------------------|--------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
| temoin_surcotisation | String | row1.surcot == null ? "?" : (row1.surcot.equals("0") ? "Non" : (row1.surcot.equals("1") ? "Oui" : "?"))                                                                                                                                                                | false      |
| Search               | String | TalendString.removeAccents(StringHandling.DOWNCASE( StringHandling.TRIM(row1.matcle) + StringHandling.TRIM(row1.nomuse) + StringHandling.TRIM(row1.prenom) + StringHandling.TRIM(row1.tyjbsr) + StringHandling.TRIM(row1.codtra) + StringHandling.TRIM(row1.codinc) )) | false      |
````


---

### 📄 `home/Alimentation-de-la-base-métier/Alimentation-des-rémunérations.md` [6.115 octets]
<a id="home-Alimentation-de-la-base-métier-Alimentation-des-rémunérations-md"></a> [↩ Retour à l'arborescence](#tree-home-Alimentation-de-la-base-métier-Alimentation-des-rémunérations-md)

> **Chemin relatif** : `home/Alimentation-de-la-base-métier/Alimentation-des-rémunérations.md`  
> **Taille** : 6.115 octets  
> **Lignes** : 91  
> **Type** : markdown

````markdown
[[_TOC_]]  

# Jobs Talend (dev/2.4.4 )

## ALIMENTATION_REMUNERATION_LAUNCHER 
### Input (soclerh) `row1`

```sql
select
	y00.MATCLE,
	null as DTBGSA,
	null as DTENSA,
	null as DTEXSA,
	yf9.CODETG,
	yf9.NUMPCH,
	yf9.DPPRIN,
	yf9.DATDEB,
	yf9.DTENDP,
	q00.NUDOSS,
	q00.SOCCLE,
	q00.MATCLE,
	q1a.DATEFF,
	q1a.DATXXX,
	q1a.CODETG,
	q1a.NUMPCH,
	q1a.ADMINI,
	q1a.CORRES,
	q1a.DEPSER,
	q60.REGREM,
	q60.TGSPEC,
	q60.NUMDOS,
	q60.DATEFF,
	q60.DATXXX,
	q60.PERPAA,
	q60.PERPMM,
	q60.PRELIQ,
	q60.TEMANU,
	q60.PQDATE
from
	SALZY00 y00
left join SALZYF9 yf9 on
	y00.NUDOSS = yf9.NUDOSS
left join ZQ00 q00 on
	y00.matcle = q00.matcle
left join ZQ1A q1a on
	q00.NUDOSS = q1a.NUDOSS
left join ZQ60 q60 on
	q00.NUDOSS = q60.NUDOSS
```

### Output (base_metier)
#### Table `remuneration`

| Name                                          | Type           | Expression   | isNullable |
|-----------------------------------------------|----------------|--------------|------------|
| remuneration_matricule_agent_renoirh          | String         | row1.matcle  | true       |
| remuneration_date_debut_saisie_mois_paye      | java.util.Date | row1.dtbgsa  | true       |
| remuneration_date_fin_saisie_mois_paye        | java.util.Date | row1.dtensa  | true       |
| remuneration_date_extreme_mise_en_paye_dgfip  | java.util.Date | row1.dtexsa  | true       |
| remuneration_code_tresorerie_generale         | String         | row1.codetg  | true       |
| remuneration_numero_de_dossier                | String         | row1.numpch  | true       |
| remuneration_dossier_de_paie_principal        | String         | row1.dpprin  | true       |
| remuneration_date_debut_affectation_tg        | java.util.Date | row1.datdeb  | true       |
| remuneration_date_fin_dossier_principal       | java.util.Date | row1.dtendp  | true       |
| remuneration_identifiant_interne              | BigDecimal     | row1.nudoss  | false      |
| remuneration_nom_reglementation               | String         | row1.soccle  | true       |
| remuneration_matricule                        | String         | row1.matcle1 | true       |
| remuneration_date_effet_prise_en_charge       | java.util.Date | row1.dateff  | true       |
| remuneration_date_fin_zone_commune            | java.util.Date | row1.datxxx  | true       |
| remuneration_code_tg                          | String         | row1.codetg1 | true       |
| remuneration_numero_dossier                   | String         | row1.numpch1 | true       |
| remuneration_code_administration              | String         | row1.admini  | true       |
| remuneration_code_correspondant               | String         | row1.corres  | true       |
| remuneration_departement_service_gestionnaire | String         | row1.depser  | true       |
| remuneration_code_regime                      | String         | row1.regrem  | true       |
| remuneration_code_tg_specifique               | String         | row1.tgspec  | true       |
| remuneration_dossier_specifique               | String         | row1.numdos  | true       |
| remuneration_date_effet_regime                | java.util.Date | row1.dateff1 | true       |
| remuneration_date_fin_regime                  | java.util.Date | row1.datxxx1 | true       |
| remuneration_annee_mise_en_paye               | String         | row1.perpaa  | true       |
| remuneration_mois_mise_en_paye                | String         | row1.perpmm  | true       |
| remuneration_temoin_validation_paye           | String         | row1.preliq  | true       |
| remuneration_temoin_annulation_paye           | String         | row1.temanu  | true       |
| remuneration_date_effet_pecuniere             | java.util.Date | row1.pqdate  | true       |
| search                                        | String         | Var.search   | true       |

#### Variables `Var`

| Name   | Type   | Expression                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | isNullable |
|--------|--------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
| search | String | TalendString.removeAccents(StringHandling.DOWNCASE( StringHandling.TRIM(row1.matcle) + StringHandling.TRIM(row1.codetg) + StringHandling.TRIM(row1.numpch) + StringHandling.TRIM(row1.dpprin) + StringHandling.TO_CHAR(row1.nudoss) + StringHandling.TRIM(row1.soccle) + StringHandling.TRIM(row1.matcle1) + StringHandling.TRIM(row1.codetg1) + StringHandling.TRIM(row1.numpch1) + StringHandling.TRIM(row1.admini) + StringHandling.TRIM(row1.corres) + StringHandling.TRIM(row1.depser) + StringHandling.TRIM(row1.regrem) + StringHandling.TRIM(row1.tgspec) + StringHandling.TRIM(row1.numdos) + StringHandling.TRIM(row1.perpaa) + StringHandling.TRIM(row1.perpmm) + StringHandling.TRIM(row1.preliq) + StringHandling.TRIM(row1.temanu) )) | false      |
````


---

### 📄 `home/Alimentation-de-la-base-métier/Alimentation-des-unités-structurelles.md` [22.067 octets]
<a id="home-Alimentation-de-la-base-métier-Alimentation-des-unités-structurelles-md"></a> [↩ Retour à l'arborescence](#tree-home-Alimentation-de-la-base-métier-Alimentation-des-unités-structurelles-md)

> **Chemin relatif** : `home/Alimentation-de-la-base-métier/Alimentation-des-unités-structurelles.md`  
> **Taille** : 22.067 octets  
> **Lignes** : 227  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (227 lignes) - Cliquer pour déplier</summary>

````markdown
[[_TOC_]]

# Jobs Talend (dev/2.4.4 )
## ALIMENTATION_UNITE_STRUCTURELLE_LAUNCHER

## ALIMENTATION_UNITE_STRUCTURELLE
### Input (soclerh) `row1`

```sql
select
	ZE00.IDOU00 us_identifiant,
	ZE01.LBOULG us_libelle_long,
	ZE01.LBOUSH us_libelle_court,
	ZE00.DTEF00 us_date_creation,
	ZE0A.DTEF00 us_date_fermeture,
	ZE0A.STOU01 ,
	ZEF7.NAUS00,
	ZE00.TYOU00 us_type,
	zd01.liblon us_type_libelle,
	ZEFL.IDMNST,
	ZE0F.ZONADA,
	ZE0F.ZONADB,
	ZE0F.ZONADC,
	ZE0F.ZONADD,
	ZE0F.CDPOST,
	ZE0F.CDPAYS,
	zd4f.tyou00 us_niveau ,
	ZE2E.IDOU00,
	ZE2E.TYTRST,
	ZE2E.DTEF00,
	ZE2E.DATXXX,
	ZEOR.TYTRST,
	ZEOR.IDOU00,
	ZEOR.LBOUSH,
	ZEOR.IDOS00,
	ZEOR.LBOSSH,
	ZEOR.DTEF00,
	ZEOR.DTEN00,
	ZEOR.MANNAM,
	ZEOR.LEVEL1,
	ZEOR.LEVEL2,
	ZEOR.LEVEL3,
	ZEOR.LEVEL6,
	ZE00.NUDOSS
from
	ZE00
left join ZE01 on
	ZE01.nudoss = ZE00.nudoss
left join (
	select
		nudoss,
		max(DTEF00) as d
	from
		ZE0A
	group by
		nudoss) q1 on
	q1.nudoss = ZE00.nudoss
left join ZE0A on
	ZE0A.nudoss = ZE00.nudoss
	and q1.d = ZE0A.DTEF00
left join (
	select
		nudoss,
		max(DTBG00) as d
	from
		ZE0F
	group by
		nudoss) q2 on
	q2.nudoss = ZE00.nudoss
left join ZE0F on
	ZE0F.nudoss = ZE00.nudoss
	and q2.d = ZE0F.DTBG00
left join (
	select
		nudoss,
		max(DTEF00) as d
	from
		ZEOR
	group by
		nudoss) q on
	q.nudoss = ZE00.nudoss
left join ZEOR on
	ZEOR.nudoss = ZE00.nudoss
	and q.d = ZEOR.DTEF00
left join ZEF7 on
	ZEF7.nudoss = ZE00.nudoss
left join (
	select
		nudoss,
		max(DTBG00) as d
	from
		ZEFL
	group by
		nudoss) q3 on
	q3.nudoss = ZE00.nudoss
left join ZEFL on
	ZEFL.nudoss = ZE00.nudoss
	and q3.d = ZEFL.DTBG00
left join (
	select
		nudoss,
		max(DTEF00) as d
	from
		ZE2E
	group by
		nudoss) q4 on
	q4.nudoss = ZE00.nudoss
left join ZE2E on
	ZE2E.nudoss = ZE00.nudoss
	and q4.d = ZE2E.DTEF00
left join zd00 on
	zd00.cdcode = ze00.tyou00
	and zd00.cdstco = 'U3G'
left join zd01 on
	zd00.nudoss = zd01.nudoss
left join zd4F on
	zd00.nudoss = zd4F.nudoss
```

#### Précisions 
 - ZE2E.IDOU00 : idou000
 - ZEOR.IDOU00 : idou002
 - ZEOR.TYTRST : tytrst1
 - ZEOR.LBOUSH : lboush1
 - ZEOR.DTEF00 : dtef003

### Output (base_metier)
#### Table `unite_structurelle`

| **Name**                     | **Type**       | **Expression**                              | **isNullable** |
| ---------------------------- | -------------- | ------------------------------------------- | -------------- |
| us_identifiant               | String         | StringHandling.TRIM(row1.us_identifiant )   | true           |
| us_libelle_long              | String         | StringHandling.TRIM(row1.us_libelle_long )  | true           |
| us_libelle_court             | String         | StringHandling.TRIM(row1.us_libelle_court ) | true           |
| us_date_creation             | java.util.Date | row1.us_date_creation                       | true           |
| us_date_fermeture            | java.util.Date | row1.us_date_fermeture                      | true           |
| us_nature                    | String         | StringHandling.TRIM(row1.naus00 )           | true           |
| us_type                      | String         | StringHandling.TRIM(row1.us_type )          | true           |
| us_type_libelle              | String         | row1.us_type_libelle                        | true           |
| us_code_ministere            | String         | StringHandling.TRIM(row1.idmnst )           | true           |
| us_numero_voie               | String         | Var.numVoi                                  | true           |
| us_voie_bis_ter              | String         | Var.bistfr                                  | true           |
| us_libelle_voie              | String         | Var.libVoi                                  | true           |
| us_complement_agent          | String         | Var.adres1                                  | true           |
| us_code_postal               | String         | StringHandling.TRIM(row1.cdpost )           | true           |
| us_code_insee                | String         | StringHandling.TRIM(Var.insefr)             | true           |
| us_commune                   | String         | StringHandling.TRIM(Var.commfrVar )         | true           |
| us_departement               | String         | StringHandling.TRIM(Var.codpfr )            | true           |
| us_pays                      | String         | StringHandling.TRIM(row1.cdpays )           | true           |
| us_bureau_distributeur       | String         | StringHandling.TRIM(Var.burdfr )            | true           |
| us_niveau                    | String         | StringHandling.TRIM(row1.us_niveau )        | true           |
| us_mere                      | String         | StringHandling.TRIM(row1.idou000 )          | true           |
| us_type_arborescence         | String         | StringHandling.TRIM(row1.tytrst )           | true           |
| us_date_debut_rattachement   | java.util.Date | row1.dtef00                                 | true           |
| us_date_fin_rattachement     | java.util.Date | row1.datxxx                                 | true           |
| us_type_organisation         | String         | StringHandling.TRIM(row1.tytrst1 )          | true           |
| us_unite_organisationnelle   | String         | StringHandling.TRIM(row1.idou002 )          | true           |
| us_libelle_court_uo          | String         | StringHandling.TRIM(row1.lboush1 )          | true           |
| us_structure_uo              | String         | StringHandling.TRIM(row1.idos00 )           | true           |
| us_date_effet                | java.util.Date | row1.dtef003                                | true           |
| us_date_fin                  | java.util.Date | row1.dten00                                 | true           |
| us_nom_responsable_uo        | String         | StringHandling.TRIM(row1.mannam )           | true           |
| us_niveau_direction          | String         | StringHandling.TRIM(row1.level1)            | true           |
| us_niveau_service            | String         | StringHandling.TRIM(row1.level3)            | true           |
| us_niveau_unite_structurelle | String         | StringHandling.TRIM(row1.level6)            | true           |
| nudoss                       | BigDecimal     | row1.nudoss                                 | true           |
| us_actif                     | Boolean        | Var.Actif                                   | true           |
| search                       | String         | Var.Search                                  | true           |

#### Variables `Var`
| **Name**  | **Type** | **Expression**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | **isNullable** |
| --------- | -------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------- |
| numVoi    | String   | row1.zonadb == null ? null : ( row1.zonadb.isEmpty() ? "" : row1.zonadb.substring(0,Math.min( 4,row1.zonadb.length())) )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | false          |
| burdfr    | String   | row1.zonadd == null ? null : ( row1.zonadd.length()<=6 ? "ERR" : row1.zonadd.substring(6,Math.min( 40,row1.zonadd.length())) )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | false          |
| codpfr    | String   | row1.cdpost == null ? null : ( row1.cdpost.isEmpty() ? "" : row1.cdpost.substring(0,Math.min( 2,row1.cdpost.length())) )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | false          |
| commfrVar | String   | row1.zonadc == null ? null : ( row1.zonadc.length()<=6 ? "ERR" : StringHandling.TRIM(row1.zonadc.substring(6,Math.min( 45,row1.zonadc.length()))) )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | false          |
| insefr    | String   | row1.zonadc == null ? null : ( row1.zonadc.isEmpty() ? "" : StringHandling.TRIM(row1.zonadc.substring(0,Math.min( 4,row1.zonadc.length()))) )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | false          |
| libVoi    | String   | row1.zonadb == null ? null : ( row1.zonadb.length()<=6 ? "" : row1.zonadb.substring(6,Math.min(40,row1.zonadb.length())) )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | false          |
| extNum    | String   | row1.zonadb == null ? null : ( row1.zonadb.length()<=4 ? "" : row1.zonadb.substring(4,Math.min(5,row1.zonadb.length())) )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | false          |
| bistfr    | String   | row1.zonadb == null ? null : ( row1.zonadb.isEmpty() ? "" : (row1.zonadb.substring(0,Math.min(6,row1.zonadb.length())).toLowerCase().contains("bis") ? "BIS" : (row1.zonadb.substring(0,Math.min(6,row1.zonadb.length())).toLowerCase().contains("ter") ? "TER" : "")) )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | false          |
| adres1    | String   | row1.zonada == null ? null : ( row1.zonada.isEmpty() ? "" : row1.zonada.substring(0,Math.min(32,row1.zonada.length())) )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | false          |
| Search    | String   | TalendString.removeAccents(StringHandling.DOWNCASE( StringHandling.TRIM(row1.us_identifiant) + StringHandling.TRIM(row1.us_identifiant) + StringHandling.TRIM(row1.us_libelle_long) + StringHandling.TRIM(row1.us_libelle_court) + StringHandling.TRIM(row1.stou01) + StringHandling.TRIM(row1.naus00) + StringHandling.TRIM(row1.us_type) + StringHandling.TRIM(row1.idmnst) + StringHandling.TRIM(row1.zonada) + StringHandling.TRIM(row1.zonadb) + StringHandling.TRIM(row1.zonadc) + StringHandling.TRIM(row1.zonadd) + StringHandling.TRIM(row1.cdpost) + StringHandling.TRIM(row1.cdpays) + StringHandling.TRIM(row1.us_niveau) + StringHandling.TRIM(row1.idou000) + StringHandling.TRIM(row1.tytrst) + StringHandling.TRIM(row1.tytrst1) + StringHandling.TRIM(row1.idou002) + StringHandling.TRIM(row1.lboush1) + StringHandling.TRIM(row1.idos00) + StringHandling.TRIM(row1.lbossh) + StringHandling.TRIM(row1.mannam) + StringHandling.TRIM(row1.level1) + StringHandling.TRIM(row1.level2) + StringHandling.TRIM(row1.level3) + StringHandling.TRIM(row1.level6) )) | false          |
| Actif     | boolean  | row1.stou01 == null ? null : ( StringHandling.TRIM(row1.stou01).compareTo("ACT")== 0 ? true : false )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | false          |


## ALIMENTATION_UNITE_STRUCTURELLE_LIEN
### Inputs 

Dans ce cas particulier, on utilise les deux sources de données :
 - `base_metier` comme flux principal `row1`
 - `soclerh` comme flux de référence (lookup) `row2`

Une jointure `Left Outer Join` est utilisée.  
Les données de la table `soclerh`.`ZE2E` sont d'abord chargées en mémoire.

Ce mécanisme est décrit dans la documentation Talend [ici](https://help.talend.com/r/fr-FR/7.3/tmap/tmap-lookup-models)

![image](uploads/46cbbbb67e1d5c884d29f1458a47e263/image.png)  

Il est important à noter que le modèle de rapprochement (`Match Model`) utilisé est `Unique match` : option par défaut pour l'opération JOIN. Cette option sort **le dernier enregistrement** de rapprochement depuis la source Lookup. (source : https://help.talend.com/r/fr-FR/7.3/tmap/example-job-implementing-different-match-models)



#### base_metier `row1`
```sql
select

	NUDOSS,
	us_identifiant
from
	UNITE_STRUCTURELLE
```
#### soclerh `row2`
```sql
select
	NUDOSS,
	IDOU00
from
	ZE2E
```
### Output (base_metier)
##### Table `unite_structurelle_lien`

| **Name** | **Type** | **Expression**                    | **isNullable** |
| -------- | -------- | --------------------------------- | -------------- |
| UST_ID   | String   | row1.us_identifiant            | true           |
| UST_MERE | String   | StringHandling.BTRIM(row2.IDOU00) | true           |
````

</details>


---

### 📄 `home/Alimentation-de-la-base-métier/Alimentation-effectif-post-agent.md` [2.842 octets]
<a id="home-Alimentation-de-la-base-métier-Alimentation-effectif-post-agent-md"></a> [↩ Retour à l'arborescence](#tree-home-Alimentation-de-la-base-métier-Alimentation-effectif-post-agent-md)

> **Chemin relatif** : `home/Alimentation-de-la-base-métier/Alimentation-effectif-post-agent.md`  
> **Taille** : 2.842 octets  
> **Lignes** : 131  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (131 lignes) - Cliquer pour déplier</summary>

````markdown
[[_TOC_]]  

# Jobs Talend (dev/2.4.4 )

## ALIMENTATION_EFFECTIF_POST_AGENT

### Input (base_metier) `row1`

```sql
with recursive recursion(us_identifiant,
nbAgenth,
nbAgentf) as (
    with query as (
select
	us_identifiant,
	count(agent_matricule_renoirh) as nbAgentf
from
	unite_structurelle
left join agent on
	us_identifiant = agent_unite_structurelle_affectation
	and agent_sexe = 'F'
group by
	us_identifiant),
    query3 as (
select
	us_identifiant,
	count(agent_matricule_renoirh) as nbAgenth
from
	unite_structurelle
left join agent on
	us_identifiant = agent_unite_structurelle_affectation
	and agent_sexe = 'H'
group by
	us_identifiant),
    query2 as (with recursive recursion2(us_identifiant,
ust_filles) as (
select
	u.us_identifiant,
	''::varchar
from
	unite_structurelle u
left join unite_structurelle_lien l on
	u.us_identifiant = l.ust_mere
where
	l.ust_id is null
union all
select
	l.ust_mere,
	r.us_identifiant
from
	recursion2 r,
	unite_structurelle u
inner join unite_structurelle_lien l on
	u.us_identifiant = l.ust_id
where
	r.us_identifiant = l.ust_id
	and l.ust_mere is not null
	and l.ust_mere != ''
		)
select
	us_identifiant,
	count(ust_filles) as nbfilles
from
	recursion2
group by
	us_identifiant)
select
	u.us_identifiant,
	nbAgenth::decimal,
	nbAgentf::decimal
from
	unite_structurelle u
inner join query q on
	q.us_identifiant = u.us_identifiant
inner join query3 q3 on
	q3.us_identifiant = u.us_identifiant
left join unite_structurelle_lien l on
	u.us_identifiant = l.ust_mere
where
	l.ust_id is null
union all
select
	l.ust_mere,
	r.nbagenth::decimal + q3.nbAgenth / q2.nbfilles::decimal,
	r.nbagentf::decimal + q.nbAgentf / q2.nbfilles::decimal
from
	recursion r,
	unite_structurelle u
inner join unite_structurelle_lien l on
	u.us_identifiant = l.ust_id
inner join query q on
	q.us_identifiant = l.ust_mere
inner join query3 q3 on
	q3.us_identifiant = l.ust_mere
inner join query2 q2 on
	q2.us_identifiant = l.ust_mere
where
	r.us_identifiant = l.ust_id
	and l.ust_mere is not null
	and l.ust_mere != ''
	)

select
	us_identifiant,
	sum(nbAgenth)::bigint as ust_nbagenth,
	sum(nbAgentf)::bigint as ust_nbagentf,
	sum(nbAgenth)::bigint + sum(nbAgentf)::bigint as ust_nbagent
from
	recursion
group by
	us_identifiant
```

### Output (base_metier)
#### Table `effectif_unite`

| Name         | Type    | Expression          | isNullable |
|--------------|---------|---------------------|------------|
| ust_id       | String  | row1.us_identifiant | true       |
| ust_nbagenth | Integer | row1.UST_NBAGENTH   | true       |
| ust_nbagentf | Integer | row1.UST_NBAGENTF   | true       |
| ust_nbagent  | Integer | row1.UST_NBAGENT    | true       |

#### Précisions

La colonne suivante est renommée :  
| Colonne (sql) | Colonne (java) |
|---------------|----------------|
| us_identifiant | ust_id |


````

</details>


---

### 📄 `home/Alimentation-de-la-base-métier.md` [17.707 octets]
<a id="home-Alimentation-de-la-base-métier-md"></a> [↩ Retour à l'arborescence](#tree-home-Alimentation-de-la-base-métier-md)

> **Chemin relatif** : `home/Alimentation-de-la-base-métier.md`  
> **Taille** : 17.707 octets  
> **Lignes** : 400  
> **Type** : markdown

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (400 lignes) - Cliquer pour déplier</summary>

````markdown
L'alimentation de la base métier se fait en appelant :

```bash
curl -x '' -L http://localhost:8080/services/2.4/AlimBase &
```

Cet appel produit le lancement de la séquence d'alimentation décrite dans le projet `Talend` : 

![ALIMENTATION_BASE_METIER_0.1](uploads/9ae6ea9e543428f26edf95be3f3318c3/ALIMENTATION_BASE_METIER_0.1.png)

La log produite lors d'une alimentation réussie se présente ainsi : 

```
2023-11-06T14:25:29,312|JOURNAL|ALIMENTATION_UNITE_STRUCTURELLE|Default|tWarn_1|Alimentation de la table unite_structurelle : 39648 lignes
2023-11-06T14:25:29,931|JOURNAL|ALIMENTATION_UNITE_STRUCTURELLE_LIEN|Default|tWarn_1|Alimentation de la table unite_structurelle_lien : 39648 lignes
2023-11-06T14:27:53,187|JOURNAL|ALIMENTATION_AGENT_LAUNCHER|Default|tWarn_1|Alimentation de la table agent : 120186 lignes
2023-11-06T14:27:55,311|JOURNAL|ALIMENTATION_EFFECTIF_POST_AGENT|Default|tWarn_1|Alimentation de la table effectif_unite : 39648 lignes
2023-11-06T14:28:27,069|JOURNAL|ALIMENTATION_REMUNERATION_LAUNCHER|Default|tWarn_1|Alimentation de la table rémunération: 698741 lignes
2023-11-06T14:29:04,954|JOURNAL|ABSENCES_CONGES_LAUNCHER|Default|tWarn_1|Alimentation de la table absences_conges: 1709705 lignes
2023-11-06T14:29:29,131|JOURNAL|ALIMENTATION_CARRIERE_LAUNCHER|Default|tWarn_1|Alimentation de la table carrière : 1072870 lignes
2023-11-06T14:29:36,968|JOURNAL|ALIMENTATION_AFFECTATION_LAUNCHER|Default|tWarn_1|Alimentation de la table affectation : 411408 lignes
2023-11-06T14:29:44,981|JOURNAL|ALIMENTATION_QUOTITE_LAUNCHER|Default|tWarn_1|Alimentation de la table quotite : 323923 lignes
2023-11-06T14:29:49,927|JOURNAL|ALIMENTATION_CORPS_LAUNCHER|Default|tWarn_1|Alimentation de la table corps : 613 lignes
2023-11-06T14:29:55,026|JOURNAL|ALIMENTATION_GRADE_LAUNCHER|Default|tWarn_1|Alimentation de la table grade : 2340 lignes
2023-11-06T14:29:55,201|JOURNAL|ALIMENTATION_CONTRACTUEL_LAUNCHER|Default|tWarn_1|Alimentation de la table contractuel : 98 lignes
2023-11-06T14:29:58,261|JOURNAL|ALIMENTATION_HABILITATION|Default|tWarn_1|Alimentation de la table habilitation : 101579 lignes
2023-11-06T14:29:59,821|JOURNAL|ALIMENTATION_PROFIL|Dev|tWarn_1|Alimentation de la table profil : 21009 lignes
2023-11-06T14:30:01,128|JOURNAL|ALIMENTATION_POSTE|Dev|tWarn_1|Alimentation de la table poste: 50717 lignes
{"Alimentation":"Fin"}
```

Pour rappel, voici les tables de la base de données `base_metier`

![base_metier_-_public](uploads/5b6b71450abf82e4bcde26768e2b34f5/base_metier_-_public.png)

Cette base a été créée au préalable avec ce script `CreateBaseMetier_ZE_v2.4.4.sql` ([cet article](https://gitlab-forge.din.developpement-durable.gouv.fr/snum/pnm3/gti/kit-de-survie/-/wikis/Produits/Mise-%C3%A0-jour-donn%C3%A9es-et-dictionnaire-SocleRH-et-ZE#chargement-full-zone-d%C3%A9change-sur-lenvironnement-de-preproduction-) donne plus de détails, notamment dans le cas d'un chargement full ZE) :

```sql
DROP TABLE IF EXISTS app_auth cascade;
CREATE TABLE app_auth (
	app VARCHAR(20) NOT NULL,
	service VARCHAR(38) NOT NULL,
	CONSTRAINT app_auth_pkey PRIMARY KEY (app, service)
);

DROP TABLE IF EXISTS agent cascade;
CREATE TABLE agent (
	agent_matricule_renoirh character varying(40),
	agent_matricule_rehucit character varying(20),
	agent_civilite character varying(20),
	agent_nom_usuel character varying(40),
	agent_prenom character varying(38),
	agent_nom_patronymique character varying(38),
	agent_sexe character varying(1),
	agent_autres_prenoms character varying(70),
	agent_autre_nom character varying(38),
	agent_pays_de_nationalite character varying(38),
	agent_date_de_naissance date,
	agent_lieu_de_naissance character varying(38),
	agent_departement_de_naissance character varying(38),
	agent_pays_de_naissance character varying(38),
	agent_date_de_deces date,
	agent_lieu_de_deces character varying(38),
	agent_adresse character varying(150),
	agent_adresse_complement character varying(150),
	agent_adresse_code_postal character varying(15),
	agent_adresse_departement_code character varying(3),
	agent_adresse_departement_fr_metrop_libelle character varying(150),
	agent_adresse_departement_outre_mer_libelle character varying(150),
	agent_adresse_code_insee character varying(40),
	agent_adresse_lieu_dit character varying(100),
	agent_adresse_libelle_acheminement character varying(100),
	agent_mail_professionnel character varying(150),
	agent_position_administrative character varying(20),
	agent_position_administrative_date_effet date,
	agent_categorie_administrative character varying(40),
	agent_situation_familiale character varying(20),
	agent_lot_gestion character varying(40),
	agent_nom_reglementation character varying(40),
	agent_type_contrat character varying(40),
	agent_carriere_origine_corps character varying(40),
	agent_carriere_origine_corps_libelle character varying(150),
	agent_carriere_origine_corps_date_entree date,
	agent_carriere_origine_grade character varying(40),
	agent_carriere_origine_grade_libelle character varying(150),
	agent_carriere_origine_grade_date_entree date,
	agent_carriere_origine_echelon character varying(40),
	agent_unite_niveau_service_affectation character varying(40),
	agent_carriere_emploi_fonctionnel_corps character varying(40),
	agent_carriere_emploi_fonctionnel_corps_libelle character varying(40),
	agent_carriere_emploi_fonctionnel_corps_date_entree date,
	agent_carriere_emploi_fonctionnel_grade character varying(40),
	agent_carriere_emploi_fonctionnel_grade_libelle character varying(100),
	agent_carriere_emploi_fonctionnel_grade_date_entree date,
	agent_carriere_emploi_fonctionnel_echelon character varying(40),
	agent_carriere_emploi_fonctionnel_echelon_date_effet date,
	agent_carriere_accueil_corps character varying(40),
	agent_carriere_accueil_corps_libelle character varying(150),
	agent_carriere_accueil_corps_date_entree date,
	agent_carriere_accueil_grade character varying(40),
	agent_carriere_accueil_grade_libelle character varying(40),
	agent_carriere_accueil_grade_date_entree date,
	agent_carriere_accueil_echelon character varying(40),
	agent_code_poste character varying(40),
	agent_poste_libelle character varying(150),
	agent_affectation_administrative_code character varying(40),
	agent_affectation_administrative_libelle_long character varying(150),
	agent_affectation_administrative_libelle_court character varying(40),
	agent_affectation_administrative_date_installation date,
	agent_affectation_administrative_date_fin_reelle date,
	agent_affectation_operationnelle_code character varying(40),
	agent_affectation_operationnelle_libelle_long character varying(150),
	agent_affectation_operationnelle_libelle_court character varying(40),
	agent_affectation_operationnelle_date_debut date,
	agent_affectation_operationnelle_date_fin date,
	agent_unite_structurelle_affectation character varying(40),
	agent_statut character varying(40),
	agent_statut_libelle character varying(40),
	agent_statut_date_effet date,
	agent_modalite_service character varying(40),
	agent_motif_cessation_fonction character varying(40),
	agent_date_sortie_administrative date,
	agent_matricule_renoirh_responsable character varying(40),
	agent_temoin_validite character varying(40),
	agent_date_entree_ministere date,
	agent_axe_partenaire character varying(20),
	agent_axe_pese character varying(3),
	agent_axe_code_corresp character varying(3),
	agent_contractuel_date_debut date, 
	agent_contractuel_date_fin_reelle date,
	agent_contractuel_date_fin_previsionnelle date,
	agent_contractuel_type_contrat character varying(10),
	agent_contractuel_type_contrat_libelle character varying(100),
	agent_contractuel_pseudo_grade character varying(15),
	agent_contractuel_pseudo_grade_libelle character varying(100),
	agent_contractuel_num_contrat character varying(10),
	agent_contractuel_num_avenant character varying(10)
);

DROP TABLE IF EXISTS poste cascade;
CREATE TABLE poste (
	code_poste VARCHAR(10),
	intitule_poste VARCHAR(60),
	matricule_renoirh VARCHAR(12),    
	date_debut_rattachement_uo date,
	date_fin_validite_uo date,
	code_uo_rattachement VARCHAR(10),
	groupe_uo_poste varchar(20)
);

DROP TABLE IF EXISTS corps cascade;
CREATE TABLE corps (
	reglementaire_code_corps character varying(40),
	reglementaire_corps_libelle_long character varying(45),
	reglementaire_corps_libelle_agrege character varying(18),
	reglementaire_corps_libelle_complementaire character varying(254),
	reglementaire_corps_date_debut_validite date,
	reglementaire_corps_date_fin_validite date,
	reglementaire_corps_ouvert boolean,
	reglementaire_corps_avec_agents boolean,
	reglementaire_corps_nb_agents integer,
	reglementaire_corps_nb_agents_masculins integer,
	reglementaire_corps_nb_agents_feminins integer,
	reglementaire_corps_accueil_nb_agents integer,
	reglementaire_corps_accueil_nb_agents_masculins integer,
	reglementaire_corps_accueil_nb_agents_feminins integer,
	reglementaire_corps_origine_nb_agents integer,
	reglementaire_corps_origine_nb_agents_masculins integer,
	reglementaire_corps_origine_nb_agents_feminins integer,
	reglementaire_corps_emplois_fonctionnels_nb_agents integer,
	reglementaire_corps_emplois_fonctionnels_nb_agents_masculins integer,
	reglementaire_corps_emplois_fonctionnels_nb_agents_feminins integer,
	search character varying(1000)
);

DROP TABLE IF EXISTS grade cascade;
CREATE TABLE grade (
	reglementaire_code_grade character varying(40),
	reglementaire_grade_libelle_long character varying(45),
	reglementaire_grade_libelle_agrege character varying(18),
	reglementaire_grade_libelle_complementaire character varying(254),
	reglementaire_grade_date_debut_validite date,
	reglementaire_grade_date_fin_validite date,
	reglementaire_grade_ouvert boolean,
	reglementaire_grade_avec_agents boolean,
	reglementaire_grade_nb_agents integer,
	reglementaire_grade_nb_agents_masculins integer,
	reglementaire_grade_nb_agents_feminins integer,
	reglementaire_grade_accueil_nb_agents integer,
	reglementaire_grade_accueil_nb_agents_masculins integer,
	reglementaire_grade_accueil_nb_agents_feminins integer,
	reglementaire_grade_origine_nb_agents integer,
	reglementaire_grade_origine_nb_agents_masculins integer,
	reglementaire_grade_origine_nb_agents_feminins integer,
	reglementaire_grade_emplois_fonctionnels_nb_agents integer,
	reglementaire_grade_emplois_fonctionnels_nb_agents_masculins integer,
	reglementaire_grade_emplois_fonctionnels_nb_agents_feminins integer
);

DROP TABLE IF EXISTS unite_structurelle cascade;
CREATE TABLE unite_structurelle (
	us_identifiant VARCHAR(100) NOT NULL,
	us_libelle_long VARCHAR(150) NULL,
	us_libelle_court VARCHAR(100) NULL,
	us_date_creation date NULL,
	us_date_fermeture date NULL,
	us_nature VARCHAR(100) NULL,
	us_type VARCHAR(100) NULL,
	us_type_libelle VARCHAR(100) NULL,
	us_code_ministere VARCHAR(100) NULL,
	us_numero_voie VARCHAR(100) NULL,
	us_voie_bis_ter VARCHAR(100) NULL,
	us_libelle_voie VARCHAR(60) NULL,
	us_complement_agent VARCHAR(60) NULL,
	us_code_postal VARCHAR(10) NULL,
	us_code_insee VARCHAR(100) NULL,
	us_commune VARCHAR(38) NULL,
	us_departement VARCHAR(38) NULL,
	us_pays VARCHAR(38) NULL,
	us_bureau_distributeur VARCHAR(100) NULL,
	us_niveau VARCHAR(100) NULL,
	us_mere VARCHAR(100) NULL,
	us_type_arborescence VARCHAR(100) NULL,
	us_date_debut_rattachement date NULL,
	us_date_fin_rattachement date NULL,
	us_type_organisation VARCHAR(100) NULL,
	us_unite_organisationnelle VARCHAR(100) NULL,
	us_libelle_court_uo VARCHAR(100) NULL,
	us_structure_uo VARCHAR(100) NULL,
	us_date_effet date NULL,
	us_date_fin date NULL,
	us_nom_responsable_uo VARCHAR(100) NULL,
	us_niveau_direction VARCHAR(100) NULL,
	us_niveau_service VARCHAR(100) NULL,
	us_niveau_unite_structurelle VARCHAR(100) NULL,
	nudoss numeric(38) NULL,
	us_actif bool NULL,
	"search" VARCHAR(1000) NULL,
	CONSTRAINT unite_structurelle_pkey PRIMARY KEY (us_identifiant)
);

DROP TABLE IF EXISTS unite_structurelle_lien cascade;
CREATE TABLE unite_structurelle_lien (
	ust_id VARCHAR(100),
	ust_mere VARCHAR(100),
	ust_dderat date,
	ust_dfirat date
);

DROP TABLE IF EXISTS remuneration cascade;
CREATE TABLE remuneration (
	remuneration_matricule_agent_renoirh VARCHAR(12) NULL,
	remuneration_date_debut_saisie_mois_paye date NULL,
	remuneration_date_fin_saisie_mois_paye date NULL,
	remuneration_date_extreme_mise_en_paye_dgfip date NULL,
	remuneration_code_tresorerie_generale VARCHAR(1) NULL,
	remuneration_numero_de_dossier VARCHAR(2) NULL,
	remuneration_dossier_de_paie_principal VARCHAR(1) NULL,
	remuneration_date_debut_affectation_tg date NULL,
	remuneration_date_fin_dossier_principal date NULL,
	remuneration_identifiant_interne numeric(38) NULL,
	remuneration_nom_reglementation VARCHAR(3) NULL,
	remuneration_matricule VARCHAR(12) NULL,
	remuneration_date_effet_prise_en_charge date NULL,
	remuneration_date_fin_zone_commune date NULL,
	remuneration_code_tg VARCHAR(1) NULL,
	remuneration_numero_dossier VARCHAR(2) NULL,
	remuneration_code_administration VARCHAR(3) NULL,
	remuneration_code_correspondant VARCHAR(3) NULL,
	remuneration_departement_service_gestionnaire VARCHAR(3) NULL,
	remuneration_code_regime VARCHAR(2) NULL,
	remuneration_code_tg_specifique VARCHAR(1) NULL,
	remuneration_dossier_specifique VARCHAR(2) NULL,
	remuneration_date_effet_regime date NULL,
	remuneration_date_fin_regime date NULL,
	remuneration_annee_mise_en_paye VARCHAR(2) NULL,
	remuneration_mois_mise_en_paye VARCHAR(2) NULL,
	remuneration_temoin_validation_paye VARCHAR(1) NULL,
	remuneration_temoin_annulation_paye VARCHAR(1) NULL,
	remuneration_date_effet_pecuniere date NULL,
	"search" VARCHAR(220) NULL
);

DROP TABLE IF EXISTS quotite cascade;
CREATE TABLE quotite (
	quotite_matricule VARCHAR(40) NULL,
	quotite_nom VARCHAR(38) NULL,
	quotite_prenom VARCHAR(38) NULL,
	quotite_travail VARCHAR(20) NULL,
	quotite_modalite_service VARCHAR(20) NULL,
	quotite_service VARCHAR(20) NULL,
	quotite_pourc_heure_presence_tmp_plein numeric(38,5) NULL,
	quotite_numerateur_remuneration numeric(38,5) NULL,
	quotite_denominateur_remuneration numeric(38,5) NULL,
	quotite_effet_travail date NULL,
	quotite_fin_travail date NULL,
	quotite_temoin_surcotisation VARCHAR(5) NULL,
	quotite_temoin_validite VARCHAR(30) NULL,
	"search" VARCHAR(250) NULL
);

DROP TABLE IF EXISTS contractuel cascade ;
CREATE TABLE contractuel(
	reglementaire_code_pseudo_grade VARCHAR(40),
	reglementaire_pseudo_grade_libelle_long VARCHAR(45),
	reglementaire_pseudo_grade_libelle_agrege VARCHAR(18),
	reglementaire_pseudo_grade_libelle_complementaire VARCHAR(254),
	reglementaire_pseudo_grade_date_debut_validite date,
	reglementaire_pseudo_grade_date_fin_validite date,
	reglementaire_pseudo_grade_ouvert boolean,
	reglementaire_pseudo_grade_avec_agents boolean,
	reglementaire_pseudo_grade_nb_agents integer,
	reglementaire_pseudo_grade_nb_agents_masculins integer,
	reglementaire_pseudo_grade_nb_agents_feminins integer
);

DROP TABLE IF EXISTS carriere cascade;
CREATE TABLE carriere (
	carriere_matricule VARCHAR(40) NULL,
	carriere_nom VARCHAR(40) NULL,
	carriere_prenom VARCHAR(40) NULL,
	carriere_date_de_naissance date NULL,
	carriere_date_debut date NULL,
	carriere_date_fin date NULL,
	carriere_grade_statutaire_date_effet_classement VARCHAR(20) NULL,
	carriere_identifiant_preliquidation_echelon VARCHAR(20) NULL,
	carriere_temoin_validite_information VARCHAR(20) NULL,
	carriere_statut_agent VARCHAR(40) NULL,
	carriere_specialite VARCHAR(40) NULL
);

DROP TABLE IF EXISTS effectif_unite cascade;
CREATE TABLE effectif_unite (
	ust_id VARCHAR(100) NULL,
	ust_nbagenth int4 NULL,
	ust_nbagentf int4 NULL,
	ust_nbagent int4 NULL,
	CONSTRAINT effectif_unite_ust_id_fkey FOREIGN KEY (ust_id) REFERENCES unite_structurelle(us_identifiant)
);

DROP TABLE IF EXISTS absences_conges cascade;
CREATE TABLE absences_conges (
	absence_conges_matricule_renoirh VARCHAR(12) NULL,
	absence_conges_motif VARCHAR(5) NULL,
	absence_conges_date_debut_impact_remuneration date NULL,
	absence_conges_temoin_debut_impact_remuneration VARCHAR(1) NULL,
	absence_conges_date_fin_tranche date NULL,
	absence_conges_temoin_absence VARCHAR(1) NULL,
	absence_conges_nombre_jours numeric(5) NULL,
	absence_conges_numero_droit VARCHAR(3) NULL,
	absence_conges_numero_de_tranche VARCHAR(1) NULL,
	absence_conges_temoin_de_validite VARCHAR(1) NULL,
	"search" VARCHAR(42) NULL
);

DROP TABLE IF EXISTS affectation cascade;
CREATE TABLE affectation (
	affectation_matricule VARCHAR(12) NULL,
	affectation_nom VARCHAR(40) NULL,
	affectation_prenom VARCHAR(40) NULL,
	affectation_date_effet_organisationnelle date NULL,
	affectation_date_fin_organisationnelle date NULL,
	affectation_unite_organisationnelle VARCHAR(10) NULL,
	affectation_temoin_validite VARCHAR(1) NULL,
	"search" VARCHAR(23) NULL
);

DROP TABLE IF EXISTS habilitation cascade;
CREATE TABLE habilitation(
	adresse_mail varchar(400),
	nom_utilisateur varchar(200),
	prenom_utilisateur varchar(200),
	matricule_renoirh varchar(20),
	agent_affectation_administrative varchar(10),
	agent_affectation_administrative_libelle_long varchar(200),
	agent_affectation_administrative_libelle_court VARCHAR(50),
	agent_affectation_operationnelle varchar(10),
	agent_affectation_operationnelle_libelle_long VARCHAR(200),
	agent_affectation_operationnelle_libelle_court VARCHAR(50)
);

DROP TABLE IF EXISTS profil cascade;
CREATE TABLE profil (
	matricule_renoirh varchar(20),
	modele_de_role VARCHAR(50),
	intitule_modele_role VARCHAR(2000),
	hab_axe VARCHAR(2000),
	hab_axe_us_oper VARCHAR(2000),
	hab_axe_pese VARCHAR(2000),
	hab_axe_us_adm VARCHAR(2000),
	hab_axe_part VARCHAR(2000),
	hab_axe_corp VARCHAR(2000),
	hab_axe_grp_uo_poste VARCHAR(2000),
	hab_axe_ldg VARCHAR(2000),
	hab_axe_corresp VARCHAR(2000)
);
```



````

</details>


---

### 📄 `home/Alimentation-des-autorisations.md` [2.139 octets]
<a id="home-Alimentation-des-autorisations-md"></a> [↩ Retour à l'arborescence](#tree-home-Alimentation-des-autorisations-md)

> **Chemin relatif** : `home/Alimentation-des-autorisations.md`  
> **Taille** : 2.139 octets  
> **Lignes** : 36  
> **Type** : markdown

````markdown
Les applications autorisées à appeler les webservices sont stockées dans la table `app_auth` au niveau de la base métier, en précisant pour chaque application le service autorisé.

Le chargement de cette table est réalisé en faisant l'appel : 

```
curl -x '' -L http://localhost:8080/services/2.1/AlimAuth
```
Le fichier `/zechange/AuthorisationApplication2.csv` est alors chargé dans la table `app_auth`.  

Il est également possible de charger cette table directement à partir d'un script `SQL` (par exemple `ZE_auth.sql`) qui inclut les instructions `INSERT` avec les données attendues.


| Rôle à indiquer dans service  | Web Service ouvert              |
|-------------------------------|---------------------------------|
| getListAgents                 | /Agent/list                     |
| getListRemunerations          | /Remuneration/list              |
| getListAbsences               | /Conges/list                    |
| getListAffectations           | /Affectation/list               |
| getArboUniteStructurelles     | /US/arbo                        |
| getEffectifAgents             | /Agent/effectif                 |
| getIdentiteAgent              | /Identite_Agent                 |
| getStatut                     | /Statut/list                    |
| getQuotite                    | /Quotite/list                   |
| getCarriere                   | /Carriere/list                  |
| getCorpsById                  | /Reglementaire/Corps/{id}       |
| getCorpsList                  | /Reglementaire/Corps/list       |
| getGradeById                  | /Reglementaire/Grade/{id}       |
| getGradeList                  | /Reglementaire/Grade/list       |
| getContractuelById            | /Reglementaire/Contractuel/{id} |
| getContractuelList            | /Reglementaire/Contractuel/list |
| getUniteStructurelle          | /US/{id}                        |
| getAgent                      | /Agent/{id}                     |
| getHabilitation               | /Habilitation/{id}              |
| getListUniteStructurelles     | /US/list                        |


````


---

### 📄 `home/Alimentation-du-référentiel.md` [1.316 octets]
<a id="home-Alimentation-du-référentiel-md"></a> [↩ Retour à l'arborescence](#tree-home-Alimentation-du-référentiel-md)

> **Chemin relatif** : `home/Alimentation-du-référentiel.md`  
> **Taille** : 1.316 octets  
> **Lignes** : 25  
> **Type** : markdown

````markdown
Il s'agit de 3 tables qui sont créées dans la base `soclerh`.   
Elles sont chargées à partir de fichiers _csv_ stockés à la racine du dossier `/zechange` :

| Table | Source (csv) |
| ------ | ------ |
| modeles_de_role_renoirh | /zechange/modeles_de_role_renoirh.csv |
|  regroupement_code_corresp | /zechange/regroupement_cco.csv |
|  regroupement_ldg | /zechange/regroupement_ldg.csv |

L'alimentation du référentiel se fait en appelant : 
```bash 
curl -x '' -L http://localhost:8060/services/2.4/AlimRef
```  

Après une alimentation de ces 3 tables, il faudra `actualiser` la base métier, pour répercuter les changements. 

```bash 
curl -x '' -L http://localhost:8060/services/2.4/AlimBase &
```  

Dans la pratique, sur l'environnement de `prod`, nous faisons en sorte d'aligner la mise à jour des tables de référence avec les chargements FULL. En effet, dans le workflow d'un chargement FULL, un appel aux deux WS `AlimRef` et `AlimBase` est effectué. Il faudra néanmoins déposer les nouveaux fichiers csv comme indiqué dans le tableau ci-haut.

En `pré-prod`, en dehors des plages horaires ou cet environnment est utilisé comme environnement de bascule (pour assurer la continuité de service), l'appel au WS pour être fait directement comme décrit ci-haut.


````


---

### 📄 `home/Environnements.md` [3.065 octets]
<a id="home-Environnements-md"></a> [↩ Retour à l'arborescence](#tree-home-Environnements-md)

> **Chemin relatif** : `home/Environnements.md`  
> **Taille** : 3.065 octets  
> **Lignes** : 37  
> **Type** : markdown

```markdown
---
title: Environnements et usages
---
Pour répondre à votre interrogation sur l'utilisation des web services de la ZE, voici une liste des environnements Web Services de la Zone échange (WS_ZE, API sur Socle RH) qui sont nécessaires :

    Environnement de production (https://zone-echange.rh.e2.rie.gouv.fr/cxf/ZE/)
    requis pour le fonctionnement courant
    Environnement de pré-production (https://zone-echange.ppr.rh.e2.rie.gouv.fr/cxf/ZE)
    requis en particulier lors de mises à jour de dictionnaire RenoiRH pour permettre de continuer d'assurer la disponibilité des WS pendant les phases de mise à jour de l'environnement de production avec la nouvelle définition du dictionnaire
    Environnement de recette (https://zone-echange.rec.rh.e2.rie.gouv.fr/cxf/ZE)
    requis pour tester les nouvelles version des WS

Tous ces environnements WS_ZE doivent pouvoir être utilisés par :

    N'importe quel environnement de Hub RH (production, pré-production, recette)
    Swagger via l'url https://zone-echange.rec.rh.e2.rie.gouv.fr/swagger/ ou https://zone-echange.ppr.rh.e2.rie.gouv.fr/swagger/ en modifiant si besoin le fichier json chargé comme définition des WS.
    A noter, une seule instance de swagger est suffisante, compte tenu de la possibilité sur cette instance de pointer les json de définition des WS à tester
    L'utilisation de swagger nécessite de disposer du certificat swagger-recette installé sur le poste de l'utilisateur
    L'utilisation de swagger facilite la construction des requêtes permettant de tester les web services mais ces requêtes peuvent aussi être forgées à la main.

Application utilisant les WS ZE

    Actuellement, seul l'application Hub RH utilise les WS ZE
    Compte tenu de la mise en place des API RenoiRH, cette utilisation ne sera pas étendue, les WS ZE ayant vocation à être décommissionné au profit de ces API RenoiRH

Liste des web services ZE utilisés par Hub RH (cf hubrh/plugins/redmine_hub_rh/lib/redmine_hub_rh/hub_rh_webservice.rb) :

    /Agent/{id} : Récupère les détails d'un ou plusieurs agents à partir d'une liste de matricules (nb a priori on utilisé par Hub RH mais utile pour les recette)
    /Agent/list : Récupère la liste d'agents correspondant aux paramètres de recherche
    /Habilitation/{id} : Récupère les profils actifs d'un agent à partir d'une liste d'adresses mail
    /Reglementaire/Corps/{id} : Récupère les informations des corps
    /Reglementaire/Corps/list : Récupère les corps correspondante aux paramètres de recherche
    /Reglementaire/Corps/list : Récupère les corps correspondante aux paramètres de recherche (nb a priori on utilisé par Hub RH mais utile pour les recette)
    /Reglementaire/Corps/list : Récupère les corps correspondante aux paramètres de recherche
    /US/{id} : Récupère les détails d'une ou plusieurs unités structurelles à partir d'une liste d'id
    /US/list : Récupère la liste d'unités structurelles correspondant aux paramètres de recherche

```


---

### 📄 `home/Webservice-Zone-d'Echange.md` [597 octets]
<a id="home-Webservice-Zone-d'Echange-md"></a> [↩ Retour à l'arborescence](#tree-home-Webservice-Zone-d'Echange-md)

> **Chemin relatif** : `home/Webservice-Zone-d'Echange.md`  
> **Taille** : 597 octets  
> **Lignes** : 26  
> **Type** : markdown

````markdown
### Endpoints (swagger.json)
1. [En pre-prod](https://zone-echange.ppr.rh.e2.rie.gouv.fr/cxf/ZE/2.4.4/swagger.json) 
2. [En local](http://localhost:8080/cxf/ZE/2.4.4/swagger.json)  

[swagger-ze-2.4.4-ppr.json](uploads/ae4d65d43ded5bd5a6bd191aa01ddbab/swagger-ze-2.4.4-ppr.json)

### Exemple (en local - poste dev)
```bash
curl -x "" -H "SSL_CLIENT_S_DN: xxxAuthorizedApp" http://localhost:8080/cxf/ZE/2.4.4/Agent/list\?recherche\=xxxxx | jq

```

```json
[
  {
    "agent_matricule_renoirh": "xxxxx",
    "agent_matricule_rehucit": "xxxxx",
    "agent_civilite": "xxxxx",
	...
  },
  ...
]

```


````


---

### 📄 `home.md` [1.691 octets]
<a id="home-md"></a> [↩ Retour à l'arborescence](#tree-home-md)

> **Chemin relatif** : `home.md`  
> **Taille** : 1.691 octets  
> **Lignes** : 22  
> **Type** : markdown

```markdown
### ZE Talend

1. [Alimentation des autorisations](home/Alimentation-des-autorisations)
2. [Alimentation du référentiel](home/Alimentation-du-référentiel)
3. [Alimentation de la base métier](home/Alimentation-de-la-base-métier)
    1. [Alimentation des unités structurelles](home/Alimentation-de-la-base-métier/Alimentation-des-unités-structurelles)
    2. [Alimentation des agents](home/Alimentation-de-la-base-métier/Alimentation-des-agents)
    3. [Alimentation des effectifs](home/Alimentation-de-la-base-métier/Alimentation-effectif-post-agent)
    4. [Alimentation des rémunérations](home/Alimentation-de-la-base-métier/Alimentation-des-rémunérations)
    5. [Alimentation des absences et congés](home/Alimentation-de-la-base-métier/Alimentation-des-absences-et-congés)
    6. [Alimentation des carrières](home/Alimentation-de-la-base-métier/Alimentation-des-carrières)
    7. [Alimentation des affectations](home/Alimentation-de-la-base-métier/Alimentation-des-affectations)
    8. [Alimentation des quotités](home/Alimentation-de-la-base-métier/Alimentation-des-quotités)
    9. [Alimentation des corps](home/Alimentation-de-la-base-métier/Alimentation-des-corps)
    10. [Alimentation des grades](home/Alimentation-de-la-base-métier/Alimentation-des-grades)
    11. [Alimentation des contractuels](home/Alimentation-de-la-base-métier/Alimentation-des-contractuels)
    12. [Alimentation des habilitations](home/Alimentation-de-la-base-métier/Alimentation-des-habilitations)
    13. [Alimentation des postes](home/Alimentation-de-la-base-métier/Alimentation-des-postes)

### Tests
1. [Swagger Webservice Zone d'Echange](home/Webservice-Zone-d'Echange)

```


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>

`````

</details>


---

### 📄 `src/check_md.py` [4.554 octets]
<a id="src-check_md-py"></a> [↩ Retour à l'arborescence](#tree-src-check_md-py)

> **Chemin relatif** : `src/check_md.py`  
> **Taille** : 4.554 octets  
> **Lignes** : 148  
> **Type** : python

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (148 lignes) - Cliquer pour déplier</summary>

```python
#!/usr/bin/env python3
# G:\home\firmin\.local\bin\check_md.py
"""
Vérifie l'encodage de fichiers Markdown via des chemins ou motifs (globs).

Supporte :
  - Chemins exacts : 'README.md'
  - Wildcards : '*.md', 'docs/[A-Z]*.md'
  - Récursion : 'content/**/*.md'

Dépendances : chardet (à installer via pip/conda)
"""

import argparse
import sys
from pathlib import Path
from typing import List

# 🔗 Import du composant réutilisable
try:
    from utils.pathglob import resolve_path_patterns
except ImportError:
    # Fallback si utils/ non dans PYTHONPATH (ex. test rapide)
    sys.path.append(str(Path(__file__).parent.parent / "utils"))
    from utils.pathglob import resolve_path_patterns

import chardet


def check_md(file_path: Path) -> dict:
    """Vérifie l'encodage d'un fichier Markdown.

    Args:
        file_path (Path): Chemin vers le fichier (doit exister).

    Returns:
        dict: Résultat avec 'path', 'encoding', 'confidence', 'error' (si applicable).
    """
    result = {
        "path": file_path,
        "encoding": None,
        "confidence": 0.0,
        "error": None
    }

    try:
        if not file_path.is_file():
            result["error"] = "Not a file or does not exist"
            return result

        raw_data = file_path.read_bytes()
        detected = chardet.detect(raw_data)
        result["encoding"] = detected["encoding"]
        result["confidence"] = detected["confidence"]

    except Exception as e:
        result["error"] = str(e)

    return result


def main_cli() -> int:
    """CLI entry point — retourne le code de sortie (0 = OK, 1 = erreur)."""
    parser = argparse.ArgumentParser(
        description="Vérifie l'encodage de fichiers Markdown (supporte les globs)."
    )
    parser.add_argument(
        "--path-pattern", "-P",
        nargs="+",
        required=True,
        metavar="PATTERN",
        help="Motif(s) de chemin(s) Markdown (ex: '*.md', 'docs/**/*.md'). "
             "Les motifs sans extension .md sont acceptés, mais seuls les .md seront traités."
    )
    parser.add_argument(
        "--min-confidence",
        type=float,
        default=0.7,
        help="Seuil minimal de confiance pour considérer l'encodage comme fiable (défaut: 0.7)"
    )
    parser.add_argument(
        "--quiet", "-q",
        action="store_true",
        help="Mode silencieux : n'affiche que les erreurs ou encodages non UTF-8"
    )

    args = parser.parse_args()

    # 🔍 Résolution des motifs → chemins concrets
    try:
        all_paths = resolve_path_patterns(args.path_pattern, recursive=True)
    except (ValueError, OSError) as e:
        print(f"❌ Échec de la résolution des motifs : {e}", file=sys.stderr)
        return 1

    # 🔎 Filtrer *seulement* les fichiers .md (insensible à la casse sous Windows)
    md_paths = [
        p for p in all_paths
        if p.is_file() and p.suffix.lower() == ".md"
    ]

    if not md_paths:
        print("⚠️  Aucun fichier Markdown (.md) trouvé.", file=sys.stderr)
        return 1

    has_issue = False
    for p in md_paths:
        res = check_md(p)
        encoding = res["encoding"] or "inconnu"
        confidence = res["confidence"]
        error = res["error"]

        # ✅ Comportement par défaut : tout afficher
        if not args.quiet:
            status = "❌" if error else ("⚠️ " if confidence < args.min_confidence else "✅")
            print(f"{status} {p}")
            if error:
                print(f"    → Erreur: {error}")
            else:
                print(f"    → Encodage: {encoding} (confiance: {confidence:.2%})")

        # 🔔 Mode silencieux : signaler les problèmes
        if error or (encoding and encoding.upper() not in ("UTF-8", "UTF8")) or confidence < args.min_confidence:
            has_issue = True
            if args.quiet:
                print(f"⚠️  {p}: {encoding} ({confidence:.0%})", file=sys.stderr)

    return 1 if has_issue else 0


# 🧩 API programmatique (réutilisable depuis d'autres modules)
def check_markdown_files(patterns: List[str]) -> List[dict]:
    """API publique : analyse les .md correspondant aux motifs.

    Args:
        patterns: Liste de motifs (ex: ["docs/**/*.md"])

    Returns:
        Liste de résultats (dict), un par fichier Markdown trouvé.
    """
    paths = resolve_path_patterns(patterns)
    md_files = [p for p in paths if p.suffix.lower() == ".md"]
    return [check_md(p) for p in md_files]


# ▶️ Point d'entrée
if __name__ == "__main__":
    sys.exit(main_cli())
```

</details>


---

### 📄 `src/check_md.py.old` [956 octets]
<a id="src-check_md-py-old"></a> [↩ Retour à l'arborescence](#tree-src-check_md-py-old)

> **Chemin relatif** : `src/check_md.py.old`  
> **Taille** : 956 octets  
> **Lignes** : 36  
> **Type** : text

```text
"""Module pour vérifier l'encodage des fichiers Markdown."""

import chardet
import os

def check_md(file_path):
    """Vérifie l'encodage d'un fichier Markdown.
    
    Args:
        file_path (str): Chemin vers le fichier Markdown à vérifier.
    """
    if not os.path.exists(file_path):
        print(f"Erreur: Le fichier {file_path} n'existe pas.")
        return

    with open(file_path, 'rb') as file:
        raw_data = file.read()
        result = chardet.detect(raw_data)

    print(f"Fichier: {file_path}")
    print(f"Encodage détecté: {result['encoding']}")
    print(f"Confiance: {result['confidence']}")

def main(args):
    """Fonction principale pour vérifier l'encodage des fichiers Markdown.
    
    Args:
        args (list): Liste des chemins de fichiers Markdown à vérifier.
    """
    if not args:
        print("Erreur: Aucun fichier spécifié.")
        return

    for file_path in args:
        check_md(file_path)

```


---

### 📄 `src/core/pathglob.py` [4.069 octets]
<a id="src-core-pathglob-py"></a> [↩ Retour à l'arborescence](#tree-src-core-pathglob-py)

> **Chemin relatif** : `src/core/pathglob.py`  
> **Taille** : 4.069 octets  
> **Lignes** : 127  
> **Type** : python

<details class="file-content-collapsible">
<summary>📖 Afficher le contenu (127 lignes) - Cliquer pour déplier</summary>

````python
# G:\home\firmin\.local\lib\python\utils\pathglob.py
# (ou dans ton projet: ./utils/pathglob.py)

"""
Path pattern resolution module — robust globbing for paths with wildcards and recursion.

Supports:
  - Shell-style globs: *, ?, [seq], [!seq]
  - Recursive globs: ** (matches any subdirectory, including zero)
  - Windows paths (G:\, \\server\share), ~ expansion, case insensitivity where relevant
  - Deduplication, sorting, and type annotation (Path objects)

Typical usage:
    from utils.pathglob import resolve_path_patterns
    files = resolve_path_patterns(["src/**/*.py", "~/.config/*.json"])
"""

import glob
import os
from pathlib import Path
from typing import Iterable, List, Optional, Union

__all__ = ["resolve_path_patterns", "PathPatternResolver"]


def resolve_path_patterns(
    patterns: Union[str, Iterable[str]],
    *,
    recursive: bool = True,
    strict: bool = False,
    resolve: bool = True,
    sort: bool = True,
    case_sensitive: Optional[bool] = None
) -> List[Path]:
    """
    Resolve one or more path patterns into concrete Path objects.

    Args:
        patterns: A single pattern (str) or list/iterable of patterns.
        recursive: Enable ** recursion (default: True).
        strict: If True, raise ValueError on empty/no-match patterns.
        resolve: If True (default), call Path.resolve() for absolute, normalized paths.
        sort: Return sorted list (default: True → deterministic output).
        case_sensitive: Override system default (None → auto-detect; Windows=False).

    Returns:
        List of unique Path objects (files and/or directories), resolved and deduplicated.

    Raises:
        ValueError: If `strict=True` and a pattern yields no matches.
        OSError: If glob encounters an OS error (e.g. permission denied on part of tree).

    Examples:
        >>> resolve_path_patterns("*.py")
        [PosixPath('main.py'), PosixPath('utils.py')]
        >>> resolve_path_patterns(["logs/*.log", "data/**/*.csv"])
        [...]
    """
    if isinstance(patterns, str):
        patterns = [patterns]

    if case_sensitive is None:
        # Windows: case-insensitive by default in glob
        case_sensitive = not (os.name == "nt")

    resolved: List[Path] = []
    for pat in patterns:
        pat = os.path.expanduser(pat)
        try:
            matches = glob.glob(pat, recursive=recursive, include_hidden=True)
        except Exception as e:
            raise OSError(f"Failed to glob pattern '{pat}': {e}") from e

        if not matches and strict:
            raise ValueError(f"No matches for pattern: '{pat}'")

        for m in matches:
            p = Path(m)
            if resolve:
                p = p.resolve()
            resolved.append(p)

    # Deduplicate (set preserves hashable Path), then sort
    unique = list(set(resolved))
    if sort:
        unique.sort(key=lambda x: (str(x).lower(), str(x)))
    return unique


class PathPatternResolver:
    """
    Reusable resolver with configurable defaults (e.g. for a CLI tool or pipeline).
    
    Example:
        resolver = PathPatternResolver(recursive=False, strict=True)
        paths = resolver(["*.tmp"])
    """

    def __init__(
        self,
        recursive: bool = True,
        strict: bool = False,
        resolve: bool = True,
        sort: bool = True,
        case_sensitive: Optional[bool] = None
    ):
        self.recursive = recursive
        self.strict = strict
        self.resolve = resolve
        self.sort = sort
        self.case_sensitive = case_sensitive

    def __call__(self, patterns: Union[str, Iterable[str]]) -> List[Path]:
        return resolve_path_patterns(
            patterns,
            recursive=self.recursive,
            strict=self.strict,
            resolve=self.resolve,
            sort=self.sort,
            case_sensitive=self.case_sensitive
        )

    def __repr__(self):
        return (
            f"PathPatternResolver(recursive={self.recursive}, strict={self.strict}, "
            f"resolve={self.resolve}, sort={self.sort})"
        )
````

</details>


---

### 📄 `src/nvyz/__init__.py` [55 octets]
<a id="src-nvyz-__init__-py"></a> [↩ Retour à l'arborescence](#tree-src-nvyz-__init__-py)

> **Chemin relatif** : `src/nvyz/__init__.py`  
> **Taille** : 55 octets  
> **Lignes** : 4  
> **Type** : python

```python
"""Module principal de nvyz."""

__version__ = "0.1.0"

```


---

### 📄 `src/nvyz/cli.py` [658 octets]
<a id="src-nvyz-cli-py"></a> [↩ Retour à l'arborescence](#tree-src-nvyz-cli-py)

> **Chemin relatif** : `src/nvyz/cli.py`  
> **Taille** : 658 octets  
> **Lignes** : 21  
> **Type** : python

````python
"""Module CLI pour nvyz."""

import argparse
from ..check_md import main as check_md_main

def main():
    """Fonction principale appelée par la commande `nvyz`."""
    parser = argparse.ArgumentParser(description='nvyz CLI')
    subparsers = parser.add_subparsers(dest='command')
    
    # Commande check-md
    parser_check_md = subparsers.add_parser('check-md', help='Vérifie l\'encodage des fichiers Markdown')
    parser_check_md.add_argument('files', nargs='+', help='Fichiers Markdown à vérifier')
    
    args = parser.parse_args()
    
    if args.command == 'check-md':
        check_md_main(args.files)
    else:
        parser.print_help()

````


---

*Généré par dyag project2md*


<style>
/* Collapsible file content styles */
.file-content-collapsible {
    margin: 15px 0;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    background: #f6f8fa;
}

.file-content-collapsible summary {
    padding: 12px 15px;
    cursor: pointer;
    font-weight: 600;
    color: #0366d6;
    user-select: none;
    list-style: none;
    background: #f6f8fa;
    border-radius: 6px;
    transition: background-color 0.2s, color 0.2s;
}

.file-content-collapsible summary::-webkit-details-marker {
    display: none;
}

.file-content-collapsible summary::before {
    content: '▶ ';
    display: inline-block;
    transition: transform 0.2s;
    margin-right: 5px;
}

.file-content-collapsible[open] summary::before {
    transform: rotate(90deg);
}

.file-content-collapsible summary:hover {
    background-color: #e1e4e8;
    color: #0256a0;
}

.file-content-collapsible[open] summary {
    border-bottom: 1px solid #e1e4e8;
    margin-bottom: 0;
    border-radius: 6px 6px 0 0;
}

.file-content-collapsible pre {
    margin: 0 !important;
    border-radius: 0 0 6px 6px !important;
    border: none !important;
}

/* Button to expand/collapse all */
.collapse-controls {
    position: sticky;
    top: 10px;
    z-index: 100;
    text-align: right;
    margin: 20px 0;
}

.collapse-btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 0 5px;
    background: #0366d6;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: background 0.2s;
    text-decoration: none;
}

.collapse-btn:hover {
    background: #0256a0;
}

.collapse-btn:active {
    transform: translateY(1px);
}
</style>

<script>
// Add expand/collapse all buttons
document.addEventListener('DOMContentLoaded', function() {
    // Find the file contents section
    const fileContentsSection = document.querySelector('h2');
    if (!fileContentsSection) return;

    // Create control buttons
    const controlsDiv = document.createElement('div');
    controlsDiv.className = 'collapse-controls';
    controlsDiv.innerHTML = `
        <button class="collapse-btn" onclick="expandAllFiles()">📖 Tout déplier</button>
        <button class="collapse-btn" onclick="collapseAllFiles()">📕 Tout replier</button>
    `;

    // Insert after the "Contenu des fichiers" heading
    const contenuHeading = Array.from(document.querySelectorAll('h2')).find(h => h.textContent.includes('Contenu des fichiers'));
    if (contenuHeading) {
        contenuHeading.parentNode.insertBefore(controlsDiv, contenuHeading.nextSibling);
    }
});

function expandAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = true;
    });
}

function collapseAllFiles() {
    document.querySelectorAll('.file-content-collapsible').forEach(details => {
        details.open = false;
    });
}

// Add keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Ctrl+E: Expand all
    if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        expandAllFiles();
    }
    // Ctrl+R: Collapse all
    if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        collapseAllFiles();
    }
});
</script>
